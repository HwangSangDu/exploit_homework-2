/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2015 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void init_proc();
// int __fastcall insert_nf_to_rule(_DWORD, _DWORD); weak
// int __fastcall get_rsync_config(int a1);
// int __fastcall get_fakedns(_DWORD); weak
// int __fastcall read_rt_db(_DWORD); weak
// int __fastcall set_samba_config(_DWORD); weak
// int __fastcall fw_add_db(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall get_usbdev_list(_DWORD, _DWORD); weak
// int __fastcall get_hw_value(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_link_status(_DWORD, _DWORD); weak
// int __fastcall wireless_api_get_max_mbss(_DWORD); weak
// int __fastcall syslog_save(_DWORD); weak
// int __fastcall delete_rt_entry_list(_DWORD, _DWORD, _DWORD); weak
// int __fastcall wireless_get_multibridge_enable(_DWORD); weak
// int __fastcall dhcpd_start(int a1);
// int __fastcall free_usbdev_list(_DWORD); weak
// int strcoll(const char *s1, const char *s2);
// int __fastcall pptpserver_set_config(_DWORD, _DWORD); weak
// int __fastcall _register_frame_info(_DWORD, _DWORD); weak
// int __fastcall syslog_get_status(_DWORD); weak
// int __fastcall dmztwinip_write_config(_DWORD, _DWORD); weak
// int __fastcall clear_active_wl(_DWORD); weak
// int __fastcall get_si(_DWORD, _DWORD); weak
// int __fastcall set_smtp_password(_DWORD); weak
// int __fastcall get_remote_addr(_DWORD); weak
// char *strtok_r(char *s, const char *delim, char **save_ptr);
// int __fastcall set_dhclient_block_private_ip(_DWORD); weak
// int __fastcall wireless_api_get_ap_list_from_tempfile(_DWORD); weak
// int __fastcall dhcpd_set_dns(_DWORD, _DWORD); weak
// int __fastcall get_pppoe_relay_enabled(_DWORD); weak
// int __fastcall istatus_set_intvalue_direct(_DWORD, _DWORD); weak
// int __fastcall set_nologin(_DWORD); weak
// int __fastcall set_autodns(_DWORD); weak
// int inet_aton(const char *cp, struct in_addr *inp);
// int __fastcall print_http_header(_DWORD); weak
// int __fastcall get_wansetup_status(_DWORD); weak
// int __fastcall set_client_login_trial_count_without_captchar(_DWORD); weak
// int __fastcall netdetect_set_portrange_and_monitorlevel(_DWORD, _DWORD); weak
// int __fastcall tc_count_file_read(_DWORD); weak
// int __fastcall set_csrf_op(_DWORD); weak
// int __fastcall syslog_get_email_status(_DWORD, _DWORD, _DWORD); weak
// int __fastcall wireless_api_start_ap_scan(_DWORD); weak
// int __fastcall get_intvalue_post(int a1, int a2, int a3);
// int __fastcall dmztwinip_apply_dmz(_DWORD, _DWORD, _DWORD); weak
// int __fastcall make_virtual_host_page(_DWORD); weak
// char *getenv(const char *name);
// int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD); weak
// size_t fwrite(const void *ptr, size_t size, size_t n, FILE *s);
// const unsigned __int16 **_ctype_b_loc(void);
// int __fastcall get_plantynet_freedevice_num(_DWORD); weak
// int system(const char *command);
// int __fastcall iconfig_set_value_direct(_DWORD, _DWORD); weak
// int __fastcall set_dhcp_access_policy(_DWORD); weak
// int __fastcall get_mysql_config(_DWORD); weak
// int __fastcall trunk_read_config(_DWORD, _DWORD, _DWORD); weak
// int __fastcall free_mount_list(_DWORD); weak
// int __fastcall get_iptv_config(_DWORD); weak
// int __fastcall get_wbm_popup_flag(_DWORD); weak
// int __fastcall get_ipmac_bind(_DWORD); weak
// int __fastcall set_led_silent_control(_DWORD); weak
// int __fastcall ifup(_DWORD); weak
// int __fastcall macdb_read(_DWORD, _DWORD); weak
// int __fastcall get_wan_ifname(_DWORD, _DWORD); weak
// int __fastcall get_ip_by_hwaddr(_DWORD, _DWORD); weak
// int __fastcall get_plantynet_status(_DWORD); weak
// void *memcpy(void *dest, const void *src, size_t n);
// int __fastcall get_system_running_time(_DWORD); weak
// int __fastcall get_wan_type(_DWORD, _DWORD); weak
// int __fastcall set_csrf_whites(_DWORD); weak
// int __fastcall get_hwaddr_cloned(_DWORD, _DWORD); weak
// int __fastcall quote_r(_DWORD, _DWORD); weak
// int __fastcall clear_hostscan_log(_DWORD); weak
// int __fastcall get_apache_config(_DWORD); weak
// int __fastcall set_wireless_conf(_DWORD, _DWORD); weak
// int __fastcall ddnsapi_get_refresh_flag(_DWORD); weak
// int __fastcall iconfig_get_intvalue_direct(_DWORD); weak
// int __fastcall tc_mode_get(_DWORD); weak
// int __fastcall get_ip_value(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_hwaddr_by_ip(int a1, int a2);
// int __fastcall get_http_auth_method(_DWORD); weak
// int __fastcall get_hostinfo_from_bridge(_DWORD, _DWORD, _DWORD); weak
// unsigned int sleep(unsigned int seconds);
// int __fastcall init_fw_rule(_DWORD); weak
// int __fastcall dmztwinip_read_config(_DWORD, _DWORD); weak
// int __fastcall remove_user_system(_DWORD, _DWORD); weak
// int __fastcall get_hostinfo_from_arp(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_hwaddr_kernel(_DWORD, _DWORD); weak
// int __fastcall read_wireless_conf(_DWORD, _DWORD); weak
// int __fastcall delete_fw_rule(_DWORD, _DWORD); weak
// int __fastcall signal_save(_DWORD); weak
// int __fastcall get_hwaddr_org(_DWORD, _DWORD); weak
// int __fastcall get_plantynet_service(_DWORD); weak
// int __fastcall accesslist_get_ip(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall local_gateway_is_default_gateway(_DWORD); weak
// int __fastcall get_url_redirect_option(_DWORD); weak
// int __fastcall get_timeserver_conf(_DWORD); weak
// int putchar(int c);
// int __fastcall signal_nas(_DWORD); weak
// int __fastcall set_torrent_config(_DWORD); weak
// int __fastcall set_dns_shadow(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall set_apache_config(_DWORD); weak
// int __fastcall wireless_api_get_ap_list(_DWORD); weak
// int set_iptv_config(void); weak
// int __fastcall get_url_redirect_usermsg(_DWORD); weak
// int __fastcall netdetect_set_on_off(_DWORD); weak
// char *strcat(char *dest, const char *src);
// int feof(FILE *stream);
// int __fastcall dhcpd_get_all_dynamic_lease(_DWORD, _DWORD); weak
// int __fastcall ddnsapi_remove_host(_DWORD); weak
// int __fastcall accesslist_iptables_cmd(_DWORD); weak
// int __fastcall read_dos_config(_DWORD); weak
// int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD); weak
// int __fastcall get_eport_stat(_DWORD, _DWORD); weak
// int __fastcall set_upnp(_DWORD); weak
// int __fastcall get_ftpd_config(_DWORD); weak
// int __fastcall set_http_auth_method(_DWORD); weak
// int __fastcall hwinfo_get_reboot_duration(_DWORD); weak
// int __fastcall malloc_syslog_msg_structure(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_urlsvc_config(_DWORD); weak
// int __fastcall wizard_api_set_mode(_DWORD); weak
// int __fastcall free_fw_list(_DWORD); weak
// int __fastcall tc_mode_set(_DWORD); weak
// int netdetect_get_virus_drop(void); weak
// int __fastcall wireless_api_get_station_list(_DWORD); weak
// int setenv(const char *name, const char *value, int replace);
// int strcasecmp(const char *s1, const char *s2);
// int __fastcall get_media_config(_DWORD); weak
// int __fastcall istatus_get_value_direct(_DWORD, _DWORD); weak
// int __fastcall decode_string(_DWORD); weak
// int __fastcall save_password(_DWORD, _DWORD); weak
// int __fastcall set_hwaddr_cloned(_DWORD, _DWORD); weak
// int __fastcall get_itunes_db_folder(_DWORD); weak
// void *malloc(size_t size);
// int __fastcall get_firmware_version2(_DWORD); weak
// int __fastcall syslog_convert_syslog_message(_DWORD, _DWORD); weak
// int __fastcall class_make_couple(_DWORD, _DWORD); weak
// int __fastcall send_system_reboot_signal(_DWORD); weak
// int __fastcall set_plantynet_service(_DWORD); weak
// int get_remote_mgmt_port(void); weak
// int httpcon_check_session_url(void); weak
// char *strrchr(const char *s, int c);
// int __fastcall strtomac(_DWORD, _DWORD); weak
// int __fastcall get_captcha(_DWORD, _DWORD); weak
// int strncmp(const char *s1, const char *s2, size_t n);
// int __fastcall is_valid_pf_ipv4(_DWORD); weak
// int set_autosaving(void); weak
// int __fastcall trunk_add_config(_DWORD, _DWORD); weak
// int __fastcall wireless_api_get_best_channel(_DWORD, _DWORD, _DWORD); weak
// int __fastcall fw_read_status(_DWORD, _DWORD); weak
// int _uClibc_main();
// int __fastcall get_plugin_status_package(_DWORD); weak
// int scandir(const char *dir, struct dirent ***namelist, int (*selector)(const struct dirent *), int (*cmp)(const void *, const void *));
// int __fastcall read_sched_array(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_dhcp_auto_detect_status(_DWORD); weak
// int __fastcall clear_url_redirection(_DWORD); weak
// int __fastcall set_port_config(_DWORD, _DWORD); weak
// int __fastcall iconv_to_utf8(_DWORD, _DWORD, _DWORD); weak
// int __fastcall set_dhcp_auto_detect(_DWORD); weak
// size_t strlen(const char *s);
// int __fastcall get_default_gateway(_DWORD, _DWORD); weak
// int __fastcall set_url_redirect_cycle(_DWORD); weak
// int __fastcall stop_hostscan(_DWORD); weak
// int __fastcall set_autoreboot_config(_DWORD); weak
// int __fastcall sysconf_nat_set(_DWORD, _DWORD); weak
// char *ctime(const time_t *timer);
// int __fastcall netdetect_set_burst_drop(_DWORD, _DWORD); weak
// int __fastcall set_url_redirect_autoconfirm(_DWORD); weak
// int __fastcall wds_remove(_DWORD, _DWORD); weak
// int __fastcall wireless_api_get_run(_DWORD); weak
// int __fastcall get_media_db_folder(_DWORD); weak
// int __fastcall set_admin_email(_DWORD); weak
// int stat(const char *file, struct stat *buf);
// int __fastcall get_smtp_auth(_DWORD); weak
// int __fastcall istatus_get_index_info_direct(_DWORD, _DWORD, _DWORD); weak
// int __fastcall print_popup_button(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall get_file_string(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_itunes_db_filename(_DWORD); weak
// int __fastcall pppoe_stop(_DWORD); weak
// int __fastcall get_firmup_status(_DWORD); weak
// int __fastcall set_ispfake(_DWORD, _DWORD); weak
// int __fastcall dhcpd_remove_static_lease(_DWORD, _DWORD); weak
// int __fastcall get_csrf_whites(_DWORD); weak
// int snprintf(char *s, size_t maxlen, const char *format, ...);
// int __fastcall convert_mac(_DWORD); weak
// int __fastcall signal_start(_DWORD); weak
// int __fastcall netdetect_write_option(_DWORD, _DWORD); weak
// int __fastcall portforward_update_by_file(_DWORD, _DWORD); weak
// int __fastcall set_smtp_account(_DWORD); weak
// int __fastcall delete_pf_rule(_DWORD, _DWORD); weak
// int __fastcall firewall_update_by_file(_DWORD, _DWORD, _DWORD); weak
// int make_auth(void); weak
// int __fastcall set_jumbo_frame_control(_DWORD); weak
// int __fastcall get_value_array(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int hwinfo_get_max_firmware_size(void); weak
// int __fastcall accesslist_already_regist(_DWORD, _DWORD); weak
// int __fastcall make_country_names(_DWORD); weak
// int init_pf_netfilter(void); weak
// int __fastcall get_idle_timeout(_DWORD); weak
// int __fastcall get_smtp_password(_DWORD); weak
// int __fastcall get_netaddr(_DWORD, _DWORD); weak
// int __fastcall hwinfo_get_mtu(_DWORD); weak
// int __fastcall set_firmupcheck_status(_DWORD); weak
// int __fastcall get_file_value(_DWORD, _DWORD); weak
// int __fastcall dhcpd_get_op(_DWORD); weak
// int __fastcall set_arp_protection(_DWORD, _DWORD, _DWORD); weak
// int get_cupsd_status(void); weak
// int __fastcall print_item(_DWORD, _DWORD); weak
// int __fastcall set_media_config(_DWORD); weak
// int __fastcall portforward_add_rule(_DWORD, _DWORD, _DWORD); weak
// int __cdecl add_rt_entry(_DWORD); weak
// int __fastcall init_url_redirection(_DWORD); weak
// int __fastcall dhclient_stop(_DWORD); weak
// int __fastcall set_cupsd_config(_DWORD); weak
// int __fastcall ddnsapi_read_config(_DWORD, _DWORD); weak
// int __fastcall check_valid_account(_DWORD); weak
// int __fastcall set_wbm_popup_flag(_DWORD); weak
// int __fastcall conv_time(_DWORD, _DWORD, _DWORD); weak
// int __fastcall convert_mac2(int a1);
// int __fastcall set_usb_tethering_op(_DWORD); weak
// int __fastcall dhcpd_set_op(_DWORD); weak
// int __fastcall get_nologin(int a1);
// int set_ftm_flag(void); weak
// int init_pf_rule(void); weak
// int __fastcall set_itunes_config(_DWORD); weak
// int __fastcall add_remotepc_config(_DWORD); weak
// int __fastcall dhcpd_flush_dynamic_lease(_DWORD); weak
// int __fastcall get_system_lang(_DWORD); weak
// int __fastcall str(_DWORD); weak
// int __fastcall check_plugin_installed(_DWORD, _DWORD); weak
// int __fastcall syslog_set_status(_DWORD); weak
// int __fastcall get_wan_link(_DWORD); weak
// int __fastcall httpcon_set_session_timeout(_DWORD); weak
// int __fastcall wireless_api_get_keyinfo_status(_DWORD); weak
// int __fastcall netdetect_set_option_rule(_DWORD, _DWORD); weak
// int __fastcall check_nas_service(_DWORD, _DWORD); weak
// int __fastcall print_html_apply_wait(_DWORD, _DWORD, _DWORD); weak
// int __fastcall validate_mac_addr(_DWORD); weak
// int __fastcall check_invalid_hwaddr(_DWORD); weak
// int smart_qos_mode_set(void); weak
// int __fastcall get_process_list(_DWORD, _DWORD, _DWORD); weak
// int __fastcall wireless_get_channel_list(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall ddnsapi_add_config(_DWORD); weak
// int __fastcall set_urlsvc_config(_DWORD); weak
// int __fastcall get_dhcp_access_policy(_DWORD); weak
// int fclose(FILE *stream);
// int syslog_clear(void); weak
// int __fastcall free_fw_status_list(_DWORD); weak
// int __fastcall syslog_decode_text(_DWORD, _DWORD); weak
// int __fastcall wireless_api_clear_mbridge_connection_status(_DWORD); weak
// int __fastcall set_default_gateway2(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall get_sniff_port(_DWORD); weak
// int set_pppoe_relay_enabled(void); weak
// int __fastcall get_autosaving(_DWORD); weak
// int __fastcall get_cupsd_config(_DWORD); weak
// int syslog_get_count(void); weak
// char *strncat(char *dest, const char *src, size_t n);
// int __fastcall istatus_get_intvalue_direct(int a1);
// int __fastcall get_wan_hw_ifname(_DWORD, _DWORD); weak
// FILE *fopen(const char *filename, const char *modes);
// int __fastcall get_wan_ipinfo(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall saveconf(_DWORD); weak
// int __fastcall check_unpermitted_chars(_DWORD); weak
// int __fastcall get_service_enable(_DWORD); weak
// int __fastcall get_value_post_multipart_file(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall get_led_silent_control(_DWORD); weak
// int __fastcall plantynet_service_event(_DWORD, _DWORD); weak
// int __fastcall macdb_search(_DWORD, _DWORD); weak
// int __fastcall max_bandwidth_set(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall get_fuse_fsname(_DWORD, _DWORD); weak
// int chmod(const char *file, __mode_t mode);
// int __fastcall smart_qos_mode_get(_DWORD); weak
// int __fastcall trunk_remove_config(_DWORD, _DWORD); weak
// int __fastcall get_filesize(_DWORD); weak
// int __fastcall get_dhcp_auto_detect(_DWORD); weak
// int __fastcall wireless_wps_stop_signal(_DWORD); weak
// int __fastcall validate_ipv4_addr(_DWORD); weak
// int __fastcall get_cupsd_printer_status(_DWORD); weak
// int __fastcall encode_ipcloud_crypt(_DWORD, _DWORD); weak
// int get_captcha_usage_type(void); weak
// int __fastcall get_manual_dns_flag(_DWORD, _DWORD); weak
// int __fastcall iconfig_get_value_direct(_DWORD, _DWORD); weak
// int __fastcall pptpserver_get_index_pptpinfo(_DWORD, _DWORD); weak
// time_t time(time_t *timer);
// int __fastcall get_pppoe_ifname(_DWORD, _DWORD); weak
// int __fastcall set_rsync_config(_DWORD); weak
// int __fastcall get_media_db_filename(_DWORD); weak
// int __fastcall get_samba_config(_DWORD); weak
// int __fastcall pptpserver_get_config(_DWORD, _DWORD); weak
// int __fastcall signal_wan(_DWORD); weak
// int __fastcall is_usb_removed(_DWORD); weak
// char *strtok(char *s, const char *delim);
// int __fastcall macauth_set_policy(_DWORD, _DWORD); weak
// int __fastcall set_wan_type(_DWORD, _DWORD); weak
// int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall netdetect_get_on_off(_DWORD); weak
// int __fastcall hwinfo_get_firmup_duration(_DWORD); weak
// int __fastcall get_value_post_multipart(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall free_syslog_msg_structure(_DWORD, _DWORD); weak
// int post_process(void); weak
// int __fastcall free_process_list(_DWORD); weak
// int __fastcall convert_url_to_new(_DWORD, _DWORD); weak
// int __fastcall get_apcplan_flag(_DWORD); weak
// int __fastcall get_arp_protection(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_autoreboot_config(_DWORD); weak
// int __fastcall get_timezone_abbr_from_config(_DWORD); weak
// int __fastcall print_start_main_table(_DWORD); weak
// int __fastcall set_mtu_value(_DWORD, _DWORD); weak
// int __fastcall set_smtp_server(_DWORD); weak
// int __fastcall class_create(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall set_upnp_relay(_DWORD); weak
// int __fastcall get_mount_devpath(_DWORD, _DWORD); weak
// int __fastcall read_real_ipclone_leasetime(_DWORD, _DWORD); weak
// int __fastcall iconv_to_local(_DWORD, _DWORD, _DWORD); weak
// int __fastcall set_timeserver_conf(_DWORD); weak
// int __fastcall get_ifconfig(int a1, int a2, int a3);
// int __fastcall etr(_DWORD); weak
// int __fastcall set_pppoe_status(_DWORD, _DWORD); weak
// int get_firmupcheck_status(void); weak
// int clear_port_statistics(void); weak
// int __fastcall dhcpd_get_dynamic_lease(_DWORD, _DWORD); weak
// int __fastcall print_sub_title(_DWORD, _DWORD); weak
// int __fastcall read_ftp_private_port(_DWORD, _DWORD); weak
// int __fastcall free_syslog_string(_DWORD); weak
// int __fastcall strtoupper(_DWORD); weak
// int netdetect_clear_all_history(void); weak
// int __fastcall set_hostname(_DWORD); weak
// int __fastcall stop_wan(_DWORD); weak
// int __fastcall netdetect_set_email_policy(_DWORD, _DWORD); weak
// int class_find(void); weak
// int __fastcall discover_upper_upnp_igd(_DWORD); weak
// int __fastcall get_url_redir_freedevice_num(_DWORD); weak
// int system2(const char *, ...); weak
// int __fastcall wireless_macauth_kickmac(_DWORD, _DWORD); weak
// int __fastcall macdb_free(_DWORD); weak
// int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD); weak
// char *fgets(char *s, int n, FILE *stream);
// int __fastcall write_wps_conf(_DWORD, _DWORD); weak
// int __fastcall set_device_removed(_DWORD, _DWORD); weak
// int __fastcall get_csrf_op(_DWORD); weak
// int __fastcall get_upnp_relay(_DWORD); weak
// int syslog_msg(_DWORD, const char *, ...); weak
// int __fastcall get_afp_config(_DWORD); weak
// int __fastcall wireless_reset_wps_status(_DWORD); weak
// int sscanf(const char *s, const char *format, ...);
// int __fastcall init_fw_netfilter(_DWORD); weak
// int __fastcall get_url_redirect_whitelist(_DWORD); weak
// int __fastcall sysconf_nat_get(_DWORD); weak
// int __fastcall malloc_syslog_string(_DWORD); weak
// int httpcon_auth(void); weak
// int __fastcall itoa_with_comma(_DWORD, _DWORD, _DWORD); weak
// char *strncpy(char *dest, const char *src, size_t n);
// int __fastcall convert_euckr_to_utf8(_DWORD, _DWORD); weak
// int __fastcall get_url_redirect_btnmsg(_DWORD); weak
// int __fastcall set_system_lang(_DWORD); weak
// int __fastcall get_plugin_status(_DWORD, _DWORD); weak
// int __fastcall read_portconfig(_DWORD, _DWORD); weak
// int __fastcall get_hostscan(_DWORD); weak
// int __fastcall set_url_redirect_btnmsg(_DWORD); weak
// int __fastcall set_hwaddr_kernel(_DWORD, _DWORD, _DWORD); weak
// int __fastcall set_remote_mgmt_flag(_DWORD); weak
// int __fastcall check_default_pass(_DWORD); weak
// int __fastcall get_dhclient_block_private_ip(_DWORD); weak
// int __cdecl filter_add_to_class(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall print_html_progress_bar(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_smtp_account(_DWORD); weak
// int __fastcall set_active_wl(_DWORD, _DWORD); weak
// int __fastcall apply_dos_config(_DWORD); weak
// int fputs(const char *s, FILE *stream);
// int __fastcall get_readable_sizestr(_DWORD, _DWORD); weak
// int __fastcall dhcpd_get_all_static_lease(_DWORD, _DWORD); weak
// int __fastcall wireless_apply_macauth(_DWORD, _DWORD); weak
// int __fastcall get_ipcloud_rand_str(_DWORD); weak
// int __fastcall set_router_mgmt_port(_DWORD); weak
// int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall write_ftp_private_port(_DWORD, _DWORD); weak
// int __fastcall print_nbsp(_DWORD); weak
// int __fastcall get_router_mgmt_port(_DWORD); weak
// int __fastcall ddnsapi_get_host_count(_DWORD); weak
// int __fastcall set_apcplan_flag(_DWORD); weak
// int __fastcall wireless_api_run_mbss(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_random_str(_DWORD, _DWORD); weak
// int __fastcall get_itunes_config(_DWORD); weak
// int __fastcall set_ftpd_config(_DWORD); weak
// int __fastcall Base64encode(_DWORD, _DWORD, _DWORD); weak
// int __fastcall print_end_main_table(_DWORD); weak
// int __fastcall fw_read_db(_DWORD, _DWORD); weak
// int sysget_ui_version(void); weak
// int __fastcall dhcpd_read_config(_DWORD); weak
// int __fastcall set_system_dns(_DWORD); weak
// int __fastcall iconfig_remove_config_tag(_DWORD); weak
// int get_igmp_proxy(void); weak
// int __fastcall dmztwinip_apply_off(_DWORD, _DWORD); weak
// int __fastcall remove_url_redir_freedevice(_DWORD); weak
// int unlink(const char *name);
// int __fastcall send_wol_packet(_DWORD); weak
// int __fastcall netdetect_comment_for_specified_port(_DWORD, _DWORD); weak
// int __fastcall set_url_redirect_usermsg(_DWORD); weak
// int __fastcall signal_reboot(_DWORD); weak
// int fflush(FILE *stream);
// int __fastcall nas_service_upnp_relay_init(_DWORD); weak
// int __fastcall pf_line_spchar_validate(_DWORD); weak
// void *memset(void *s, int c, size_t n);
// int tc_reconfig(void); weak
// int __fastcall get_localbroadaddr(_DWORD, _DWORD); weak
// int __fastcall macauth_get_policy(_DWORD); weak
// int __fastcall accesslist_add_ip(_DWORD, _DWORD, _DWORD, _DWORD); weak
// char *inet_ntoa(struct in_addr in);
// int __fastcall netdetect_get_history_by_index(_DWORD); weak
// int __fastcall add_url_redir_freedevice(_DWORD, _DWORD); weak
// int __fastcall ddnsapi_read_config_by_service_type(_DWORD, _DWORD, _DWORD); weak
// int __fastcall set_fakedns(_DWORD); weak
// int __fastcall get_usb_mode(_DWORD); weak
// int __fastcall read_pppoe_option(_DWORD, _DWORD); weak
// void qsort(void *base, size_t nmemb, size_t size, __compar_fn_t compar);
// int __fastcall portforward_remove_rules(_DWORD, _DWORD, _DWORD); weak
// int __fastcall wireless_check_8021x_enabled(_DWORD); weak
// int __fastcall hwinfo_get_max_macauth(_DWORD); weak
// int __fastcall set_nas_user_system(_DWORD, _DWORD); weak
// int __fastcall wireless_api_enable_bss(_DWORD, _DWORD); weak
// int __fastcall is_mobile_agent(_DWORD); weak
// int __fastcall clear_timed_status(_DWORD); weak
// int __fastcall get_macclone_in_giga(_DWORD); weak
// int __fastcall macdb_binary_search(_DWORD, _DWORD); weak
// int __fastcall print_item_desc(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall dhcpd_commit_config(_DWORD); weak
// int __fastcall br(_DWORD); weak
// int __fastcall add_plantynet_freedevice(_DWORD, _DWORD); weak
// int __fastcall wireless_api_get_mbridge_connection_status(_DWORD, _DWORD); weak
// int syslog_max_count(void); weak
// int __fastcall get_num_of_mountdev(_DWORD); weak
// int __fastcall get_active_wl(_DWORD, _DWORD, _DWORD); weak
// int fprintf(FILE *stream, const char *format, ...);
// int __fastcall is_factory_test_mode(_DWORD); weak
// int __fastcall accesslist_remove_ip(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_mtu_value(_DWORD, _DWORD); weak
// int __fastcall class_destroy(_DWORD); weak
// int __fastcall get_hw_value_post(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_url_redirect_autoconfirm(_DWORD); weak
// int __fastcall get_dhcp_auto_restart(_DWORD); weak
// int __fastcall dhcpd_add_static_lease(_DWORD, _DWORD); weak
// int __fastcall tc_count_file_write(_DWORD); weak
// in_addr_t inet_addr(const char *cp);
// int __fastcall wireless_api_stop_ap_scan(_DWORD); weak
// int init_tr_netfilter(void); weak
// int __fastcall hwinfo_get_conntrack_default(_DWORD); weak
// int __fastcall is_wds_enable(_DWORD); weak
// int __fastcall wireless_api_get_current_channelspec(_DWORD, _DWORD); weak
// int get_remote_mgmt_flag(void); weak
// int memcmp(const void *s1, const void *s2, size_t n);
// int __fastcall write_portconfig(_DWORD, _DWORD); weak
// int __fastcall set_use_local_gateway(_DWORD); weak
// int __fastcall accesslist_set_write_config(_DWORD); weak
// int __fastcall get_parameter_value(_DWORD, _DWORD); weak
// int __fastcall dhcpd_stop(_DWORD); weak
// int __fastcall get_upnp(_DWORD); weak
// int __fastcall start_hostscan(_DWORD); weak
// int __fastcall print_start_content_table(_DWORD); weak
// int __fastcall get_wireless_mode_by_ipaddr(_DWORD); weak
// int sprintf(char *s, const char *format, ...);
// int __fastcall get_ifexist(_DWORD); weak
// int __fastcall get_torrent_config(_DWORD); weak
// int __fastcall read_mbssid_conf(_DWORD, _DWORD); weak
// int __fastcall get_url_redirect_usermsg2(_DWORD); weak
// int __fastcall check_wan_connected(_DWORD); weak
// int __fastcall get_wan_ip(_DWORD, _DWORD); weak
// int __fastcall netdetect_get_email_policy(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_client_login_trial_count_without_captchar(_DWORD); weak
// int __fastcall set_firmup_status(_DWORD); weak
// int __fastcall get_dns_shadow(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall wds_get_config(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_mount_list(_DWORD, _DWORD); weak
// int __fastcall get_twinip_wan_virtual_ip(int a1);
// int __fastcall set_use_captcha_code(_DWORD); weak
// int __fastcall print_blank_line(_DWORD, _DWORD); weak
// int __fastcall file_exists(_DWORD); weak
// int __fastcall istatus_set_value_direct(_DWORD, _DWORD); weak
// int __fastcall get_domain_name_server(_DWORD, _DWORD); weak
// int __fastcall remove_remotepc_config(_DWORD); weak
// int __fastcall max_bandwidth_get(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall get_timeserver_list(_DWORD, _DWORD); weak
// int __fastcall portforward_modify_rule(_DWORD, _DWORD, _DWORD); weak
// int check_remote_connection(void); weak
// int __fastcall get_value_array_post(_DWORD, _DWORD); weak
// int __fastcall get_pvalue_array(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_use_local_gateway(_DWORD); weak
// int __fastcall wireless_get_wwan_enable(_DWORD); weak
// int __fastcall class_priority_order_write(_DWORD, _DWORD, _DWORD); weak
// int __fastcall set_wan_ipconfig(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall wireless_get_wps_status(_DWORD, _DWORD); weak
// int __fastcall netdetect_get_detect_port_range(_DWORD); weak
// int __fastcall collapse(_DWORD, _DWORD); weak
// int statfs(const char *file, struct statfs *buf);
// int __fastcall httpcon_get_session_timeout(_DWORD); weak
// int __fastcall set_wansetup_status(_DWORD, _DWORD); weak
// int __fastcall eth2wan(_DWORD, _DWORD); weak
// int __fastcall ddnsapi_get_status(_DWORD, _DWORD); weak
// int __fastcall check_ippool_range(_DWORD, _DWORD); weak
// int __fastcall signal_wps(_DWORD); weak
// int __fastcall defaultconf(int a1);
// int __fastcall get_remotepc_config(_DWORD, _DWORD); weak
// int __fastcall macauth_get_count(_DWORD); weak
// int __fastcall set_url_redirect_usermsg2(_DWORD); weak
// int __fastcall get_ispfake(_DWORD); weak
// int __fastcall wizard_api_set_status(_DWORD, _DWORD); weak
// int __fastcall set_mysql_config(_DWORD); weak
// int __fastcall set_smtp_auth(_DWORD); weak
// int __fastcall get_url_redir_freedevice(_DWORD, _DWORD, _DWORD); weak
// int __fastcall plantynet_service_request(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall remove_plantynet_freedevice(_DWORD); weak
// int __fastcall set_remote_mgmt_port(_DWORD); weak
// int get_usb_tethering_op(void); weak
// int __fastcall iconfig_set_intvalue_direct(_DWORD, _DWORD); weak
// int __fastcall set_usb_mode(_DWORD); weak
// int raise(int sig);
// int __fastcall get_url_redirect_cycle(_DWORD); weak
// int __fastcall add_gen_schedule(_DWORD, _DWORD); weak
// char *strstr(const char *haystack, const char *needle);
// int __fastcall check_wireless_ifrun(_DWORD); weak
// int __fastcall wizard_api_get_status(_DWORD, _DWORD); weak
// int __fastcall check_wifi_regulation(_DWORD); weak
// int __fastcall wireless_api_get_mbridge_status(_DWORD, _DWORD); weak
// int __fastcall get_subnet_range(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int strcmp(const char *s1, const char *s2);
// int __fastcall tethering_is_running(_DWORD); weak
// int __fastcall set_macclone_in_giga(_DWORD); weak
// int __fastcall get_smtp_server(_DWORD); weak
// int __fastcall wireless_api_add_mbss(_DWORD, _DWORD, _DWORD); weak
// int __fastcall set_lan_ipconfig(_DWORD, _DWORD, _DWORD); weak
// int __fastcall maccmp(_DWORD, _DWORD); weak
// int __fastcall pptpserver_add_user(_DWORD); weak
// int netdetect_get_burst_drop(void); weak
// int __fastcall get_nas_user(_DWORD, _DWORD, _DWORD); weak
// int __fastcall check_unpermitted_password_chars(_DWORD); weak
// int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD); weak
// int __fastcall set_url_redirect_option(_DWORD, _DWORD); weak
// int __fastcall fw_delete_rules(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall wireless_api_get_ifname(_DWORD, _DWORD); weak
// int __fastcall get_led_silent_state(_DWORD); weak
// int __fastcall syslog_set_email_status(_DWORD, _DWORD); weak
// int __fastcall insert_tr_to_rule(_DWORD, _DWORD); weak
// int __fastcall wireless_set_wps_src(_DWORD); weak
// int __fastcall check_process(_DWORD); weak
// int __fastcall accesslist_set_read_config(_DWORD); weak
// int __fastcall ddnsapi_clear_status_by_service_type(_DWORD); weak
// int __fastcall write_rt_db(_DWORD); weak
// int __fastcall pptpserver_disconnect_user(_DWORD); weak
// int __fastcall netdetect_read_current_history(_DWORD); weak
// int __fastcall print_end_content_table(_DWORD); weak
// int __fastcall apply_jumbo_frame_control(_DWORD); weak
// void free(void *ptr);
// int __fastcall portforward_read_db(_DWORD, _DWORD); weak
// int atoi(const char *nptr);
// int __fastcall get_iptime_service_network(_DWORD); weak
// int netdetect_get_monitor_level(void); weak
// int __fastcall restore_backup_config(_DWORD); weak
// int __fastcall get_plantynet_freedevice(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_ux_lang(int a1);
// int __fastcall get_usb_tethering_status(_DWORD); weak
// int __fastcall check_same_network(_DWORD, _DWORD, _DWORD); weak
// char *strchr(const char *s, int c);
// int __fastcall dhcpd_search_static_lease(_DWORD, _DWORD); weak
// int __fastcall remove_all_gen_schedule(_DWORD); weak
// int set_ipmac_bind(void); weak
// int __fastcall dmztwinip_apply_twinip(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall signal_toggle(_DWORD); weak
// int syslog_set_sendmail(void); weak
// int __fastcall get_internet_connected_time(_DWORD); weak
// int __fastcall check_bandwidth_limitation(_DWORD); weak
// int __fastcall free_portforward_list(_DWORD); weak
// int __fastcall set_ifconfig(_DWORD); weak
// int __fastcall get_id_password(_DWORD, _DWORD); weak
// int printf(const char *format, ...);
// int __fastcall ddnsapi_set_refresh_flag(_DWORD, _DWORD); weak
// int __fastcall get_admin_email(_DWORD); weak
// int __fastcall unlock_file(int a1);
// int wireless_api_get_operation_mode(void); weak
// int __fastcall class_get(_DWORD); weak
// int __fastcall set_default_gateway(_DWORD, _DWORD); weak
// char *strdup(const char *s);
// int __fastcall signal_update(_DWORD); weak
// int __fastcall wireless_api_apply_mbssid(_DWORD); weak
// int __fastcall set_sniff_port(_DWORD); weak
// int __fastcall tc_close(_DWORD); weak
// int __fastcall write_wireless_conf(_DWORD, _DWORD); weak
// int __fastcall dhcpd_remove_dynamic_lease(_DWORD, _DWORD); weak
// int puts(const char *s);
// int __fastcall istatus_remove_tag_prefix(_DWORD); weak
// int __fastcall encode_crypt(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall write_file(_DWORD, _DWORD); weak
// int __fastcall get_jumbo_frame_control(_DWORD); weak
// int __fastcall fw_modify_db(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall set_dhcp_auto_restart(_DWORD, _DWORD); weak
// int __fastcall get_hostname(_DWORD); weak
// int __fastcall set_plugin_status(_DWORD, _DWORD); weak
// int __fastcall set_afp_config(_DWORD); weak
// int __fastcall check_default_gateway(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_firmupcheck_version(_DWORD); weak
// int __fastcall save_pppoe_option(_DWORD, _DWORD); weak
// int __fastcall strtolower(_DWORD); weak
// int __fastcall ddnsapi_remove_by_service_type(_DWORD); weak
// int __fastcall set_url_redirect_whitelist(_DWORD); weak
// int __fastcall get_ifstatus(_DWORD); weak
// int __fastcall set_domain_name_server(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_send_email(_DWORD); weak
// int __fastcall get_remotepc_num(_DWORD); weak
// int __fastcall tc_open(_DWORD); weak
// int __fastcall get_pppoe_status(_DWORD); weak
// int __fastcall print_file(_DWORD); weak
// int __fastcall syslog_read_syslog_msg(_DWORD, _DWORD); weak
// int __fastcall write_file_intval(_DWORD, _DWORD); weak
// int __fastcall set_manual_dns_flag(_DWORD, _DWORD, _DWORD); weak
// int __fastcall portforward_upnp_relay_init(_DWORD); weak
// int __fastcall set_nas_user(_DWORD, _DWORD, _DWORD); weak
// int __fastcall fw_spchar_validate(_DWORD); weak
// int __fastcall get_default_id_password(_DWORD, _DWORD); weak
// int __fastcall istatus_remove_status_tag(_DWORD); weak
// int __fastcall wds_add(_DWORD); weak
// int __fastcall get_lan_ipconfig(_DWORD, _DWORD, _DWORD); weak
// int __cdecl get_timed_status(_DWORD); weak
// char *strcpy(char *dest, const char *src);
// int __fastcall set_send_email(_DWORD); weak
// int __fastcall pptpserver_remove_user(_DWORD); weak
// int __fastcall lock_file(_DWORD); weak
// int __fastcall macdb_write(_DWORD, _DWORD); weak
// int __fastcall wireless_api_support_onlyb(_DWORD); weak
// int __fastcall _deregister_frame_info(_DWORD); weak
// int __fastcall check_twinip_enable(_DWORD); weak
// int __fastcall remove_captcha(_DWORD); weak
void sub_121A0();
int *sub_121E4();
FILE *__fastcall commit_process(int a1, int a2, const char *a3);
int __fastcall printTitleBarNNavi(int a1, int a2);
int __fastcall printMenu_(int menu); // idb
int __fastcall print_main_screen(int a1, const char *a2, int a3);
int (__fastcall *__fastcall real_function_init(int a1, int a2, int a3))(int);
int __fastcall print_flag_screen(const char **a1, const char *a2);
void __fastcall print_iframe(int a1, const char *a2, const char *a3);
int __fastcall print_RefreshOpener(int a1);
int __cdecl main(int argc, const char **argv, const char **envp);
int __fastcall parse_params(int a1, int a2);
void *__fastcall get_auth_type_string(int a1, int a2);
void *__fastcall get_enc_type_string(int a1, int a2);
int __fastcall readWirelessConf(int a1);
int __fastcall getStartAPScan(int a1);
int __fastcall sub_142AC(_DWORD *a1, _DWORD *a2, char *a3, int a4);
int __fastcall channel_select(int a1, int a2, int a3);
int __fastcall print_iframe_channelscan(int a1);
int __fastcall print_wireless_wizard_top(int a1, int a2, const char *a3);
int __fastcall print_wizard_top(int a1, int a2);
int __fastcall common_wl_wizard_finish(int a1);
int __fastcall common_wizard_finish(int a1);
int __fastcall common_wl_wizard_finish5g(int a1);
int __fastcall common_wizard_save(int a1);
const char *__fastcall get_country_string(const char *a1);
int __fastcall print_country_code_option(const char *a1);
void *__fastcall get_channelspec_str(int a1, int a2);
int __fastcall print_country_code_js(const char *a1);
signed int print_natoff_warning();
int __fastcall get_firmware_builddate(int a1, int a2);
signed int __fastcall timetostr(unsigned int a1, int a2, int a3);
int __fastcall get_wl_mode(int a1, int a2, int a3);
int __fastcall get_wl_mode_post(int a1, int a2, int a3);
int __fastcall print_alert(int a1);
int __fastcall print_hwadress_inputbox(int a1, const char *a2, int a3);
int __fastcall print_html_ip_address(int a1, _BYTE *a2, int a3);
char *__fastcall convert_auth_enc(const char *a1, int a2, signed int *a3, _DWORD *a4);
signed int __fastcall reconvert_auth_enc(int a1, int a2, char *a3);
int __fastcall print_mask(int a1, int a2, int a3, int a4, int a5);
int __fastcall print_mask_0(int a1, int a2, int a3);
int __fastcall print_message_box(int a1);
void *__fastcall getTags(const char *a1);
signed int __fastcall print_escape_str(const char *a1);
int return0();
signed int __fastcall load_ui(userInterface *a1);
void *get_image_dir();
void *add_image_prefix();
signed int __fastcall monthSelector(const char *a1);
int __fastcall selectLang(int a1, int a2);
int __fastcall langSelector2(int a1, int a2);
int __fastcall daySelector(const char *a1);
int __fastcall daySelectorFucked(const char *a1);
int __fastcall check_captcha_valid(int a1, const char *a2);
int __fastcall check_captcha_post(int a1);
int __fastcall get_iptimeddns_service_config(void *a1);
signed int __fastcall check_ddns_hostname(const char *a1);
int __fastcall check_pptp_account(const char *a1);
void *__fastcall getNowDayMonth(time_t a1, int a2);
signed int __fastcall getDayInfo(char *a1, time_t a2);
int __fastcall print_div_m_str(int a1, int a2, int a3);
int __fastcall print_div_m_etr(int a1);
int __fastcall print_js_file(int a1, int a2);
int __fastcall set_ux_text_common(int a1, int a2);
int __fastcall get_ux_text_common(int a1, int a2);
void __fastcall call_real_functions_of_router(int a1, int a2);
signed int __fastcall get_detail_menu_string(int a1, int a2, size_t a3);
signed int __fastcall print_menu_group(int a1, int a2, int a3);
int __fastcall sub_18C78(int a1, int a2);
int __fastcall real_function(int a1, int a2);
int __fastcall print_navi_sidemenu_basic(int a1);
int __fastcall print_navi_sidemenu_advance(int a1, int a2, int a3);
int __fastcall setTDWIDTH(int result, int a2);
int __fastcall print_navi_image(int a1, int a2, int a3, int a4);
int __fastcall print_navi_title(const char *a1, int a2);
int __fastcall print_detail_menu(int a1, int a2, const char *a3, int a4, int a5, int a6, int a7);
int sub_195F4();
int __fastcall print_system_end(int a1);
void *__fastcall get_internet_conn_type(const char *a1);
int __fastcall print_system_external_info(const char *a1);
int __fastcall print_system_firmware_info(int a1);
int __fastcall print_system_wireless_info(int a1);
int print_system_remotemgmt_info();
int sub_1A194();
int sub_1A1F4();
int print_iframe_system_info_status();
int system_info();
int __fastcall sub_1A434(char *a1, int a2);
int sub_1A53C();
unsigned int __fastcall sub_1A6D4(const char *a1, const char *a2);
signed int __fastcall sub_1A6F8(int a1, int a2, const char *a3);
int __fastcall select_work(int a1);
signed int __fastcall sub_1ACC8(int a1, _DWORD *a2);
int __fastcall sub_1AD1C(char *s2, int a2, int a3);
int sub_1AD68();
int __fastcall print_iframe_static_lease(int a1, signed int a2);
void __fastcall print_iframe_lan_pcinfo(int a1, int a2);
int __fastcall print_iframe_hiddenlansetup(int a1, int a2);
int print_iframe_hiddenlanstatus();
int netconf_lansetup();
int __fastcall sub_1CF90(int a1);
int print_login_setup();
int print_session_setup();
int print_admin_email();
int __fastcall print_iframe_hiddenloginsetup_0(int a1, int a2);
int sysconf_login();
int __fastcall sub_1E3AC(int a1, int a2, int a3);
int __fastcall sub_1E40C(const char *a1, int a2);
void *__fastcall auto_select_lang(const char *a1);
char *sub_1E5B0();
char *__fastcall sub_1E600(char *result, const char *a2, const char *a3, char a4, int a5);
char *__fastcall maekGMTData(int a1, int a2);
int __fastcall print_min_select(int a1, int a2, char *a3);
int print_hostname_table_sysconf();
int __fastcall print_iframe_sysconf_misc_configmgmt_submit(int a1, int a2);
FILE *__fastcall print_iframe_sysconf_misc_configmgmt_restore(int a1, int a2);
int print_configmgmt_table_sysconf();
int __fastcall print_autosaving_table_sysconf(int a1);
int print_ispfake_table_sysconf();
int __fastcall print_mgmt_prot_table_sysconf(int a1);
int __fastcall print_fakedns_table_sysconf(int a1);
int __fastcall print_dhcp_restart_form(const char *a1);
int print_dhcp_restart_table_sysconf();
int __fastcall print_nologin_table_sysconf(int a1);
int __fastcall print_wbmpopup_table_sysconf(int a1);
int __fastcall print_led_table_sysconf(int a1, int a2, int a3, int a4);
int __fastcall print_macclone_giga_sysconf(int a1);
int __fastcall print_hour_select(int a1, int a2, char *a3);
int print_auto_table_sysconf();
int print_usb_mode_table_sysconf();
int print_restart_table_sysconf();
int __fastcall print_apcplan_sysconf(int a1);
int print_hubapmode_table_sysconf();
int __fastcall print_upnp_table_sysconf(int a1);
int print_realtime_table_sysconf();
int lang_selector();
int __fastcall print_service_body_sysconf(const char *a1, int a2);
int __fastcall print_sysconf_misc_body(const char *a1, int a2, int a3);
int __fastcall apply_sysconf(int a1);
int print_iframe_upnp_sysconf_misc();
int print_iframe_sysconf_misc_realtime_status();
int __fastcall print_iframe_sysconf_misc(int a1, int a2);
int __fastcall print_sysconf_misc(int a1);
int __fastcall sysconf_misc(int a1, int a2);
int __fastcall print_iframe_sysconf_swupgrade_online_status(int a1, int a2);
int print_iframe_sysconf_swupgrade_manual_status();
int __fastcall sysconf_swupgrade(int a1);
int __fastcall sub_23BC4(int a1, int a2, const char *a3, int a4);
int __fastcall sub_23D1C(const char *a1, int a2, int a3);
int __fastcall sub_23E8C(int a1);
int __fastcall sub_23FEC(int a1, const char *a2, int a3);
int __fastcall sub_2414C(int a1, int a2, const char *a3);
int __fastcall sub_24300(int a1, _BYTE *a2, int a3);
int __fastcall netconf_wansetup_apply(int a1);
int __fastcall print_iframe_hiddenwanstatus(int a1, int a2);
int __fastcall print_iframe_hiddenwansetup(int a1, int a2);
int __fastcall print_iframe_netconfmacsearch(int a1, int a2);
int __fastcall print_wansetup_view(int a1, int a2);
int __fastcall print_wansetup_script(int a1);
int __fastcall netconf_wansetup(int a1);
int sub_266A8();
int sub_26704();
int __fastcall sub_267FC(int a1);
int __fastcall sub_26964(int a1);
int print_iframe_sysconf_syslog_setup();
int __fastcall print_iframe_sysconf_syslog_setup_status(int a1, int a2);
int print_iframe_sysconf_syslog_log();
int __fastcall print_iframe_sysconf_syslog_log_status(int a1);
int __fastcall print_iframe_sysconf_syslog_log_clear(int a1, int a2);
int sysconf_syslog();
int sysconf_syslog_0();
int __fastcall apply_hostscan(int a1);
int __fastcall apply_hostscan_0(int a1, int a2);
int __fastcall print_hostscan(int a1, int a2);
int print_iframe_hostscanlist();
int print_iframe_hostscanstatus();
int __fastcall print_iframe_hostscansubmit(int a1, int a2);
int __fastcall expertconf_hostscan(int a1);
int __fastcall sub_2845C(int a1, int a2);
signed int __fastcall sub_2847C(unsigned int a1, int a2);
int onoffswitch();
int sub_286D4();
int __fastcall sub_288A8(int a1);
int __fastcall print_iframe_wpsstatus_0(int a1, int a2);
int __fastcall sub_28B04(int a1, int a2, int a3, char a4, int a5);
char *__fastcall print_iframe_multibssid_0(int a1, int a2, int a3);
int __fastcall sub_28F2C(_DWORD *a1, _DWORD *a2, char *a3);
int __fastcall print_iframe_searchwireless(int a1, int a2);
int __fastcall print_iframe_multibssid(int a1, int a2);
int __fastcall print_iframe_hiddenwlsetup(int a1, int a2);
int __fastcall print_iframe_wpssubmit(int a1, int a2);
int __fastcall print_iframe_wpsstatus(int a1, int a2);
int print_iframe_wpssetup();
int __fastcall wirelessconf_basicsetup(int a1, int a2);
int __fastcall print_iframe_extendsetup(int a1, int a2);
signed int __fastcall wirelessconf_basicsetup_0(int a1, int a2);
int sub_2D044();
int __fastcall sub_2D07C(int a1, int a2);
int __fastcall sub_2D08C(int a1);
int __fastcall print_iframe_macauth_bss_list(int a1);
int __fastcall print_iframe_macauth_bss_list_submit(int a1, int a2, int a3);
int __fastcall print_iframe_macauth_dblist(int a1, int a2, int a3);
int __fastcall print_iframe_macauth_dblist_submit(int a1, int a2);
int __fastcall print_iframe_macauth_pcinfo(int a1, int a2, int a3);
void __fastcall print_iframe_macauth_pcinfo_status(int a1, int a2);
int __fastcall wirelessconf_macauth(int a1);
int sub_2EC90();
int __fastcall sub_2ECD4(int a1);
int __fastcall sub_2F6FC(int a1);
int __fastcall sub_2F778(const char *a1, int a2, int a3);
int __fastcall sub_2FAB0(int a1, int a2);
int __fastcall sub_2FB3C(int a1, int a2);
int __fastcall sub_2FBE4(int a1, int a2);
int __fastcall sub_2FC5C(int a1);
int sub_3000C();
int __fastcall sub_3001C(_DWORD *a1, int a2, char *a3, int a4);
int __fastcall sub_3059C(int a1);
int __fastcall print_iframe_apinfo_status(int a1);
int __fastcall print_iframe_mbridge_apply(int a1, int a2);
int __fastcall print_iframe_ap_list(int a1);
int __fastcall wirelessconf_multibridge(int a1);
int __fastcall print_init_name(int a1, int a2, int a3, int a4, int a5);
int __fastcall print_iframe_checkssid(int a1, int a2);
char *__fastcall get_init_name(int a1, char *a2, int a3, int a4, char *a5);
int __fastcall sub_31960(const char *a1, const char *a2, int a3);
int sub_31A34();
int __fastcall common_step0(int a1);
int __fastcall ap_step3(int a1);
int __fastcall ap_step4(int a1);
int __fastcall ap_step5(int a1);
int __fastcall ap_step6(int a1);
int __fastcall ap_step7(int a1);
int __fastcall ap_step8(int a1);
int __fastcall ap_step9(int a1);
int __fastcall getWifiStatus(int a1);
int __fastcall goReboot(int a1, int a2);
int __fastcall print_wireless_wizard(int a1);
int __fastcall printCheckSSID(int a1);
int __fastcall print_iframe_checkssid1(int a1);
_BYTE *__fastcall sub_332F8(_BYTE *result);
int sub_33320();
int sub_33358();
int sub_33378();
int sub_33418();
int __fastcall sub_336F4(int result, int a2);
int __fastcall sub_33A44(int a1, int a2);
int __fastcall sub_33D18(int a1, int a2, int a3);
const char *__fastcall sub_34390(const char *a1, const char *a2, int a3, signed int a4);
_DWORD *__fastcall sub_344C8(int a1);
int __fastcall sub_34C4C(int result);
int __fastcall sub_34C5C(int a1, int a2, int a3);
signed int __fastcall sub_34D98(const char *a1);
signed int __fastcall sub_34F6C(const char *a1);
int __fastcall sub_35030(int a1);
int __fastcall print_iframe_restore_portforward(int a1, int a2);
int __fastcall print_iframe_user_portforward(int a1, const char *a2);
int __fastcall print_iframe_upnp_portforward(int a1, const char *a2);
int __fastcall print_iframe_tirgger_portforward(int a1);
FILE *__fastcall preferenceReset(int a1, int a2);
signed int __fastcall natrouterconf_portforward(int a1);
signed int __fastcall sub_372D8(const char *a1, int a2);
signed int __fastcall sub_37334(int a1);
int __fastcall print_iframe_natrouterconf_router_status(int a1, int a2);
int print_iframe_natrouterconf_router_list();
int __fastcall print_iframe_natrouterconf_router_setup(int a1, int a2);
int natrouterconf_router();
int __fastcall sub_37E5C(int a1, int a2, int a3);
int __fastcall sub_37EBC(const char *a1, int a2);
int __fastcall sub_37FA4(int a1);
int sub_385B0();
int __fastcall print_iframe_natrouterconf_misc_select(int a1);
int __fastcall sub_38D24(const char *a1);
int __fastcall sub_3920C(const char *a1, int a2);
int __fastcall sub_39274(int result, int a2, signed int a3, int a4);
int __fastcall sub_392E0(int a1);
int __fastcall print_iframe_natrouterconf_misc_submit(int a1, int a2);
int print_iframe_natrouterconf_misc_status();
int print_iframe_natrouterconf_misc();
int sub_39BE8();
int sub_39DA8();
_BYTE *__fastcall sub_39E44(_BYTE *result);
int sub_39E6C();
int __fastcall sub_39EA4(unsigned int a1);
int sub_39F78();
int __fastcall sub_3A254(int a1, char *a2);
char *__fastcall sub_3A3C0(int a1);
char *__fastcall sub_3A54C(int a1, int a2);
signed int __fastcall sub_3A620(const char **a1, const char *a2);
char *__fastcall sub_3A678(int a1);
const char *__fastcall sub_3A6EC(char *src);
int __fastcall sub_3A754(int result);
const char *__fastcall sub_3A764(const char *a1, const char *a2, int a3, signed int a4);
void *__fastcall sub_3A89C(const char *a1);
int __fastcall sub_3B534(int a1, int a2, int a3);
int __fastcall sub_3BA78(int a1, int a2, int a3);
int __fastcall sub_3C3C8(int a1, int a2);
int __fastcall sub_3C414(int a1);
signed int __fastcall sub_3C448(const char *a1);
int __fastcall print_iframe_firewall(int a1, const char *a2);
int print_iframe_macsearch_firewall();
int __fastcall sub_3D33C(int a1, int a2);
FILE *__fastcall firmwareReset(int a1, int a2);
int __fastcall firewallconf_firewall(const char *a1);
int firewallconf_firewall_real(); // weak
int __fastcall firewallconf_firewall_real_2(const char *a1);
int __fastcall sub_3E4B0(int a1);
signed int __fastcall sub_3E4C0(int a1);
int __fastcall sub_3E5E8(const char *a1, int a2);
int __fastcall print_iframe_hasetup(int a1, int a2);
int __fastcall print_iframe_haext(int a1);
int __fastcall print_iframe_haint(int a1);
int __fastcall sub_3FA14(int a1);
signed int firewallconf_accesslist();
int __fastcall sub_40374(int a1, int a2, int a3, int a4);
int __fastcall sub_403F8(int a1, int a2);
int __fastcall sub_404A8(int a1);
int __fastcall sub_40800(const char *a1);
int __fastcall sub_40850(int a1);
int __fastcall sub_4095C(int a1);
int __fastcall sub_409D0(int a1, int a2, int a3, int a4);
int __fastcall sub_40FFC(int a1, int a2);
int __fastcall sub_41074(int a1, int a2);
int __fastcall sub_416A4(int a1, int a2);
int print_iframe_trafficconf_qos_menu();
int __fastcall print_iframe_trafficconf_qos_menu_status(int a1);
int print_iframe_trafficonf_qos_list();
int __fastcall print_iframe_trafficonf_qos_list_status(int a1, int a2);
int __fastcall print_iframe_trafficconf_qos_setup(int a1, int a2);
int __fastcall sub_428AC(const char *a1);
int __fastcall sub_43070(const char *a1, int a2);
int trafficconf_qos();
int __fastcall sub_43400(signed __int64 a1, char *a2);
FILE *__fastcall sub_434EC(int a1);
int sub_43A24();
int __fastcall sub_43A34(unsigned int a1, unsigned int a2, unsigned int a3, unsigned int a4, int a5);
int print_iframe_trafficconf_conninfo_info();
int print_iframe_trafficconf_conninfo_info_status();
int print_iframe_trafficconf_conninfo_total();
int print_iframe_trafficconf_conninfo_total_status();
signed int trafficconf_conninfo();
int __fastcall sub_44984(_DWORD *a1);
int __fastcall sub_449E4(_DWORD *a1);
int __fastcall sub_44A74(int a1);
int __fastcall sub_44B74(int a1);
int __fastcall sub_44D04(int a1);
int __fastcall sub_44DB4(int a1);
int sub_44F04();
int print_iframe_trafficconf_connctrl_connctrl();
int __fastcall print_iframe_connctrl_connctrl_status(int a1, int a2);
int sub_45390();
int print_iframe_trafficconf_connctrl_timeout();
int __fastcall print_iframe_trafficconf_connctrl_timeour_status(int a1, int a2);
signed int trafficconf_connctrl();
int print_iframe_switch_portmirror();
int __fastcall print_iframe_trafficconf_switch_portmirror_status(int a1, int a2);
int __fastcall sub_45E3C(int a1);
int sub_45EB8();
int print_iframe_trafficconf_switch_jumboframe();
int __fastcall print_iframe_trafficconf_switch_jumboframe_status(int a1, int a2);
int __fastcall sub_460E0(int a1, int a2);
int sub_461A0();
int print_iframe_trafficconf_switch_trunk();
int __fastcall print_iframe_trafficconf_switch_trunk_status(int a1, int a2);
int trafficconf_switch();
int __fastcall sub_46684(const char *a1, int a2, int a3);
int __fastcall sub_466C8(int a1, signed int a2);
int sub_46A24();
int print_iframe_trafficconf_linksetup_linksetup();
int __fastcall print_iframe_trafficconf_linksetup_linksetup_status(int a1, int a2);
signed int __fastcall sub_46F88(signed int result, int a2, _QWORD *a3);
int __fastcall sub_470AC(int a1, int a2, int a3, signed int a4);
int sub_472F4();
int print_iframe_trafficconf_linksetup_linkstat();
int print_iframe_trafficconf_linksetup_linkstat_status();
int __fastcall print_iframe_trafficconf_linksetup_linkstat_clear(int a1, int a2);
int print_iframe_trafficconf_linksetup_linkstatus();
int print_iframe_trafficconf_linksetup_linkstatus_status();
int trafficconf_linksetup();
int __fastcall firewallconf_netdetect(int a1);
int __fastcall virustotalJavascript(int a1);
int __fastcall portCheck(int a1);
int sub_49440();
int __fastcall print_iframe_expertconfmacsearch(int a1, int a2);
int __fastcall print_iframe_expertconfwollist(int a1, int a2);
int sub_49D08();
int experconf_remotepc();
void *__fastcall sub_4A108(const char *a1, int a2);
int __fastcall sub_4A318(int a1, int a2, int a3);
int sub_4A37C();
_BOOL4 __fastcall check_ddns_burst(int a1);
signed int __fastcall sub_4ACD8(int a1);
int __fastcall print_iframe_hiddenddnssetup(int a1, int a2);
int print_iframe_hiddenddnsstatus();
int expertconf_ddns();
int sub_4B8DC();
int __fastcall sub_4BA78(int a1);
int __fastcall print_iframe_hiddenpptpvpnsetup(int a1, int a2);
int print_iframe_hiddenpptpvpnstatus();
int __fastcall print_iframe_pptpvpn_accout(int a1, int a2);
int expertconf_pptpvpn();
int __fastcall sub_4C94C(int a1, int a2);
int __fastcall sub_4CB28(int a1, int a2, int a3);
int __fastcall sub_4CCE0(int a1);
int __fastcall setDNSSettings(int a1);
int __fastcall print_wizard(int a1);
int sub_4F32C();
signed int __fastcall sub_4F4C8(const char *a1);
char *__fastcall sub_4F514(int a1);
int __fastcall sub_4F8CC(int a1);
int __fastcall print_iframe_advertiseexlist(int a1, int a2);
int __fastcall print_iframe_hiddenadvertisesetup(int a1, int a2);
int expertconf_advertise();
int __fastcall redirectForMobile(int a1);
int __fastcall sub_50BF0(int a1);
int __fastcall sub_50E88(const char *a1, int a2);
int print_iframe_experconf_iptv_macgroup();
int __fastcall print_iframe_experconf_iptv_macgroup_status(int a1);
int __fastcall print_iframe_expertconf_iptv_setup_status(int a1, int a2);
int expertconf_iptv();
unsigned int __fastcall sub_51564(const char *a1, int a2);
int __fastcall sub_51604(int *a1, _DWORD *a2);
int print_iframe_nasconf_basic_device();
void __fastcall print_iframe_nasconf_basic_device_status(int a1, int a2, int a3);
int __fastcall print_iframe_nasconf_basic_device_submit(int a1, int a2);
char *__fastcall sub_51CDC(int a1, const char *a2);
int __fastcall sub_51D78(int a1, _DWORD *a2);
int print_iframe_nasconf_basic_storage();
void __fastcall print_iframe_nasconf_basic_storage_status(int a1, int a2, int a3);
int nasconf_basic();
int __fastcall sub_523A0(int a1, int a2, int a3);
int __fastcall getStatusScript(int a1, int a2);
int __fastcall dir_filter(int a1);
signed int __fastcall getStatus(int a1, int a2);
int getThetheringStatus();
signed int getCupsdStatus();
int __fastcall sub_5275C(int a1, int a2);
int __fastcall sub_527BC(int result, char *a2, int a3, _DWORD *a4);
int __fastcall sub_52934(int result, char *a2, int a3, _DWORD *a4);
int getIPDiskStatus();
char *__fastcall getFile(const char *a1);
signed int getMediaStatus();
signed int getiTunesStatus();
void *sub_533CC();
void *__fastcall sub_53454(const char *a1);
int ipcloudUnregister();
signed int __fastcall sub_5361C(int a1);
FILE *__fastcall sub_53724(int a1);
const char *__fastcall sub_538AC(int a1);
void __fastcall print_iframe_natrouteconf_router_setup(int a1);
int sub_55CD4();
int sub_55EA8();
int __fastcall sub_56130(int a1, int a2, int a3, char a4, int a5);
int sub_56394();
int sub_56788();
int sub_56D04();
int sub_56FCC();
int sub_573B4();
int sub_57778();
int sub_57A8C();
int sub_57E04();
int sub_58208();
int sub_585C0();
int sub_58750();
int print_iframe_basicapp_service_onusers();
int print_iframe_basicapp_service_onusers_status();
int __fastcall sub_58C04(const char *a1);
int __fastcall sub_58E98(const char *a1, int a2);
int __fastcall sub_58F28(int a1);
int __fastcall getNASStatus(int a1, int a2, int a3, int a4);
int __fastcall nasconf_service(int a1);
int __fastcall sub_59730(int a1);
int __fastcall print_iframe_plugin_setup(int a1);
int __fastcall plugin_setup(int a1);
int __fastcall sub_59C9C(int a1, int a2);
int __fastcall sub_59D08(int a1);
int __fastcall sub_59DF4(int a1, int a2, int a3);
int __fastcall print_iframe_plugin_install(int a1, int a2, int a3, int a4);
int __fastcall getPluginAction(int a1);
int __fastcall plugin_install(int a1);
signed int __fastcall sub_5A434(unsigned int a1);
signed int __fastcall sub_5A460(int a1, char *a2, int a3);
int sub_5A48C();
const char *__fastcall sub_5A56C(const char *a1);
FILE *__fastcall sub_5A62C(int a1, int a2);
int __fastcall sub_5AA9C(int a1);
void *__fastcall sub_5AB54(int a1, int a2);
int __fastcall sub_5AC44(int a1);
int sub_5AF1C();
int __fastcall firewallconf_plantynet(int a1);
unsigned int __fastcall sub_5B5A0(unsigned int result, unsigned int a2);
unsigned int __fastcall sub_5B648(unsigned int a1, unsigned int a2);
int __fastcall calc_mask(int a1, int a2);
int __fastcall sub_5B670(int result, unsigned int a2);
int __fastcall sub_5B744(int a1, unsigned int a2);
unsigned int __fastcall sub_5BA1C(unsigned int result, int a2, int a3, int a4, int a5, int a6, int (__fastcall *a7)(_DWORD, unsigned int));
int __fastcall sub_5BA40(int result);
unsigned int __fastcall sub_5BB1C(unsigned int result, unsigned int a2, unsigned int a3, unsigned int a4);
void __fastcall sub_5BF1C(int a1, int a2, int a3, unsigned int a4);
int __fastcall sub_5BF98(int result, int a2, int a3, unsigned int a4);
unsigned int __fastcall sub_5C130(unsigned int result);
unsigned int __fastcall sub_5C1DC(unsigned int a1, unsigned int a2, int a3, int a4);
unsigned int __fastcall sub_5C374(unsigned int a1, unsigned int a2, int a3, int a4);
unsigned int __fastcall sub_5C4D4(int a1);
int __fastcall sub_5C530(__int64 a1, __int64 a2);
int __fastcall sub_5C5B8(__int64 a1, __int64 a2, _QWORD *a3);
unsigned __int64 __fastcall sub_5C5F4(unsigned int a1, signed int a2, unsigned int a3, signed int a4);
signed int __fastcall sub_5CA58(unsigned int a1, unsigned int a2, unsigned int a3, unsigned int a4);
void term_proc();
// int __fastcall get_rsync_config(_DWORD); weak
// int __fastcall dhcpd_start(_DWORD); weak
// int __fastcall get_intvalue_post(_DWORD, _DWORD, _DWORD); weak
// int system(const char *command);
// int __fastcall get_hwaddr_by_ip(_DWORD, _DWORD); weak
// void *malloc(size_t size);
// int httpcon_check_session_url(void); weak
// int __uClibc_main(void); weak
// int hwinfo_get_max_firmware_size(void); weak
// int __fastcall convert_mac2(_DWORD); weak
// int __fastcall get_nologin(_DWORD); weak
// int __fastcall istatus_get_intvalue_direct(_DWORD); weak
// int post_process(void); weak
// int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD); weak
// int __fastcall system2(_DWORD); weak
// int httpcon_auth(void); weak
// int sysget_ui_version(void); weak
// int __fastcall get_twinip_wan_virtual_ip(_DWORD); weak
// int __fastcall defaultconf(_DWORD); weak
// int __fastcall get_ux_lang(_DWORD); weak
// int printf(const char *format, ...);
// int __fastcall unlock_file(_DWORD); weak

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_15180; // weak
_UNKNOWN loc_2A300; // weak
_UNKNOWN loc_3F480; // weak
_UNKNOWN loc_5B63C; // weak
_UNKNOWN loc_5B734; // weak
_UNKNOWN loc_5B8B8; // weak
_UNKNOWN loc_5BCB0; // weak
_UNKNOWN loc_5BD18; // weak
_UNKNOWN loc_5BD64; // weak
_UNKNOWN loc_5BD7C; // weak
_UNKNOWN loc_5C27C; // weak
_UNKNOWN loc_5C30C; // weak
_UNKNOWN loc_5C354; // weak
_UNKNOWN loc_5C368; // weak
_UNKNOWN loc_5C56C; // weak
_UNKNOWN unk_5DE8C; // weak
_UNKNOWN unk_5E725; // weak
_UNKNOWN unk_5E7E8; // weak
_UNKNOWN unk_5E7E9; // weak
_UNKNOWN wpapsk; // weak
_UNKNOWN wpa; // weak
_UNKNOWN unk_78CB3; // weak
_UNKNOWN unk_79558; // weak
_UNKNOWN unk_7ACE6; // weak
_UNKNOWN unk_7B3ED; // weak
_UNKNOWN unk_7CD7A; // weak
_UNKNOWN unk_7D215; // weak
_UNKNOWN unk_7D21A; // weak
_UNKNOWN unk_7D222; // weak
_UNKNOWN unk_7DBFA; // weak
_UNKNOWN unk_7EB54; // weak
_UNKNOWN unk_7F939; // weak
_UNKNOWN unk_7FF8C; // weak
_UNKNOWN unk_8031F; // weak
_UNKNOWN unk_814D3; // weak
_UNKNOWN unk_8178D; // weak
_UNKNOWN unk_82FE6; // weak
_UNKNOWN unk_830D4; // weak
_UNKNOWN unk_84A2A; // weak
_UNKNOWN unk_84A37; // weak
_UNKNOWN unk_84CE6; // weak
_UNKNOWN unk_84F00; // weak
_UNKNOWN unk_85213; // weak
_UNKNOWN unk_852A7; // weak
_UNKNOWN unk_85714; // weak
_UNKNOWN unk_86952; // weak
_UNKNOWN unk_86A15; // weak
_UNKNOWN unk_86DF7; // weak
_UNKNOWN unk_86ED8; // weak
_UNKNOWN unk_86F34; // weak
_UNKNOWN unk_87601; // weak
_UNKNOWN unk_88AA2; // weak
_UNKNOWN unk_88AF9; // weak
_UNKNOWN unk_88CC6; // weak
_UNKNOWN unk_8B0FA; // weak
_UNKNOWN unk_8B2C5; // weak
_UNKNOWN unk_8C413; // weak
_UNKNOWN unk_8C425; // weak
_UNKNOWN unk_8C452; // weak
_UNKNOWN unk_8C468; // weak
_UNKNOWN unk_8C4BD; // weak
_UNKNOWN unk_8C4C3; // weak
_UNKNOWN unk_8C4D0; // weak
_UNKNOWN unk_8C4E6; // weak
_UNKNOWN unk_8C59B; // weak
_UNKNOWN unk_8CCAC; // weak
_UNKNOWN unk_8D279; // weak
_UNKNOWN unk_8DC4A; // weak
_UNKNOWN unk_8DC4F; // weak
_UNKNOWN unk_8DEC5; // weak
_UNKNOWN unk_8DF0F; // weak
_UNKNOWN unk_8E3D9; // weak
_UNKNOWN unk_8EA38; // weak
_UNKNOWN unk_8EBC7; // weak
_UNKNOWN unk_8ED11; // weak
_UNKNOWN unk_8EE56; // weak
_UNKNOWN unk_8F6A3; // weak
_UNKNOWN unk_8F8B7; // weak
_UNKNOWN unk_8FC4B; // weak
_UNKNOWN unk_8FC4D; // weak
_UNKNOWN unk_920EA; // weak
_UNKNOWN unk_92928; // weak
_UNKNOWN unk_92ABB; // weak
_UNKNOWN unk_92B1F; // weak
_UNKNOWN unk_92C18; // weak
_UNKNOWN unk_93A2A; // weak
_UNKNOWN unk_93DF5; // weak
_UNKNOWN unk_940A7; // weak
_UNKNOWN unk_942B3; // weak
_UNKNOWN unk_947D9; // weak
_UNKNOWN unk_94D6E; // weak
_UNKNOWN unk_95032; // weak
_UNKNOWN unk_9510F; // weak
_UNKNOWN unk_9511B; // weak
_UNKNOWN unk_95124; // weak
_UNKNOWN unk_95360; // weak
_UNKNOWN unk_95E16; // weak
_UNKNOWN unk_9618D; // weak
_UNKNOWN unk_96236; // weak
_UNKNOWN unk_96318; // weak
_UNKNOWN unk_97610; // weak
_UNKNOWN unk_97FC1; // weak
_UNKNOWN unk_97FC6; // weak
_UNKNOWN unk_98524; // weak
_UNKNOWN unk_99CD9; // weak
_UNKNOWN unk_99E79; // weak
_UNKNOWN unk_9A072; // weak
_UNKNOWN unk_9A92C; // weak
_UNKNOWN unk_9B324; // weak
_UNKNOWN unk_9B71B; // weak
_UNKNOWN unk_9BAB0; // weak
_UNKNOWN unk_9BD46; // weak
_UNKNOWN unk_9C3EC; // weak
_UNKNOWN unk_9D189; // weak
_UNKNOWN unk_9D4AD; // weak
_UNKNOWN unk_9DE29; // weak
_UNKNOWN unk_9E9A0; // weak
_UNKNOWN unk_9EB2C; // weak
_UNKNOWN unk_9F3A2; // weak
_UNKNOWN unk_9F3C1; // weak
_UNKNOWN unk_9FD1B; // weak
_UNKNOWN unk_A021B; // weak
_UNKNOWN unk_A022C; // weak
_UNKNOWN unk_A0294; // weak
_UNKNOWN unk_A119C; // weak
_UNKNOWN unk_A22E2; // weak
_UNKNOWN unk_A2609; // weak
_UNKNOWN unk_A2794; // weak
_UNKNOWN unk_A2A2E; // weak
_UNKNOWN unk_A3405; // weak
_UNKNOWN unk_A39C2; // weak
_UNKNOWN unk_A3AF8; // weak
_UNKNOWN unk_A3F98; // weak
_UNKNOWN unk_A40C6; // weak
_UNKNOWN unk_A4387; // weak
_UNKNOWN unk_A57B8; // weak
_UNKNOWN unk_A5801; // weak
_UNKNOWN unk_A5804; // weak
_UNKNOWN unk_A592E; // weak
_UNKNOWN unk_A5931; // weak
_UNKNOWN unk_A5938; // weak
_UNKNOWN unk_A5944; // weak
_UNKNOWN unk_A93F9; // weak
_UNKNOWN unk_AA1E4; // weak
_UNKNOWN unk_AC7D8; // weak
_UNKNOWN unk_ACDA3; // weak
_UNKNOWN unk_AD262; // weak
_UNKNOWN unk_ADD83; // weak
_UNKNOWN unk_ADD97; // weak
_UNKNOWN unk_ADDA3; // weak
_UNKNOWN unk_ADE54; // weak
char aAbcdefghijklmn[65] = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"; // weak
_UNKNOWN unk_AECE5; // weak
_UNKNOWN unk_AF04A; // weak
_UNKNOWN unk_AF449; // weak
_UNKNOWN unk_AF783; // weak
_UNKNOWN unk_B00DD; // weak
_UNKNOWN unk_B01AA; // weak
_UNKNOWN unk_B041A; // weak
_UNKNOWN unk_B0956; // weak
_UNKNOWN unk_B09AF; // weak
_UNKNOWN unk_B09FB; // weak
_UNKNOWN unk_B0C26; // weak
_UNKNOWN unk_B0FD1; // weak
_UNKNOWN unk_B1017; // weak
_UNKNOWN unk_B1801; // weak
_UNKNOWN unk_B2B8F; // weak
_UNKNOWN unk_B2CE1; // weak
_UNKNOWN unk_B3414; // weak
_UNKNOWN unk_B49EC; // weak
_UNKNOWN unk_B4A35; // weak
_UNKNOWN unk_B4B05; // weak
_UNKNOWN unk_B4C58; // weak
_UNKNOWN unk_B4D75; // weak
_UNKNOWN unk_B4FEE; // weak
_UNKNOWN unk_B504B; // weak
_UNKNOWN unk_B529E; // weak
_UNKNOWN unk_B5E68; // weak
_UNKNOWN unk_B6047; // weak
_UNKNOWN unk_B61F8; // weak
_UNKNOWN unk_B68EF; // weak
_UNKNOWN unk_B81F2; // weak
_UNKNOWN unk_B86D7; // weak
_UNKNOWN unk_BA770; // weak
_UNKNOWN unk_BAE06; // weak
_UNKNOWN unk_BAF38; // weak
_UNKNOWN unk_BB1D8; // weak
_UNKNOWN unk_BB4C9; // weak
_UNKNOWN unk_BB601; // weak
_UNKNOWN unk_BB91B; // weak
_UNKNOWN unk_BBE72; // weak
int dword_C5008 = 0; // weak
char *off_C5B34[2] = { "Apr", "Aug" }; // weak
char *off_C5BAC[20] =
{
  "Apr",
  "Aug",
  "days",
  "Dec",
  "Feb",
  "Fri",
  "hours",
  "Jan",
  "Jul",
  "Jun",
  "Mar",
  "May",
  "minutes",
  "month",
  "Mon",
  "Trying to get system time from time server.",
  "Nov",
  "Oct",
  "Sat",
  "Sec"
}; // weak
char *off_C5C24[6] =
{
  " MAC: %d ",
  " ",
  " %d  ",
  "  ",
  "   MAC Learning . <br>        , <br>     .",
  "MAC Learning"
}; // weak
char *off_C76E8[15] =
{
  "MAC#: %d",
  "Input a explain",
  "Max %d",
  "Management port",
  "Control address learning function for all ports. This function is not for begginner.",
  "Address Learning",
  "Add",
  "Ethernet switch control",
  "Once a user access the internet, the user's browser will be redirected to the URL you listed",
  "Others on the exception list are excluded",
  "(Maximum 10 devices)",
  "Description",
  "Notice URL",
  "White list is the list defined connection to allow the IP address",
  "or domain is included in the notice page."
}; // weak
_UNKNOWN unk_C91AC; // weak
_UNKNOWN unk_C91B0; // weak
_UNKNOWN unk_C91B4; // weak
_UNKNOWN unk_C91B8; // weak
_UNKNOWN unk_C91BC; // weak
_UNKNOWN unk_C91C0; // weak
_UNKNOWN unk_C91C4; // weak
_UNKNOWN unk_C91C8; // weak
_UNKNOWN unk_C91CC; // weak
_UNKNOWN country_names; // weak
int stdout; // weak
char byte_C9464; // weak
_UNKNOWN unk_C9480; // weak
_UNKNOWN unk_C94C0; // weak
_UNKNOWN unk_C9500; // weak
_UNKNOWN unk_C9640; // weak
int ui_version; // weak
_UNKNOWN unk_C9744; // weak
_UNKNOWN unk_C9764; // weak
int dword_C9864; // weak
_UNKNOWN unk_C9868; // weak
int dword_C98E8; // weak
int dword_C98EC[]; // weak
_UNKNOWN unk_C98F0; // weak
_UNKNOWN unk_C98F4; // weak
_UNKNOWN unk_C98F8; // weak
_UNKNOWN unk_C98FC; // weak
_UNKNOWN unk_C9900; // weak
_UNKNOWN unk_C9908; // weak
_UNKNOWN unk_C990C; // weak
_UNKNOWN unk_C9910; // weak
_UNKNOWN unk_C9914; // weak
_UNKNOWN unk_C9918; // weak
_UNKNOWN unk_C991C; // weak
_UNKNOWN unk_C9924; // weak
_UNKNOWN unk_C9928; // weak
_UNKNOWN unk_C992C; // weak
_UNKNOWN unk_C9930; // weak
_UNKNOWN unk_C9934; // weak
_UNKNOWN unk_C9938; // weak
_UNKNOWN unk_C9940; // weak
_UNKNOWN unk_C9944; // weak
_UNKNOWN unk_C9948; // weak
_UNKNOWN unk_C994C; // weak
_UNKNOWN unk_C9950; // weak
_UNKNOWN unk_C9954; // weak
_UNKNOWN unk_C995C; // weak
_UNKNOWN unk_C9960; // weak
_UNKNOWN unk_C9964; // weak
_UNKNOWN unk_C9968; // weak
_UNKNOWN unk_C996C; // weak
_UNKNOWN unk_C9970; // weak
_UNKNOWN unk_C9978; // weak
_UNKNOWN unk_C997C; // weak
_UNKNOWN unk_C9980; // weak
_UNKNOWN unk_C9984; // weak
_UNKNOWN unk_C9988; // weak
_UNKNOWN unk_C998C; // weak
_UNKNOWN unk_C9994; // weak
_UNKNOWN unk_C9998; // weak
_UNKNOWN unk_C999C; // weak
_UNKNOWN unk_C99A0; // weak
_UNKNOWN unk_C99A4; // weak
_UNKNOWN unk_C99A8; // weak
_UNKNOWN unk_C99B0; // weak
_UNKNOWN unk_C99B4; // weak
_UNKNOWN unk_C99B8; // weak
_UNKNOWN unk_C99BC; // weak
_UNKNOWN unk_C99C0; // weak
_UNKNOWN unk_C99C4; // weak
_UNKNOWN unk_C99CC; // weak
_UNKNOWN unk_C99D0; // weak
_UNKNOWN unk_C99D4; // weak
_UNKNOWN unk_C99D8; // weak
_UNKNOWN unk_C99DC; // weak
_UNKNOWN unk_C99E0; // weak
_UNKNOWN unk_C99E8; // weak
_UNKNOWN unk_C99EC; // weak
_UNKNOWN unk_C99F0; // weak
_UNKNOWN unk_C99F4; // weak
_UNKNOWN unk_C99F8; // weak
_UNKNOWN unk_C99FC; // weak
_UNKNOWN unk_C9A04; // weak
_UNKNOWN unk_C9A08; // weak
_UNKNOWN unk_C9A0C; // weak
_UNKNOWN unk_C9A10; // weak
_UNKNOWN unk_C9A14; // weak
_UNKNOWN unk_C9A18; // weak
_UNKNOWN unk_C9A20; // weak
_UNKNOWN unk_C9A24; // weak
_UNKNOWN unk_C9A28; // weak
_UNKNOWN unk_C9A2C; // weak
_UNKNOWN unk_C9A30; // weak
_UNKNOWN unk_C9A34; // weak
_UNKNOWN unk_C9A3C; // weak
_UNKNOWN unk_C9A40; // weak
_UNKNOWN unk_C9A44; // weak
_UNKNOWN unk_C9A48; // weak
_UNKNOWN unk_C9A4C; // weak
_UNKNOWN unk_C9A50; // weak
_UNKNOWN unk_C9A58; // weak
_UNKNOWN unk_C9A5C; // weak
_UNKNOWN unk_C9A60; // weak
_UNKNOWN unk_C9A64; // weak
_UNKNOWN unk_C9A68; // weak
_UNKNOWN unk_C9A6C; // weak
_UNKNOWN unk_C9A74; // weak
_UNKNOWN unk_C9A78; // weak
_UNKNOWN unk_C9A7C; // weak
_UNKNOWN unk_C9A80; // weak
_UNKNOWN unk_C9A84; // weak
_UNKNOWN unk_C9A88; // weak
_UNKNOWN unk_C9A90; // weak
_UNKNOWN unk_C9A94; // weak
_UNKNOWN unk_C9A98; // weak
_UNKNOWN unk_C9A9C; // weak
_UNKNOWN unk_C9AA0; // weak
_UNKNOWN unk_C9AA4; // weak
_UNKNOWN unk_C9AAC; // weak
_UNKNOWN unk_C9AB0; // weak
_UNKNOWN unk_C9AB4; // weak
_UNKNOWN unk_C9AB8; // weak
_UNKNOWN unk_C9ABC; // weak
_UNKNOWN unk_C9AC0; // weak
_UNKNOWN unk_C9AC8; // weak
_UNKNOWN unk_C9ACC; // weak
_UNKNOWN unk_C9AD0; // weak
_UNKNOWN unk_C9AD4; // weak
_UNKNOWN unk_C9AD8; // weak
_UNKNOWN unk_C9ADC; // weak
_UNKNOWN unk_C9AE4; // weak
_UNKNOWN unk_C9AE8; // weak
_UNKNOWN unk_C9AEC; // weak
_UNKNOWN unk_C9AF0; // weak
_UNKNOWN unk_C9AF4; // weak
_UNKNOWN unk_C9AF8; // weak
_UNKNOWN unk_C9B00; // weak
_UNKNOWN unk_C9B04; // weak
_UNKNOWN unk_C9B08; // weak
_UNKNOWN unk_C9B0C; // weak
_UNKNOWN unk_C9B10; // weak
_UNKNOWN unk_C9B14; // weak
_UNKNOWN unk_C9B1C; // weak
_UNKNOWN unk_C9B20; // weak
_UNKNOWN unk_C9B24; // weak
_UNKNOWN unk_C9B28; // weak
_UNKNOWN unk_C9B2C; // weak
_UNKNOWN unk_C9B30; // weak
_UNKNOWN unk_C9B38; // weak
_UNKNOWN unk_C9B3C; // weak
_UNKNOWN unk_C9B40; // weak
_UNKNOWN unk_C9B44; // weak
_UNKNOWN unk_C9B48; // weak
_UNKNOWN unk_C9B4C; // weak
_UNKNOWN unk_C9B54; // weak
_UNKNOWN unk_C9B58; // weak
_UNKNOWN unk_C9B5C; // weak
_UNKNOWN unk_C9B60; // weak
_UNKNOWN unk_C9B64; // weak
_UNKNOWN unk_C9B68; // weak
_UNKNOWN unk_C9B70; // weak
_UNKNOWN unk_C9B74; // weak
_UNKNOWN unk_C9B78; // weak
_UNKNOWN unk_C9B7C; // weak
_UNKNOWN unk_C9B80; // weak
_UNKNOWN unk_C9B84; // weak
_UNKNOWN unk_C9B8C; // weak
_UNKNOWN unk_C9B90; // weak
_UNKNOWN unk_C9B94; // weak
_UNKNOWN unk_C9B98; // weak
_UNKNOWN unk_C9B9C; // weak
_UNKNOWN unk_C9BA0; // weak
_UNKNOWN unk_C9BA8; // weak
_UNKNOWN unk_C9BAC; // weak
_UNKNOWN unk_C9BB0; // weak
_UNKNOWN unk_C9BB4; // weak
_UNKNOWN unk_C9BB8; // weak
_UNKNOWN unk_C9BBC; // weak
_UNKNOWN unk_C9BC4; // weak
_UNKNOWN unk_C9BC8; // weak
_UNKNOWN unk_C9BCC; // weak
_UNKNOWN unk_C9BD0; // weak
_UNKNOWN unk_C9BD4; // weak
_UNKNOWN unk_C9BD8; // weak
_UNKNOWN unk_C9BE0; // weak
_UNKNOWN unk_C9BE4; // weak
_UNKNOWN unk_C9BE8; // weak
_UNKNOWN unk_C9BEC; // weak
_UNKNOWN unk_C9BF0; // weak
_UNKNOWN unk_C9BF4; // weak
_UNKNOWN unk_C9BFC; // weak
_UNKNOWN unk_C9C00; // weak
_UNKNOWN unk_C9C04; // weak
_UNKNOWN unk_C9C08; // weak
_UNKNOWN unk_C9C0C; // weak
_UNKNOWN unk_C9C10; // weak
_UNKNOWN unk_C9C18; // weak
_UNKNOWN unk_C9C1C; // weak
_UNKNOWN unk_C9C20; // weak
_UNKNOWN unk_C9C24; // weak
_UNKNOWN unk_C9C28; // weak
_UNKNOWN unk_C9C2C; // weak
_UNKNOWN unk_C9C34; // weak
_UNKNOWN unk_C9C38; // weak
_UNKNOWN unk_C9C3C; // weak
_UNKNOWN unk_C9C40; // weak
_UNKNOWN unk_C9C44; // weak
_UNKNOWN unk_C9C48; // weak
_UNKNOWN unk_C9C50; // weak
_UNKNOWN unk_C9C54; // weak
_UNKNOWN unk_C9C58; // weak
_UNKNOWN unk_C9C5C; // weak
_UNKNOWN unk_C9C60; // weak
_UNKNOWN unk_C9C64; // weak
_UNKNOWN unk_CA3DC; // weak
_UNKNOWN unk_CA45C; // weak
_UNKNOWN unk_CA49C; // weak
char byte_CA4DC[]; // weak
_UNKNOWN unk_CA4E2; // weak
_UNKNOWN unk_CA4F1; // weak
_UNKNOWN unk_CA4F7; // weak
_UNKNOWN unk_CA506; // weak
_UNKNOWN unk_CA50C; // weak
_UNKNOWN unk_CA51B; // weak
_UNKNOWN unk_CA521; // weak
_UNKNOWN unk_CA530; // weak
_UNKNOWN unk_CA536; // weak
_UNKNOWN unk_CA545; // weak
_UNKNOWN unk_CA54B; // weak
_UNKNOWN unk_CA55A; // weak
_UNKNOWN unk_CA560; // weak
_UNKNOWN unk_CA56F; // weak
_UNKNOWN unk_CA575; // weak
char byte_CA584[]; // weak
_UNKNOWN unk_CA594; // weak
_UNKNOWN unk_CA5A4; // weak
_UNKNOWN unk_CA5B4; // weak
_UNKNOWN unk_CA5C4; // weak
_UNKNOWN unk_CA5D4; // weak
_UNKNOWN unk_CA5E4; // weak
_UNKNOWN unk_CA5F4; // weak
int dword_CA614; // weak
int dword_CA618; // weak
_UNKNOWN unk_CA61C; // weak
char byte_CA6DC[128]; // idb
_UNKNOWN unk_CA75C; // weak
_UNKNOWN unk_CA7DC; // weak
_UNKNOWN unk_CA8DC; // weak
int dword_CA95C; // weak
int (__fastcall *dword_CA960)(_DWORD); // weak
int (__fastcall *dword_CA964)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int dword_CA968; // weak
int dword_CA96C; // weak
int dword_CA970; // weak
int dword_CA974; // weak
int dword_CA978; // weak
int (__fastcall *dword_CA97C)(_DWORD); // weak
char byte_CA980[4032]; // idb


//----- (00010394) --------------------------------------------------------
void init_proc()
{
  ;
}

//----- (00012164) --------------------------------------------------------
#error "12170: positive sp value has been found (funcsize=3)"

//----- (000121A0) --------------------------------------------------------
void sub_121A0()
{
  if ( !byte_C9464 )
    byte_C9464 = 1;
}
// 12140: using guessed type int __fastcall _deregister_frame_info(_DWORD);
// C9464: using guessed type char byte_C9464;

//----- (000121E4) --------------------------------------------------------
int *sub_121E4()
{
  return &dword_C5008;
}
// 10484: using guessed type int __fastcall _register_frame_info(_DWORD, _DWORD);
// C5008: using guessed type int dword_C5008;

//----- (00012238) --------------------------------------------------------
FILE *__fastcall commit_process(int a1, int a2, const char *a3)
{
  int v3; // r4@1
  int v4; // r6@1
  const char *v5; // r5@1
  FILE *result; // r0@11
  int v7; // [sp+0h] [bp-38h]@4

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( !strcmp(a3, "current_wireless") )
    readWirelessConf(v3);
  if ( !strcmp(v5, "wireless_scan_start") )
  {
    get_value(v3, "ifname", &v7, 32);
    getStartAPScan((int)&v7);
  }
  if ( !strcmp(v5, "manual_config_wizard") )
    setDNSSettings(v3);
  if ( !strcmp(v5, "manual_wireless_wizard") )
    getWifiStatus(v3);
  if ( !strcmp(v5, "pf_restore") )
    preferenceReset(v3, v4);
  result = (FILE *)strcmp(v5, "fw_restore");
  if ( !result )
    result = firmwareReset(v3, v4);
  return result;
}
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00012338) --------------------------------------------------------
int __fastcall printTitleBarNNavi(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r6@1
  int v4; // r1@3
  int result; // r0@6
  const char *v6; // r0@9
  int v7; // r0@13
  int v8; // r1@19
  int v9; // [sp+0h] [bp-180h]@17
  char v10; // [sp+100h] [bp-80h]@1
  char s1; // [sp+180h] [bp+0h]@1
  char v12; // [sp+200h] [bp+80h]@15
  char v13; // [sp+220h] [bp+A0h]@15

  v2 = a2;
  v3 = a1;
  strcpy(&s1, "");
  strcpy(&v10, "");
  if ( v2 )
  {
    get_value_post(v2, "tmenu", &s1, 127);
    get_value_post(v2, "smenu", &v10, 127);
  }
  else
  {
    v4 = get_parameter_value(v3, "tmenu");
    if ( v4 )
      sf_strncpy(&s1, v4, 128);
    v8 = get_parameter_value(v3, "smenu");
    if ( v8 )
      sf_strncpy(&v10, v8, 128);
  }
  result = strcmp(&s1, "menu_titlebar");
  if ( !result )
    return result;
  result = strcmp(&s1, "navi_titlebar");
  if ( !result )
    return result;
  if ( !strcmp(&s1, "titlebar") )
  {
    v6 = "/home/httpd/js/toptitle.js";
  }
  else if ( !strcmp(&s1, "navi_menu_basic") || !strcmp(&s1, "navi_menu_advance") )
  {
    v6 = "/home/httpd/js/navimenu.js";
  }
  else
  {
    print_file("/home/httpd/js/navimenu.js");
    print_js_file((int)"string", 0);
    v7 = print_js_file((int)"common", 0);
    if ( dword_CA97C )
      dword_CA97C(v7);
    get_netaddr("br0", &v13);
    get_localbroadaddr("br0", &v12);
    puts("<script>");
    printf(
      "function CheckIPNetworkObj(ifr,ip)\n"
      "\t\t{\n"
      "\t\t\tfor( i = 1 ; i <= 4 ; i++ )\t\t\t\tif( ifr.document.getElementsByName(ip+i)[0].value == '' )\t\t\t\t\treturn"
      " 0;\t\t\tip1=Number(ifr.document.getElementsByName(ip+1)[0].value);\t\t\tip2=Number(ifr.document.getElementsByName"
      "(ip+2)[0].value);\t\t\tip3=Number(ifr.document.getElementsByName(ip+3)[0].value);\t\t\tip4=Number(ifr.document.get"
      "ElementsByName(ip+4)[0].value);\t\t\tipstr = ip1+'.'+ip2+'.'+ip3+'.'+ip4;\t\t\tif( ipstr == '%s')\t\t\t{\t\t\t\tre"
      "turn ifr.document.getElementsByName(ip+4)[0];\t\t\t}\t\t\tif( ipstr == '%s')\t\t\t{\t\t\t\treturn ifr.document.get"
      "ElementsByName(ip+4)[0];\t\t\t}\t\t\treturn 0;\t\t}\n"
      "\n",
      &v13,
      &v12);
    printf(
      "function CheckIPNetwork(ip)\n"
      "\t\t{\n"
      "\t\t\tfor( i = 1 ; i <= 4 ; i++ )\t\t\t\tif( document.getElementsByName(ip+i)[0].value == '' )\t\t\t\t\treturn 0;\t"
      "\t\tip1=Number(document.getElementsByName(ip+1)[0].value);\t\t\tip2=Number(document.getElementsByName(ip+2)[0].val"
      "ue);\t\t\tip3=Number(document.getElementsByName(ip+3)[0].value);\t\t\tip4=Number(document.getElementsByName(ip+4)["
      "0].value);\t\t\tipstr = ip1+'.'+ip2+'.'+ip3+'.'+ip4;\t\t\tif( ipstr == '%s')\t\t\t{\t\t\t\treturn document.getElem"
      "entsByName(ip+4)[0];\t\t\t}\t\t\tif( ipstr == '%s')\t\t\t{\t\t\t\treturn document.getElementsByName(ip+4)[0];\t\t\t"
      "}\t\t\treturn 0;\t\t}\n"
      "\n",
      &v13,
      &v12);
    puts("</script>");
    if ( !strcmp(&s1, "wizard") )
      print_file("/home/httpd/js/netconf.js");
    snprintf((char *)&v9, 0xFFu, "/home/httpd/js/%s.js", &s1);
    v6 = (const char *)&v9;
  }
  result = print_file(v6);
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10D18: using guessed type int __fastcall get_netaddr(_DWORD, _DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 116C0: using guessed type int __fastcall get_localbroadaddr(_DWORD, _DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 12068: using guessed type int __fastcall print_file(_DWORD);
// CA97C: using guessed type int (__fastcall *dword_CA97C)(_DWORD);

//----- (00012578) --------------------------------------------------------
int __fastcall printMenu_(int menu)
{
  int userInput; // r4@1
  const char *v2; // r0@1
  int v3; // r1@2
  int v4; // r0@3
  const char *v5; // r0@4
  char *v6; // r1@7
  const char *v7; // r0@7
  const char *v8; // r0@9
  int v9; // r0@15
  int v11; // [sp+0h] [bp-2C8h]@14
  char v12; // [sp+80h] [bp-248h]@14
  char dest; // [sp+1C0h] [bp-108h]@12

  userInput = menu;
  v2 = (const char *)get_parameter_value(menu, "helpmenu");
  if ( v2 && !strcmp(v2, "1") )
  {
    v4 = 630;
LABEL_7:
    v6 = (char *)get_ux_text_common(v4, v3);
    v7 = "<head><title>%s</title>\n";
    goto LABEL_8;
  }
  v5 = (const char *)get_parameter_value(userInput, "tmenu");// if user select tmenu
  if ( v5 && !strcmp(v5, "wizard") )
  {
    v4 = 1698;
    goto LABEL_7;
  }
  v8 = (const char *)get_parameter_value(userInput, "tmenu");
  if ( v8 && !strcmp(v8, "wirelesswizard") )
  {
    v4 = 1597;
    goto LABEL_7;
  }
  strcpy(&dest, "");
  get_hostname(&dest);
  if ( !dest )
  {
    get_si("pi", &v11);
    printf("<head><title>%s %s</title>\n", &v12, &v11);
    goto LABEL_15;
  }
  v7 = "<head><title>%s</title>\n";
  v6 = &dest;
LABEL_8:
  printf(v7, v6);
LABEL_15:
  printf("<meta name=\"format-detection\" content=\"telephone=no\">");
  v9 = printf("<style>");
  dword_CA960(v9);
  printf("</style>");
  return puts("</head>");
}
// 104B4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 11FB4: using guessed type int __fastcall get_hostname(_DWORD);
// CA960: using guessed type int (__fastcall *dword_CA960)(_DWORD);

//----- (000126C8) --------------------------------------------------------
int __fastcall print_main_screen(int a1, const char *a2, int a3)
{
  const char *v3; // r4@1
  int v4; // r5@1
  int v5; // r6@1
  const char *v6; // r0@1
  int v7; // r6@3
  int v8; // r0@3
  int v9; // r1@5
  int v10; // r0@5
  int v11; // r0@5
  int result; // r0@5
  int (__fastcall *v13)(int); // r7@6
  char v14[512]; // [sp+8h] [bp-2D8h]@3
  char s; // [sp+208h] [bp-D8h]@6
  char v16; // [sp+288h] [bp-58h]@3
  char dest; // [sp+2A8h] [bp-38h]@3

  v3 = a2;
  v4 = a1;
  v5 = a3;
  v6 = (const char *)get_parameter_value(a1, "saveconfig");
  if ( v6 && !strcmp(v6, "1") )
  {
    strcpy(&dest, "");
    strcpy(&v16, "");
    get_value(v4, "tmenu", &dest, 32);
    get_value(v4, "smenu", &v16, 32);
    v7 = snprintf(v14, 0x200u, "timepro.cgi?tmenu=%s&smenu=%s&savesave=1", &dest, &v16);
    v8 = strcmp(v3, "wirelessconf5g");
    if ( !v8 )
      v8 = snprintf(&v14[v7], 0x200u, "&wl_mode=1");
    print_start_main_table(v8);
    v10 = get_ux_text_common(1078, v9);
    v11 = print_html_apply_wait(v10, 2, v14);
    result = print_end_main_table(v11);
  }
  else
  {
    snprintf(&s, 128u, "%s_%s", v3, v5);
    v13 = (int (__fastcall *)(int))sub_18C78((int)v3, v5);
    result = return0();
    if ( !result && v13 )
      result = v13(v4);
  }
  return result;
}
// 10EC8: using guessed type int __fastcall print_html_apply_wait(_DWORD, _DWORD, _DWORD);
// 1121C: using guessed type int __fastcall print_start_main_table(_DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 115DC: using guessed type int __fastcall print_end_main_table(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 126C8: using guessed type char var_2D8[512];

//----- (00012820) --------------------------------------------------------
int (__fastcall *__fastcall real_function_init(int a1, int a2, int a3))(int)
{
  int v3; // r5@1
  int v4; // r4@1
  int v5; // r6@1
  int (__fastcall *result)(int); // r0@1
  char s; // [sp+8h] [bp-90h]@1

  v3 = a2;
  v4 = a3;
  v5 = a1;
  snprintf(&s, 0x80u, "%s_%s", a2, a3);
  result = (int (__fastcall *)(int))real_function(v3, v4);
  if ( result )
    result = (int (__fastcall *)(int))result(v5);
  return result;
}

//----- (00012874) --------------------------------------------------------
int __fastcall print_flag_screen(const char **a1, const char *a2)
{
  const char **v2; // r4@1
  const char *v3; // r5@1
  int result; // r0@1

  v2 = a1;
  v3 = a2;
  result = strcmp(*a1, "/ndbin/netdetect.cgi");
  if ( result )
    return result;
  result = check_remote_connection();
  if ( result )
    return result;
  result = netdetect_get_on_off(0);
  if ( !result )
    return result;
  if ( !strcmp(v3, "nd-warning") || strcmp(v3, "nd-report") )// unnormal approach
    result = virustotalJavascript((int)v2);
  else
    result = portCheck((int)v2);
  return result;
}
// 11198: using guessed type int __fastcall netdetect_get_on_off(_DWORD);
// 11A80: using guessed type int check_remote_connection(void);
// CA95C: using guessed type int dword_CA95C;

//----- (00012904) --------------------------------------------------------
void __fastcall print_iframe(int a1, const char *a2, const char *a3)
{
  int v3; // r4@1
  const char *v4; // r5@1
  const char *v5; // r6@1
  int v6; // r2@23
  int v7; // r3@23
  int v8; // r2@35
  int v9; // r2@37
  int v10; // r2@45
  int v11; // r2@141
  int v12; // r2@147

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( !strcmp(a3, "channelscan") )
  {
    print_iframe_channelscan(v3);
  }
  else if ( !strcmp(v5, "checkssid") )
  {
    printCheckSSID(v3);
  }
  else if ( !strcmp(v5, "multibssid") )
  {
    print_iframe_multibssid(v3, (int)v4);
  }
  else if ( !strcmp(v5, "basicsetup") )
  {
    wirelessconf_basicsetup(v3, (int)v4);
  }
  else if ( !strcmp(v5, "extendsetup") )
  {
    print_iframe_extendsetup(v3, (int)v4);
  }
  else if ( !strcmp(v5, "wpssetup") )
  {
    print_iframe_wpssetup();
  }
  else if ( !strcmp(v5, "wpssubmit") )
  {
    print_iframe_wpssubmit(v3, (int)v4);
  }
  else if ( !strcmp(v5, "wpsstatus") )
  {
    print_iframe_wpsstatus(v3, (int)v4);
  }
  else if ( !strcmp(v5, "hiddenwlsetup") )
  {
    print_iframe_hiddenwlsetup(v3, (int)v4);
  }
  else if ( !strcmp(v5, "wlsearch") )
  {
    print_iframe_searchwireless(v3, (int)v4);
  }
  else if ( !strcmp(v5, "nas_service") )
  {
    print_iframe_natrouteconf_router_setup(v3);
  }
  else if ( !strcmp(v5, "plugin_install") )
  {
    print_iframe_plugin_install(v3, (int)v4, v6, v7);
  }
  else if ( !strcmp(v5, "plugin_setup") )
  {
    print_iframe_plugin_setup(v3);
  }
  else if ( !strcmp(v5, "checkssid2") )
  {
    print_iframe_checkssid1(v3);
  }
  else if ( !strcmp(v5, "mbridgeapply") )
  {
    print_iframe_mbridge_apply(v3, (int)v4);
  }
  else if ( !strcmp(v5, "ap_list") )
  {
    print_iframe_ap_list(v3);
  }
  else if ( !strcmp(v5, "apinfostatus") )
  {
    print_iframe_apinfo_status(v3);
  }
  else if ( !strcmp(v5, "macauth_pcinfo") )
  {
    print_iframe_macauth_pcinfo(v3, (int)v4, v8);
  }
  else if ( !strcmp(v5, "macauth_dblist") )
  {
    print_iframe_macauth_dblist(v3, (int)v4, v9);
  }
  else if ( !strcmp(v5, "macauth_pcinfo_status") )
  {
    print_iframe_macauth_pcinfo_status(v3, (int)v4);
  }
  else if ( !strcmp(v5, "macauth_dblist_submit") )
  {
    print_iframe_macauth_dblist_submit(v3, (int)v4);
  }
  else if ( !strcmp(v5, "macauth_bsslist") )
  {
    print_iframe_macauth_bss_list(v3);
  }
  else if ( !strcmp(v5, "macauth_bsslist_submit") )
  {
    print_iframe_macauth_bss_list_submit(v3, (int)v4, v10);
  }
  else if ( !strcmp(v5, "sysconf_misc") )
  {
    print_iframe_sysconf_misc(v3, (int)v4);
  }
  else if ( !strcmp(v5, "sysconf_misc_realtime_status") )
  {
    print_iframe_sysconf_misc_realtime_status();
  }
  else if ( !strcmp(v5, "sysconf_misc_configmgmt_submit") )
  {
    print_iframe_sysconf_misc_configmgmt_submit(v3, (int)v4);
  }
  else if ( !strcmp(v5, "sysconf_misc_configmgmt_restore") )
  {
    print_iframe_sysconf_misc_configmgmt_restore(v3, (int)v4);
  }
  else if ( !strcmp(v5, "upnp_sysconf_misc") )
  {
    print_iframe_upnp_sysconf_misc();
  }
  else if ( !strcmp(v5, "natrouterconf_misc") )
  {
    print_iframe_natrouterconf_misc();
  }
  else if ( !strcmp(v5, "natrouterconf_misc_select") )
  {
    print_iframe_natrouterconf_misc_select(v3);
  }
  else if ( !strcmp(v5, "natrouterconf_misc_status") )
  {
    print_iframe_natrouterconf_misc_status();
  }
  else if ( !strcmp(v5, "natrouterconf_misc_submit") )
  {
    print_iframe_natrouterconf_misc_submit(v3, (int)v4);
  }
  else if ( !strcmp(v5, "natrouterconf_router_list") )
  {
    print_iframe_natrouterconf_router_list();
  }
  else if ( !strcmp(v5, "natrouterconf_router_status") )
  {
    print_iframe_natrouterconf_router_status(v3, (int)v4);
  }
  else if ( !strcmp(v5, "natrouterconf_router_setup") )
  {
    print_iframe_natrouterconf_router_setup(v3, (int)v4);
  }
  else if ( !strcmp(v5, "lan_pcinfo") )
  {
    print_iframe_lan_pcinfo(v3, (int)v4);
  }
  else if ( !strcmp(v5, "static_lease") )
  {
    print_iframe_static_lease(v3, (signed int)v4);
  }
  else if ( !strcmp(v5, "user_portforward") )
  {
    print_iframe_user_portforward(v3, v4);
  }
  else if ( !strcmp(v5, "upnp_portforward") )
  {
    print_iframe_upnp_portforward(v3, v4);
  }
  else if ( !strcmp(v5, "trigger_portforward") )
  {
    print_iframe_tirgger_portforward(v3);
  }
  else if ( !strcmp(v5, "restore_portforward") )
  {
    print_iframe_restore_portforward(v3, (int)v4);
  }
  else if ( !strcmp(v5, "firewall") )
  {
    print_iframe_firewall(v3, v4);
  }
  else if ( !strcmp(v5, "macsearch_firewall") )
  {
    print_iframe_macsearch_firewall();
  }
  else if ( !strcmp(v5, (const char *)&unk_9F3C1) )
  {
    sub_3D33C(v3, (int)v4);
  }
  else if ( !strcmp(v5, "system_info_status") )
  {
    print_iframe_system_info_status();
  }
  else if ( !strcmp(v5, "hiddenwansetup") )
  {
    print_iframe_hiddenwansetup(v3, (int)v4);
  }
  else if ( !strcmp(v5, "hiddenwanstatus") )
  {
    print_iframe_hiddenwanstatus(v3, (int)v4);
  }
  else if ( !strcmp(v5, "netconfmacsearch") )
  {
    print_iframe_netconfmacsearch(v3, (int)v4);
  }
  else if ( !strcmp(v5, "hiddenlansetup") )
  {
    print_iframe_hiddenlansetup(v3, (int)v4);
  }
  else if ( !strcmp(v5, "hiddenlanstatus") )
  {
    print_iframe_hiddenlanstatus();
  }
  else if ( !strcmp(v5, "trafficconf_qos_menu") )
  {
    print_iframe_trafficconf_qos_menu();
  }
  else if ( !strcmp(v5, "trafficconf_qos_menu_status") )
  {
    print_iframe_trafficconf_qos_menu_status(v3);
  }
  else if ( !strcmp(v5, "trafficconf_qos_list") )
  {
    print_iframe_trafficonf_qos_list();
  }
  else if ( !strcmp(v5, "trafficconf_qos_list_status") )
  {
    print_iframe_trafficonf_qos_list_status(v3, (int)v4);
  }
  else if ( !strcmp(v5, "trafficconf_qos_setup") )
  {
    print_iframe_trafficconf_qos_setup(v3, (int)v4);
  }
  else if ( !strcmp(v5, "trafficconf_conninfo_total") )
  {
    print_iframe_trafficconf_conninfo_total();
  }
  else if ( !strcmp(v5, "trafficconf_conninfo_total_status") )
  {
    print_iframe_trafficconf_conninfo_total_status();
  }
  else if ( !strcmp(v5, "trafficconf_conninfo_info") )
  {
    print_iframe_trafficconf_conninfo_info();
  }
  else if ( !strcmp(v5, "trafficconf_conninfo_info_status") )
  {
    print_iframe_trafficconf_conninfo_info_status();
  }
  else if ( !strcmp(v5, "trafficconf_connctrl_connctrl") )
  {
    print_iframe_trafficconf_connctrl_connctrl();
  }
  else if ( !strcmp(v5, "trafficconf_connctrl_connctrl_status") )
  {
    print_iframe_connctrl_connctrl_status(v3, (int)v4);
  }
  else if ( !strcmp(v5, "trafficconf_connctrl_timeout") )
  {
    print_iframe_trafficconf_connctrl_timeout();
  }
  else if ( !strcmp(v5, "trafficconf_connctrl_timeout_status") )
  {
    print_iframe_trafficconf_connctrl_timeour_status(v3, (int)v4);
  }
  else if ( !strcmp(v5, "sysconf_syslog_setup") )
  {
    print_iframe_sysconf_syslog_setup();
  }
  else if ( !strcmp(v5, "sysconf_syslog_setup_status") )
  {
    print_iframe_sysconf_syslog_setup_status(v3, (int)v4);
  }
  else if ( !strcmp(v5, "sysconf_syslog_log") )
  {
    print_iframe_sysconf_syslog_log();
  }
  else if ( !strcmp(v5, "sysconf_syslog_log_status") )
  {
    print_iframe_sysconf_syslog_log_status(v3);
  }
  else if ( !strcmp(v5, "sysconf_syslog_log_clear") )
  {
    print_iframe_sysconf_syslog_log_clear(v3, (int)v4);
  }
  else if ( !strcmp(v5, "hiddenloginsetup") )
  {
    print_iframe_hiddenloginsetup_0(v3, (int)v4);
  }
  else if ( !strcmp(v5, "nasconf_basic_device") )
  {
    print_iframe_nasconf_basic_device();
  }
  else if ( !strcmp(v5, "nasconf_basic_device_status") )
  {
    print_iframe_nasconf_basic_device_status(v3, (int)v4, v11);
  }
  else if ( !strcmp(v5, "nasconf_basic_device_submit") )
  {
    print_iframe_nasconf_basic_device_submit(v3, (int)v4);
  }
  else if ( !strcmp(v5, "nasconf_basic_storage") )
  {
    print_iframe_nasconf_basic_storage();
  }
  else if ( !strcmp(v5, "nasconf_basic_storage_status") )
  {
    print_iframe_nasconf_basic_storage_status(v3, (int)v4, v12);
  }
  else if ( !strcmp(v5, "sysconf_swupgrade_online_status") )
  {
    print_iframe_sysconf_swupgrade_online_status(v3, (int)v4);
  }
  else if ( !strcmp(v5, "sysconf_swupgrade_manual_status") )
  {
    print_iframe_sysconf_swupgrade_manual_status();
  }
  else if ( !strcmp(v5, "experconf_iptv_macgroup") )
  {
    print_iframe_experconf_iptv_macgroup();
  }
  else if ( !strcmp(v5, "experconf_iptv_macgroup_status") )
  {
    print_iframe_experconf_iptv_macgroup_status(v3);
  }
  else if ( !strcmp(v5, "expertconf_iptv_setup_status") )
  {
    print_iframe_expertconf_iptv_setup_status(v3, (int)v4);
  }
  else if ( !strcmp(v5, "basicapp_service_onusers") )
  {
    print_iframe_basicapp_service_onusers();
  }
  else if ( !strcmp(v5, "basicapp_service_onusers_status") )
  {
    print_iframe_basicapp_service_onusers_status();
  }
  else if ( !strcmp(v5, "hiddenpptpvpnsetup") )
  {
    print_iframe_hiddenpptpvpnsetup(v3, (int)v4);
  }
  else if ( !strcmp(v5, "hiddenpptpvpnstatus") )
  {
    print_iframe_hiddenpptpvpnstatus();
  }
  else if ( !strcmp(v5, "pptpvpn_account") )
  {
    print_iframe_pptpvpn_accout(v3, (int)v4);
  }
  else if ( !strcmp(v5, "hiddenddnssetup") )
  {
    print_iframe_hiddenddnssetup(v3, (int)v4);
  }
  else if ( !strcmp(v5, "hiddenddnsstatus") )
  {
    print_iframe_hiddenddnsstatus();
  }
  else if ( !strcmp(v5, "expertconfmacsearch") )
  {
    print_iframe_expertconfmacsearch(v3, (int)v4);
  }
  else if ( !strcmp(v5, "expertconfwollist") )
  {
    print_iframe_expertconfwollist(v3, (int)v4);
  }
  else if ( !strcmp(v5, "hostscanstatus") )
  {
    print_iframe_hostscanstatus();
  }
  else if ( !strcmp(v5, "hostscansubmit") )
  {
    print_iframe_hostscansubmit(v3, (int)v4);
  }
  else if ( !strcmp(v5, "hostscanlist") )
  {
    print_iframe_hostscanlist();
  }
  else if ( !strcmp(v5, "hiddenadvertisesetup") )
  {
    print_iframe_hiddenadvertisesetup(v3, (int)v4);
  }
  else if ( !strcmp(v5, "advertiseexlist") )
  {
    print_iframe_advertiseexlist(v3, (int)v4);
  }
  else if ( !strcmp(v5, "hasetup") )
  {
    print_iframe_hasetup(v3, (int)v4);
  }
  else if ( !strcmp(v5, "haext") )
  {
    print_iframe_haext(v3);
  }
  else if ( !strcmp(v5, "haint") )
  {
    print_iframe_haint(v3);
  }
  else if ( !strcmp(v5, "trafficconf_linksetup_linkstatus") )
  {
    print_iframe_trafficconf_linksetup_linkstatus();
  }
  else if ( !strcmp(v5, "trafficconf_linksetup_linkstatus_status") )
  {
    print_iframe_trafficconf_linksetup_linkstatus_status();
  }
  else if ( !strcmp(v5, "trafficconf_linksetup_linksetup") )
  {
    print_iframe_trafficconf_linksetup_linksetup();
  }
  else if ( !strcmp(v5, "trafficconf_linksetup_linksetup_status") )
  {
    print_iframe_trafficconf_linksetup_linksetup_status(v3, (int)v4);
  }
  else if ( !strcmp(v5, "trafficconf_linksetup_linkstat") )
  {
    print_iframe_trafficconf_linksetup_linkstat();
  }
  else if ( !strcmp(v5, "trafficconf_linksetup_linkstat_status") )
  {
    print_iframe_trafficconf_linksetup_linkstat_status();
  }
  else if ( !strcmp(v5, "trafficconf_linksetup_linkstat_clear") )
  {
    print_iframe_trafficconf_linksetup_linkstat_clear(v3, (int)v4);
  }
  else if ( !strcmp(v5, "trafficconf_switch_portmirror") )
  {
    print_iframe_switch_portmirror();
  }
  else if ( !strcmp(v5, "trafficconf_switch_portmirror_status") )
  {
    print_iframe_trafficconf_switch_portmirror_status(v3, (int)v4);
  }
  else if ( !strcmp(v5, "trafficconf_switch_jumboframe") )
  {
    print_iframe_trafficconf_switch_jumboframe();
  }
  else if ( !strcmp(v5, "trafficconf_switch_jumboframe_status") )
  {
    print_iframe_trafficconf_switch_jumboframe_status(v3, (int)v4);
  }
  else if ( !strcmp(v5, "trafficconf_switch_trunk") )
  {
    print_iframe_trafficconf_switch_trunk();
  }
  else if ( !strcmp(v5, "trafficconf_switch_trunk_status") )
  {
    print_iframe_trafficconf_switch_trunk_status(v3, (int)v4);
  }
}

//----- (00013A10) --------------------------------------------------------
int __fastcall print_RefreshOpener(int a1)
{
  int result; // r0@1
  int v2; // r4@1

  result = get_parameter_value(a1, "ip");
  v2 = result;
  if ( !result )
    return result;
  puts("<script>");
  printf("RefreshOpener('%s');\n", v2);
  result = printf("</script>");
  return result;
}
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);

//----- (00013A54) --------------------------------------------------------
int __cdecl main(int argc, const char **argv, const char **envp)
{
  const char **v3; // r4@1
  int pvalue; // r0@4
  const char *v5; // r5@4
  const char *v6; // r0@5
  const char *v7; // r0@7
  int v8; // r0@11
  const char *v9; // r5@11
  int v10; // r0@13
  int v11; // r1@13
  char *v12; // r2@13
  const char *v13; // r0@18
  int v14; // r0@20
  int v15; // r0@21
  const char *v16; // r0@22
  int v17; // r0@24
  int v18; // r1@29
  int v19; // r2@29
  int v20; // r3@29
  const char *v21; // r0@43
  void *v22; // r0@50
  void (__fastcall *v23)(void *); // r3@50
  void (__fastcall *v24)(const char **, int, char *, const char *); // r12@56
  const char **v25; // r0@56
  int v26; // r1@56
  char *v27; // r2@56
  const char *v28; // r3@56
  int v29; // r1@59
  int v30; // r2@59
  int v32; // [sp+0h] [bp-B0h]@36
  char s1; // [sp+40h] [bp-70h]@12
  char v34; // [sp+80h] [bp-30h]@45

  v3 = argv;
  if ( istatus_get_intvalue_direct((int)"killhttpd") != 1 && httpcon_check_session_url() && !httpcon_auth() )
    return 0;
  load_ui((userInterface *)&dword_CA95C);
  pvalue = get_parameter_value(v3, "flag");
  v5 = (const char *)pvalue;
  if ( pvalue )
  {
    print_http_header(pvalue);
    puts("<html>");
    printMenu_((int)v3);
    print_flag_screen(v3, v5);
    v6 = "</html>";
LABEL_25:
    printf(v6);
    return 0;
  }
  if ( !strcmp(*v3, "/ndbin/netdetect.cgi") )
    return 0;
  v7 = (const char *)get_parameter_value(v3, "page");
  if ( v7 && !strcmp(v7, "url_redirect") )
  {
    print_http_header(0);
    redirectForMobile((int)v3);
    return 0;
  }
  if ( !strcmp(*v3, "/cgibin/login-cgi/urlredir.cgi") )
    return 0;
  v8 = post_process();
  v9 = (const char *)v8;
  if ( v8 )
  {
    if ( !get_value_post(v8, "commit", &s1, 64) )
      goto LABEL_18;
    v10 = 0;
    v11 = (int)v9;
    v12 = &s1;
  }
  else
  {
    v12 = (char *)get_parameter_value(v3, "commit");
    if ( !v12 )
    {
LABEL_18:
      v13 = (const char *)get_parameter_value(v3, "savesave");
      if ( v13 )
      {
        v13 = (const char *)strcmp(v13, "1");
        if ( !v13 )
        {
          v14 = syslog_msg(1, "@{85}");
          v13 = (const char *)saveconf(v14);
        }
      }
      v15 = print_http_header(v13);
      if ( is_factory_test_mode(v15) )
      {
        v16 = (const char *)get_parameter_value(v3, "factory_test_mode");
        if ( v16 && !strcmp(v16, "off") )
        {
          v17 = set_ftm_flag();
          defaultconf(v17);
          v6 = "OK";
          goto LABEL_25;
        }
      }
      else if ( get_parameter_value(v3, "factory_test_mode") )
      {
        v6 = "NG";
        goto LABEL_25;
      }
      if ( get_value(v3, "tmenu", &s1, 64) && !strcmp(&s1, "iframe_nas_status") )
      {
        getNASStatus((int)v3, v18, v19, v20);
        return 0;
      }
      if ( get_value(v3, "tmenu", &s1, 64) && !strcmp(&s1, "iframe_plugin_action") )
      {
        getPluginAction((int)v3);
        return 0;
      }
      puts("<html>");
      printf("<meta http-equiv='X-UA-Compatible' content='IE=edge'>");
      printf("<meta name='renderer' content='webkit'>");
      printTitleBarNNavi((int)v3, (int)v9);
      printMenu_((int)v3);
      if ( v9 )
      {
        if ( get_value_post(v9, "tmenu", &s1, 64) && get_value_post(v9, "smenu", &v32, 64) )
        {
          if ( !strcmp(&s1, "iframe") )
            print_iframe(0, v9, (const char *)&v32);
          else
            dword_CA964(0, v9, &s1, &v32);
        }
        free((void *)v9);
        goto LABEL_75;
      }
      if ( get_value(v3, "tmenu", &s1, 64) )
      {
        if ( get_value(v3, "smenu", &v32, 64) )
        {
          v21 = (const char *)get_parameter_value(v3, &unk_5DE8C);
          if ( v21 )
            v9 = (const char *)(strcmp(v21, "plantynet") == 0);
          if ( !get_value(v3, "helpframe", &v34, 32) || strcmp(&v34, "1") )
          {
            if ( !strcmp(&s1, "iframe") )
            {
              print_iframe((int)v3, 0, (const char *)&v32);
LABEL_75:
              puts("</html>");
              fflush((FILE *)stdout);
              return 0;
            }
            if ( !strcmp(&s1, "main_frame") )
            {
              v22 = (void *)v9;
              v23 = (void (__fastcall *)(void *))dword_CA978;
LABEL_51:
              v23(v22);
              goto LABEL_75;
            }
            if ( !strcmp(&s1, "popup") )
              goto LABEL_75;
            if ( !strcmp(&s1, "menu_titlebar") )
            {
              v23 = (void (__fastcall *)(void *))dword_CA96C;
LABEL_55:
              v22 = v3;
              goto LABEL_51;
            }
            v24 = (void (__fastcall *)(const char **, int, char *, const char *))dword_CA964;
            v25 = v3;
            v26 = 0;
            v27 = &s1;
            v28 = (const char *)&v32;
LABEL_74:
            v24(v25, v26, v27, v28);
            goto LABEL_75;
          }
        }
        else
        {
          if ( !strcmp(&s1, "navi_menu_basic") )
          {
            print_navi_sidemenu_basic((int)v3);
            goto LABEL_75;
          }
          if ( !strcmp(&s1, "navi_menu_advance") )
          {
            print_navi_sidemenu_advance((int)v3, v29, v30);
            goto LABEL_75;
          }
          if ( !strcmp(&s1, "titlebar") )
          {
            v23 = (void (__fastcall *)(void *))dword_CA974;
            goto LABEL_55;
          }
          if ( strcmp(&s1, "main_body") )
          {
            if ( strcmp(&s1, "navi_titlebar") )
            {
              if ( !strcmp(&s1, "RefreshOpener") )
              {
                print_RefreshOpener((int)v3);
              }
              else if ( !strcmp(&s1, "wizard") )
              {
                print_wizard((int)v3);
              }
              else if ( !strcmp(&s1, "wirelesswizard") )
              {
                print_wireless_wizard((int)v3);
              }
              goto LABEL_75;
            }
            v23 = (void (__fastcall *)(void *))dword_CA970;
            goto LABEL_55;
          }
        }
        v23 = (void (__fastcall *)(void *))dword_CA968;
        goto LABEL_55;
      }
      v25 = v3;
      v27 = "main_frame";
      v26 = 0;
      v24 = (void (__fastcall *)(const char **, int, char *, const char *))dword_CA964;
      v28 = "main_frame";
      goto LABEL_74;
    }
    v10 = (int)v3;
    v11 = (int)v9;
  }
  commit_process(v10, v11, v12);
  goto LABEL_18;
}
// 10550: using guessed type int __fastcall print_http_header(_DWORD);
// 10A48: using guessed type int httpcon_check_session_url(void);
// 10E20: using guessed type int set_ftm_flag(void);
// 10FF4: using guessed type int __fastcall saveconf(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 111C8: using guessed type int post_process(void);
// 113CC: using guessed type int syslog_msg(_DWORD, const char *, ...);
// 1142C: using guessed type int httpcon_auth(void);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 11828: using guessed type int __fastcall is_factory_test_mode(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// C9460: using guessed type int stdout;
// CA95C: using guessed type int dword_CA95C;
// CA964: using guessed type int (__fastcall *dword_CA964)(_DWORD, _DWORD, _DWORD, _DWORD);
// CA968: using guessed type int dword_CA968;
// CA96C: using guessed type int dword_CA96C;
// CA970: using guessed type int dword_CA970;
// CA974: using guessed type int dword_CA974;
// CA978: using guessed type int dword_CA978;

//----- (00014064) --------------------------------------------------------
int __fastcall parse_params(int a1, int a2)
{
  int v2; // r2@1
  int v3; // r3@1
  int result; // r0@2

  v2 = *(_DWORD *)(a1 + 168);
  v3 = *(_DWORD *)(a2 + 168);
  if ( v2 == v3 )
    result = *(_DWORD *)(a1 + 172);
  else
    result = v2 - v3;
  if ( v2 == v3 )
    result -= *(_DWORD *)(a2 + 172);
  return result;
}

//----- (00014084) --------------------------------------------------------
void *__fastcall get_auth_type_string(int a1, int a2)
{
  int v2; // r0@2
  const char *v3; // r1@11
  char *v4; // r0@11

  switch ( a1 )
  {
    case 1:
      v2 = 51;
      break;
    case 2:
      v2 = 50;
      break;
    case 3:
      v2 = 49;
      break;
    case 4:
      v2 = 52;
      break;
    case 5:
      v2 = 55;
      break;
    default:
      v4 = (char *)&unk_C9480;
      v3 = "UNKNOWN";
      goto LABEL_13;
    case 8:
      v2 = 53;
      break;
    case 9:
      v2 = 54;
      break;
    case 10:
      v2 = 56;
      break;
    case 11:
      v2 = 57;
      break;
  }
  v3 = (const char *)get_ux_text_common(v2, a2);
  v4 = (char *)&unk_C9480;
LABEL_13:
  strcpy(v4, v3);
  return &unk_C9480;
}

//----- (00014134) --------------------------------------------------------
void *__fastcall get_enc_type_string(int a1, int a2)
{
  int v2; // r0@2
  char *v3; // r0@3
  const char *v4; // r1@3

  switch ( a1 )
  {
    case 0:
      v2 = 160;
      goto LABEL_8;
    case 1:
      v3 = (char *)&unk_C94C0;
      v4 = "WEP";
      break;
    case 2:
      v2 = 158;
      goto LABEL_8;
    case 3:
      v2 = 161;
      goto LABEL_8;
    case 4:
      v2 = 159;
      goto LABEL_8;
    case 5:
      v2 = 162;
LABEL_8:
      v4 = (const char *)get_ux_text_common(v2, a2);
      v3 = (char *)&unk_C94C0;
      break;
    default:
      v3 = (char *)&unk_C94C0;
      v4 = "UNKNOWN";
      break;
  }
  strcpy(v3, v4);
  return &unk_C94C0;
}

//----- (000141BC) --------------------------------------------------------
int __fastcall readWirelessConf(int a1)
{
  int *v1; // r0@5
  const char *v2; // r1@5
  int v4; // [sp+0h] [bp-5A8h]@5
  int v5; // [sp+578h] [bp-30h]@1

  if ( !get_value(a1, "ifname", &v5, 32) )
    strcpy((char *)&v5, "eth2");
  if ( !strcmp((const char *)&v5, "noapply") )
    return 0;
  if ( !strcmp((const char *)&v5, "both") )
  {
    read_wireless_conf(&v4, "eth2");
    set_wireless_conf(&v4, "eth2");
    read_wireless_conf(&v4, "eth1");
    v1 = &v4;
    v2 = "eth1";
  }
  else
  {
    read_wireless_conf(&v4, &v5);
    v1 = &v4;
    v2 = (const char *)&v5;
  }
  set_wireless_conf(v1, v2);
  return 0;
}
// 10724: using guessed type int __fastcall set_wireless_conf(_DWORD, _DWORD);
// 107CC: using guessed type int __fastcall read_wireless_conf(_DWORD, _DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00014294) --------------------------------------------------------
int __fastcall getStartAPScan(int a1)
{
  int v1; // r4@1

  v1 = a1;
  ifup(a1);
  return wireless_api_start_ap_scan(v1);
}
// 105A4: using guessed type int __fastcall wireless_api_start_ap_scan(_DWORD);
// 10688: using guessed type int __fastcall ifup(_DWORD);

//----- (000142AC) --------------------------------------------------------
int __fastcall sub_142AC(_DWORD *a1, _DWORD *a2, char *a3, int a4)
{
  int v4; // r7@1
  _DWORD *v5; // r5@1
  _DWORD *v6; // r4@1
  char *v7; // r6@1
  _DWORD *v8; // r10@1
  int v9; // r8@1
  size_t v10; // r11@1
  size_t v11; // ST04_4@3

  v4 = 0;
  v5 = a1;
  v6 = a2;
  v7 = a3;
  v8 = a2;
  v9 = 0;
  v10 = a4 - 10;
  while ( v9 < *v6 )
  {
    if ( v8[54] == *v5 )
    {
      v11 = strlen((const char *)&v6[53 * v9 + 12]);
      if ( strlen(v7) + v11 < v10 )
      {
        strcat(v7, (const char *)&v6[53 * v9 + 12]);
        strcat(v7, ",");
      }
      ++v4;
    }
    ++v9;
    v8 += 53;
  }
  if ( *v7 )
    v7[strlen(v7) - 1] = 0;
  return v4;
}

//----- (00014374) --------------------------------------------------------
int __fastcall channel_select(int a1, int a2, int a3)
{
  _DWORD *v3; // r8@1
  int v4; // r6@1
  int v5; // r10@1
  int v6; // r5@1
  int *v7; // r4@1
  int v8; // r6@1
  char *v9; // r5@1
  const char *v10; // r2@3
  const char *v11; // r12@4
  void *v12; // r0@10
  int v13; // r0@10
  int v14; // r7@10
  const char *v15; // r2@12
  int v16; // r1@13
  int v17; // r0@13
  int v18; // r11@13
  int v19; // r1@13
  int v20; // r2@13
  int v21; // r3@13
  int v22; // r0@15
  char *v23; // r3@18
  int v24; // r0@20
  int v25; // r1@20
  const char *v26; // r0@22
  int v27; // r0@24
  int v28; // r1@27
  int v29; // r0@28
  const char *v30; // r2@31
  int v31; // r0@32
  int v32; // r1@32
  int v33; // r2@32
  char *v34; // r4@34
  const char *v35; // r0@35
  int v37; // r0@41
  char *v38; // [sp+8h] [bp-D40h]@0
  int v39; // [sp+10h] [bp-D38h]@1
  int v40; // [sp+14h] [bp-D34h]@1
  int v41; // [sp+18h] [bp-D30h]@13
  char v42; // [sp+20h] [bp-D28h]@10
  char v43[1280]; // [sp+820h] [bp-528h]@1
  char v44; // [sp+D20h] [bp-28h]@1

  v3 = (_DWORD *)a1;
  v4 = a2;
  v5 = a3;
  v6 = a1 + 8;
  qsort((void *)(a1 + 48), *(_DWORD *)a1, 0xD4u, (__compar_fn_t)parse_params);
  v39 = wireless_get_channel_list(v6, v3 + 10, v4, v43);
  v40 = wireless_api_get_best_channel(v43, v39, v3);
  v7 = (int *)&v43[8];
  puts("<form method=get action=timepro.cgi name=channellist_fm>");
  v8 = 0;
  v9 = &v44 + 20 * v40;
  printf("<input type=hidden name=channel value=%d.%d>\n", *((_DWORD *)v9 - 320), *((_DWORD *)v9 - 319));
  printf("<table width=%d class=wizard_content_table>");
  while ( v8 < v39 )
  {
    if ( *(v7 - 2) == *((_DWORD *)v9 - 320) )
    {
      v11 = "big_selected_td";
      if ( *(v7 - 1) != *((_DWORD *)v9 - 319) )
        v11 = "big_td";
      v10 = v11;
    }
    else
    {
      v10 = "big_td";
    }
    printf(
      "<tr id=scan_tr_%d class=%s onclick=\"OnClickChannelScan(%d,'%d.%d')\" onSelectStart=\"return false;\" onDrag=\"return false;\"",
      v8,
      v10,
      v8,
      *((_DWORD *)v9 - 320),
      *((_DWORD *)v9 - 319),
      v38);
    if ( v5 )
      putchar(62);
    else
      printf(" ondblclick=\"OnDBLClickChannelScanNoWizard('%d.%d');\">", *(v7 - 2), *(v7 - 1));
    printf("<td class=big_td valign=center>");
    v12 = add_image_prefix();
    printf("<img src='%s' border=0>", v12);
    printf("</td>");
    printf("<td width=100%% class=big_td valign=top>");
    strcpy(&v42, "");
    v13 = sub_142AC(&v43[20 * v8], v3, &v42, 2048);
    v14 = v13;
    if ( *(v7 - 2) != *((_DWORD *)v9 - 320) || *(v7 - 1) != *((_DWORD *)v9 - 319) )
    {
      v15 = "gray_text";
      if ( !v13 )
        v15 = "item_text";
    }
    else
    {
      v15 = "white_text";
    }
    printf("<span id=scan_text_0_%d class=%s> ", v8, v15);
    printf("<a name=\"channel_%d.%d\"> ", *(v7 - 2), *(v7 - 1));
    v17 = get_ux_text_common(72, v16);
    v18 = *v7;
    v41 = v17;
    calc_mask(*v7, 1000);
    sub_5B744(v18, 1000u);
    v20 = *(v7 - 2);
    v21 = *(v7 - 1);
    if ( v20 != v21 )
    {
      if ( v20 <= v21 )
        v22 = 1367;
      else
        v22 = 570;
      get_ux_text_common(v22, v19);
    }
    v23 = "";
    if ( *(v7 - 2) != *(v7 - 1) )
      v23 = "40 MHz";
    v38 = v23;
    printf("<b>%s %d </b>&nbsp;( %d.%d GHz,%s,%s ) &nbsp;&nbsp;", v41);
    v24 = printf("</a>");
    if ( *(v7 - 2) == *((_DWORD *)v9 - 320) && *(v7 - 1) == *((_DWORD *)v9 - 319) )
    {
      v26 = (const char *)get_ux_text_common(1518, v25);
      printf(v26);
      v24 = print_nbsp(2);
    }
    if ( v14 )
    {
      v27 = get_ux_text_common(73, v25);
      v24 = printf("(%d%s)", v14, v27);
    }
    else if ( *(v7 - 2) != *((_DWORD *)v9 - 320) || *(v7 - 1) != *((_DWORD *)v9 - 319) )
    {
      v37 = get_ux_text_common(69, v25);
      v24 = printf("(%s)", v37);
    }
    br(v24);
    collapse(&v42, 50);
    if ( v14 )
    {
      v29 = get_ux_text_common(1101, v28);
      printf("&nbsp;%s: %s", v29, &v42);
    }
    if ( *(v7 - 2) != *((_DWORD *)v9 - 320) || *(v7 - 1) != *((_DWORD *)v9 - 319) )
    {
      v30 = "gray_text";
      if ( !v14 )
        v30 = "item_text";
    }
    else
    {
      v30 = "white_text";
    }
    printf("<span id=scan_text_1_%d class=%s> ", v8++, v30);
    printf("</span>");
    v31 = printf("</td>");
    etr(v31);
    printf("<input type=hidden name=apnum value=%d>", v14);
    v32 = *(v7 - 2);
    v33 = *(v7 - 1);
    v7 += 5;
    printf("<input type=hidden name=channelnum value=%d.%d>", v32, v33);
  }
  printf("</table>");
  printf("<script>");
  v34 = &v44 + 20 * v40;
  printf("document.location.href='#channel_%d.%d';", *((_DWORD *)v34 - 320), *((_DWORD *)v34 - 319));
  printf("</script>");
  printf("</form>");
  printf("<script>");
  printf("EnableObj(parent.document.wizard.search_bt);");
  if ( v5 )
  {
    printf("EnableObj(parent.document.wizard.next_bt);");
    v35 = "EnableObj(parent.document.wizard.prev_bt);";
  }
  else
  {
    printf(
      "parent.document.wizard.best_ch.value = MSG_BEST_CHANNEL_PRE + '%d' + MSG_BEST_CHANNEL_POST;",
      *((_DWORD *)v34 - 320));
    v35 = "EnableObj(parent.document.wizard.select_bt);";
  }
  printf(v35);
  return printf("</script>");
}
// 10AA8: using guessed type int __fastcall wireless_api_get_best_channel(_DWORD, _DWORD, _DWORD);
// 10F04: using guessed type int __fastcall wireless_get_channel_list(_DWORD, _DWORD, _DWORD, _DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 11AEC: using guessed type int __fastcall collapse(_DWORD, _DWORD);
// 14374: using guessed type char var_528[1280];

//----- (00014830) --------------------------------------------------------
int __fastcall print_iframe_channelscan(int a1)
{
  int v1; // r4@1
  const char *v2; // r0@7
  int v3; // r0@9
  int v4; // r1@9
  const char *v5; // r0@9
  int v6; // r0@9
  int v7; // r1@9
  const char *v8; // r0@9
  void *v9; // r4@11
  char v11; // [sp+8h] [bp-68h]@5
  char v12; // [sp+28h] [bp-48h]@5
  char v13; // [sp+48h] [bp-28h]@1
  int v14; // [sp+50h] [bp-20h]@5
  int v15; // [sp+54h] [bp-1Ch]@3

  v1 = a1;
  puts("<body class=scan_body>");
  if ( !get_value(v1, "country", &v13, 8) )
    strcpy(&v13, "KR");
  if ( !get_intvalue(v1, "wizard", &v15) )
    v15 = 0;
  get_value(v1, "ifname", &v11, 32);
  get_intvalue(v1, "bw", &v14);
  strcpy(&v12, "");
  get_value(v1, "stage", &v12, 32);
  puts("<form method=get action=timepro.cgi name=scan_fm>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=channelscan>");
  printf("<input type=hidden name=country value=%s>\n", &v13);
  printf("<input type=hidden name=bw value=%d>\n", v14);
  puts("<input type=hidden name=stage value=start>");
  printf("<input type=hidden name=wizard value=%d>\n", v15);
  printf("<input type=hidden name=ifname value=%s>\n", &v11);
  printf("</form>");
  if ( !strcmp(&v12, "start") )
  {
    printf("<script>");
    printf("DisableObj(parent.document.wizard.search_bt);");
    if ( v15 )
    {
      printf("DisableObj(parent.document.wizard.next_bt);");
      v2 = "DisableObj(parent.document.wizard.prev_bt);";
    }
    else
    {
      printf("parent.document.wizard.best_ch.value = '';");
      v2 = "DisableObj(parent.document.wizard.select_bt);";
    }
    printf(v2);
    v3 = printf("</script>");
    br(v3);
    print_nbsp(5);
    v5 = (const char *)get_ux_text_common(1515, v4);
    v6 = printf(v5);
    br(v6);
    print_nbsp(5);
    v8 = (const char *)get_ux_text_common(1516, v7);
    printf(v8);
    wireless_api_start_ap_scan(&v11);
    printf(
      "<meta http-equiv=refresh content=\"%d; URL=timepro.cgi?tmenu=iframe&smenu=channelscan&stage=end&country=%s&wizard="
      "%d&ifname=%s&bw=%d\">",
      10,
      &v13,
      v15,
      &v11,
      v14);
  }
  else if ( !strcmp(&v12, "end") )
  {
    v9 = malloc(0xD430u);
    memset(v9, 0, 0xD430u);
    sf_strncpy((char *)v9 + 8, &v11, 32);
    sf_strncpy((char *)v9 + 40, &v13, 8);
    wireless_api_get_ap_list(v9);
    wireless_api_stop_ap_scan(&v11);
    channel_select((int)v9, v14, v15);
    free(v9);
  }
  return printf("</body>");
}
// 105A4: using guessed type int __fastcall wireless_api_start_ap_scan(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10874: using guessed type int __fastcall wireless_api_get_ap_list(_DWORD);
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 118A0: using guessed type int __fastcall wireless_api_stop_ap_scan(_DWORD);

//----- (00014ADC) --------------------------------------------------------
int __fastcall print_wireless_wizard_top(int a1, int a2, const char *a3)
{
  const char *v3; // r6@1
  int v4; // r4@1
  int v5; // r5@1
  bool v6; // zf@1
  int v7; // r1@1
  const char *v8; // r6@1
  int v9; // r0@3
  int v10; // r0@5

  v3 = a3;
  v4 = a2;
  v5 = a1;
  str(a1);
  puts("<td height=40px class=wizardtop_td valign=top>");
  v6 = strcmp(v3, "eth1") == 0;
  v8 = "2.4GHz";
  if ( v6 )
    v8 = "5GHz";
  v9 = get_ux_text_common(1598, v7);
  printf("<b>%s</b> - %s %s <br>", v5, v8, v9);
  if ( v4 )
    printf("%s<br>", v4);
  v10 = printf("</td>");
  return etr(v10);
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);

//----- (00014B70) --------------------------------------------------------
int __fastcall print_wizard_top(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r5@1
  int v4; // r0@1
  int v5; // r0@2
  int v6; // r0@4

  v2 = a2;
  v3 = a1;
  str(a1);
  puts("<td height=40px class=wizardtop_td valign=top>");
  v4 = printf("<b>%s</b><br>", v3);
  if ( v2 )
    v5 = printf("%s<br>", v2);
  else
    v5 = br(v4);
  br(v5);
  v6 = printf("</td>");
  return etr(v6);
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);

//----- (00014BD4) --------------------------------------------------------
int __fastcall common_wl_wizard_finish(int a1)
{
  int v1; // r0@1
  int v3; // [sp+0h] [bp-28h]@1

  v1 = get_value(a1, "wizardsave", &v3, 32);
  if ( v1 )
    saveconf(v1);
  printf("<script>");
  printf("document.location.href='timepro.cgi?tmenu=wirelesswizard&step=2&ifname=%s';", "eth1");
  return printf("</script>");
}
// 10FF4: using guessed type int __fastcall saveconf(_DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00014C30) --------------------------------------------------------
int __fastcall common_wizard_finish(int a1)
{
  int v1; // r0@1
  int v3; // [sp+0h] [bp-28h]@1

  v1 = get_value(a1, "wizardsave", &v3, 32);
  if ( v1 )
    saveconf(v1);
  printf("<script>");
  printf("self.close();");
  printf("parent.opener.focus();");
  return printf("</script>");
}
// 10FF4: using guessed type int __fastcall saveconf(_DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00014C90) --------------------------------------------------------
int __fastcall common_wl_wizard_finish5g(int a1)
{
  int v1; // r0@1
  int v3; // [sp+0h] [bp-28h]@1

  v1 = get_value(a1, "wizardsave", &v3, 32);
  if ( v1 )
    saveconf(v1);
  printf("<script>");
  printf("self.close();");
  printf("parent.opener.focus();");
  return printf("</script>");
}
// 10FF4: using guessed type int __fastcall saveconf(_DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00014CF0) --------------------------------------------------------
int __fastcall common_wizard_save(int a1)
{
  int v1; // r4@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r0@1
  bool v5; // zf@1
  const char *v6; // r3@1
  int v7; // r1@3
  int v8; // r5@6
  int v9; // r1@6
  int v10; // r0@6
  int v11; // r0@6
  int result; // r0@6
  char v13; // [sp+8h] [bp-280h]@6
  char s; // [sp+108h] [bp-180h]@3
  char dest; // [sp+208h] [bp-80h]@1
  int v16; // [sp+288h] [bp+0h]@1
  char v17; // [sp+2C8h] [bp+40h]@1
  char s1; // [sp+308h] [bp+80h]@1

  v1 = a1;
  strcpy(&dest, "");
  get_value(v1, "tmenu", &v17, 64);
  get_value(v1, "nextstep", &v16, 64);
  get_value(v1, "ifname", &s1, 32);
  v3 = get_ux_text_common(1601, v2);
  v4 = print_wizard_top(v3, 0);
  str(v4);
  puts("<td height=260px class=wizardbody_td>");
  v5 = strcmp(&s1, "eth1") == 0;
  v6 = "both";
  if ( !v5 )
    v6 = "noapply";
  snprintf(&s, 0x100u, "timepro.cgi?tmenu=%s&step=%s&savesave=1&ifname=%s", &v17, &v16, v6);
  if ( get_value(v1, "commit", &dest, 128) && !strcmp(&dest, "manual_wireless_wizard") )
    strcat(&s, (const char *)&unk_5E725);
  v8 = get_ux_text_common(1599, v7);
  v10 = get_ux_text_common(1600, v9);
  snprintf(&v13, 0x100u, "%s<br>%s", v8, v10);
  print_html_apply_wait(&v13, 3, &s);
  v11 = printf("</td>");
  etr(v11);
  result = strcmp(&s1, "eth1");
  if ( result )
    return result;
  puts("<script>");
  printf("setTimeout(\"self.close();\",7000);");
  result = puts("</script>");
  return result;
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 10EC8: using guessed type int __fastcall print_html_apply_wait(_DWORD, _DWORD, _DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00014EB0) --------------------------------------------------------
const char *__fastcall get_country_string(const char *a1)
{
  const char *v1; // r7@1
  int v2; // r4@1
  int v3; // r5@3
  char *v4; // r3@3

  v1 = a1;
  v2 = 0;
  make_country_names(a1);
  while ( 1 )
  {
    v3 = *(_DWORD *)((char *)&country_names + v2);
    v4 = (char *)&country_names + v2;
    if ( !v3 )
      break;
    v2 += 16;
    if ( !strcmp(v1, *((const char **)v4 + 1)) )
      return (const char *)v3;
  }
  return "Unknown";
}
// 10CE8: using guessed type int __fastcall make_country_names(_DWORD);

//----- (00014F04) --------------------------------------------------------
int __fastcall print_country_code_option(const char *a1)
{
  const char *v1; // r7@1
  int v2; // r4@1
  int result; // r0@1
  const char *v4; // r10@2
  char *v5; // r2@3
  int v6; // r1@6
  int v7; // [sp+0h] [bp-A0h]@2

  v1 = a1;
  v2 = 0;
  for ( result = make_country_names(a1); ; result = printf("<option value=%s %s> %s </option>", v4, v5, &v7) )
  {
    v6 = *(_DWORD *)((char *)&country_names + v2);
    if ( !v6 )
      break;
    sf_strncpy(&v7, v6, 128);
    v4 = *(const char **)((char *)&country_names + v2 + 4);
    v2 += 16;
    if ( !strcmp(v1, v4) )
      v5 = "selected";
    else
      v5 = "";
  }
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10CE8: using guessed type int __fastcall make_country_names(_DWORD);

//----- (00014F90) --------------------------------------------------------
void *__fastcall get_channelspec_str(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r0@2
  int v4; // r6@2
  int v5; // r4@2
  int v6; // ST00_4@2
  int v7; // ST04_4@2
  int v8; // r1@2
  int v9; // r0@3
  int v10; // r6@3
  int v11; // r4@3
  int v12; // r7@3
  int v13; // r1@3
  int v14; // r6@3
  int v15; // r3@3
  char *v16; // r0@4
  int v17; // r0@6
  signed int v18; // r2@10

  v2 = a1;
  if ( *(_DWORD *)a1 == *(_DWORD *)(a1 + 4) )
  {
    v3 = get_ux_text_common(72, a2);
    v4 = *(_DWORD *)(v2 + 8);
    v5 = v3;
    v6 = *(_DWORD *)v2;
    v7 = calc_mask(*(_DWORD *)(v2 + 8), 1000);
    sub_5B744(v4, 0x3E8u);
    snprintf(
      (char *)&unk_C9500,
      0x80u,
      "<b>%s %d </b> &nbsp;( %d.%d GHz,%d MHz )",
      v5,
      v6,
      v7,
      v8,
      *(_DWORD *)(v2 + 16));
  }
  else
  {
    v9 = get_ux_text_common(72, a2);
    v10 = *(_DWORD *)(v2 + 8);
    v11 = v9;
    v12 = calc_mask(*(_DWORD *)(v2 + 8), 1000);
    sub_5B744(v10, 0x3E8u);
    v14 = v13;
    v15 = *(_DWORD *)(v2 + 4);
    if ( *(_DWORD *)v2 == v15 )
    {
      v16 = "";
    }
    else
    {
      if ( *(_DWORD *)v2 <= v15 )
        v17 = 1367;
      else
        v17 = 570;
      v16 = (char *)get_ux_text_common(v17, v13);
    }
    if ( *(_DWORD *)v2 == *(_DWORD *)(v2 + 4) )
      v18 = 20;
    else
      v18 = 40;
    snprintf(
      (char *)&unk_C9500,
      0x80u,
      "<b>%s %d </b> &nbsp;( %d.%d GHz,%s,%d MHz )",
      v11,
      *(_DWORD *)v2,
      v12,
      v14,
      v16,
      v18);
  }
  return &unk_C9500;
}

//----- (000150A8) --------------------------------------------------------
int __fastcall print_country_code_js(const char *a1)
{
  signed int v1; // r4@1
  signed int v2; // r0@2
  int v3; // r0@4
  int i; // r5@6
  int v5; // r8@8
  int v6; // r9@9
  int v7; // r10@9
  int v8; // r10@14
  int v9; // r1@14
  int v10; // r6@14
  char *v11; // r6@21
  signed int v13; // [sp+0h] [bp-530h]@4
  const char *v14; // [sp+4h] [bp-52Ch]@1
  char v15; // [sp+8h] [bp-528h]@8

  v1 = 20;
  v14 = a1;
  if ( !strcmp(a1, "eth1") )
    v2 = 80;
  else
    v2 = 40;
  v13 = v2;
  puts((const char *)&unk_5E7E8);
  puts("var control_channel_arr = new Array();");
  v3 = puts("var central_channel_arr = new Array();");
  make_country_names(v3);
  do
  {
    if ( v1 != 60 )
    {
      for ( i = 0; ; i += 16 )
      {
        v11 = (char *)&country_names + i;
        if ( !*(_DWORD *)((char *)&country_names + i) )
          break;
        v5 = wireless_get_channel_list(v14, *((_DWORD *)v11 + 1), v1, &v15);
        if ( v5 )
        {
          v6 = 0;
          printf("control_channel_arr['%s_%d'] = new Array(", *((_DWORD *)v11 + 1), v1);
          v7 = 0;
          while ( v7 < v5 )
          {
            printf("%d", *(_DWORD *)(&v15 + v6));
            if ( v7 != v5 - 1 )
              putchar(44);
            ++v7;
            v6 += 20;
          }
          v8 = 0;
          puts(");");
          v9 = *((_DWORD *)v11 + 1);
          v10 = 0;
          printf("central_channel_arr['%s_%d'] = new Array(", v9, v1);
          while ( v10 < v5 )
          {
            printf("%d", *(_DWORD *)(&v15 + v8 + 4));
            if ( v10 != v5 - 1 )
              putchar(44);
            ++v10;
            v8 += 20;
          }
          puts(");");
        }
      }
    }
    v1 += 20;
  }
  while ( v1 <= v13 );
  puts("</script>\n");
  return print_file("/home/httpd/js/ccode.js");
}
// 10CE8: using guessed type int __fastcall make_country_names(_DWORD);
// 10F04: using guessed type int __fastcall wireless_get_channel_list(_DWORD, _DWORD, _DWORD, _DWORD);
// 12068: using guessed type int __fastcall print_file(_DWORD);

//----- (00015240) --------------------------------------------------------
signed int print_natoff_warning()
{
  int v0; // r1@2
  int v1; // r0@2
  int v2; // r0@2
  signed int result; // r0@2

  if ( sysconf_nat_get(1) )
  {
    result = 0;
  }
  else
  {
    print_start_main_table(0);
    v1 = get_ux_text_common(732, v0);
    v2 = printf("<tr><td width=100%% height=200px valign=top style=\"padding-top:10px;\"> %s </td></tr>", v1);
    print_end_main_table(v2);
    result = 1;
  }
  return result;
}
// 1121C: using guessed type int __fastcall print_start_main_table(_DWORD);
// 11414: using guessed type int __fastcall sysconf_nat_get(_DWORD);
// 115DC: using guessed type int __fastcall print_end_main_table(_DWORD);

//----- (00015284) --------------------------------------------------------
int __fastcall get_firmware_builddate(int a1, int a2)
{
  return get_file_string("/home/httpd/build_date", a1, a2);
}
// 10BF8: using guessed type int __fastcall get_file_string(_DWORD, _DWORD, _DWORD);

//----- (0001537C) --------------------------------------------------------
signed int __fastcall timetostr(unsigned int a1, int a2, int a3)
{
  unsigned int v3; // r5@1
  int v4; // r7@1
  int v5; // r6@1
  char *v6; // r4@1
  int v7; // r8@2
  unsigned int v8; // r0@2
  int v9; // r1@3
  unsigned int v10; // r5@3
  int v11; // r8@3
  unsigned int v12; // r0@3
  char *v13; // r4@3
  int v14; // r1@3
  unsigned int v15; // r5@3
  int v16; // r8@3
  unsigned int v17; // r0@3
  int v18; // r10@3
  int v19; // r1@3
  int v20; // r8@3
  int v21; // r1@3
  char v23; // [sp+8h] [bp-120h]@1

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = &v23;
  if ( a1 > 0x15180 )
  {
    v7 = get_ux_text_common(138, a2);
    v8 = sub_5B5A0(v3, 0x15180u);
    v6 = &v23 + snprintf(&v23, 0x40u, "%d %s ", v8, v7);
  }
  sub_5B648(v3, 0x15180u);
  v10 = v9;
  v11 = get_ux_text_common(417, v9);
  v12 = sub_5B5A0(v10, 0xE10u);
  v13 = &v6[snprintf(v6, 0x40u, "%d %s ", v12, v11)];
  sub_5B648(v10, 0xE10u);
  v15 = v14;
  v16 = get_ux_text_common(634, v14);
  v17 = sub_5B5A0(v15, 0x3Cu);
  v18 = snprintf(v13, 0x40u, "%d %s ", v17, v16);
  v20 = get_ux_text_common(1083, v19);
  sub_5B648(v15, 0x3Cu);
  snprintf(&v13[v18], 0x40u, "%d %s ", v21, v20);
  sf_strncpy(v4, &v23, v5);
  return 1;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);

//----- (0001558C) --------------------------------------------------------
int __fastcall get_wl_mode(int a1, int a2, int a3)
{
  int v4; // [sp+4h] [bp-Ch]@1
  int v5; // [sp+8h] [bp-8h]@1

  v4 = a2;
  v5 = a3;
  if ( !get_intvalue(a1, "wl_mode", &v4) )
    v4 = 1;
  return v4;
}
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);

//----- (000155B4) --------------------------------------------------------
int __fastcall get_wl_mode_post(int a1, int a2, int a3)
{
  int v4; // [sp+4h] [bp-Ch]@1
  int v5; // [sp+8h] [bp-8h]@1

  v4 = a2;
  v5 = a3;
  if ( !get_intvalue_post(a1, (int)"wl_mode", (int)&v4) )
    v4 = 1;
  return v4;
}

//----- (000155DC) --------------------------------------------------------
int __fastcall print_alert(int a1)
{
  int v1; // r4@1

  v1 = a1;
  printf("<script>");
  printf("alert(\"%s\");\n", v1);
  printf("</script>");
  return 0;
}

//----- (0001586C) --------------------------------------------------------
int __fastcall print_hwadress_inputbox(int a1, const char *a2, int a3)
{
  const char *v3; // r4@1
  int v4; // r6@1
  int v5; // r8@1
  const char *v6; // r0@4
  const char *v7; // r1@4
  int i; // r7@8
  int v9; // r1@10
  int v10; // r0@13
  int result; // r0@13
  int *v12; // [sp+Ch] [bp-34h]@0
  char v13; // [sp+10h] [bp-30h]@12
  int v14; // [sp+24h] [bp-1Ch]@4

  v3 = a2;
  v4 = a1;
  v5 = a3;
  if ( !a2 || !*a2 )
    goto LABEL_8;
  if ( strchr(a2, 58) )
  {
    v6 = v3;
    v7 = "%02X:%02X:%02X:%02X:%02X:%02X";
    v12 = &v14;
LABEL_7:
    sscanf(v6, v7);
    goto LABEL_8;
  }
  if ( strchr(v3, 45) )
  {
    v7 = "%02X-%02X-%02X-%02X-%02X-%02X";
    v6 = v3;
    v12 = &v14;
    goto LABEL_7;
  }
LABEL_8:
  for ( i = 0; ; ++i )
  {
    printf(
      "<input type=text name='%s%d' size=2 maxlength=2 style=\"width:18pt; ime-mode: disabled;\" class=\"navi_text\" onfo"
      "cus='this.select();' onkeypress=\"return HWKeyDown('%s',%d);\" onkeyup=\"HWKeyUp('%s',%d);\"",
      v4,
      i + 1,
      v4,
      i + 1,
      v4,
      i + 1,
      v12);
    if ( v3 && *v3 )
      printf("value='%02X' ", *((_DWORD *)&v13 + i));
    v10 = get_ux_text_common(591, v9);
    printf("title=\"%s%d\"", v10, i + 1);
    result = putchar(62);
    if ( i != 5 )
      result = putchar(45);
    if ( i == 5 )
      break;
  }
  if ( v5 )
    result = printf("<script> DisableHW('%s'); </script>", v4);
  return result;
}

//----- (000159D8) --------------------------------------------------------
int __fastcall print_html_ip_address(int a1, _BYTE *a2, int a3)
{
  int v3; // r5@1
  int v4; // r7@1
  int v5; // r1@3
  char *v6; // r1@6
  char *v7; // r0@8
  bool v8; // zf@8
  const char *v9; // r1@8
  char *v10; // r0@8
  char *v11; // r0@13
  bool v12; // zf@13
  const char *v13; // r1@13
  char *v14; // r0@13
  char *v15; // r1@18
  char *v16; // r0@19
  unsigned int v17; // r4@24
  unsigned int v18; // r4@24
  char *v19; // r6@25
  signed int v20; // r4@25
  bool v21; // zf@26
  int v22; // r0@29
  int result; // r0@29
  char v24; // [sp+18h] [bp-68h]@24
  char v25; // [sp+2Ch] [bp-54h]@24
  char s; // [sp+40h] [bp-40h]@8
  char v27; // [sp+45h] [bp-3Bh]@10
  char v28; // [sp+4Ah] [bp-36h]@15
  char v29; // [sp+4Fh] [bp-31h]@19
  char dest; // [sp+54h] [bp-2Ch]@3

  v3 = a1;
  v4 = a3;
  if ( a2 && *a2 )
    sf_strncpy(&dest, a2, 20);
  else
    strcpy(&dest, "");
  if ( dest )
  {
    v6 = strtok(&dest, ".");
    if ( !v6 )
      v6 = "0";
    strcpy(&s, v6);
    v7 = strtok(0, ".");
    v9 = v7;
    v8 = v7 == 0;
    v10 = &s;
    if ( v8 )
      v9 = "0";
    else
      v10 = &v27;
    if ( v8 )
      v10 += 5;
    strcpy(v10, v9);
    v11 = strtok(0, ".");
    v13 = v11;
    v12 = v11 == 0;
    v14 = &s;
    if ( v12 )
      v13 = "0";
    else
      v14 = &v28;
    if ( v12 )
      v14 += 10;
    strcpy(v14, v13);
    v15 = strtok(0, ".");
    if ( v15 )
    {
      v16 = &v29;
    }
    else
    {
      v16 = &v29;
      v15 = "0";
    }
    strcpy(v16, v15);
  }
  else
  {
    v29 = 0;
    v28 = 0;
    v27 = 0;
    s = 0;
  }
  if ( v4 == 3 )
  {
    get_ifconfig((int)"br0", (int)&v25, (int)&v24);
    v17 = inet_addr(&v25);
    v18 = __rev(inet_addr(&v24)) & __rev(v17);
    snprintf(&s, 5u, "%d", v18 >> 24);
    snprintf(&v27, 5u, "%d", (v18 >> 16) & 0xFF);
    snprintf(&v28, 5u, "%d", (unsigned __int16)v18 >> 8);
    v29 = 0;
  }
  v19 = &s;
  v20 = 1;
  while ( 1 )
  {
    v21 = v20 == 4;
    if ( v20 == 4 )
      v21 = v4 == 4;
    if ( v21 )
      break;
    v22 = get_ux_text_common(442, v5);
    result = printf(
               "<input type=text name=\"%s%d\" maxlength=3 size=3 style=\"width:25pt; padding-left: 0; padding-right: 0; "
               "ime-mode:disabled;\" value=\"%s\" onfocus=\"this.select();\"                    onkeyup=\"IPKeyUp('%s',%d"
               ");\" onkeypress=\"return IPKeyDown('%s', %d)\" title=\"%s%d\">",
               v3,
               v20,
               v19,
               v3,
               v20,
               v3,
               v20,
               v22,
               v20);
    if ( v20 != 4 )
      result = putchar(46);
    ++v20;
    v19 += 5;
    if ( v20 == 5 )
      return result;
  }
  return printf(
           "<input type=text name=\"%s%d\" maxlength=3 size=3 style=\"width:25pt; ime-mode:disabled; background-color:#ee"
           "eeee; padding-left: 0; padding-right: 0;\" value=\"%s\" readonly>",
           v3,
           4,
           &v29);
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);

//----- (00015BE8) --------------------------------------------------------
char *__fastcall convert_auth_enc(const char *a1, int a2, signed int *a3, _DWORD *a4)
{
  int v4; // r5@1
  _DWORD *v5; // r8@1
  signed int *v6; // r4@1
  const char *v7; // r6@1
  char *result; // r0@2
  const char *v9; // r6@4
  signed int v10; // r3@5
  int v11; // r0@23
  signed int v12; // r3@24
  signed int v13; // r3@30
  int v14; // [sp+0h] [bp-38h]@3

  v4 = a2;
  v5 = a4;
  v6 = a3;
  v7 = a1;
  if ( !strcmp(a1, "nouse") )
  {
    result = (char *)1;
    *v6 = 1;
    *v5 = 0;
    return result;
  }
  sf_strncpy(&v14, v7, 32);
  result = strchr((const char *)&v14, 95);
  if ( !result )
    return result;
  *result = 0;
  v9 = result + 1;
  if ( !strcmp((const char *)&v14, "wpa2psk") )
  {
    v10 = 9;
  }
  else if ( !strcmp((const char *)&v14, "wpapsk") )
  {
    v10 = 5;
  }
  else if ( !strcmp((const char *)&v14, (const char *)&wpapsk) )
  {
    v10 = 10;
  }
  else if ( !strcmp((const char *)&v14, "wpa") )
  {
    v10 = 4;
  }
  else if ( !strcmp((const char *)&v14, "wpa2") )
  {
    v10 = 8;
  }
  else if ( !strcmp((const char *)&v14, (const char *)&wpa) )
  {
    v10 = 11;
  }
  else
  {
    if ( strcmp((const char *)&v14, "auto") )
    {
      if ( strcmp((const char *)&v14, "open") )
      {
        if ( !strcmp((const char *)&v14, "key") )
        {
          v10 = 2;
          goto LABEL_23;
        }
        printf("Uknown AUTH : %s\n", &v14);
      }
      v10 = 1;
      goto LABEL_23;
    }
    v10 = 3;
  }
LABEL_23:
  *v6 = v10;
  v11 = strcmp(v9, "aes");
  if ( !v11 )
  {
    v12 = 4;
LABEL_29:
    *v5 = v12;
    return (char *)(v11 + 1);
  }
  v11 = strcmp(v9, "tkip");
  if ( !v11 )
  {
    v12 = 3;
    goto LABEL_29;
  }
  v11 = strcmp(v9, "tkipaes");
  if ( !v11 )
  {
    v12 = 5;
    goto LABEL_29;
  }
  result = (char *)strcmp(v9, "wep");
  if ( result )
  {
    printf("Uknown Encrypt : %s\n", v9);
    v13 = 0;
  }
  else
  {
    if ( v4 == 5 )
      result = (char *)1;
    else
      v13 = 2;
    if ( v4 == 5 )
    {
      *v5 = result;
      return result;
    }
  }
  result = (char *)1;
  *v5 = v13;
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);

//----- (00015E1C) --------------------------------------------------------
signed int __fastcall reconvert_auth_enc(int a1, int a2, char *a3)
{
  bool v3; // zf@1
  int v4; // r4@3
  char *v5; // r5@3
  char *v6; // r0@8
  const char *v7; // r1@8
  char *v8; // r0@18
  const char *v9; // r1@18

  v3 = a1 == 1;
  if ( a1 != 1 )
    v3 = a1 == 3;
  v4 = a2;
  v5 = a3;
  if ( !v3 || a2 )
  {
    switch ( a1 )
    {
      case 2:
        v6 = a3;
        v7 = "key";
        break;
      case 3:
        v6 = a3;
        v7 = "auto";
        break;
      case 4:
        v6 = a3;
        v7 = "wpa";
        break;
      case 5:
        v6 = a3;
        v7 = "wpapsk";
        break;
      default:
        v7 = "open";
        v6 = a3;
        break;
      case 8:
        v6 = a3;
        v7 = "wpa2";
        break;
      case 9:
        v6 = a3;
        v7 = "wpa2psk";
        break;
      case 10:
        v6 = a3;
        v7 = (const char *)&wpapsk;
        break;
      case 11:
        v6 = a3;
        v7 = (const char *)&wpa;
        break;
    }
    strcpy(v6, v7);
    strcat(v5, "_");
    switch ( v4 )
    {
      case 1:
      case 2:
        v9 = "wep";
        v8 = v5;
        goto LABEL_22;
      case 3:
        v8 = v5;
        v9 = "tkip";
        goto LABEL_22;
      case 4:
        v8 = v5;
        v9 = "aes";
        goto LABEL_22;
      case 5:
        v8 = v5;
        v9 = "tkipaes";
LABEL_22:
        strcat(v8, v9);
        break;
      default:
        return 1;
    }
  }
  else
  {
    strcpy(a3, "nouse");
  }
  return 1;
}

//----- (00015F94) --------------------------------------------------------
int __fastcall print_mask(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // r5@1
  void *v6; // r0@1

  v5 = a4;
  printf(
    "<DIV ID=\"%s\" STYLE=\"position:absolute; left:%dpx; top:%dpx; width:%dpx; height:%dpx; Z-index:1; background-color:"
    "#ffffff; opacity:0.5; display:none;\">\n",
    a1,
    a2,
    a3,
    a4,
    a5);
  v6 = get_image_dir();
  return printf(
           "<table width=%dpx height=%dpx><tr><td width=100%% height=100%% align=center valign=center><img src=\"/%s/appl"
           "y_ani.gif\"></td></tr></table></DIV>",
           v5,
           a5,
           v6);
}

//----- (00015FF0) --------------------------------------------------------
int __fastcall print_mask_0(int a1, int a2, int a3)
{
  int v3; // r7@1
  int v4; // r10@1
  int v5; // r6@1
  int v6; // r4@1
  int v7; // r8@1
  int v8; // r0@1
  char v10; // [sp+10h] [bp-30h]@1

  v3 = a1;
  v4 = *(_DWORD *)(a3 + 48);
  v5 = a2;
  v6 = a3;
  v7 = calc_mask(*(_DWORD *)(a3 + 48), 100);
  v8 = calc_mask(v4, 10);
  snprintf(&v10, 0x10u, "%d.%d", v7, v8);
  printf(
    "<DIV ID=\"%s\" STYLE=\"position:absolute; left:%dpx; top:%dpx; width:%dpx; height:%dpx; Z-index:1; background-color:"
    "%s; opacity:%s; display:none;\">\n",
    v3,
    *(_DWORD *)v6,
    *(_DWORD *)(v6 + 4),
    *(_DWORD *)(v6 + 8),
    *(_DWORD *)(v6 + 12),
    v6 + 16,
    &v10);
  return printf(
           "<table width=%dpx height=%dpx><tr><td width=100%% height=100%% align=center valign=center>%s</td></tr></table></DIV>",
           *(_DWORD *)(v6 + 8),
           *(_DWORD *)(v6 + 12),
           v5);
}

//----- (00016098) --------------------------------------------------------
int __fastcall print_message_box(int a1)
{
  printf("<tr><td width=100%% height=200px valign=top style=\"padding-top:10px;\"> %s </td></tr>", a1);
  return 0;
}

//----- (000160B4) --------------------------------------------------------
void *__fastcall getTags(const char *a1)
{
  const char *v1; // r7@1
  signed int v2; // r5@1
  char *v3; // r4@1
  signed int v4; // r0@1
  signed int v5; // r6@2
  int v6; // r2@5
  char *v7; // r0@6
  const char *v8; // r1@6

  v1 = a1;
  v2 = 0;
  v3 = (char *)&unk_C9640;
  v4 = strlen(a1);
  if ( v4 >= 32 )
    v5 = 32;
  else
    v5 = v4;
  while ( v2 < v5 )
  {
    v6 = v1[v2];
    if ( v6 == 60 )
    {
      v7 = v3;
      v8 = "&#60;";
LABEL_9:
      strcpy(v7, v8);
      v3 += 5;
      goto LABEL_21;
    }
    if ( v6 == 62 )
    {
      v8 = "&#62;";
      v7 = v3;
      goto LABEL_9;
    }
    if ( v6 == 38 )
    {
      v7 = v3;
      v8 = "&#38;";
      goto LABEL_9;
    }
    if ( v6 == 34 )
    {
      v7 = v3;
      v8 = "&#34;";
      goto LABEL_9;
    }
    if ( v6 == 32 )
    {
      v7 = v3;
      v8 = "&#32;";
      goto LABEL_9;
    }
    if ( v6 == 39 )
    {
      v7 = v3;
      v8 = "&#39;";
      goto LABEL_9;
    }
    if ( v6 == 35 )
    {
      v7 = v3;
      v8 = "&#35;";
      goto LABEL_9;
    }
    v3 += sprintf(v3, "%c");
LABEL_21:
    if ( strlen((const char *)&unk_C9640) > 0xFF )
      return &unk_C9640;
    ++v2;
  }
  return &unk_C9640;
}

//----- (000161B0) --------------------------------------------------------
signed int __fastcall print_escape_str(const char *a1)
{
  const char *v1; // r6@1
  signed int v2; // r4@1
  signed int result; // r0@1
  signed int v4; // r5@1
  int v5; // r0@2
  const char *v6; // r0@3

  v1 = a1;
  v2 = 0;
  result = strlen(a1);
  v4 = result;
  while ( v2 < v4 )
  {
    v5 = v1[v2];
    if ( v5 == 60 )
    {
      v6 = "&#60;";
LABEL_6:
      result = printf(v6);
      goto LABEL_18;
    }
    if ( v5 == 62 )
    {
      v6 = "&#62;";
      goto LABEL_6;
    }
    if ( v5 == 38 )
    {
      v6 = "&#38;";
      goto LABEL_6;
    }
    if ( v5 == 34 )
    {
      v6 = "&#34;";
      goto LABEL_6;
    }
    if ( v5 == 32 )
    {
      v6 = "&#32;";
      goto LABEL_6;
    }
    if ( v5 == 39 )
    {
      v6 = "&#39;";
      goto LABEL_6;
    }
    if ( v5 == 35 )
    {
      v6 = "&#35;";
      goto LABEL_6;
    }
    result = putchar(v5);
LABEL_18:
    ++v2;
  }
  return result;
}

//----- (00016258) --------------------------------------------------------
int return0()
{
  return 0;
}

//----- (00016260) --------------------------------------------------------
signed int __fastcall load_ui(userInterface *a1)
{
  userInterface *v1; // r5@1
  int v2; // r1@2
  int v3; // r2@2
  int v4; // r3@2
  char *v5; // r12@2
  int v6; // r1@2
  int v7; // r2@2
  int v8; // r3@2

  v1 = a1;
  ui_version = sysget_ui_version();
  if ( ui_version == 2 )
  {
    v2 = unk_C91B0;
    v3 = unk_C91B4;
    v4 = unk_C91B8;
    v1->field_0 = unk_C91AC;
    v1->field_4 = v2;
    v1->field_8 = v3;
    v1->field_12 = v4;
    v5 = (char *)&v1->field_16;
    v6 = unk_C91C0;
    v7 = unk_C91C4;
    v8 = unk_C91C8;
    *(_DWORD *)v5 = unk_C91BC;
    *((_DWORD *)v5 + 1) = v6;
    *((_DWORD *)v5 + 2) = v7;
    *((_DWORD *)v5 + 3) = v8;
    v1->field_32 = unk_C91CC;
  }
  else
  {
    puts("UI Not Specified..");
  }
  return 1;
}
// 115F4: using guessed type int sysget_ui_version(void);
// C9740: using guessed type int ui_version;

//----- (000162BC) --------------------------------------------------------
void *get_image_dir()
{
  char *v0; // r0@2
  const char *v1; // r1@2

  if ( ui_version == 2 )
  {
    v0 = (char *)&unk_C9744;
    v1 = "images2";
  }
  else
  {
    v0 = (char *)&unk_C9744;
    v1 = "images";
  }
  strcpy(v0, v1);
  return &unk_C9744;
}
// C9740: using guessed type int ui_version;

//----- (000162F8) --------------------------------------------------------
void *add_image_prefix()
{
  snprintf((char *)&unk_C9764, 256u, "%s/%s");
  return &unk_C9764;
}
// C9740: using guessed type int ui_version;

//----- (00016344) --------------------------------------------------------
signed int __fastcall monthSelector(const char *a1)
{
  const char *v1; // r4@1
  signed int result; // r0@2

  v1 = a1;
  if ( !strcmp(a1, "Jan") )
  {
    result = 1;
  }
  else if ( !strcmp(v1, "Feb") )
  {
    result = 2;
  }
  else if ( !strcmp(v1, "Mar") )
  {
    result = 3;
  }
  else if ( !strcmp(v1, "Apr") )
  {
    result = 4;
  }
  else if ( !strcmp(v1, "May") )
  {
    result = 5;
  }
  else if ( !strcmp(v1, "Jun") )
  {
    result = 6;
  }
  else if ( !strcmp(v1, "Jul") )
  {
    result = 7;
  }
  else if ( !strcmp(v1, "Aug") )
  {
    result = 8;
  }
  else if ( !strcmp(v1, "Sep") )
  {
    result = 9;
  }
  else if ( !strcmp(v1, "Oct") )
  {
    result = 10;
  }
  else if ( !strcmp(v1, "Nov") )
  {
    result = 11;
  }
  else if ( !strcmp(v1, "Dec") )
  {
    result = 12;
  }
  else
  {
    result = 1;
  }
  return result;
}

//----- (000164A0) --------------------------------------------------------
int __fastcall selectLang(int a1, int a2)
{
  int result; // r0@1
  char **v3; // r2@2
  int v4; // [sp+0h] [bp-10h]@1
  int v5; // [sp+4h] [bp-Ch]@1

  v4 = a1;
  v5 = a2;
  get_ux_lang((int)&v4);
  result = strcmp((const char *)&v4, "kr");
  if ( result )
  {
    result = strcmp((const char *)&v4, "en");
    if ( result )
      return result;
    v3 = off_C5BAC;
  }
  else
  {
    v3 = off_C5B34;
  }
  dword_C9864 = (int)v3;
  return result;
}
// C5B34: using guessed type char *off_C5B34[2];
// C5BAC: using guessed type char *off_C5BAC[20];
// C9864: using guessed type int dword_C9864;

//----- (00016500) --------------------------------------------------------
int __fastcall langSelector2(int a1, int a2)
{
  int v2; // r4@1

  v2 = a1;
  if ( !dword_C9864 )
    selectLang(a1, a2);
  return *(_DWORD *)(dword_C9864 + 4 * v2);
}
// C9864: using guessed type int dword_C9864;

//----- (00016530) --------------------------------------------------------
int __fastcall daySelector(const char *a1)
{
  const char *v1; // r4@1
  int v2; // r1@1
  int v3; // r0@2

  v1 = a1;
  if ( !strcmp(a1, "Sun") )
  {
    v3 = 22;
  }
  else if ( !strcmp(v1, "Mon") )
  {
    v3 = 14;
  }
  else if ( !strcmp(v1, "Tue") )
  {
    v3 = 26;
  }
  else if ( !strcmp(v1, "Wed") )
  {
    v3 = 28;
  }
  else if ( !strcmp(v1, "Thu") )
  {
    v3 = 23;
  }
  else if ( !strcmp(v1, "Fri") )
  {
    v3 = 5;
  }
  else if ( !strcmp(v1, "Sat") )
  {
    v3 = 18;
  }
  else
  {
    v3 = 22;
  }
  return langSelector2(v3, v2);
}

//----- (00016600) --------------------------------------------------------
int __fastcall daySelectorFucked(const char *a1)
{
  const char *v1; // r4@1
  int v2; // r1@1
  signed int v3; // r0@2

  v1 = a1;
  if ( !strcmp(a1, "Jan") )
  {
    v3 = 7;
  }
  else if ( !strcmp(v1, "Feb") )
  {
    v3 = 4;
  }
  else if ( !strcmp(v1, "Mar") )
  {
    v3 = 10;
  }
  else
  {
    v3 = strcmp(v1, "Apr");
    if ( v3 )
    {
      if ( !strcmp(v1, "May") )
      {
        v3 = 11;
      }
      else if ( !strcmp(v1, "Jun") )
      {
        v3 = 9;
      }
      else if ( !strcmp(v1, "Jul") )
      {
        v3 = 8;
      }
      else if ( !strcmp(v1, "Aug") )
      {
        v3 = 1;
      }
      else if ( !strcmp(v1, "Sep") )
      {
        v3 = 21;
      }
      else if ( !strcmp(v1, "Oct") )
      {
        v3 = 17;
      }
      else if ( !strcmp(v1, "Nov") )
      {
        v3 = 16;
      }
      else if ( !strcmp(v1, "Dec") )
      {
        v3 = 3;
      }
      else
      {
        v3 = 7;
      }
    }
  }
  return langSelector2(v3, v2);
}

//----- (00016758) --------------------------------------------------------
int __fastcall check_captcha_valid(int a1, const char *a2)
{
  const char *v2; // r5@1
  int result; // r0@1
  char v4; // [sp+4h] [bp-24h]@1

  v2 = a2;
  result = get_captcha(a1, &v4);
  if ( result )
    result = strcmp(&v4, v2) == 0;
  return result;
}
// 10A6C: using guessed type int __fastcall get_captcha(_DWORD, _DWORD);

//----- (0001681C) --------------------------------------------------------
int __fastcall check_captcha_post(int a1)
{
  int v1; // r6@1
  int v2; // r6@2
  char v4; // [sp+0h] [bp-D0h]@1
  unsigned __int8 v5; // [sp+80h] [bp-50h]@1

  v1 = a1;
  strcpy(&v4, "");
  strcpy((char *)&v5, "");
  if ( get_value_post(v1, "captcha_file", &v4, 63) )
  {
    if ( v4 )
    {
      v2 = get_value_post(v1, "captcha_code", &v5, 64);
      if ( v2 && (v2 = v5) != 0 && (v2 = check_captcha_valid((int)&v4, (const char *)&v5)) != 0 )
      {
        v2 = 1;
        remove_captcha(&v4);
      }
      else
      {
        remove_captcha(&v4);
      }
    }
    else
    {
      v2 = 0;
    }
  }
  else
  {
    v2 = 0;
  }
  return v2;
}
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 12158: using guessed type int __fastcall remove_captcha(_DWORD);

//----- (000168E4) --------------------------------------------------------
int __fastcall get_iptimeddns_service_config(void *a1)
{
  void *v1; // r6@1
  int v2; // r4@1
  int result; // r0@2
  int v4; // [sp+0h] [bp-4h]@2
  int v5; // [sp+4h] [bp+0h]@3

  v1 = a1;
  v2 = 0;
  while ( 1 )
  {
    result = ddnsapi_read_config(v2, &v4);
    if ( !result )
      break;
    if ( !strcmp("iptime", (const char *)&v5) )
    {
      if ( v1 )
        memcpy(v1, &v4, 0x500u);
      return 1;
    }
    if ( ++v2 == 6 )
      return 0;
  }
  return result;
}
// 10DC0: using guessed type int __fastcall ddnsapi_read_config(_DWORD, _DWORD);

//----- (0001696C) --------------------------------------------------------
signed int __fastcall check_ddns_hostname(const char *a1)
{
  const char *v1; // r4@1
  signed int v2; // r0@1
  signed int i; // r2@1
  unsigned int v4; // r3@2
  unsigned int v5; // r12@2
  unsigned int v6; // r1@2
  bool v7; // cf@2
  bool v8; // zf@2
  unsigned int v9; // r1@6
  bool v10; // cf@6
  bool v11; // zf@6

  v1 = a1;
  v2 = strlen(a1);
  for ( i = 0; ; ++i )
  {
    if ( i >= v2 )
      return 1;
    v4 = v1[i];
    v5 = (unsigned __int8)(v4 - 65);
    v6 = (unsigned __int8)(v4 - 97);
    v7 = v5 >= 0x19;
    v8 = v5 == 25;
    if ( v5 > 0x19 )
    {
      v7 = v6 >= 0x19;
      v8 = v6 == 25;
    }
    if ( !v8 && v7 )
    {
      v9 = (unsigned __int8)(v4 - 48);
      v10 = v4 >= 0x2E;
      v11 = v4 == 46;
      if ( v4 != 46 )
      {
        v10 = v9 >= 9;
        v11 = v9 == 9;
      }
      if ( !v11 && v10 && v4 != 45 )
        break;
    }
  }
  return 0;
}

//----- (000169D8) --------------------------------------------------------
int __fastcall check_pptp_account(const char *a1)
{
  const char *v1; // r6@1
  int v2; // r4@1
  int result; // r0@3
  int v4; // [sp+0h] [bp-78h]@2

  v1 = a1;
  v2 = 0;
  do
  {
    memset(&v4, 0, 0x68u);
    if ( !pptpserver_get_index_pptpinfo(v2, &v4) )
      break;
    result = strcmp((const char *)&v4, v1);
    if ( !result )
      return result;
    ++v2;
  }
  while ( v2 != 5 );
  return 1;
}
// 110F0: using guessed type int __fastcall pptpserver_get_index_pptpinfo(_DWORD, _DWORD);

//----- (00016A3C) --------------------------------------------------------
void *__fastcall getNowDayMonth(time_t a1, int a2)
{
  int v2; // r5@1
  char *v3; // r0@1
  int v4; // r1@1
  const char *v5; // r2@3
  char *v6; // r0@3
  int v7; // r3@3
  signed int v8; // r8@5
  int v9; // r1@5
  int v10; // r7@5
  int v11; // r1@5
  int v12; // r6@5
  int v13; // r1@5
  int v14; // r1@5
  int v15; // r5@5
  int v16; // r0@6
  int v17; // r4@8
  int v18; // r1@8
  int v19; // ST3C_4@8
  int v20; // ST44_4@8
  int v21; // r11@8
  int v22; // r1@8
  int v23; // r9@8
  int v24; // r10@8
  int v25; // r1@8
  char *v26; // r0@8
  const char *v27; // r2@8
  int v28; // ST40_4@9
  signed int v29; // r11@9
  int v30; // r1@9
  int v31; // r9@9
  int v32; // ST3C_4@9
  int v33; // ST48_4@9
  int v34; // ST44_4@9
  int v35; // r1@9
  int v36; // r10@9
  int v37; // r8@9
  int v38; // r1@9
  int v39; // r7@9
  int v40; // r6@9
  int v41; // r1@9
  int v42; // r5@9
  int v43; // r4@9
  int v44; // r1@9
  int v45; // r1@14
  int v46; // r4@15
  int v47; // r8@15
  int v48; // r0@15
  signed int v49; // r5@15
  int v50; // r7@15
  int v51; // r6@15
  int v52; // r1@15
  int v53; // r9@15
  int v54; // r10@15
  int v55; // r11@15
  int v56; // r0@16
  char *v57; // r0@18
  const char *v58; // r2@18
  int v59; // r8@19
  int v60; // r0@19
  signed int v61; // r5@19
  int v62; // r7@19
  int v63; // r6@19
  int v64; // r1@19
  int v65; // r11@19
  int v66; // r0@20
  int v67; // r9@22
  int v68; // r10@22
  int v69; // r0@22
  int v70; // r4@25
  int v71; // r5@25
  int v72; // r5@26
  signed int v74; // [sp+0h] [bp-158h]@3
  int v75; // [sp+0h] [bp-158h]@8
  int v76; // [sp+0h] [bp-158h]@18
  int v77; // [sp+4h] [bp-154h]@3
  signed int v78; // [sp+4h] [bp-154h]@8
  int v79; // [sp+4h] [bp-154h]@18
  int v80; // [sp+8h] [bp-150h]@3
  int v81; // [sp+8h] [bp-150h]@8
  int v82; // [sp+8h] [bp-150h]@18
  int v83; // [sp+Ch] [bp-14Ch]@3
  int v84; // [sp+Ch] [bp-14Ch]@8
  int v85; // [sp+Ch] [bp-14Ch]@18
  int v86; // [sp+10h] [bp-148h]@3
  int v87; // [sp+10h] [bp-148h]@8
  int v88; // [sp+10h] [bp-148h]@18
  int v89; // [sp+14h] [bp-144h]@0
  int v90; // [sp+14h] [bp-144h]@8
  int v91; // [sp+14h] [bp-144h]@18
  int v92; // [sp+18h] [bp-140h]@8
  int v93; // [sp+18h] [bp-140h]@18
  int v94; // [sp+1Ch] [bp-13Ch]@8
  int v95; // [sp+20h] [bp-138h]@8
  int v96; // [sp+24h] [bp-134h]@8
  int v97; // [sp+28h] [bp-130h]@8
  int v98; // [sp+2Ch] [bp-12Ch]@8
  int v99; // [sp+30h] [bp-128h]@8
  int v100; // [sp+34h] [bp-124h]@0
  int v101; // [sp+4Ch] [bp-10Ch]@4
  int v102; // [sp+50h] [bp-108h]@5
  int v103; // [sp+54h] [bp-104h]@5
  int v104; // [sp+58h] [bp-100h]@5
  time_t timer; // [sp+5Ch] [bp-FCh]@1
  char v106; // [sp+64h] [bp-F4h]@1
  char v107; // [sp+E4h] [bp-74h]@1
  char v108; // [sp+104h] [bp-54h]@1
  char v109; // [sp+10Ch] [bp-4Ch]@1
  char v110; // [sp+114h] [bp-44h]@1
  int v111; // [sp+11Ch] [bp-3Ch]@1
  int v112; // [sp+120h] [bp-38h]@1
  int v113; // [sp+124h] [bp-34h]@1
  int v114; // [sp+128h] [bp-30h]@1
  int v115; // [sp+12Ch] [bp-2Ch]@1

  timer = a1;
  v2 = a2;
  get_timezone_abbr_from_config(&v107);
  setenv("TZ", &v107, 1);
  v3 = ctime(&timer);
  snprintf(&v106, 0x80u, "%s", v3);
  sscanf(&v106, "%s %s %d %d:%d:%d %d", &v109, &v108, &v114, &v113, &v112, &v111, &v115);
  get_ux_lang((int)&v110);
  if ( !strcmp(&v110, "kr") )
  {
    if ( v2 == 1 )
    {
      v74 = monthSelector(&v108);
      v5 = "%4d-%02d-%02d %02d:%02d:%02d";
      v77 = v114;
      v6 = (char *)&unk_C9868;
      v80 = v113;
      v83 = v112;
      v86 = v111;
      v7 = v115;
LABEL_28:
      snprintf(v6, 0x80u, v5, v7, v74, v77, v80, v83, v86, v89);
      return &unk_C9868;
    }
    v101 = v115;
    if ( v2 == 2 )
    {
      v102 = langSelector2(29, v4);
      v8 = monthSelector(&v108);
      v10 = langSelector2(13, v9);
      v103 = v114;
      v104 = langSelector2(2, v11);
      v12 = daySelector(&v109);
      v15 = langSelector2(27, v13);
      if ( v113 <= 11 )
        v16 = 24;
      else
        v16 = 25;
      v17 = langSelector2(v16, v14);
      sub_5B744(v113, 0xCu);
      v19 = v18;
      v20 = langSelector2(6, v18);
      v21 = v112;
      v23 = langSelector2(12, v22);
      v24 = v111;
      v75 = v102;
      v95 = v19;
      v100 = langSelector2(19, v25);
      v84 = v103;
      v78 = v8;
      v81 = v10;
      v87 = v104;
      v90 = v12;
      v92 = v15;
      v94 = v17;
      v96 = v20;
      v97 = v21;
      v98 = v23;
      v99 = v24;
      v26 = (char *)&unk_C9868;
      v27 = "%d%s %d%s %d%s %s%s %s %d%s %d%s %d%s";
    }
    else
    {
      v28 = langSelector2(29, v4);
      v29 = monthSelector(&v108);
      v31 = langSelector2(13, v30);
      v32 = v114;
      v33 = langSelector2(2, v114);
      v34 = daySelector(&v109);
      v36 = langSelector2(27, v35);
      v37 = v113;
      v39 = langSelector2(6, v38);
      v40 = v112;
      v42 = langSelector2(12, v41);
      v43 = v111;
      v99 = langSelector2(20, v44);
      v75 = v28;
      v26 = (char *)&unk_C9868;
      v27 = "%d%s %d%s %d%s %s%s %d%s %d%s %d%s";
      v84 = v32;
      v78 = v29;
      v81 = v31;
      v87 = v33;
      v90 = v34;
      v92 = v36;
      v94 = v37;
      v95 = v39;
      v96 = v40;
      v97 = v42;
      v98 = v43;
    }
    snprintf(v26, 0x80u, v27, v101, v75, v78, v81, v84, v87, v90, v92, v94, v95, v96, v97, v98, v99, v100);
  }
  else
  {
    if ( v2 == 1 )
    {
      v74 = monthSelector(&v108);
      v5 = "%02d-%02d-%4d %02d:%02d:%02d";
      v77 = v115;
      v6 = (char *)&unk_C9868;
      v80 = v113;
      v83 = v112;
      v86 = v111;
      v7 = v114;
      goto LABEL_28;
    }
    if ( v2 != 2 )
    {
      if ( !strcmp(&v110, "pt") )
      {
        v70 = daySelector(&v109);
        v71 = v114;
        v77 = daySelectorFucked(&v108);
        v74 = v71;
        v80 = v115;
        v6 = (char *)&unk_C9868;
        v5 = "%s, %d %s de %4d, %02d:%02d:%02d";
        v83 = v113;
        v86 = v112;
        v89 = v111;
      }
      else
      {
        v70 = daySelector(&v109);
        v72 = v114;
        v77 = daySelectorFucked(&v108);
        v5 = "%s, %d %s %4d, %02d:%02d:%02d";
        v80 = v115;
        v6 = (char *)&unk_C9868;
        v74 = v72;
        v83 = v113;
        v86 = v112;
        v89 = v111;
      }
      v7 = v70;
      goto LABEL_28;
    }
    sub_5B744(v113, 0xCu);
    v113 = v45;
    if ( !strcmp(&v110, "pt") )
    {
      v46 = daySelector(&v109);
      v47 = v114;
      v48 = daySelectorFucked(&v108);
      v49 = v113;
      v50 = v48;
      v51 = v115;
      sub_5B744(v113, 0xCu);
      v53 = v112;
      v54 = v111;
      v55 = v52;
      if ( v49 <= 11 )
        v56 = 24;
      else
        v56 = 25;
      v76 = v47;
      v93 = langSelector2(v56, v52);
      v79 = v50;
      v82 = v51;
      v85 = v55;
      v88 = v53;
      v91 = v54;
      v57 = (char *)&unk_C9868;
      v58 = "%s, %d %s de %4d, %02d:%02d:%02d %s";
    }
    else
    {
      v46 = daySelector(&v109);
      v59 = v114;
      v60 = daySelectorFucked(&v108);
      v61 = v113;
      v62 = v60;
      v63 = v115;
      sub_5B744(v113, 0xCu);
      v65 = v64;
      if ( v61 <= 11 )
        v66 = 24;
      else
        v66 = 25;
      v67 = v112;
      v68 = v111;
      v69 = langSelector2(v66, v64);
      v58 = "%s, %d %s %4d, %02d:%02d:%02d %s";
      v93 = v69;
      v57 = (char *)&unk_C9868;
      v76 = v59;
      v79 = v62;
      v82 = v63;
      v85 = v65;
      v88 = v67;
      v91 = v68;
    }
    snprintf(v57, 0x80u, v58, v46, v76, v79, v82, v85, v88, v91, v93);
  }
  return &unk_C9868;
}
// 11210: using guessed type int __fastcall get_timezone_abbr_from_config(_DWORD);

//----- (00016F90) --------------------------------------------------------
signed int __fastcall getDayInfo(char *a1, time_t a2)
{
  char *v2; // r4@1
  time_t v3; // r5@1
  int v4; // r1@1
  const char *v5; // r0@2
  signed int result; // r0@2
  void *v7; // r0@3
  time_t timer; // [sp+4h] [bp-14h]@1

  timer = a2;
  v2 = a1;
  v3 = a2;
  if ( get_timed_status(a1) )
  {
    time(&timer);
    v7 = getNowDayMonth(timer, 0);
    sf_strncpy(v2, v7, v3);
    result = 1;
  }
  else
  {
    v5 = (const char *)langSelector2(15, v4);
    strcpy(v2, v5);
    result = 0;
  }
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 120EC: using guessed type int __cdecl get_timed_status(_DWORD);

//----- (00016FF0) --------------------------------------------------------
int __fastcall print_div_m_str(int a1, int a2, int a3)
{
  int v3; // r6@1
  int v4; // r5@1
  int v5; // r4@1
  int v6; // r0@1
  const char *v7; // r0@2
  int result; // r0@3

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = is_mobile_agent(a1);
  if ( v6 == 1 )
  {
    v7 = "<div style=\"height:%s; width:%s; -webkit-overflow-scrolling: touch; overflow-y:scroll; overflow-x:hidden; %s\">";
  }
  else
  {
    result = is_mobile_agent(v6);
    if ( result != 2 )
      return result;
    v7 = "<div style=\"height:%s; width:%s; -webkit-overflow-scrolling: touch; overflow-y:hidden; overflow-x:hidden; %s\">";
  }
  return printf(v7, v3, v4, v5);
}
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (0001703C) --------------------------------------------------------
int __fastcall print_div_m_etr(int a1)
{
  int result; // r0@1

  result = is_mobile_agent(a1);
  if ( result )
    result = printf("</div>");
  return result;
}
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (0001706C) --------------------------------------------------------
int __fastcall print_js_file(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r4@1
  const char *v4; // r2@2
  int v6; // [sp+0h] [bp-68h]@5
  int v7; // [sp+4h] [bp-64h]@0
  char s; // [sp+8h] [bp-60h]@7
  char v9; // [sp+48h] [bp-20h]@1

  v2 = a2;
  v3 = a1;
  get_ux_lang((int)&v9);
  if ( v2 )
    v4 = "/home/httpd/js/%s/%s_%s.lang.js";
  else
    v4 = "/home/httpd/js/%s/%s.js";
  if ( v2 )
  {
    v6 = v3;
    v7 = v2;
  }
  else
  {
    v6 = v3;
  }
  snprintf(&s, 0x40u, v4, &v9, v6, v7);
  print_file(&s);
  if ( v2 )
    snprintf(&s, 0x40u, "/home/httpd/js/%s_%s.js", v3, v2);
  else
    snprintf(&s, 0x40u, "/home/httpd/js/%s.js", v3);
  return print_file(&s);
}
// 12068: using guessed type int __fastcall print_file(_DWORD);

//----- (00017118) --------------------------------------------------------
int __fastcall set_ux_text_common(int a1, int a2)
{
  int result; // r0@1
  char **v3; // r2@2
  int lang; // [sp+0h] [bp-10h]@1
  int v5; // [sp+4h] [bp-Ch]@1

  lang = a1;
  v5 = a2;
  get_ux_lang((int)&lang);
  result = strcmp((const char *)&lang, "kr");
  if ( result )
  {
    result = strcmp((const char *)&lang, "en");
    if ( result )
      return result;
    v3 = off_C76E8;
  }
  else
  {
    v3 = off_C5C24;
  }
  dword_C98E8 = (int)v3;
  return result;
}
// C5C24: using guessed type char *off_C5C24[6];
// C76E8: using guessed type char *off_C76E8[15];
// C98E8: using guessed type int dword_C98E8;

//----- (00017178) --------------------------------------------------------
int __fastcall get_ux_text_common(int a1, int a2)
{
  int v2; // r4@1

  v2 = a1;
  if ( !dword_C98E8 )
    set_ux_text_common(a1, a2);
  return *(_DWORD *)(dword_C98E8 + 4 * v2);
}
// C98E8: using guessed type int dword_C98E8;

//----- (0001816C) --------------------------------------------------------
void __fastcall call_real_functions_of_router(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r6@2
  int v4; // r1@2
  int v5; // r1@2
  int v6; // r7@2
  int v7; // r1@2
  int v8; // r1@2
  int v9; // r7@2
  int v10; // r1@2
  int v11; // r1@2
  int v12; // r7@2
  int v13; // r1@2
  int v14; // r1@2
  int v15; // r7@2
  int v16; // r1@2
  int v17; // r1@2
  int v18; // r7@2
  int v19; // r1@2
  int v20; // r1@2
  int v21; // r7@2
  int v22; // r1@2
  int v23; // r1@2
  int v24; // r8@2
  int v25; // r1@2
  int v26; // r1@2
  int v27; // r8@2
  int v28; // r1@2
  int v29; // r1@2
  int v30; // r8@2
  int v31; // r1@2
  int v32; // r1@2
  int v33; // r8@2
  int v34; // r1@2
  int v35; // r1@2
  int v36; // r8@2
  int v37; // r1@2
  int v38; // r1@2
  int v39; // r8@2
  int v40; // r1@2
  int v41; // r1@2
  int v42; // r8@2
  int v43; // r1@2
  int v44; // r1@2
  int v45; // r8@2
  int v46; // r1@2
  int v47; // r1@2
  int v48; // r8@2
  int v49; // r1@2
  int v50; // r1@2
  int v51; // r8@2
  int v52; // r1@2
  int v53; // r1@2
  int v54; // r8@2
  int v55; // r1@2
  int v56; // r1@2
  int v57; // r8@2
  int v58; // r1@2
  int v59; // r1@2
  int v60; // r8@2
  int v61; // r1@2
  int v62; // r1@2
  int v63; // r8@2
  int v64; // r1@2
  int v65; // r1@2
  int v66; // r8@2
  int v67; // r1@2
  int v68; // r1@2
  int v69; // r8@2
  int v70; // r1@2
  int v71; // r1@2
  int v72; // r8@2
  int v73; // r1@2
  int v74; // r1@2
  int v75; // r8@2
  int v76; // r1@2
  int v77; // r1@2
  int v78; // r8@2
  int v79; // r1@2
  int v80; // r1@2
  int v81; // r8@2
  int v82; // r1@2
  int v83; // r1@2
  int v84; // r8@2
  int v85; // r1@2
  int v86; // r1@2
  int v87; // r7@2
  int v88; // r1@2
  int v89; // r1@2
  int v90; // r7@2
  int v91; // r1@2
  int v92; // r1@2
  int v93; // r7@2
  int v94; // r1@2
  int v95; // r1@2
  int v96; // r7@2
  int v97; // r1@2
  int v98; // r0@2

  v2 = dword_C98EC[0];
  if ( !dword_C98EC[0] )
  {
    v3 = get_ux_text_common(797, a2);
    unk_C98F8 = get_ux_text_common(769, v4);
    unk_C98F4 = v3;
    dword_C98EC[0] = (int)"system";
    unk_C9900 = v2;
    unk_C98F0 = "info";
    unk_C98FC = system_info;
    v6 = get_ux_text_common(797, v5);
    unk_C9914 = get_ux_text_common(901, v7);
    unk_C9908 = "netconf";
    unk_C990C = "wansetup";
    unk_C9910 = v6;
    unk_C991C = v2;
    unk_C9918 = netconf_wansetup;
    v9 = get_ux_text_common(797, v8);
    unk_C9930 = get_ux_text_common(759, v10);
    unk_C9924 = "netconf";
    unk_C9928 = "lansetup";
    unk_C992C = v9;
    unk_C9938 = v2;
    unk_C9934 = netconf_lansetup;
    v12 = get_ux_text_common(801, v11);
    unk_C994C = get_ux_text_common(779, v13);
    unk_C9944 = "basicsetup";
    unk_C9940 = "wirelessconf";
    unk_C9948 = v12;
    unk_C9950 = wirelessconf_basicsetup_0;
    unk_C9954 = v2;
    v15 = get_ux_text_common(801, v14);
    unk_C9968 = get_ux_text_common(784, v16);
    unk_C995C = "wirelessconf";
    unk_C9960 = "multibridge";
    unk_C9964 = v15;
    unk_C9970 = v2;
    unk_C996C = wirelessconf_multibridge;
    v18 = get_ux_text_common(801, v17);
    unk_C9984 = get_ux_text_common(783, v19);
    unk_C9978 = "wirelessconf";
    unk_C997C = "macauth";
    unk_C9980 = v18;
    unk_C998C = v2;
    unk_C9988 = wirelessconf_macauth;
    v21 = get_ux_text_common(796, v20);
    unk_C99A0 = get_ux_text_common(755, v22);
    unk_C9998 = "portforward";
    unk_C9994 = "natrouterconf";
    unk_C999C = v21;
    unk_C99A4 = natrouterconf_portforward;
    unk_C99A8 = v2;
    v24 = get_ux_text_common(796, v23);
    unk_C99BC = get_ux_text_common(754, v25);
    unk_C99B0 = "natrouterconf";
    unk_C99C0 = sub_39DA8;
    unk_C99B4 = "misc";
    unk_C99B8 = v24;
    unk_C99C4 = v2;
    v27 = get_ux_text_common(796, v26);
    unk_C99D8 = get_ux_text_common(757, v28);
    unk_C99CC = "natrouterconf";
    unk_C99D0 = "router";
    unk_C99D4 = v27;
    unk_C99E0 = v2;
    unk_C99DC = natrouterconf_router;
    v30 = get_ux_text_common(794, v29);
    unk_C99F4 = get_ux_text_common(344, v31);
    unk_C99EC = "firewall";
    unk_C99E8 = "firewallconf";
    unk_C99F0 = v30;
    unk_C99F8 = firewallconf_firewall_real_2;
    unk_C99FC = firewallconf_firewall_real;
    v33 = get_ux_text_common(794, v32);
    unk_C9A10 = get_ux_text_common(749, v34);
    unk_C9A04 = "firewallconf";
    unk_C9A08 = "netdetect";
    unk_C9A0C = v33;
    unk_C9A18 = v2;
    unk_C9A14 = firewallconf_netdetect;
    v36 = get_ux_text_common(794, v35);
    unk_C9A2C = get_ux_text_common(762, v37);
    unk_C9A20 = "firewallconf";
    unk_C9A24 = "accesslist";
    unk_C9A28 = v36;
    unk_C9A34 = v2;
    unk_C9A30 = firewallconf_accesslist;
    v39 = get_ux_text_common(794, v38);
    unk_C9A48 = get_ux_text_common(750, v40);
    unk_C9A3C = "firewallconf";
    unk_C9A40 = "plantynet";
    unk_C9A44 = v39;
    unk_C9A50 = v2;
    unk_C9A4C = firewallconf_plantynet;
    v42 = get_ux_text_common(793, v41);
    unk_C9A64 = get_ux_text_common(744, v43);
    unk_C9A5C = "pptpvpn";
    unk_C9A58 = "expertconf";
    unk_C9A60 = v42;
    unk_C9A68 = expertconf_pptpvpn;
    unk_C9A6C = v2;
    v45 = get_ux_text_common(793, v44);
    unk_C9A80 = get_ux_text_common(740, v46);
    unk_C9A74 = "expertconf";
    unk_C9A78 = "ddns";
    unk_C9A7C = v45;
    unk_C9A88 = v2;
    unk_C9A84 = expertconf_ddns;
    v48 = get_ux_text_common(793, v47);
    unk_C9A9C = get_ux_text_common(745, v49);
    unk_C9A90 = "expertconf";
    unk_C9A94 = "remotepc";
    unk_C9A98 = v48;
    unk_C9AA4 = v2;
    unk_C9AA0 = experconf_remotepc;
    v51 = get_ux_text_common(793, v50);
    unk_C9AB8 = get_ux_text_common(741, v52);
    unk_C9AAC = "expertconf";
    unk_C9AB0 = "hostscan";
    unk_C9AB4 = v51;
    unk_C9AC0 = v2;
    unk_C9ABC = expertconf_hostscan;
    v54 = get_ux_text_common(793, v53);
    unk_C9AD4 = get_ux_text_common(739, v55);
    unk_C9AC8 = "expertconf";
    unk_C9ACC = "advertise";
    unk_C9AD0 = v54;
    unk_C9ADC = v2;
    unk_C9AD8 = expertconf_advertise;
    v57 = get_ux_text_common(793, v56);
    unk_C9AF0 = get_ux_text_common(742, v58);
    unk_C9AE4 = "expertconf";
    unk_C9AE8 = "iptv";
    unk_C9AEC = v57;
    unk_C9AF8 = v2;
    unk_C9AF4 = expertconf_iptv;
    v60 = get_ux_text_common(799, v59);
    unk_C9B0C = get_ux_text_common(776, v61);
    unk_C9B04 = "qos";
    unk_C9B00 = "trafficconf";
    unk_C9B08 = v60;
    unk_C9B10 = trafficconf_qos;
    unk_C9B14 = v2;
    v63 = get_ux_text_common(799, v62);
    unk_C9B28 = get_ux_text_common(772, v64);
    unk_C9B1C = "trafficconf";
    unk_C9B20 = "conninfo";
    unk_C9B24 = v63;
    unk_C9B30 = v2;
    unk_C9B2C = trafficconf_conninfo;
    v66 = get_ux_text_common(799, v65);
    unk_C9B44 = get_ux_text_common(771, v67);
    unk_C9B38 = "trafficconf";
    unk_C9B3C = "connctrl";
    unk_C9B40 = v66;
    unk_C9B4C = v2;
    unk_C9B48 = trafficconf_connctrl;
    v69 = get_ux_text_common(799, v68);
    unk_C9B60 = get_ux_text_common(773, v70);
    unk_C9B54 = "trafficconf";
    unk_C9B58 = "linksetup";
    unk_C9B5C = v69;
    unk_C9B68 = v2;
    unk_C9B64 = trafficconf_linksetup;
    v72 = get_ux_text_common(799, v71);
    unk_C9B7C = get_ux_text_common(777, v73);
    unk_C9B70 = "trafficconf";
    unk_C9B74 = "switch";
    unk_C9B78 = v72;
    unk_C9B84 = v2;
    unk_C9B80 = trafficconf_switch;
    v75 = get_ux_text_common(798, v74);
    unk_C9B98 = get_ux_text_common(768, v76);
    unk_C9B90 = "syslog";
    unk_C9B8C = "sysconf";
    unk_C9B94 = v75;
    unk_C9B9C = sysconf_syslog;
    unk_C9BA0 = sysconf_syslog_0;
    v78 = get_ux_text_common(798, v77);
    unk_C9BB4 = get_ux_text_common(764, v79);
    unk_C9BA8 = "sysconf";
    unk_C9BAC = "login";
    unk_C9BB0 = v78;
    unk_C9BBC = v2;
    unk_C9BB8 = sysconf_login;
    v81 = get_ux_text_common(798, v80);
    unk_C9BD0 = get_ux_text_common(767, v82);
    unk_C9BC4 = "sysconf";
    unk_C9BC8 = "swupgrade";
    unk_C9BCC = v81;
    unk_C9BD8 = v2;
    unk_C9BD4 = sysconf_swupgrade;
    v84 = get_ux_text_common(798, v83);
    unk_C9BEC = get_ux_text_common(765, v85);
    unk_C9BE0 = "sysconf";
    unk_C9BF0 = sysconf_misc;
    unk_C9BE4 = "misc";
    unk_C9BE8 = v84;
    unk_C9BF4 = v2;
    v87 = get_ux_text_common(795, v86);
    unk_C9C08 = get_ux_text_common(751, v88);
    unk_C9C00 = "basic";
    unk_C9BFC = "nasconf";
    unk_C9C04 = v87;
    unk_C9C0C = nasconf_basic;
    unk_C9C10 = v2;
    v90 = get_ux_text_common(795, v89);
    unk_C9C24 = get_ux_text_common(752, v91);
    unk_C9C18 = "nasconf";
    unk_C9C1C = "service";
    unk_C9C20 = v90;
    unk_C9C2C = v2;
    unk_C9C28 = nasconf_service;
    v93 = get_ux_text_common(968, v92);
    unk_C9C40 = get_ux_text_common(969, v94);
    unk_C9C38 = "setup";
    unk_C9C3C = v93;
    unk_C9C34 = "plugin";
    unk_C9C44 = plugin_setup;
    unk_C9C48 = v2;
    v96 = get_ux_text_common(968, v95);
    v98 = get_ux_text_common(967, v97);
    unk_C9C50 = "plugin";
    unk_C9C58 = v96;
    unk_C9C54 = "install";
    unk_C9C5C = v98;
    unk_C9C64 = v2;
    unk_C9C60 = plugin_install;
  }
}
// 3E49C: using guessed type int firewallconf_firewall_real();
// C98EC: using guessed type int dword_C98EC[];

//----- (00018960) --------------------------------------------------------
signed int __fastcall get_detail_menu_string(int a1, int a2, size_t a3)
{
  int v3; // r4@1
  char *v4; // r9@1
  int v5; // r0@1
  int v6; // r4@1
  int v7; // r5@1
  char *v8; // r0@2
  char v9; // r3@2
  int v10; // r3@6
  size_t maxlen; // [sp+Ch] [bp-1ACh]@1
  char v13; // [sp+10h] [bp-1A8h]@2
  char v14; // [sp+90h] [bp-128h]@6
  char v15; // [sp+110h] [bp-A8h]@1

  v3 = a1;
  v4 = (char *)a2;
  maxlen = a3;
  call_real_functions_of_router(a1, a2);
  v5 = v3;
  v6 = 0;
  get_value(v5, "smenu", &v15, 128);
  v7 = 0;
  while ( dword_C98EC[v6] )
  {
    sf_strncpy(&v13, dword_C98EC[v6 + 1], 128);
    v8 = strchr(&v13, 38);
    if ( v8 )
      v9 = 0;
    if ( v8 )
      *v8 = v9;
    v10 = dword_C98EC[v6];
    v6 += 7;
    snprintf(&v14, 0x80u, "%s_%s", v10, &v13);
    if ( !strcmp(&v15, &v14) )
    {
      snprintf(v4, maxlen, "%s", dword_C98EC[7 * v7 + 3]);
      return 1;
    }
    ++v7;
  }
  strcpy(v4, "");
  return 0;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// C98EC: using guessed type int dword_C98EC[];

//----- (00018A68) --------------------------------------------------------
signed int __fastcall print_menu_group(int a1, int a2, int a3)
{
  int v3; // r5@1
  const char *v4; // r4@1
  int v5; // r11@1
  int v6; // r6@1
  const char *v7; // r1@4
  int v9; // r0@6
  void *v10; // r9@6
  int v11; // r0@6
  int v12; // r0@6
  int v13; // r0@6
  const char *v14; // r1@8
  int v15; // r5@9
  const char *v16; // r1@13
  int v17; // r0@14
  int v18; // [sp+14h] [bp-12Ch]@1
  char v19; // [sp+18h] [bp-128h]@6
  char v20; // [sp+58h] [bp-E8h]@6
  char v21; // [sp+98h] [bp-A8h]@6
  char v22; // [sp+D8h] [bp-68h]@6

  v3 = 0;
  v4 = (const char *)a2;
  v5 = a3;
  v6 = 0;
  v18 = a1;
  call_real_functions_of_router(a1, a2);
  while ( 1 )
  {
    v7 = (const char *)dword_C98EC[v3];
    if ( !v7 )
      return 0;
    v3 += 7;
    if ( !strcmp(v4, v7) )
      break;
    ++v6;
  }
  str(0);
  puts("<td>");
  v9 = puts("<table class=\"navicontent_table\" CELLPADDING=0 CELLSPACING=0>");
  str(v9);
  setTDWIDTH(1, 16);
  snprintf(&v21, 0x40u, "%s_picon", v4);
  snprintf(&v22, 0x40u, "%s_setup", v4);
  snprintf(&v19, 0x40u, "navimenu_%s.gif", v4);
  snprintf(&v20, 0x40u, "%s_foldericon", v4);
  print_navi_image((int)"middle_plus.gif", (int)&v21, (int)&v22, 1);
  print_navi_image((int)&v19, (int)&v20, (int)"", 0);
  v10 = &unk_C98F8;
  v11 = print_navi_title(&v22, dword_C98EC[7 * v6 + 2]);
  etr(v11);
  puts("</table>");
  v12 = printf("</td>");
  v13 = etr(v12);
  str(v13);
  printf("<td id=\"%s\" style=\"display:none;\">\n", &v22);
  puts("<table class=\"navicontent_table\" CELLPADDING=0 CELLSPACING=0>");
  while ( 1 )
  {
    v16 = (const char *)*((_DWORD *)v10 - 3);
    if ( !v16 )
      break;
    if ( !strcmp(v4, v16) )
    {
      v14 = (const char *)*((_DWORD *)v10 + 4);
      v15 = v14 ? (unsigned __int8)(strcmp(v4, v14) != 0) : 1;
      print_detail_menu(v18, (int)"navimenu_detail_menu.gif", v4, *((_DWORD *)v10 - 2), *(_DWORD *)v10, v15, v5);
      if ( v15 )
        break;
    }
    v10 = (char *)v10 + 28;
  }
  puts("</table>");
  v17 = printf("</td>");
  etr(v17);
  return 1;
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// C98EC: using guessed type int dword_C98EC[];

//----- (00018C78) --------------------------------------------------------
int __fastcall sub_18C78(int a1, int a2)
{
  int v2; // r4@1
  const char *v3; // r9@1
  const char *v4; // r10@1
  int v5; // r5@1
  int v6; // r11@3
  char *v7; // r1@4
  const char *v9; // r1@8
  int v10; // [sp+0h] [bp-A8h]@4

  v2 = 0;
  v3 = (const char *)a1;
  v4 = (const char *)a2;
  v5 = 0;
  call_real_functions_of_router(a1, a2);
  while ( 1 )
  {
    v9 = (const char *)dword_C98EC[v2];
    if ( !v9 )
      break;
    if ( !strcmp(v3, v9) )
    {
      v6 = dword_C98EC[v2 + 1];
      if ( !strcmp(v4, (const char *)dword_C98EC[v2 + 1]) )
        return dword_C98EC[7 * v5 + 4];
      sf_strncpy(&v10, v6, 128);
      v7 = strtok((char *)&v10, "&");
      if ( v7 )
      {
        if ( !strcmp(v4, v7) )
          return dword_C98EC[7 * v5 + 4];
      }
    }
    ++v5;
    v2 += 7;
  }
  return 0;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// C98EC: using guessed type int dword_C98EC[];

//----- (00018D3C) --------------------------------------------------------
int __fastcall real_function(int a1, int a2)
{
  int v2; // r4@1
  const char *v3; // r9@1
  const char *v4; // r10@1
  int v5; // r5@1
  int v6; // r11@3
  char *v7; // r1@4
  const char *v9; // r1@8
  int v10; // [sp+0h] [bp-A8h]@4

  v2 = 0;
  v3 = (const char *)a1;
  v4 = (const char *)a2;
  v5 = 0;
  call_real_functions_of_router(a1, a2);
  while ( 1 )
  {
    v9 = (const char *)dword_C98EC[v2];
    if ( !v9 )
      break;
    if ( !strcmp(v3, v9) )
    {
      v6 = dword_C98EC[v2 + 1];
      if ( !strcmp(v4, (const char *)dword_C98EC[v2 + 1]) )
        return dword_C98EC[7 * v5 + 5];
      sf_strncpy(&v10, v6, 128);
      v7 = strtok((char *)&v10, "&");
      if ( v7 )
      {
        if ( !strcmp(v4, v7) )
          return dword_C98EC[7 * v5 + 5];
      }
    }
    ++v5;
    v2 += 7;
  }
  return 0;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// C98EC: using guessed type int dword_C98EC[];

//----- (00018E00) --------------------------------------------------------
int __fastcall print_navi_sidemenu_basic(int a1)
{
  void *v1; // r0@1
  int v2; // r0@1
  int v3; // r0@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r0@1
  int v8; // r0@1
  int v9; // r0@1
  int v10; // r1@1
  int v11; // r0@1
  int v12; // r1@1
  int v13; // r0@1
  int v14; // r1@1
  int v15; // r0@1
  int v16; // r1@1
  int v17; // r0@1
  int v18; // r0@1
  int v19; // r0@1
  int v20; // r0@1
  int v22; // [sp+14h] [bp-1Ch]@1

  v22 = 0;
  get_intvalue(a1, "helpmenu", &v22);
  puts("<body bgcolor=#dedede topmargin=\"0\" leftmargin=\"0\" rightmargin=\"0\" bottommargin=\"0\" style=\"background-color:transparent\">");
  puts("<form name=navi_basic_form>");
  puts("<input type=hidden name=\"navi_basic_hidden\" value=\"none\">");
  v1 = get_image_dir();
  printf("<input type=hidden name=\"image_prefix\" value=\"/%s\">\n", v1);
  v2 = printf("<table class=\"navimaintable\" CELLPADDING=0 CELLSPACING=0 width=197 >\n ");
  str(v2);
  puts("<td valign=top>");
  v3 = printf("<table class=\"navicontent_table\" CELLPADDING=0 CELLSPACING=0 >\n ");
  str(v3);
  puts("<td>");
  printf("<table class=\"navicontent_table\" width=100%% CELLPADDING=0 CELLSPACING=0 >\n");
  v4 = print_blank_line(3, 5);
  str(v4);
  puts("<td>");
  setTDWIDTH(1, 16);
  print_navi_image((int)"navimenu_title_basic_setup.gif", (int)"basic_foldericon", (int)"", 0);
  v6 = get_ux_text_common(792, v5);
  v7 = print_navi_title("basic_setup", v6);
  etr(v7);
  puts("</table>");
  v8 = printf("</td>");
  v9 = etr(v8);
  str(v9);
  printf("<td id=\"%s\">\n", "basic_setup");
  puts("<table class=\"navicontent_table\" CELLPADDING=0 CELLSPACING=0>");
  v11 = get_ux_text_common(769, v10);
  print_detail_menu(2, (int)"system_info.gif", "system", (int)"info", v11, 0, v22);
  v13 = get_ux_text_common(901, v12);
  print_detail_menu(2, (int)"netconf_wansetup.gif", "netconf", (int)"wansetup", v13, 0, v22);
  v15 = get_ux_text_common(779, v14);
  print_detail_menu(2, (int)"wirelessconf_basicsetup.gif", "wirelessconf", (int)"basicsetup", v15, 0, v22);
  v17 = get_ux_text_common(767, v16);
  print_detail_menu(2, (int)"sysconf_swupgrade.gif", "sysconf", (int)"swupgrade", v17, 1, v22);
  puts("</table>");
  v18 = printf("</td>");
  etr(v18);
  puts("</table>");
  v19 = printf("</td>");
  etr(v19);
  puts("</table>");
  v20 = printf("</td>");
  etr(v20);
  puts("</table>");
  printf("</form>");
  return printf("</body>");
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (00019090) --------------------------------------------------------
int __fastcall print_navi_sidemenu_advance(int a1, int a2, int a3)
{
  int v3; // r0@1
  int v4; // r0@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r0@1
  int v9; // r0@1
  int v10; // r0@1
  int v11; // r0@1
  int v12; // r0@1
  int v14; // [sp+4h] [bp-1Ch]@1
  int v15; // [sp+8h] [bp-18h]@1

  v15 = a3;
  v14 = 0;
  get_intvalue(a1, "helpmenu", &v14);
  puts("<body bgcolor=#dedede topmargin=\"0\" leftmargin=\"0\" rightmargin=\"0\" bottommargin=\"0\" style=\"background-color:transparent\">");
  puts("<form name=navi_advance_form>");
  puts("<input type=hidden name=\"navi_advance_hidden\" value=\"none\">");
  v3 = printf("<table border=0 CELLPADDING=0 CELLSPACING=0>");
  str(v3);
  puts("<td valign=top>");
  v4 = printf("<table class=\"navicontent_table\" CELLPADDING=0 CELLSPACING=0 >\n ");
  str(v4);
  puts("<td valign=top>");
  v5 = printf("<table class=\"navicontent_table\" width=100%% CELLPADDING=0 CELLSPACING=0 >\n");
  str(v5);
  puts("<td>");
  puts("<table class=\"navicontent_table\" CELLPADDING=0 CELLSPACING=0>");
  print_navi_image((int)"navimenu_plusnode.gif", (int)"advance_picon", (int)"advance_setup", 1);
  print_navi_image((int)"navimenu_title_advance_setup.gif", (int)"advance_foldericon", (int)"", 0);
  v7 = get_ux_text_common(791, v6);
  v8 = print_navi_title("advance_setup", v7);
  etr(v8);
  puts("</table>");
  v9 = printf("</td>");
  v10 = etr(v9);
  str(v10);
  printf("<td id=\"%s\" style=\"display:none;\" >\n", "advance_setup");
  puts("<table class=\"navicontent_table\" CELLPADDING=0 CELLSPACING=0>");
  print_menu_group(3, (int)"netconf", v14);
  print_menu_group(3, (int)"wirelessconf", v14);
  print_menu_group(3, (int)"wirelessconf5g", v14);
  print_menu_group(3, (int)"natrouterconf", v14);
  print_menu_group(3, (int)"firewallconf", v14);
  print_menu_group(3, (int)"expertconf", v14);
  print_menu_group(3, (int)"trafficconf", v14);
  print_menu_group(3, (int)"sysconf", v14);
  print_menu_group(3, (int)"nasconf", v14);
  print_menu_group(3, (int)"basicapp", v14);
  print_menu_group(3, (int)"plugin", v14);
  puts("</table>");
  v11 = printf("</td>");
  etr(v11);
  puts("</table>");
  v12 = printf("</td>");
  etr(v12);
  puts("</table>");
  puts("</form>");
  return puts("</body>");
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);

//----- (000192F8) --------------------------------------------------------
int __fastcall setTDWIDTH(int result, int a2)
{
  int v2; // r6@1
  int v3; // r5@1
  int v4; // r4@1

  v2 = result;
  v3 = a2;
  v4 = 0;
  while ( v4 < v2 )
  {
    ++v4;
    result = printf("<td width=%d ></td>\n", v3);
  }
  return result;
}

//----- (0001932C) --------------------------------------------------------
int __fastcall print_navi_image(int a1, int a2, int a3, int a4)
{
  int v4; // r6@1
  int v5; // r5@1
  void *v6; // r0@2
  int result; // r0@2
  void *v8; // r0@3

  v4 = a2;
  v5 = a3;
  if ( a4 )
  {
    puts("<td>");
    v6 = add_image_prefix();
    result = printf("<img class=navi_click_img id=\"%s\" src=\"%s\" onclick=\"toggle('%s','');\"></td>\n", v4, v6, v5);
  }
  else
  {
    puts("<td width=16>");
    v8 = add_image_prefix();
    result = printf("<img id=\"%s\" src=\"%s\"></td>\n", v4, v8);
  }
  return result;
}

//----- (000193A0) --------------------------------------------------------
int __fastcall print_navi_title(const char *a1, int a2)
{
  const char *v2; // r5@1
  int v3; // r6@1
  int v5; // [sp+0h] [bp-50h]@1

  v2 = a1;
  v3 = a2;
  snprintf((char *)&v5, 0x40u, "%s_td", a1);
  printf("<td id=\"%s\">\n", &v5);
  if ( !strcmp(v2, "basic_setup") )
    printf("<span style=\"margin-left:4;\">%s</span>\n", v3);
  else
    printf(
      "<span style=\"cursor:pointer; margin-left:4;\" onclick=\"toggle('%s',%s);\" \t\t\t\tonmouseover=\"this.style.textD"
      "ecoration='underline'\" \t\t\t\tonmouseout=\"this.style.textDecoration='none'\" \t\t\t\tOnFocus=this.blur(); >%s</span>\n",
      v2,
      &v5,
      v3);
  return printf("</td>");
}

//----- (00019434) --------------------------------------------------------
int __fastcall print_detail_menu(int a1, int a2, const char *a3, int a4, int a5, int a6, int a7)
{
  const char *v7; // r4@1
  int v8; // r5@1
  int v9; // r6@1
  int v10; // r0@1
  void *v11; // r0@6
  void *v12; // r0@7
  void *v13; // r0@8
  const char *v14; // r0@8
  const char *v15; // r0@12
  int v16; // r0@16
  char v18; // [sp+8h] [bp-120h]@1
  char s; // [sp+88h] [bp-A0h]@1

  v7 = a3;
  v8 = a1;
  v9 = a4;
  snprintf(&s, 0x80u, "%s_%s_%d_td", a3, a4, a1);
  v10 = snprintf(&v18, 0x80u, "%s_%s", v7, v9);
  str(v10);
  if ( v8 )
  {
    if ( v8 == 2 || !strcmp(v7, "sysconf") )
    {
      setTDWIDTH(v8 - 1, 16);
    }
    else
    {
      setTDWIDTH(v8 - 2, 16);
      puts("<td>");
      v11 = add_image_prefix();
      printf("<img src=\"%s\"></td>\n", v11);
    }
    puts("<td>");
    v12 = add_image_prefix();
    printf("<img src=\"%s\"></td>\n", v12);
  }
  else
  {
    setTDWIDTH(1, 16);
  }
  puts("<td>");
  v13 = add_image_prefix();
  printf("<img src=\"%s\"></td>\n", v13);
  printf("<td id=\"%s\">\n", &s);
  v14 = (const char *)puts("<span style=\"margin-left:4px;\">");
  if ( a7 )
    v14 = "<a href=\"timepro.cgi?tmenu=%s&smenu=%s&helpmenu=1&mainscreen=1\"";
  if ( !a7 )
    v14 = "<a href=\"timepro.cgi?tmenu=%s&smenu=%s\"";
  printf(v14, v7, v9);
  v15 = (const char *)printf(" target=\"main\"  OnFocus=this.blur(); ");
  if ( a7 )
    v15 = "onclick=\"toggle_detail_help('%s'); parent.menu_title.location.href='timepro.cgi?tmenu=%s&smenu=%s&helpmenu=1'\"; >\n";
  if ( !a7 )
    v15 = "onclick=\"toggle_detail('%s'); parent.menu_title.location.href='timepro.cgi?tmenu=%s&smenu=%s'\"; >\n";
  printf(v15, &s, "menu_titlebar", &v18);
  printf("%s", a5);
  v16 = printf("</span></td>");
  return etr(v16);
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);

//----- (000195F4) --------------------------------------------------------
int sub_195F4()
{
  printf("<style>");
  printf("#sysinfo_iframe tr { height: 23px; }");
  printf("#sysinfo_iframe td.title { border:1px solid #CCC; border-left-width: 0px; }");
  printf(".td_desc { padding: 0 10px 0px 10px; }");
  printf(".td_item { padding: 0 10px 0 10px; }");
  printf("tr.odd { background-color: #FFF; }");
  printf("tr.even { background-color: #F7F7F7; }");
  printf(".border_right { border-right: 1px solid #CCC; }");
  printf(".border_left { border-left-color: #CCC; border-left-width: 0px; border-left-style:solid; width:150px;}");
  return printf("</style>");
}

//----- (00019674) --------------------------------------------------------
int __fastcall print_system_end(int a1)
{
  int v1; // r4@1

  v1 = a1;
  puts("<tr><td class='title' colspan=10>");
  printf("<table width=100%% border=0 cellspacing=0 cellpadding=0>\n");
  puts("<tr class=\"even\"><td>");
  printf("<span style=\"padding-left:10px;\" class=\"subtitle_string\">%s</span></td></tr>\n", v1);
  puts("</table>");
  return puts("</td></tr>");
}

//----- (000196CC) --------------------------------------------------------
void *__fastcall get_internet_conn_type(const char *a1)
{
  const char *v1; // r4@1
  int v2; // r1@1
  int v3; // r0@2
  const char *v4; // r0@7

  v1 = a1;
  if ( !strcmp(a1, "static") )
  {
    v3 = 1266;
LABEL_7:
    v4 = (const char *)get_ux_text_common(v3, v2);
    strcpy((char *)&unk_CA3DC, v4);
    return &unk_CA3DC;
  }
  if ( !strcmp(v1, "dynamic") )
  {
    v3 = 1254;
    goto LABEL_7;
  }
  if ( strcmp(v1, "pppoe") )
    return &unk_CA3DC;
  v3 = 1261;
  goto LABEL_7;
}

//----- (00019740) --------------------------------------------------------
int __fastcall print_system_external_info(const char *a1)
{
  const char *v1; // r5@1
  int v2; // r4@1
  int v3; // r1@3
  const char *v4; // r0@4
  char *v5; // r6@6
  int v6; // r1@6
  int v7; // r0@7
  int v8; // r0@14
  int v9; // r1@14
  int v10; // r0@15
  const char *v11; // r0@18
  const char *v12; // r1@22
  char *v13; // r0@22
  const char *v14; // r1@25
  char *v15; // r0@25
  int v16; // r0@26
  int v17; // r1@29
  char *v18; // r7@34
  int v19; // r1@34
  const char *v20; // r0@34
  int v21; // r8@34
  int v22; // r1@34
  const char *v23; // r0@35
  const char *v24; // r6@40
  int v25; // r1@40
  int v26; // r0@40
  int v27; // r1@40
  int v28; // r0@40
  void *v29; // r0@42
  int v30; // r0@42
  int v31; // r1@42
  int v32; // r0@43
  int v33; // r1@44
  int v34; // r0@44
  char *v35; // r0@46
  bool v36; // zf@47
  const char *v37; // r1@47
  int v38; // r1@50
  int v39; // r0@50
  int v40; // r0@50
  unsigned int v41; // r0@51
  int v42; // r6@52
  char dest[512]; // [sp+4h] [bp-2DCh]@1
  char v45; // [sp+204h] [bp-DCh]@20
  char v46; // [sp+224h] [bp-BCh]@20
  char v47; // [sp+244h] [bp-9Ch]@50
  char v48; // [sp+264h] [bp-7Ch]@50
  char s1; // [sp+284h] [bp-5Ch]@1
  char v50; // [sp+298h] [bp-48h]@1
  char v51; // [sp+2A8h] [bp-38h]@1
  char v52; // [sp+2B8h] [bp-28h]@1

  v1 = a1;
  get_wan_hw_ifname(a1, &v52);
  get_wan_type(v1, &v51);
  get_wan_hw_ifname(v1, &v50);
  get_wan_type(v1, &s1);
  strcpy(dest, "");
  v2 = get_wan_link(v1);
  if ( get_usb_tethering_status(v2) )
    v2 = 1;
  if ( wireless_get_wwan_enable(0) )
  {
    v4 = (const char *)get_ux_text_common(1710, v3);
    strcpy(dest, v4);
  }
  if ( !v2 )
  {
    v5 = dest;
    if ( wireless_get_wwan_enable(0) )
      v7 = 1295;
    else
      v7 = 146;
    goto LABEL_38;
  }
  if ( !strcmp(&s1, "pppoe") || !strcmp(&s1, "pptp") )
  {
    if ( !get_idle_timeout(&v50) && get_wansetup_status(v1) )
    {
      v8 = get_pppoe_status(v1);
      if ( !v8 )
      {
        v10 = 429;
LABEL_25:
        v14 = (const char *)get_ux_text_common(v10, v9);
        v15 = dest;
LABEL_39:
        strcat(v15, v14);
        goto LABEL_40;
      }
      if ( v8 != 4 )
      {
        if ( v8 != 6 )
          goto LABEL_40;
        v10 = 1259;
        goto LABEL_25;
      }
      v5 = dest;
      if ( !strcmp(v1, "wan2") )
        v11 = "ppp2";
      else
        v11 = "ppp1";
      get_ifconfig((int)v11, (int)&v46, (int)&v45);
      if ( !v46 )
      {
        v7 = 1255;
LABEL_38:
        v14 = (const char *)get_ux_text_common(v7, v6);
        v15 = v5;
        goto LABEL_39;
      }
      v12 = (const char *)get_ux_text_common(1256, v6);
      v13 = dest;
LABEL_31:
      strcat(v13, v12);
      v2 = 1;
      goto LABEL_40;
    }
    v5 = dest;
    v16 = get_wansetup_status(v1);
    if ( v16 )
    {
      v7 = 1260;
      goto LABEL_38;
    }
    goto LABEL_33;
  }
  get_ifconfig((int)&v50, (int)&v46, (int)&v45);
  if ( v46 )
  {
    v12 = (const char *)get_ux_text_common(1256, v17);
    v13 = dest;
    goto LABEL_31;
  }
  v5 = dest;
  v16 = get_wansetup_status(v1);
  if ( !v16 )
  {
LABEL_33:
    v7 = v16 + 432;
    goto LABEL_38;
  }
  v18 = &dest[strlen(dest)];
  v20 = (const char *)get_ux_text_common(1260, v19);
  v21 = sprintf(v18, v20);
  if ( istatus_get_intvalue_direct((int)"lanwan_samenetwork") == 1 )
  {
    v23 = (const char *)get_ux_text_common(1265, v22);
    sprintf(&v18[v21], v23, "JavaScript:MovePagetoMain('netconf','lansetup');");
    goto LABEL_40;
  }
  if ( istatus_get_intvalue_direct((int)"privateip") == 1 )
  {
    v7 = 1263;
    goto LABEL_38;
  }
LABEL_40:
  printf("<tr class='%s'>", "odd");
  v24 = "gray_text";
  v26 = get_ux_text_common(1293, v25);
  printf("<td class='td_desc border_left'>%s</td>\n", v26);
  puts("<td class='td_item border_right' colspan=3 >");
  printf("%s", dest);
  puts("</td>");
  printf("</tr>");
  printf("<tr class='%s'>", "even");
  v28 = get_ux_text_common(1294, v27);
  printf("<td class='td_desc border_left'>%s</td>\n", v28);
  puts("<td class=td_item>");
  if ( v2 )
    v24 = "item_text";
  v29 = get_internet_conn_type(&v51);
  v30 = printf("<span class=%s>%s ", v24, v29);
  if ( get_usb_tethering_status(v30) )
  {
    v32 = get_ux_text_common(1390, v31);
    printf("(%s)", v32);
  }
  printf("</span>");
  puts("</td>");
  v34 = get_ux_text_common(247, v33);
  printf("<td class=td_desc>%s</td>\n", v34);
  puts("<td class=\"td_item border_right\" style=\"width:162px;\">");
  if ( !strcmp(&v51, "pppoe") || !strcmp(&v51, "pptp") )
  {
    v36 = strcmp(v1, "wan2") == 0;
    v37 = "ppp1";
    if ( v36 )
      v37 = "ppp2";
    sf_strncpy(&s1, v37, 20);
    v35 = &s1;
  }
  else
  {
    v35 = &v52;
  }
  get_ifconfig((int)v35, (int)&v48, (int)&v47);
  printf("<span class=%s style='font-weight: bold;'>%s</span>");
  puts("</td>");
  printf("</tr>");
  printf("<tr class='%s'>", "odd");
  v39 = get_ux_text_common(430, v38);
  printf("<td class='td_desc border_left'>%s</td>\n", v39);
  v40 = puts("<td class='td_item border_right' colspan=3 class=td_item>");
  if ( v2 )
  {
    v42 = get_system_running_time(v40);
    v41 = v42 - get_internet_connected_time(v1);
  }
  else
  {
    v41 = 0;
  }
  timetostr(v41, (int)dest, 512);
  printf("<span class=%s>%s</span>");
  puts("</td>");
  return printf("</tr>");
}
// 1055C: using guessed type int __fastcall get_wansetup_status(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 106D0: using guessed type int __fastcall get_system_running_time(_DWORD);
// 106DC: using guessed type int __fastcall get_wan_type(_DWORD, _DWORD);
// 10D00: using guessed type int __fastcall get_idle_timeout(_DWORD);
// 10E8C: using guessed type int __fastcall get_wan_link(_DWORD);
// 10FD0: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// 11AB0: using guessed type int __fastcall wireless_get_wwan_enable(_DWORD);
// 11E10: using guessed type int __fastcall get_usb_tethering_status(_DWORD);
// 11E7C: using guessed type int __fastcall get_internet_connected_time(_DWORD);
// 1205C: using guessed type int __fastcall get_pppoe_status(_DWORD);
// 19740: using guessed type char dest[512];

//----- (00019C18) --------------------------------------------------------
int __fastcall print_system_firmware_info(int a1)
{
  int v1; // r5@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@2
  const char *v8; // r0@6
  int v9; // r1@6
  int v10; // r0@6
  int v12; // [sp+0h] [bp-3F0h]@6
  char s; // [sp+10h] [bp-3E0h]@6
  char v14; // [sp+24h] [bp-3CCh]@6
  char v15; // [sp+3B8h] [bp-38h]@1
  char v16; // [sp+3CCh] [bp-24h]@1

  v1 = dhcpd_get_op(a1);
  printf("<tr class='%s'>", "odd");
  v3 = get_ux_text_common(428, v2);
  printf("<td class='td_desc border_left'>%s</td>\n", v3);
  puts("<td class='td_item border_right' colspan=3>");
  get_ifconfig((int)"br0", (int)&v16, (int)&v15);
  puts(&v16);
  puts("</td>");
  printf("</tr>");
  printf("<tr class='%s'>", "even");
  v5 = get_ux_text_common(810, v4);
  printf("<td class='td_desc border_left'>%s</td>\n", v5);
  printf("<td class=\"td_item border_right\" colspan=3>");
  if ( v1 )
  {
    if ( get_dhcp_auto_detect_status("br0") )
      v7 = 813;
    else
      v7 = 808;
  }
  else
  {
    v7 = 811;
  }
  v8 = (const char *)get_ux_text_common(v7, v6);
  printf(v8);
  puts("</td>");
  printf("</tr>");
  printf("<tr class='%s'>", "odd");
  v10 = get_ux_text_common(1248, v9);
  printf("<td class='td_desc border_left'>%s</td>\n", v10);
  puts("<td class=\"td_item border_right\" colspan=3 >");
  dhcpd_read_config(&v12);
  puts(&s);
  printf(" - ");
  print_nbsp(1);
  puts(&v14);
  puts("</td>");
  return printf("</tr>");
}
// 10AF0: using guessed type int __fastcall get_dhcp_auto_detect_status(_DWORD);
// 10D48: using guessed type int __fastcall dhcpd_get_op(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 11600: using guessed type int __fastcall dhcpd_read_config(_DWORD);

//----- (00019D70) --------------------------------------------------------
int __fastcall print_system_wireless_info(int a1)
{
  int v1; // r4@1
  int v2; // r5@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r1@2
  int v7; // r0@3
  const char *v8; // r0@5
  int v9; // r1@5
  int v10; // r0@6
  int v11; // r0@8
  int v12; // r0@10
  const char *v13; // r0@11
  int v14; // r1@12
  int v15; // r0@12
  void *v16; // r0@12
  int v17; // r1@13
  int v18; // r0@13
  int v19; // r1@14
  int v20; // r0@14
  int v21; // r1@14
  const char *v22; // r0@15
  int v23; // r1@15
  int *v24; // r4@16
  signed int v25; // r2@18
  int v26; // r0@24
  int v27; // r0@26
  int v28; // r1@26
  int v29; // r0@27
  int v30; // r0@29
  int v31; // r0@31
  const char *v32; // r0@32
  int v34; // [sp+0h] [bp-660h]@1
  char v35; // [sp+4h] [bp-65Ch]@12
  int v36; // [sp+A4h] [bp-5BCh]@7
  char v37; // [sp+130h] [bp-530h]@13
  int v38; // [sp+1D0h] [bp-490h]@14
  int v39; // [sp+350h] [bp-310h]@23
  char v40; // [sp+354h] [bp-30Ch]@15
  int v41; // [sp+578h] [bp-E8h]@16
  int v42; // [sp+64Ch] [bp-14h]@15

  v1 = a1;
  v2 = wireless_api_get_operation_mode();
  read_wireless_conf(&v34, v1);
  printf("<tr class='%s'>", "odd");
  v4 = get_ux_text_common(1310, v3);
  printf("<td class='td_desc border_left'>%s</td>\n", v4);
  puts("<td class=\"td_item border_right\" colspan=3>");
  if ( v34 )
  {
    if ( get_ifstatus(v1) )
      v7 = 1102;
    else
      v7 = 1438;
    v8 = (const char *)get_ux_text_common(v7, v6);
    printf(v8);
    if ( v2 == 2 )
    {
      v10 = get_ux_text_common(1116, v9);
      printf(" - %s", v10);
    }
    if ( v36 )
      v11 = 1309;
    else
      v11 = 1308;
    v12 = get_ux_text_common(v11, v9);
    printf(" - %s ", v12);
  }
  else
  {
    v13 = (const char *)get_ux_text_common(1109, v5);
    printf(v13);
  }
  puts("</td>");
  printf("</tr>");
  printf("<tr class='%s'>", "even");
  v15 = get_ux_text_common(1283, v14);
  printf("<td class='td_desc border_left'>%s</td>\n", v15);
  puts("<td class=\"td_item border_right\" colspan=3>");
  v16 = getTags(&v35);
  printf("%s", v16);
  puts("</td>");
  printf("</tr>");
  if ( v36 )
  {
    printf("<tr class='%s'>", "odd");
    puts("<td class='td_desc border_left'>");
    printf(
      "<input type='checkbox' id='pwCheckbox_%s' onclick=\"toggleDisplay('%s');\" style=\"vertical-align:middle;\">",
      v1,
      v1);
    v18 = get_ux_text_common(1272, v17);
    printf("<label for='pwCheckbox_%s'><span>%s</span></label>", v1, v18);
    printf("<input type='hidden' id='pwValue_%s' value='", v1);
    print_escape_str(&v37);
    printf("'>");
    puts("</td>");
    puts("<td class=\"td_item\">");
    printf("<span id=\"pwCell_%s\"></span>", v1);
    puts("</td>");
    puts("<td class=\"td_item border_right\" colspan=2>");
    puts("</td>");
    printf("</tr>");
  }
  printf("<tr class='%s'>");
  v20 = get_ux_text_common(1277, v19);
  printf("<td class='td_desc border_left'>%s</td>\n", v20);
  puts("<td class=\"td_item border_right\" colspan=3>");
  if ( v38 )
  {
    v22 = (const char *)get_ux_text_common(1102, v21);
    printf(v22);
    wireless_api_get_mbridge_connection_status(&v40, &v42);
    if ( !get_ifstatus(&v40) || (v24 = &v41, !wireless_api_get_mbridge_status(&v40, &v41)) )
      v24 = 0;
    v25 = (signed int)v24;
    if ( v24 )
      v25 = 1;
    if ( v42 != 3 )
      v25 = 0;
    if ( v25 )
    {
      if ( v39 )
        v26 = 1311;
      else
        v26 = 1312;
      v27 = get_ux_text_common(v26, v23);
      printf(" - %s", v27);
      if ( v24[47] )
      {
        v29 = get_ux_text_common(1298, v28);
        printf("(%s : %d%%)", v29, v24[47]);
      }
    }
    else
    {
      if ( v42 )
        v30 = 1296;
      else
        v30 = 1295;
      v31 = get_ux_text_common(v30, v23);
      printf(" - %s", v31);
    }
  }
  else
  {
    v32 = (const char *)get_ux_text_common(1109, v21);
    printf(v32);
  }
  puts("</td>");
  printf("</tr>");
  return printf("<tr style='display:none;'></tr>");
}
// 107CC: using guessed type int __fastcall read_wireless_conf(_DWORD, _DWORD);
// 117EC: using guessed type int __fastcall wireless_api_get_mbridge_connection_status(_DWORD, _DWORD);
// 11C54: using guessed type int __fastcall wireless_api_get_mbridge_status(_DWORD, _DWORD);
// 11EE8: using guessed type int wireless_api_get_operation_mode(void);
// 12020: using guessed type int __fastcall get_ifstatus(_DWORD);

//----- (0001A0C8) --------------------------------------------------------
int print_system_remotemgmt_info()
{
  int v0; // r4@1
  int v1; // r5@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  const char *v5; // r0@2
  const char *v6; // r0@3
  int v7; // r1@4
  const char *v8; // r0@4

  v0 = get_remote_mgmt_port();
  v1 = get_remote_mgmt_flag();
  printf("<tr class='even'>");
  v3 = get_ux_text_common(1062, v2);
  printf("<td class='td_desc border_left'>%s</td>\n", v3);
  puts("<td class='td_item border_right' colspan=3>");
  if ( v1 )
  {
    v5 = (const char *)get_ux_text_common(1063, v4);
    printf(v5, v0);
  }
  else
  {
    v6 = (const char *)get_ux_text_common(1064, v4);
    puts(v6);
  }
  printf("</td>");
  printf("</tr>");
  printf("<tr class='odd'>");
  puts("<td class='td_desc border_left'></td>");
  puts("<td class='td_item border_right' colspan=3>");
  v8 = (const char *)get_ux_text_common(1297, v7);
  printf(v8, "JavaScript:MovePagetoMain('firewallconf','accesslist');");
  printf("</td>");
  return printf("</tr>");
}
// 10A3C: using guessed type int get_remote_mgmt_port(void);
// 118DC: using guessed type int get_remote_mgmt_flag(void);

//----- (0001A194) --------------------------------------------------------
int sub_1A194()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r0@1
  const char *v3; // r4@1

  printf("<tr class='odd'>");
  v1 = get_ux_text_common(1194, v0);
  v2 = printf("<td class='td_desc border_left'>%s</td>\n", v1);
  v3 = (const char *)get_firmware_version2(v2);
  puts("<td class='td_item border_right' colspan=3>");
  puts(v3);
  printf("</td>");
  return printf("</tr>");
}
// 10A00: using guessed type int __fastcall get_firmware_version2(_DWORD);

//----- (0001A1F4) --------------------------------------------------------
int sub_1A1F4()
{
  sub_195F4();
  print_js_file((int)"system", (int)"info");
  puts("<tr><td style=\"padding-left:0px; border-left: 1px solid #CCC;\">");
  puts("<table id=\"sysinfo_iframe\" class=menu_content_list_noline_table cellspacing=0px cellpadding=0px style=\"width:640px; border-bottom: 1px solid #CCC; overflow-y: hidden;\">");
  printf("</table>");
  puts("<iframe src=\"timepro.cgi?tmenu=iframe&smenu=system_info_status\" name=\"system_info_status\" style=\"display:none;\"></iframe>");
  return puts("</td></tr>");
}

//----- (0001A250) --------------------------------------------------------
int print_iframe_system_info_status()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r1@1
  int v9; // r0@1
  int v10; // r1@1
  int v11; // r0@1
  int v12; // r0@1
  unsigned int v13; // r0@1
  int v15; // [sp+0h] [bp-110h]@1

  sub_195F4();
  print_js_file((int)"system", (int)"info");
  puts("<tr><td style=\"padding-left:0px; border-left: 1px solid #CCC;\">");
  puts("<table id=\"sysinfo_iframe\" class=menu_content_list_noline_table cellspacing=0px cellpadding=0px style=\"width: 640px; border-bottom: 1px solid #CCC; overflow-y: hidden;\">");
  v1 = get_ux_text_common(1301, v0);
  print_system_end(v1);
  print_system_external_info("wan1");
  v3 = get_ux_text_common(1300, v2);
  print_system_end(v3);
  print_system_firmware_info(0);
  v5 = get_ux_text_common(1304, v4);
  print_system_end(v5);
  print_system_wireless_info((int)"eth2");
  v7 = get_ux_text_common(1305, v6);
  print_system_end(v7);
  print_system_wireless_info((int)"eth1");
  v9 = get_ux_text_common(1299, v8);
  print_system_end(v9);
  sub_1A194();
  print_system_remotemgmt_info();
  printf("<tr class='even'>");
  v11 = get_ux_text_common(1313, v10);
  printf("<td class='td_desc border_left'>%s</td>\n", v11);
  v12 = puts("<td class='td_item border_right' colspan=3>");
  v13 = get_system_running_time(v12);
  timetostr(v13, (int)&v15, 256);
  printf("%s", &v15);
  printf("</td>");
  printf("</tr>");
  printf("</table>");
  printf("<script>");
  printf("setPasswordDisplay('%s');", "eth2");
  printf("setPasswordDisplay('%s');", "eth1");
  printf("parent.document.getElementById('sysinfo_iframe').outerHTML = document.getElementById('sysinfo_iframe').outerHTML;");
  printf("setTimeout(function() {");
  printf("location.reload();");
  printf("}, 3000);");
  return printf("</script>");
}
// 106D0: using guessed type int __fastcall get_system_running_time(_DWORD);

//----- (0001A3E4) --------------------------------------------------------
int system_info()
{
  puts("<table cellpadding=0px cellspacing=0px style=\"padding-left:0px;\">");
  sub_1A1F4();
  printf("</table>");
  printf("<script>");
  printf("document.getElementsByTagName('body')[0].style.overflowX = 'hidden';");
  return printf("</script>");
}

//----- (0001A434) --------------------------------------------------------
int __fastcall sub_1A434(char *a1, int a2)
{
  char *v2; // r3@15

  if ( a1 == (char *)21600 )
    return a2 == (_DWORD)a1;
  if ( (signed int)a1 <= 21600 )
  {
    if ( a1 == (char *)1800 )
      return a2 == (_DWORD)a1;
    if ( (signed int)a1 <= 1800 )
    {
      if ( a1 == (char *)60 )
        return a2 == 60;
      if ( a1 == (char *)600 )
        return a2 == 600;
      return 0;
    }
    if ( a1 == (char *)7200 )
      return a2 == (_DWORD)a1;
    if ( a1 == (char *)14400 )
      return a2 == 14400;
    if ( a1 == (char *)3600 )
      return a2 == 3600;
    return 0;
  }
  if ( (_UNKNOWN *)a1 == &loc_15180 )
    return a2 == (_DWORD)a1;
  if ( (signed int)a1 > 86400 )
  {
    if ( (_UNKNOWN *)a1 == &loc_3F480 || a1 == "2);\">" )
      return a2 == (_DWORD)a1;
    v2 = (_BYTE *)&loc_2A300;
  }
  else
  {
    if ( a1 == (char *)43200 )
      return a2 == (_DWORD)a1;
    v2 = (char *)64800;
  }
  if ( a1 == v2 )
    return a2 == (_DWORD)a1;
  return 0;
}

//----- (0001A53C) --------------------------------------------------------
int sub_1A53C()
{
  puts("<style type=\"text/css\">");
  puts(".lansetup_main_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".lansetup_main_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".lansetup_main_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".lansetup_main_p {");
  puts("\tpadding-left:5px; display:inline-block;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".lansetup_main_span {");
  puts("\tdisplay:inline-block; vertical-align:middle;");
  puts("}");
  puts(".lansetup_main_button {");
  puts("\tpadding:0 1 0 1; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".lansetup_main_td input[type=checkbox], .lansetup_main_td input[type=radio] {");
  puts("display:inline-block; vertical-align:middle;");
  puts("}");
  puts("#lansetup_div_msg p {");
  puts("margin:5 0 5 15px; text-align:left;");
  puts("}");
  puts(".lansetup_ellipsis {");
  puts("text-overflow:ellipsis; overflow:hidden; white-space:nowrap; text-align:left;");
  puts("}");
  printf("input[type=\"text\"] {border:1px #CCC solid;}");
  printf("input[type=\"password\"] {border:1px #CCC solid;}");
  printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td, img {cursor:default;}");
  return printf("</style>");
}

//----- (0001A6D4) --------------------------------------------------------
unsigned int __fastcall sub_1A6D4(const char *a1, const char *a2)
{
  unsigned int v2; // r4@1

  v2 = __rev(inet_addr(a1));
  return v2 - __rev(inet_addr(a2));
}

//----- (0001A6F8) --------------------------------------------------------
signed int __fastcall sub_1A6F8(int a1, int a2, const char *a3)
{
  int v3; // r4@1
  const char *v4; // r7@1
  int v5; // r6@1
  int i; // r5@1
  int v7; // r0@2

  v3 = a2;
  v4 = a3;
  v5 = a1;
  for ( i = 0; ; ++i )
  {
    if ( i >= v3 )
      return 0;
    v7 = strcmp((const char *)(v5 + 148), v4);
    v5 += 188;
    if ( !v7 )
      break;
  }
  return 1;
}

//----- (0001A744) --------------------------------------------------------
int __fastcall select_work(int a1)
{
  int v1; // r4@1
  int result; // r0@1
  int v3; // r5@2
  int v4; // r6@5
  int v5; // r0@12
  signed int v6; // r3@18
  int v7; // r0@26
  signed int v8; // r7@28
  int v9; // r0@28
  signed int v10; // r3@28
  int v11; // r7@31
  int v12; // r0@33
  int v13; // r0@33
  signed int v14; // r8@35
  int v15; // r7@43
  int v16; // r6@43
  int v17; // r7@43
  int v18; // r0@44
  int v19; // r0@44
  int v20; // r7@45
  int v21; // r0@47
  signed int v22; // r0@48
  int v23; // r0@50
  int v24; // r0@52
  int v25; // r0@57
  char v26; // [sp+8h] [bp-488h]@5
  int v27; // [sp+18h] [bp-478h]@7
  int v28; // [sp+2Ch] [bp-464h]@7
  char v29; // [sp+40h] [bp-450h]@7
  int v30; // [sp+54h] [bp-43Ch]@7
  int v31; // [sp+68h] [bp-428h]@7
  char v32; // [sp+7Ch] [bp-414h]@24
  char v33; // [sp+94h] [bp-3FCh]@24
  char v34; // [sp+9Ch] [bp-3F4h]@20
  int v35; // [sp+3BCh] [bp-D4h]@20
  char s; // [sp+3C0h] [bp-D0h]@44
  char s1; // [sp+3E0h] [bp-B0h]@1
  char v38; // [sp+400h] [bp-90h]@2
  char v39; // [sp+420h] [bp-70h]@7
  int v40; // [sp+434h] [bp-5Ch]@7
  int v41; // [sp+448h] [bp-48h]@6
  int v42; // [sp+45Ch] [bp-34h]@5

  v1 = a1;
  result = get_value_post(a1, "act", &s1, 32);
  if ( !result )
    return result;
  v3 = get_value_post(v1, "reboot", &v38, 32);
  if ( v3 )
    v3 = strcmp(&v38, "reboot") == 0;
  if ( !strcmp(&s1, "submit") )
  {
    dhcpd_read_config(&v26);
    strcpy((char *)&v42, "");
    v4 = get_ip_value_post(v1, "ip", &v42);
    if ( v4 )
    {
      v4 = get_ip_value_post(v1, "sm", &v41);
      if ( v4 )
      {
        set_use_local_gateway(0);
        set_lan_ipconfig(&v42, &v41, 0);
        sf_strncpy(&v29, &v42, 20);
        sf_strncpy(&v30, &v41, 20);
        get_subnet_range(&v42, &v41, &v27, &v28);
        get_ifconfig((int)"br0", (int)&v40, (int)&v39);
        if ( !strcmp((const char *)&v31, (const char *)&v40) )
          sf_strncpy(&v31, &v42, 20);
        v4 = 1;
      }
    }
    if ( get_value_post(v1, "dhcp_enable", &v38, 32) && !strcmp(&v38, "on") )
    {
      v5 = dhcpd_set_op(1);
      dhcpd_stop(v5);
      if ( get_value_post(v1, "miprange", &v38, 32) && !strcmp(&v38, "on") )
      {
        if ( get_ip_value_post(v1, "spool_conf", &v38) )
          sf_strncpy(&v27, &v38, 20);
        if ( get_ip_value_post(v1, "epool_conf", &v38) )
          sf_strncpy(&v28, &v38, 20);
        v6 = 1;
      }
      else
      {
        v6 = 0;
      }
      v35 = v6;
      if ( !get_value_post(v1, "domain", &v34, 32) )
        strcpy(&v34, "");
      if ( check_unpermitted_chars(&v34) )
        strcpy(&v34, "");
      get_intvalue_post(v1, (int)"leasetime", (int)&v33);
      get_domain_name_server(&v31, &v32);
      set_autodns(1);
      v7 = get_value_post(v1, "dhcp_auto_detect", &v38, 32) && !strcmp(&v38, "on");
      set_dhcp_auto_detect(v7);
      v8 = 1;
      v9 = syslog_msg(1, "@{43}");
      v10 = 1;
    }
    else
    {
      v9 = get_value_post(v1, "dhcp_enable", &v38, 32);
      if ( v9 )
      {
        v9 = strcmp(&v38, "off");
        v11 = v9;
        if ( !v9 )
        {
          dhcpd_set_op(0);
          set_dhcp_auto_detect(v11);
          set_dhcp_access_policy(v11);
          v12 = syslog_msg(2, "@{44}");
          v13 = check_twinip_enable(v12);
          if ( v13 )
            v13 = dhcpd_start(v13);
          v9 = dhcpd_stop(v13);
          v8 = 0;
          v14 = 1;
LABEL_36:
          if ( v4 )
            v9 = dhcpd_commit_config(&v26);
          if ( v14 )
            v9 = dhcpd_flush_dynamic_lease(v9);
          if ( v8 )
            v9 = dhcpd_start(v9);
          if ( v3 )
          {
            v15 = hwinfo_get_reboot_duration(v9);
            v9 = check_remote_connection();
            v16 = v9;
            v17 = v15 + 30;
            if ( !v9 )
            {
              v18 = get_ip_value_post(v1, "ip", &v42);
              v19 = get_router_mgmt_port(v18);
              v9 = snprintf(&s, 0x20u, "%s:%d", &v42, v19);
            }
            goto LABEL_55;
          }
          goto LABEL_56;
        }
        v10 = v4;
        v8 = 0;
      }
      else
      {
        v10 = v4;
        v8 = 0;
      }
    }
    v14 = v4;
    v4 = v10;
    goto LABEL_36;
  }
  v9 = strcmp(&s1, "part");
  v20 = v9;
  if ( !v9 )
  {
    if ( get_value_post(v1, "dhcp_access_policy", &v38, 32) )
    {
      v21 = dhcpd_set_op(1);
      dhcpd_stop(v21);
      if ( !strcmp(&v38, "on") )
        v22 = 1;
      else
        v22 = v20;
      v23 = set_dhcp_access_policy(v22);
      dhcpd_start(v23);
    }
    v9 = get_value_post(v1, "mac_restrict", &v38, 32);
    if ( v9 )
    {
      v24 = strcmp(&v38, "on") == 0;
      v9 = set_ipmac_bind();
    }
  }
  if ( v3 )
  {
    v16 = 0;
    v17 = 0;
LABEL_55:
    v9 = saveconf(v9);
    goto LABEL_57;
  }
LABEL_56:
  v16 = v3;
  v17 = v3;
LABEL_57:
  v25 = signal_update(v9);
  result = signal_save(v25);
  if ( !v3 )
    return result;
  printf("<script>");
  if ( !v16 )
    printf("document.refreshURL = '%s';\n", &s);
  printf("document.rebootDuration = %d;", v17);
  printf("</script>");
  result = signal_reboot(3);
  return result;
}
// 1052C: using guessed type int __fastcall set_autodns(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10628: using guessed type int __fastcall set_dhcp_access_policy(_DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10934: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// 10B20: using guessed type int __fastcall set_dhcp_auto_detect(_DWORD);
// 10E08: using guessed type int __fastcall dhcpd_set_op(_DWORD);
// 10E50: using guessed type int __fastcall dhcpd_flush_dynamic_lease(_DWORD);
// 10FF4: using guessed type int __fastcall saveconf(_DWORD);
// 11000: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 113CC: using guessed type int syslog_msg(_DWORD, const char *, ...);
// 1157C: using guessed type int __fastcall get_router_mgmt_port(_DWORD);
// 11600: using guessed type int __fastcall dhcpd_read_config(_DWORD);
// 11678: using guessed type int __fastcall signal_reboot(_DWORD);
// 117C8: using guessed type int __fastcall dhcpd_commit_config(_DWORD);
// 1190C: using guessed type int __fastcall set_use_local_gateway(_DWORD);
// 11930: using guessed type int __fastcall dhcpd_stop(_DWORD);
// 11A44: using guessed type int __fastcall get_domain_name_server(_DWORD, _DWORD);
// 11A80: using guessed type int check_remote_connection(void);
// 11C60: using guessed type int __fastcall get_subnet_range(_DWORD, _DWORD, _DWORD, _DWORD);
// 11CA8: using guessed type int __fastcall set_lan_ipconfig(_DWORD, _DWORD, _DWORD);
// 11CF0: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// 11E4C: using guessed type int set_ipmac_bind(void);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);
// 1214C: using guessed type int __fastcall check_twinip_enable(_DWORD);

//----- (0001ACC8) --------------------------------------------------------
signed int __fastcall sub_1ACC8(int a1, _DWORD *a2)
{
  int v2; // r7@1
  _DWORD *v3; // r5@1
  int i; // r4@1

  v2 = a1;
  v3 = a2;
  for ( i = 0; ; ++i )
  {
    if ( i >= *v3 )
      return 0;
    if ( !maccmp(v2, &v3[51 * i + 10]) )
      break;
  }
  return 1;
}
// 11CB4: using guessed type int __fastcall maccmp(_DWORD, _DWORD);

//----- (0001AD1C) --------------------------------------------------------
int __fastcall sub_1AD1C(char *s2, int a2, int a3)
{
  char *v3; // r4@1
  int v4; // r7@1
  int v5; // r6@1
  int i; // r5@1
  int v7; // r0@2

  v3 = s2;
  v4 = a3;
  v5 = a2;
  for ( i = 0; ; ++i )
  {
    if ( i >= v4 )
      return 0;
    v7 = strcasecmp((const char *)(v5 + 148), v3);
    v5 += 188;
    if ( !v7 )
      break;
  }
  return 1;
}

//----- (0001AD68) --------------------------------------------------------
int sub_1AD68()
{
  char *v0; // r0@1
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r1@1
  int v4; // r0@1
  char v5; // r6@2
  unsigned int v6; // r0@3
  char *v7; // r0@3
  int v8; // r1@3
  int v9; // r0@3
  int v10; // r1@3
  int v11; // r0@3
  int v12; // r1@3
  int v13; // r0@3
  int v14; // r1@3
  int v15; // r0@3
  char v16; // r10@4
  int v17; // r0@4
  const char *v18; // r4@4
  int v19; // r8@4
  int v20; // r1@4
  const char *v21; // r6@5
  int v22; // r0@7
  const char *v23; // r1@7
  char *v24; // r6@7
  char *v25; // r1@8
  int v26; // r1@10
  int v27; // r0@10
  char *v28; // r1@11
  int v29; // r1@13
  int v30; // r0@13
  int v31; // r8@13
  int v32; // r1@13
  int v33; // r0@13
  int v34; // r1@13
  char v35; // r8@13
  int v36; // r1@13
  const char *v37; // r10@14
  int v38; // r0@16
  int v39; // r1@16
  int v40; // r0@18
  int v41; // r1@18
  int v42; // r0@20
  bool v43; // zf@25
  signed int v44; // r2@32
  char *v45; // r1@39
  char *v46; // r4@41
  char *v47; // r5@41
  int v48; // r1@41
  char *v49; // r7@42
  int v50; // r0@44
  int v51; // r1@44
  char *v52; // r7@45
  int v53; // r0@47
  int v54; // r1@47
  char *v55; // r7@48
  int v56; // r0@50
  int v57; // r1@50
  char *v58; // r7@51
  int v59; // r0@53
  int v60; // r1@53
  char *v61; // r7@54
  int v62; // r0@56
  int v63; // r1@56
  char *v64; // r7@57
  int v65; // r0@59
  int v66; // r1@59
  char *v67; // r7@60
  int v68; // r0@62
  int v69; // r1@62
  char *v70; // r7@63
  int v71; // r0@65
  int v72; // r1@65
  char *v73; // r7@66
  int v74; // r0@68
  int v75; // r1@68
  char *v76; // r7@69
  int v77; // r0@71
  int v78; // r1@71
  char *v79; // r7@72
  int v80; // r0@74
  int v81; // r1@74
  char *v82; // r7@75
  int v83; // r0@77
  int v84; // r1@77
  int v85; // r0@79
  int v86; // r1@79
  int v87; // r0@79
  int v88; // r1@79
  const char *v89; // r5@80
  int v90; // r0@82
  int v91; // r0@82
  int v92; // r1@82
  char *v93; // r6@83
  int v94; // r0@85
  int v95; // r1@85
  int v96; // r0@85
  const char *v97; // r1@86
  int v98; // r1@88
  int v99; // r7@88
  int v100; // r1@88
  int v101; // r6@88
  int v102; // r1@88
  int v103; // r0@88
  int v104; // r1@88
  int v105; // r0@88
  int v106; // r0@88
  int v107; // r1@88
  char *v108; // r6@89
  int v109; // r0@91
  int v110; // r0@91
  int v111; // r1@91
  int v112; // r0@93
  int v113; // r1@93
  int v114; // r0@93
  int v115; // r1@93
  const char *v116; // r0@93
  void *v117; // r4@93
  int v118; // r1@93
  int v119; // r0@93
  int v120; // r0@93
  int v121; // r0@94
  int v122; // r1@96
  int v123; // r0@96
  void *v124; // r4@96
  int v125; // r1@96
  int v126; // r0@96
  void *v127; // r4@96
  int v128; // r1@96
  int v129; // r0@96
  int v130; // r0@96
  int v131; // r0@97
  int v132; // r4@99
  int v133; // r1@99
  int v134; // r0@99
  int v135; // r1@100
  int v136; // r0@100
  int v137; // r1@102
  int v138; // r0@102
  void *v139; // r4@102
  int v140; // r1@102
  int v141; // r0@102
  int v142; // r0@102
  int v143; // r0@103
  int v144; // r0@103
  int v145; // r0@106
  void *v146; // r0@108
  char v148; // [sp+10h] [bp-820h]@3
  char v149; // [sp+20h] [bp-810h]@16
  int v150; // [sp+34h] [bp-7FCh]@16
  char *v151; // [sp+9Ch] [bp-794h]@20
  int v152; // [sp+A4h] [bp-78Ch]@79
  int v153; // [sp+3C4h] [bp-46Ch]@16
  char v154; // [sp+3C8h] [bp-468h]@93
  int v155; // [sp+458h] [bp-3D8h]@93
  char v156; // [sp+780h] [bp-B0h]@3
  char v157; // [sp+7A0h] [bp-90h]@1
  char v158; // [sp+7C0h] [bp-70h]@1
  char v159; // [sp+7E0h] [bp-50h]@1
  int v160; // [sp+7F4h] [bp-3Ch]@1
  int v161; // [sp+808h] [bp-28h]@1
  struct in_addr v162; // [sp+80Ch] [bp-24h]@1

  puts("<form method=post action=\"timepro.cgi\" name=\"netconf_lansetup\" style=\"margin:0; padding:0;\">");
  puts("<input type=hidden name=\"tmenu\" value=\"netconf\">");
  puts("<input type=hidden name=\"smenu\" value=\"lansetup\">");
  puts("<input type=hidden name=\"act\" value=\"\">");
  puts("<input type=hidden name=\"reboot\" value=\"\">");
  printf("<table class=\"v3_table lansetup_main_table\" width=\"100%%; padding:0; margin:0;\">\n");
  printf("<COL width=\"125\"><COL width=\"75\"><COL width=\"442\">");
  printf("<tr class=\"lansetup_main_tr\"><td class=\"lansetup_main_td\" width=\"100%%\" colspan=\"3\">");
  printf("<table class=\"v3_table lansetup_main_table\" width=\"100%%\">\n");
  printf("<COL width=\"110\"><COL width=\"160\"><COL width=\"240\"><COL width=\"%%%%\">");
  get_wan_ifname("wan1", &v160);
  get_ifconfig((int)&v160, (int)&v158, (int)&v157);
  inet_aton(&v158, &v162);
  inet_aton(&v157, (struct in_addr *)&v161);
  v162.s_addr &= v161;
  v0 = inet_ntoa(v162);
  printf("<input type=hidden name=\"wan1subnet\" value=\"%s\">\n", v0);
  v2 = get_ux_text_common(428, v1);
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s;\">\t\t<td class=\"lansetup_main_td\" styl"
    "e=\"padding-left:5px;\">%s</td>",
    "FFFFFF",
    v2);
  get_ifconfig((int)"br0", (int)&v158, (int)&v157);
  puts("<td class=\"lansetup_main_td\">");
  print_html_ip_address((int)"ip", &v158, 1);
  printf("</td><td colspan=\"2\" class=\"lansetup_main_td\">");
  get_hwaddr_kernel("br0", &v159);
  convert_mac(&v159);
  printf("<span class=\"lansetup_main_p\">(%s)</span>", &v159);
  puts("</td></tr>");
  v4 = get_ux_text_common(1118, v3);
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s;\">\t\t<td class=\"lansetup_main_td\" styl"
    "e=\"padding-left:5px;\">%s</td>",
    "F7F7F7",
    v4);
  puts("<td class=\"lansetup_main_td\">");
  print_html_ip_address((int)"sm", &v157, 2);
  puts("</td><td colspan=\"2\" class=\"lansetup_main_td\"></td></tr>");
  if ( istatus_get_intvalue_direct((int)"lanwan_samenetwork") == 1 )
  {
    v5 = 3;
    get_localbroadaddr("br0", &v156);
    v6 = inet_addr(&v156);
    v7 = inet_ntoa((struct in_addr)__rev(__rev(v6) + 2));
    strcpy(&v148, v7);
    printf(
      "<tr height=\"96\" class=\"lansetup_main_tr\" style=\"background-color:#%s;\">\t\t\t<td class=\"lansetup_main_td\" "
      "colspan=\"4\" style=\"padding-left:5px;\">\t\t\t<span class=\"lansetup_main_span\">",
      "FFFFFF");
    v9 = get_ux_text_common(501, v8);
    printf("<p>%s</p>", v9);
    v11 = get_ux_text_common(502, v10);
    printf("<p>%s</p>", v11);
    printf(
      "<p><input type=checkbox onclick=\"if(this.checked == true) SetIP('ip','%s'); else SetIP('ip','%s');\">",
      &v148,
      &v158);
    v13 = get_ux_text_common(500, v12);
    printf("%s</p>", v13);
    v15 = get_ux_text_common(503, v14);
    printf("<p>%s</p>", v15);
    puts("</span></td></tr>");
  }
  else
  {
    v5 = 2;
  }
  printf("</table>");
  v16 = v5 + 1;
  printf("</td></tr>");
  printf("<tr class=\"lansetup_main_tr\"><td class=\"lansetup_main_td\" width=\"100%%\" colspan=\"3\">");
  v17 = dhcpd_read_config(&v148);
  v18 = "F7F7F7";
  v19 = dhcpd_get_op(v17);
  printf("<table class=\"v3_table lansetup_main_table\" width=\"100%%\">\n");
  printf("<COL width=\"110\"><COL width=\"160\"><COL width=\"240\"><COL width=\"%%%%\">");
  if ( v5 & 1 )
    v21 = "F7F7F7";
  else
    v21 = "FFFFFF";
  v22 = get_ux_text_common(807, v20);
  v23 = v21;
  v24 = "checked";
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s;\">\t\t<td class=\"lansetup_main_td\" styl"
    "e=\"padding-left:5px;\">%s</td>",
    v23,
    v22);
  printf("<td class=\"lansetup_main_td\">");
  if ( v19 )
    v25 = "checked";
  else
    v25 = "";
  printf(
    "<input type=radio class=\"navi_radio\" id=\"enable_on_id\" name=\"dhcp_enable\" value=on %s onclick=\"ChangeDHCPServerOp();\"> \n",
    v25);
  v27 = get_ux_text_common(1104, v26);
  printf("<label for=\"enable_on_id\"><span class=\"netconf_lansetup_span\">%s</span></label>", v27);
  printf("<span class=\"lansetup_main_span\" style=\"width:25px;\"></span>");
  if ( v19 )
    v28 = "";
  else
    v28 = "checked";
  printf(
    "<input type=radio class=\"navi_radio\" id=\"enable_off_id\" name=\"dhcp_enable\" %s value=off onclick=\"ChangeDHCPServerOp();\"> \n",
    v28);
  v30 = get_ux_text_common(1112, v29);
  printf("<label for=\"enable_off_id\"><span class=\"netconf_lansetup_span\">%s</span></label>", v30);
  printf("</td>");
  printf("<td class=\"lansetup_main_td\" colspan=\"2\">");
  printf("<span class=\"lansetup_main_span\">");
  v31 = dhcpd_get_all_dynamic_lease(0, 0);
  v33 = get_ux_text_common(506, v32);
  v34 = v31;
  v35 = v16 + 1;
  printf("(%d %s)", v34, v33);
  printf("</span>");
  printf("</td></tr>");
  if ( v16 & 1 )
    v37 = "F7F7F7";
  else
    v37 = "FFFFFF";
  v38 = get_ux_text_common(805, v36);
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s;\">\t\t<td class=\"lansetup_main_td\" styl"
    "e=\"padding-left:5px;\">%s</td>",
    v37,
    v38);
  printf("<td class=\"lansetup_main_td\" colspan=\"3\">");
  print_html_ip_address((int)"spool_conf", &v149, 2);
  printf(" ~ &nbsp;");
  print_html_ip_address((int)"epool_conf", &v150, 2);
  if ( !v153 )
    v24 = "";
  v40 = get_ux_text_common(526, v39);
  printf(
    "<span class=\"lansetup_main_span\" style=\"margin-left:5px;\">\t\t<input type=checkbox class=\"navi_chk\" name=\"mip"
    "range\" id=\"miprange_id\" onclick=\"SetIPViewByCheckbox(this.checked);\" %s>\t\t<label for=\"miprange_id\">%s</label></span>",
    v24,
    v40);
  puts("</td></tr>");
  if ( !(v35 & 1) )
    v18 = "FFFFFF";
  v42 = get_ux_text_common(806, v41);
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s;\">\t\t<td class=\"lansetup_main_td\" styl"
    "e=\"padding-left:5px;\">%s</td>",
    v18,
    v42);
  printf("<td class=\"lansetup_main_td\">");
  printf("<select name=\"leasetime\">");
  if ( v151 == (char *)21600 )
    goto LABEL_40;
  if ( (signed int)v151 > 21600 )
  {
    if ( (_UNKNOWN *)v151 == &loc_15180 )
      goto LABEL_40;
    if ( (signed int)v151 > 86400 )
    {
      if ( (_UNKNOWN *)v151 == &loc_3F480 || v151 == "2);\">" )
        goto LABEL_40;
      v44 = 172800;
    }
    else
    {
      if ( v151 == (char *)43200 )
        goto LABEL_40;
      v44 = 64800;
    }
    v43 = v151 == (char *)v44;
  }
  else
  {
    if ( v151 == (char *)1800 )
      goto LABEL_40;
    if ( (signed int)v151 > 1800 )
    {
      if ( v151 == (char *)7200 || v151 == (char *)14400 )
        goto LABEL_40;
      v43 = v151 == (char *)3600;
    }
    else
    {
      if ( v151 == (char *)60 )
        goto LABEL_40;
      v43 = v151 == (char *)600;
    }
  }
  if ( !v43 )
  {
    v45 = "selected";
    goto LABEL_41;
  }
LABEL_40:
  v45 = "";
LABEL_41:
  v46 = "";
  v47 = "selected";
  printf("<option value=\"-\" %s>-</option>", v45);
  if ( sub_1A434((char *)0x3C, (int)v151) )
    v49 = "selected";
  else
    v49 = "";
  v50 = get_ux_text_common(517, v48);
  printf("<option value=\"60\" %s>%s</option>", v49, v50);
  if ( sub_1A434((char *)0x258, (int)v151) )
    v52 = "selected";
  else
    v52 = "";
  v53 = get_ux_text_common(515, v51);
  printf("<option value=\"600\" %s>%s</option>", v52, v53);
  if ( sub_1A434((char *)0x708, (int)v151) )
    v55 = "selected";
  else
    v55 = "";
  v56 = get_ux_text_common(510, v54);
  printf("<option value=\"1800\" %s>%s</option>", v55, v56);
  if ( sub_1A434((char *)0xE10, (int)v151) )
    v58 = "selected";
  else
    v58 = "";
  v59 = get_ux_text_common(513, v57);
  printf("<option value=\"3600\" %s>%s</option>", v58, v59);
  if ( sub_1A434((char *)0x1C20, (int)v151) )
    v61 = "selected";
  else
    v61 = "";
  v62 = get_ux_text_common(519, v60);
  printf("<option value=\"7200\" %s>%s</option>", v61, v62);
  if ( sub_1A434((char *)0x3840, (int)v151) )
    v64 = "selected";
  else
    v64 = "";
  v65 = get_ux_text_common(508, v63);
  printf("<option value=\"14400\" %s>%s</option>", v64, v65);
  if ( sub_1A434((char *)0x5460, (int)v151) )
    v67 = "selected";
  else
    v67 = "";
  v68 = get_ux_text_common(511, v66);
  printf("<option value=\"21600\" %s>%s</option>", v67, v68);
  if ( sub_1A434((char *)0xA8C0, (int)v151) )
    v70 = "selected";
  else
    v70 = "";
  v71 = get_ux_text_common(514, v69);
  printf("<option value=\"43200\" %s>%s</option>", v70, v71);
  if ( sub_1A434((char *)0xFD20, (int)v151) )
    v73 = "selected";
  else
    v73 = "";
  v74 = get_ux_text_common(518, v72);
  printf("<option value=\"64800\" %s>%s</option>", v73, v74);
  if ( sub_1A434((char *)&loc_15180, (int)v151) )
    v76 = "selected";
  else
    v76 = "";
  v77 = get_ux_text_common(520, v75);
  printf("<option value=\"86400\" %s>%s</option>", v76, v77);
  if ( sub_1A434((char *)&loc_2A300, (int)v151) )
    v79 = "selected";
  else
    v79 = "";
  v80 = get_ux_text_common(509, v78);
  printf("<option value=\"172800\" %s>%s</option>", v79, v80);
  if ( sub_1A434((char *)&loc_3F480, (int)v151) )
    v82 = "selected";
  else
    v82 = "";
  v83 = get_ux_text_common(512, v81);
  printf("<option value=\"259200\" %s>%s</option>", v82, v83);
  if ( !sub_1A434("2);\">", (int)v151) )
    v47 = "";
  v85 = get_ux_text_common(516, v84);
  printf("<option value=\"604800\" %s>%s</option>", v47, v85);
  printf("</select>");
  puts("</td>");
  printf("<td class=\"lansetup_main_td\" colspan=\"2\">");
  v87 = get_ux_text_common(814, v86);
  printf("<span class=\"lansetup_main_span\">%s</span>", v87);
  printf(
    "<span class=\"lansetup_main_p\"><input type=text name=domain size=10 maxlength=30 style=\"width:90px;\" value=\"%s\"></span>",
    &v152);
  printf("</td></tr>");
  if ( (v35 + 1) & 1 )
    v89 = "F7F7F7";
  else
    v89 = "FFFFFF";
  v90 = get_ux_text_common(495, v88);
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s;\">\t\t<td class=\"lansetup_main_td\" styl"
    "e=\"padding-left:5px;\">%s</td>",
    v89,
    v90);
  v91 = printf("<td class=\"lansetup_main_td\" colspan=\"2\"><span class=\"lansetup_main_span\" style=\"width:230px; margin-right:15px;\" id=\"dhcpstat\">\t\t</span>");
  if ( get_dhcp_auto_detect(v91) )
    v93 = "checked";
  else
    v93 = "";
  v94 = get_ux_text_common(504, v92);
  printf(
    "<input type=checkbox class=\"navi_chk\" name=\"dhcp_auto_detect\" id=\"detect_id\" %s>\t\t<label for=\"detect_id\">%s</label>",
    v93,
    v94);
  puts("</td>");
  puts("<td class=\"lansetup_main_td\" align=right>");
  v96 = get_ux_text_common(35, v95);
  printf(
    "<button type=\"button\" class=\"navi_bt\" name=\"int_save\" onclick=\"ApplyLanSetup();\" style=\"width:51px;\">\t\t<"
    "span class=\"lansetup_main_span\">%s</span></button>\n",
    v96);
  puts("</td></tr>");
  printf("</table>");
  printf("</td></tr>");
  if ( (v35 + 2) & 1 )
    v97 = "F7F7F7";
  else
    v97 = "FFFFFF";
  printf((const char *)&unk_78CB3, v97);
  v99 = get_ux_text_common(496, v98);
  v101 = get_ux_text_common(497, v100);
  v103 = get_ux_text_common(498, v102);
  printf(
    "<span class=\"lansetup_main_p\">\t\t%s <a href=\"javascript:MovePagetoMainURL('sysconf', 'misc', 'service=hubapmode'"
    ");\" style=\"color:#0000FF;\"><u>%s</u></a> %s\t\t</span>",
    v99,
    v101,
    v103);
  printf("</td></tr>");
  v105 = get_ux_text_common(809, v104);
  printf(
    "<tr height=\"26\" class=\"lansetup_main_tr\" style=\"background-color:#%s;\">\t\t<td class=\"lansetup_main_td\" styl"
    "e=\"padding-left:5px;\"><span class=\"lansetup_main_span\"><b>%s</b></span></td>",
    "DBDBDB",
    v105);
  printf("<td class=\"lansetup_main_td\" colspan=2 align=\"right\">");
  v106 = printf("<span class=\"lansetup_main_span\">");
  if ( get_ipmac_bind(v106) & 1 )
    v108 = "checked";
  else
    v108 = "";
  v109 = get_ux_text_common(594, v107);
  printf(
    "<input type=\"checkbox\" name=\"mac_restrict\" onclick=\"onclick_macristrict();\" id=\"mrestid\" %s>\t\t<label for=\""
    "mrestid\">%s</label>",
    v108,
    v109);
  v110 = printf("</span><span class=\"lansetup_main_span\" style=\"padding-right:17px;\">");
  if ( get_dhcp_access_policy(v110) )
    v46 = "checked";
  v112 = get_ux_text_common(815, v111);
  printf(
    "<input type=\"checkbox\" class=\"navi_chk\" id=\"dhcppol\" name=\"dhcp_access_policy\" onclick=\"ApplyPartSubmit('dh"
    "cp_access_policy');\" %s>\t\t<label for=\"dhcppol\">%s</label>",
    v46,
    v112);
  printf("</span>");
  printf("</td></tr>");
  v114 = get_ux_text_common(816, v113);
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s; border-bottom:1px #ccc solid; border-top:"
    "1px #ccc solid;\">\t\t<td class=\"lansetup_main_td\" colspan=2 style=\"padding-left:5px;\"><span class=\"lansetup_main_span\">%s",
    "EEEEEE",
    v114);
  dhcpd_read_config(&v154);
  v116 = (const char *)get_ux_text_common(521, v115);
  printf(v116, v155);
  printf("</span></td>");
  printf("<td class=\"lansetup_main_td\" align=\"right\" style=\"padding-right:17px;\">");
  printf("<span class=\"lansetup_main_span\" style=\"margin-right:10px;\" onclick=\"RemoveStaticLease();\">");
  v117 = get_image_dir();
  v119 = get_ux_text_common(143, v118);
  printf(
    "<img src=\"/%s/minus_icon.gif\" class=\"lansetup_main_span\" style=\"width:10px; height:10px;\">\t\t<span class=\"la"
    "nsetup_main_span\">%s</span>",
    v117,
    v119);
  printf("</span>");
  printf("<span class=\"lansetup_main_span\">");
  puts("<input type=\"checkbox\" name=\"del_allchk\" onclick=\"CheckAllCheckBox(static_lease.document, this, 'dellease');\">");
  printf("</span>");
  printf("</td></tr>");
  v120 = printf("<tr class=\"lansetup_main_tr\" height=\"120\"><td class=\"lansetup_main_td\" colspan=\"3\">");
  if ( is_mobile_agent(v120) )
  {
    print_div_m_str((int)"120", (int)"100%%", (int)"display:inline-block; *display:inline; zoom:1;");
    v121 = printf("<iframe name=\"static_lease\" src=\"timepro.cgi?tmenu=iframe&smenu=static_lease\"                         frameborder=no width=100%% height=120 align=center scrolling=yes></iframe>");
    print_div_m_etr(v121);
  }
  else
  {
    printf("<iframe name=\"static_lease\" src=\"timepro.cgi?tmenu=iframe&smenu=static_lease\"                         frameborder=no width=100%% height=120 align=center scrolling=yes></iframe>");
  }
  printf("</td></tr>");
  v123 = get_ux_text_common(817, v122);
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s; border-bottom:1px #ccc solid; border-top:"
    "1px #ccc solid;\">\t\t<td class=\"lansetup_main_td\" style=\"padding-left:5px;\"><span class=\"lansetup_main_span\">%s</span></td>",
    "EEEEEE",
    v123);
  printf("<td class=\"lansetup_main_td\" colspan=2 align=\"right\" style=\"padding-right:17px;\">");
  printf("<span class=\"lansetup_main_span\" style=\"margin-right:10px;\" onclick=\"onclick_research_span();\">");
  v124 = get_image_dir();
  v126 = get_ux_text_common(523, v125);
  printf((const char *)&unk_79558, v124, v126);
  printf("</span>");
  printf("<span class=\"lansetup_main_span\" style=\"margin-right:10px;\" onclick=\"AddStaticLease();\">");
  v127 = get_image_dir();
  v129 = get_ux_text_common(493, v128);
  printf(
    "<img src=\"/%s/plus_icon.gif\" class=\"lansetup_main_span\" style=\"width:10px; height:10px;\">\t\t<span class=\"lan"
    "setup_main_span\">%s</span>",
    v127,
    v129);
  printf("</span>");
  printf("<span class=\"lansetup_main_span\">");
  puts("<input type=\"checkbox\" name=\"add_allchk\" onclick=\"CheckAllCheckBox(lan_pcinfo.document, this, 'addlease');\">");
  printf("</span>");
  printf("</td></tr>");
  v130 = printf("<tr class=\"lansetup_main_tr\" height=\"120\"><td class=\"lansetup_main_td\" colspan=\"3\">");
  if ( is_mobile_agent(v130) )
  {
    print_div_m_str((int)"120", (int)"100%%", (int)"display:inline-block; *display:inline; zoom:1;");
    v131 = printf("<iframe name=\"lan_pcinfo\" src=\"timepro.cgi?tmenu=iframe&smenu=lan_pcinfo\"                         frameborder=no width=100%% height=120 align=center scrolling=yes></iframe>");
    print_div_m_etr(v131);
  }
  else
  {
    printf("<iframe name=\"lan_pcinfo\" src=\"timepro.cgi?tmenu=iframe&smenu=lan_pcinfo\"                         frameborder=no width=100%% height=120 align=center scrolling=yes></iframe>");
  }
  v132 = 0;
  printf("</td></tr>");
  v134 = get_ux_text_common(524, v133);
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s; border-bottom:1px #ccc solid; border-top:"
    "1px #ccc solid;\">\t\t<td class=\"lansetup_main_td\" style=\"padding-left:5px;\" colspan=\"3\"><span class=\"lansetu"
    "p_main_span\">%s</span>",
    "EEEEEE",
    v134);
  printf("<span class=\"lansetup_main_span\" style=\"padding-left:15px;\">");
  print_html_ip_address((int)"manual_ip", 0, 3);
  printf("</span>");
  printf("<span class=\"lansetup_main_span\" style=\"padding-left:10px;\">");
  while ( 1 )
  {
    ++v132;
    printf(
      "<input type=text name='%s%d' size=2 maxlength=2 style=\"width:18pt; ime-mode: disabled;\" onfocus='this.select();'"
      " onkeypress=\"return HWKeyDown('%s',%d);\" onkeyup=\"HWKeyUp('%s',%d);\"",
      "manual_hw",
      v132,
      "manual_hw",
      v132,
      "manual_hw",
      v132);
    v136 = get_ux_text_common(591, v135);
    printf("title=\"%s%d\"", v136, v132);
    putchar(62);
    if ( v132 == 6 )
      break;
    putchar(45);
  }
  printf("</span>");
  printf("<span class=\"lansetup_main_span\" style=\"padding-left:10px;\">");
  v138 = get_ux_text_common(494, v137);
  printf("<input type=\"text\" name=\"desc\" maxlength=\"20\" style=\"width:120px;\" placeholder=\"%s\">", v138);
  printf("</span>");
  printf("<span class=\"lansetup_main_span\" style=\"padding-left:15px;\" onclick=\"AddManualStaticLease();\">");
  v139 = get_image_dir();
  v141 = get_ux_text_common(525, v140);
  printf(
    "<img src=\"/%s/plus_icon.gif\" class=\"lansetup_main_span\" style=\"width:10px; height:10px;\">\t\t<span class=\"lan"
    "setup_main_span\">%s</span>",
    v139,
    v141);
  printf("</span>");
  printf("</td></tr>");
  printf("</table>");
  printf("</form>");
  printf("<form method=\"post\" name=\"backup_lansetup\" style=\"padding:0; margin:0;\">");
  v142 = printf("</form>");
  if ( is_mobile_agent(v142) )
  {
    print_div_m_str((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v143 = printf("<iframe name=\"hiddenlansetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenlansetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    v144 = print_div_m_etr(v143);
  }
  else
  {
    v144 = printf("<iframe name=\"hiddenlansetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenlansetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  if ( is_mobile_agent(v144) )
  {
    print_div_m_str((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v145 = printf("<iframe name=\"hiddenlanstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenlanstatus\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    print_div_m_etr(v145);
  }
  else
  {
    printf("<iframe name=\"hiddenlanstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenlanstatus\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  puts("<script language=JavaScript>");
  puts("init_netconf_lansetup();");
  puts("</script>");
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v146 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v146);
  printf("</SPAN></td>");
  printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"lansetup_div_msg\">\n");
  printf("</SPAN></td>");
  printf("</tr></table></DIV>");
  printf("</DIV>");
  printf("<DIV id=\"%s\" style=\"display:none;\">", "info_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:151px; top:198px; width:340px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"340\" height=\"70\">");
  printf("<tr height=\"35\"><td width=\"1%%\" height=\"35\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  printf("</SPAN></td>");
  printf("<td width=\"99%%\" height=\"35\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"lansetup_div_info1\">\n");
  printf("</SPAN></td>");
  printf("</tr>");
  printf("<tr height=\"35\"><td width=\"1%%\" height=\"35\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  printf("</SPAN></td>");
  printf("<td width=\"99%%\" height=\"35\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"lansetup_div_info2\">\n");
  printf("</SPAN></td>");
  printf("</tr>");
  printf("</table></DIV>");
  return printf("</DIV>");
}
// 10670: using guessed type int __fastcall get_ipmac_bind(_DWORD);
// 106A0: using guessed type int __fastcall get_wan_ifname(_DWORD, _DWORD);
// 107C0: using guessed type int __fastcall get_hwaddr_kernel(_DWORD, _DWORD);
// 108C8: using guessed type int __fastcall dhcpd_get_all_dynamic_lease(_DWORD, _DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);
// 10D48: using guessed type int __fastcall dhcpd_get_op(_DWORD);
// 10F28: using guessed type int __fastcall get_dhcp_access_policy(_DWORD);
// 11090: using guessed type int __fastcall get_dhcp_auto_detect(_DWORD);
// 11600: using guessed type int __fastcall dhcpd_read_config(_DWORD);
// 116C0: using guessed type int __fastcall get_localbroadaddr(_DWORD, _DWORD);
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (0001BCF0) --------------------------------------------------------
int __fastcall print_iframe_static_lease(int a1, signed int a2)
{
  signed int v2; // r5@1
  int i; // r4@4
  int v4; // r0@7
  int v5; // r0@10
  signed int v6; // r7@12
  void *v7; // r6@12
  signed int v8; // r11@12
  void *v9; // r4@15
  signed int v10; // r5@15
  int v11; // r0@16
  void *v12; // r10@20
  int v13; // r1@20
  int v14; // r0@22
  int v15; // r0@25
  char *v16; // r3@26
  signed int v17; // r1@29
  char *v18; // r0@31
  const char *v19; // r1@37
  int result; // r0@41
  signed int v21; // [sp+0h] [bp-6810h]@0
  signed int v22; // [sp+Ch] [bp-6804h]@2
  int v23; // [sp+10h] [bp-6800h]@18
  int v24; // [sp+14h] [bp-67FCh]@20
  int v25; // [sp+1Ch] [bp-67F4h]@12
  int v26; // [sp+24h] [bp-67ECh]@12
  int v27; // [sp+3344h] [bp-34CCh]@12
  int v28; // [sp+334Ch] [bp-34C4h]@12
  int v29; // [sp+666Ch] [bp-1A4h]@18
  int v30; // [sp+676Ch] [bp-A4h]@19
  int v31; // [sp+67ACh] [bp-64h]@3
  int v32; // [sp+67C0h] [bp-50h]@8
  int v33; // [sp+67D4h] [bp-3Ch]@16

  v2 = a2;
  if ( !a2 )
  {
    v22 = a2;
    goto LABEL_12;
  }
  if ( get_value_post(a2, "act", &v31, 20) )
  {
LABEL_7:
    for ( i = 0; ; ++i )
    {
      v21 = 20;
      v4 = get_value_array_post(v2, "dellease");
      if ( !v4 )
        break;
      dhcpd_remove_static_lease(&v32, 0);
    }
    if ( i )
    {
      v5 = dhcpd_stop(0);
      v4 = dhcpd_start(v5);
    }
    signal_save(v4);
    v22 = 1;
    goto LABEL_12;
  }
  i = strcmp((const char *)&v31, "remove");
  if ( !i )
    goto LABEL_7;
  v22 = 0;
LABEL_12:
  sub_1A53C();
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0;\">");
  v6 = 0;
  puts("<script>");
  puts("function ClickEventPropagater(e){");
  puts("if(!e) e = window.event;");
  printf("e.cancelbubble = true; if(e.stopPropagation)\te.stopPropagation();");
  puts("}");
  puts("</script>");
  printf("<form name=\"static_lease_fm\" method=\"post\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=static_lease>");
  printf("<input type=hidden name=act value=>");
  printf("<table class=\"lansetup_main_table\" style=\"width:100%%;\">\n");
  printf("<COL width=\"110\"><COL width=\"160\"><COL width=\"150\"><COL width=\"130\"><COL width=\"%%%%\">");
  v27 = 0;
  strcpy((char *)&v28, "eth2");
  wireless_api_get_station_list(&v27);
  v25 = 0;
  strcpy((char *)&v26, "eth1");
  wireless_api_get_station_list(&v25);
  v7 = malloc(0x6C00u);
  memset(v7, 0, 0x6C00u);
  v8 = dhcpd_get_all_static_lease(v7, 256);
  qsort(v7, v8, 0x6Cu, (__compar_fn_t)sub_1A6D4);
  while ( v6 < v8 )
    ++v6;
  v9 = v7;
  v10 = 0;
  while ( v10 < v8 )
  {
    printf("<tr class=\"lansetup_main_tr\" height=\"24\" style=\"background-color:#%s; cursor:pointer;\" \t\t\tonclick=\"if(parent.window.onclick_static_tr)parent.window.onclick_static_tr(document, %d);\">");
    v11 = get_wan_ip("wan1", &v33);
    if ( v11 )
      v11 = strcmp((const char *)&v33, (const char *)v9) == 0;
    v23 = v11;
    memset(&v29, 0, 0x100u);
    sf_strncpy(&v29, (char *)v9 + 44, 256);
    if ( !(_BYTE)v29 )
    {
      snprintf((char *)&v30, 0x40u, "slease_%s", (char *)v9 + 20, v21);
      iconfig_get_value_direct(&v30, &v29);
    }
    printf("<td class=\"lansetup_main_td\">");
    printf("<span class=\"lansetup_main_span\" style=\"padding-left:5px\">%s</span>", v9);
    printf("</td>");
    convert_mac((char *)v9 + 20);
    printf("<td class=\"lansetup_main_td\">");
    printf("<span class=\"lansetup_main_span\" style=\"padding-left:5px\">%s</span>", (char *)v9 + 20);
    printf("</td>");
    convert_mac2((int)v9 + 20);
    printf("<td class=\"lansetup_main_td\">");
    printf(
      "<span class=\"lansetup_main_span lansetup_ellipsis\" style=\"width:145px; padding-left:5px\">%s</span>",
      &v29);
    printf("</td>");
    printf("<td class=\"lansetup_main_td\">");
    memset(&v29, 0, 0x100u);
    v12 = malloc(0xBC00u);
    v24 = get_hostinfo_from_bridge(1, 256, v12);
    if ( sub_1ACC8((int)v9 + 20, &v27) || sub_1ACC8((int)v9 + 20, &v25) )
    {
      v14 = 529;
    }
    else
    {
      if ( !sub_1AD1C((char *)v9 + 20, (int)v12, v24) )
        goto LABEL_26;
      v14 = 530;
    }
    v15 = get_ux_text_common(v14, v13);
    sf_strncpy(&v29, v15, 256);
LABEL_26:
    free(v12);
    printf(
      "<span class=\"lansetup_main_span lansetup_ellipsis\" style=\"width:130px; padding-left:5px\">%s</span>",
      &v29);
    printf("</td>");
    printf("<td class=\"lansetup_main_td\" align=\"right\">");
    v16 = "disabled";
    if ( !v23 )
      v16 = "";
    if ( v6 > 5 )
      v17 = 5;
    else
      v17 = 17;
    printf(
      "<span class=\"lansetup_main_span\" style=\"padding-right:%dpx;\">\t\t\t<input type=\"checkbox\" class=navi_chk nam"
      "e=\"dellease\" id=\"dellease%d\" value=\"%s\" \t\t\tonclick=\"ClickEventPropagater(event);\" %s></span>",
      v17,
      v10,
      v9,
      v16);
    printf("</td>");
    printf("</tr>");
    v18 = getenv("REMOTE_ADDR");
    if ( !strcmp(v18, (const char *)v9) )
      printf("<input type=\"hidden\" name=\"curpc\" value=\"1\">");
    ++v10;
    v9 = (char *)v9 + 108;
  }
  while ( v10 <= 4 )
  {
    if ( v10 & 1 )
      v19 = "F7F7F7";
    else
      v19 = "FFFFFF";
    ++v10;
    printf("<tr class=\"lansetup_main_tr\" height=\"24\"style=\"background-color:#%s\">", v19);
    printf("<td class=\"lansetup_main_td\" colspan=\"5\"></td>");
    printf("</tr>");
  }
  free(v7);
  puts("</table>");
  puts("</form>");
  result = puts("</BODY>");
  if ( v22 )
    result = printf("<script> if(parent.window.RemovePostSubmit)parent.window.RemovePostSubmit(); </script>");
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10778: using guessed type int __fastcall get_hostinfo_from_bridge(_DWORD, _DWORD, _DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10988: using guessed type int __fastcall wireless_api_get_station_list(_DWORD);
// 10C34: using guessed type int __fastcall dhcpd_remove_static_lease(_DWORD, _DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);
// 110E4: using guessed type int __fastcall iconfig_get_value_direct(_DWORD, _DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11528: using guessed type int __fastcall dhcpd_get_all_static_lease(_DWORD, _DWORD);
// 11930: using guessed type int __fastcall dhcpd_stop(_DWORD);
// 119B4: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);
// 11A8C: using guessed type int __fastcall get_value_array_post(_DWORD, _DWORD);

//----- (0001C24C) --------------------------------------------------------
void __fastcall print_iframe_lan_pcinfo(int a1, int a2)
{
  int v2; // r7@1
  int v3; // r4@1
  int v4; // r6@2
  int v5; // r6@5
  int *v6; // r5@9
  int v7; // t1@15
  const char *v8; // r0@19
  int *v9; // r1@19
  int v10; // r0@20
  int v11; // r10@25
  int v12; // r0@30
  int v13; // r0@30
  void *v14; // r7@32
  int v15; // r8@32
  char *v16; // r0@32
  signed int v17; // r4@32
  void *v18; // r5@35
  int v19; // r10@35
  signed int v20; // r4@43
  char *v21; // r0@47
  char *v22; // r0@47
  int v23; // r9@47
  int v24; // r1@47
  int v25; // r0@49
  const char *v26; // r0@53
  int v27; // r1@53
  int v28; // r0@54
  int v29; // r0@56
  signed int v30; // r1@57
  char *v31; // r0@59
  int v32; // r11@60
  char *v33; // r0@60
  int v34; // r9@60
  int v35; // r6@61
  char *v36; // r5@62
  const char *v37; // r1@66
  int v38; // r1@68
  int v39; // r0@70
  const char *v40; // r0@74
  int v41; // r1@74
  int v42; // r0@75
  int v43; // r0@77
  signed int v44; // r1@78
  signed int v45; // r1@80
  const char *v46; // r1@85
  int v47; // r8@17
  int *v48; // [sp+0h] [bp-6930h]@0
  int *v49; // [sp+4h] [bp-692Ch]@0
  int *v50; // [sp+8h] [bp-6928h]@0
  int *v51; // [sp+Ch] [bp-6924h]@0
  void *v52; // [sp+10h] [bp-6920h]@35
  int v53; // [sp+18h] [bp-6918h]@43
  int v54; // [sp+1Ch] [bp-6914h]@68
  int v55; // [sp+24h] [bp-690Ch]@1
  int v56; // [sp+2Ch] [bp-6904h]@1
  int v57; // [sp+334Ch] [bp-35E4h]@1
  int v58; // [sp+3354h] [bp-35DCh]@1
  int v59; // [sp+6674h] [bp-2BCh]@47
  int v60; // [sp+6774h] [bp-1BCh]@47
  int v61; // [sp+67A0h] [bp-190h]@47
  int v62; // [sp+67E0h] [bp-150h]@17
  int v63; // [sp+6820h] [bp-110h]@25
  int v64; // [sp+6840h] [bp-F0h]@3
  int v65; // [sp+6868h] [bp-C8h]@16
  int v66; // [sp+686Ch] [bp-C4h]@16
  int v67; // [sp+6870h] [bp-C0h]@16
  int v68; // [sp+6874h] [bp-BCh]@16
  int v69; // [sp+6878h] [bp-B8h]@21
  int v70; // [sp+6890h] [bp-A0h]@8
  int v71; // [sp+68A4h] [bp-8Ch]@9
  int v72; // [sp+68B8h] [bp-78h]@47
  unsigned __int8 v73; // [sp+68CCh] [bp-64h]@32
  int v74; // [sp+68E0h] [bp-50h]@32
  int v75; // [sp+68F4h] [bp-3Ch]@32

  v2 = 0;
  v55 = 0;
  v3 = a2;
  strcpy((char *)&v56, "eth2");
  wireless_api_get_station_list(&v55);
  v57 = 0;
  strcpy((char *)&v58, "eth1");
  wireless_api_get_station_list(&v57);
  if ( !v3 )
  {
    v4 = 0;
    goto LABEL_32;
  }
  v4 = get_value_post(v3, "act", &v64, 32);
  if ( !v4 )
    goto LABEL_32;
  if ( strcmp((const char *)&v64, "add") )
    goto LABEL_31;
  v5 = get_value_post(v3, "manual_check", &v64, 32);
  if ( !v5 )
  {
LABEL_24:
    while ( 1 )
    {
      v48 = (int *)32;
      v10 = get_value_array_post(v3, "addlease");
      if ( !v10 )
        break;
      v11 = atoi((const char *)&v64);
      sprintf((char *)&v63, "m%d", v11);
      v10 = get_value_post(v3, &v63, &v71, 20);
      if ( !v10 )
        break;
      v10 = check_unpermitted_chars(&v71);
      if ( v10 )
        break;
      sprintf((char *)&v63, "i%d", v11);
      v10 = get_value_post(v3, &v63, &v70, 20);
      if ( !v10 )
        break;
      v10 = check_unpermitted_chars(&v70);
      if ( v10 )
        break;
      dhcpd_add_static_lease(&v70, &v71);
      ++v5;
    }
    goto LABEL_30;
  }
  v2 = strcmp((const char *)&v64, "on");
  if ( v2 )
  {
    v5 = 0;
    goto LABEL_24;
  }
  v4 = get_value_post(v3, "manual_ip", &v70, 20);
  if ( v4 )
  {
    v6 = &v71;
    v4 = get_value_post(v3, "manual_hw", &v71, 20);
    if ( v4 )
    {
      v4 = check_unpermitted_chars(&v70);
      if ( !v4 )
      {
        if ( !check_unpermitted_chars(&v71) )
        {
          while ( 1 )
          {
            v7 = *(_BYTE *)v6;
            v6 = (int *)((char *)v6 + 1);
            v4 = v7;
            if ( !v7 )
              break;
            if ( (unsigned __int8)(v4 - 97) <= 0x19u )
              *((_BYTE *)v6 - 1) = v4 - 32;
          }
          v48 = &v65;
          v49 = &v66;
          v50 = &v67;
          v51 = &v68;
          if ( sscanf((const char *)&v71, "%02X:%02X:%02X:%02X:%02X:%02X") == 6 )
          {
            snprintf((char *)&v62, 0x40u, "slease_%s", &v71, &v65, &v66, &v67, &v68);
            v47 = dhcpd_add_static_lease(&v70, &v71);
            convert_mac(&v71);
            if ( v47 == 1 )
            {
              v8 = "<script> alert(STATIC_LEASE_ALREADY_EXIST_IPADDRESS + ':%s'); </script>";
              v9 = &v70;
            }
            else
            {
              if ( v47 != 2 )
              {
                v10 = get_value_post(v3, "desc", &v69, 24);
                if ( v10 )
                {
                  v10 = check_unpermitted_chars(&v69);
                  if ( !v10 )
                    v10 = iconfig_set_value_direct(&v62, &v69);
                }
                goto LABEL_30;
              }
              v8 = "<script> alert(STATIC_LEASE_ALREADY_EXIST_HWADDRESS + ':%s'); </script>";
              v9 = &v71;
            }
            v10 = printf(v8, v9);
LABEL_30:
            v12 = dhcpd_stop(v10);
            v4 = 1;
            v13 = dhcpd_start(v12);
            signal_save(v13);
            goto LABEL_32;
          }
        }
        goto LABEL_32;
      }
LABEL_31:
      v4 = v2;
      goto LABEL_32;
    }
  }
LABEL_32:
  v14 = malloc(0xBC00u);
  memset(v14, 0, 0xBC00u);
  v15 = get_hostinfo_from_arp("br0", 256, v14);
  get_ifconfig((int)"br0", (int)&v75, (int)&v74);
  sub_1A53C();
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0;\">");
  puts("<script>");
  puts("function ClickEventPropagater(e){");
  puts("if(!e) e = window.event;");
  printf("e.cancelbubble = true; if(e.stopPropagation)\te.stopPropagation();");
  puts("}");
  puts("</script>");
  printf("<form name=\"lan_pcinfo_fm\" method=\"post\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=lan_pcinfo>");
  printf("<input type=hidden name=act value=>");
  printf("<input type=hidden name=clickedbg value=>");
  printf("<input type=hidden name=clickedid value=>");
  printf("<input type=hidden name=manual_check value=>");
  printf("<input type=hidden name=manual_ip value=>");
  printf("<input type=hidden name=manual_hw value=>");
  printf("<input type=hidden name=desc value=>");
  printf("<table class=\"lansetup_main_table\" style=\"width:100%%;\">\n");
  printf("<COL width=\"110\"><COL width=\"160\"><COL width=\"150\"><COL width=\"130\"><COL width=\"%%%%\">");
  v16 = getenv("REMOTE_ADDR");
  get_internal_pc_hardware_address(v16, &v73);
  v17 = v73;
  if ( v73 )
  {
    v17 = sub_1A6F8((int)v14, v15, (const char *)&v73);
    if ( v17 )
      v17 = dhcpd_search_static_lease(0, &v73) == 0;
  }
  v52 = v14;
  v18 = v14;
  v19 = 0;
  while ( v19 < v15 )
  {
    if ( !dhcpd_search_static_lease((char *)v18 + 128, 0)
      && !dhcpd_search_static_lease(0, (char *)v18 + 148)
      && strcmp((const char *)&v73, (const char *)v18 + 148)
      && check_same_network((char *)v18 + 128, &v75, &v74) )
    {
      ++v17;
    }
    ++v19;
    v18 = (char *)v18 + 188;
  }
  v53 = v17 > 5;
  v20 = v73;
  if ( v73 )
  {
    v20 = sub_1A6F8((int)v14, v15, (const char *)&v73);
    if ( v20 )
    {
      if ( dhcpd_search_static_lease(0, &v73) )
      {
        v20 = 0;
      }
      else
      {
        printf(
          "<tr class=\"lansetup_main_tr\" height=\"24\" style=\"background-color:#%s; cursor:pointer;\" id=\"addlease_lin"
          "e%d\" \t\t\t\tonclick=\"if(parent.window.onclick_list_tr)parent.window.onclick_list_tr(document, %d);\">",
          "FFFFFF",
          0,
          0,
          v48,
          v49,
          v50,
          v51);
        printf("<td class=\"lansetup_main_td\">");
        v21 = getenv("REMOTE_ADDR");
        printf("<span class=\"lansetup_main_span\" style=\"padding-left:5px\">%s</span>", v21);
        printf("</td>");
        printf("<td class=\"lansetup_main_td\">");
        sf_strncpy(&v72, &v73, 20);
        convert_mac(&v73);
        printf("<span class=\"lansetup_main_span\" style=\"padding-left:5px\">%s</span>", &v73);
        printf("</td>");
        convert_mac2((int)&v73);
        sf_strncpy(&v73, &v72, 20);
        memset(&v60, 0, 0x6Cu);
        v22 = getenv("REMOTE_ADDR");
        v23 = dhcpd_get_dynamic_lease(v22, &v60);
        printf("<td class=\"lansetup_main_td\">");
        memset(&v59, 0, 0x100u);
        convert_euckr_to_utf8(&v61, &v59);
        printf(
          "<span class=\"lansetup_main_span lansetup_ellipsis\" style=\"width:145px; padding-left:5px\">%s</span>",
          &v59);
        printf("</td>");
        printf("<td class=\"lansetup_main_td\">");
        printf("<span class=\"lansetup_main_span lansetup_ellipsis\" style=\"width:130px; padding-left:5px\">");
        if ( sub_1ACC8((int)&v73, &v55) || sub_1ACC8((int)&v73, &v57) )
        {
          v25 = 529;
        }
        else if ( sub_1AD1C((char *)&v73, (int)v14, v15) )
        {
          v25 = 530;
        }
        else
        {
          v25 = 528;
        }
        v26 = (const char *)get_ux_text_common(v25, v24);
        printf(v26);
        v20 = 1;
        if ( v23 )
          v28 = 499;
        else
          v28 = 527;
        v29 = get_ux_text_common(v28, v27);
        printf(":%s</span>", v29);
        printf("</td>");
        printf("<td class=\"lansetup_main_td\" align=\"right\">");
        if ( v53 )
          v30 = 5;
        else
          v30 = 17;
        printf((const char *)&unk_7ACE6, v30);
        printf("</td>");
        printf("</tr>");
        printf("<input type=\"hidden\" name=m%d value=\"%s\">\n", 0, &v73);
        v31 = getenv("REMOTE_ADDR");
        printf("<input type=\"hidden\" name=i%d value=\"%s\">\n", 0, v31);
        printf("<input type=\"hidden\" name=h%d value=\"%s\">\n", 0, &v59);
        printf("<input type=\"hidden\" name=\"curpc\" value=\"1\">");
      }
    }
  }
  v32 = 0;
  v33 = getenv("REMOTE_ADDR");
  v34 = v4;
  get_internal_pc_hardware_address(v33, &v73);
  while ( v32 < v15 )
  {
    v35 = (int)v52 + 128;
    if ( !dhcpd_search_static_lease((char *)v52 + 128, 0) )
    {
      v36 = (char *)v52 + 148;
      if ( !dhcpd_search_static_lease(0, (char *)v52 + 148)
        && strcmp((const char *)&v73, v36)
        && check_same_network(v35, &v75, &v74) )
      {
        printf("<tr class=\"lansetup_main_tr\" height=\"24\" style=\"background-color:#%s; cursor:pointer;\" id=\"addlease_line%d\" \t\t\tonclick=\"if(parent.window.onclick_list_tr)parent.window.onclick_list_tr(document, %d);\">");
        printf("<td class=\"lansetup_main_td\">");
        if ( *((_BYTE *)v52 + 128) )
          v37 = (char *)v52 + 128;
        else
          v37 = "*";
        printf("<span class=\"lansetup_main_span\" style=\"padding-left:5px\">%s</span>", v37);
        printf("</td>");
        sf_strncpy(&v72, v36, 20);
        convert_mac(v36);
        printf("<td class=\"lansetup_main_td\">");
        printf("<span class=\"lansetup_main_span\" style=\"padding-left:5px\">%s</span>", v36);
        printf("</td>");
        convert_mac2((int)v36);
        sf_strncpy(v36, &v72, 20);
        memset(&v60, 0, 0x6Cu);
        v54 = dhcpd_get_dynamic_lease(v35, &v60);
        printf("<td class=\"lansetup_main_td\">");
        memset(&v59, 0, 0x100u);
        convert_euckr_to_utf8(&v61, &v59);
        printf(
          "<span class=\"lansetup_main_span lansetup_ellipsis\" style=\"width:145px; padding-left:5px\">%s</span>",
          &v59);
        printf("</td>");
        printf("<td class=\"lansetup_main_td\">");
        printf("<span class=\"lansetup_main_span lansetup_ellipsis\" style=\"width:130px; padding-left:5px\">");
        if ( sub_1ACC8((int)v36, &v55) || sub_1ACC8((int)v36, &v57) )
        {
          v39 = 529;
        }
        else if ( sub_1AD1C(v36, (int)v14, v15) )
        {
          v39 = 530;
        }
        else
        {
          v39 = 528;
        }
        v40 = (const char *)get_ux_text_common(v39, v38);
        printf(v40);
        if ( v54 )
          v42 = 499;
        else
          v42 = 527;
        v43 = get_ux_text_common(v42, v41);
        printf(":%s</span>", v43);
        printf("</td>");
        printf("<td class=\"lansetup_main_td\" align=\"right\">");
        if ( v53 )
          v44 = 5;
        else
          v44 = 17;
        printf(
          "<span class=\"lansetup_main_span\" style=\"padding-right:%dpx;\">\t\t\t<input type=\"checkbox\" class=navi_chk"
          " name=\"addlease\" id=\"addlease%d\" value=\"%d\" \t\t\tonclick=\"ClickEventPropagater(event);\">\t\t\t</span>",
          v44,
          v20,
          v20,
          v48,
          v49,
          v50,
          v51);
        printf("</td>");
        printf("</tr>");
        printf("<input type=hidden name=m%d value=\"%s\">\n", v20, v36);
        printf("<input type=hidden name=i%d value=\"%s\">\n", v20, v35);
        v45 = v20++;
        printf("<input type=hidden name=h%d value=\"%s\">\n", v45, &v59);
      }
    }
    ++v32;
    v52 = (char *)v52 + 188;
  }
  while ( v20 <= 4 )
  {
    if ( v20 & 1 )
      v46 = "F7F7F7";
    else
      v46 = "FFFFFF";
    ++v20;
    printf("<tr class=\"lansetup_main_tr\" height=\"24\"style=\"background-color:#%s\">", v46);
    printf("<td class=\"lansetup_main_td\" colspan=\"5\"></td>");
    printf("</tr>");
  }
  puts("</table>");
  puts("</form>");
  puts("</BODY>");
  puts("<script>");
  if ( v34 )
    puts("if(parent.window.AddPostSubmit)parent.window.AddPostSubmit();");
  printf("</script>");
  free(v14);
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 1061C: using guessed type int __fastcall iconfig_set_value_direct(_DWORD, _DWORD);
// 107B4: using guessed type int __fastcall get_hostinfo_from_arp(_DWORD, _DWORD, _DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 108F8: using guessed type int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD);
// 10988: using guessed type int __fastcall wireless_api_get_station_list(_DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);
// 11000: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 112D0: using guessed type int __fastcall dhcpd_get_dynamic_lease(_DWORD, _DWORD);
// 11450: using guessed type int __fastcall convert_euckr_to_utf8(_DWORD, _DWORD);
// 1187C: using guessed type int __fastcall dhcpd_add_static_lease(_DWORD, _DWORD);
// 11930: using guessed type int __fastcall dhcpd_stop(_DWORD);
// 11A8C: using guessed type int __fastcall get_value_array_post(_DWORD, _DWORD);
// 11E1C: using guessed type int __fastcall check_same_network(_DWORD, _DWORD, _DWORD);
// 11E34: using guessed type int __fastcall dhcpd_search_static_lease(_DWORD, _DWORD);

//----- (0001CE24) --------------------------------------------------------
int __fastcall print_iframe_hiddenlansetup(int a1, int a2)
{
  int v2; // r4@1

  v2 = a2;
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"netconf_hiddenlansetup\">");
  printf("</form>");
  printf("</BODY>");
  select_work(v2);
  printf("<script>");
  puts("if(document.rebootDuration && parent.window.lansetup_reboot_process){");
  puts("parent.window.lansetup_reboot_process(document.rebootDuration, document.refreshURL);}");
  printf("else{UnMaskIt(parent.document,'apply_mask');}");
  return printf("</script>");
}

//----- (0001CEA4) --------------------------------------------------------
int print_iframe_hiddenlanstatus()
{
  int v0; // r0@1
  int v1; // r1@2
  int v2; // r0@3

  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"netconf_hiddenlanstatus\">");
  puts("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  puts("<input type=hidden name=\"smenu\" value=\"hiddenlanstatus\">");
  printf("</form>");
  printf("</BODY>");
  v0 = printf("<script>");
  if ( dhcpd_get_op(v0) && get_dhcp_auto_detect_status("br0") )
  {
    v2 = get_ux_text_common(505, v1);
    printf("parent.document.getElementById('dhcpstat').innerHTML = '%s';", v2);
  }
  else
  {
    printf("parent.document.getElementById('dhcpstat').innerHTML = '';");
  }
  printf("if(!parent.document.runstat || parent.document.runstat == 'run')");
  printf("parent.document.timeoutval = setTimeout(function(){document.netconf_hiddenlanstatus.submit();}, 5000);");
  return printf("</script>");
}
// 10AF0: using guessed type int __fastcall get_dhcp_auto_detect_status(_DWORD);
// 10D48: using guessed type int __fastcall dhcpd_get_op(_DWORD);

//----- (0001CF6C) --------------------------------------------------------
int netconf_lansetup()
{
  sub_1A53C();
  print_js_file((int)"netconf", (int)"lansetup");
  return sub_1AD68();
}

//----- (0001CF90) --------------------------------------------------------
int __fastcall sub_1CF90(int a1)
{
  int v1; // r4@1
  int result; // r0@1
  int v3; // r0@14
  int v4; // r0@20
  int v5; // r0@23
  int v6; // r0@24
  char v7; // [sp+0h] [bp-158h]@4
  char dest; // [sp+80h] [bp-D8h]@4
  char v9; // [sp+100h] [bp-58h]@11
  char v10; // [sp+120h] [bp-38h]@1

  v1 = a1;
  result = get_value_post(a1, "act", &v10, 31);
  if ( !result )
    return result;
  if ( strcmp(&v10, "save") )
  {
    if ( strcmp(&v10, (const char *)&unk_7B3ED) )
      return 0;
    strcpy(&v9, "");
    if ( get_value_post(v1, "http_auth", &v9, 15) )
    {
      set_http_auth_method(&v9);
      if ( !strcmp(&v9, "session") )
      {
        if ( get_value_post(v1, "use_captcha", &dest, 16) )
        {
          v3 = strcmp(&dest, "off");
          if ( v3 )
          {
            if ( !strcmp(&dest, "manual") )
              v3 = 2;
            else
              v3 = 1;
          }
          set_use_captcha_code(v3);
        }
        if ( get_value_post(v1, "captcha_attempt", &dest, 16) )
        {
          v4 = atoi(&dest);
          set_client_login_trial_count_without_captchar(v4);
        }
        strcpy(&v7, "");
        if ( get_value_post(v1, "http_session_timeout", &v7, 15) && v7 )
        {
          v5 = atoi(&v7);
          httpcon_set_session_timeout(60 * v5);
        }
      }
    }
    goto LABEL_24;
  }
  result = check_captcha_post(v1);
  if ( !result )
    return result;
  strcpy(&dest, "");
  strcpy(&v7, "");
  get_value_post(v1, "new_passwd", &dest, 127);
  get_value_post(v1, "new_login", &v7, 127);
  if ( check_unpermitted_chars(&v7) )
    return 0;
  if ( !v7 && (result = (unsigned __int8)dest, !dest) )
    return result;
  save_password(&v7, &dest);
LABEL_24:
  v6 = syslog_msg(1, "@{37}");
  signal_save(v6);
  signal_start("httpd");
  puts("<script>");
  puts("function GotoLoginPage(method)\n\t\t{\n\t\t\tif(method == 'session')\n\t\t\t\ttop.location.href='/sess-bin/login_session.cgi?logout=1';\n\t\t\telse if(method == 'basic')\n\t\t\t\ttop.location.href='/login/login.cgi';\n\t\t}");
  strcpy(&v9, "");
  get_http_auth_method(&v9);
  if ( v9 )
    printf("setTimeout(\"GotoLoginPage('%s')\", 4000);\n", &v9);
  puts("</script>");
  result = 1;
  return result;
}
// 10568: using guessed type int __fastcall set_client_login_trial_count_without_captchar(_DWORD);
// 1076C: using guessed type int __fastcall get_http_auth_method(_DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10928: using guessed type int __fastcall set_http_auth_method(_DWORD);
// 109D0: using guessed type int __fastcall save_password(_DWORD, _DWORD);
// 10C64: using guessed type int __fastcall signal_start(_DWORD);
// 10E98: using guessed type int __fastcall httpcon_set_session_timeout(_DWORD);
// 11000: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 113CC: using guessed type int syslog_msg(_DWORD, const char *, ...);
// 11A14: using guessed type int __fastcall set_use_captcha_code(_DWORD);

//----- (0001D240) --------------------------------------------------------
int print_login_setup()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  char *v5; // r1@2
  int v6; // r1@4
  int v7; // r0@4
  int v8; // r1@4
  int v9; // r0@5
  int v10; // r0@7
  int v11; // r1@7
  int v12; // r0@7
  int v13; // r1@7
  int v14; // r0@7
  int v15; // r1@7
  int v16; // r0@7
  int v17; // r1@7
  int v18; // r0@7
  int v19; // r1@7
  int v20; // r0@7
  int v21; // r1@7
  int v22; // r0@7
  int v23; // r1@7
  int v24; // r0@7
  int v26; // [sp+0h] [bp-1D0h]@1
  char v27; // [sp+80h] [bp-150h]@1
  char v28; // [sp+100h] [bp-D0h]@1
  char v29; // [sp+140h] [bp-90h]@1
  char v30; // [sp+180h] [bp-50h]@7
  char v31; // [sp+1A0h] [bp-30h]@7

  get_id_password(&v29, &v27);
  get_default_id_password(&v28, &v26);
  printf("<form method=post action=timepro.cgi name=login_fm style=\"padding:0; margin:0;\">");
  puts("<input type=hidden name=tmenu value=sysconf>");
  puts("<input type=hidden name=smenu value=login>");
  puts("<input type=hidden name=act value=>");
  printf("<table class=\"v3_table login_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"321\"><COL width=\"321\">");
  printf("<tr class=\"login_main_tr\" height=\"24\" style=\"background-color:#E3E3E3; border-top:1px #CCC solid; border-bottom:1px #CCC solid;\">\t\t<td class=\"login_main_td\" colspan=\"2\">");
  v1 = get_ux_text_common(1152, v0);
  printf("<p class=\"login_main_p\"><b>%s</b></p>", v1);
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\" style=\"background-color:#FFFFFF;\"><td class=\"login_main_td\" colspan=\"2\">");
  printf("<table class=\"v3_table login_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"120\"><COL width=\"170\"><COL width=\"80\"><COL width=\"272\">");
  printf("<tr class=\"login_main_tr\" height=\"24\" style=\"background-color:#FFFFFF;\"><td class=\"login_main_td\">");
  v3 = get_ux_text_common(1141, v2);
  printf("<p class=\"login_main_p\"><b>%s</b></p>", v3);
  printf("</td><td class=\"login_main_td\">");
  if ( v29 )
    v5 = &v29;
  else
    v5 = (char *)get_ux_text_common(1148, v4);
  printf("<span class=\"login_main_span\">%s</span>", v5);
  printf("</td><td class=\"login_main_td\">");
  v7 = get_ux_text_common(1142, v6);
  printf("<p class=\"login_main_p\"><b>%s</b></p>", v7);
  printf("</td><td class=\"login_main_td\">");
  if ( v27 )
    v9 = 1149;
  else
    v9 = 1148;
  v10 = get_ux_text_common(v9, v8);
  printf("<span class=\"login_main_span\">%s</span>", v10);
  printf("</td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"5\"><td class=\"login_main_td\" colspan=\"2\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"72\"><td class=\"login_main_td\">");
  printf("<table class=\"v3_table login_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"100\"><COL width=\"145\"><COL width=\"76\">");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  v12 = get_ux_text_common(1146, v11);
  printf("<p class=\"login_main_p\">%s</p>", v12);
  printf("</td><td class=\"login_main_td\">");
  puts("<input type=text name=new_login maxlength=32 style=\"width:140px\" value=>");
  printf("</td><td class=\"login_main_td\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  v14 = get_ux_text_common(1147, v13);
  printf("<p class=\"login_main_p\">%s</p>", v14);
  printf("</td><td class=\"login_main_td\">");
  printf("<input type=password name=new_passwd style=\"width:140px\" maxlength=32 value=>");
  printf("<input type=text name=new_passwd_text style=\"display:none; ime-mode:disabled; width:140px;\" maxlength=32 value=>");
  printf("</td><td class=\"login_main_td\">");
  printf("<input type=checkbox id=passview NAME=password_view value=1 onclick=\"PasswordView(new_passwd,new_passwd_text,password_view);\" >");
  v16 = get_ux_text_common(1415, v15);
  printf("<label for=\"passview\">%s</label>", v16);
  printf("</td></tr>");
  v18 = get_ux_text_common(1150, v17);
  printf("<input type=hidden name=default_captcha_desc value='%s'>\n", v18);
  puts("<input type=hidden name=captcha_file value=>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  v20 = get_ux_text_common(1181, v19);
  printf("<p class=\"login_main_p\">%s</p>", v20);
  printf("</td><td class=\"login_main_td\" colspan=\"2\">");
  v22 = get_ux_text_common(1150, v21);
  printf(
    "<input type=text name=captcha_code maxlength=\"5\" STYLE=\"width:205px; color:#888888;\" value=\"%s\"         \tonfo"
    "cus=\"FocusCaptcha(document.login_fm);\" onblur=\"BlurCaptcha(document.login_fm);\">",
    v22);
  printf("</td></tr>");
  printf("</table>");
  printf("</td><td class=\"login_main_td\">");
  get_http_auth_method(&v30);
  get_ux_lang((int)&v31);
  puts("<table class=\"v3_table login_main_table\" width=\"321\" height=\"72\">");
  printf("<COL width=\"291\"><COL width=\"30\">");
  printf("<tr class=\"login_main_tr\"><td class=\"login_main_td\">");
  puts("<table class=\"v3_table login_main_table\" width=\"254\" height=\"72\">");
  printf("<COL width=\"90\"><COL width=\"201\">");
  printf(
    "<tr class=\"login_main_tr\" \t\tstyle=\"font: normal normal normal 12px arial; color:#000000; border:#C6C9CC 1px sol"
    "id; background-color:#FFFFFF;\" height=\"72\">\t\t<td class=\"login_main_td\" style=\"cursor:pointer; background-col"
    "or:#FAFAFA; border:0;\" \t\tonclick=\"iframe_captcha.location.reload();\">\t\t<img src=\"/images2/captcha_noborder.%"
    "s.gif\" style=\"border:0; margin-left:18px;\"></td>\n",
    &v31);
  strcmp(&v30, "session");
  printf("<td class=\"login_main_td\" style=\"border-left:1px #CCC solid;\">\t\t<iframe name=iframe_captcha id=iframe_captcha src=\"/%s/captcha.cgi\" width=\"200\" height=\"72\" \t\tframeborder=no scrolling=no></iframe>\t\t</td></tr>\n");
  printf("</table>");
  printf("</td><td class=\"login_main_td\"></td></tr></table>");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"5\"><td class=\"login_main_td\" colspan=\"2\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"5\" style=\"border-top:1px #CCC solid;\"><td class=\"login_main_td\" colspan=\"2\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  printf("</td><td class=\"login_main_td\" align=\"right\" style=\"padding-right:30px;\">");
  printf("<button class=\"login_main_button\" style=\"width:90px;\" onclick=\"ApplyLogin(); return ClickEventPropagater(event);\">");
  v24 = get_ux_text_common(1145, v23);
  printf("<span class=\"login_main_span\">%s</span>", v24);
  printf("</button>");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"5\"><td class=\"login_main_td\" colspan=\"2\">");
  printf("</td></tr>");
  printf("</table>");
  return printf("</form>");
}
// 1076C: using guessed type int __fastcall get_http_auth_method(_DWORD);
// 11EAC: using guessed type int __fastcall get_id_password(_DWORD, _DWORD);
// 120BC: using guessed type int __fastcall get_default_id_password(_DWORD, _DWORD);

//----- (0001D664) --------------------------------------------------------
int print_session_setup()
{
  int v0; // r6@1
  signed int v1; // r4@2
  char *v2; // r4@4
  char *v3; // r7@4
  int v4; // r1@4
  int v5; // r0@4
  int v6; // r1@4
  char *v7; // r8@5
  int v8; // r0@7
  int v9; // r1@7
  int v10; // r0@7
  int v11; // r1@7
  int v12; // r0@9
  int v13; // r0@9
  int v14; // r7@9
  int v15; // r1@9
  int v16; // r5@9
  int v17; // r0@9
  int v18; // r1@9
  int v19; // r0@9
  int v20; // r1@9
  char *v21; // r7@10
  int v22; // r0@12
  int v23; // r1@12
  char *v24; // r7@13
  int v25; // r0@15
  int v26; // r1@15
  int v27; // r0@17
  int v28; // r0@17
  int v29; // r0@17
  int v30; // r1@17
  int v31; // r0@17
  int v32; // r1@17
  int v33; // r0@17
  int v34; // r0@17
  int v35; // r1@18
  int v36; // r0@18
  char v38; // [sp+0h] [bp-F8h]@1
  char v39; // [sp+80h] [bp-78h]@1
  char v40; // [sp+C0h] [bp-38h]@4

  v0 = get_captcha_usage_type();
  strcpy(&v39, "");
  strcpy(&v38, "");
  get_id_password(&v39, &v38);
  if ( v39 )
    v1 = v38 == 0;
  else
    v1 = 1;
  printf("<form method=post action=timepro.cgi name=session_fm style=\"padding:0; margin:0;\">");
  puts("<input type=hidden name=tmenu value=sysconf>");
  puts("<input type=hidden name=smenu value=login>");
  puts("<input type=hidden name=act value=>");
  printf("<input type=hidden name=noid value=%d>\n", v1);
  v2 = "";
  get_http_auth_method(&v40);
  printf("<input type=hidden name=prev_auth_method value=%s>\n", &v40);
  printf("<table class=\"v3_table login_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"100\"><COL width=\"450\"><COL width=\"62\"><COL width=\"30\">");
  printf("<tr class=\"login_main_tr\" height=\"24\" style=\"background-color:#E3E3E3; border-top:1px #CCC solid; border-bottom:1px #CCC solid;\">\t\t<td class=\"login_main_td\" colspan=\"4\">");
  v3 = "checked";
  v5 = get_ux_text_common(1180, v4);
  printf("<p class=\"login_main_p\"><b>%s</b></p>", v5);
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  if ( !strcmp(&v40, "basic") )
    v7 = "checked";
  else
    v7 = "";
  v8 = get_ux_text_common(553, v6);
  printf(
    "<input type=radio id=\"authh\" name=http_auth value=basic %s onclick=\"InitLogin();\"><label for=\"authh\">%s</label>",
    v7,
    v8);
  printf("</td><td class=\"login_main_td\">");
  v10 = get_ux_text_common(1140, v9);
  printf("<span class=\"login_main_span\">%s</span>", v10);
  printf("</td><td class=\"login_main_td\" colspan=\"2\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  if ( !strcmp(&v40, "basic") )
    v3 = "";
  v12 = get_ux_text_common(565, v11);
  printf(
    "<input type=radio id=\"auths\" name=http_auth value=session %s onclick=\"InitLogin();\"><label for=\"auths\">%s</label>",
    v3,
    v12);
  v13 = printf("</td><td class=\"login_main_td\" colspan=3>");
  v14 = httpcon_get_session_timeout(v13);
  v16 = get_ux_text_common(145, v15);
  v17 = calc_mask(v14, 60);
  printf(
    "<input type=text name=http_session_timeout value=%d size=3 maxlength=3 style='text-align: center;'> %s\n",
    v17,
    v16);
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  printf("</td><td class=\"login_main_td\">");
  v19 = get_ux_text_common(1410, v18);
  printf("%s", v19);
  printf("<select name='use_captcha' onchange='onChangeCaptchaUsage();' style='margin-left: 10px; height: 20px; border: 1px solid #CCC;'>");
  if ( v0 )
    v21 = "";
  else
    v21 = "selected";
  v22 = get_ux_text_common(1409, v20);
  printf("<option value='off' %s>%s</option>", v21, v22);
  if ( v0 == 1 )
    v24 = "selected";
  else
    v24 = "";
  v25 = get_ux_text_common(1405, v23);
  printf("<option value='always' %s>%s</option>", v24, v25);
  if ( v0 == 2 )
    v2 = "selected";
  v27 = get_ux_text_common(1408, v26);
  printf("<option value='manual' %s>%s</option>", v2, v27);
  v28 = printf("</select>");
  v29 = get_client_login_trial_count_without_captchar(v28);
  printf(
    "<input type='number' name='captcha_attempt' min=0 value=%d  style='width: 35px; text-align: center;margin: 0 5px; bo"
    "rder: 1px solid #CCC;'>",
    v29);
  v31 = get_ux_text_common(1406, v30);
  printf("<p id='captcha_desc' style='display: inline;'>%s</p>", v31);
  printf("</td><td class=\"login_main_td\" align=\"right\">");
  printf("<button class=\"login_main_button\" style=\"width:55px;\" onclick=\"ApplySession(); return ClickEventPropagater(event);\">");
  v33 = get_ux_text_common(35, v32);
  printf("<span class=\"login_main_span\">%s</span>", v33);
  printf("</button>");
  printf("</td><td class=\"login_main_td\">");
  v34 = printf("</td></tr>");
  if ( check_default_pass(v34) )
  {
    printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
    printf("</td><td class=\"login_main_td\" colspan=3>");
    v36 = get_ux_text_common(1407, v35);
    printf("<span id='captcha_warning' style='color:gray;'>%s</span>", v36);
    printf("</td></tr>");
  }
  printf("</table>");
  printf("</form>");
  puts("<script language=JavaScript>");
  puts("InitLogin();");
  return printf("</script>");
}
// 1076C: using guessed type int __fastcall get_http_auth_method(_DWORD);
// 110CC: using guessed type int get_captcha_usage_type(void);
// 114BC: using guessed type int __fastcall check_default_pass(_DWORD);
// 119CC: using guessed type int __fastcall get_client_login_trial_count_without_captchar(_DWORD);
// 11B04: using guessed type int __fastcall httpcon_get_session_timeout(_DWORD);
// 11EAC: using guessed type int __fastcall get_id_password(_DWORD, _DWORD);

//----- (0001DA1C) --------------------------------------------------------
int print_admin_email()
{
  int v0; // r1@1
  int v1; // r0@1
  void *v2; // r4@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r1@1
  int v8; // r0@1
  char *v9; // r4@1
  int v10; // r1@1
  int v11; // r0@1
  int v12; // r1@1
  int v13; // r0@1
  int v14; // r0@1
  int v15; // r1@1
  char *v16; // r6@2
  int v17; // r0@4
  int v18; // r0@4
  int v19; // r1@4
  int v20; // r0@6
  int v21; // r1@6
  int v22; // r0@6
  int v23; // r1@6
  int v24; // r0@6
  int v25; // r1@6
  int v26; // r0@6
  int v28; // [sp+0h] [bp-290h]@1
  char v29; // [sp+80h] [bp-210h]@6
  char v30; // [sp+100h] [bp-190h]@6
  char v31; // [sp+180h] [bp-110h]@1
  char v32; // [sp+200h] [bp-90h]@1

  printf("<form method=post action=timepro.cgi name=email_fm style=\"padding:0; margin:0;\">");
  puts("<input type=hidden name=tmenu value=sysconf>");
  puts("<input type=hidden name=smenu value=login>");
  puts("<input type=hidden name=act value=>");
  printf("<table class=\"v3_table login_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"100\"><COL width=\"145\"><COL width=\"152\"><COL width=\"145\"><COL width=\"70\"><COL width=\"30\">");
  printf("<tr class=\"login_main_tr\" height=\"24\" style=\"background-color:#E3E3E3; border-top:1px #CCC solid; border-bottom:1px #CCC solid;\">\t\t<td class=\"login_main_td\" colspan=\"4\">");
  v1 = get_ux_text_common(1144, v0);
  printf("<p class=\"login_main_p\"><b>%s</b></p>", v1);
  printf("</td><td class=\"login_main_td\" align=\"right\">");
  v2 = get_image_dir();
  v4 = get_ux_text_common(143, v3);
  printf(
    "<span class=\"login_main_span\" onclick=\"DeleteEmailConfig();\" style=\"width:55px; cursor:pointer;\">\t\t<img src="
    "\"/%s/minus_icon.gif\" style=\"margin-right:5px;\">%s</span>",
    v2,
    v4);
  printf("</td><td class=\"login_main_td\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"5\"><td class=\"login_main_td\" colspan=\"6\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  v6 = get_ux_text_common(1143, v5);
  printf("<p class=\"login_main_p\">%s</p>", v6);
  printf("</td><td class=\"login_main_td\">");
  get_admin_email(&v32);
  printf("<input type=text name=email style=\"width:140px;\" maxlength=120 value=%s>", &v32);
  printf("</td><td class=\"login_main_td\" align=\"right\">");
  v8 = get_ux_text_common(1155, v7);
  printf("<span class=\"login_main_span\" style=\"margin-right:10px;\">%s</span>", v8);
  printf("</td><td class=\"login_main_td\">");
  get_smtp_server(&v31);
  printf("<input type=text name=smtp style=\"width:140px;\" maxlength=120 value=%s>", &v31);
  printf("</td><td class=\"login_main_td\" colspan=\"2\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  v9 = "checked";
  v11 = get_ux_text_common(1151, v10);
  printf("<p class=\"login_main_p\">%s</p>", v11);
  printf("</td><td class=\"login_main_td\">");
  get_send_email(&v28);
  printf("<input type=text name=send_email style=\"width:140px;\" maxlength=120 value=%s>", &v28);
  printf("</td><td class=\"login_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  v13 = get_ux_text_common(1156, v12);
  printf("<p class=\"login_main_p\">%s</p>", v13);
  printf("</td><td class=\"login_main_td\" colspan=\"5\">");
  v14 = printf("<span class=\"login_main_span\">");
  if ( get_smtp_auth(v14) )
    v16 = "checked";
  else
    v16 = "";
  v17 = get_ux_text_common(1158, v15);
  printf(
    "<input type=radio id=\"smtptrue\" name=smtp_auth %s value=on onclick=\"ChangeAuth();\"><label for=\"smtptrue\">%s</label>",
    v16,
    v17);
  v18 = printf("</span><span class=\"login_main_span\" style=\"margin-left:15px;\">");
  if ( get_smtp_auth(v18) )
    v9 = "";
  v20 = get_ux_text_common(1157, v19);
  printf(
    "<input type=radio id=\"smtpfalse\" name=smtp_auth %s value=off onclick=\"ChangeAuth();\"><label for=\"smtpfalse\">%s</label>",
    v9,
    v20);
  printf("</span>");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  v22 = get_ux_text_common(1153, v21);
  printf("<p class=\"login_main_p\">%s</p>", v22);
  printf("</td><td class=\"login_main_td\" colspan=\"3\">");
  get_smtp_account(&v30);
  printf("<input type=text name=account style=\"width:140px;\" maxlength=120 value=\"%s\">", &v30);
  v24 = get_ux_text_common(1154, v23);
  printf("<span class=\"login_main_span\" style=\"margin:0 5px 0 15px;\">%s</span>", v24);
  get_smtp_password(&v29);
  printf("<input type=password name=smtp_pass style=\"width:140px;\" maxlength=120 value=\"");
  print_escape_str(&v29);
  printf("\">");
  printf("</td><td class=\"login_main_td\" align=\"right\">");
  printf("<button class=\"login_main_button\" style=\"width:55px;\" onclick=\"ChangeEmailConfig(); return ClickEventPropagater(event);\">");
  v26 = get_ux_text_common(35, v25);
  printf("<span class=\"login_main_span\">%s</span>", v26);
  printf("</button>");
  printf("</td><td class=\"login_main_td\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"5\" style=\"border-bottom:1px #CCC solid;\"><td class=\"login_main_td\" colspan=\"6\">");
  printf("</td></tr>");
  printf("</table>");
  printf("</form>");
  puts("<script language=JavaScript>");
  puts("ChangeAuth();");
  return printf("</script>");
}
// 10BD4: using guessed type int __fastcall get_smtp_auth(_DWORD);
// 10D0C: using guessed type int __fastcall get_smtp_password(_DWORD);
// 114EC: using guessed type int __fastcall get_smtp_account(_DWORD);
// 11C90: using guessed type int __fastcall get_smtp_server(_DWORD);
// 11ED0: using guessed type int __fastcall get_admin_email(_DWORD);
// 12038: using guessed type int __fastcall get_send_email(_DWORD);

//----- (0001DDBC) --------------------------------------------------------
int __fastcall print_iframe_hiddenloginsetup_0(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r6@1
  char *v4; // r0@5
  char *v5; // r0@9
  char *v6; // r0@13
  int v7; // r0@15
  char *v8; // r0@20
  char *v9; // r0@23
  int v10; // r0@25
  int v11; // r0@29
  int v13; // [sp+0h] [bp-B0h]@3
  char v14; // [sp+80h] [bp-30h]@1

  v2 = a2;
  v3 = sub_1CF90(a2);
  if ( get_value_post(v2, "act", &v14, 32) )
  {
    if ( !strcmp(&v14, "apply_email") )
    {
      if ( !get_value_post(v2, "email", &v13, 128) || check_unpermitted_chars(&v13) )
        v4 = "";
      else
        v4 = (char *)&v13;
      set_admin_email(v4);
      if ( !get_value_post(v2, "smtp", &v13, 128) || check_unpermitted_chars(&v13) )
        v5 = "";
      else
        v5 = (char *)&v13;
      set_smtp_server(v5);
      if ( !get_value_post(v2, &unk_7CD7A, &v13, 128) || check_unpermitted_chars(&v13) )
        v6 = "";
      else
        v6 = (char *)&v13;
      set_send_email(v6);
      v7 = get_value_post(v2, "smtp_auth", &v13, 128);
      if ( v7 )
      {
        if ( !strcmp((const char *)&v13, "on") )
        {
          set_smtp_auth(1);
          if ( !get_value_post(v2, "account", &v13, 128) || check_unpermitted_chars(&v13) )
            v8 = "";
          else
            v8 = (char *)&v13;
          set_smtp_account(v8);
          if ( get_value_post(v2, "smtp_pass", &v13, 128) )
            v9 = (char *)&v13;
          else
            v9 = "";
          v10 = set_smtp_password(v9);
          goto LABEL_29;
        }
        v7 = 0;
      }
    }
    else
    {
      if ( strcmp(&v14, "delete_email") )
        goto LABEL_30;
      set_admin_email("");
      set_smtp_server("");
      set_send_email("");
      set_smtp_account("");
      set_smtp_password("");
      v7 = 0;
    }
    v10 = set_smtp_auth(v7);
LABEL_29:
    v11 = signal_update(v10);
    signal_save(v11);
  }
LABEL_30:
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"sysconf_hiddenloginsetup\">");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  printf("UnMaskIt(parent.document, 'apply_mask');");
  if ( v3 )
    printf("MaskIt(parent.document, 'relogin_mask');");
  return printf("</script>");
}
// 104C0: using guessed type int __fastcall set_smtp_password(_DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10BBC: using guessed type int __fastcall set_admin_email(_DWORD);
// 10C88: using guessed type int __fastcall set_smtp_account(_DWORD);
// 11000: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11234: using guessed type int __fastcall set_smtp_server(_DWORD);
// 11BA0: using guessed type int __fastcall set_smtp_auth(_DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);
// 12104: using guessed type int __fastcall set_send_email(_DWORD);

//----- (0001E03C) --------------------------------------------------------
int sysconf_login()
{
  int v0; // r0@1
  int v1; // r0@2
  void *v2; // r0@4
  void *v3; // r0@4
  int v4; // r1@4
  int v5; // r0@4

  print_js_file((int)"sysconf", (int)"login");
  puts("<style type=\"text/css\">");
  puts(".login_main_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".login_main_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".login_main_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".login_main_p {");
  puts("\tpadding:0 0 0 5px; display:inline-block;");
  puts("\tvertical-align:middle; margin:0;");
  puts("}");
  puts(".login_main_span {");
  puts("\tdisplay:inline-block; vertical-align:middle;");
  puts("}");
  puts(".login_main_button {");
  puts("\tpadding:0 1 0 1; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".login_main_td input[type=checkbox], .login_main_td input[type=radio] {");
  puts("display:inline-block; vertical-align:middle;");
  puts("}");
  puts("#login_div_msg p {");
  puts("margin:5 0 5 15px; text-align:left;");
  puts("}");
  puts(".login_ellipsis {");
  puts("text-overflow:ellipsis; overflow:hidden; white-space:nowrap; text-align:left;");
  puts("}");
  printf("input[type=\"text\"] {border:1px #CCC solid;}");
  printf("input[type=\"password\"] {border:1px #CCC solid;}");
  printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td {cursor:default;}");
  printf("</style>");
  printf("<table class=\"v3_table login_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"642\">");
  printf("<tr class=\"login_main_tr\"><td class=\"login_main_td\">");
  print_login_setup();
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\"><td class=\"login_main_td\">");
  print_session_setup();
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\"><td class=\"login_main_td\">");
  print_admin_email();
  v0 = printf("</td></tr>");
  if ( is_mobile_agent(v0) )
  {
    print_div_m_str((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v1 = printf("<iframe name=\"hiddenloginsetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenloginsetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    print_div_m_etr(v1);
  }
  else
  {
    printf("<iframe name=\"hiddenloginsetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenloginsetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  printf("</table>");
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v2 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v2);
  printf("</SPAN></td>");
  printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"login_div_msg\">\n");
  printf("</SPAN></td>");
  printf((const char *)&unk_7D215);
  printf("<DIV id=\"relogin_mask\" style=\"display:none;\">");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:171px; top:198px; width:300px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"300\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v3 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v3);
  printf("</SPAN></td>");
  v5 = get_ux_text_common(564, v4);
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:"
    "middle; display:block; text-align:center;\">%s",
    v5);
  printf("</SPAN></td>");
  return printf((const char *)&unk_7D215);
}
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (0001E3AC) --------------------------------------------------------
int __fastcall sub_1E3AC(int a1, int a2, int a3)
{
  int v3; // r5@1
  int v4; // r4@1
  int v5; // r6@1

  v3 = a3;
  v4 = a1;
  v5 = a2;
  printf("<TR height=20 ID=%s STYLE=\"cursor:pointer; background-color:#%s;\" ONCLICK=\"clickSysconf(this);\">", a1);
  return printf("<TD></TD><TD>%s</TD><TD CLASS=text_gray ID=%s_value >%s</TD><TD>%s</TD></TR>\n", v5, v4, v3);
}

//----- (0001E40C) --------------------------------------------------------
int __fastcall sub_1E40C(const char *a1, int a2)
{
  int v2; // r5@1
  const char *v3; // r4@1
  void *v4; // r0@3

  v2 = a2;
  v3 = a1;
  if ( !strcmp(a1, "reboot_mask") )
  {
    printf("<style>");
    printf("#%s p { margin: 5px 0 5px 15px; text-align: left; }", v3);
    printf("</style>");
  }
  printf("<DIV id=\"%s\" style=\"display:none;\">", v3);
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v4 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v4);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:"
    "middle; display:block; text-align:center;\">%s\n",
    v2);
  printf("</SPAN></td>");
  return printf((const char *)&unk_7D215);
}

//----- (0001E4F4) --------------------------------------------------------
void *__fastcall auto_select_lang(const char *a1)
{
  const char *v1; // r4@1
  int v2; // r1@1
  int v3; // r0@2
  const char *v4; // r1@11
  char *v5; // r0@11

  v1 = a1;
  if ( !strcmp(a1, "auto") )
  {
    v3 = 648;
  }
  else if ( !strcmp(v1, "kr") )
  {
    v3 = 135;
  }
  else if ( !strcmp(v1, "en") )
  {
    v3 = 134;
  }
  else if ( !strcmp(v1, "ch") )
  {
    v3 = 132;
  }
  else
  {
    if ( strcmp(v1, "cx") )
    {
      v5 = (char *)&unk_CA45C;
      v4 = "";
      goto LABEL_13;
    }
    v3 = 133;
  }
  v4 = (const char *)get_ux_text_common(v3, v2);
  v5 = (char *)&unk_CA45C;
LABEL_13:
  strcpy(v5, v4);
  return &unk_CA45C;
}

//----- (0001E5B0) --------------------------------------------------------
char *sub_1E5B0()
{
  char *result; // r0@2
  char v1; // [sp+4h] [bp-5Ch]@1

  get_timeserver_conf(&v1);
  if ( !strcmp(&v1, "null") )
  {
    result = "";
  }
  else
  {
    strcpy((char *)&unk_CA49C, &v1);
    result = (char *)&unk_CA49C;
  }
  return result;
}
// 1082C: using guessed type int __fastcall get_timeserver_conf(_DWORD);

//----- (0001E600) --------------------------------------------------------
char *__fastcall sub_1E600(char *result, const char *a2, const char *a3, char a4, int a5)
{
  const char *v5; // r4@1
  char v6; // r8@1
  int v7; // r7@2
  char *v8; // r5@2

  v5 = a3;
  v6 = a4;
  if ( (signed int)result > 27 )
    return result;
  v7 = 144 * (_DWORD)result;
  v8 = &byte_CA980[144 * (_DWORD)result];
  strcpy(v8, a2);
  result = strcpy(&byte_CA980[v7 + 8], v5);
  v8[136] = v6;
  *((_DWORD *)v8 + 35) = a5;
  return result;
}

//----- (0001E650) --------------------------------------------------------
char *__fastcall maekGMTData(int a1, int a2)
{
  const char *v2; // r0@1
  int v3; // r1@1
  const char *v4; // r0@1
  int v5; // r1@1
  const char *v6; // r0@1
  int v7; // r1@1
  const char *v8; // r0@1
  int v9; // r1@1
  const char *v10; // r0@1
  int v11; // r1@1
  const char *v12; // r0@1
  int v13; // r1@1
  const char *v14; // r0@1
  int v15; // r1@1
  const char *v16; // r0@1
  int v17; // r1@1
  const char *v18; // r0@1
  int v19; // r1@1
  const char *v20; // r0@1
  int v21; // r1@1
  const char *v22; // r0@1
  int v23; // r1@1
  const char *v24; // r0@1
  int v25; // r1@1
  const char *v26; // r0@1
  int v27; // r1@1
  const char *v28; // r0@1
  int v29; // r1@1
  const char *v30; // r0@1
  int v31; // r1@1
  const char *v32; // r0@1
  int v33; // r1@1
  const char *v34; // r0@1
  int v35; // r1@1
  const char *v36; // r0@1
  int v37; // r1@1
  const char *v38; // r0@1
  int v39; // r1@1
  const char *v40; // r0@1
  int v41; // r1@1
  const char *v42; // r0@1
  int v43; // r1@1
  const char *v44; // r0@1
  int v45; // r1@1
  const char *v46; // r0@1
  int v47; // r1@1
  const char *v48; // r0@1
  int v49; // r1@1
  const char *v50; // r0@1
  int v51; // r1@1
  const char *v52; // r0@1
  int v53; // r1@1
  const char *v54; // r0@1
  int v55; // r1@1
  const char *v56; // r0@1

  v2 = (const char *)get_ux_text_common(384, a2);
  sub_1E600(0, "gmt0", v2, 45, 720);
  v4 = (const char *)get_ux_text_common(395, v3);
  sub_1E600((char *)1, "gmt1", v4, 45, 660);
  v6 = (const char *)get_ux_text_common(404, v5);
  sub_1E600((char *)2, "gmt2", v6, 45, 600);
  v8 = (const char *)get_ux_text_common(405, v7);
  sub_1E600((char *)3, "gmt3", v8, 45, 540);
  v10 = (const char *)get_ux_text_common(406, v9);
  sub_1E600((char *)4, "gmt4", v10, 45, 480);
  v12 = (const char *)get_ux_text_common(407, v11);
  sub_1E600((char *)5, "gmt5", v12, 45, 420);
  v14 = (const char *)get_ux_text_common(408, v13);
  sub_1E600((char *)6, "gmt6", v14, 45, 360);
  v16 = (const char *)get_ux_text_common(409, v15);
  sub_1E600((char *)7, "gmt7", v16, 45, 300);
  v18 = (const char *)get_ux_text_common(410, v17);
  sub_1E600((char *)8, "gmt8", v18, 45, 240);
  v20 = (const char *)get_ux_text_common(411, v19);
  sub_1E600((char *)9, "gmt9", v20, 45, 180);
  v22 = (const char *)get_ux_text_common(385, v21);
  sub_1E600((char *)0xA, "gmt10", v22, 45, 120);
  v24 = (const char *)get_ux_text_common(386, v23);
  sub_1E600((char *)0xB, "gmt11", v24, 45, 60);
  v26 = (const char *)get_ux_text_common(387, v25);
  sub_1E600((char *)0xC, "gmt12", v26, 43, 0);
  v28 = (const char *)get_ux_text_common(388, v27);
  sub_1E600((char *)0xD, "gmt13", v28, 43, 60);
  v30 = (const char *)get_ux_text_common(389, v29);
  sub_1E600((char *)0xE, "gmt14", v30, 43, 120);
  v32 = (const char *)get_ux_text_common(390, v31);
  sub_1E600((char *)0xF, "gmt15", v32, 43, 180);
  v34 = (const char *)get_ux_text_common(391, v33);
  sub_1E600((char *)0x10, "gmt16", v34, 43, 210);
  v36 = (const char *)get_ux_text_common(392, v35);
  sub_1E600((char *)0x11, "gmt17", v36, 43, 240);
  v38 = (const char *)get_ux_text_common(393, v37);
  sub_1E600((char *)0x12, "gmt18", v38, 43, 300);
  v40 = (const char *)get_ux_text_common(394, v39);
  sub_1E600((char *)0x13, "gmt19", v40, 43, 330);
  v42 = (const char *)get_ux_text_common(396, v41);
  sub_1E600((char *)0x14, "gmt20", v42, 43, 360);
  v44 = (const char *)get_ux_text_common(397, v43);
  sub_1E600((char *)0x15, "gmt21", v44, 43, 420);
  v46 = (const char *)get_ux_text_common(398, v45);
  sub_1E600((char *)0x16, "gmt22", v46, 43, 480);
  v48 = (const char *)get_ux_text_common(399, v47);
  sub_1E600((char *)0x17, "gmt23", v48, 43, 540);
  v50 = (const char *)get_ux_text_common(400, v49);
  sub_1E600((char *)0x18, "gmt24", v50, 43, 600);
  v52 = (const char *)get_ux_text_common(401, v51);
  sub_1E600((char *)0x19, "gmt25", v52, 43, 660);
  v54 = (const char *)get_ux_text_common(402, v53);
  sub_1E600((char *)0x1A, "gmt26", v54, 43, 720);
  v56 = (const char *)get_ux_text_common(403, v55);
  return sub_1E600((char *)0x1B, "gmt27", v56, 43, 780);
}

//----- (0001EAA4) --------------------------------------------------------
int __fastcall print_min_select(int a1, int a2, char *a3)
{
  int v3; // r7@1
  bool v4; // zf@1
  int v5; // r4@1
  int v6; // r1@6
  char *v7; // r2@7
  int v8; // r3@9

  v3 = a2;
  v4 = a3 == 0;
  v5 = 0;
  if ( !a3 )
    a3 = "";
  if ( !v4 )
    a3 = "disabled";
  printf("<select name=%s %s>", a1, a3, "disabled");
  do
  {
    v6 = v5;
    if ( v5 == v3 )
      v7 = "selected";
    else
      v7 = "";
    v8 = v5++;
    printf("<option value=%d %s >%d", v6, v7, v8);
  }
  while ( v5 != 24 );
  return printf("</select>");
}

//----- (0001EB24) --------------------------------------------------------
int print_hostname_table_sysconf()
{
  int v1; // [sp+0h] [bp-108h]@1

  get_hostname(&v1);
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=23px><td colspan=4 style=\"padding-left:5px;\">");
  printf("<input type=text name=hostname  size=60 maxlength=60 value='%s'>", &v1);
  printf("</td></tr>");
  return printf("</TABLE>");
}
// 11FB4: using guessed type int __fastcall get_hostname(_DWORD);

//----- (0001EB80) --------------------------------------------------------
int __fastcall print_iframe_sysconf_misc_configmgmt_submit(int a1, int a2)
{
  int v2; // r6@1
  int v3; // r5@1
  int v4; // r0@8
  int v5; // r0@8
  int v6; // r0@8
  int v7; // r0@8
  int v9; // [sp+0h] [bp-30h]@1

  v2 = a2;
  v3 = a1;
  print_js_file((int)"sysconf", (int)"misc");
  if ( get_value_post(v2, "act", &v9, 32) )
  {
    if ( !strcmp((const char *)&v9, "default") )
    {
      defaultconf(0);
      signal_reboot(3);
    }
  }
  else if ( get_value(v3, "act", &v9, 32) && !strcmp((const char *)&v9, "restore") )
  {
    printf("<script>");
    printf("setTimeout(function() {");
    printf("UnMaskIt(parent.document, 'apply_mask');");
    if ( get_value(v3, "result", &v9, 32) && !strcmp((const char *)&v9, "success") )
    {
      printf("parent.document.getElementById('configmgmt_success').style.display = '';");
      v4 = printf("parent.document.getElementById('configmgmt_fail').style.display = 'none';");
      v5 = hwinfo_get_reboot_duration(v4);
      v6 = printf("maskRebootMsg(%d, 'configmgmt_reboot', parent.document);", v5);
      v7 = hwinfo_get_reboot_duration(v6);
      printf("setTimeout(function() { parent.location.reload(); }, %d000);", v7);
    }
    else
    {
      printf("parent.document.getElementById('configmgmt_success').style.display = 'none';");
      printf("parent.document.getElementById('configmgmt_fail').style.display = '';");
      printf("MaskIt(parent.document, 'configmgmt_reboot_mask');");
      printf("setTimeout(function() { UnMaskIt(parent.document, 'configmgmt_reboot_mask'); }, 5000);");
    }
    printf("}, 500);");
    printf("</script>");
  }
  printf("<style>");
  printf("body { margin: 0; background-color: #EEE; }");
  printf("form { margin: 0; }");
  printf("</style>");
  puts("<form method=post action=timepro.cgi name=default_fm enctype=\"multipart/form-data\">");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=sysconf_misc_configmgmt_submit>");
  puts("<input type=hidden name=act value=default>");
  printf("</form>");
  puts("<form method=post action=timepro.cgi name=restore_fm enctype=\"multipart/form-data\" style='padding-top: 2px;'>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=sysconf_misc_configmgmt_restore>");
  puts("<input type=hidden name=act value=restore>");
  printf("<td><input type=file name=\"restore_config_file\" size=10 maxlength=120 style='width:300px; color: #888;' onchange='validateCFGFile(this);'></td>");
  return printf("</form>");
}
// 10934: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 11678: using guessed type int __fastcall signal_reboot(_DWORD);

//----- (0001EDC0) --------------------------------------------------------
FILE *__fastcall print_iframe_sysconf_misc_configmgmt_restore(int a1, int a2)
{
  signed int v2; // r5@1
  FILE *result; // r0@1
  FILE *v4; // r6@1
  const char *v5; // r0@8
  unsigned __int8 v6; // [sp+8h] [bp-98h]@1
  void *ptr; // [sp+88h] [bp-18h]@1
  size_t n; // [sp+8Ch] [bp-14h]@1

  v2 = 0;
  n = 0;
  get_value_post_multipart_file(a2, "restore_config_file", &ptr, &v6);
  result = fopen("/var/run/rsavefs.gz", "w+");
  v4 = result;
  if ( !result )
    return result;
  fwrite(ptr, 1u, n, result);
  fclose(v4);
  system((const char *)&unk_7DBFA);
  if ( restore_backup_config("/var/run/rsavefs") == -1 )
  {
    if ( v6 )
      syslog_msg(3, "%s%s", "@{22}", &v6, 128, &n);
    else
      v2 = v6;
  }
  else
  {
    syslog_msg(1, "%s%s", "@{24}", &v6, 128, &n);
    v2 = 1;
    signal_reboot(3);
  }
  unlink("/var/run/rsavefs.gz");
  unlink("/var/run/rsavefs");
  printf("<script>");
  if ( v2 )
    v5 = "location.href = 'timepro.cgi?tmenu=iframe&smenu=sysconf_misc_configmgmt_submit&act=restore&result=success';";
  else
    v5 = "location.href = 'timepro.cgi?tmenu=iframe&smenu=sysconf_misc_configmgmt_submit&act=restore&result=fail';";
  printf(v5);
  result = (FILE *)printf("</script>");
  return result;
}
// 11018: using guessed type int __fastcall get_value_post_multipart_file(_DWORD, _DWORD, _DWORD, _DWORD);
// 113CC: using guessed type int syslog_msg(_DWORD, const char *, ...);
// 11678: using guessed type int __fastcall signal_reboot(_DWORD);
// 11DEC: using guessed type int __fastcall restore_backup_config(_DWORD);

//----- (0001EEF0) --------------------------------------------------------
int print_configmgmt_table_sysconf()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r4@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r0@1
  int v7; // r1@1
  int v8; // r4@1
  int v9; // r1@1
  char *v10; // r2@2
  int v11; // r1@4
  int v12; // r0@4
  int v13; // r0@4
  int v14; // r1@4
  int v15; // r0@4
  int v16; // r4@4
  int v17; // r0@4
  int v18; // r0@4

  puts("<table cellspacing=0px cellpadding=0px>");
  printf("<colgroup><col width=150px></colgroup>");
  puts("<tr style='height: 26px;'>");
  puts("<td>");
  v1 = get_ux_text_common(1129, v0);
  v2 = v1;
  v3 = hwinfo_get_reboot_duration(v1);
  printf(
    "<input type=button name=save VALUE=\"%s\"  onclick=\"RestoreDefaultConfig(%d);\" style=\"width:120px;\">",
    v2,
    v3);
  puts("</td>");
  v5 = get_ux_text_common(1130, v4);
  v6 = printf("<td><span class=gray_text>%s</span></td>\n", v5);
  etr(v6);
  puts("<tr style='height: 26px;'>");
  puts("<td>");
  v8 = get_ux_text_common(1176, v7);
  if ( file_exists("/var/run/savefs.gz") )
    v10 = "";
  else
    v10 = (char *)get_ux_text_common(1171, v9);
  printf("<input type=button name=save VALUE=\"%s\" onclick=\"ApplyBackup('%s')\" style=\"width:120px;\">", v8, v10);
  puts("</td>");
  v12 = get_ux_text_common(1177, v11);
  printf("<td><span class=gray_text>%s</span></td>\n", v12);
  v13 = puts("</td>");
  etr(v13);
  puts("<tr style='height: 26px;'>");
  puts("<td>");
  v15 = get_ux_text_common(1174, v14);
  v16 = v15;
  v17 = hwinfo_get_reboot_duration(v15);
  printf("<input type=button name=save VALUE=\"%s\"  onclick=\"RestoreConfig(%d)\" style=\"width:120px;\">", v16, v17);
  puts("</td>");
  printf("<td>");
  printf("<iframe name=\"sysconf_misc_configmgmt_submit\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_misc_configmgmt_submit\" frameborder=no width=400px height=26px scrolling=no></iframe>");
  printf("<input type=file name=\"restore_config_file\" size=10 maxlength=120 style='width:300px; display: none; color: #888;' disabled>");
  v18 = printf("</td>");
  etr(v18);
  return puts("</table>");
}
// 10934: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11A2C: using guessed type int __fastcall file_exists(_DWORD);

//----- (0001F064) --------------------------------------------------------
int __fastcall print_autosaving_table_sysconf(int a1)
{
  int v1; // r6@1
  char *v2; // r4@1
  int v3; // r1@1
  char *v4; // r7@2
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6

  v1 = get_autosaving(a1);
  v2 = "checked";
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=23px><td style=\"padding-left:5px;width:\" colspan=4>");
  if ( v1 )
    v4 = "checked";
  else
    v4 = "";
  v5 = get_ux_text_common(1104, v3);
  printf("<input type=radio id=autosaving_on name=autosaving value=1 %s><label for=autosaving_on> %s</label>", v4, v5);
  print_nbsp(10);
  if ( v1 )
    v2 = "";
  v7 = get_ux_text_common(1111, v6);
  printf("<input type=radio id=autosaving_off name=autosaving value=0 %s><label for=autosaving_off> %s</label>", v2, v7);
  printf("</td></tr>");
  return printf("</TABLE>");
}
// 10F94: using guessed type int __fastcall get_autosaving(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);

//----- (0001F108) --------------------------------------------------------
int print_ispfake_table_sysconf()
{
  char *v0; // r5@1
  int v1; // r4@1
  int v2; // r1@1
  char *v3; // r8@2
  int v4; // r0@4
  int v5; // r1@4
  int v6; // r0@6
  int v8; // [sp+0h] [bp-218h]@1

  v0 = "checked";
  v1 = get_ispfake(&v8);
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=23px><td style=\"padding-left:5px;width:\" colspan=4>");
  if ( v1 )
    v3 = "checked";
  else
    v3 = "";
  v4 = get_ux_text_common(1104, v2);
  printf(
    "<input type=radio id=ispfake_on name=ispfake value=1 onclick=\"document.getElementsByName('ispfake_path')[0].disable"
    "d=false;\" %s><label for=ispfake_on> %s</label>",
    v3,
    v4);
  print_nbsp(5);
  printf("URL TAG ");
  printf("&nbsp;<input type=text name=ispfake_path value='%s' size=30 maxlength=30>\n", &v8);
  printf("<br>");
  if ( v1 )
    v0 = "";
  v6 = get_ux_text_common(1111, v5);
  printf(
    "<input type=radio id=ispfake_off name=ispfake value=0 onclick=\"document.getElementsByName('ispfake_path')[0].disabl"
    "ed=true;\" %s><label for=ispfake_off> %s</label>",
    v0,
    v6);
  printf("</td></tr>");
  printf("</TABLE>");
  return printf("<script> document.getElementsByName('ispfake_path')[0].disabled=%s; </script>");
}
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 11B7C: using guessed type int __fastcall get_ispfake(_DWORD);

//----- (0001F208) --------------------------------------------------------
int __fastcall print_mgmt_prot_table_sysconf(int a1)
{
  int v1; // r4@1
  int v2; // r1@3
  char *v3; // r4@4
  int v4; // r0@6
  int v6; // [sp+0h] [bp-50h]@2
  char v7; // [sp+20h] [bp-30h]@2

  v1 = get_router_mgmt_port(a1);
  if ( !check_remote_connection() )
  {
    get_ifconfig((int)"br0", (int)&v7, (int)&v6);
    printf("<input type=hidden name=local_ip value=%s>", &v7);
  }
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=23px><td style=\"padding-left:5px;width:\" colspan=4>");
  printf(
    "<input type=text name=mgmt_port size=5 maxlength=5 value=%d style='padding-left: 4px; border: 1px solid #CCC; '>",
    v1);
  if ( v1 == 80 )
    v3 = "checked";
  else
    v3 = "";
  v4 = get_ux_text_common(141, v2);
  printf(
    "<input type=checkbox name=mgmt_port_method value=default onclick=\"ClickMgmtPortMethod();\" %s> %s</td>",
    v3,
    v4);
  printf("</td></tr>");
  printf("</TABLE>");
  return printf("<script> ClickMgmtPortMethod(); </script>");
}
// 1157C: using guessed type int __fastcall get_router_mgmt_port(_DWORD);
// 11A80: using guessed type int check_remote_connection(void);

//----- (0001F2D8) --------------------------------------------------------
int __fastcall print_fakedns_table_sysconf(int a1)
{
  int v1; // r6@1
  char *v2; // r4@1
  int v3; // r1@1
  char *v4; // r7@2
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6
  int v8; // r1@6
  int v9; // r0@6

  v1 = get_fakedns(a1);
  v2 = "checked";
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=23px><td style=\"padding-left:5px;\" colspan=4>");
  if ( v1 )
    v4 = "checked";
  else
    v4 = "";
  v5 = get_ux_text_common(1104, v3);
  printf("<input type=radio id=fakedns_on name=fakedns value=1 %s ><label for=fakedns_on> %s</label>", v4, v5);
  print_nbsp(10);
  if ( v1 )
    v2 = "";
  v7 = get_ux_text_common(1111, v6);
  printf("<input type=radio id=fakedns_off name=fakedns value=0 %s ><label for=fakedns_off> %s</label>", v2, v7);
  printf("</td></tr>");
  printf("<tr height=5><td colspan=4>&nbsp;</td></tr>");
  v9 = get_ux_text_common(1136, v8);
  printf(
    "<tr valign=bottom height=10><td colspan=4 style=\"padding-left:5px;\"><span class=gray_text><LI>%s</span></td></tr>",
    v9);
  return printf("</TABLE>");
}
// 103D0: using guessed type int __fastcall get_fakedns(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);

//----- (0001F3A0) --------------------------------------------------------
int __fastcall print_dhcp_restart_form(const char *a1)
{
  const char *v1; // r5@1
  int v2; // r7@1
  const char *v3; // r0@1
  char *v4; // r5@1
  signed int v5; // r4@2
  int v6; // r1@4
  char *v7; // r8@5
  int v8; // r0@7
  int v9; // r1@7
  int v10; // r0@9
  char v12; // [sp+8h] [bp-28h]@1

  v1 = a1;
  get_wan_hw_ifname(a1, &v12);
  v2 = get_dhcp_auto_restart(&v12);
  v3 = v1;
  v4 = "checked";
  if ( !strcmp(v3, "wan1") )
    v5 = 1;
  else
    v5 = 2;
  printf("<tr height=23px><td style=\"padding-left:5px;\" colspan=4>");
  if ( v2 )
    v7 = "checked";
  else
    v7 = "";
  v8 = get_ux_text_common(1104, v6);
  printf(
    "<input type=radio id=dhcp_auto_restart_on_%d name=dhcp_auto_restart_%d value=on %s ><label for=dhcp_auto_restart_on_%d> %s</label>",
    v5,
    v5,
    v7,
    v5,
    v8);
  print_nbsp(10);
  if ( v2 )
    v4 = "";
  v10 = get_ux_text_common(1111, v9);
  printf(
    "<input type=radio id=dhcp_auto_restart_off_%d name=dhcp_auto_restart_%d value=off %s ><label for=dhcp_auto_restart_o"
    "ff_%d> %s</label>",
    v5,
    v5,
    v4,
    v5,
    v10);
  printf("</td></tr>");
  return printf("<tr height=5><td colspan=4>&nbsp;</td></tr>");
}
// 10FD0: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 11870: using guessed type int __fastcall get_dhcp_auto_restart(_DWORD);

//----- (0001F488) --------------------------------------------------------
int print_dhcp_restart_table_sysconf()
{
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  print_dhcp_restart_form("wan1");
  return printf("</TABLE>");
}

//----- (0001F4B4) --------------------------------------------------------
int __fastcall print_nologin_table_sysconf(int a1)
{
  int v1; // r6@1
  char *v2; // r4@1
  int v3; // r1@1
  char *v4; // r7@2
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6

  v1 = get_nologin(a1);
  v2 = "checked";
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=23px><td style=\"padding-left:5px;\" colspan=4>");
  if ( v1 )
    v4 = "";
  else
    v4 = "checked";
  v5 = get_ux_text_common(1166, v3);
  printf("<input type=radio id=nologin_off name=nologin value=0 %s ><label for=nologin_off> %s</label>", v4, v5);
  printf("</td></tr><tr height=23px><td style=\"padding-left:5px;\"colspan=4 >");
  if ( !v1 )
    v2 = "";
  v7 = get_ux_text_common(1167, v6);
  printf("<input type=radio id=nologin_on name=nologin value=1 %s ><label for=nologin_on> %s</label>", v2, v7);
  printf("</td></tr>");
  return printf("</TABLE>");
}

//----- (0001F55C) --------------------------------------------------------
int __fastcall print_wbmpopup_table_sysconf(int a1)
{
  int v1; // r6@1
  char *v2; // r4@1
  int v3; // r1@1
  char *v4; // r7@2
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6

  v1 = get_wbm_popup_flag(a1);
  v2 = "checked";
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=23px><td style=\"padding-left:5px;\" colspan=4>");
  if ( v1 )
    v4 = "checked";
  else
    v4 = "";
  v5 = get_ux_text_common(1164, v3);
  printf("<input type=radio id=wbmpopup_on name=wbmpopup value=1 %s ><label for=wbmpopup_on> %s</label>", v4, v5);
  print_nbsp(10);
  if ( v1 )
    v2 = "";
  v7 = get_ux_text_common(1162, v6);
  printf("<input type=radio id=wbmpopup_off name=wbmpopup value=0 %s ><label for=wbmpopup_off> %s</label>", v2, v7);
  printf("</td></tr>");
  return printf("</TABLE>");
}
// 10664: using guessed type int __fastcall get_wbm_popup_flag(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);

//----- (0001F600) --------------------------------------------------------
int __fastcall print_led_table_sysconf(int a1, int a2, int a3, int a4)
{
  int v4; // r1@1
  char *v5; // r6@2
  int v6; // r0@4
  int v7; // r1@4
  char *v8; // r6@5
  int v9; // r0@7
  int v10; // r1@7
  int v11; // r0@7
  char *v12; // r2@7
  int v13; // r1@9
  const char *v14; // r0@9
  char *v15; // r2@9
  int v16; // r1@11
  const char *v17; // r0@11
  int v18; // r0@11
  int v19; // r1@11
  int v20; // r0@11
  int v21; // r0@11
  int v22; // r1@13
  int v23; // r0@13
  int v24; // r0@13
  int v25; // r1@13
  int v26; // r0@13
  int v28; // [sp+0h] [bp-20h]@1
  int v29; // [sp+0h] [bp-20h]@4
  int v30; // [sp+4h] [bp-1Ch]@1
  int v31; // [sp+8h] [bp-18h]@1
  int v32; // [sp+Ch] [bp-14h]@1

  v28 = a1;
  v30 = a2;
  v31 = a3;
  v32 = a4;
  get_led_silent_control(&v30);
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=23px><td style=\"padding-left:5px;\" colspan=4>");
  if ( v30 )
    v5 = "";
  else
    v5 = "checked";
  v6 = get_ux_text_common(23, v4);
  printf(
    "<input type=radio id=led_default name=led value=%d onclick=\"OnClickSilentLED_2();\" %s><label for=led_default> %s</label>",
    0,
    v5,
    v6,
    v28);
  printf("</td></tr>");
  printf("<tr height=23px><td style=\"padding-left:5px;\" colspan=4>");
  if ( v30 == 1 )
    v8 = "checked";
  else
    v8 = "";
  v9 = get_ux_text_common(22, v7);
  printf(
    "<input type=radio id=led_off name=led value=%d onclick=\"OnClickSilentLED_2();\" %s><label for=led_off> %s</label>",
    1,
    v8,
    v9);
  printf("</td></tr>");
  printf("<tr height=23px><td style=\"padding-left:5px;\" colspan=4>");
  printf("<input type=radio name=led value=%d onclick=\"OnClickSilentLED_2();\" %s> ");
  v11 = get_ux_text_common(537, v10);
  printf("%s", v11);
  v12 = (char *)(v30 - 2);
  if ( v30 != 2 )
    v12 = (char *)1;
  print_min_select((int)"ledstart", v31, v12);
  v14 = (const char *)get_ux_text_common(536, v13);
  printf(v14);
  v15 = (char *)(v30 - 2);
  if ( v30 != 2 )
    v15 = (char *)1;
  print_min_select((int)"ledend", v32, v15);
  v17 = (const char *)get_ux_text_common(538, v16);
  printf(v17);
  v18 = printf("</td></tr></table>");
  br(v18);
  printf("<table border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%><tr><td height=5 colspan=4 style=\"padding-left:5px;\">");
  printf("<span class=gray_text><li>");
  v20 = get_ux_text_common(535, v19);
  printf("%s", v20);
  printf("</span>");
  v21 = printf("</td></tr></table>");
  if ( get_timed_status(v21) || v30 != 2 )
    return v29;
  br(0);
  v23 = get_ux_text_common(1055, v22);
  v24 = printf("<span class=gray_text>%s</span>", v23);
  br(v24);
  print_nbsp(10);
  v26 = get_ux_text_common(1056, v25);
  printf("<span class=gray_text>%s</span>", v26);
  return v29;
}
// 11024: using guessed type int __fastcall get_led_silent_control(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 120EC: using guessed type int __cdecl get_timed_status(_DWORD);

//----- (0001F7E8) --------------------------------------------------------
int __fastcall print_macclone_giga_sysconf(int a1)
{
  int v1; // r6@1
  char *v2; // r4@1
  int v3; // r1@1
  char *v4; // r7@2
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6

  v1 = get_macclone_in_giga(a1);
  v2 = "checked";
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=23px><td style=\"padding-left:5px;\" colspan=4>");
  if ( v1 )
    v4 = "";
  else
    v4 = "checked";
  v5 = get_ux_text_common(1104, v3);
  printf(
    "<input type=radio id=macclone_giga_on name=macclone_giga value=0 %s ><label for=macclone_giga_on> %s</label>",
    v4,
    v5);
  print_nbsp(10);
  if ( !v1 )
    v2 = "";
  v7 = get_ux_text_common(1111, v6);
  printf(
    "<input type=radio id=macclone_giga_off name=macclone_giga value=1 %s ><label for=macclone_giga_off> %s</label>",
    v2,
    v7);
  printf("</td></tr>");
  return printf("</TABLE>");
}
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 117A4: using guessed type int __fastcall get_macclone_in_giga(_DWORD);

//----- (0001F88C) --------------------------------------------------------
int __fastcall print_hour_select(int a1, int a2, char *a3)
{
  int v3; // r7@1
  bool v4; // zf@1
  int v5; // r4@1
  int v6; // r1@6
  char *v7; // r2@7
  int v8; // r3@9

  v3 = a2;
  v4 = a3 == 0;
  v5 = 0;
  if ( !a3 )
    a3 = "";
  if ( !v4 )
    a3 = "disabled";
  printf("<select name=%s %s>", a1, a3, "disabled");
  do
  {
    v6 = v5;
    if ( v5 == v3 )
      v7 = "selected";
    else
      v7 = "";
    v8 = v5++;
    printf("<option value=%d %s>%d", v6, v7, v8);
  }
  while ( v5 != 60 );
  return printf("</select>");
}

//----- (0001F90C) --------------------------------------------------------
int print_auto_table_sysconf()
{
  char *v0; // r4@1
  int v1; // r1@1
  char *v2; // r6@2
  int v3; // r0@4
  int v4; // r1@4
  char *v5; // r6@5
  int v6; // r0@7
  int v7; // r0@7
  int v8; // r1@7
  char *v9; // r6@8
  int v10; // r0@10
  int v11; // r1@10
  char *v12; // r6@11
  int v13; // r0@13
  int v14; // r1@13
  char *v15; // r6@14
  int v16; // r0@16
  int v17; // r1@16
  char *v18; // r6@17
  int v19; // r0@19
  int v20; // r1@19
  char *v21; // r6@20
  int v22; // r0@22
  int v23; // r1@22
  char *v24; // r6@23
  int v25; // r0@25
  int v26; // r1@25
  char *v27; // r6@26
  int v28; // r0@28
  int v29; // r1@28
  int v30; // r0@30
  int v31; // r0@30
  int v32; // r1@30
  const char *v33; // r0@30
  int v34; // r1@30
  const char *v35; // r0@30
  int v36; // r1@30
  const char *v37; // r0@30
  int v38; // r0@30
  int v39; // r1@32
  int v40; // r0@32
  int v41; // r0@32
  int v42; // r1@32
  int v43; // r0@32
  int v45; // [sp+0h] [bp-58h]@1
  int v46; // [sp+24h] [bp-34h]@7
  char v47; // [sp+28h] [bp-30h]@10
  char v48; // [sp+29h] [bp-2Fh]@13
  char v49; // [sp+2Ah] [bp-2Eh]@16
  char v50; // [sp+2Bh] [bp-2Dh]@19
  char v51; // [sp+2Ch] [bp-2Ch]@22
  char v52; // [sp+2Dh] [bp-2Bh]@25
  char v53; // [sp+2Eh] [bp-2Ah]@28
  int v54; // [sp+34h] [bp-24h]@30
  int v55; // [sp+38h] [bp-20h]@30
  int v56; // [sp+44h] [bp-14h]@1

  v0 = "checked";
  get_autoreboot_config(&v56);
  memset(&v45, 0, 0x44u);
  read_sched_array(&unk_7EB54, &v45, 1);
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=40>");
  printf("<td style=\"padding-left:5px;padding-top:2px;\">");
  if ( v56 )
    v2 = "checked";
  else
    v2 = "";
  v3 = get_ux_text_common(1104, v1);
  printf(
    "<input type=radio id=autoreboot_on name=autoreboot value=1 onclick=\"ClickAutoReboot_2(document.sysconf_fm);\" %s><l"
    "abel for=autoreboot_on> %s</label>",
    v2,
    v3);
  print_nbsp(10);
  if ( v56 )
    v5 = "";
  else
    v5 = "checked";
  v6 = get_ux_text_common(1111, v4);
  v7 = printf(
         "<input type=radio id=autoreboot_off name=autoreboot value=0 onclick=\"ClickAutoReboot_2(document.sysconf_fm);\""
         " %s><label for=autoreboot_off> %s</label>",
         v5,
         v6);
  br(v7);
  if ( v46 )
    v9 = "checked";
  else
    v9 = "";
  v10 = get_ux_text_common(274, v8);
  printf(
    "<input type=checkbox id=everyday name=everyday value=1 onclick=\"ClickEveryDay_2(document.sysconf_fm);\" style='marg"
    "in-left: 5px;' %s><label for=everyday> %s</label>",
    v9,
    v10);
  print_nbsp(10);
  if ( v47 )
    v12 = "checked";
  else
    v12 = "";
  v13 = get_ux_text_common(289, v11);
  printf(
    " <input type=checkbox id=sun name=sun value=1 style='margin-left: 2px; margin-right: 6px;' %s><label for=sun>%s</label>",
    v12,
    v13);
  if ( v48 )
    v15 = "checked";
  else
    v15 = "";
  v16 = get_ux_text_common(280, v14);
  printf(" <input type=checkbox id=mon name=mon value=1 %s><label for=mon>%s</label>", v15, v16);
  if ( v49 )
    v18 = "checked";
  else
    v18 = "";
  v19 = get_ux_text_common(291, v17);
  printf(" <input type=checkbox id=tue name=tue value=1 %s><label for=tue>%s</label>", v18, v19);
  if ( v50 )
    v21 = "checked";
  else
    v21 = "";
  v22 = get_ux_text_common(294, v20);
  printf(" <input type=checkbox id=wed name=wed value=1 %s><label for=wed>%s</label>", v21, v22);
  if ( v51 )
    v24 = "checked";
  else
    v24 = "";
  v25 = get_ux_text_common(290, v23);
  printf(" <input type=checkbox id=thu name=thu value=1 %s><label for=thu>%s</label>", v24, v25);
  if ( v52 )
    v27 = "checked";
  else
    v27 = "";
  v28 = get_ux_text_common(277, v26);
  printf(" <input type=checkbox id=fri name=fri value=1 %s><label for=fri>%s</label>", v27, v28);
  if ( !v53 )
    v0 = "";
  v30 = get_ux_text_common(281, v29);
  v31 = printf(" <input type=checkbox id=sat name=sat value=1 %s><label for=sat>%s</label>", v0, v30);
  br(v31);
  print_nbsp(1);
  print_min_select((int)"autorebootHour", v54, 0);
  v33 = (const char *)get_ux_text_common(418, v32);
  printf(v33);
  print_nbsp(3);
  print_hour_select((int)"autorebootMin", v55, 0);
  v35 = (const char *)get_ux_text_common(635, v34);
  printf(v35);
  v37 = (const char *)get_ux_text_common(58, v36);
  v38 = printf(v37);
  if ( !get_timed_status(v38) && v56 )
  {
    br(0);
    v40 = get_ux_text_common(1055, v39);
    v41 = printf("<span class=gray_text>%s</span>", v40);
    br(v41);
    print_nbsp(10);
    v43 = get_ux_text_common(1056, v42);
    printf("<span class=gray_text>%s</span>", v43);
  }
  printf("</td>");
  printf("</tr></table>");
  return printf("<script> ClickAutoReboot_2(document.sysconf_fm);</script>");
}
// 10AE4: using guessed type int __fastcall read_sched_array(_DWORD, _DWORD, _DWORD);
// 11204: using guessed type int __fastcall get_autoreboot_config(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 120EC: using guessed type int __cdecl get_timed_status(_DWORD);

//----- (0001FC1C) --------------------------------------------------------
int print_usb_mode_table_sysconf()
{
  char *v0; // r4@1
  int v1; // r0@1
  int v2; // r1@1
  char *v3; // r6@2
  int v4; // r0@4
  int v5; // r0@4
  int v6; // r0@4
  int v7; // r1@4
  int v8; // r0@6
  int v9; // r1@6
  int v10; // r0@6

  v0 = "checked";
  v1 = printf("<table CELLPADDING=0 CELLSPACING=0><tr><td style=\"padding-left:5px;padding-top:2px; line-height: 20px;\">");
  if ( get_usb_mode(v1) == 2 )
    v3 = "checked";
  else
    v3 = "";
  v4 = get_ux_text_common(1370, v2);
  v5 = printf(
         "<input type=radio id=usb_mode2 name=usb_mode value=2 %s onclick=\"ShowUSBMessage_2();\"><label for=usb_mode2> %s</label>",
         v3,
         v4);
  v6 = br(v5);
  if ( get_usb_mode(v6) != 3 )
    v0 = "";
  v8 = get_ux_text_common(1371, v7);
  printf(
    "<input type=radio id=usb_mode3 name=usb_mode value=3 %s onclick=\"ShowUSBMessage_2();\"><label for=usb_mode3> %s</label>",
    v0,
    v8);
  printf("</td><td style=\"padding:20px 0 0 10;\">");
  v10 = get_ux_text_common(1368, v9);
  printf("<span ID=usb30_desc style=\"display:none;\" class=\"gray_text\">%s</span>", v10);
  printf("</td></tr></table>");
  return printf("<script> ShowUSBMessage_2(); </script>");
}
// 1172C: using guessed type int __fastcall get_usb_mode(_DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);

//----- (0001FCD4) --------------------------------------------------------
int print_restart_table_sysconf()
{
  int v0; // r1@1
  int v1; // r0@1

  printf("<table CELLPADDING=0 CELLSPACING=0><tr height=23px><td style=\"padding-left:5px;\">");
  v1 = get_ux_text_common(1133, v0);
  printf("%s", v1);
  printf("</td>");
  return printf("</tr></table>");
}

//----- (0001FD18) --------------------------------------------------------
int __fastcall print_apcplan_sysconf(int a1)
{
  int v1; // r6@1
  char *v2; // r4@1
  int v3; // r1@1
  char *v4; // r7@2
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6
  int v8; // r1@6
  const char *v9; // r0@6

  v1 = get_apcplan_flag(a1);
  printf("<table width=100%% CELLPADDING=0 CELLSPACING=0 border=0>");
  v2 = "checked";
  printf("<tr height=23px>");
  printf("<td style=\"padding-left:5px;\" colspan=4>");
  if ( v1 )
    v4 = "checked";
  else
    v4 = "";
  v5 = get_ux_text_common(1104, v3);
  printf("<input type=radio id=apcplan_on name=apcplan value=1 %s><label for=apcplan_on> %s</label>", v4, v5);
  print_nbsp(10);
  if ( v1 )
    v2 = "";
  v7 = get_ux_text_common(1111, v6);
  printf("<input type=radio id=apcplan_off name=apcplan value=0 %s><label for=apcplan_off> %s</label>", v2, v7);
  printf("</td><tr height=15px><td>&nbsp;</td></tr><tr height=23px><td style=\"padding-left:5px;\">");
  printf("<span class=gray_text><li>");
  v9 = (const char *)get_ux_text_common(1126, v8);
  printf(v9);
  puts("</span>");
  printf("</td>");
  return printf("</tr></table>");
}
// 111EC: using guessed type int __fastcall get_apcplan_flag(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);

//----- (0001FDF8) --------------------------------------------------------
int print_hubapmode_table_sysconf()
{
  char *v0; // r4@1
  int v1; // r0@1
  int v2; // r1@1
  char *v3; // r5@2
  int v4; // r0@4
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6
  int v8; // r1@6
  int v9; // r0@6
  int v10; // r1@6
  int v11; // r0@6
  char v13; // [sp+4h] [bp-54h]@6
  char v14; // [sp+18h] [bp-40h]@6
  char v15; // [sp+2Ch] [bp-2Ch]@6

  printf("<table width=100%% CELLPADDING=0 CELLSPACING=0 border=0>");
  v0 = "checked";
  printf("<tr height=\"24\">");
  v1 = printf("<td style=\"padding-left:5px;\" colspan=\"4\">");
  if ( get_use_local_gateway(v1) )
    v3 = "checked";
  else
    v3 = "";
  v4 = get_ux_text_common(1224, v2);
  printf(
    "<input type=\"radio\" id=use_local_gateway_on name=\"use_local_gateway\" value=\"1\" onclick=\"ChangeLanIPSetupForm("
    "document.sysconf_fm);\" %s><label for=use_local_gateway_on> %s</label>",
    v3,
    v4);
  v5 = print_nbsp(10);
  if ( get_use_local_gateway(v5) )
    v0 = "";
  v7 = get_ux_text_common(1170, v6);
  printf(
    "<input type=\"radio\" id=use_local_gateway_off name=\"use_local_gateway\" value=\"0\" onclick=\"ChangeLanIPSetupForm"
    "(document.sysconf_fm);\" %s><label for=use_local_gateway_off> %s</label>",
    v0,
    v7);
  strcpy(&v15, "");
  strcpy(&v14, "");
  strcpy(&v13, "");
  iconfig_get_value_direct("lan_gateway", &v15);
  get_dns_shadow("br0", "local", &v14, &v13);
  v9 = get_ux_text_common(552, v8);
  printf(
    "</td></tr><tr height=\"24\"><td style=\"padding-left:5px; width: 150px;\">%s</td><td colspan=\"3\" style=\"padding-left:5px;\">",
    v9);
  print_html_ip_address((int)"gw", &v15, 0);
  v11 = get_ux_text_common(551, v10);
  printf(
    "</td></tr><tr height=\"24\"><td style=\"padding-left:5px;\">%s</td><td colspan=\"3\" style=\"padding-left:5px;\">",
    v11);
  print_html_ip_address((int)"fdns", &v14, 0);
  printf("</td></tr><tr height=\"24\"><td style=\"padding-left:5px;\"></td><td colspan=\"3\" style=\"padding-left:5px;\">");
  print_html_ip_address((int)"sdns", &v13, 0);
  printf("</td>");
  printf("</tr>");
  printf("</table>");
  return printf("<script>ChangeLanIPSetupForm(document.sysconf_fm);</script>");
}
// 110E4: using guessed type int __fastcall iconfig_get_value_direct(_DWORD, _DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 119E4: using guessed type int __fastcall get_dns_shadow(_DWORD, _DWORD, _DWORD, _DWORD);
// 11AA4: using guessed type int __fastcall get_use_local_gateway(_DWORD);

//----- (0001FF9C) --------------------------------------------------------
int __fastcall print_upnp_table_sysconf(int a1)
{
  int v1; // r6@1
  char *v2; // r4@1
  int v3; // r1@1
  char *v4; // r7@2
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6
  int v8; // r1@6
  int v9; // r4@6
  int v10; // r1@6
  int v11; // r0@6

  v1 = get_upnp(a1);
  printf("<table width=100%% CELLPADDING=0 CELLSPACING=0 border=0>");
  v2 = "checked";
  printf("<tr height=23px>");
  printf("<td style=\"padding-left:5px;\" colspan=4>");
  if ( v1 )
    v4 = "checked";
  else
    v4 = "";
  v5 = get_ux_text_common(1104, v3);
  printf("<input type=radio id=upnp_on name=upnp value=1 %s><label for=upnp_on> %s</label>", v4, v5);
  print_nbsp(10);
  if ( v1 )
    v2 = "";
  v7 = get_ux_text_common(1111, v6);
  printf("<input type=radio id=upnp_off name=upnp value=0 %s><label for=upnp_off> %s</label>", v2, v7);
  printf("</td></tr><tr height=10px><td colspan=4></td></tr> ");
  printf("<tr><td colspan=4 style=\"padding-left:5px;\"");
  printf("<div id=\"upnp_div\">");
  printf("<table width=100%% border=0 cellspacing=0 cellpadding=0>\n");
  puts("<tr><td class=\"st_text_td\">");
  v9 = get_ux_text_common(1362, v8);
  v11 = get_ux_text_common(1361, v10);
  printf(
    "<SPAN class=\"movetomain\"><a href=\"javascript:MovePagetoMainURL('natrouterconf','portforward','mode=upnp');\"><u>%"
    "s</u></a> %s</SPAN>",
    v9,
    v11);
  printf("</td>");
  printf("</tr>");
  puts("</table>");
  printf("</div>");
  printf("</td>");
  printf("</tr>");
  printf("<tr><td>");
  printf("<div id=\"upnp_desc\" style=\"border:none; width:100%%; height:80px;\">");
  printf("</div>");
  return printf("</td></tr></table>");
}
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 1193C: using guessed type int __fastcall get_upnp(_DWORD);

//----- (00020104) --------------------------------------------------------
int print_realtime_table_sysconf()
{
  int v0; // r5@1
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r4@6
  char *v9; // r0@6
  int v10; // r0@6
  int v11; // r1@6
  int v12; // r0@6
  char *v13; // r2@8
  int v14; // r1@10
  char *v15; // r3@10
  int v16; // r0@11
  char *v17; // r1@12
  int v18; // r1@14
  int v19; // r0@14
  int v20; // r0@14
  int v21; // r0@14
  int v22; // r1@17
  const char *v23; // r0@17
  int v24; // r0@17
  int v25; // r1@17
  const char *v26; // r0@17
  int v27; // r0@17
  char v29; // [sp+4h] [bp-114h]@2
  char v30; // [sp+84h] [bp-94h]@1
  char v31; // [sp+C4h] [bp-54h]@7
  int v32; // [sp+D4h] [bp-44h]@11
  char v33; // [sp+D8h] [bp-40h]@15

  v0 = 0;
  puts("<table cellspacing=0px cellpadding=0px>");
  printf("<tr style='height: 24px;'>");
  v2 = get_ux_text_common(1217, v1);
  printf("<td style='width:150px;'><span style='padding-left: 5px;'>%s</span></td>", v2);
  printf((const char *)&unk_7F939);
  v3 = printf("</td>");
  etr(v3);
  printf("<tr style='height: 24px;'>");
  v5 = get_ux_text_common(1219, v4);
  printf("<td><span style='padding-left: 5px;'>%s</span></td>\n", v5);
  puts("<td>");
  get_timeserver_conf(&v30);
  printf("<select name=server_list onchange=\"SelectTimeServer()\" style='width: 145px; margin-right: 10px; height: 20px; border: 1px solid #CCC;'>");
  v7 = get_ux_text_common(1218, v6);
  printf("<option value=null> %s </option>", v7);
  do
  {
    if ( !get_timeserver_list(v0, &v29) )
      break;
    printf("<option value=%s ", &v29);
    if ( !strcmp(&v29, &v30) )
      printf("selected");
    ++v0;
    printf(">%s</option>", &v29);
  }
  while ( v0 != 15 );
  v8 = 0;
  printf("</select>");
  v9 = sub_1E5B0();
  printf(
    "<input type=text name=server_edit value=\"%s\" size=24 maxlength=60 style='border: 1px solid #CCC; padding-left: 4px"
    "; width: 215px; height: 20px;'>",
    v9);
  v10 = puts("</td>");
  etr(v10);
  printf("<tr style='height: 24px;'>");
  v12 = get_ux_text_common(1220, v11);
  printf("<td><span style='padding-left: 5px;'>%s</span></td>\n", v12);
  puts("<td>");
  puts("<select name=gmtidx style='width: 370px; border: 1px solid #CCC; height: 20px;'>");
  do
  {
    if ( !strcmp(&byte_CA980[144 * v8], &v31) )
      v13 = "selected";
    else
      v13 = "";
    v14 = v8;
    v15 = &byte_CA980[144 * v8++ + 8];
    printf("<option value=%d %s>%s</option>", v14, v13, v15);
  }
  while ( v8 != 28 );
  puts("</select>");
  v16 = printf("</td>");
  etr(v16);
  printf("<tr style='height: 24px;'>");
  puts("<td></td>");
  puts("<td>");
  if ( v32 )
    v17 = "checked";
  else
    v17 = "";
  printf("<input type=checkbox id=summer_flag name=summer_flag value=1 style='vertical-align: middle;' %s>", v17, "");
  v19 = get_ux_text_common(1221, v18);
  printf("<label for=summer_flag>%s</label>", v19);
  v20 = puts("</td>");
  v21 = etr(v20);
  if ( !get_timed_status(v21) && (!get_wan_ip("wan1", &v33) || !get_wan_link("wan1")) )
  {
    printf("<tr height=70>");
    printf("<td colspan=2 align=left>");
    printf("<span class=gray_text>");
    v23 = (const char *)get_ux_text_common(1053, v22);
    v24 = printf(v23);
    br(v24);
    v26 = (const char *)get_ux_text_common(1054, v25);
    printf(v26);
    v27 = printf("</span>");
    etr(v27);
  }
  printf("</table>");
  printf("<iframe name=\"sysconf_misc_realtime_status\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_misc_realtime_status\" style='display: none;' frameborder=no></iframe>");
  puts("<script>");
  puts("SelectTimeServer();");
  return puts("</script>");
}
// 1082C: using guessed type int __fastcall get_timeserver_conf(_DWORD);
// 10E8C: using guessed type int __fastcall get_wan_link(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 119B4: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);
// 11A68: using guessed type int __fastcall get_timeserver_list(_DWORD, _DWORD);
// 120EC: using guessed type int __cdecl get_timed_status(_DWORD);

//----- (0002041C) --------------------------------------------------------
int lang_selector()
{
  char *v0; // r4@2
  void *v1; // r0@4
  char *v2; // r1@4
  const char *v3; // r4@4
  char *v4; // r10@7
  void *v5; // r0@9
  int v7; // [sp+4h] [bp+0h]@1
  char v8; // [sp+24h] [bp+20h]@4
  __int16 v9; // [sp+42h] [bp+3Eh]@10
  char v10; // [sp+3E8h] [bp+3E4h]@1

  get_si("sw", &v7);
  get_system_lang(&v10);
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=23px><td style=\"padding-left:5px;width:\" colspan=4>");
  printf("<select name=multilang_lang style='height: 20px; width: 200px;'>");
  if ( !strcmp(&v10, "auto") )
    v0 = "selected";
  else
    v0 = "";
  v1 = auto_select_lang("auto");
  v2 = v0;
  v3 = &v8;
  printf("<option value='auto' %s>%s</option>", v2, v1);
  do
  {
    if ( *v3 )
    {
      if ( !strcmp(&v10, v3) )
        v4 = "selected";
      else
        v4 = "";
      v5 = auto_select_lang(v3);
      printf("<option value='%s' %s>%s</option>", v3, v4, v5);
    }
    v3 += 5;
  }
  while ( (__int16 *)v3 != &v9 );
  printf("</select>");
  printf("</td></tr>");
  return printf("</TABLE>");
}
// 104B4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// 10E5C: using guessed type int __fastcall get_system_lang(_DWORD);

//----- (00020534) --------------------------------------------------------
int __fastcall print_service_body_sysconf(const char *a1, int a2)
{
  int v2; // r5@1
  const char *v3; // r4@1
  int result; // r0@2
  int v5; // r2@21
  int v6; // r3@21

  v2 = a2;
  v3 = a1;
  if ( !strcmp(a1, "hostname") )
  {
    result = print_hostname_table_sysconf();
  }
  else if ( !strcmp(v3, "configmgmt") )
  {
    result = print_configmgmt_table_sysconf();
  }
  else if ( !strcmp(v3, "autosaving") )
  {
    result = print_autosaving_table_sysconf((int)v3);
  }
  else if ( !strcmp(v3, "ispfake") )
  {
    result = print_ispfake_table_sysconf();
  }
  else if ( !strcmp(v3, "mgmt_port") )
  {
    result = print_mgmt_prot_table_sysconf((int)v3);
  }
  else if ( !strcmp(v3, "fakedns") )
  {
    result = print_fakedns_table_sysconf((int)v3);
  }
  else if ( !strcmp(v3, "dhcp_restart") )
  {
    result = print_dhcp_restart_table_sysconf();
  }
  else if ( !strcmp(v3, "nologin") )
  {
    result = print_nologin_table_sysconf((int)v3);
  }
  else if ( !strcmp(v3, "wbmpopup") )
  {
    result = print_wbmpopup_table_sysconf((int)v3);
  }
  else if ( !strcmp(v3, "upnp") )
  {
    result = print_upnp_table_sysconf((int)v3);
  }
  else if ( !strcmp(v3, "led") )
  {
    result = print_led_table_sysconf((int)v3, v2, v5, v6);
  }
  else if ( !strcmp(v3, (const char *)&unk_7EB54) )
  {
    result = print_auto_table_sysconf();
  }
  else if ( !strcmp(v3, "usb_mode") )
  {
    result = print_usb_mode_table_sysconf();
  }
  else if ( !strcmp(v3, "restart") )
  {
    result = print_restart_table_sysconf();
  }
  else if ( !strcmp(v3, "apcplan") )
  {
    result = print_apcplan_sysconf((int)v3);
  }
  else if ( !strcmp(v3, "macclone_giga") )
  {
    result = print_macclone_giga_sysconf((int)v3);
  }
  else if ( !strcmp(v3, "hubapmode") )
  {
    result = print_hubapmode_table_sysconf();
  }
  else if ( !strcmp(v3, "realtime") )
  {
    result = print_realtime_table_sysconf();
  }
  else
  {
    result = strcmp(v3, "multilang");
    if ( !result )
      result = lang_selector();
  }
  return result;
}

//----- (00020834) --------------------------------------------------------
int __fastcall print_sysconf_misc_body(const char *a1, int a2, int a3)
{
  const char *v3; // r4@1
  int v4; // r6@1
  int v5; // r5@1

  v3 = a1;
  v4 = a3;
  v5 = a2;
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%% ID=%s_table STYLE=\"display:none;\">", a1);
  if ( v4 )
    printf(
      "<tr><td height=20 valign=center style=\"padding:3px;width:180px;\">&nbsp; <b>%s</b></td><td align=right>%s</td></tr>",
      v5,
      v4);
  else
    printf("<tr><td colspan=2 height=20 valign=center style=\"padding:3px;\">&nbsp; <b>%s</b></td></tr>", v5);
  printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=2 style='width:640px;'></td></tr>");
  printf("<tr><td  colspan=2 valign=top style=\"padding:5px\" >");
  print_service_body_sysconf(v3, 0);
  return puts((const char *)&unk_7FF8C);
}

//----- (000208B8) --------------------------------------------------------
int __fastcall apply_sysconf(int a1)
{
  int v1; // r5@1
  int result; // r0@1
  char *v3; // r0@5
  int v4; // r0@7
  int v5; // r4@10
  int v6; // r7@14
  int v7; // r0@18
  int v8; // r4@21
  const char *v9; // r1@22
  int v10; // r0@24
  int *v11; // r0@28
  signed int v12; // r1@28
  int v13; // r0@33
  int v14; // r0@36
  int v15; // r0@39
  int v16; // r0@42
  int v17; // r0@44
  int v18; // r0@54
  int v19; // r6@56
  int v20; // r0@56
  bool v21; // zf@56
  signed int v22; // r6@59
  int v23; // r7@64
  int v24; // r0@64
  signed int v25; // r3@64
  int v26; // r6@71
  int v27; // r0@71
  signed int v28; // r3@71
  char v29; // r0@75
  int v30; // r6@77
  int v31; // r0@77
  signed int v32; // r3@77
  char v33; // r0@81
  int v34; // r6@83
  int v35; // r0@83
  signed int v36; // r3@83
  char v37; // r0@87
  int v38; // r6@89
  int v39; // r0@89
  signed int v40; // r3@89
  char v41; // r0@93
  int v42; // r6@95
  int v43; // r0@95
  signed int v44; // r3@95
  char v45; // r0@99
  int v46; // r6@101
  int v47; // r0@101
  signed int v48; // r3@101
  char v49; // r0@105
  int v50; // r0@119
  int v51; // r0@122
  int v52; // r0@130
  int v53; // r0@138
  int v54; // r0@138
  int v55; // r0@138
  int v56; // r0@140
  int v57; // r0@141
  int v58; // r1@141
  int v59; // r0@142
  int v60; // [sp+0h] [bp-5D0h]@128
  int v61; // [sp+10h] [bp-5C0h]@128
  int v62; // [sp+24h] [bp-5ACh]@128
  char v63; // [sp+38h] [bp-598h]@128
  int v64; // [sp+4Ch] [bp-584h]@128
  int v65; // [sp+60h] [bp-570h]@128
  char s; // [sp+3B8h] [bp-218h]@3
  int v67; // [sp+3D8h] [bp-1F8h]@64
  int v68; // [sp+3DCh] [bp-1F4h]@63
  char v69; // [sp+3E0h] [bp-1F0h]@69
  char v70; // [sp+3E1h] [bp-1EFh]@77
  char v71; // [sp+3E2h] [bp-1EEh]@83
  char v72; // [sp+3E3h] [bp-1EDh]@89
  char v73; // [sp+3E4h] [bp-1ECh]@95
  char v74; // [sp+3E5h] [bp-1EBh]@101
  char v75; // [sp+3E6h] [bp-1EAh]@107
  int v76; // [sp+3E8h] [bp-1E8h]@108
  int v77; // [sp+3ECh] [bp-1E4h]@109
  int v78; // [sp+3F0h] [bp-1E0h]@111
  int v79; // [sp+3F4h] [bp-1DCh]@109
  int v80; // [sp+3F8h] [bp-1D8h]@111
  char v81; // [sp+4B8h] [bp-118h]@132
  int v82; // [sp+4F8h] [bp-D8h]@138
  int v83; // [sp+500h] [bp-D0h]@138
  int v84; // [sp+504h] [bp-CCh]@138
  int v85; // [sp+508h] [bp-C8h]@136
  unsigned __int8 v86; // [sp+50Ch] [bp-C4h]@1
  int v87; // [sp+54Ch] [bp-84h]@124
  char v88; // [sp+560h] [bp-70h]@124
  __int16 v89; // [sp+574h] [bp-5Ch]@54
  int v90; // [sp+588h] [bp-48h]@56
  int v91; // [sp+59Ch] [bp-34h]@27
  int v92; // [sp+5A0h] [bp-30h]@50
  int v93; // [sp+5A4h] [bp-2Ch]@52
  int v94; // [sp+5B0h] [bp-20h]@18
  int v95; // [sp+5B4h] [bp-1Ch]@1

  v1 = a1;
  result = get_value_post(a1, "service", &v86, 64);
  v95 = 0;
  if ( !result )
    return result;
  if ( !strcmp((const char *)&v86, "hostname") )
  {
    if ( !get_value_post(v1, "hostnameh", &s, 255) || check_unpermitted_chars(&s) )
      v3 = 0;
    else
      v3 = &s;
    v4 = set_hostname(v3);
    goto LABEL_143;
  }
  if ( !strcmp((const char *)&v86, "autosaving") )
  {
    result = get_value_post(v1, "autosavingh", &v86, 64);
    if ( !result )
      return result;
    v5 = atoi((const char *)&v86);
    v4 = set_autosaving();
    if ( !v5 )
      v4 = saveconf(v4);
    goto LABEL_143;
  }
  if ( !strcmp((const char *)&v86, "ispfake") )
  {
    result = get_value_post(v1, "ispfake", &v86, 64);
    if ( !result )
      return result;
    v6 = atoi((const char *)&v86);
    memset(&s, 0, 0x80u);
    if ( !get_value_post(v1, "ispfake_path", &s, 128) )
      memset(&s, 0, 0x80u);
    v4 = set_ispfake(v6, &s);
    goto LABEL_143;
  }
  if ( !strcmp((const char *)&v86, "mgmt_port") )
  {
    v94 = 0;
    get_intvalue_post(v1, (int)"mgmt_port", (int)&v94);
    v7 = set_router_mgmt_port(v94);
LABEL_45:
    saveconf(v7);
    signal_reboot(3);
    return 2;
  }
  if ( !strcmp((const char *)&v86, "fakedns") )
  {
    result = get_value_post(v1, "fakednsh", &v86, 64);
    if ( !result )
      return result;
    v8 = atoi((const char *)&v86);
    if ( v8 )
      v9 = "@{62}";
    else
      v9 = "@{63}";
    syslog_msg(1, v9);
    v10 = set_fakedns(v8);
    goto LABEL_115;
  }
  if ( !strcmp((const char *)&v86, "dhcp_restart") )
  {
    v10 = get_value_post(v1, "dhcp_auto_restart_1", &v86, 64);
    if ( v10 )
    {
      get_wan_hw_ifname("wan1", &v91);
      if ( !strcmp((const char *)&v86, "on") )
      {
        v11 = &v91;
        v12 = 1;
      }
      else
      {
        v11 = &v91;
        v12 = 0;
      }
      v10 = set_dhcp_auto_restart(v11, v12);
    }
    goto LABEL_115;
  }
  if ( !strcmp((const char *)&v86, "nologin") )
  {
    result = get_value_post(v1, "nologinh", &v86, 64);
    if ( !result )
      return result;
    v13 = atoi((const char *)&v86);
    v4 = set_nologin(v13);
    goto LABEL_143;
  }
  if ( !strcmp((const char *)&v86, "wbmpopup") )
  {
    if ( !get_value_post(v1, "wbmpopuph", &v86, 64) )
      return 0;
    v14 = atoi((const char *)&v86);
    v4 = set_wbm_popup_flag(v14);
LABEL_143:
    signal_save(v4);
    return 1;
  }
  if ( !strcmp((const char *)&v86, "apcplan") )
  {
    result = get_value_post(v1, "apcplanh", &v86, 64);
    if ( !result )
      return result;
    v15 = atoi((const char *)&v86);
    v4 = set_apcplan_flag(v15);
    goto LABEL_143;
  }
  if ( !strcmp((const char *)&v86, "usb_mode") )
  {
    result = get_value_post(v1, "usbmodeh", &v86, 64);
    if ( !result )
      return result;
    v16 = atoi((const char *)&v86);
    if ( v16 != 3 )
      v16 = 2;
    set_usb_mode(v16);
    v17 = syslog_msg(1, "@{42}");
    v7 = syslog_save(v17);
    goto LABEL_45;
  }
  if ( strcmp((const char *)&v86, "led") )
  {
    if ( !strcmp((const char *)&v86, (const char *)&unk_7EB54) )
    {
      v89 = 0;
      v18 = get_value_post(v1, "autorebooth", &v86, 64);
      if ( v18 )
        v18 = atoi((const char *)&v86);
      v90 = v18;
      set_autoreboot_config(&v90);
      memset(&s, 0, 0x44u);
      v19 = get_value_post(v1, "everyday", &v89, 2);
      v20 = atoi((const char *)&v89);
      v21 = v19 == 0;
      if ( v19 )
        v21 = v20 == 0;
      v22 = !v21;
      if ( v21 )
        v20 = v22;
      v68 = v20;
      if ( !v20 )
      {
        LOWORD(v91) = 0;
        v67 = 1;
        v23 = get_value_post(v1, "sun", &v91, 2);
        v24 = strcmp((const char *)&v91, "1");
        v25 = v23;
        if ( v23 )
          v25 = 1;
        if ( v24 )
          v25 = 0;
        if ( v25 )
          v69 = atoi((const char *)&v91);
        else
          v69 = 0;
        v26 = get_value_post(v1, "mon", &v91, 2);
        v27 = strcmp((const char *)&v91, "1");
        v28 = v26;
        if ( v26 )
          v28 = 1;
        if ( v27 )
          v28 = 0;
        v29 = v28;
        if ( v28 )
          v29 = atoi((const char *)&v91);
        v70 = v29;
        v30 = get_value_post(v1, "tue", &v91, 2);
        v31 = strcmp((const char *)&v91, "1");
        v32 = v30;
        if ( v30 )
          v32 = 1;
        if ( v31 )
          v32 = 0;
        v33 = v32;
        if ( v32 )
          v33 = atoi((const char *)&v91);
        v71 = v33;
        v34 = get_value_post(v1, "wed", &v91, 2);
        v35 = strcmp((const char *)&v91, "1");
        v36 = v34;
        if ( v34 )
          v36 = 1;
        if ( v35 )
          v36 = 0;
        v37 = v36;
        if ( v36 )
          v37 = atoi((const char *)&v91);
        v72 = v37;
        v38 = get_value_post(v1, "thu", &v91, 2);
        v39 = strcmp((const char *)&v91, "1");
        v40 = v38;
        if ( v38 )
          v40 = 1;
        if ( v39 )
          v40 = 0;
        v41 = v40;
        if ( v40 )
          v41 = atoi((const char *)&v91);
        v73 = v41;
        v42 = get_value_post(v1, "fri", &v91, 2);
        v43 = strcmp((const char *)&v91, "1");
        v44 = v42;
        if ( v42 )
          v44 = 1;
        if ( v43 )
          v44 = 0;
        v45 = v44;
        if ( v44 )
          v45 = atoi((const char *)&v91);
        v74 = v45;
        v46 = get_value_post(v1, "sat", &v91, 2);
        v47 = strcmp((const char *)&v91, "1");
        v48 = v46;
        if ( v46 )
          v48 = 1;
        if ( v47 )
          v48 = 0;
        v49 = v48;
        if ( v48 )
          v49 = atoi((const char *)&v91);
        v75 = v49;
      }
      v76 = 0;
      if ( get_value_post(v1, "autorebootHour", &v86, 64) )
      {
        v77 = atoi((const char *)&v86);
        v79 = v77;
      }
      if ( get_value_post(v1, "autorebootMin", &v86, 64) )
      {
        v78 = atoi((const char *)&v86);
        v80 = v78;
      }
      remove_all_gen_schedule(&unk_7EB54);
      if ( v90 )
        add_gen_schedule(&unk_7EB54, &s);
      v10 = iconfig_remove_config_tag("last_autoboot_stamp");
      goto LABEL_115;
    }
    if ( strcmp((const char *)&v86, "restart") )
    {
      if ( strcmp((const char *)&v86, "upnp") )
      {
        if ( !strcmp((const char *)&v86, "macclone_giga") )
        {
          get_value_post(v1, "macclone_giga", &s, 64);
          v51 = atoi(&s);
          v7 = set_macclone_in_giga(v51);
          goto LABEL_45;
        }
        if ( !strcmp((const char *)&v86, "hubapmode") )
        {
          get_ifconfig((int)"br0", (int)&v88, (int)&v87);
          get_value_post(v1, "use_local_gateway", &s, 32);
          if ( !strcmp(&s, "1") && get_ip_value_post(v1, "gw", &v91) )
          {
            set_use_local_gateway(1);
            set_lan_ipconfig(&v88, &v87, &v91);
            get_ip_value_post(v1, "fdns", &v90);
            get_ip_value_post(v1, "sdns", &v89);
            set_dns_shadow("br0", "local", &v90, &v89);
          }
          else
          {
            set_use_local_gateway(0);
            set_lan_ipconfig(&v88, &v87, 0);
          }
          dhcpd_read_config(&v60);
          sf_strncpy(&v63, &v88, 20);
          sf_strncpy(&v64, &v87, 20);
          get_subnet_range(&v88, &v87, &v61, &v62);
          if ( !strcmp((const char *)&v65, &v88) )
            sf_strncpy(&v65, &v88, 20);
          v52 = dhcpd_commit_config(&v60);
          v7 = dhcpd_flush_dynamic_lease(v52);
          goto LABEL_45;
        }
        if ( !strcmp((const char *)&v86, "realtime") )
        {
          memset(&v81, 0, 0x54u);
          get_value_post(v1, "server_list", &v81, 64);
          if ( strcmp(&v81, "null") || (get_value_post(v1, "server_edit", &v81, 64), !check_unpermitted_chars(&v81)) )
          {
            if ( !v81 )
              strcpy(&v81, "null");
            if ( !get_intvalue_post(v1, (int)"summer_flag", (int)&v85) )
              v85 = 0;
            get_intvalue_post(v1, (int)"gmtidx", (int)&v95);
            sf_strncpy(&v82, &byte_CA980[144 * v95], 8);
            v83 = byte_CA980[144 * v95 + 136] == 43;
            v84 = *(_DWORD *)&byte_CA980[144 * v95 + 140];
            v53 = set_timeserver_conf(&v81);
            v54 = clear_timed_status(v53);
            v55 = signal_update(v54);
            signal_save(v55);
            signal_start("realtime");
            return 1;
          }
        }
        else if ( !strcmp((const char *)&v86, "multilang") )
        {
          v56 = get_value_post(v1, "multilang_lang", &v91, 16);
          if ( v56 )
          {
            v57 = set_system_lang(&v91);
            v56 = set_ux_text_common(v57, v58);
          }
          v59 = signal_update(v56);
          signal_save(v59);
          return 3;
        }
        return 0;
      }
      result = get_value_post(v1, "upnph", &v91, 2);
      if ( !result )
        return result;
      v50 = atoi((const char *)&v91);
      set_upnp(v50);
    }
    v7 = syslog_msg(1, "@{42}");
    goto LABEL_45;
  }
  get_led_silent_control(&v91);
  v91 = 0;
  result = get_value_post(v1, "ledh", &v86, 64);
  if ( !result )
    return result;
  v91 = atoi((const char *)&v86);
  if ( get_value_post(v1, "ledstart", &v86, 64) )
  {
    result = v86;
    if ( !v86 )
      return result;
    v92 = atoi((const char *)&v86);
  }
  get_value_post(v1, "ledend", &v86, 64);
  result = v86;
  if ( !v86 )
    return result;
  v93 = atoi((const char *)&v86);
  v10 = set_led_silent_control(&v91);
LABEL_115:
  v4 = signal_update(v10);
  goto LABEL_143;
}
// 10430: using guessed type int __fastcall syslog_save(_DWORD);
// 10520: using guessed type int __fastcall set_nologin(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 1067C: using guessed type int __fastcall set_led_silent_control(_DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 1085C: using guessed type int __fastcall set_dns_shadow(_DWORD, _DWORD, _DWORD, _DWORD);
// 10910: using guessed type int __fastcall set_upnp(_DWORD);
// 10A90: using guessed type int set_autosaving(void);
// 10B5C: using guessed type int __fastcall set_autoreboot_config(_DWORD);
// 10C28: using guessed type int __fastcall set_ispfake(_DWORD, _DWORD);
// 10C64: using guessed type int __fastcall signal_start(_DWORD);
// 10DD8: using guessed type int __fastcall set_wbm_popup_flag(_DWORD);
// 10E50: using guessed type int __fastcall dhcpd_flush_dynamic_lease(_DWORD);
// 10FD0: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// 10FF4: using guessed type int __fastcall saveconf(_DWORD);
// 11000: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// 11024: using guessed type int __fastcall get_led_silent_control(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 1127C: using guessed type int __fastcall set_timeserver_conf(_DWORD);
// 11318: using guessed type int __fastcall set_hostname(_DWORD);
// 113CC: using guessed type int syslog_msg(_DWORD, const char *, ...);
// 11468: using guessed type int __fastcall set_system_lang(_DWORD);
// 1154C: using guessed type int __fastcall set_router_mgmt_port(_DWORD);
// 11594: using guessed type int __fastcall set_apcplan_flag(_DWORD);
// 11600: using guessed type int __fastcall dhcpd_read_config(_DWORD);
// 11618: using guessed type int __fastcall iconfig_remove_config_tag(_DWORD);
// 11678: using guessed type int __fastcall signal_reboot(_DWORD);
// 11720: using guessed type int __fastcall set_fakedns(_DWORD);
// 11798: using guessed type int __fastcall clear_timed_status(_DWORD);
// 117C8: using guessed type int __fastcall dhcpd_commit_config(_DWORD);
// 1190C: using guessed type int __fastcall set_use_local_gateway(_DWORD);
// 11BF4: using guessed type int __fastcall set_usb_mode(_DWORD);
// 11C18: using guessed type int __fastcall add_gen_schedule(_DWORD, _DWORD);
// 11C60: using guessed type int __fastcall get_subnet_range(_DWORD, _DWORD, _DWORD, _DWORD);
// 11C84: using guessed type int __fastcall set_macclone_in_giga(_DWORD);
// 11CA8: using guessed type int __fastcall set_lan_ipconfig(_DWORD, _DWORD, _DWORD);
// 11CF0: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// 11E40: using guessed type int __fastcall remove_all_gen_schedule(_DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);
// 11FA8: using guessed type int __fastcall set_dhcp_auto_restart(_DWORD, _DWORD);

//----- (00021578) --------------------------------------------------------
int print_iframe_upnp_sysconf_misc()
{
  FILE *v0; // r7@1
  int v1; // r4@2
  char *v2; // r0@4
  const char *v3; // r6@5
  char *v4; // r0@5
  const char *v5; // r10@6
  unsigned __int16 v6; // r11@6
  char *v7; // r0@6
  const char *v8; // r9@7
  char *v9; // r0@7
  const char *v10; // r6@8
  int v11; // r9@8
  int v12; // r5@11
  const char *v13; // r1@13
  int v15; // [sp+0h] [bp-A8h]@4

  printf("<html><head></head><body width=100%% bottommargin=0 rightmargin=0 leftmargin=0 topmargin=0 marginheight=0 >");
  printf("<form method=post action=\"timepro.cgi\" name=\"upnp_list_fm\">");
  printf("<input type=hidden name=\"tmenu\" value=\"popup\">");
  printf("<input type=hidden name=\"smenu\" value=\"upnp_list\">");
  printf("<table cellspacing=0px cellpadding=0px border=0 width=100%% align=left>");
  v0 = fopen("/var/run/upnp_pmlist", "r");
  if ( v0 )
  {
    v1 = 0;
    while ( fgets((char *)&v15, 128, v0) )
    {
      v2 = strchr((const char *)&v15, 59);
      ++v1;
      if ( v2 )
      {
        *v2 = 0;
        v3 = v2 + 1;
        v4 = strchr(v2 + 1, 59);
        if ( v4 )
        {
          *v4 = 0;
          v5 = v4 + 1;
          v6 = atoi(v3);
          v7 = strchr(v5, 59);
          if ( v7 )
          {
            *v7 = 0;
            v8 = v7 + 1;
            v9 = strchr(v7 + 1, 59);
            if ( v9 )
            {
              *v9 = 0;
              v10 = v9 + 1;
              v11 = (unsigned __int16)atoi(v8);
              *strchr(v10, 10) = 0;
              printf("<tr style=\"background:#%s;height:20px;\">");
              printf("<td width=72px style=\"padding-left:5px;\">%s</td>\n", &v15);
              printf("<td width=76px>%d</td>\n", v6);
              printf("<td width=146px>%s:%d</td>\n", v5, v11);
              printf("<td width=318px>%s</td>\n", v10);
              printf("</tr>");
            }
          }
        }
      }
    }
    fclose(v0);
  }
  else
  {
    v1 = 0;
  }
  v12 = 0;
  while ( v12 < 5 - v1 )
  {
    if ( ((_BYTE)v12 + (_BYTE)v1) & 1 )
      v13 = "f7f7f7";
    else
      v13 = "ffffff";
    ++v12;
    printf("<TR height=20 STYLE=\"background-Color:#%s\">", v13);
    printf("<TD></TD><TD></TD><TD CLASS=text_gray></TD><TD></TD></TR>");
  }
  printf("</table>");
  printf("</form>");
  return printf((const char *)&unk_8031F);
}

//----- (00021780) --------------------------------------------------------
int print_iframe_sysconf_misc_realtime_status()
{
  int v1; // [sp+0h] [bp-108h]@1

  printf("<script>");
  getDayInfo((char *)&v1, 0x100u);
  printf("setTimeout(function() { ");
  printf("parent.document.getElementById('current_time').outerHTML = \"<span id='current_time'>%s</span>\";", &v1);
  printf(
    "parent.document.getElementsByName('sysconf_misc_iframe')[0].contentWindow.document.getElementById('realtime_value')."
    "outerHTML = '<TD CLASS=text_gray ID=realtime_value >%s</TD>';",
    &v1);
  printf("}, 500);");
  printf("setTimeout(function() { location.reload(); }, 3000);");
  return printf("</script>");
}

//----- (000217FC) --------------------------------------------------------
int __fastcall print_iframe_sysconf_misc(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r4@1
  int v4; // r6@1
  const char *v5; // r0@2
  int v6; // r0@4
  bool v7; // zf@4
  int *v8; // r1@4
  int *v9; // r0@4
  int result; // r0@7
  const char *v11; // r0@10
  int v12; // r1@10
  int v13; // r0@10
  int v14; // r1@10
  int v15; // r1@11
  int v16; // r0@12
  int v17; // r0@13
  int v18; // r1@13
  int v19; // r0@13
  char *v20; // r0@14
  int v21; // r1@15
  int v22; // r0@15
  int v23; // r0@15
  int v24; // r1@15
  int v25; // r0@16
  int v26; // r1@16
  int v27; // r0@17
  int v28; // r0@18
  int v29; // r0@18
  int v30; // r7@18
  int v31; // r1@18
  int v32; // r0@18
  int v33; // r1@18
  int v34; // r0@18
  int v35; // r0@18
  int v36; // r1@18
  int v37; // r0@19
  int v38; // r1@19
  int v39; // r0@20
  int v40; // r0@21
  int v41; // r0@21
  int v42; // r1@21
  int v43; // r0@22
  int v44; // r1@22
  int v45; // r0@23
  int v46; // r0@24
  int v47; // r0@24
  int v48; // r1@24
  int v49; // r0@25
  int v50; // r1@25
  int v51; // r0@26
  int v52; // r0@27
  int v53; // r0@27
  int v54; // r1@27
  int v55; // r0@28
  int v56; // r0@30
  int v57; // r1@30
  int v58; // r0@30
  int v59; // r0@30
  int v60; // r1@30
  int v61; // r0@31
  int v62; // r1@31
  int v63; // r0@32
  int v64; // r0@33
  int v65; // r1@33
  int v66; // r0@34
  int v67; // r0@35
  int v68; // r0@36
  int v69; // r1@36
  int v70; // r0@37
  int v71; // r1@37
  int v72; // r0@38
  int v73; // r0@39
  int v74; // r1@39
  int v75; // r0@40
  int v76; // r1@40
  int v77; // r0@41
  int v78; // r0@42
  int v79; // r1@42
  int v80; // r0@42
  int v81; // r0@42
  int v82; // r1@42
  int v83; // r0@43
  int v84; // r1@43
  int v85; // r0@44
  int v86; // r0@45
  int v87; // r0@45
  int v88; // r1@45
  int v89; // r0@46
  int v90; // r0@48
  int v91; // r1@48
  int v92; // r0@48
  int v93; // r0@48
  int v94; // r1@48
  int v95; // r0@49
  int v96; // r0@51
  int v97; // r1@51
  int v98; // r0@51
  int v99; // r1@51
  int v100; // r0@52
  int v101; // r0@54
  int v102; // r1@54
  int v103; // r0@54
  int v104; // r0@55
  int v105; // r0@55
  char v106; // [sp+8h] [bp-5B8h]@10
  char v107; // [sp+208h] [bp-3B8h]@10
  int v108; // [sp+408h] [bp-1B8h]@10
  int v109; // [sp+508h] [bp-B8h]@7
  int v110; // [sp+548h] [bp-78h]@4
  int v111; // [sp+588h] [bp-38h]@27
  int v112; // [sp+598h] [bp-28h]@10

  v2 = a2;
  v3 = a1;
  maekGMTData(a1, a2);
  print_js_file((int)"sysconf", (int)"misc");
  v4 = apply_sysconf(v2);
  if ( v4 != 3 )
  {
    if ( v3 )
    {
      v6 = get_parameter_value(v3, "service");
      v8 = (int *)v6;
      v7 = v6 == 0;
      v9 = &v110;
      if ( v7 )
      {
        strcpy((char *)&v110, "multilang");
LABEL_10:
        printf("<style>");
        printf("form { margin: 0; }");
        printf(".selected { background-color: #C9D5E9 !important; }");
        printf("</style>");
        printf("<BODY style=\"padding:0px 0px; margin:0px 0px;\">");
        printf("<form method=post action=\"timepro.cgi\" name=\"main_form\">");
        puts("<input type=hidden name=tmenu value=iframe>");
        printf("<input type=hidden name=\"smenu\" value=\"sysconf_misc\">");
        puts("<input type=hidden name=service value=>");
        puts("<input type=hidden name=run value=>");
        puts("<input type=hidden name=hostnameh value=>");
        puts("<input type=hidden name=autosavingh value=>");
        puts("<input type=hidden name=ispfake value=>");
        puts("<input type=hidden name=ispfake_path value=>");
        puts("<input type=hidden name=mgmt_port value=>");
        puts("<input type=hidden name=fakednsh value=>");
        puts("<input type=hidden name=dhcp_auto_restart_1 value=>");
        puts("<input type=hidden name=nologinh value=>");
        puts("<input type=hidden name=wbmpopuph value=>");
        puts("<input type=hidden name=apcplanh value=>");
        puts("<input type=hidden name=usbmodeh value=>");
        puts("<input type=hidden name=ledh value=>");
        puts("<input type=hidden name=ledstart value=>");
        puts("<input type=hidden name=ledend value=>");
        puts("<input type=hidden name=autorebooth value=>");
        puts("<input type=hidden name=everyday value=>");
        puts("<input type=hidden name=autorebootHour value=>");
        puts("<input type=hidden name=autorebootMin value=>");
        puts("<input type=hidden name=sun value=>");
        puts("<input type=hidden name=mon value=>");
        puts("<input type=hidden name=tue value=>");
        puts("<input type=hidden name=wed value=>");
        puts("<input type=hidden name=thu value=>");
        puts("<input type=hidden name=fri value=>");
        puts("<input type=hidden name=sat value=>");
        puts("<input type=hidden name=macclone_giga value=>");
        puts("<input type=hidden name=restarth value=>");
        puts("<input type=hidden name=upnph value=>");
        printf("<table style=\"border-collapse:collapse; border-style:none none none none; width:100%%;\" cellspacing=0px cellpadding=0px>\n");
        printf("<COL WIDTH=9><COL WIDTH=220><COL width=350><COL>");
        get_system_lang(&v112);
        v11 = (const char *)auto_select_lang((const char *)&v112);
        strcpy((char *)&v108, v11);
        strcpy(&v107, "");
        v13 = get_ux_text_common(1161, v12);
        sub_1E3AC((int)"multilang", v13, (int)&v108);
        puts("<input type=hidden name=multilang_lang >");
        memset(&v106, 0, 0xFFu);
        get_hostname(&v106);
        if ( v106 )
        {
          snprintf(
            (char *)&v108,
            0x100u,
            "<span id=hostname_status title=\"%s\" style=\" display:block; overflow:hidden; white-space:nowrap;  text-ove"
            "rflow:ellipsis; width:350px; \">%s </span>",
            &v106,
            &v106);
          snprintf(
            &v107,
            0x200u,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap;  text-overflow:ellipsis;\">%s</span>",
            "hostname",
            "");
        }
        else
        {
          v16 = get_ux_text_common(1169, v14);
          snprintf((char *)&v108, 0x100u, "<span id=hostname_status>%s</span>", v16, 0);
          strcpy(&v107, "");
        }
        v17 = get_ux_text_common(1138, v15);
        sub_1E3AC((int)"hostname", v17, (int)&v108);
        getDayInfo((char *)&v108, 0x100u);
        strcpy(&v107, "");
        v19 = get_ux_text_common(766, v18);
        sub_1E3AC((int)"realtime", v19, (int)&v108);
        puts("<input type=hidden name=server_list>");
        puts("<input type=hidden name=server_edit>");
        puts("<input type=hidden name=gmtidx>");
        puts("<input type=hidden name=summer_flag>");
        if ( v4 == 1 )
        {
          printf("<script>");
          v20 = sub_1E5B0();
          printf("parent.document.getElementsByName('server_edit')[0].value = '%s';", v20);
          printf("if((parent.document.getElementsByName('sysconf_misc_realtime_status')[0]) && parent.document.getElementsByName('sysconf_misc_realtime_status')[0].contentWindow)");
          printf("parent.document.getElementsByName('sysconf_misc_realtime_status')[0].contentWindow.location.reload();");
          printf("</script>");
        }
        strcpy((char *)&v108, "");
        strcpy(&v107, "");
        v22 = get_ux_text_common(763, v21);
        v23 = sub_1E3AC((int)"configmgmt", v22, (int)&v108);
        if ( get_autosaving(v23) <= 0 )
        {
          v27 = get_ux_text_common(1111, v24);
          snprintf((char *)&v108, 0x100u, "<span id=autosaving_status>%s</span>", v27, 3);
          strcpy(&v107, "");
        }
        else
        {
          v25 = get_ux_text_common(1104, v24);
          snprintf((char *)&v108, 0x100u, "<span id=autosaving_status>%s</span>", v25, 3);
          snprintf(
            &v107,
            0x200u,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap;  text-overflow:ellipsis;\">%s</span>",
            "auto_saving",
            "");
        }
        v28 = get_ux_text_common(1159, v26);
        v29 = sub_1E3AC((int)"autosaving", v28, (int)&v108);
        v30 = get_router_mgmt_port(v29);
        v32 = get_ux_text_common(1413, v31);
        snprintf((char *)&v108, 0x100u, "<span id=mgmt_port_status>%d %s</span>", v30, v32);
        strcpy(&v107, "");
        v34 = get_ux_text_common(1067, v33);
        v35 = sub_1E3AC((int)"mgmt_port", v34, (int)&v108);
        if ( get_fakedns(v35) <= 0 )
        {
          v39 = get_ux_text_common(1111, v36);
          snprintf((char *)&v108, 0x100u, "<span id=fakedns_status>%s</span>", v39, 5);
          strcpy(&v107, "");
        }
        else
        {
          v37 = get_ux_text_common(1104, v36);
          snprintf((char *)&v108, 0x100u, "<span id=fakedns_status>%s</span>", v37, 5);
          snprintf(
            &v107,
            0x200u,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap;  text-overflow:ellipsis;\">%s</span>",
            "fakedns",
            "");
        }
        v40 = get_ux_text_common(1160, v38);
        v41 = sub_1E3AC((int)"fakedns", v40, (int)&v108);
        if ( get_nologin(v41) )
        {
          v45 = get_ux_text_common(148, v42);
          snprintf((char *)&v108, 0x100u, "<span id=nologin_status>%s</span>", v45, 6);
          strcpy(&v107, "");
        }
        else
        {
          v43 = get_ux_text_common(1099, v42);
          snprintf((char *)&v108, 0x100u, "<span id=nologin_status>%s</span>", v43, 6);
          snprintf(
            &v107,
            0x200u,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap; text-overflow:ellipsis;\">%s</span>",
            "nologin",
            "");
        }
        v46 = get_ux_text_common(1168, v44);
        v47 = sub_1E3AC((int)"nologin", v46, (int)&v108);
        if ( get_wbm_popup_flag(v47) <= 0 )
        {
          v51 = get_ux_text_common(1162, v48);
          snprintf((char *)&v108, 0x100u, "<span id=wbm_popup_status>%s</span>", v51, 7);
          strcpy(&v107, "");
        }
        else
        {
          v49 = get_ux_text_common(1164, v48);
          snprintf((char *)&v108, 0x100u, "<span id=wbm_popup_status>%s</span>", v49, 7);
          snprintf(
            &v107,
            0x200u,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap;  text-overflow:ellipsis;\">%s</span>",
            "wbmpopup",
            "");
        }
        v52 = get_ux_text_common(1163, v50);
        sub_1E3AC((int)"wbmpopup", v52, (int)&v108);
        v53 = get_led_silent_control(&v111);
        if ( get_led_silent_state(v53) )
          v55 = 542;
        else
          v55 = 541;
        v56 = get_ux_text_common(v55, v54);
        snprintf((char *)&v108, 0x100u, "<span id=led_status>%s</span>", v56, 8);
        strcpy(&v107, "");
        v58 = get_ux_text_common(539, v57);
        v59 = sub_1E3AC((int)"led", v58, (int)&v108);
        if ( get_upnp(v59) <= 0 )
        {
          v63 = get_ux_text_common(1111, v60);
          snprintf((char *)&v108, 0x100u, "<span id=upnp_status>%s</span>", v63, 9);
          strcpy(&v107, "");
        }
        else
        {
          v61 = get_ux_text_common(1104, v60);
          snprintf((char *)&v108, 0x100u, "<span id=upnp_status>%s</span>", v61, 9);
          snprintf(
            &v107,
            0x200u,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap; text-overflow:ellipsis;\">%s</span>",
            "upnp",
            "");
        }
        v64 = get_ux_text_common(1223, v62);
        sub_1E3AC((int)"upnp", v64, (int)&v108);
        if ( get_ispfake(&v106) <= 0 )
        {
          v67 = get_ux_text_common(1111, v65);
          snprintf((char *)&v108, 0x100u, "<span id=ispfake_status>%s</span>", v67, 10);
          strcpy(&v107, "");
        }
        else
        {
          v66 = get_ux_text_common(1104, v65);
          snprintf((char *)&v108, 0x100u, "<span id=ispfake_status>%s - %s</span>", v66, &v106);
          snprintf(
            &v107,
            0x200u,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap;  text-overflow:ellipsis;\">%s</span>",
            "ispfake",
            "");
        }
        v68 = sub_1E3AC((int)"ispfake", (int)"HTTP URL Tag", (int)&v108);
        if ( get_apcplan_flag(v68) <= 0 )
        {
          v72 = get_ux_text_common(1111, v69);
          snprintf((char *)&v108, 0x100u, "<span id=apcpd_status>%s</span>", v72, 11);
          strcpy(&v107, "");
        }
        else
        {
          v70 = get_ux_text_common(1104, v69);
          snprintf((char *)&v108, 0x100u, "<span id=apcpd_status>%s</span>", v70, 11);
          snprintf(
            &v107,
            0x200u,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap;  text-overflow:ellipsis;\">%s</span>",
            "apcpd",
            "");
        }
        v73 = get_ux_text_common(1128, v71);
        sub_1E3AC((int)"apcplan", v73, (int)&v108);
        get_autoreboot_config(&v112);
        memset(&v106, 0, 0x44u);
        read_sched_array(&unk_7EB54, &v106, 1);
        if ( v112 )
        {
          v75 = get_ux_text_common(1104, v74);
          snprintf((char *)&v108, 0x100u, "<span id=autoreboot_status>%s</span>", v75, 12);
          snprintf(
            &v107,
            0x200u,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap; text-overflow:ellipsis;\">%s</span>",
            &unk_7EB54,
            "");
        }
        else
        {
          v77 = get_ux_text_common(1111, v74);
          snprintf((char *)&v108, 0x100u, "<span id=autoreboot_status>%s</span>", v77, 12);
          strcpy(&v107, "");
        }
        v78 = get_ux_text_common(59, v76);
        sub_1E3AC((int)&unk_7EB54, v78, (int)&v108);
        snprintf((char *)&v108, 0x100u, "<span id=restart_status></span>");
        snprintf(
          &v107,
          0x200u,
          "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap; text-overflow:ellipsis;\">%s</span>",
          "restart",
          "");
        v80 = get_ux_text_common(1132, v79);
        v81 = sub_1E3AC((int)"restart", v80, (int)&v108);
        if ( get_usb_mode(v81) == 2 )
        {
          v83 = get_ux_text_common(1370, v82);
          snprintf((char *)&v108, 0x100u, "<span id=usb_mode_status>%s</span>", v83, 14);
          snprintf(
            &v107,
            0x200u,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap; text-overflow:ellipsis;\">%s</span>",
            "usb_mode",
            "");
        }
        else
        {
          v85 = get_ux_text_common(1371, v82);
          snprintf((char *)&v108, 0x100u, "<span id=usb_mode_status>%s</span>", v85, 14);
          strcpy(&v107, "");
        }
        v86 = get_ux_text_common(1383, v84);
        v87 = sub_1E3AC((int)"usb_mode", v86, (int)&v108);
        if ( get_macclone_in_giga(v87) )
          v89 = 1111;
        else
          v89 = 1104;
        v90 = get_ux_text_common(v89, v88);
        snprintf((char *)&v108, 0x100u, "<span id=macclone_giga_status>%s</span>", v90, 15);
        strcpy(&v107, "");
        v92 = get_ux_text_common(1172, v91);
        v93 = sub_1E3AC((int)"macclone_giga", v92, (int)&v108);
        if ( get_use_local_gateway(v93) )
          v95 = 1224;
        else
          v95 = 1170;
        v96 = get_ux_text_common(v95, v94);
        snprintf((char *)&v108, 0x100u, "<span id=hubapmode_status>%s</span>", v96, 16);
        strcpy(&v107, "");
        v98 = get_ux_text_common(1139, v97);
        sub_1E3AC((int)"hubapmode", v98, (int)&v108);
        puts("<input type=hidden name=gw1 value=>");
        puts("<input type=hidden name=gw2 value=>");
        puts("<input type=hidden name=gw3 value=>");
        puts("<input type=hidden name=gw4 value=>");
        puts("<input type=hidden name=fdns1 value=>");
        puts("<input type=hidden name=fdns2 value=>");
        puts("<input type=hidden name=fdns3 value=>");
        puts("<input type=hidden name=fdns4 value=>");
        puts("<input type=hidden name=sdns1 value=>");
        puts("<input type=hidden name=sdns2 value=>");
        puts("<input type=hidden name=sdns3 value=>");
        puts("<input type=hidden name=sdns4 value=>");
        puts("<input type=hidden name=use_local_gateway value=>");
        strcpy((char *)&v108, "");
        strcpy(&v107, "");
        get_wan_hw_ifname("wan1", &v111);
        if ( get_dhcp_auto_restart(&v111) )
          v100 = 1104;
        else
          v100 = 1111;
        v101 = get_ux_text_common(v100, v99);
        snprintf((char *)&v108, 0x100u, "<span id=dhcp_restart_status>%s</span>", v101, 17);
        v103 = get_ux_text_common(1135, v102);
        sub_1E3AC((int)"dhcp_restart", v103, (int)&v108);
        printf("</table>");
        printf("</form>");
        printf("</BODY>");
        printf("<script>");
        printf("setTimeout(function() { clickSysconf(document.getElementById('%s')); }, 50);", &v110);
        if ( v4 == 2 )
        {
          printf("setTimeout(function() {");
          v104 = printf("UnMaskIt(parent.document, 'apply_mask');");
          v105 = hwinfo_get_reboot_duration(v104);
          printf("maskRebootMsg(%d, null, parent.document);", v105);
          printf("}, 500);");
        }
        else
        {
          puts("setTimeout(function() {UnMaskIt(parent.document,'apply_mask'); }, 500);");
        }
        v5 = "</script>";
        return printf(v5);
      }
    }
    else
    {
      result = get_value_post(v2, "service", &v109, 64);
      if ( !result )
        return result;
      v8 = &v109;
      v9 = &v110;
    }
    sf_strncpy(v9, v8, 64);
    goto LABEL_10;
  }
  printf("<BODY style=\"padding:0px 0px; margin:0px 0px;\">");
  printf("<script>top.location.reload();</script>");
  v5 = "</body>";
  return printf(v5);
}
// 103D0: using guessed type int __fastcall get_fakedns(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10664: using guessed type int __fastcall get_wbm_popup_flag(_DWORD);
// 10934: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// 10AE4: using guessed type int __fastcall read_sched_array(_DWORD, _DWORD, _DWORD);
// 10E5C: using guessed type int __fastcall get_system_lang(_DWORD);
// 10F94: using guessed type int __fastcall get_autosaving(_DWORD);
// 10FD0: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// 11024: using guessed type int __fastcall get_led_silent_control(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 111EC: using guessed type int __fastcall get_apcplan_flag(_DWORD);
// 11204: using guessed type int __fastcall get_autoreboot_config(_DWORD);
// 1157C: using guessed type int __fastcall get_router_mgmt_port(_DWORD);
// 1172C: using guessed type int __fastcall get_usb_mode(_DWORD);
// 117A4: using guessed type int __fastcall get_macclone_in_giga(_DWORD);
// 11870: using guessed type int __fastcall get_dhcp_auto_restart(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 1193C: using guessed type int __fastcall get_upnp(_DWORD);
// 11AA4: using guessed type int __fastcall get_use_local_gateway(_DWORD);
// 11B7C: using guessed type int __fastcall get_ispfake(_DWORD);
// 11D20: using guessed type int __fastcall get_led_silent_state(_DWORD);
// 11FB4: using guessed type int __fastcall get_hostname(_DWORD);

//----- (000226E0) --------------------------------------------------------
int __fastcall print_sysconf_misc(int a1)
{
  int v1; // r4@1
  int v2; // r0@1
  char *v3; // r5@1
  int v4; // r3@1
  int v5; // r1@4
  int v6; // r0@4
  int v7; // r1@4
  int v8; // r0@4
  int v9; // r1@4
  int v10; // r0@4
  int v11; // r1@4
  int v12; // r0@4
  int v13; // r1@4
  int v14; // r0@4
  int v15; // r1@4
  int v16; // r0@4
  int v17; // r1@4
  int v18; // r0@4
  int v19; // r1@4
  int v20; // r0@4
  int v21; // r1@4
  int v22; // r0@4
  int v23; // r1@4
  int v24; // r0@4
  int v25; // r1@4
  int v26; // r0@4
  int v27; // r1@4
  int v28; // r0@4
  int v29; // r1@4
  int v30; // r0@4
  int v31; // r1@4
  int v32; // r0@4
  int v33; // r1@4
  int v34; // r0@4
  int v35; // r1@4
  int v36; // r0@4
  int v37; // r1@4
  int v38; // r0@4
  int v39; // r1@4
  int v40; // r0@4
  int v41; // r1@4
  int v42; // r0@4
  int v43; // r4@4
  int v44; // r0@4
  int v46; // [sp+0h] [bp-310h]@1
  char dest; // [sp+200h] [bp-110h]@1

  v1 = a1;
  strcpy(&dest, "");
  printf("<form method=\"post\" action=\"timepro.cgi\" name=\"sysconf_fm\"> ");
  puts("<table style=\"border-collapse:collapse; border-style:none solid solid solid; border-width:0px 1px 1px 1px; border-color:#eeeeee;width:642 \" cellspacing=0px cellpadding=0px>");
  printf("<input type=hidden name=tmenu value=sysconf>");
  printf("<input type=hidden name=\"smenu\" value=\"misc\">");
  v2 = printf("<input type=hidden name=\"act\"id=act  value=\"\">");
  str(v2);
  printf("<td width=100%% height=%d colspan=2 style='border-bottom: 1px solid #CCC;'>", 260);
  v3 = (char *)&v46 + snprintf((char *)&v46, 0x80u, (const char *)&unk_814D3);
  v4 = get_parameter_value(v1, "act");
  if ( v4 || (v4 = get_parameter_value(v1, "service")) != 0 )
    snprintf(v3, 0x80u, "&service=%s", v4);
  printf(
    "<iframe name=\"sysconf_misc_iframe\" src=\"%s\" frameborder=no width=100%% height=340 align=left scrolling=yes></iframe>",
    &v46);
  printf("</td></tr>");
  puts("<tr height=165 style=\"background-Color:#eeeeee\"><td valign=top colspan=2>");
  v6 = get_ux_text_common(1161, v5);
  print_sysconf_misc_body("multilang", v6, 0);
  v8 = get_ux_text_common(1138, v7);
  print_sysconf_misc_body("hostname", v8, 0);
  v10 = get_ux_text_common(763, v9);
  print_sysconf_misc_body("configmgmt", v10, 0);
  v12 = get_ux_text_common(1159, v11);
  print_sysconf_misc_body("autosaving", v12, 0);
  v14 = get_ux_text_common(1067, v13);
  print_sysconf_misc_body("mgmt_port", v14, 0);
  v16 = get_ux_text_common(1160, v15);
  print_sysconf_misc_body("fakedns", v16, 0);
  v18 = get_ux_text_common(1168, v17);
  print_sysconf_misc_body("nologin", v18, 0);
  v20 = get_ux_text_common(1163, v19);
  print_sysconf_misc_body("wbmpopup", v20, 0);
  v22 = get_ux_text_common(539, v21);
  print_sysconf_misc_body("led", v22, 0);
  print_sysconf_misc_body("ispfake", (int)"HTTP URL Tag", 0);
  v24 = get_ux_text_common(59, v23);
  print_sysconf_misc_body((const char *)&unk_7EB54, v24, 0);
  v26 = get_ux_text_common(1383, v25);
  print_sysconf_misc_body("usb_mode", v26, 0);
  v28 = get_ux_text_common(1132, v27);
  print_sysconf_misc_body("restart", v28, 0);
  v30 = get_ux_text_common(1128, v29);
  print_sysconf_misc_body("apcplan", v30, 0);
  v32 = get_ux_text_common(1172, v31);
  print_sysconf_misc_body("macclone_giga", v32, 0);
  v34 = get_ux_text_common(1223, v33);
  print_sysconf_misc_body("upnp", v34, 0);
  v36 = get_ux_text_common(1139, v35);
  print_sysconf_misc_body("hubapmode", v36, 0);
  v38 = get_ux_text_common(766, v37);
  print_sysconf_misc_body("realtime", v38, 0);
  v40 = get_ux_text_common(1135, v39);
  print_sysconf_misc_body("dhcp_restart", v40, 0);
  printf("</td></tr>");
  printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=2></td></tr>");
  printf("<tr align=right valign=middle height=28 style=\"background-Color:#eeeeee\"><td align=right width=595>");
  printf("</td><td align=right>");
  v42 = get_ux_text_common(35, v41);
  v43 = v42;
  v44 = hwinfo_get_reboot_duration(v42);
  printf("<input type=button id=apply_bt name=params_bt value=\"%s\" onclick=\"ApplySysconfig(%d);\">", v43, v44);
  printf("</td></tr>");
  printf("</table>");
  return printf("</form>");
}
// 10934: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);

//----- (00022A58) --------------------------------------------------------
int __fastcall sysconf_misc(int a1, int a2)
{
  int v2; // r6@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  void *v7; // r0@1
  int v8; // r1@1
  int v9; // r5@1
  int v10; // r1@1
  int v11; // r0@1
  int v12; // r1@1
  int v13; // r0@1

  v2 = a1;
  maekGMTData(a1, a2);
  print_js_file((int)"sysconf", (int)"misc");
  printf("<style>");
  printf("form { margin: 0; }");
  printf("input[type='text'] { border: 1px solid #CCC; }");
  printf("input[type='radio'], input[type='checkbox'] { vertical-align: sub; }");
  printf("</style>");
  print_sysconf_misc(v2);
  v4 = get_ux_text_common(34, v3);
  sub_1E40C("apply_mask", v4);
  v6 = get_ux_text_common(1165, v5);
  sub_1E40C("reboot_mask", v6);
  printf("<style>");
  printf("#%s p { margin: 5px 0 5px 10px; text-align: left; }", &unk_8178D);
  printf("</style>");
  printf("<DIV id=\"%s\" style=\"display:none;\">", &unk_8178D);
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:200px; top:198px; width:240px; height:75px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"240\" height=\"70\">");
  printf("<tr><td width=\"35px\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v7 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v7);
  printf("</SPAN></td>");
  printf("<td height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\">\n");
  printf("<p id=configmgmt_success style='line-height: 21px; height: 40px;'>");
  v9 = get_ux_text_common(1066, v8);
  v11 = get_ux_text_common(1057, v10);
  printf("%s<br>%s</p>", v9, v11);
  v13 = get_ux_text_common(1065, v12);
  printf("<p id=configmgmt_fail>%s</p>", v13);
  printf("<p id='configmgmt_reboot_seconds'></p>");
  printf("</SPAN></td>");
  return printf((const char *)&unk_7D215);
}

//----- (00022C14) --------------------------------------------------------
int __fastcall print_iframe_sysconf_swupgrade_online_status(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r0@1
  int v4; // r5@6
  int v5; // r4@7
  int result; // r0@7
  signed int v7; // r0@8
  int v8; // r7@12
  int v9; // r0@12
  int v10; // r0@12
  int v11; // r5@12
  int v12; // r0@13
  int v13; // r6@15
  int v14; // r1@17
  char *v15; // r4@17
  void *v16; // r0@18
  char *v17; // r4@18
  int v18; // r1@18
  int v19; // r0@18
  int v20; // r8@18
  char *v21; // r4@18
  int v22; // r8@22
  void *v23; // r0@22
  char *v24; // r4@22
  int v25; // r1@22
  int v26; // r0@22
  char *v27; // r4@22
  void *v28; // r0@26
  char *v29; // r4@26
  int v30; // r1@26
  int v31; // r8@26
  int v32; // r10@26
  int v33; // r0@26
  int v34; // r0@26
  int v35; // r3@26
  int v36; // r8@26
  char *v37; // r4@26
  int v38; // r8@30
  void *v39; // r0@30
  char *v40; // r4@30
  int v41; // r1@30
  int v42; // r0@30
  char *v43; // r4@30
  void *v44; // r0@34
  char *v45; // r4@34
  int v46; // r1@34
  int v47; // r0@34
  char *v48; // r4@34
  char *v49; // r4@34
  int v50; // r8@34
  int v51; // r1@34
  int v52; // r6@34
  int v53; // r1@34
  int v54; // r0@34
  signed int v55; // r0@34
  int v56; // r0@37
  int v57; // r0@39
  int v58; // r1@45
  int v59; // r0@46
  int v60; // r8@46
  int v61; // r1@47
  int v62; // r0@48
  int v63; // r6@49
  int v64; // r0@49
  void *v65; // r0@51
  int v66; // r6@51
  int v67; // r1@51
  const char *v68; // r0@51
  int v69; // r8@52
  int v70; // r1@53
  const char *v71; // r0@54
  char *v72; // r4@54
  int v73; // r6@54
  int v74; // r1@54
  const char *v75; // r0@54
  const char *v76; // r0@55
  int v77; // r6@56
  int v78; // r1@56
  const char *v79; // r0@56
  int v80; // r1@57
  const char *v81; // r0@57
  char dest[512]; // [sp+8h] [bp-500h]@17
  char v83; // [sp+208h] [bp-300h]@49
  char s; // [sp+3C8h] [bp-140h]@49
  int v85; // [sp+448h] [bp-C0h]@13
  int v86; // [sp+468h] [bp-A0h]@34
  int v87; // [sp+488h] [bp-80h]@34
  int v88; // [sp+4A8h] [bp-60h]@44
  int v89; // [sp+4C8h] [bp-40h]@1

  v2 = a2;
  print_js_file((int)"sysconf", (int)"swupgrade");
  v3 = get_value_post(v2, "act", &v89, 32);
  if ( !v3 )
    goto LABEL_12;
  if ( !strcmp((const char *)&v89, "update") )
  {
    set_firmup_status(1);
    v3 = signal_start("firmupui");
LABEL_12:
    v8 = hwinfo_get_firmup_duration(v3);
    printf("<html>");
    printf("<form method=post name=firmup_fm action=timepro.cgi>");
    printf("<input type=hidden name=tmenu value=iframe>");
    printf("<input type=hidden name=smenu value=sysconf_swupgrade_online_status>");
    printf("<input type=hidden name=act>");
    printf("</form>");
    v9 = puts("<script>");
    v10 = get_firmup_status(v9);
    v11 = v10;
    if ( v10 )
    {
      snprintf((char *)&v85, 0x20u, "firmup_counter_%d", v10);
      v12 = istatus_get_intvalue_direct((int)&v85);
      if ( v12 == -1 )
        v12 = 0;
      v13 = v12 + 1;
      if ( v12 + 1 > 64 )
        v13 = 0;
      snprintf((char *)&v85, 0x20u, "firmup_counter_%d", v11);
      istatus_set_intvalue_direct(&v85, v13);
      v15 = dest;
      switch ( v11 )
      {
        case 1:
          v16 = get_image_dir();
          v17 = &dest[snprintf(dest, 0x200u, "<img width=10 height=10 src=\"/%s/apply_ani.gif\">", v16)];
          v19 = get_ux_text_common(362, v18);
          v20 = 0;
          v21 = &v17[snprintf(v17, 0x200u, " %s", v19)];
          while ( v20 < v13 )
          {
            ++v20;
            v21 += snprintf(v21, 0x200u, ".");
          }
          puts("DisableRadio( parent.document.view_fm.firmup);");
          puts("DisableObj( parent.document.getElementById('onlineupdate_bt'));");
          puts("parent.document.getElementById('onlineupdate_bt').style.color = 'gray';");
          puts("ShowObj( parent.document.getElementById('cancel_bt'));");
          goto LABEL_52;
        case 2:
          v22 = 0;
          puts("DisableRadio( parent.document.view_fm.firmup);");
          v23 = get_image_dir();
          v24 = &dest[snprintf(dest, 0x200u, "<img width=10 height=10 src=\"/%s/apply_ani.gif\">", v23)];
          v26 = get_ux_text_common(358, v25);
          v27 = &v24[snprintf(v24, 0x200u, " %s", v26)];
          while ( v22 < v13 )
          {
            ++v22;
            v27 += snprintf(v27, 0x200u, ".");
          }
          goto LABEL_52;
        case 3:
          puts("DisableRadio( parent.document.view_fm.firmup);");
          puts("ShowObj( parent.document.getElementById('cancel_bt'));");
          v28 = get_image_dir();
          v29 = &dest[snprintf(dest, 0x200u, "<img width=10 height=10 src=\"/%s/apply_ani.gif\">", v28)];
          v31 = get_ux_text_common(359, v30);
          v32 = hwinfo_get_max_firmware_size();
          v33 = get_filesize("/tmp/firmware");
          v34 = calc_mask(100 * v33, v32);
          v35 = v31;
          v36 = 0;
          v37 = &v29[snprintf(v29, 0x200u, " %s (%d %%) ", v35, v34)];
          while ( v36 < v13 )
          {
            ++v36;
            v37 += snprintf(v37, 0x200u, ".");
          }
          goto LABEL_52;
        case 4:
          v38 = 0;
          puts("DisableRadio( parent.document.view_fm.firmup);");
          puts("HideObj( parent.document.getElementById('cancel_bt'));");
          v39 = get_image_dir();
          v40 = &dest[snprintf(dest, 0x200u, "<img width=10 height=10 src=\"/%s/apply_ani.gif\">", v39)];
          v42 = get_ux_text_common(356, v41);
          v43 = &v40[snprintf(v40, 0x200u, " %s", v42)];
          while ( v38 < v13 )
          {
            ++v38;
            v43 += snprintf(v43, 0x200u, ".");
          }
          goto LABEL_52;
        case 5:
          puts("DisableRadio( parent.document.view_fm.firmup);");
          puts("HideObj( parent.document.getElementById('cancel_bt'));");
          get_ifconfig((int)"br0", (int)&v87, (int)&v86);
          v44 = get_image_dir();
          v45 = &dest[snprintf(dest, 0x200u, "<img width=10 height=10 src=\"/%s/apply_ani.gif\">", v44)];
          v47 = get_ux_text_common(364, v46);
          v48 = &v45[snprintf(v45, 0x200u, " %s", v47)];
          v49 = &v48[snprintf(v48, 0x200u, "<span id=firmup_dot></span><br>")];
          v50 = snprintf(v49, 0x200u, "&nbsp;&nbsp;&nbsp;&nbsp;");
          v52 = get_ux_text_common(1061, v51);
          v54 = get_ux_text_common(1084, v53);
          snprintf(&v49[v50], 0x200u, "(%s <span id=firmup_duration>%d</span>%s)", v52, v8, v54);
          v55 = 100;
          goto LABEL_40;
        case 6:
          strcpy(dest, "");
          goto LABEL_59;
        default:
          goto LABEL_59;
        case 10:
        case 14:
          v15 = dest;
          puts("EnableRadio( parent.document.view_fm.firmup);");
          puts("EnableObj( parent.document.getElementById('onlineupdate_bt'));");
          puts("parent.document.getElementById('onlineupdate_bt').style.color = '';");
          puts("HideObj( parent.document.getElementById('cancel_bt'));");
          if ( v11 == 14 )
            v56 = 360;
          else
            v56 = 361;
          break;
        case 11:
          v56 = 355;
          break;
        case 12:
          v56 = 357;
          break;
        case 13:
          v56 = 363;
          break;
      }
      v57 = get_ux_text_common(v56, v14);
      snprintf(v15, 0x200u, " %s", v57);
      v55 = 0;
LABEL_40:
      set_firmup_status(v55);
LABEL_59:
      v69 = 0;
    }
    else if ( get_wan_ip("wan1", &v88) || get_default_gateway("br0", &v88) )
    {
      v63 = get_firmupcheck_status();
      get_si("pi", &v83);
      v64 = snprintf(&s, 0x80u, &v83);
      switch ( v63 )
      {
        case 0:
          signal_start("firmupcheck");
          goto LABEL_51;
        case 1:
LABEL_51:
          v65 = get_image_dir();
          v66 = snprintf(dest, 0x200u, "<img width=10 height=10 src=\"/%s/apply_ani.gif\"> ", v65);
          v68 = (const char *)get_ux_text_common(354, v67);
          snprintf(&dest[v66], 0x200u, v68, &s);
LABEL_52:
          v69 = 1;
          break;
        default:
          goto LABEL_59;
        case 3:
          set_firmupcheck_status(0);
          v69 = get_firmupcheck_version(&v85);
          if ( v69 )
          {
            v71 = (const char *)get_ux_text_common(374, v70);
            v72 = &dest[snprintf(dest, 0x200u, v71, &v85)];
            v73 = snprintf(v72, 0x200u, "<br>");
            v75 = (const char *)get_ux_text_common(375, v74);
            snprintf(&v72[v73], 0x200u, v75);
            puts("EnableObj( parent.document.getElementById('onlineupdate_bt'));");
            puts("parent.document.getElementById('onlineupdate_bt').style.color = '';");
            puts("HideObj( parent.document.getElementById('cancel_bt'));");
            goto LABEL_59;
          }
          v76 = (const char *)get_ux_text_common(352, v70);
          snprintf(dest, 0x200u, v76);
          break;
        case 4:
          v77 = get_firmware_version2(v64);
          set_firmupcheck_status(0);
          v79 = (const char *)get_ux_text_common(353, v78);
          snprintf(dest, 0x200u, v79, v77);
          goto LABEL_59;
        case 5:
          set_firmupcheck_status(0);
          v81 = (const char *)get_ux_text_common(352, v80);
          snprintf(dest, 0x200u, v81);
          goto LABEL_59;
      }
    }
    else
    {
      v59 = get_ux_text_common(65, v58);
      v60 = snprintf(dest, 0x200u, "%s<br>", v59);
      if ( !get_wan_link("wan1") && !get_default_gateway("br0", &v88) )
      {
        v62 = get_ux_text_common(66, v61);
        snprintf(&dest[v60], 0x200u, "<br>%s", v62);
      }
      v69 = v11;
    }
    printf("if(parent.document.getElementById('firmware_status'))");
    printf("parent.document.getElementById('firmware_status').innerHTML = '%s';\n", dest);
    if ( v11 == 5 )
    {
      printf("parent.PrintRemainTime('firmup_duration',%d);\n", v8);
      puts("PrintDot('firmup_dot',64,64);");
    }
    if ( v69 == 1 )
      printf("setTimeout(function() { location.href = 'timepro.cgi?tmenu=iframe&smenu=sysconf_swupgrade_online_status'; }, 3000);");
    puts("</script>");
    return printf("</html>");
  }
  if ( !strcmp((const char *)&v89, "cancel") )
  {
    v3 = system("/usr/bin/killall wget");
    goto LABEL_12;
  }
  v3 = strcmp((const char *)&v89, "status");
  v4 = v3;
  if ( v3 )
    goto LABEL_12;
  v5 = get_firmup_status(0);
  result = printf("Status:%d", v5);
  if ( v5 == 5 )
  {
    v7 = 100;
  }
  else
  {
    if ( v5 <= 9 )
      return result;
    v7 = v4;
  }
  return set_firmup_status(v7);
}
// 104B4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// 10514: using guessed type int __fastcall istatus_set_intvalue_direct(_DWORD, _DWORD);
// 10A00: using guessed type int __fastcall get_firmware_version2(_DWORD);
// 10B38: using guessed type int __fastcall get_default_gateway(_DWORD, _DWORD);
// 10C1C: using guessed type int __fastcall get_firmup_status(_DWORD);
// 10C64: using guessed type int __fastcall signal_start(_DWORD);
// 10CD0: using guessed type int hwinfo_get_max_firmware_size(void);
// 10D30: using guessed type int __fastcall set_firmupcheck_status(_DWORD);
// 10E8C: using guessed type int __fastcall get_wan_link(_DWORD);
// 11084: using guessed type int __fastcall get_filesize(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 111A4: using guessed type int __fastcall hwinfo_get_firmup_duration(_DWORD);
// 112B8: using guessed type int get_firmupcheck_status(void);
// 119B4: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);
// 119D8: using guessed type int __fastcall set_firmup_status(_DWORD);
// 11FE4: using guessed type int __fastcall get_firmupcheck_version(_DWORD);
// 22C14: using guessed type char dest[512];

//----- (0002347C) --------------------------------------------------------
int print_iframe_sysconf_swupgrade_manual_status()
{
  int v0; // r4@1
  int v1; // r1@1
  int v2; // r0@1

  v0 = hwinfo_get_max_firmware_size();
  puts("<style type=\"text/css\">");
  printf("body { margin: 0; background-color: #EEE; }");
  puts("</style>");
  printf("<body>");
  print_js_file((int)"sysconf", (int)"swupgrade");
  puts("<form method=post action=upgrade.cgi enctype=\"multipart/form-data\" name=image_upload style='margin: 5px 0 0 0; height: 22px; padding: 5px; border-width: 1px 0; border-color: #DDD; border-style: solid;'>");
  printf(
    "<input type=file name=upgrade size=30 maxlength=120 style='width: 430px; font-size: 12px; height: 22px; float:left;'"
    " onchange='onChangeForm(this, %d);'>",
    v0);
  puts("<input type=hidden name=act>");
  v2 = get_ux_text_common(1190, v1);
  printf(
    "<input type=button name=upload_submit value=\"%s\" style='float: right; font-size: 12px; height: 22px;' onclick='fir"
    "mwareSubmit();'>\n",
    v2);
  puts("</form>");
  printf("<script>");
  printf("onChangeForm(document.getElementsByName('upgrade')[0], %d);", v0);
  return printf("</script>");
}
// 10CD0: using guessed type int hwinfo_get_max_firmware_size(void);

//----- (00023544) --------------------------------------------------------
int __fastcall sysconf_swupgrade(int a1)
{
  int v1; // r5@1
  signed int v2; // r4@2
  int v3; // r0@4
  int v4; // r1@6
  const char *v5; // r0@6
  int v6; // r0@6
  int v7; // r1@7
  int v8; // r0@7
  int v9; // r0@7
  const char *v10; // r5@7
  int v11; // r1@7
  int v12; // r0@7
  int v13; // r0@7
  char *v14; // r1@8
  int v15; // r1@10
  int v16; // r0@10
  int v17; // r1@10
  char *v18; // r4@11
  int v19; // r0@13
  int v20; // r0@13
  int v21; // r1@13
  int v22; // r0@13
  int v23; // r1@13
  int v24; // r0@13
  void *v25; // r4@13
  int v26; // r1@13
  int v27; // r0@13
  int v28; // r1@13
  int v29; // r0@13
  int v30; // r1@13
  const char *v31; // r0@13
  int v32; // r0@13
  int v33; // r1@13
  int v34; // r0@13
  int v35; // r1@13
  int v36; // r1@14
  const char *v37; // r0@14
  int v38; // r1@14
  int v39; // r0@16
  int v40; // r0@17
  int v41; // r1@17
  int v42; // r0@17
  int v43; // r1@17
  int v44; // r0@17
  int v45; // r1@17
  int v46; // r0@17
  int v47; // r1@17
  int v48; // r0@17
  void *v49; // r4@17
  int v50; // r1@17
  int v51; // r0@17
  int v52; // r1@17
  int v53; // r0@17
  int v54; // r1@17
  const char *v55; // r0@17
  int v56; // r0@17
  int v58; // [sp+4h] [bp-4B4h]@13
  int v59; // [sp+84h] [bp-434h]@13
  char v60; // [sp+104h] [bp-3B4h]@13
  char v61; // [sp+1C4h] [bp-2F4h]@13
  char dest; // [sp+2C4h] [bp-1F4h]@4
  char v63; // [sp+3C4h] [bp-F4h]@13
  int v64; // [sp+444h] [bp-74h]@7
  int v65; // [sp+484h] [bp-34h]@1
  int v66; // [sp+4A4h] [bp-14h]@1

  v1 = a1;
  v66 = 0;
  if ( get_wan_ip("wan1", &v65) )
    v2 = 1;
  else
    v2 = get_default_gateway("br0", &v65) != 0;
  strcpy(&dest, "http://download.iptime.co.kr/online_upgrade/ipTIME_Firmware_Wizard(11ac).exe");
  print_js_file((int)"sysconf", (int)"swupgrade");
  puts("<table cellpadding=0px cellspacing=0px style='background-Color: #EEE; width: 641px;'>");
  puts("<tr><td>");
  puts("<table cellspacing=0px cellpadding=0px style='width: 640px; border-bottom: 1px solid #DDD;'>");
  v3 = get_intvalue(v1, "upgradedone", &v66);
  if ( v3 && v66 )
  {
    str(v3);
    printf("<td colspan=2>");
    v5 = (const char *)get_ux_text_common(1201, v4);
    printf(v5);
    v6 = puts("</td>");
    etr(v6);
  }
  printf("<tr style='background-color: #FFF; height: 24px;'>");
  v8 = get_ux_text_common(1194, v7);
  v9 = printf("<td style='width:190px; padding-left: 5px;'>%s</td>", v8);
  v10 = (const char *)get_firmware_version2(v9);
  printf("<td>");
  printf(v10);
  printf("</td>");
  printf("</tr>");
  printf("<tr style='background-color: #F7F7F7; height: 24px;'>");
  v12 = get_ux_text_common(1188, v11);
  printf("<td style='padding-left: 5px;'>%s</td>", v12);
  get_firmware_builddate((int)&v64, 64);
  printf("<td>%s</td>", &v64);
  printf("</tr>");
  printf("<tr style='background-color: #FFF; height: 24px;'>");
  printf("<td colspan=2></td>");
  printf("</tr>");
  puts("</table></td></tr>");
  puts("<tr><td>");
  v13 = puts("<table cellspacing=0px cellpadding=0px>");
  str(v13);
  printf("<td style=\"height:20px; padding-top: 0px; padding-bottom: 2px; padding-left: 5px; padding-right: 10px;\">");
  puts("<form method=post action=timepro.cgi name=view_fm style='margin:0; padding: 5px 0;'>");
  if ( v2 )
    v14 = "checked";
  else
    v14 = "";
  printf(
    "<input type=radio id=firmup_online name=firmup value=online style='vertical-align: bottom;' onclick=\"FirmUpView();\" %s>",
    v14);
  v16 = get_ux_text_common(1193, v15);
  printf("<label for=firmup_online style='margin-right: 35px;'> %s</label>", v16);
  if ( v2 )
    v18 = "";
  else
    v18 = "checked";
  v19 = get_ux_text_common(1192, v17);
  printf(
    "<input type=radio id=firmup_manual name=firmup value=manual style='vertical-align: bottom;' onclick=\"FirmUpView();\""
    " %s><label for=firmup_manual> %s</label>",
    v18,
    v19);
  printf("</td>");
  printf("<input type=hidden name=status_code>");
  v20 = printf("</form>");
  etr(v20);
  printf("<tr id=online>");
  puts("<td align=left>");
  printf("<table style='width: 640px;'>");
  printf("<tr height=40 valign=top><td>");
  printf("<table cellpadding=0px cellspacing=0px style='background-color: #FFF; width: 620px; margin: 0 5px; min-height:52px;'><tr><td style='padding: 10px; height: 52px;'>");
  printf("<span ID=firmware_status style='color:gray;'></span>");
  printf("</td></tr></table>");
  printf("</td></tr>");
  printf("<tr height=40 valign=top><td align=right>");
  puts("<form method=post action=timepro.cgi name=firmup2_fm style='margin: 5px 0 0 0; border-width: 1px 0; border-color: #DDD; border-style: solid; padding: 5px;'>");
  v22 = get_ux_text_common(351, v21);
  printf(
    "<input type=button name=autoup id=cancel_bt style=\"display:none;\" value=\"%s\" onclick=\"CancelFirmUp();\">\n",
    v22);
  v24 = get_ux_text_common(350, v23);
  printf(
    "<input type=button name=autoup id=onlineupdate_bt value=\"%s\" style='color:gray;' onclick=\"StartFirmUp();\" disabled>\n",
    v24);
  puts("</form>");
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<table cellpadding=0px cellspacing=0px style='margin-left: 5px;'>");
  v25 = get_image_dir();
  v27 = get_ux_text_common(1202, v26);
  printf(
    "<tr style='height: 24px;'><td><img src='/%s/warning.gif' style='margin: 0 3px 1px 3px; vertical-align: middle;'><b s"
    "tyle='color: gray;'>%s</b></td></tr>",
    v25,
    v27);
  v29 = get_ux_text_common(348, v28);
  printf("<tr style='height: 18px;'><td><span style='color: gray;'>%s</span></td></tr>", v29);
  printf("<tr style='height: 18px;'><td><span style='color: gray;'>");
  v31 = (const char *)get_ux_text_common(349, v30);
  printf(v31, &dest);
  printf("</span></td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("</table>");
  printf("<iframe name=\"sysconf_swupgrade_online_status\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_swupgrade_online_status\" frameborder=no style='display:none;'></iframe>");
  v32 = printf("</td>");
  etr(v32);
  printf("<tr id=manual>");
  puts("<td align=left>");
  printf("<table style='width: 640px;'>");
  printf("<tr height=40 valign=top><td>");
  printf("<table id=manual_status_table cellpadding=0px cellspacing=0px style='margin: 0 5px; background-color: #FFF; width: 620px;'>");
  v34 = get_ux_text_common(1195, v33);
  printf("<tr style='height: 18px;'><td style='color:gray; padding-left: 10px; padding-top: 10px;'>%s</td></tr>", v34);
  get_si("pi", &v58);
  snprintf(&v61, 0x100u, "%s", &v60);
  snprintf(&v63, 0x80u, "%s", &v59);
  if ( v61 )
  {
    printf("<tr style='height: 18px;'><td style='color:gray; padding-left: 10px;'>");
    v37 = (const char *)get_ux_text_common(1196, v36);
    printf(v37, &v61, &v63);
    printf("</td></tr>");
  }
  else if ( *(_BYTE *)get_ux_text_common(1196, v35) )
  {
    v39 = get_ux_text_common(1196, v38);
    printf("<tr style='height: 18px;'><td style='color:gray; padding-left: 10px;'>%s</td></tr>", v39);
  }
  v40 = get_ux_text_common(1197, v38);
  printf("<tr style='height: 18px;'><td style='color:gray; padding-left: 10px;'>%s</td></tr>", v40);
  v42 = get_ux_text_common(1198, v41);
  printf(
    "<tr style='height: 18px;'><td style='color:gray; padding-left: 10px; padding-bottom: 10px;'>%s</td></tr>",
    v42);
  printf("</table>");
  printf("<table id=manual_upload_table cellpadding=0px cellspacing=0px style='margin: 0 5px; background-color: #FFF; width: 620px; display: none;'>");
  v44 = get_ux_text_common(365, v43);
  printf("<tr style='height: 18px;'><td style='color:gray; padding-left: 10px; padding-top: 10px;'>%s</td></tr>", v44);
  v46 = get_ux_text_common(372, v45);
  printf("<tr style='height: 18px;'><td style='color:gray; padding-left: 10px;'>%s</td></tr>", v46);
  printf("<tr style='height: 18px;'><td style='color:gray; padding-left: 10px;'></td></tr>");
  printf("<tr style='height: 18px;'><td style='color:gray; padding-left: 10px; padding-bottom: 10px; height: 26px;'></td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<iframe name=\"sysconf_swupgrade_manual_file_form\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_swupgrade_manual_status\" frameborder=no scrolling='no' noresize style='width:100%%; height:39px;'></iframe>");
  puts("<form name='sysconf_swupgrade_manual_file_form' style='margin: 5px 0 0 0; padding: 5px; border-width: 1px 0; border-color: #DDD; border-style: solid; display: none;'>");
  printf("<input type=file name=upgrade size=30 maxlength=120 style='width: 430px; font-size: 12px; color:gray;' disabled>");
  v48 = get_ux_text_common(1190, v47);
  printf(
    "<input type=button name=upload_submit value=\"%s\" style='float: right; font-size: 12px; color: gray;' disabled>\n",
    v48);
  puts("</form>");
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<table cellpadding=0px cellspacing=0px style='margin-left: 5px;'>");
  v49 = get_image_dir();
  v51 = get_ux_text_common(1202, v50);
  printf(
    "<tr style='height: 24px;'><td><img src='/%s/warning.gif' style='margin: 0 3px 1px 3px; vertical-align: middle;'><b s"
    "tyle='color: gray;'>%s</b></td></tr>",
    v49,
    v51);
  v53 = get_ux_text_common(348, v52);
  printf("<tr style='height: 18px;'><td><span style='color: gray;'>%s</span></td></tr>", v53);
  printf("<tr style='height: 18px;'><td><span style='color: gray;'>");
  v55 = (const char *)get_ux_text_common(349, v54);
  printf(v55, &dest);
  printf("</span></td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("</table>");
  v56 = printf("</td>");
  etr(v56);
  puts("</table></td></tr>");
  printf("</table>");
  puts("<script>");
  puts("FirmUpView();");
  return puts("</script>");
}
// 104B4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// 10A00: using guessed type int __fastcall get_firmware_version2(_DWORD);
// 10B38: using guessed type int __fastcall get_default_gateway(_DWORD, _DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);
// 119B4: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);

//----- (00023BC4) --------------------------------------------------------
int __fastcall sub_23BC4(int a1, int a2, const char *a3, int a4)
{
  int v4; // r4@1
  const char *v5; // r6@1
  int v6; // r7@1
  int v7; // r10@1
  char *v8; // r8@1
  int v9; // r1@1
  int v10; // r0@1
  const char *v11; // r1@2
  int v12; // r1@4
  int v13; // r0@4
  void *v14; // r0@6
  char s; // [sp+18h] [bp-140h]@4
  char v17; // [sp+118h] [bp-40h]@1

  v4 = a1;
  v5 = a3;
  v6 = a4;
  v7 = a2;
  puts("<td class=\"wansetup_main_td\">");
  v8 = "";
  v10 = get_ux_text_common(900, v9);
  printf("<span class=\"wansetup_main_p\">%s</span></td>\n", v10);
  puts("<td class=\"wansetup_main_td\">");
  snprintf(&v17, 0x20u, "hw_%s", v4);
  if ( *v5 )
    v11 = v5;
  else
    v11 = 0;
  print_hwadress_inputbox((int)&v17, v11, v6);
  printf((const char *)&unk_82FE6);
  printf(
    "<input type=checkbox id=\"macchk_%s\" class=navi_chk name=hw_conf_%s %s onclick=\"SetHWOnCheckEnableHWButton(this,'h"
    "w_%s','%s','macbutton_%s'); setdefaultmac(this, 'hw_%s', '%s');\"><label for=\"macchk_%s\">\n",
    v4,
    v4);
  v13 = get_ux_text_common(861, v12);
  printf("<span class=\"wansetup_main_span\">%s</span></label>", v13);
  snprintf(&s, 0x100u, (const char *)&unk_830D4, v4, v4, v7, v4, v4, v5, v4);
  snprintf(&v17, 0x20u, "macbutton_%s", v4);
  if ( !*v5 )
    v8 = "disabled";
  v14 = get_image_dir();
  printf(
    "<button type=\"button\" class=\"wansetup_main_button\" name=\"%s\" style=\"margin-left:5px;\" onclick=\"onclick_macs"
    "earchbtn('hw_%s')\" %s>\t\t<img src=\"/%s/fw_search.gif\" style=\"width:16px; height:16px; padding:0; margin:0;\"></button>",
    &v17,
    v4,
    v8,
    v14);
  return printf("</td>");
}

//----- (00023D1C) --------------------------------------------------------
int __fastcall sub_23D1C(const char *a1, int a2, int a3)
{
  char *v3; // r5@1
  const char *v4; // r6@1
  int v5; // r4@1
  int v6; // r7@1
  int v7; // r4@4
  int v8; // r0@6
  int v9; // r1@10
  char *v10; // r4@10
  int v11; // r0@12
  char v13; // [sp+10h] [bp-1B8h]@1
  char v14; // [sp+90h] [bp-138h]@6
  char s; // [sp+110h] [bp-B8h]@6
  char v16; // [sp+190h] [bp-38h]@3

  v3 = &v13;
  v4 = a1;
  v5 = a2;
  v6 = a3;
  get_wan_hw_ifname(a2, &v13);
  if ( !strcmp(v4, "pppoe") || !strcmp(v4, "pptp") )
  {
    v3 = &v16;
    get_pppoe_ifname(v5, &v16);
  }
  v7 = get_mtu_value(v3, 1);
  if ( !v7 )
    v7 = v6;
  snprintf(&s, 0x80u, "mtu.%s.%s.check", v4, &v13);
  snprintf(&v14, 0x80u, "mtu.%s.%s", v4, &v13);
  v8 = iconfig_get_intvalue_direct(&s);
  if ( v8 != -1 )
    v4 = (const char *)v8;
  if ( v8 == -1 )
    v4 = 0;
  printf("<td class=\"wansetup_main_td\">");
  puts("<span class=\"wansetup_main_p\">MTU</span>");
  printf("</td>");
  printf(
    "<td class=\"wansetup_main_td\"><input class=\"navi_text\" style=\"width:160px;\" type=text name=%s maxlength=4 value=%d></td>\n",
    &v14,
    v7);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\">");
  v10 = "";
  if ( v4 )
    v10 = "checked";
  v11 = get_ux_text_common(898, v9);
  printf(
    "<input type=checkbox class=navi_chk id=\"mtuchk_%s\" name='%s' %s onclick=\"OnCheckEnableMTU(this, '%s')\">\t\t<labe"
    "l for=\"mtuchk_%s\"><span class=\"wansetup_main_span\">%s</span></label>\n",
    &s,
    &s,
    v10,
    &v14,
    &s,
    v11);
  return printf("</td>");
}
// 1073C: using guessed type int __fastcall iconfig_get_intvalue_direct(_DWORD);
// 10FD0: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// 11108: using guessed type int __fastcall get_pppoe_ifname(_DWORD, _DWORD);
// 11840: using guessed type int __fastcall get_mtu_value(_DWORD, _DWORD);

//----- (00023E8C) --------------------------------------------------------
int __fastcall sub_23E8C(int a1)
{
  int v1; // r6@1
  int result; // r0@1
  bool v3; // zf@2
  const char *v4; // r1@2
  int v5; // r0@8
  char s; // [sp+Ch] [bp-18Ch]@5
  char v7; // [sp+10Ch] [bp-8Ch]@4
  char v8; // [sp+14Ch] [bp-4Ch]@1
  char v9; // [sp+16Ch] [bp-2Ch]@2

  v1 = a1;
  result = get_value_post(a1, "act", &v8, 32);
  if ( !result )
    return result;
  get_value_post(v1, "wan", &v9, 20);
  v3 = strcmp(&v9, "wan2") == 0;
  v4 = "eth0";
  if ( v3 )
    v4 = "eth2";
  strcpy(&v7, v4);
  if ( !strcmp(&v8, "connect") )
  {
    set_wansetup_status(&v9, 1);
    snprintf(&s, 0x100u, "%s(%s)", "@{40}", &v9);
    syslog_msg(1, &s);
    stop_wan(&v9);
  }
  else if ( !strcmp(&v8, "disconnect") )
  {
    snprintf(&s, 0x100u, "%s(%s)", "@{41}", &v9);
    syslog_msg(1, &s);
    set_wansetup_status(&v9, 0);
    stop_wan(&v9);
    set_ifconfig(&v7);
  }
  v5 = istatus_remove_status_tag("lanwan_samenetwork");
  result = signal_update(v5);
  return result;
}
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11324: using guessed type int __fastcall stop_wan(_DWORD);
// 113CC: using guessed type int syslog_msg(_DWORD, const char *, ...);
// 11B10: using guessed type int __fastcall set_wansetup_status(_DWORD, _DWORD);
// 11EA0: using guessed type int __fastcall set_ifconfig(_DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);
// 120C8: using guessed type int __fastcall istatus_remove_status_tag(_DWORD);

//----- (00023FEC) --------------------------------------------------------
int __fastcall sub_23FEC(int a1, const char *a2, int a3)
{
  int v3; // r5@1
  const char *v4; // r4@1
  int v5; // r6@1
  char v7; // [sp+4h] [bp-17Ch]@2
  char s; // [sp+84h] [bp-FCh]@2
  char v9; // [sp+104h] [bp-7Ch]@2
  char v10; // [sp+124h] [bp-5Ch]@7
  char s2; // [sp+138h] [bp-48h]@2
  char dest; // [sp+14Ch] [bp-34h]@4

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( strcmp(a2, "eth0") )
    return 0;
  snprintf(&s, 0x80u, "hw_conf_%s", v5);
  snprintf(&v7, 0x80u, "hw_%s", v5);
  get_hwaddr_kernel(v4, &s2);
  if ( get_value_post(v3, &s, &v9, 32) && !strcmp(&v9, "on") )
  {
    strcpy(&dest, "");
    get_hw_value_post(v3, &v7, &dest);
    if ( !check_invalid_hwaddr(&dest) && strcmp(&dest, &s2) )
    {
      set_hwaddr_kernel(v4, &dest, 1);
      set_hwaddr_cloned(v4, &dest);
    }
  }
  else
  {
    get_hwaddr_org(v4, &v10);
    set_hwaddr_cloned(v4, 0);
    if ( strcmp(&v10, &s2) )
      set_hwaddr_kernel(v4, &v10, 1);
  }
  return 0;
}
// 107C0: using guessed type int __fastcall get_hwaddr_kernel(_DWORD, _DWORD);
// 107F0: using guessed type int __fastcall get_hwaddr_org(_DWORD, _DWORD);
// 109DC: using guessed type int __fastcall set_hwaddr_cloned(_DWORD, _DWORD);
// 10EE0: using guessed type int __fastcall check_invalid_hwaddr(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 114A4: using guessed type int __fastcall set_hwaddr_kernel(_DWORD, _DWORD, _DWORD);
// 11858: using guessed type int __fastcall get_hw_value_post(_DWORD, _DWORD, _DWORD);

//----- (0002414C) --------------------------------------------------------
int __fastcall sub_2414C(int a1, int a2, const char *a3)
{
  const char *v3; // r4@1
  int v4; // r9@1
  int v5; // r7@1
  int v6; // r5@1
  int v7; // r0@10
  char v9; // [sp+Ch] [bp-1C4h]@4
  char v10; // [sp+8Ch] [bp-144h]@4
  char v11; // [sp+10Ch] [bp-C4h]@3
  char v12; // [sp+14Ch] [bp-84h]@4
  char v13; // [sp+18Ch] [bp-44h]@4
  int v14; // [sp+1ACh] [bp-24h]@9

  v3 = a3;
  v4 = a1;
  v5 = a2;
  v6 = hwinfo_get_mtu(a3);
  if ( !strcmp(v3, "pppoe") || !strcmp(v3, "pptp") )
    get_pppoe_ifname(v5, &v11);
  get_wan_hw_ifname(v5, &v12);
  snprintf(&v10, 0x80u, "mtu.%s.%s", v3, &v12);
  snprintf(&v9, 0x80u, "mtu.%s.%s.check", v3, &v12);
  if ( get_value_post(v4, &v9, &v13, 32) && !strcmp(&v13, "on") )
  {
    if ( get_intvalue_post(v4, (int)&v10, (int)&v14) )
    {
      iconfig_set_intvalue_direct(&v9, 1);
      v7 = get_mtu_value(&v12, 1);
      v6 = v14;
      if ( v7 != v14 )
      {
        iconfig_set_intvalue_direct(&v10, v14);
        if ( strcmp(v3, "pppoe") && strcmp(v3, "pptp") )
          set_mtu_value(&v12, v14);
        v6 = v14;
      }
    }
  }
  else
  {
    iconfig_set_intvalue_direct(&v9, 0);
    if ( strcmp(v3, "pppoe") && strcmp(v3, "pptp") )
      set_mtu_value(&v12, v6);
  }
  return v6;
}
// 10D24: using guessed type int __fastcall hwinfo_get_mtu(_DWORD);
// 10FD0: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// 11108: using guessed type int __fastcall get_pppoe_ifname(_DWORD, _DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11228: using guessed type int __fastcall set_mtu_value(_DWORD, _DWORD);
// 11840: using guessed type int __fastcall get_mtu_value(_DWORD, _DWORD);
// 11BE8: using guessed type int __fastcall iconfig_set_intvalue_direct(_DWORD, _DWORD);

//----- (00024300) --------------------------------------------------------
int __fastcall sub_24300(int a1, _BYTE *a2, int a3)
{
  int v3; // r5@1
  int v4; // r4@1
  int v5; // r1@3
  char *v6; // r1@6
  char *v7; // r0@8
  bool v8; // zf@8
  const char *v9; // r1@8
  char *v10; // r0@8
  char *v11; // r0@13
  bool v12; // zf@13
  const char *v13; // r1@13
  char *v14; // r0@13
  char *v15; // r1@18
  char *v16; // r0@19
  char *v17; // r6@24
  signed int v18; // r4@24
  char *v19; // r6@25
  signed int v20; // r4@25
  int result; // r0@26
  int v22; // r0@30
  char v23; // [sp+18h] [bp-38h]@8
  char v24; // [sp+1Dh] [bp-33h]@10
  char v25; // [sp+22h] [bp-2Eh]@15
  char v26; // [sp+27h] [bp-29h]@19
  char dest; // [sp+2Ch] [bp-24h]@3

  v3 = a1;
  v4 = a3;
  if ( a2 && *a2 )
    sf_strncpy(&dest, a2, 20);
  else
    strcpy(&dest, "");
  if ( dest )
  {
    v6 = strtok(&dest, ".");
    if ( !v6 )
      v6 = "0";
    strcpy(&v23, v6);
    v7 = strtok(0, ".");
    v9 = v7;
    v8 = v7 == 0;
    v10 = &v23;
    if ( v8 )
      v9 = "0";
    else
      v10 = &v24;
    if ( v8 )
      v10 += 5;
    strcpy(v10, v9);
    v11 = strtok(0, ".");
    v13 = v11;
    v12 = v11 == 0;
    v14 = &v23;
    if ( v12 )
      v13 = "0";
    else
      v14 = &v25;
    if ( v12 )
      v14 += 10;
    strcpy(v14, v13);
    v15 = strtok(0, ".");
    if ( v15 )
    {
      v16 = &v26;
    }
    else
    {
      v16 = &v26;
      v15 = "0";
    }
    strcpy(v16, v15);
  }
  else
  {
    v26 = 0;
    v25 = 0;
    v24 = 0;
    v23 = 0;
  }
  if ( v4 )
  {
    v19 = &v23;
    v20 = 1;
    do
    {
      result = printf(
                 "<input type=text maxlength=3 size=3 id=\"disabled_%s%d\" style=\"width:28pt; ime-mode:disabled; backgro"
                 "und-color:#EEEEEE;\" value=\"%s\" disabled>",
                 v3,
                 v20,
                 v19);
      if ( v20 != 4 )
        result = putchar(46);
      ++v20;
      v19 += 5;
    }
    while ( v20 != 5 );
  }
  else
  {
    v17 = &v23;
    v18 = 1;
    do
    {
      v22 = get_ux_text_common(442, v5);
      result = printf(
                 "<input type=text name=\"%s%d\" maxlength=3 size=3 style=\"width:28pt; ime-mode:disabled;\" value=\"%s\""
                 " onfocus=\"this.select();\"\t\t\t    onkeyup=\"IPKeyUp('%s',%d);\" onkeypress=\"return IPKeyDown('%s', "
                 "%d)\" title=\"%s%d\">",
                 v3,
                 v18,
                 v17,
                 v3,
                 v18,
                 v3,
                 v18,
                 v22,
                 v18,
                 *(_DWORD *)&v23);
      if ( v18 != 4 )
        result = putchar(46);
      ++v18;
      v17 += 5;
    }
    while ( v18 != 5 );
  }
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);

//----- (000244A8) --------------------------------------------------------
int __fastcall netconf_wansetup_apply(int a1)
{
  int v1; // r4@1
  int result; // r0@1
  const char *v3; // r0@3
  int v4; // r0@12
  int *v5; // r0@16
  int v6; // r0@31
  int v7; // r0@33
  int v8; // r0@33
  int v9; // r0@36
  int v10; // r0@36
  int v11; // r0@36
  char v12; // [sp+8h] [bp-480h]@1
  char s; // [sp+208h] [bp-280h]@22
  char v14; // [sp+288h] [bp-200h]@24
  int v15; // [sp+330h] [bp-158h]@24
  char v16; // [sp+334h] [bp-154h]@26
  char v17; // [sp+338h] [bp-150h]@26
  int v18; // [sp+340h] [bp-148h]@24
  char s1; // [sp+344h] [bp-144h]@4
  char v20; // [sp+384h] [bp-104h]@28
  char v21; // [sp+3A4h] [bp-E4h]@28
  char v22; // [sp+3C4h] [bp-C4h]@28
  char v23; // [sp+3E4h] [bp-A4h]@33
  char dest; // [sp+3F8h] [bp-90h]@33
  int v25; // [sp+40Ch] [bp-7Ch]@6
  char v26; // [sp+420h] [bp-68h]@6
  int v27; // [sp+434h] [bp-54h]@6
  int v28; // [sp+448h] [bp-40h]@2
  int v29; // [sp+45Ch] [bp-2Ch]@4

  v1 = a1;
  result = get_value_post(a1, "act", &v12, 512);
  if ( !result )
    return result;
  if ( !get_value_post(v1, "wan", &v28, 20) )
  {
    v3 = "No WAN name is specified. Debug it..";
    return puts(v3);
  }
  get_wan_hw_ifname(&v28, &v29);
  set_wansetup_status(&v28, 1);
  result = get_value_post(v1, "wan_type", &s1, 64);
  if ( !result )
    return result;
  signal_toggle(result);
  stop_wan(&v28);
  set_wan_type(&v28, &s1);
  if ( !strcmp(&s1, "static") )
  {
    strcpy((char *)&v27, "");
    get_ip_value_post(v1, "ip", &v27);
    strcpy(&v26, "");
    get_ip_value_post(v1, "sm", &v26);
    strcpy((char *)&v25, "");
    get_ip_value_post(v1, "gw", &v25);
    set_wan_ipconfig(&v29, &v27, &v26, &v25);
    sub_23FEC(v1, (const char *)&v29, (int)&s1);
    set_ifconfig(&v29);
    if ( !sysconf_nat_get(1) )
      make_virtual_host_page(&v27);
    if ( check_default_gateway(&v25, &v27, &v26) )
    {
      set_default_gateway(&v29, 0);
    }
    else
    {
      set_default_gateway("br0", 0);
      if ( set_default_gateway(&v29, &v25) )
        set_default_gateway2(&v29, &v27, &v26, &v25);
    }
    v4 = sub_2414C(v1, (int)&v28, &s1);
    signal_wan(v4);
  }
  else if ( !strcmp(&s1, "dynamic") )
  {
    set_ifconfig(&v29);
    set_wan_ipconfig(&v29, "0.0.0.0", "255.255.255.0", 0);
    if ( get_value_post(v1, "allow_private", &v12, 512) && !strcmp(&v12, "on") )
      v5 = &v29;
    else
      v5 = &v29;
    set_dhclient_block_private_ip(v5);
    set_dhcp_auto_restart(&v29, 1);
    sub_23FEC(v1, (const char *)&v29, (int)&s1);
    sub_2414C(v1, (int)&v28, &s1);
  }
  else if ( !strcmp(&s1, "pppoe") )
  {
    if ( get_pppoe_status(&v28) == 7 )
      set_pppoe_status(&v28, 0);
    set_ifconfig(&v29);
    set_wan_ipconfig(&v29, "0.0.0.0", "255.255.255.0", 0);
    read_pppoe_option(&v28, &s);
    get_value_post(v1, "userid", &s, 128);
    if ( check_unpermitted_chars(&s) )
      strcpy(&s, "");
    get_value_post(v1, "passwd", &v14, 128);
    sub_23FEC(v1, (const char *)&v29, (int)&s1);
    v18 = sub_2414C(v1, (int)&v28, &s1);
    if ( get_intvalue_post(v1, (int)"lcp_flag", (int)&v15) )
    {
      get_intvalue_post(v1, (int)"lcp_echo_interval", (int)&v16);
      get_intvalue_post(v1, (int)"lcp_echo_failure", (int)&v17);
    }
    else
    {
      v15 = 0;
    }
    save_pppoe_option(&v28, &s);
  }
  snprintf(&s, 0x80u, "dns_%s_chk", &s1);
  snprintf(&v21, 0x20u, "fdns_%s", &s1);
  snprintf(&v20, 0x20u, "sdns_%s", &s1);
  if ( get_value_post(v1, &s, &v22, 32) && !strcmp(&v22, "on") || !strcmp(&s1, "static") )
  {
    v6 = strcmp(&s1, "static");
    if ( v6 && !check_valid_account(v6) )
      goto LABEL_36;
    strcpy(&dest, "");
    strcpy(&v23, "");
    get_ip_value_post(v1, &v21, &dest);
    get_ip_value_post(v1, &v20, &v23);
    set_autodns(0);
    dhcpd_set_dns(&dest, &v23);
    set_manual_dns_flag(&v29, &s1, 1);
    v7 = set_dns_shadow(&v29, &s1, &dest, &v23);
    v8 = get_remote_addr(v7);
    syslog_msg(1, "@{57}", v8, &dest, &v23);
  }
  else
  {
    set_autodns(1);
    set_manual_dns_flag(&v29, &s1, 0);
  }
  set_system_dns(&v28);
LABEL_36:
  v9 = istatus_remove_status_tag("lanwan_samenetwork");
  v10 = signal_toggle(v9);
  v11 = signal_update(v10);
  signal_save(v11);
  puts("<script language=JavaScript>");
  v3 = "</script>";
  return puts(v3);
}
// 104CC: using guessed type int __fastcall get_remote_addr(_DWORD);
// 104E4: using guessed type int __fastcall set_dhclient_block_private_ip(_DWORD);
// 104FC: using guessed type int __fastcall dhcpd_set_dns(_DWORD, _DWORD);
// 1052C: using guessed type int __fastcall set_autodns(_DWORD);
// 105C8: using guessed type int __fastcall make_virtual_host_page(_DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 1085C: using guessed type int __fastcall set_dns_shadow(_DWORD, _DWORD, _DWORD, _DWORD);
// 10DCC: using guessed type int __fastcall check_valid_account(_DWORD);
// 10F70: using guessed type int __fastcall set_default_gateway2(_DWORD, _DWORD, _DWORD, _DWORD);
// 10FD0: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// 11000: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// 11144: using guessed type int __fastcall signal_wan(_DWORD);
// 11180: using guessed type int __fastcall set_wan_type(_DWORD, _DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 112AC: using guessed type int __fastcall set_pppoe_status(_DWORD, _DWORD);
// 11324: using guessed type int __fastcall stop_wan(_DWORD);
// 113CC: using guessed type int syslog_msg(_DWORD, const char *, ...);
// 11414: using guessed type int __fastcall sysconf_nat_get(_DWORD);
// 1160C: using guessed type int __fastcall set_system_dns(_DWORD);
// 11738: using guessed type int __fastcall read_pppoe_option(_DWORD, _DWORD);
// 11AC8: using guessed type int __fastcall set_wan_ipconfig(_DWORD, _DWORD, _DWORD, _DWORD);
// 11B10: using guessed type int __fastcall set_wansetup_status(_DWORD, _DWORD);
// 11CF0: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// 11E64: using guessed type int __fastcall signal_toggle(_DWORD);
// 11EA0: using guessed type int __fastcall set_ifconfig(_DWORD);
// 11F00: using guessed type int __fastcall set_default_gateway(_DWORD, _DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);
// 11FA8: using guessed type int __fastcall set_dhcp_auto_restart(_DWORD, _DWORD);
// 11FD8: using guessed type int __fastcall check_default_gateway(_DWORD, _DWORD, _DWORD);
// 11FF0: using guessed type int __fastcall save_pppoe_option(_DWORD, _DWORD);
// 1205C: using guessed type int __fastcall get_pppoe_status(_DWORD);
// 1208C: using guessed type int __fastcall set_manual_dns_flag(_DWORD, _DWORD, _DWORD);
// 120C8: using guessed type int __fastcall istatus_remove_status_tag(_DWORD);

//----- (00024AB4) --------------------------------------------------------
int __fastcall print_iframe_hiddenwanstatus(int a1, int a2)
{
  int v2; // r5@1
  char *v3; // r4@1
  int result; // r0@2
  int v5; // r1@3
  const char *v6; // r0@4
  int v7; // r1@7
  int v8; // r0@12
  int v9; // r0@13
  char *v10; // r5@15
  int v11; // r0@16
  char *v12; // r6@24
  int v13; // r1@24
  const char *v14; // r0@24
  int v15; // r7@24
  int v16; // r1@24
  const char *v17; // r0@25
  const char *v18; // r1@29
  char *v19; // r0@29
  int v20; // r0@33
  int v21; // r6@33
  char *v22; // r0@33
  int v23; // r1@35
  const char *v24; // r0@36
  const char *v25; // r0@37
  int v26; // r1@38
  int v27; // r0@39
  int v28; // r1@45
  char *v29; // r5@45
  int v30; // r0@46
  int v31; // r0@53
  char s[512]; // [sp+8h] [bp-338h]@3
  char v33; // [sp+208h] [bp-138h]@40
  char v34; // [sp+248h] [bp-F8h]@45
  char v35; // [sp+268h] [bp-D8h]@42
  char v36; // [sp+288h] [bp-B8h]@2
  char v37; // [sp+2A8h] [bp-98h]@42
  char v38; // [sp+2BCh] [bp-84h]@42
  char v39; // [sp+2D0h] [bp-70h]@5
  char v40; // [sp+2E4h] [bp-5Ch]@5
  char v41; // [sp+2F8h] [bp-48h]@5
  char s1; // [sp+30Ch] [bp-34h]@3
  char v43; // [sp+31Ch] [bp-24h]@3

  v2 = a2;
  v3 = (char *)get_parameter_value(a1, "wan");
  if ( !v3 && (v3 = &v36, (result = get_value_post(v2, "wan", &v36, 32)) == 0) )
    return result;
  get_wan_type(v3, &s1);
  get_wan_hw_ifname(v3, &v43);
  memset(s, 0, 0x200u);
  if ( wireless_get_wwan_enable(0) )
  {
    v6 = (const char *)get_ux_text_common(1710, v5);
    strcpy(s, v6);
  }
  get_wan_ipinfo(v3, &v41, &v40, &v39);
  if ( !strcmp(&s1, "pppoe") )
    sf_strncpy(&v39, &v41, 20);
  if ( !get_wansetup_status(v3) )
  {
    v9 = 432;
    goto LABEL_31;
  }
  if ( !strcmp(&s1, "pppoe") || !strcmp(&s1, "pptp") )
  {
    if ( get_idle_timeout(&v43) || !get_wansetup_status(v3) )
    {
      v9 = 1258;
      goto LABEL_31;
    }
    v8 = get_pppoe_status(v3);
    if ( !v8 )
    {
      v9 = 429;
LABEL_31:
      v18 = (const char *)get_ux_text_common(v9, v7);
      v19 = s;
      goto LABEL_32;
    }
    if ( v8 != 4 )
    {
      if ( v8 != 6 )
        goto LABEL_33;
      v9 = 1259;
      goto LABEL_31;
    }
    v10 = s;
    if ( !v41 )
    {
      v11 = 1255;
LABEL_29:
      v18 = (const char *)get_ux_text_common(v11, v7);
      v19 = v10;
LABEL_32:
      strcat(v19, v18);
      goto LABEL_33;
    }
  }
  else
  {
    v10 = s;
    if ( !v41 )
    {
      v12 = &s[strlen(s)];
      v14 = (const char *)get_ux_text_common(1260, v13);
      v15 = sprintf(v12, v14);
      if ( istatus_get_intvalue_direct((int)"lanwan_samenetwork") == 1 )
      {
        v17 = (const char *)get_ux_text_common(899, v16);
        sprintf(&v12[v15], v17, "JavaScript:MovePagetoMain(\\'netconf\\',\\'lansetup\\');");
      }
      else if ( istatus_get_intvalue_direct((int)"privateip") == 1 && get_dhclient_block_private_ip(&v43) )
      {
        v11 = 1263;
        goto LABEL_29;
      }
LABEL_33:
      v20 = get_wan_link(v3);
      v21 = v20;
      v22 = (char *)get_usb_tethering_status(v20);
      if ( !v22 && !v21 )
      {
        strcpy(s, "");
        if ( wireless_get_wwan_enable(0) )
        {
          v24 = (const char *)get_ux_text_common(1710, v23);
          strcpy(s, v24);
        }
        v25 = (const char *)get_ux_text_common(146, v23);
        v22 = strcat(s, v25);
      }
      if ( get_usb_tethering_status(v22) )
      {
        v27 = get_ux_text_common(1390, v26);
        snprintf(s, 0x200u, "%s(%s)", s, v27);
      }
      memset(&v33, 0, 0x40u);
      if ( get_idle_timeout(&v43) || !get_wansetup_status(v3) )
      {
        if ( !strcmp(&s1, "static") )
        {
LABEL_54:
          printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
          printf("<form action=\"timepro.cgi\" method=\"post\" name=\"waninfostatus_fm\">");
          printf("<input type=\"hidden\" name=\"tmenu\" value=\"iframe\">");
          printf("<input type=\"hidden\" name=\"smenu\" value=\"hiddenwanstatus\">");
          printf("<input type=\"hidden\" name=\"wan\" value=\"%s\">", v3);
          printf("<input type=\"hidden\" name=\"wan_type\" value=\"%s\">", &s1);
          printf("<input type=\"hidden\" name=\"fdns\" value=\"%s\">", &v38);
          printf("<input type=\"hidden\" name=\"sdns\" value=\"%s\">", &v37);
          printf("<input type=\"hidden\" name=\"ip\" value=\"%s\">", &v41);
          printf("<input type=\"hidden\" name=\"sm\" value=\"%s\">", &v40);
          printf("<input type=\"hidden\" name=\"gw\" value=\"%s\">", &v39);
          printf("<input type=\"hidden\" name=\"buttonact\" value=\"%s\">", &v34);
          printf("</form>");
          printf("</BODY>");
          printf("<script>");
          printf("parent.document.getElementById('connstatus').innerHTML = '%s';\n", s);
          printf("parent.document.getElementById('conbtn').value = '%s';\n", &v33);
          puts("EnableObj(parent.document.getElementById('conbtn'));");
          puts("if(parent.window.footerbtn_view_control)\tparent.window.footerbtn_view_control(parent.document);");
          puts("if(parent.window.update_addrs)\t\t\tparent.window.update_addrs(document, parent.document);");
          puts("setTimeout(function(){document.waninfostatus_fm.submit(); \t\tif(parent.window.submitted){parent.window.submitted = false; UnMaskIt(parent.document,'apply_mask');}},3000);");
          return printf("</script>");
        }
        sf_strncpy(&v34, "connect", 32);
        v29 = &v33;
        if ( !strcmp(&s1, "dynamic") )
          v30 = 822;
        else
          v30 = 1264;
      }
      else
      {
        get_dns_shadow(&v43, &s1, &v38, &v37);
        if ( !get_hwaddr_cloned("eth0", &v35) )
          get_hwaddr_kernel(&v43, &v35);
        convert_mac(&v35);
        if ( !strcmp(&s1, "static") )
          goto LABEL_54;
        sf_strncpy(&v34, "disconnect", 32);
        v29 = &v33;
        if ( !strcmp(&s1, "dynamic") )
          v30 = 821;
        else
          v30 = 1257;
      }
      v31 = get_ux_text_common(v30, v28);
      sf_strncpy(v29, v31, 64);
      goto LABEL_54;
    }
  }
  v11 = 1256;
  goto LABEL_29;
}
// 1055C: using guessed type int __fastcall get_wansetup_status(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 106DC: using guessed type int __fastcall get_wan_type(_DWORD, _DWORD);
// 106F4: using guessed type int __fastcall get_hwaddr_cloned(_DWORD, _DWORD);
// 107C0: using guessed type int __fastcall get_hwaddr_kernel(_DWORD, _DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);
// 10D00: using guessed type int __fastcall get_idle_timeout(_DWORD);
// 10E8C: using guessed type int __fastcall get_wan_link(_DWORD);
// 10FD0: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// 10FE8: using guessed type int __fastcall get_wan_ipinfo(_DWORD, _DWORD, _DWORD, _DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 114C8: using guessed type int __fastcall get_dhclient_block_private_ip(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 119E4: using guessed type int __fastcall get_dns_shadow(_DWORD, _DWORD, _DWORD, _DWORD);
// 11AB0: using guessed type int __fastcall wireless_get_wwan_enable(_DWORD);
// 11E10: using guessed type int __fastcall get_usb_tethering_status(_DWORD);
// 1205C: using guessed type int __fastcall get_pppoe_status(_DWORD);
// 24AB4: using guessed type char s[512];

//----- (00024FEC) --------------------------------------------------------
int __fastcall print_iframe_hiddenwansetup(int a1, int a2)
{
  int v2; // r5@1
  char v4; // [sp+0h] [bp-30h]@1

  v2 = a2;
  memset(&v4, 0, 0x20u);
  if ( get_value_post(v2, "act", &v4, 32) )
  {
    if ( !strcmp(&v4, "connect") || !strcmp(&v4, "disconnect") )
      sub_23E8C(v2);
    else
      netconf_wansetup_apply(v2);
  }
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"netconf_wansetup\">");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  if ( v4 )
    printf("parent.window.submitted = true;");
  return printf("</script>");
}
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (000250D8) --------------------------------------------------------
int __fastcall print_iframe_netconfmacsearch(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r9@3
  int v4; // r8@3
  void *v5; // r7@3
  void *v6; // r5@3
  int v7; // r11@3
  int v8; // r1@6
  int v9; // r0@6
  int v10; // r1@6
  int v11; // r0@6
  int v12; // r1@7
  int v13; // r1@14
  int v14; // r0@14
  int v16; // [sp+0h] [bp-48h]@2
  char v17; // [sp+10h] [bp-38h]@1

  v2 = a2;
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"netconf_macsearchiframe\">");
  printf("<input type=\"hidden\" name=\"tmenu\" value=\"iframe\">");
  printf("<input type=\"hidden\" name=\"smenu\" value=\"netconfmacsearch\">");
  printf("<input type=\"hidden\" name=\"inputprefix\" value=\"\">");
  printf("<input type=\"hidden\" name=\"act\" value=\"\">");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  if ( !get_value_post(v2, "act", &v17, 16) || !get_value_post(v2, "inputprefix", &v16, 16) )
    return printf("</script>");
  v3 = 0;
  puts("function MakeMacAddrTable()");
  v4 = 0;
  puts("{");
  puts("var obj = parent.document.getElementById('searchmaclist');");
  puts("var HTMLStr = '<div style=\\\"display:block; width:340px; height:24px;\\\">\t\t\t<table class=\\\"wansetup_main_table\\\" style=\\\"width:340px; height:24px;\\\">';");
  v5 = malloc(0xBC00u);
  v6 = v5;
  memset(v5, 0, 0xBC00u);
  v7 = get_hostinfo_from_arp("br0", 256, v5);
  while ( v4 < v7 )
  {
    if ( strcmp((const char *)v6 + 148, "00:00:00:00:00:00") )
    {
      convert_mac((char *)v6 + 148);
      if ( !v3 )
      {
        printf("HTMLStr += '<tr class=\\\"wansetup_main_tr\\\" height=\\\"24\\\">';");
        v9 = get_ux_text_common(985, v8);
        printf(
          "HTMLStr += '<td class=\\\"wansetup_main_td\\\" \t\t\t\t\tstyle=\\\"width:169px; background-color:#EEEEEE; bord"
          "er:1px #ccc solid;\\\">\t\t\t\t\t<span class=\\\"wansetup_main_span\\\" style=\\\"text-align:center; width:100"
          "%%;\\\">%s</span></td>';",
          v9);
        v11 = get_ux_text_common(984, v10);
        printf(
          "HTMLStr += '<td class=\\\"wansetup_main_td\\\" \t\t\t\t\tstyle=\\\"width:169px; background-color:#EEEEEE; bord"
          "er:1px #ccc solid;\\\">\t\t\t\t\t<span class=\\\"wansetup_main_span\\\" style=\\\"text-align:center; width:100"
          "%%;\\\">%s</span></td>';",
          v11);
        printf("HTMLStr += '</tr>';");
        printf("HTMLStr += '</table></div><div \t\t\tstyle=\\\"display:block; width:340px; max-height:186px; height:186px; overflow:auto; overflow-x:hidden; -ms-overflow-x:hidden;\\\">\t\t\t\t\t<table class=\\\"wansetup_main_table\\\" style=\\\"width:340px;\\\">';");
      }
      printf(
        "HTMLStr += '<tr class=\\\"wansetup_main_tr\\\" height=\\\"24\\\" style=\"cursor:pointer;\"\t\t\t\tonclick=\\\"Se"
        "lectMacFromPopup(\\'%s\\', \\'%s\\');\\\" onmouseover=\\\"ChangeToOverColor(this);\\\" onmouseout=\\\"ChangeToOu"
        "tColor(this);\\\">';",
        &v16,
        (char *)v6 + 148);
      printf(
        "HTMLStr += '<td class=\\\"wansetup_main_td\\\" style=\\\"border:1px #ccc solid;\\\">\t\t\t\t<span class=\\\"wans"
        "etup_main_span\\\" style=\\\"margin-left:5px; min-width:163px;\\\">%s</a></td>';",
        (char *)v6 + 148);
      v12 = (int)v6 + 128;
      if ( *(_BYTE *)v6 )
        printf(
          "HTMLStr += '<td class=\\\"wansetup_main_td\\\" style=\\\"border:1px #ccc solid;\\\">\t\t\t\t\t<span class=\\\""
          "wansetup_main_span\\\" style=\\\"margin-left:5px; min-width:163px;\\\">%s(%s)</span></td>';",
          v12,
          v6);
      else
        printf(
          "HTMLStr += '<td class=\\\"wansetup_main_td\\\" style=\\\"border:1px #ccc solid;\\\">\t\t\t\t\t<span class=\\\""
          "wansetup_main_span\\\" style=\\\"margin-left:5px; min-width:163px;\\\">%s</span></td>';",
          v12);
      ++v3;
      printf("HTMLStr += '</tr>';");
    }
    ++v4;
    v6 = (char *)v6 + 188;
  }
  if ( !v3 )
  {
    printf("HTMLStr += '<tr class=\\\"wansetup_main_tr\\\" height=\\\"24\\\">';");
    v14 = get_ux_text_common(986, v13);
    printf(
      "HTMLStr += '<td class=\\\"wansetup_main_td\\\" colspan=\\\"2\\\" style=\\\"background-color:#EEEEEE;\\\">\t\t\t\t<"
      "span class=\\\"wansetup_main_span\\\">%s</span></td>';",
      v14);
    printf("HTMLStr += '</tr>';");
  }
  free(v5);
  puts("HTMLStr += '</table></div>';");
  puts("obj.innerHTML = HTMLStr;");
  puts("}");
  printf("MakeMacAddrTable();");
  return printf("</script>");
}
// 107B4: using guessed type int __fastcall get_hostinfo_from_arp(_DWORD, _DWORD, _DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00025374) --------------------------------------------------------
int __fastcall print_wansetup_view(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r1@1
  const char *v4; // r0@1
  int v5; // r0@1
  int v6; // r1@1
  char *v7; // r1@2
  int v8; // r1@4
  int v9; // r0@4
  char *v10; // r1@5
  int v11; // r1@7
  int v12; // r0@7
  char *v13; // r1@8
  int v14; // r1@10
  int v15; // r0@10
  char *v16; // r0@12
  int v17; // r10@12
  char *v18; // r8@12
  int v19; // r1@12
  int v20; // r0@12
  int v21; // r1@12
  int v22; // r0@14
  int v23; // r1@14
  int v24; // r0@14
  int v25; // r1@14
  int v26; // r0@14
  int v27; // r1@16
  int v28; // r0@16
  int v29; // r1@16
  int v30; // r0@16
  int v31; // r1@16
  int v32; // r0@16
  int v33; // r1@16
  int v34; // r0@16
  int v35; // r1@16
  int v36; // r0@16
  int v37; // r1@16
  int v38; // r0@16
  int v39; // r1@16
  int v40; // r0@16
  int v41; // r1@16
  int v42; // r0@16
  int v43; // r1@16
  int v44; // r0@16
  int v45; // r1@18
  int v46; // r0@18
  int v47; // r1@18
  int v48; // r0@18
  char *v49; // r1@19
  int v50; // r1@21
  int v51; // r0@21
  int v52; // r1@21
  int v53; // r0@21
  int v54; // r1@21
  int v55; // r0@21
  int v56; // r1@21
  int v57; // r0@21
  int v58; // r1@21
  int v59; // r0@21
  char *v60; // r1@22
  int v61; // r1@24
  int v62; // r0@24
  int v63; // r1@24
  int v64; // r0@24
  int v65; // r1@24
  int v66; // r0@24
  int v67; // r1@24
  int v68; // r0@24
  int v69; // r1@26
  int v70; // r0@26
  int v71; // r1@26
  int v72; // r0@26
  int v73; // r1@26
  int v74; // r0@26
  int v75; // r1@26
  int v76; // r0@26
  int v78; // [sp+8h] [bp-23Ch]@16
  char v79; // [sp+88h] [bp-1BCh]@16
  int v80; // [sp+130h] [bp-114h]@21
  int v81; // [sp+134h] [bp-110h]@21
  int v82; // [sp+138h] [bp-10Ch]@21
  int v83; // [sp+140h] [bp-104h]@21
  char v84; // [sp+144h] [bp-100h]@1
  char v85; // [sp+1C4h] [bp-80h]@1
  char dest; // [sp+204h] [bp-40h]@1
  char s1; // [sp+244h] [bp+0h]@1
  char v88; // [sp+264h] [bp+20h]@7
  char v89; // [sp+278h] [bp+34h]@7
  char v90; // [sp+28Ch] [bp+48h]@12
  char v91; // [sp+2A0h] [bp+5Ch]@16
  int v92; // [sp+2B4h] [bp+70h]@16
  char v93; // [sp+2C8h] [bp+84h]@14
  char v94; // [sp+2DCh] [bp+98h]@12
  char v95; // [sp+2F0h] [bp+ACh]@12
  char v96; // [sp+304h] [bp+C0h]@1

  v2 = a2;
  strcpy(&dest, "");
  strcpy(&v85, "");
  get_wan_hw_ifname(v2, &v96);
  get_wan_type(v2, &s1);
  v4 = (const char *)get_ux_text_common(834, v3);
  strcpy(&v84, v4);
  printf("<COL width=\"180\"><COL width=\"200\"><COL width=\"%%%%\">");
  puts("<form method=\"post\" action=\"timepro.cgi\" name=\"netconf_wansetup\">");
  puts("<input type=hidden name=\"tmenu\" value=\"netconf\">");
  puts("<input type=hidden name=\"smenu\" value=\"wansetup\">");
  puts("<input type=hidden name=\"act\" value=\"\">");
  puts("<input type=hidden name=\"ocolor\" value=\"\">");
  printf("<input type=hidden name=\"wan\" value=\"%s\">\n", v2);
  v5 = printf("<input type=hidden name=\"ifname\" value=\"%s\">\n", &v96);
  v6 = check_valid_account(v5) == 0;
  printf("<input type=hidden name=\"nopassword\" value=\"%d\">");
  puts("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"border-top:1px #CCC solid;\"><td class=\"wansetup_main_td\" colspan=\"3\"> ");
  if ( !strcmp(&s1, "dynamic") )
    v7 = "checked";
  else
    v7 = "";
  printf(
    "<input type=radio id=\"wan_type_id1\" name=\"wan_type\" class=\"navi_radio\" value=\"dynamic\" %s onclick=\"ShowWans"
    "etup('%s','dynamic')\"><label for=\"wan_type_id1\" style=\"display:inline-block; vertical-align:middle;\">",
    v7,
    &v96);
  v9 = get_ux_text_common(823, v8);
  printf("<span class=\"wansetup_main_span\" style=\"font-weight:700;\">%s</span></label></td></tr>\n", v9);
  puts("<tr class=\"wansetup_main_tr\" height=\"24\"><td class=\"wansetup_main_td\" colspan=\"3\"> ");
  if ( !strcmp(&s1, "pppoe") )
    v10 = "checked";
  else
    v10 = "";
  printf(
    "<input type=radio id=\"wan_type_id2\" name=\"wan_type\" class=\"navi_radio\" value=\"pppoe\" %s onclick=\"ShowWanset"
    "up('%s','pppoe')\"><label for=\"wan_type_id2\" style=\"display:inline-block; vertical-align:middle;\">",
    v10,
    &v96);
  v12 = get_ux_text_common(831, v11);
  printf("<span class=\"wansetup_main_span\" style=\"font-weight:700;\">%s</span></label></td></tr>", v12);
  strcpy(&v88, "");
  strcpy(&v89, "");
  puts("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"border-bottom:1px #CCC solid;\"><td class=\"wansetup_main_td\" colspan=\"3\"> ");
  if ( !strcmp(&s1, "static") )
    v13 = "checked";
  else
    v13 = "";
  printf(
    "<input type=radio id=\"wan_type_id3\" name=\"wan_type\" class=\"navi_radio\" value=\"static\" %s onclick=\"ShowWanse"
    "tup('%s','static')\"><label for=\"wan_type_id3\" style=\"display:inline-block; vertical-align:middle;\">",
    v13,
    &v96);
  v15 = get_ux_text_common(833, v14);
  printf("<span class=\"wansetup_main_span\" style=\"font-weight:700;\">%s</span></label></td></tr>", v15);
  if ( !get_hwaddr_cloned("eth0", &v89) )
    get_hwaddr_kernel(&v96, &v89);
  convert_mac(&v89);
  v16 = getenv("REMOTE_ADDR");
  get_internal_pc_hardware_address(v16, &v90);
  get_hwaddr_cloned(&v96, &v88);
  v17 = v88 == 0;
  strcmp(&s1, "dynamic");
  v18 = "checked";
  printf("<tr id=\"dynamic\" class=\"wansetup_main_tr\" style=\"display:%s;\"><td colspan=\"3\">");
  printf("<table class=\"v3_table wansetup_main_table\" width=\"100%%\">");
  printf("<COL width=\"180\"><COL width=\"200\"><COL width=\"%%%%\">");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v20 = get_ux_text_common(247, v19);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v20);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  get_ifconfig((int)&v96, (int)&v95, (int)&v94);
  sub_24300((int)"dynamicip", &v95, 1);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\">");
  if ( get_dhclient_block_private_ip(&v96) )
    v18 = "";
  v22 = get_ux_text_common(818, v21);
  printf(
    "<input type=checkbox id=\"aprchkid\" class=\"navi_chk\" name=\"allow_private\" %s>\t\t<label for=\"aprchkid\"><span "
    "class=\"item_text wansetup_main_span\">%s</span></label>",
    v18,
    v22);
  printf("</td></tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  v24 = get_ux_text_common(1118, v23);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v24);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_24300((int)"dynamicsm", &v94, 1);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\"></td>");
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v26 = get_ux_text_common(381, v25);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v26);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  get_default_gateway(&v96, &v93);
  if ( !strncmp(&v93, "ppp", 3u) )
    sf_strncpy(&v93, &v95, 20);
  sub_24300((int)"dynamicgw", &v93, 1);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\"></td>");
  printf("</tr>");
  get_dns_shadow(&v96, "dynamic", &v92, &v91);
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  v28 = get_ux_text_common(258, v27);
  printf("<td class=\"wansetup_main_td\"><span class=\"wansetup_main_p\">%s</span>\n", v28);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_24300((int)&unk_84A2A, &v92, 0);
  puts((const char *)&unk_84A37);
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v30 = get_ux_text_common(1079, v29);
  printf("<td class=\"wansetup_main_td\"><span class=\"wansetup_main_p\">%s</span>\n", v30);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_24300((int)"sdns_dynamic", &v91, 0);
  puts("</td>");
  puts("<td class=\"wansetup_main_td\">");
  get_manual_dns_flag(&v96, "dynamic");
  printf("<input type=checkbox name=\"dns_dynamic_chk\" class=navi_chk %s onclick=\"check_dns_dynamic();\" id=\"dns_dynamic_chkid\">\n");
  v32 = get_ux_text_common(804, v31);
  printf("<label for=\"dns_dynamic_chkid\"><span class=\"wansetup_main_span\">%s</span></label>\n", v32);
  puts("</td>");
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  sub_23BC4((int)"dynamic", (int)&v90, &v89, v17);
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  sub_23D1C("dynamic", v2, 1500);
  printf("</tr>");
  printf(
    "<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">\t\t<td class=\"wansetup_main_td\" cols"
    "pan=\"3\"></td></tr>",
    "F7F7F7");
  printf("</table></td></tr>");
  read_pppoe_option(v2, &v78);
  strcmp(&s1, "pppoe");
  printf("<tr id=\"pppoe\" class=\"wansetup_main_tr\" style=\"display:%s;\"><td colspan=\"3\">");
  printf("<table class=\"v3_table wansetup_main_table\" width=\"100%%\">");
  printf("<COL width=\"180\"><COL width=\"200\"><COL width=\"%%%%\">");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v34 = get_ux_text_common(827, v33);
  printf("<td class=wansetup_main_td><span class=\"wansetup_main_p\">%s</span></td>", v34);
  printf(
    "<td class=wansetup_main_td><input class=navi_text type=text style=\"width:160px;\" name=\"userid\" maxlength=63 valu"
    "e=\"%s\"></td>\n",
    &v78);
  printf("<td class=wansetup_main_td></td>");
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  v36 = get_ux_text_common(830, v35);
  printf((const char *)&unk_84CE6, v36);
  printf("<td class=wansetup_main_td><input class=\"navi_text\" type=password style=\"width:160px;\" name=\"passwd\" \t\tid=\"passwd_passwd\" maxlength=63 value=\"");
  print_escape_str(&v79);
  puts("\"><input class=\"navi_text\" type=text style=\"width:160px; display:none;\" id=\"passwd_text\" maxlength=63></td>");
  v38 = get_ux_text_common(1415, v37);
  printf(
    "<td class=wansetup_main_td><input type=\"checkbox\" id=\"passviewid\" name=\"passviewname\" onclick=\"clicked_passvi"
    "ew(this.checked, 'passwd');\" value=\"1\">\t\t<label for=\"passviewid\">%s</label></td>",
    v38);
  printf("</tr>");
  printf(
    "<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">\t\t<td class=\"wansetup_main_td\" cols"
    "pan=\"3\"></td></tr>",
    "FFFFFF");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  v40 = get_ux_text_common(247, v39);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v40);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  get_ifconfig((int)&v96, (int)&v95, (int)&v94);
  sub_24300((int)"pppoeip", &v95, 1);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\"></td>");
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v42 = get_ux_text_common(1118, v41);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v42);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_24300((int)"pppoesm", &v94, 1);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\"></td>");
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  v44 = get_ux_text_common(381, v43);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v44);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  get_default_gateway(&v96, &v93);
  if ( !strncmp(&v93, "ppp", 3u) )
    sf_strncpy(&v93, &v95, 20);
  sub_24300((int)"pppoegw", &v93, 1);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\"></td>");
  printf("</tr>");
  get_dns_shadow(&v96, "pppoe", &v92, &v91);
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v46 = get_ux_text_common(258, v45);
  printf("<td class=\"wansetup_main_td\"><span class=\"wansetup_main_p\">%s</span>\n", v46);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_24300((int)&unk_84F00, &v92, 0);
  puts((const char *)&unk_84A37);
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  v48 = get_ux_text_common(1079, v47);
  printf("<td class=\"wansetup_main_td\"><span class=\"wansetup_main_p\">%s</span>\n", v48);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_24300((int)"sdns_pppoe", &v91, 0);
  puts("</td>");
  puts("<td class=\"wansetup_main_td\">");
  if ( get_manual_dns_flag(&v96, "pppoe") )
    v49 = "checked";
  else
    v49 = "";
  printf(
    "<input type=checkbox name=\"dns_pppoe_chk\" class=navi_chk %s onclick=\"check_dns_pppoe();\" id=\"dns_pppoe_chkid\">\n",
    v49);
  v51 = get_ux_text_common(804, v50);
  printf("<label for=\"dns_pppoe_chkid\"><span class=\"wansetup_main_span\">%s</span></label>\n", v51);
  puts("</td>");
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  sub_23BC4((int)"pppoe", (int)&v90, &v89, v17);
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  sub_23D1C("pppoe", v2, v83);
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  printf("<td class=\"wansetup_main_td\">");
  v53 = get_ux_text_common(534, v52);
  printf("<span class=\"wansetup_main_p\">%s</span>", v53);
  printf("</td>");
  printf("<td class=wansetup_main_td>");
  v55 = get_ux_text_common(533, v54);
  printf("<span class=\"wansetup_main_span\">%s</span>", v55);
  printf("<input class=\"navi_text\" type=text name=\"lcp_echo_interval\" size=3 maxlength=3 value=\"%d\" >", v81);
  v57 = get_ux_text_common(1083, v56);
  printf("<span style=\"display:inline-block; vertical-align:middle; margin-right:5px;\">%s</span>", v57);
  v59 = get_ux_text_common(532, v58);
  printf("<span style=\"display:inline-block; vertical-align:middle; margin-left:5px;\">%s</span>", v59);
  printf("<input class=\"navi_text\" type=text name=\"lcp_echo_failure\" size=3 maxlength=3 value=\"%d\" >", v82);
  printf("</td>");
  printf("<td class=wansetup_main_td>");
  if ( v80 )
    v60 = "checked";
  else
    v60 = "";
  printf(
    "<input type=checkbox class=navi_chk id=\"lcpid\" name='lcp_flag' %s onclick=\"OnCheckEnableLCP()\" value=1>\n",
    v60);
  v62 = get_ux_text_common(898, v61);
  printf((const char *)&unk_85213, v62);
  printf("</td>");
  printf("</tr>");
  printf(
    "<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">\t\t<td class=\"wansetup_main_td\" cols"
    "pan=\"3\"></td></tr>",
    "F7F7F7");
  printf("</table>");
  printf("</td></tr>");
  strcmp(&s1, "static");
  printf("<tr id=\"static\" class=\"wansetup_main_tr\" style=\"display:%s;\"><td colspan=\"3\">");
  printf("<table class=\"v3_table wansetup_main_table\" width=\"100%%\">");
  printf("<COL width=\"180\"><COL width=\"200\"><COL width=\"%%%%\">");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v64 = get_ux_text_common(247, v63);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v64);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  get_ifconfig((int)&v96, (int)&v95, (int)&v94);
  sub_24300((int)"ip", &v95, 0);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\"></td>");
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  v66 = get_ux_text_common(1118, v65);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v66);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_24300((int)"sm", &v94, 0);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\"></td>");
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v68 = get_ux_text_common(381, v67);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v68);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  get_default_gateway(&v96, &v93);
  if ( !strncmp(&v93, "ppp", 3u) )
    sf_strncpy(&v93, &v95, 20);
  sub_24300((int)"gw", &v93, 0);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\"></td>");
  printf("</tr>");
  get_dns_shadow(&v96, "static", &v92, &v91);
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  v70 = get_ux_text_common(258, v69);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v70);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_24300((int)&unk_852A7, &v92, 0);
  puts((const char *)&unk_84A37);
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v72 = get_ux_text_common(1079, v71);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v72);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_24300((int)"sdns_static", &v91, 0);
  puts((const char *)&unk_84A37);
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  sub_23BC4((int)"static", (int)&v90, &v89, v17);
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  sub_23D1C("static", v2, 1500);
  printf("</tr>");
  printf(
    "<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">\t\t<td class=\"wansetup_main_td\" cols"
    "pan=\"3\"></td></tr>",
    "F7F7F7");
  printf("</table></td></tr>");
  printf(
    "<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s; border-bottom:1px #CCC solid;\">",
    "FFFFFF");
  v74 = get_ux_text_common(802, v73);
  printf("<td class=\"wansetup_main_td\"><span class=\"wansetup_main_p\" id=\"conntitle\">%s</span></td>", v74);
  printf("<td class=\"wansetup_main_td\" colspan=\"2\" height=\"24\">\t<div style=\"width:370px; display:inline-block; *display:inline; zoom:1; vertical-align:middle; margin:0; padding:0;\">\t<p id=\"connstatus\" style=\"width:370px; display:inline-block; *display:inline; zoom:1; vertical-align:middle; margin:0; padding:0;\"></p></div>");
  v76 = get_ux_text_common(35, v75);
  printf(
    "<div style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle; margin:0 0 0 10px; width:70px; pa"
    "dding:0;\">\t\t<input type=\"button\" class=\"bt\" id=\"appbtn\" value=\"%s\" onclick=\"apply_wansetup('%s','%s');\""
    ">\t\t<input type=\"button\" class=\"bt\" id=\"conbtn\" value=\"\" onclick=\"apply_connection('%s','%s');\" style=\"d"
    "isplay:none;\"></div>\n",
    v76,
    v2,
    &v96,
    v2,
    &v96);
  printf("</td></tr>");
  puts("</form>");
  printf("<form method=\"post\" name=\"backup_wansetup\">");
  return printf("</form>");
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 106DC: using guessed type int __fastcall get_wan_type(_DWORD, _DWORD);
// 106F4: using guessed type int __fastcall get_hwaddr_cloned(_DWORD, _DWORD);
// 107C0: using guessed type int __fastcall get_hwaddr_kernel(_DWORD, _DWORD);
// 108F8: using guessed type int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD);
// 10B38: using guessed type int __fastcall get_default_gateway(_DWORD, _DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);
// 10DCC: using guessed type int __fastcall check_valid_account(_DWORD);
// 10FD0: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// 110D8: using guessed type int __fastcall get_manual_dns_flag(_DWORD, _DWORD);
// 114C8: using guessed type int __fastcall get_dhclient_block_private_ip(_DWORD);
// 11738: using guessed type int __fastcall read_pppoe_option(_DWORD, _DWORD);
// 119E4: using guessed type int __fastcall get_dns_shadow(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00026180) --------------------------------------------------------
int __fastcall print_wansetup_script(int a1)
{
  int v1; // r6@1
  int v3; // [sp+0h] [bp-50h]@1
  char v4; // [sp+20h] [bp-30h]@1

  v1 = a1;
  get_wan_type(a1, &v4);
  get_wan_hw_ifname(v1, &v3);
  print_js_file((int)"netconf", (int)"wansetup");
  puts("<script language=JavaScript>");
  printf("ShowWansetup('%s','%s');", &v3, &v4);
  puts("check_dns()");
  puts("OnCheckEnableLCP();");
  return puts("</script>");
}
// 106DC: using guessed type int __fastcall get_wan_type(_DWORD, _DWORD);
// 10FD0: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);

//----- (00026208) --------------------------------------------------------
int __fastcall netconf_wansetup(int a1)
{
  int v1; // r5@1
  int v2; // r0@1
  int v3; // r1@2
  int v4; // r0@2
  int v5; // r0@2
  int result; // r0@2
  int v7; // r1@5
  int v8; // r0@5
  int v9; // r1@5
  int v10; // r0@5
  int v11; // r0@5
  int v12; // r0@6
  int v13; // r0@6
  int v14; // r0@9
  int v15; // r0@9
  int v16; // r0@12
  void *v17; // r0@14
  int v18; // [sp+0h] [bp-38h]@5
  char dest; // [sp+14h] [bp-24h]@3

  v1 = a1;
  v2 = get_usb_tethering_status(a1);
  if ( v2 )
  {
    print_start_main_table(v2);
    v4 = get_ux_text_common(1399, v3);
    v5 = printf("<tr><td width=100%% height=200px valign=top style=\"padding-top:0px;\"> %s </td></tr>", v4);
    result = print_end_main_table(v5);
  }
  else
  {
    strcpy(&dest, "");
    if ( !get_value(v1, "wan", &dest, 20) )
      strcpy(&dest, "wan1");
    puts("<script language=JavaScript>");
    puts("<!--");
    puts("function CheckNetworkConfig()");
    puts("{");
    get_netaddr("br0", &v18);
    printf("\tif(GetNetworkAddress('ip','sm')==\"%s\")\n", &v18);
    v8 = get_ux_text_common(826, v7);
    printf((const char *)&unk_85714, v8);
    printf("\telse if(GetNetworkAddress('gw','sm')==\"%s\")\n", &v18);
    v10 = get_ux_text_common(825, v9);
    printf((const char *)&unk_85714, v10);
    puts(" \telse");
    puts("\t{");
    puts("\t\treturn 1;");
    puts("\t}");
    puts("\treturn 0;");
    puts("}");
    puts("-->");
    puts("</script>");
    puts("<style type=\"text/css\">");
    puts(".wansetup_main_table {");
    puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
    puts("\ttable-layout:fixed;");
    puts("}");
    puts(".wansetup_main_tr {");
    puts("\tborder:0 0 0 0; padding:0 0 0 0;");
    puts("}");
    puts(".wansetup_main_td {");
    puts("\tpadding:0 0 0 0; font-size:12px;");
    puts("\tvertical-align:middle;");
    puts("}");
    puts(".wansetup_main_p {");
    puts("\tpadding-left:5px; display:inline-block;");
    puts("\tvertical-align:middle;");
    puts("}");
    puts(".wansetup_main_span {");
    puts("\tdisplay:inline-block; vertical-align:middle;");
    puts("}");
    puts(".wansetup_main_button {");
    puts("\tpadding:0 1 0 1; margin:0 0 0 0; font-size:12px;");
    puts("\tvertical-align:middle;");
    puts("}");
    puts(".wansetup_main_td input[type=checkbox], .wansetup_main_td input[type=radio] {");
    puts("display:inline-block; vertical-align:middle;");
    puts("}");
    printf("input[type=\"text\"] {border:1px #CCC solid;}");
    printf("input[type=\"password\"] {border:1px #CCC solid;}");
    printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td {cursor:default;}");
    v11 = printf("</style>");
    if ( is_mobile_agent(v11) )
    {
      print_div_m_str((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
      v12 = printf("<iframe name=\"hiddenwansetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenwansetup\" \t\t\tframeborder=no width=0 height=0 align=center scrolling=no></iframe>");
      v13 = print_div_m_etr(v12);
    }
    else
    {
      v13 = printf("<iframe name=\"hiddenwansetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenwansetup\" \t\t\tframeborder=no width=0 height=0 align=center scrolling=no></iframe>");
    }
    if ( is_mobile_agent(v13) )
    {
      print_div_m_str((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
      v14 = printf(
              "<iframe name=\"hiddenwanstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenwanstatus&wan=%s\" \t\t"
              "\tframeborder=no width=0 height=0 align=center scrolling=no></iframe>",
              &dest);
      v15 = print_div_m_etr(v14);
    }
    else
    {
      v15 = printf(
              "<iframe name=\"hiddenwanstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenwanstatus&wan=%s\" \t\t"
              "\tframeborder=no width=0 height=0 align=center scrolling=no></iframe>",
              &dest);
    }
    if ( is_mobile_agent(v15) )
    {
      print_div_m_str((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
      v16 = printf("<iframe name=\"hiddenmacsearch_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=netconfmacsearch\" \t\t\tframeborder=no width=0 height=0 align=center scrolling=no></iframe>");
      print_div_m_etr(v16);
    }
    else
    {
      printf("<iframe name=\"hiddenmacsearch_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=netconfmacsearch\" \t\t\tframeborder=no width=0 height=0 align=center scrolling=no></iframe>");
    }
    printf("<table class=\"v3_table wansetup_main_table\" width=\"100%%\">\n");
    print_wansetup_view(v1, (int)&dest);
    print_wansetup_script((int)&dest);
    printf("</table>");
    printf("<script>");
    puts("init_checkform();");
    printf("</script>");
    printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
    puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
    printf("</DIV>");
    puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
    puts("<table width=\"180\" height=\"70\">");
    printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
    puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
    v17 = get_image_dir();
    printf(
      "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
      v17);
    printf("</SPAN></td>");
    printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"wansetup_div_msg\">\n");
    printf("</SPAN></td>");
    printf((const char *)&unk_7D215);
    printf("<DIV id=\"%s\" style=\"display:none;\">", "macsearch_mask");
    printf(
      "<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff"
      ";                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50)"
      ";\" \t\tonclick=\"UnMaskIt(document,'%s');\">\n",
      "macsearch_mask");
    printf("</DIV>");
    puts("<DIV style=\"position:absolute; left:151px; top:128px; width:340px; height:210px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888; overflow:hidden;\" id=\"searchmaclist\">");
    result = printf((const char *)&unk_7D222);
  }
  return result;
}
// 10D18: using guessed type int __fastcall get_netaddr(_DWORD, _DWORD);
// 1121C: using guessed type int __fastcall print_start_main_table(_DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 115DC: using guessed type int __fastcall print_end_main_table(_DWORD);
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);
// 11E10: using guessed type int __fastcall get_usb_tethering_status(_DWORD);

//----- (000266A8) --------------------------------------------------------
int sub_266A8()
{
  int v0; // r1@1
  int v1; // r0@1

  printf("<tr style='background-color: #EEE; height: 24px;'><td>");
  v1 = get_ux_text_common(1216, v0);
  printf("<b style='padding-left: 5px;'>%s</b>", v1);
  printf("</td></tr>");
  printf("<tr style='border-top: 1px solid #CCC;'><td>");
  printf("<iframe name=\"sysconf_syslog_setup\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_syslog_setup\" frameborder=no style='width:100%%; height:120px;'></iframe>");
  return printf("</td></tr>");
}

//----- (00026704) --------------------------------------------------------
int sub_26704()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1
  void *v4; // r5@1
  int v5; // r1@1
  int v6; // r0@1

  printf("<tr><td>");
  puts("<table cellspacing=0px cellpadding=0px style='border-bottom: 1px solid #CCC; height: 24px; background-color: #EEE;'>");
  printf("<colgroup><col width=158px><col width=402px><col width=81px></colgroup>");
  printf("<tr>");
  v1 = get_ux_text_common(1214, v0);
  printf("<td><span style='padding-left: 5px;'>%s</span></td>", v1);
  v3 = get_ux_text_common(1209, v2);
  printf("<td><span>%s</span></td>", v3);
  puts("<td align=right>");
  v4 = get_image_dir();
  v6 = get_ux_text_common(1211, v5);
  printf(
    "<span name=rmlog_bt style='margin-right: 20px; cursor:pointer; width: 65px;' onclick=\"RemoveLog();\"><img src='/%s/"
    "minus_icon.gif' style='margin: 1px;'>%s</span>",
    v4,
    v6);
  printf("</td>");
  printf("</tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<iframe name=\"sysconf_syslog_log\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_syslog_log\" scrolling=yes frameborder=no style='width:100%%; height:336px; border-bottom: 1px solid #CCC;'></iframe>");
  printf("<iframe name=\"sysconf_syslog_log_clear\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_syslog_log_clear\" frameborder=no style='display:none;'></iframe>");
  return printf("</td></tr>");
}

//----- (000267FC) --------------------------------------------------------
int __fastcall sub_267FC(int a1)
{
  int v1; // r5@1
  int result; // r0@1
  int v3; // r0@3
  int v4; // r0@5
  int v5; // r0@7
  int v6; // r6@8
  int v7; // r4@10
  int v8; // r0@14
  int v9; // [sp+0h] [bp-38h]@1

  v1 = a1;
  result = get_value_post(a1, "act", &v9, 32);
  if ( !result )
    return result;
  if ( !strcmp((const char *)&v9, "remove") )
  {
    v3 = syslog_clear();
  }
  else
  {
    if ( !strcmp((const char *)&v9, "sendmail") )
    {
      v4 = syslog_set_sendmail();
      signal_update(v4);
      return 1;
    }
    if ( get_value_post(v1, "log_flag", &v9, 32) )
    {
      v5 = strcmp((const char *)&v9, "on") == 0;
      syslog_set_status(v5);
    }
    v6 = get_value_post(v1, "log_email_chk", &v9, 32);
    if ( v6 )
      v6 = strcmp((const char *)&v9, "on") == 0;
    v7 = get_value_post(v1, "email_hour", &v9, 32);
    if ( v7 )
      v7 = atoi((const char *)&v9);
    if ( get_value_post(v1, "log_rmflag_chk", &v9, 32) )
      strcmp((const char *)&v9, "on");
    v8 = syslog_set_email_status(v6, v7);
    v3 = signal_update(v8);
  }
  signal_save(v3);
  return 1;
}
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10E80: using guessed type int __fastcall syslog_set_status(_DWORD);
// 10F40: using guessed type int syslog_clear(void);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11D2C: using guessed type int __fastcall syslog_set_email_status(_DWORD, _DWORD);
// 11E70: using guessed type int syslog_set_sendmail(void);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);

//----- (00026964) --------------------------------------------------------
int __fastcall sub_26964(int a1)
{
  int v1; // r5@1
  void *v2; // r0@1

  v1 = a1;
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v2 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v2);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:"
    "middle; display:block; text-align:center;\">%s\n",
    v1);
  printf("</SPAN></td>");
  return printf((const char *)&unk_7D215);
}

//----- (00026A14) --------------------------------------------------------
int print_iframe_sysconf_syslog_setup()
{
  printf("<style>");
  printf("body { margin: 0; background-color: #EEE; }");
  printf("form { margin: 0; }");
  printf("tr { height: 24px; }");
  printf("</style>");
  print_js_file((int)"sysconf", (int)"syslog");
  puts("<form method=post action=timepro.cgi name=syslog_fm>");
  printf("<table id='sysconf_syslog_setup_table' cellspacing=0px cellpadding=0px style='width:100%%; padding-left: 5px; border-bottom: 1px solid #CCC;'>\n");
  printf("</table>");
  printf("<iframe name=\"sysconf_syslog_setup_status\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_syslog_setup_status\" frameborder=no style='display:none;'></iframe>");
  return printf("</form>");
}

//----- (00026AA8) --------------------------------------------------------
int __fastcall print_iframe_sysconf_syslog_setup_status(int a1, int a2)
{
  int v2; // r6@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r0@1
  int v7; // r1@1
  char *v8; // r7@2
  int v9; // r0@4
  int v10; // r0@4
  int v11; // r1@4
  char *v12; // r7@5
  int v13; // r0@7
  int v14; // r0@7
  int v15; // r0@7
  int v16; // r1@7
  int v17; // r0@7
  int v18; // r1@7
  int v19; // r8@7
  int v20; // r7@7
  int v21; // r0@7
  int v22; // r0@7
  int v23; // r0@7
  int v24; // r1@7
  int v25; // r0@7
  char *v26; // r1@10
  int v27; // r1@12
  const char *v28; // r0@12
  int v29; // r1@15
  const char *v30; // r0@15
  char *v31; // r1@16
  int v32; // r1@18
  const char *v33; // r0@18
  int v34; // r0@18
  int v35; // r1@18
  int v36; // r0@18
  const char *v37; // r0@18
  int v38; // r1@19
  const char *v39; // r0@19
  int v40; // r0@19
  int v41; // r1@20
  int v42; // r0@20
  char v44; // [sp+4h] [bp-124h]@8
  char v45; // [sp+84h] [bp-A4h]@7
  int v46; // [sp+104h] [bp-24h]@7
  unsigned int v47; // [sp+108h] [bp-20h]@7
  int v48; // [sp+10Ch] [bp-1Ch]@7

  v2 = sub_267FC(a2);
  print_start_main_table(v2);
  puts("<form method=post action=timepro.cgi name=syslog_fm>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=sysconf_syslog_setup_status>");
  puts("<input type=hidden name=act value=>");
  v3 = printf("<table id='sysconf_syslog_setup_table' cellspacing=0px cellpadding=0px style='width:100%%; padding-left: 5px; border-bottom: 1px solid #CCC;'>\n");
  str(v3);
  v5 = get_ux_text_common(1212, v4);
  printf("<td style='width:130px;'><span>%s</span></td>", v5);
  v6 = puts("<td colspan=2>");
  if ( syslog_get_status(v6) )
    v8 = "checked";
  else
    v8 = "";
  v9 = get_ux_text_common(1104, v7);
  printf("<input type=radio id=log_flag_on name=log_flag value=on %s><label for=log_flag_on> %s</label>", v8, v9);
  v10 = print_nbsp(5);
  if ( syslog_get_status(v10) )
    v12 = "";
  else
    v12 = "checked";
  v13 = get_ux_text_common(1112, v11);
  printf("<input type=radio id=log_flag_off name=log_flag value=off %s><label for=log_flag_off> %s</label>", v12, v13);
  v14 = printf("</td>");
  v15 = etr(v14);
  str(v15);
  v17 = get_ux_text_common(1213, v16);
  printf("<td><span>%s</span></td>", v17);
  puts("<td colspan=2>");
  v19 = get_ux_text_common(1203, v18);
  v20 = syslog_get_count();
  v21 = syslog_max_count();
  printf("<span style='padding-left: 4px;'>%s : %d(%d)</span>", v19, v20, v21);
  v22 = printf("</td>");
  v23 = etr(v22);
  str(v23);
  v25 = get_ux_text_common(1208, v24);
  printf("<td><span>%s</span></td>", v25);
  syslog_get_email_status(&v48, &v47, &v46);
  if ( get_admin_email(&v45) && get_smtp_server(&v44) )
  {
    printf("<td>");
    if ( v48 )
      v26 = "checked";
    else
      v26 = "";
    printf(
      "<input type=checkbox id=log_email_chk name=log_email_chk %s style='vertical-align: middle;' onclick='toggleTimeCheckbox();'>",
      v26);
    print_nbsp(1);
    printf("<label for=log_email_chk>");
    v28 = (const char *)get_ux_text_common(1206, v27);
    printf(v28);
    printf("</label>");
    if ( v47 > 0x17 )
      printf("<input type=number id=email_hour name=email_hour min=0 max=23 style='width: 37px; padding-left: 2px; border: 1px solid #CCC;'>");
    else
      printf("<input type=number id=email_hour name=email_hour min=0 max=23 style='width: 37px; padding-left: 2px; border: 1px solid #CCC;' value=%d>");
    printf("<label for=log_email_chk>");
    v30 = (const char *)get_ux_text_common(1207, v29);
    printf(v30);
    printf("</label>");
    printf("</td>");
    printf("<td style='width: 380px;'>");
    if ( v46 )
      v31 = "checked";
    else
      v31 = "";
    printf(
      "<input type=checkbox id=log_rmflag_chk name=\"log_rmflag_chk\" %s style='vertical-align: middle;'>",
      v31,
      "");
    print_nbsp(1);
    printf("<label for=log_rmflag_chk>");
    v33 = (const char *)get_ux_text_common(1205, v32);
    printf(v33);
    v34 = printf("</label>");
    etr(v34);
    printf("<tr style='height:40px;'>");
    printf("<td></td>");
    printf("<td align=left>");
    v36 = get_ux_text_common(1215, v35);
    printf("<input type=button name=\"sendmail_bt\" value=\"%s\" onclick=\"Send_Email();\">", v36);
    printf("</td>");
    v37 = "<td align=right>";
  }
  else
  {
    puts("<td><span style='padding-left: 2px;'>");
    v39 = (const char *)get_ux_text_common(1204, v38);
    printf(v39, "JavaScript:parent.MovePagetoMain('sysconf','login');");
    v40 = printf("</span></td>");
    etr(v40);
    printf("<tr style='height:45px;'>");
    v37 = "<td colspan=2 align=right>";
  }
  puts(v37);
  v42 = get_ux_text_common(35, v41);
  printf("<input type=button name=rmlog_bt value=\"%s\" style='margin-right: 20px;' onclick=\"ApplySyslog();\">", v42);
  printf("</td>");
  printf("</tr>");
  printf("</table>");
  puts("</form>");
  printf("<script>");
  printf("parent.document.getElementById('sysconf_syslog_setup_table').outerHTML = document.getElementById('sysconf_syslog_setup_table').outerHTML;");
  if ( v2 )
    printf("setTimeout(function() { UnMaskIt(parent.parent.document, 'apply_mask'); }, 500);");
  printf("parent.toggleTimeCheckbox();");
  return printf("</script>");
}
// 10490: using guessed type int __fastcall syslog_get_status(_DWORD);
// 10598: using guessed type int __fastcall syslog_get_email_status(_DWORD, _DWORD, _DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 10FAC: using guessed type int syslog_get_count(void);
// 1121C: using guessed type int __fastcall print_start_main_table(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 117F8: using guessed type int syslog_max_count(void);
// 11C90: using guessed type int __fastcall get_smtp_server(_DWORD);
// 11ED0: using guessed type int __fastcall get_admin_email(_DWORD);

//----- (00026E70) --------------------------------------------------------
int print_iframe_sysconf_syslog_log()
{
  int v0; // r4@1
  const char *v1; // r1@3

  v0 = 0;
  printf("<style>");
  printf("body { margin: 0; }");
  printf("form { margin: 0; }");
  printf("tr { height: 24px; }");
  printf(".selected { background-color: #CCCCFF !important; }");
  printf(".highlight { background-color: #E8E8E8 !important; }");
  printf(".highlight_selected { background-color: #BBBBFF !important; }");
  printf("</style>");
  print_js_file((int)"sysconf", (int)"syslog");
  printf((const char *)&unk_86A15);
  printf("<table cellspacing=0px cellpadding=0px style='width:100%%;'>\n");
  do
  {
    if ( v0 & 1 )
      v1 = "#FFF";
    else
      v1 = (const char *)&unk_86952;
    ++v0;
    printf("<tr style='background-color:%s;'><td colspan=2><p name=blanktr>&nbsp;</p></td></tr>", v1);
  }
  while ( v0 != 14 );
  printf("</table>");
  return printf("<iframe name=\"sysconf_syslog_log_status\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_syslog_log_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (00026F54) --------------------------------------------------------
int __fastcall print_iframe_sysconf_syslog_log_status(int a1)
{
  int v1; // r5@1
  int v2; // r0@1
  int v3; // r4@3
  int v4; // r5@3
  const char *v5; // r0@5
  int v6; // r0@9
  int v8; // [sp+4h] [bp-94h]@3
  int v9; // [sp+8h] [bp-90h]@9
  int v10; // [sp+Ch] [bp-8Ch]@4
  int v11; // [sp+14h] [bp-84h]@9
  char v12; // [sp+38h] [bp-60h]@1
  char v13; // [sp+58h] [bp-40h]@3
  void *v14; // [sp+68h] [bp-30h]@1
  size_t v15; // [sp+6Ch] [bp-2Ch]@9
  void *s; // [sp+70h] [bp-28h]@1
  size_t n; // [sp+74h] [bp-24h]@9

  v1 = a1;
  malloc_syslog_string(&s);
  malloc_syslog_string(&v14);
  print_js_file((int)"sysconf", (int)"syslog");
  printf("<div id='syslog_dummy_tr' style='display:none;'>");
  printf((const char *)&unk_86A15);
  printf("<table id='sysconf_syslog_log_table' cellspacing=0px cellpadding=0px style='width:100%%;'>\n");
  v2 = get_value(v1, "logid", &v12, 32);
  if ( v2 )
    v2 = atoi(&v12);
  v3 = v2;
  malloc_syslog_msg_structure(&v13, &v8, v2);
  v4 = 0;
  while ( syslog_read_syslog_msg(&v13, &v8) )
  {
    printf("<tr onclick=\"ChangeToClickColor(this);\" onmouseover=\"ChangeToOverColor(this);\" onmouseout=\"ChangeToOutColor(this)\">");
    printf("<td style=\"height:20px; padding: 0px 10px 0px 5px; width: 134px; \" >%s</td>", v10);
    puts("<td style=\"height:20px; padding: 0px 10px 0px 10px;\" >");
    if ( v8 == 2 )
    {
      v5 = "<span class=\"log_warning_text\">";
    }
    else if ( v8 == 3 )
    {
      v5 = "<span class=\"log_error_text\">";
    }
    else
    {
      v5 = "<span class=\"log_info_text\">";
    }
    puts(v5);
    ++v4;
    memset(s, 0, n);
    memset(v14, 0, v15);
    syslog_decode_text(v11, &v14);
    syslog_convert_syslog_message(&s, &v14);
    print_escape_str((const char *)s);
    v6 = printf("</span></td>");
    etr(v6);
    if ( v3 < v9 )
      v3 = v9;
  }
  free_syslog_string(&s);
  free_syslog_string(&v14);
  free_syslog_msg_structure(&v13, &v8);
  printf("</table>");
  printf("</div>");
  printf("<script>");
  if ( v4 )
  {
    printf("setTRBackgroundColor();");
    printf("parent.document.getElementById('syslog_dummy_tr').outerHTML = document.getElementById('syslog_dummy_tr').innerHTML;");
    printf("DeleteBlankTr();");
  }
  printf((const char *)&unk_86DF7, v3);
  return printf("</script>");
}
// 10940: using guessed type int __fastcall malloc_syslog_msg_structure(_DWORD, _DWORD, _DWORD);
// 10A0C: using guessed type int __fastcall syslog_convert_syslog_message(_DWORD, _DWORD);
// 10F58: using guessed type int __fastcall syslog_decode_text(_DWORD, _DWORD);
// 111BC: using guessed type int __fastcall free_syslog_msg_structure(_DWORD, _DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 112F4: using guessed type int __fastcall free_syslog_string(_DWORD);
// 11420: using guessed type int __fastcall malloc_syslog_string(_DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 12074: using guessed type int __fastcall syslog_read_syslog_msg(_DWORD, _DWORD);

//----- (00027158) --------------------------------------------------------
int __fastcall print_iframe_sysconf_syslog_log_clear(int a1, int a2)
{
  int v2; // r4@1
  int result; // r0@1

  v2 = sub_267FC(a2);
  puts("<form method=post action=timepro.cgi name=syslog_fm>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=sysconf_syslog_log_clear>");
  puts("<input type=hidden name=act value='remove'>");
  result = printf("</form>");
  if ( !v2 )
    return result;
  printf("<script>");
  printf((const char *)&unk_86ED8);
  printf((const char *)&unk_86F34);
  result = printf("</script>");
  return result;
}

//----- (000271E0) --------------------------------------------------------
int sysconf_syslog()
{
  int v0; // r1@1
  int v1; // r0@1

  print_js_file((int)"sysconf", (int)"syslog");
  printf("<table cellspacing=0px cellpadding=0px style='width:100%%;'>\n");
  sub_26704();
  sub_266A8();
  printf("</table>");
  v1 = get_ux_text_common(34, v0);
  return sub_26964(v1);
}

//----- (00027228) --------------------------------------------------------
int sysconf_syslog_0()
{
  int v0; // r1@1
  int v1; // r0@1

  print_js_file((int)"sysconf", (int)"syslog");
  printf("<table cellspacing=0px cellpadding=0px style='width:100%%;'>\n");
  sub_26704();
  sub_266A8();
  printf("</table>");
  v1 = get_ux_text_common(34, v0);
  return sub_26964(v1);
}

//----- (00027270) --------------------------------------------------------
int __fastcall apply_hostscan(int a1)
{
  int v1; // r4@1
  int v2; // r0@1
  int v3; // r3@1
  int v4; // r0@5
  int v5; // r3@5
  int v6; // r0@9
  char v7; // r3@9
  int v8; // r0@13
  char v9; // r3@13
  int v10; // r0@19
  signed int v11; // r3@19
  int v12; // r0@23
  signed int v13; // r3@23
  int v14; // r0@27
  signed int v15; // r3@27
  int v16; // r0@31
  int v17; // r3@31
  int v18; // r0@35
  int v19; // r3@35
  bool v20; // zf@35
  int result; // r0@37

  v1 = a1;
  v2 = istatus_get_intvalue_direct((int)"scan_type");
  *(_DWORD *)v1 = v2;
  if ( v2 == -1 )
    v3 = 0;
  if ( v2 == -1 )
    *(_DWORD *)v1 = v3;
  v4 = istatus_get_intvalue_direct((int)"ping_type");
  *(_DWORD *)(v1 + 4) = v4;
  if ( v4 == -1 )
    v5 = 0;
  if ( v4 == -1 )
    *(_DWORD *)(v1 + 4) = v5;
  v6 = istatus_get_value_direct("ping_addr", v1 + 8);
  if ( v6 == -1 )
    v7 = 0;
  if ( v6 == -1 )
    *(_BYTE *)(v1 + 8) = v7;
  v8 = istatus_get_value_direct("tcp_addr", v1 + 40);
  if ( v8 == -1 )
    v9 = 0;
  if ( v8 == -1 )
    *(_BYTE *)(v1 + 40) = v9;
  if ( istatus_get_value_direct("text_color", v1 + 72) == -1 )
    strcpy((char *)(v1 + 72), "start");
  v10 = istatus_get_intvalue_direct((int)"ping_count");
  *(_DWORD *)(v1 + 104) = v10;
  if ( v10 == -1 )
    v11 = 3;
  if ( v10 == -1 )
    *(_DWORD *)(v1 + 104) = v11;
  v12 = istatus_get_intvalue_direct((int)"ping_datasize");
  *(_DWORD *)(v1 + 108) = v12;
  if ( v12 == -1 )
    v13 = 100;
  if ( v12 == -1 )
    *(_DWORD *)(v1 + 108) = v13;
  v14 = istatus_get_intvalue_direct((int)"ping_timeout");
  *(_DWORD *)(v1 + 112) = v14;
  if ( v14 == -1 )
    v15 = 1;
  if ( v14 == -1 )
    *(_DWORD *)(v1 + 112) = v15;
  v16 = istatus_get_intvalue_direct((int)"tcp_scan_start_port");
  *(_DWORD *)(v1 + 116) = v16;
  if ( v16 == -1 )
    v17 = 0;
  if ( v16 == -1 )
    *(_DWORD *)(v1 + 116) = v17;
  v18 = istatus_get_intvalue_direct((int)"tcp_scan_end_port");
  v20 = v18 == -1;
  *(_DWORD *)(v1 + 120) = v18;
  if ( v18 == -1 )
    v19 = 0;
  result = 0;
  if ( v20 )
    *(_DWORD *)(v1 + 120) = v19;
  return result;
}
// 109B8: using guessed type int __fastcall istatus_get_value_direct(_DWORD, _DWORD);

//----- (000273A8) --------------------------------------------------------
int __fastcall apply_hostscan_0(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r5@1
  int v4; // r0@4
  char *v5; // r1@4
  int v6; // r2@4
  int v7; // r0@9
  int v8; // r3@10
  char *v9; // r0@13
  const char *v10; // r2@13
  int v11; // r3@13
  int v12; // r0@22
  int v14; // [sp+0h] [bp-320h]@13
  int v15; // [sp+4h] [bp-31Ch]@13
  char s; // [sp+10h] [bp-310h]@11
  char s1; // [sp+210h] [bp-110h]@1

  v2 = a2;
  v3 = a1;
  if ( !get_value_post(a1, "act", &s1, 256) )
    return 0;
  get_intvalue_post(v3, (int)"sel", v2);
  if ( *(_DWORD *)v2 )
  {
    if ( *(_DWORD *)v2 != 1 )
      goto LABEL_8;
    get_ip_value_post(v3, "pip", v2 + 40);
    get_intvalue_post(v3, (int)"start", v2 + 116);
    v5 = "end";
    v4 = v3;
    v6 = v2 + 120;
  }
  else
  {
    get_ip_value_post(v3, "ip", v2 + 8);
    get_intvalue_post(v3, (int)"ping_type", v2 + 4);
    get_intvalue_post(v3, (int)"count", v2 + 104);
    get_intvalue_post(v3, (int)"timeout", v2 + 112);
    if ( *(_DWORD *)(v2 + 4) )
      goto LABEL_8;
    v4 = v3;
    v5 = "datasize";
    v6 = v2 + 108;
  }
  get_intvalue_post(v4, (int)v5, v6);
LABEL_8:
  if ( strcmp(&s1, "start") )
  {
    if ( !strcmp(&s1, "stop") )
    {
      strcpy((char *)(v2 + 72), "stop");
      stop_hostscan(1);
    }
    else if ( !strcmp(&s1, "clear") )
    {
      clear_hostscan_log(0);
    }
    goto LABEL_22;
  }
  strcpy((char *)(v2 + 72), "start");
  v7 = stop_hostscan(1);
  if ( *(_DWORD *)v2 )
  {
    if ( *(_DWORD *)v2 != 1 )
      goto LABEL_17;
    v9 = &s;
    v10 = "tcp %s %d %d";
    v14 = *(_DWORD *)(v2 + 116);
    v15 = *(_DWORD *)(v2 + 120);
    v11 = v2 + 40;
  }
  else
  {
    v8 = *(_DWORD *)(v2 + 4);
    if ( !v8 )
    {
      v7 = snprintf(
             &s,
             0x200u,
             "icmp %s %d %d %d",
             v2 + 8,
             *(_DWORD *)(v2 + 104),
             1000 * *(_DWORD *)(v2 + 112),
             *(_DWORD *)(v2 + 108));
LABEL_17:
      clear_hostscan_log(v7);
      start_hostscan(&s);
LABEL_22:
      istatus_set_intvalue_direct("scan_type", *(_DWORD *)v2);
      istatus_set_intvalue_direct("ping_type", *(_DWORD *)(v2 + 4));
      istatus_set_value_direct("ping_addr", v2 + 8);
      istatus_set_value_direct("tcp_addr", v2 + 40);
      istatus_set_value_direct("text_color", v2 + 72);
      istatus_set_intvalue_direct("ping_count", *(_DWORD *)(v2 + 104));
      istatus_set_intvalue_direct("ping_datasize", *(_DWORD *)(v2 + 108));
      istatus_set_intvalue_direct("tcp_scan_start_port", *(_DWORD *)(v2 + 116));
      v12 = istatus_set_intvalue_direct("tcp_scan_end_port", *(_DWORD *)(v2 + 120));
      signal_update(v12);
      return 0;
    }
    if ( v8 != 1 )
      goto LABEL_17;
    v9 = &s;
    v14 = *(_DWORD *)(v2 + 104);
    v10 = "arp %s %d %d";
    v15 = 1000 * *(_DWORD *)(v2 + 112);
    v11 = v2 + 8;
  }
  v7 = snprintf(v9, 0x200u, v10, v11, v14, v15);
  goto LABEL_17;
}
// 10514: using guessed type int __fastcall istatus_set_intvalue_direct(_DWORD, _DWORD);
// 1070C: using guessed type int __fastcall clear_hostscan_log(_DWORD);
// 10B50: using guessed type int __fastcall stop_hostscan(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11948: using guessed type int __fastcall start_hostscan(_DWORD);
// 11A38: using guessed type int __fastcall istatus_set_value_direct(_DWORD, _DWORD);
// 11CF0: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);

//----- (00027688) --------------------------------------------------------
int __fastcall print_hostscan(int a1, int a2)
{
  int v2; // r4@1
  char *v3; // r7@1
  int v4; // r1@1
  int v5; // r0@1
  char *v6; // r1@2
  int v7; // r1@4
  char *v8; // r8@5
  int v9; // r0@7
  int v10; // r1@7
  int v11; // r0@9
  int v12; // r1@9
  int v13; // r0@9
  int v14; // r1@9
  int v15; // r0@9
  int v16; // r1@9
  int v17; // r0@9
  int v18; // r7@9
  int v19; // r1@9
  int v20; // r0@9
  int v21; // r1@9
  int v22; // r0@9
  int v23; // r7@9
  int v24; // r8@9
  int v25; // r1@9
  int v26; // r0@9
  int v27; // r1@9
  int v28; // r0@9
  int v29; // r1@9
  int v30; // r0@9
  int v31; // r1@9
  int v32; // r0@9
  void *v33; // r5@9
  int v34; // r1@9
  int v35; // r0@9
  void *v36; // r5@9
  int v37; // r1@9
  int v38; // r0@9
  int v39; // r1@9
  int v40; // r0@9
  void *v41; // r5@9
  int v42; // r1@9
  int v43; // r0@9
  int v44; // r0@9
  int v45; // r0@10
  int v46; // r0@12
  int v47; // r0@13
  int v48; // r0@13
  int v49; // r0@16
  int result; // r0@16
  const char *v51; // r0@19

  v2 = a2;
  printf("<table class=\"v3_table hostscan_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  puts("<form method=get action=\"timepro.cgi\" name=\"hostscan_fm\">");
  puts("<input type=hidden name=\"tmenu\" value=\"expertconf\">");
  puts("<input type=hidden name=\"smenu\" value=\"hostscan\">");
  printf("<input type=\"hidden\" name=act value\"\">");
  printf("<input type=\"hidden\" name=submitted value\"0\">");
  printf("<COL width=\"130\"><COL width=\"100\"><COL width=\"60\"><COL width=\"80\"><COL width=\"140\"><COL width=\"%%%%\">");
  printf("<tr class=\"hostscan_main_tr\" height=\"24\"><td class=\"hostscan_main_td\">");
  v3 = "selected";
  *(_DWORD *)v2;
  printf("<input type=radio name=sel id=\"sel_ping\" value=%d onclick=\"hostscanRadio_disableForm(0)\" %s>\n");
  v5 = get_ux_text_common(1242, v4);
  printf("<label for=\"sel_ping\">%s</label>", v5);
  printf("</td><td class=\"hostscan_main_td\">");
  if ( *(_DWORD *)v2 )
    v6 = "disabled";
  else
    v6 = "";
  printf("<select class=navi_select name=ping_type onchange=\"hostscanSel_disableForm()\" %s>\n", v6);
  if ( *(_DWORD *)(v2 + 4) )
    v8 = "";
  else
    v8 = "selected";
  v9 = get_ux_text_common(1241, v7);
  printf("<option value=%d %s>%s\n", 0, v8, v9);
  if ( *(_DWORD *)(v2 + 4) != 1 )
    v3 = "";
  v11 = get_ux_text_common(1236, v10);
  printf("<option value=%d %s>%s\n", 1, v3, v11);
  puts("</select>");
  printf("</td><td class=\"hostscan_main_td\" align=\"right\">");
  v13 = get_ux_text_common(442, v12);
  printf("<span class=\"hostscan_main_span\" style='margin-right:5px;'>%s</span>", v13);
  printf("</td><td class=\"hostscan_main_td\" colspan=\"2\">");
  print_html_ip_address((int)"ip", (_BYTE *)(v2 + 8), 1);
  printf("</td><td class=\"hostscan_main_td\"></td></tr>");
  printf("<tr class=\"hostscan_main_tr\" height=\"24\"><td class=\"hostscan_main_td\">");
  printf("</td><td class=\"hostscan_main_td\">");
  v15 = get_ux_text_common(1238, v14);
  printf(
    "<span class=\"hostscan_main_span\">%s \t\t<input type=text class=navi_text class=navimenu_text name=count maxlength="
    "3 size=3 value=%d></span>\n",
    v15,
    *(_DWORD *)(v2 + 104));
  printf("</td><td class=\"hostscan_main_td\" align=\"right\">");
  v17 = get_ux_text_common(1247, v16);
  printf("<span class=\"hostscan_main_span\" style='margin-right:5px;'>%s</span>", v17);
  printf("</td><td class=\"hostscan_main_td\">");
  v18 = *(_DWORD *)(v2 + 112);
  v20 = get_ux_text_common(1083, v19);
  printf("<input type=text class=navi_text name=timeout maxlength=2 size=2 value=%d>%s</span>\n", v18, v20);
  printf("</td><td class=\"hostscan_main_td\" colspan=\"2\">");
  v22 = get_ux_text_common(1239, v21);
  v23 = *(_DWORD *)(v2 + 108);
  v24 = v22;
  v26 = get_ux_text_common(1240, v25);
  printf(
    "<span class=\"hostscan_main_span\">%s \t\t<input type=text class=navi_text name=datasize maxlength=5 size=5 value=%d>%s\n",
    v24,
    v23,
    v26);
  printf("</td></tr>");
  printf("<tr class=\"hostscan_main_tr\" height=\"24\"><td class=\"hostscan_main_td\">");
  *(_DWORD *)v2;
  printf("<input type=radio name=\"sel\" id=\"sel_tcp\" value=%d onclick=\"hostscanRadio_disableForm(1)\" %s>\n");
  v28 = get_ux_text_common(1246, v27);
  printf("<label for=\"sel_tcp\">%s</label>", v28);
  printf("</td><td class=\"hostscan_main_td\" colspan=\"3\">");
  v30 = get_ux_text_common(442, v29);
  printf("<span class=\"hostscan_main_span\">%s", v30);
  print_html_ip_address((int)"pip", (_BYTE *)(v2 + 40), 1);
  printf((const char *)&unk_87601);
  v32 = get_ux_text_common(1243, v31);
  printf(
    "<span class=\"hostscan_main_span\">%s <input type=text class=navi_text name=start maxlength=5 size=5 value=%d>\n",
    v32,
    *(_DWORD *)(v2 + 116));
  printf("~<input type=text class=navi_text name=end maxlength=5 size=5 value=%d></span>\n", *(_DWORD *)(v2 + 120));
  puts("</td></tr>");
  printf("<tr class=\"hostscan_main_tr\" height=\"5\"><td class=\"hostscan_main_td\" colspan=\"6\">");
  printf("</td></tr>");
  printf("<tr class=\"hostscan_main_tr\" height=\"5\" style=\"border-top:1px #CCC solid;\"><td class=\"hostscan_main_td\" colspan=\"6\">");
  printf("</td></tr>");
  printf("<tr class=\"hostscan_main_tr\" height=\"24\"><td class=\"hostscan_main_td\" colspan=\"6\" style=\"padding-left:5px;\">");
  printf("<button type=\"button\" class=\"hostscan_main_button\" style=\"width:55px;\" \t\tonclick=\"hostscanStart(); return ClickEventPropagater();\" id=\"startbtn\">");
  v33 = get_image_dir();
  v35 = get_ux_text_common(1244, v34);
  printf(
    "<span class=\"hostscan_main_span\"><img src=\"/%s/apscan.gif\" style=\"margin-right:5px;\">%s</span>",
    v33,
    v35);
  printf("</button>");
  printf("<button type=\"button\" class=\"hostscan_main_button\" style=\"width:55px; margin-left:10px;\" \t\tonclick=\"hostscanStop(); return ClickEventPropagater();\" id=\"stopbtn\">");
  v36 = get_image_dir();
  v38 = get_ux_text_common(1112, v37);
  printf(
    "<span class=\"hostscan_main_span\"><img src=\"/%s/minus_icon.gif\" style=\"margin-right:5px;\">%s</span>",
    v36,
    v38);
  printf("</button>");
  printf("</td></tr>");
  printf("<tr class=\"hostscan_main_tr\" height=\"5\" style=\"border-bottom:1px #CCC solid;\"><td class=\"hostscan_main_td\" colspan=\"6\">");
  printf("</td></tr>");
  printf("<tr class=\"hostscan_main_tr\" height=\"24\" style=\"background-color:#DBDBDB; border-top:1px #ccc solid; border-bottom:1px #ccc solid;\">\t\t<td class=\"hostscan_main_td\" colspan=\"4\">");
  v40 = get_ux_text_common(1245, v39);
  printf(
    "<p class=\"hostscan_main_p\"><b>%s</b></p></td><td class=\"hostscan_main_td\" colspan=\"2\" align=\"right\" style=\""
    "padding-right:15px;\">",
    v40);
  v41 = get_image_dir();
  v43 = get_ux_text_common(1237, v42);
  printf(
    "<span class=\"hostscan_main_span\" onclick=\"hostscanClear();\" style=\"cursor:pointer;\">\t\t<img src=\"/%s/minus_i"
    "con.gif\" style=\"margin-right:5px;\">%s</span>",
    v41,
    v43);
  printf("</td></tr>");
  printf("</form>");
  v44 = printf("<tr class=\"hostscan_main_tr\" height=\"360\" style=\"border-bottom:1px #CCC solid;\">\t\t<td class=\"hostscan_main_td\" colspan=\"6\">");
  if ( is_mobile_agent(v44) )
  {
    print_div_m_str((int)"360", (int)"100%%", (int)"display:inline-block; *display:inline; zoom:1;");
    v45 = printf("<iframe name=\"hostscanlist_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hostscanlist\"                         frameborder=no width=100%% height=360 align=center scrolling=no></iframe>");
    print_div_m_etr(v45);
  }
  else
  {
    printf("<iframe name=\"hostscanlist_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hostscanlist\"                         frameborder=no width=100%% height=360 align=center scrolling=no></iframe>");
  }
  printf("</td></tr>");
  v46 = printf("</table>");
  if ( is_mobile_agent(v46) )
  {
    print_div_m_str((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v47 = printf("<iframe name=\"hostscanstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hostscanstatus\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    v48 = print_div_m_etr(v47);
  }
  else
  {
    v48 = printf("<iframe name=\"hostscanstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hostscanstatus\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  if ( is_mobile_agent(v48) )
  {
    print_div_m_str((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v49 = printf("<iframe name=\"hostscansubmit_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hostscansubmit\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    result = print_div_m_etr(v49);
  }
  else
  {
    result = printf("<iframe name=\"hostscansubmit_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hostscansubmit\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  if ( *(_DWORD *)v2 )
  {
    if ( *(_DWORD *)v2 != 1 )
      return result;
    puts("<script language=JavaScript>");
    v51 = "hostscanRadio_disableForm(1);";
  }
  else
  {
    puts("<script language=JavaScript>");
    puts("hostscanRadio_disableForm(0);");
    v51 = "hostscanSel_disableForm();";
  }
  puts(v51);
  puts("init_hostscan();");
  return puts("</script>");
}
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (00027BF4) --------------------------------------------------------
int print_iframe_hostscanlist()
{
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:auto;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_hostscanlist\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=hostscanlist>");
  printf("<div id=\"hostscan_list\" style=\"height:360px; overflow:auto;\">");
  printf("</div>");
  printf("</form>");
  return printf("</BODY>");
}

//----- (00027C5C) --------------------------------------------------------
int print_iframe_hostscanstatus()
{
  int v0; // r6@1
  char *v1; // r7@2
  int v2; // r1@2
  int v3; // r0@3
  char *v4; // r7@3
  int v5; // r1@3
  int v6; // r0@3
  char *v7; // r7@3
  int v8; // r1@3
  int v9; // r0@3
  char *v10; // r7@3
  int v11; // r1@3
  int v12; // r8@3
  int v13; // r10@3
  int v14; // r1@3
  int v15; // r7@3
  int v16; // r0@3
  char *v17; // r4@3
  int v18; // r1@3
  int v19; // r5@3
  int v20; // r1@3
  int v21; // r0@3
  int v22; // r1@3
  int v23; // r3@3
  int v24; // r2@3
  const char *v25; // r0@3
  int v26; // r1@4
  int v27; // r0@5
  char *v28; // r7@5
  int v29; // r1@5
  int v30; // r0@5
  char *v31; // r7@5
  int v32; // r1@5
  int v33; // r0@5
  char *v34; // r4@5
  int v35; // r1@5
  int v36; // r5@5
  int v37; // r7@5
  int v38; // r1@5
  int v39; // r4@5
  int v40; // r1@7
  int v41; // r0@8
  char *v42; // r7@8
  int v43; // r1@8
  int v44; // r0@8
  char *v45; // r7@8
  int v46; // r1@8
  int v47; // r0@8
  char *v48; // r0@8
  FILE *v49; // r7@9
  signed int v50; // r4@10
  signed int v51; // r4@11
  const char *v52; // r1@13
  const char *v53; // r1@19
  const char *v54; // r1@25
  char s; // [sp+4h] [bp-124h]@1
  char v57; // [sp+84h] [bp-A4h]@1
  char *save_ptr; // [sp+104h] [bp-24h]@2

  v0 = get_hostscan(&v57);
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_hostscanstatus\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=hostscanstatus>");
  printf("<div id=\"statline\">");
  printf("<table name=\"listtable\" class=\"v3_table hostscan_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  get_hostscan(&s);
  printf(
    "<tr height=\"24\" class=\"hostscan_main_tr\" style=\"background-color:#%s;\"><td class=\"hostscan_main_td\"><p class"
    "=\"hostscan_main_p\">",
    "FFFFFF");
  if ( s )
  {
    v1 = strtok_r(&s, " ", &save_ptr);
    if ( !strcmp(v1, "icmp") )
    {
      v3 = get_ux_text_common(1241, v2);
      printf("%s PING\t", v3);
      v4 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v6 = get_ux_text_common(442, v5);
      printf("%s:%s\t", v6, v4);
      v7 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v9 = get_ux_text_common(1238, v8);
      printf("%s:%s\t", v9, v7);
      v10 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v12 = get_ux_text_common(1247, v11);
      v13 = atoi(v10);
      v15 = get_ux_text_common(1083, v14);
      v16 = calc_mask(v13, 1000);
      printf("%s:%d%s\t", v12, v16, v15);
      v17 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v19 = get_ux_text_common(1239, v18);
      v21 = get_ux_text_common(1240, v20);
      v22 = v19;
      v23 = v21;
      v24 = (int)v17;
      v25 = "%s:%s%s\t";
LABEL_6:
      printf(v25, v22, v24, v23);
      goto LABEL_9;
    }
    if ( !strcmp(v1, "arp") )
    {
      v27 = get_ux_text_common(1236, v26);
      printf("%s PING\t", v27);
      v28 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v30 = get_ux_text_common(442, v29);
      printf("%s:%s\t", v30, v28);
      v31 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v33 = get_ux_text_common(1238, v32);
      printf("%s:%s\t", v33, v31);
      v34 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v36 = get_ux_text_common(1247, v35);
      v37 = atoi(v34);
      v39 = get_ux_text_common(1083, v38);
      v24 = calc_mask(v37, 1000);
      v25 = "%s:%d%s\t";
      v22 = v36;
      v23 = v39;
      goto LABEL_6;
    }
    if ( !strcmp(v1, "tcp") )
    {
      v41 = get_ux_text_common(1246, v40);
      printf("%s\t", v41);
      v42 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v44 = get_ux_text_common(442, v43);
      printf("%s:%s\t", v44, v42);
      v45 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v47 = get_ux_text_common(1243, v46);
      printf("%s:%s~", v47, v45);
      v48 = strtok_r(0, " ", &save_ptr);
      printf("%s\t", v48);
    }
  }
LABEL_9:
  printf("</p></td></tr>");
  v49 = fopen("/var/log/hostscan.log", "rb");
  if ( v49 )
  {
    v50 = 1;
    while ( fgets(&s, 128, v49) )
    {
      if ( strcmp(&s, "\n") )
      {
        if ( v50 & 1 )
          v53 = "F7F7F7";
        else
          v53 = "FFFFFF";
        ++v50;
        printf(
          "<tr height=\"24\" class=\"hostscan_main_tr\" style=\"background-color:#%s;\"><td class=\"hostscan_main_td\"><p"
          " class=\"hostscan_main_p\">",
          v53);
        printf("%s", &s);
        printf("</p></td></tr>");
      }
    }
    while ( v50 <= 14 )
    {
      if ( v50 & 1 )
        v54 = "F7F7F7";
      else
        v54 = "FFFFFF";
      ++v50;
      printf(
        "<tr height=\"24\" class=\"hostscan_main_tr\" style=\"background-color:#%s;\"><td class=\"hostscan_main_td\"><p c"
        "lass=\"hostscan_main_p\">",
        v54);
      printf("</p></td></tr>");
    }
    fclose(v49);
  }
  else
  {
    v51 = 1;
    do
    {
      if ( v51 & 1 )
        v52 = "F7F7F7";
      else
        v52 = "FFFFFF";
      ++v51;
      printf(
        "<tr height=\"24\" class=\"hostscan_main_tr\" style=\"background-color:#%s;\"><td class=\"hostscan_main_td\"><p c"
        "lass=\"hostscan_main_p\">",
        v52);
      printf("</p></td></tr>");
    }
    while ( v51 != 15 );
  }
  printf("</table>");
  printf("</div>");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  printf("if(parent.window.init_hostscan_status)parent.window.init_hostscan_status(document, %d);", v0);
  return printf("</script>");
}
// 1148C: using guessed type int __fastcall get_hostscan(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);

//----- (00028168) --------------------------------------------------------
int __fastcall print_iframe_hostscansubmit(int a1, int a2)
{
  int v2; // r5@1
  char v4; // [sp+4h] [bp-8Ch]@1

  v2 = a2;
  apply_hostscan((int)&v4);
  apply_hostscan_0(v2, (int)&v4);
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_hostscansubmit\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=hostscansubmit>");
  printf("</form>");
  printf("</BODY>");
  return printf("<script>if(parent.window.init_hostscan_submit)parent.window.init_hostscan_submit();</script>");
}

//----- (000281E8) --------------------------------------------------------
int __fastcall expertconf_hostscan(int a1)
{
  int v1; // r5@1
  void *v2; // r0@1
  char v4; // [sp+4h] [bp-94h]@1

  v1 = a1;
  apply_hostscan((int)&v4);
  print_js_file((int)"expertconf", (int)"hostscan");
  puts("<style type=\"text/css\">");
  puts(".hostscan_main_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".hostscan_main_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".hostscan_main_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".hostscan_main_p {");
  puts("\tpadding:0 0 0 5px; display:inline-block;");
  puts("\tvertical-align:middle; margin:0;");
  puts("}");
  puts(".hostscan_main_span {");
  puts("\tdisplay:inline-block; vertical-align:middle;");
  puts("}");
  puts(".hostscan_main_button {");
  puts("\tpadding:0 1px 0 1px; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".hostscan_main_td input[type=checkbox], .hostscan_main_td input[type=radio] {");
  puts("display:inline-block; vertical-align:middle;");
  puts("}");
  puts("#hostscan_div_msg p {");
  puts("margin:5px 0 5px 15px; text-align:left;");
  puts("}");
  puts(".hostscan_ellipsis {");
  puts("text-overflow:ellipsis; overflow:hidden; white-space:nowrap; text-align:left;");
  puts("}");
  printf("input[type=\"text\"] {border:1px #CCC solid;}");
  printf("input[type=\"password\"] {border:1px #CCC solid;}");
  printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td {cursor:default;}");
  printf("</style>");
  print_hostscan(v1, (int)&v4);
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v2 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v2);
  printf("</SPAN></td>");
  printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"hostscan_div_msg\">\n");
  printf("</SPAN></td>");
  return printf((const char *)&unk_7D215);
}

//----- (0002845C) --------------------------------------------------------
int __fastcall sub_2845C(int a1, int a2)
{
  int v2; // r2@1
  int v3; // r3@1
  int result; // r0@2

  v2 = *(_DWORD *)(a1 + 168);
  v3 = *(_DWORD *)(a2 + 168);
  if ( v2 == v3 )
    result = *(_DWORD *)(a1 + 172);
  else
    result = v2 - v3;
  if ( v2 == v3 )
    result -= *(_DWORD *)(a2 + 172);
  return result;
}

//----- (0002847C) --------------------------------------------------------
signed int __fastcall sub_2847C(unsigned int a1, int a2)
{
  unsigned int v2; // r4@1
  signed int result; // r0@2
  const char *v4; // r0@4
  const char *v5; // r0@11
  int v6; // [sp+4h] [bp-14h]@1

  v6 = a2;
  v2 = a1;
  if ( a1 <= 1 )
  {
    get_active_wl(a1, 0, &v6);
    if ( v2 == 1 )
      v4 = "eth1";
    else
      v4 = "eth2";
    if ( get_ifexist(v4) )
    {
      if ( v6 )
      {
        result = 3;
      }
      else
      {
        if ( v2 == 1 )
          v5 = "eth1";
        else
          v5 = "eth2";
        if ( wireless_api_get_run(v5) )
        {
          if ( wireless_get_multibridge_enable(v2) )
            result = 6;
          else
            result = 0;
        }
        else
        {
          result = 4;
        }
      }
    }
    else
    {
      result = 2;
    }
  }
  else
  {
    result = 1;
  }
  return result;
}
// 10448: using guessed type int __fastcall wireless_get_multibridge_enable(_DWORD);
// 10BA4: using guessed type int __fastcall wireless_api_get_run(_DWORD);
// 11810: using guessed type int __fastcall get_active_wl(_DWORD, _DWORD, _DWORD);
// 11978: using guessed type int __fastcall get_ifexist(_DWORD);

//----- (0002850C) --------------------------------------------------------
int onoffswitch()
{
  puts("<style type=\"text/css\">");
  puts(".onoffswitch {");
  puts("display:inline-block; *display:inline; zoom:1; vertical-align:middle; position:relative; width:45px;");
  puts("-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; border:1px #999999 solid;");
  puts("-webkit-border-radius:20px; -moz-border-radius:20px; -khtml-border-radius:20px; -ms-border-radius:20px; border-radius:20px;");
  puts("}");
  puts(".onoffswitch-checkbox {");
  puts("display:none;");
  puts("}");
  puts(".onoffswitch-label {");
  puts("display:block; overflow:hidden; cursor:pointer;");
  puts("border-radius:20px;");
  puts("-webkit-border-radius:20px; -moz-border-radius:20px; -khtml-border-radius:20px; -ms-border-radius:20px;");
  puts("}");
  puts(".onoffswitch-inner {");
  printf("display:block; width:200%%; margin-left:-100%%;\n");
  puts("transition:margin 0.3s ease-in 0s;");
  puts("}");
  puts(".onoffswitch-inner:before, .onoffswitch-inner:after {");
  printf("display:block; float:left; width:50%%; height:20px; padding:0; line-height:20px; font-size:10px; color:white;\n");
  puts("font-family:Trebuchet, Arial, sans-serif; font-weight:bold; box-sizing:border-box;");
  puts("}");
  puts(".onoffswitch-inner:before {");
  puts("content: \"On\"; padding-left:5px; background-color:#FFFFFF; color:#000000;");
  puts("}");
  puts(".onoffswitch-inner:after {");
  puts("content: \"Off\"; padding-right:8px; text-align:right; background-color:#FFFFFF; color:#CCCCCC;");
  puts("}");
  puts(".onoffswitch-switch {");
  puts("display:block; width:12px; margin:4px; background:#999999; position:absolute; top:0; bottom:0; right:24px;");
  puts("-webkit-border-radius:20px; -moz-border-radius:20px; -khtml-border-radius:20px; -ms-border-radius:20px;");
  puts("border:1px solid #999999; border-radius:20px; transition:all 0.3s ease-in 0s;");
  puts("}");
  puts((const char *)&unk_88AA2);
  puts("margin-left:0;");
  puts("}");
  puts((const char *)&unk_88AF9);
  puts("right:0px; background:#8DAF25;");
  puts("}");
  return puts("</style>");
}

//----- (000286D4) --------------------------------------------------------
int sub_286D4()
{
  puts("<style type=\"text/css\">");
  puts(".wl_mbssid_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".wl_mbssid_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0; height:24px;");
  puts("}");
  puts(".wl_mbssid_title {");
  puts("\tborder-top:1px #ccc solid; border-bottom:1px #ccc solid; padding:0 0 0 0; height:24px;");
  puts("}");
  puts(".wl_mbssid_title p{");
  puts("\tfont-weight:bold;");
  puts("}");
  puts(".wl_mbssid_td {");
  puts("\tpadding:0 0 0 5px; font-size:12px;");
  puts("\tvertical-align:middle; cursor:pointer;");
  puts("}");
  puts(".wl_mbssid_button {");
  puts("\tpadding:0 1px 0 1px; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".wl_mbssid_div {");
  puts((const char *)&unk_88CC6);
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".wl_mbssid_p {");
  puts((const char *)&unk_88CC6);
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".wl_opacity_30 {");
  puts("\topacity:0.3;");
  puts("\t-moz-opacity:0.3;");
  puts("\t-khtml-opacity:0.3;");
  puts("\tfilter:alpha(opacity=30);");
  puts("}");
  printf("input[type=\"text\"] {border:1px #CCC solid;}");
  printf("input[type=\"password\"] {border:1px #CCC solid;}");
  printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span {cursor:default;}");
  printf("td, tr, span, p{-ms-user-select:none; -moz-user-select:none; -khtml-user-select:none; -webkit-user-select:none; user-select:none;}");
  return printf("</style>");
}

//----- (000288A8) --------------------------------------------------------
int __fastcall sub_288A8(int a1)
{
  int v1; // r5@1
  const char *v2; // r1@1
  signed int v3; // r0@4
  char *v4; // r4@7
  char *v5; // r1@9
  signed int v6; // r4@9
  int v7; // r0@9
  int result; // r0@9
  int i; // r8@11
  char *v10; // r1@15
  int v11; // r6@17
  char *v12; // r1@17
  int v13; // r10@17
  int v14; // r3@18
  char *v15; // r1@25
  int v16; // r6@27
  int v17; // r10@27
  char *v18; // r12@27
  char *v19; // r1@29
  int v20; // ST04_4@31
  char *v21; // ST0C_4@31
  char *v22; // r7@34
  int v23; // [sp+0h] [bp-560h]@18
  int v24; // [sp+0h] [bp-560h]@28
  int v25; // [sp+10h] [bp-550h]@13
  signed int v26; // [sp+14h] [bp-54Ch]@6
  char v27[1272]; // [sp+18h] [bp-548h]@13
  int v28; // [sp+518h] [bp-48h]@3

  v1 = a1;
  v2 = "eth2";
  if ( a1 == 1 )
    v2 = "eth1";
  sf_strncpy(&v28, v2, 32);
  if ( !strcmp((const char *)&v28, "eth1") )
    v3 = 80;
  else
    v3 = 40;
  v26 = v3;
  if ( v1 )
    v4 = "5g";
  else
    v4 = "2g";
  printf("var control_channel_arr%s = [];\n", v4);
  v5 = v4;
  v6 = 20;
  v7 = printf("var central_channel_arr%s = [];\n", v5);
  result = make_country_names(v7);
  do
  {
    if ( v6 != 60 )
    {
      for ( i = 0; ; i += 16 )
      {
        v22 = (char *)&country_names + i;
        if ( !*(_DWORD *)((char *)&country_names + i) )
          break;
        result = wireless_get_channel_list(&v28, *((_DWORD *)v22 + 1), v6, v27);
        v25 = result;
        if ( result )
        {
          if ( v1 )
            v10 = "5g";
          else
            v10 = "2g";
          v11 = 0;
          printf("control_channel_arr%s['%s_%d'] = new Array();\n", v10, *((_DWORD *)v22 + 1), v6);
          v13 = 0;
          while ( v13 < v25 )
          {
            v23 = v13;
            v14 = *(_DWORD *)&v27[v11];
            ++v13;
            v11 += 20;
            if ( v1 )
              v12 = "5g";
            if ( !v1 )
              v12 = "2g";
            printf("control_channel_arr%s['%s_%d'][%d] = parseInt(%d);\n", v12, *((_DWORD *)v22 + 1), v6, v23, v14);
          }
          if ( v1 )
            v15 = "5g";
          else
            v15 = "2g";
          v16 = 0;
          result = printf("central_channel_arr%s['%s_%d'] = new Array();\n", v15, *((_DWORD *)v22 + 1), v6);
          v17 = 0;
          v18 = v27;
          while ( v17 < v25 )
          {
            v24 = v17;
            if ( v1 )
              v19 = "5g";
            else
              v19 = "2g";
            ++v17;
            v20 = *(_DWORD *)&v18[v16 + 4];
            v16 += 20;
            v21 = v18;
            result = printf(
                       "central_channel_arr%s['%s_%d'][%d] = parseInt(%d);\n",
                       v19,
                       *((_DWORD *)v22 + 1),
                       v6,
                       v24,
                       v20);
            v18 = v21;
          }
        }
      }
    }
    v6 += 20;
  }
  while ( v6 <= v26 );
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10CE8: using guessed type int __fastcall make_country_names(_DWORD);
// 10F04: using guessed type int __fastcall wireless_get_channel_list(_DWORD, _DWORD, _DWORD, _DWORD);
// 288A8: using guessed type char var_548[1272];

//----- (00028A9C) --------------------------------------------------------
int __fastcall print_iframe_wpsstatus_0(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r4@1
  int v4; // r0@2
  int result; // r0@3
  const char *v6; // r0@5
  int v7; // r1@5
  int v8; // [sp+4h] [bp-14h]@1

  v8 = a2;
  v2 = a1;
  v3 = a2;
  if ( wireless_get_wps_status(0, &v8) == 3 )
  {
    v4 = 0;
  }
  else
  {
    result = wireless_get_wps_status(v3, &v8);
    if ( !result )
      return result;
    if ( v2 )
    {
      v6 = "wps_5g_ts";
      v7 = 0;
    }
    else
    {
      v6 = "wps_2g_ts";
      v7 = 0;
    }
    istatus_set_intvalue_direct(v6, v7);
    v4 = v3;
  }
  return wireless_wps_stop_signal(v4);
}
// 10514: using guessed type int __fastcall istatus_set_intvalue_direct(_DWORD, _DWORD);
// 1109C: using guessed type int __fastcall wireless_wps_stop_signal(_DWORD);
// 11AD4: using guessed type int __fastcall wireless_get_wps_status(_DWORD, _DWORD);

//----- (00028B04) --------------------------------------------------------
int __fastcall sub_28B04(int a1, int a2, int a3, char a4, int a5)
{
  int v5; // r4@1
  int v6; // r5@1
  int v7; // r6@1
  char *v8; // r2@3
  bool v9; // zf@3
  const char *v10; // r1@3
  char *v11; // r0@3
  int v12; // r10@5
  int v13; // r12@7
  int v14; // r1@11
  int v15; // r3@11
  int v16; // r7@12
  char *v17; // r9@12
  const char *v18; // r8@12
  int v19; // ST08_4@16
  int v20; // r7@17
  char *v21; // r8@17
  char *v22; // r9@19
  int v23; // ST08_4@21
  int v24; // r11@22
  const char *v25; // r9@23
  void *v26; // r0@25
  const char *v27; // r1@26
  char *v28; // r7@29
  char *v29; // r1@30
  const char *v30; // r10@33
  const char *v31; // r7@39
  char *v32; // r8@43
  void *v33; // r0@45
  const char *v34; // r2@45
  void *v35; // ST0C_4@47
  const char *v36; // ST10_4@47
  int v37; // ST1C_4@47
  void *v39; // [sp+4h] [bp-44h]@35
  int v40; // [sp+Ch] [bp-3Ch]@0

  v5 = a1;
  v6 = a2;
  v7 = a3;
  if ( a1 )
  {
    v8 = "";
    v9 = a2 == 0;
    v10 = "F7F7F7";
    v11 = "name=\"GUESTS\"";
    if ( v9 )
      v11 = "";
    v12 = a4 & 1;
    if ( !(a4 & 1) )
      v10 = "FFFFFF";
    v13 = a5 == 0;
    if ( !v6 )
      v13 = 0;
    if ( v13 )
      v8 = "display:none;";
    printf(
      "<tr class=\"wl_mbssid_tr\" id=\"BSSID_%d_%d_%d\" %s style=\"background-color:#%s; %s\">",
      v7,
      v6,
      *(_DWORD *)(v5 + 1200),
      v11,
      v10,
      v8);
    v15 = *(_DWORD *)v5;
    if ( v6 )
    {
      v20 = *(_DWORD *)(v5 + 1200);
      v21 = "B4B4B4";
      if ( v15 )
        v21 = "#000000";
      v22 = "5";
      if ( !v20 )
        v22 = "2.4";
      v23 = get_ux_text_common(1459, v14);
      printf(
        "<td class=\"wl_mbssid_td\" align=\"left\" width=\"160\" style=\"color:%s;\" \t\t\tonclick=\"Clicked_Multibssid(d"
        "ocument.multibssid_fm, document.getElementById('BSSID_%d_%d_%d'));\">%s GHz %s %d</td>",
        v21,
        v7,
        v6,
        v20,
        v22,
        v23,
        v6);
    }
    else
    {
      v16 = *(_DWORD *)(v5 + 1200);
      v17 = "5";
      v18 = "#B4B4B4";
      if ( v15 )
        v18 = "#000000";
      if ( !v16 )
        v17 = "2.4";
      v19 = get_ux_text_common(1456, v14);
      printf(
        "<td class=\"wl_mbssid_td\" align=\"left\" width=\"160\" style=\"color:%s;\" \t\t\tonclick=\"Clicked_Multibssid(d"
        "ocument.multibssid_fm, document.getElementById('BSSID_%d_%d_%d'));\">%s GHz %s</td>",
        v18,
        v7,
        0,
        v16,
        v17,
        v19,
        v40);
    }
    v24 = *(_DWORD *)(v5 + 1200);
    if ( *(_DWORD *)v5 )
      v25 = "#000000";
    else
      v25 = "#B4B4B4";
    v26 = getTags((const char *)(v5 + 4));
    printf(
      "<td class=\"wl_mbssid_td\" align=\"left\" width=\"270\" style=\"color:%s;\" \t\t\tonclick=\"Clicked_Multibssid(doc"
      "ument.multibssid_fm, document.getElementById('BSSID_%d_%d_%d'));\">\t\t\t<span class=\"wl_mbssid_p\" \t\t\t\tstyle"
      "=\"overflow:hidden; text-overflow:ellipsis; white-space:nowrap; width:260px; \t\t\t\tvertical-align:middle;\">%s</span></td>",
      v25,
      v7,
      v6,
      v24,
      v26);
    if ( *(_DWORD *)v5 )
      v27 = "#000000";
    else
      v27 = "#B4B4B4";
    printf(
      "<td class=\"wl_mbssid_td\" align=\"left\" width=\"100\" style=\"color:%s;\" \t\t\tonclick=\"Clicked_Multibssid(doc"
      "ument.multibssid_fm, document.getElementById('BSSID_%d_%d_%d'));\">",
      v27,
      v7,
      v6,
      *(_DWORD *)(v5 + 1200));
    if ( !v6 )
    {
      v28 = "2G";
      if ( *(_DWORD *)(v5 + 1200) )
        v29 = "5G";
      else
        v29 = "2G";
      printf(
        "<table class=\"v3_table wl_mbssid_table\" style=\"width:100px; display:none; vertical-align:middle;\" \t\t\t\tid"
        "=\"WPSSTATUS_LINE%s\">",
        v29);
      printf("<COL width=\"22\"><COL width=\"78\">");
      if ( v12 )
        v30 = "F7F7F7";
      else
        v30 = "FFFFFF";
      v39 = get_image_dir();
      if ( *(_DWORD *)(v5 + 1200) )
        v28 = "5G";
      printf(
        "<tr class=\"wl_mbssid_tr\" style=\"background-color:#%s;\" id=\"BSSID_%d_%d_%d_wps\"><td class=\"wl_mbssid_td\">"
        "\t\t\t\t<img src=\"/%s/apply_ani.gif\" style=\"width:18px; height:18px;\"></td>\t\t\t\t<td class=\"wl_mbssid_td\""
        "><p class=\"wl_mbssid_p\" id=\"WPSSTATUS_TEXT%s\"></p></td></tr>",
        v30,
        v7,
        0,
        *(_DWORD *)(v5 + 1200),
        v39,
        v28);
      printf("</table>");
    }
    printf("</td>");
    get_image_dir();
    if ( *(_DWORD *)(v5 + 164) )
    {
      v31 = "wifi_lock.png";
    }
    else
    {
      v31 = "wifi_lock.png";
      if ( !wireless_check_8021x_enabled(v5) )
        v31 = "wifi_unlock.png";
    }
    if ( *(_DWORD *)v5 )
      v32 = "";
    else
      v32 = "wl_opacity_30";
    v33 = get_image_dir();
    v34 = "trigger_off.png";
    if ( *(_DWORD *)v5 )
      v34 = "trigger_on.png";
    v35 = v33;
    v36 = v34;
    v37 = *(_DWORD *)(v5 + 1200);
    printf(
      "<td class=\"wl_mbssid_td\" align=\"right\" style=\"padding-right:5px;\" \t\t\tonclick=\"Clicked_Multibssid(documen"
      "t.multibssid_fm, document.getElementById('BSSID_%d_%d_%d'));\">\t\t\t<img src=\"/%s/%s\" style=\"vertical-align:mi"
      "ddle; display:inline-block; *display:inline; zoom:1;\" class=\"%s\">\t\t\t<img src=\"/%s/%s\" id=\"bssid_%d_%d_%d_"
      "run\" style=\"vertical-align:middle; display:inline-block; *display:inline; zoom:1;\" \t\t\tonclick=\"onclick_bssi"
      "d_onoff(this); ClickEventPropagater(event); return false;\"></td>",
      v7,
      v6);
    printf(
      "<input type=\"hidden\" name=\"bssid_%d_%d_%d_run_hidden\" value=\"%d\">",
      v7,
      v6,
      *(_DWORD *)(v5 + 1200),
      *(_DWORD *)v5,
      v31,
      v32,
      v35,
      v36,
      v7,
      v6,
      v37);
  }
  else
  {
    printf("<tr class=\"wl_mbssid_tr\" name=\"GUESTS\" style=\"background-color:#%s; %s\">");
    printf("<td colspan=\"4\">-</td>");
  }
  return printf("</tr>");
}
// 1175C: using guessed type int __fastcall wireless_check_8021x_enabled(_DWORD);

//----- (00028E74) --------------------------------------------------------
char *__fastcall print_iframe_multibssid_0(int a1, int a2, int a3)
{
  int v3; // r6@1
  int v4; // r4@1
  int v5; // r5@1
  const char *v6; // r1@1
  const char *v7; // r2@4
  char *result; // r0@6
  int v9; // [sp+0h] [bp-570h]@3
  int v10; // [sp+578h] [bp+8h]@3

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = "eth2";
  if ( a1 == 1 )
    v6 = "eth1";
  sf_strncpy(&v10, v6, 32);
  read_wireless_conf(&v9, &v10);
  if ( v3 == 1 )
    v7 = "ipTIME 5G Guest%d";
  else
    v7 = "ipTIME Guest%d";
  snprintf((char *)(v4 + 4), 0x7Fu, v7, v5);
  *(_DWORD *)(v4 + 1200) = v3;
  *(_DWORD *)(v4 + 1392) = v5;
  result = convert_auth_enc("nouse", 0, (signed int *)(v4 + 160), (_DWORD *)(v4 + 164));
  *(_DWORD *)(v4 + 932) = 1;
  *(_DWORD *)(v4 + 156) = 1;
  *(_DWORD *)(v4 + 1384) = 1812;
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 107CC: using guessed type int __fastcall read_wireless_conf(_DWORD, _DWORD);

//----- (00028F2C) --------------------------------------------------------
int __fastcall sub_28F2C(_DWORD *a1, _DWORD *a2, char *a3)
{
  int v3; // r7@1
  _DWORD *v4; // r5@1
  _DWORD *v5; // r4@1
  char *v6; // r6@1
  _DWORD *v7; // r10@1
  int v8; // r8@1
  size_t v9; // ST04_4@3

  v3 = 0;
  v4 = a1;
  v5 = a2;
  v6 = a3;
  v7 = a2;
  v8 = 0;
  while ( v8 < *v5 )
  {
    if ( v7[54] == *v4 )
    {
      v9 = strlen((const char *)&v5[53 * v8 + 12]);
      if ( strlen(v6) + v9 <= 0x1F5 )
      {
        strcat(v6, (const char *)&v5[53 * v8 + 12]);
        strcat(v6, ",");
      }
      ++v3;
    }
    ++v8;
    v7 += 53;
  }
  if ( *v6 )
    v6[strlen(v6) - 1] = 0;
  return v3;
}

//----- (00028FF4) --------------------------------------------------------
int __fastcall print_iframe_searchwireless(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r8@4
  int v4; // r5@4
  const char *v5; // r1@5
  test_case *v6; // r7@8
  int *v7; // r5@8
  int v8; // r8@8
  char *v9; // r6@8
  int v10; // r1@11
  char *v11; // r4@12
  int v12; // r0@16
  char *v13; // r4@17
  int v14; // ST10_4@21
  int v15; // r1@21
  int v16; // r2@21
  int v17; // r3@21
  char *v18; // r2@22
  int v19; // r0@24
  char *v20; // r3@28
  char *v21; // r0@28
  int v22; // r1@29
  char *v23; // ST14_4@31
  int v24; // r3@32
  char *v25; // r1@33
  char *v26; // ST14_4@37
  int v27; // ST10_4@37
  int v28; // r4@37
  int v29; // r1@37
  int v30; // r0@37
  int *v31; // r4@40
  int v32; // r6@40
  test_case *v33; // r10@40
  char *v34; // r5@40
  char *v35; // r7@45
  int v36; // r0@47
  char *v37; // r7@48
  int v38; // r11@52
  int v39; // r1@52
  int v40; // r2@52
  int v41; // r3@52
  char *v42; // r3@53
  int v43; // r0@55
  char *v44; // r11@59
  char *v45; // r0@59
  int v46; // r1@60
  char *v47; // ST10_4@62
  int v48; // r7@63
  char *v49; // r1@64
  char *v50; // ST14_4@68
  int v51; // r11@68
  int v52; // r1@68
  int v53; // r0@68
  int v55; // r3@73
  int v56; // r2@73
  int v57; // r1@73
  int v58; // [sp+18h] [bp-7E0h]@8
  int v59; // [sp+18h] [bp-7E0h]@52
  int v60; // [sp+1Ch] [bp-7DCh]@8
  int v61; // [sp+20h] [bp-7D8h]@21
  int v62; // [sp+20h] [bp-7D8h]@52
  int v63; // [sp+24h] [bp-7D4h]@21
  char v64[4]; // [sp+2Ch] [bp-7CCh]@8
  int v65; // [sp+34h] [bp-7C4h]@8
  int v66; // [sp+52Ch] [bp-2CCh]@32
  int v67; // [sp+72Ch] [bp-CCh]@3
  int v68; // [sp+76Ch] [bp-8Ch]@2
  int v69; // [sp+78Ch] [bp-6Ch]@1
  int v70; // [sp+7ACh] [bp-4Ch]@4
  int v71; // [sp+7CCh] [bp-2Ch]@4
  char v72; // [sp+7D0h] [bp-28h]@8

  v2 = a2;
  sub_286D4();
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"wl_searchiframe\" style=\"padding:0; margin:0;\">");
  printf("<input type=\"hidden\" name=\"tmenu\" value=\"iframe\">");
  printf("<input type=\"hidden\" name=\"smenu\" value=\"wlsearch\">");
  printf("<input type=\"hidden\" name=\"act\" value=\"\">");
  printf("<input type=\"hidden\" name=\"country\" value=\"\">");
  printf("<input type=\"hidden\" name=\"bw\" value=\"\">");
  printf("<input type=\"hidden\" name=\"wlmode\" value=\"\">");
  printf("</form>");
  printf("</BODY>");
  if ( !get_value_post(v2, "wlmode", &v69, 32)
    || !get_value_post(v2, "bw", &v68, 32)
    || !get_value_post(v2, "country", &v67, 64) )
  {
    return printf("<script>parent.iframe_searchwireless = true;</script>");
  }
  v3 = atoi((const char *)&v68);
  v4 = atoi((const char *)&v69);
  if ( !get_active_wl(v4, &v70, &v71) )
  {
    v5 = "eth2";
    if ( v4 == 1 )
      v5 = "eth1";
    sf_strncpy(&v70, v5, 32);
  }
  wireless_api_start_ap_scan(&v70);
  sleep(0xAu);
  v6 = (test_case *)malloc(0xD430u);
  memset(v6, 0, 0xD430u);
  sf_strncpy(&v6->field_8, &v70, 32);
  sf_strncpy(&v6->field_40, &v67, 8);
  wireless_api_get_ap_list(v6);
  wireless_api_stop_ap_scan(&v70);
  qsort(&v6->field_48, v6->field_0, 0xD4u, (__compar_fn_t)sub_2845C);
  v60 = wireless_get_channel_list(&v6->field_8, &v6->field_40, v3, v64);
  v58 = wireless_api_get_best_channel(v64, v60, v6);
  v7 = &v65;
  v8 = 0;
  puts((const char *)&unk_5E7E9);
  puts("function MakeSearchTable(){");
  puts("var obj = parent.document.getElementById('searchwllist');");
  puts("var lobj = parent.document.getElementById('loadingwllist');");
  puts("var HTMLStr = '<div style=\\\"display:block; width:420px; height:210px; overflow:auto;\\\">';");
  puts("HTMLStr += '<table class=\\\"wl_mbssid_table\\\" style=\\\"height:210px; overflow:auto; overflow-x:hidden; -ms-overflow-x:hidden; max-height:210px; display:block;\\\">';");
  printf("HTMLStr += '<COL width=\\\"140\\\"><COL width=\\\"%%%%\\\">';\n");
  v9 = &v72 + 20 * v58;
  while ( v8 < v60 )
  {
    if ( *(v7 - 2) == *((_DWORD *)v9 - 489) && *(v7 - 1) == *((_DWORD *)v9 - 488) )
    {
      printf(
        "HTMLStr += '<tr class=\\\"wl_mbssid_tr\\\" style=\\\"height:48px; background-color:#%s;\\\" \t\t\tonclick=\\\"Se"
        "lectSearchResult(\\'%d.%d\\');\\\" onmouseover=\\\"ChangeToOverColor(this);\\\" onmouseout=\\\"ChangeToOutColor("
        "this);\\\">\t\t\t<td class=\\\"wl_mbssid_td\\\" style=\\\"border-bottom:1px #CCC solid;\\\">';\n",
        "F7F7F7");
      if ( *(v7 - 2) == *((_DWORD *)v9 - 489) )
      {
        if ( *(v7 - 1) == *((_DWORD *)v9 - 488) )
          v11 = "";
        else
          v11 = "color:#AAA;";
      }
      else
      {
        v11 = "color:#AAA;";
      }
      v12 = get_ux_text_common(1455, v10);
      printf(
        "HTMLStr += '<p class=\\\"wl_mbssid_p\\\" style=\\\"cursor:default; margin-left:10px; font-size:16px; %s;\\\">%s %d</p>';",
        v11,
        v12,
        *(v7 - 2));
      puts("HTMLStr += '</td><td class=\\\"wl_mbssid_td\\\" style=\\\"border-bottom:1px #CCC solid;\\\">';");
      puts("HTMLStr += '<table class=\\\"wl_mbssid_table\\\" height=\\\"48px\\\"><tr class=\\\"wl_mbssid_tr\\\" height=\\\"24px\\\">\t\t\t\t<td class=\\\"wl_mbssid_td\\\">';");
      if ( *(v7 - 2) == *((_DWORD *)v9 - 489) )
      {
        if ( *(v7 - 1) == *((_DWORD *)v9 - 488) )
          v13 = "";
        else
          v13 = "color:#AAA;";
      }
      else
      {
        v13 = "color:#AAA;";
      }
      v14 = *v7;
      v61 = calc_mask(*v7, 1000);
      sub_5B744(v14, 0x3E8u);
      v16 = *(v7 - 2);
      v17 = *(v7 - 1);
      v63 = v15;
      if ( v16 == v17 )
      {
        v18 = "";
      }
      else
      {
        if ( v16 <= v17 )
          v19 = 1367;
        else
          v19 = 570;
        v18 = (char *)get_ux_text_common(v19, v15);
      }
      if ( *(v7 - 2) == *((_DWORD *)v9 - 489) )
      {
        v22 = *(v7 - 1);
        if ( v22 == *((_DWORD *)v9 - 488) )
        {
          v23 = v18;
          v21 = (char *)get_ux_text_common(1518, v22);
          v18 = v23;
          v20 = "-";
        }
        else
        {
          v21 = "";
          v20 = "";
        }
      }
      else
      {
        v20 = "";
        v21 = "";
      }
      printf(
        "HTMLStr += '<p class=\\\"wl_mbssid_p\\\" \t\t\tstyle=\\\" cursor:default; width:260px; white-space:nowrap; text-"
        "overflow:ellipsis; overflow:hidden; font-size:12px; %s;\\\">\t\t\t\t%d.%d GHz %s %s %s</p>';\n",
        v13,
        v61,
        v63,
        v18,
        v20,
        v21);
      puts("HTMLStr += '</td></tr><tr class=\\\"wl_mbssid_tr\\\" height=\\\"24px\\\"><td class=\\\"wl_mbssid_td\\\">';");
      memset(&v66, 0, 0x200u);
      v24 = sub_28F2C(&v64[20 * v8], v6, (char *)&v66);
      if ( *(v7 - 2) == *((_DWORD *)v9 - 489) )
      {
        if ( *(v7 - 1) == *((_DWORD *)v9 - 488) )
          v25 = "";
        else
          v25 = "color:#AAA;";
      }
      else
      {
        v25 = "color:#AAA;";
      }
      v26 = v25;
      v27 = v24;
      v28 = get_ux_text_common(1474, (int)v25);
      v30 = get_ux_text_common(1473, v29);
      printf(
        "HTMLStr += '<p class=\\\"wl_mbssid_p\\\" \t\t\tstyle=\\\"cursor:default; width:260px; white-space:nowrap; text-o"
        "verflow:ellipsis; overflow:hidden; font-size:12px; %s;\\\">\t\t\t\t%s(%d%s) : %s';\n",
        v26,
        v28,
        v27,
        v30,
        &v66);
      puts("HTMLStr += '</td></tr></table>';");
      puts("HTMLStr += '</td></tr>';");
    }
    ++v8;
    v7 += 5;
  }
  v31 = &v65;
  v32 = 0;
  v33 = v6;
  v34 = &v72 + 20 * v58;
  while ( v32 < v60 )
  {
    if ( *(v31 - 2) != *((_DWORD *)v34 - 489) || *(v31 - 1) != *((_DWORD *)v34 - 488) )
    {
      v55 = *(v31 - 1);
      v56 = *(v31 - 2);
      printf("HTMLStr += '<tr class=\\\"wl_mbssid_tr\\\" style=\\\"height:48px; background-color:#%s;\\\" \t\t\tonclick=\\\"SelectSearchResult(\\'%d.%d\\');\\\" onmouseover=\\\"ChangeToOverColor(this);\\\" onmouseout=\\\"ChangeToOutColor(this);\\\">\t\t\t<td class=\\\"wl_mbssid_td\\\" style=\\\"border-bottom:1px #CCC solid;\\\">';\n");
      if ( *(v31 - 2) == *((_DWORD *)v34 - 489) )
      {
        if ( *(v31 - 1) == *((_DWORD *)v34 - 488) )
          v35 = "";
        else
          v35 = "color:#AAA;";
      }
      else
      {
        v35 = "color:#AAA;";
      }
      v36 = get_ux_text_common(1455, v57);
      printf(
        "HTMLStr += '<p class=\\\"wl_mbssid_p\\\" style=\\\"cursor:default; margin-left:10px; font-size:16px; %s;\\\">%s %d</p>';",
        v35,
        v36,
        *(v31 - 2));
      puts("HTMLStr += '</td><td class=\\\"wl_mbssid_td\\\" style=\\\"border-bottom:1px #CCC solid;\\\">';");
      puts("HTMLStr += '<table class=\\\"wl_mbssid_table\\\" height=\\\"48px\\\"><tr class=\\\"wl_mbssid_tr\\\" height=\\\"24px\\\">\t\t\t\t<td class=\\\"wl_mbssid_td\\\">';");
      if ( *(v31 - 2) == *((_DWORD *)v34 - 489) )
      {
        if ( *(v31 - 1) == *((_DWORD *)v34 - 488) )
          v37 = "";
        else
          v37 = "color:#AAA;";
      }
      else
      {
        v37 = "color:#AAA;";
      }
      v38 = *v31;
      v59 = calc_mask(*v31, 1000);
      sub_5B744(v38, 0x3E8u);
      v40 = *(v31 - 2);
      v41 = *(v31 - 1);
      v62 = v39;
      if ( v40 == v41 )
      {
        v42 = "";
      }
      else
      {
        if ( v40 <= v41 )
          v43 = 1367;
        else
          v43 = 570;
        v42 = (char *)get_ux_text_common(v43, v39);
      }
      if ( *(v31 - 2) == *((_DWORD *)v34 - 489) )
      {
        v46 = *(v31 - 1);
        v44 = "-";
        if ( v46 == *((_DWORD *)v34 - 488) )
        {
          v47 = v42;
          v45 = (char *)get_ux_text_common(1518, v46);
          v42 = v47;
        }
        else
        {
          v44 = "";
          v45 = "";
        }
      }
      else
      {
        v44 = "";
        v45 = "";
      }
      printf(
        "HTMLStr += '<p class=\\\"wl_mbssid_p\\\" \t\t\tstyle=\\\"cursor:default; width:260px; white-space:nowrap; text-o"
        "verflow:ellipsis; overflow:hidden; font-size:12px; %s;\\\">\t\t\t\t%d.%d GHz %s %s %s</p>';\n",
        v37,
        v59,
        v62,
        v42,
        v44,
        v45);
      puts("HTMLStr += '</td></tr><tr class=\\\"wl_mbssid_tr\\\" height=\\\"24px\\\"><td class=\\\"wl_mbssid_td\\\">';");
      memset(&v66, 0, 0x200u);
      v48 = sub_28F2C(&v64[20 * v32], v33, (char *)&v66);
      if ( *(v31 - 2) == *((_DWORD *)v34 - 489) )
      {
        if ( *(v31 - 1) == *((_DWORD *)v34 - 488) )
          v49 = "";
        else
          v49 = "color:#AAA;";
      }
      else
      {
        v49 = "color:#AAA;";
      }
      v50 = v49;
      v51 = get_ux_text_common(1474, (int)v49);
      v53 = get_ux_text_common(1473, v52);
      printf(
        "HTMLStr += '<p class=\\\"wl_mbssid_p\\\" \t\t\tstyle=\\\"cursor:default; width:260px; white-space:nowrap; text-o"
        "verflow:ellipsis; overflow:hidden; font-size:12px; %s;\\\">\t\t\t\t%s(%d%s) : %s';\n",
        v50,
        v51,
        v48,
        v53,
        &v66);
      puts("HTMLStr += '</td></tr></table>';");
      puts("HTMLStr += '</td></tr>';");
    }
    ++v32;
    v31 += 5;
  }
  puts("HTMLStr += '</table></div>';");
  puts("obj.innerHTML = HTMLStr;");
  puts("lobj.style.display = 'none';");
  puts("obj.style.display = 'block';");
  puts("}");
  puts("MakeSearchTable();");
  puts("</script>");
  return printf("<script>parent.iframe_searchwireless = true;</script>");
}
// 105A4: using guessed type int __fastcall wireless_api_start_ap_scan(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10874: using guessed type int __fastcall wireless_api_get_ap_list(_DWORD);
// 10AA8: using guessed type int __fastcall wireless_api_get_best_channel(_DWORD, _DWORD, _DWORD);
// 10F04: using guessed type int __fastcall wireless_get_channel_list(_DWORD, _DWORD, _DWORD, _DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11810: using guessed type int __fastcall get_active_wl(_DWORD, _DWORD, _DWORD);
// 118A0: using guessed type int __fastcall wireless_api_stop_ap_scan(_DWORD);
// 28FF4: using guessed type char var_7CC[4];

//----- (000297B0) --------------------------------------------------------
int __fastcall print_iframe_multibssid(int a1, int a2)
{
  void *v2; // r0@1
  int v3; // r10@1
  int v4; // r4@1
  int *v5; // r6@3
  int v6; // r5@3
  int *v7; // r0@4
  int v8; // r5@6
  int v9; // r0@14
  int *v10; // r1@14
  char *v11; // r7@19
  int v12; // r6@19
  char *v13; // r0@20
  int v14; // r7@22
  int v15; // r0@30
  char *v16; // r1@30
  int *v17; // r11@35
  char *v18; // r8@35
  int v19; // r1@35
  int v20; // r6@35
  void *v21; // r2@35
  int v22; // r1@35
  signed int v23; // r6@35
  char *v24; // r0@37
  int v25; // r1@37
  int v26; // r2@37
  int v27; // r9@42
  int *v28; // r8@43
  signed int v29; // r6@43
  int *v30; // r7@43
  int *v31; // r0@45
  int v32; // r1@45
  int v33; // r2@45
  char v34; // r3@49
  const char *v35; // r0@52
  int *v36; // r1@53
  int v38; // [sp+0h] [bp-31D8h]@37
  int v39; // [sp+0h] [bp-31D8h]@45
  signed int v40; // [sp+Ch] [bp-31CCh]@32
  signed int v41; // [sp+10h] [bp-31C8h]@16
  int v42; // [sp+14h] [bp-31C4h]@1
  char s[5544]; // [sp+18h] [bp-31C0h]@19
  int v44; // [sp+15F8h] [bp-1BE0h]@3
  int v45; // [sp+2020h] [bp-11B8h]@43
  int v46; // [sp+2BD8h] [bp-600h]@7
  int v47; // [sp+3148h] [bp-90h]@9
  int v48; // [sp+3150h] [bp-88h]@3
  int v49; // [sp+3170h] [bp-68h]@1
  int v50; // [sp+3190h] [bp-48h]@1
  int v51; // [sp+31A0h] [bp-38h]@1
  int v52; // [sp+31B0h] [bp-28h]@14

  v42 = a2;
  memset(&v51, 0, 0x10u);
  v2 = memset(&v50, 0, 0x10u);
  v3 = wireless_api_get_max_mbss(v2);
  sub_286D4();
  onoffswitch();
  print_js_file((int)"wirelessconf", (int)"basicsetup");
  v4 = get_value_post(v42, "opened", &v49, 32);
  if ( v4 )
    v4 = atoi((const char *)&v49);
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  v5 = &v44;
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"multibssid_fm\" style=\"padding:0; margin:0;\">");
  v6 = 0;
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"multibssid\">");
  printf("<input type=hidden name=\"action\" value=\"\">");
  printf("<input type=hidden name=\"clicked_bg\" value=\"\">");
  printf("<input type=hidden name=\"clicked_id\" value=\"\">");
  printf("<input type=hidden name=\"opened\" value=\"%d\">", v4);
  printf("<table class=\"v3_table wl_mbssid_table\">");
  printf("<COL WIDTH=\"160\"><COL WIDTH=\"270\"><COL WIDTH=\"100\"><COL WIDTH=\"%%%%\">");
  sf_strncpy(&v48, "eth2", 32);
  while ( v6 < v3 )
  {
    v7 = v5;
    ++v6;
    v5 += 350;
    memset(v7, 0, 0x578u);
  }
  v8 = 0;
  do
  {
    if ( v8 >= v3 )
    {
      v41 = 1;
      goto LABEL_19;
    }
    memset(&v46, 0, 0x578u);
    if ( !read_mbssid_conf(v8, &v46) )
    {
      v41 = 1;
      goto LABEL_19;
    }
    if ( v8 && !v47 )
      v47 = v8;
    if ( v47 < 0 || v47 > v3 )
      v47 = v8;
    v9 = v8;
    v10 = &v44 + 350 * v47;
    *(&v52 + v47 - 8) = v8++;
    read_mbssid_conf(v9, v10);
    *(&v52 + 350 * v47 - 1426) = v47;
  }
  while ( !wireless_get_multibridge_enable(0) );
  v41 = 0;
LABEL_19:
  sf_strncpy(&v48, "eth1", 32);
  v11 = s;
  v12 = 0;
  while ( v12 < v3 )
  {
    v13 = v11;
    ++v12;
    v11 += 1400;
    memset(v13, 0, 0x578u);
  }
  v14 = 0;
  do
  {
    if ( v14 >= v3 )
    {
      v40 = 1;
      goto LABEL_35;
    }
    memset(&v46, 0, 0x578u);
    if ( !read_mbssid_conf(v14 + 65536, &v46) )
    {
      v40 = 1;
      goto LABEL_35;
    }
    if ( v14 && !v47 )
      v47 = v14;
    if ( v47 < 0 || v47 > v3 )
      v47 = v14;
    v15 = v14 + 65536;
    v16 = &s[1400 * v47];
    *(&v52 + v47 - 4) = v14++;
    read_mbssid_conf(v15, v16);
    *(&v52 + 350 * v47 - 2826) = v47;
  }
  while ( !wireless_get_multibridge_enable(1) );
  v40 = 0;
LABEL_35:
  sub_28B04((int)s, 0, v51, 0, v4);
  sub_28B04((int)&v44, 0, v50, 1, v4);
  v17 = &v51;
  v18 = &s[2600];
  printf(
    "<tr class=\"wl_mbssid_tr\" style=\"background-color:#%s;\" \t\tonclick=\"toggle_guests(document.getElementsByName('G"
    "UESTS'), document.getElementById('timg'));\">",
    "FFFFFF");
  printf("<td colspan=\"4\" class=\"wl_mbssid_td\">");
  v20 = get_ux_text_common(1475, v19);
  v21 = get_image_dir();
  v22 = v20;
  v23 = 1;
  printf(
    "<p style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle; margin:0; padding:0;\">%s</p>\t\t<i"
    "mg id=\"timg\" src=\"/%s/menu_list_%s.png\" \t\tstyle=\"display:inline-block; *display:inline; zoom:1; height:14px; "
    "vertical-align:middle; margin-left:5px; width:16px;\">",
    v22,
    v21);
  printf("</td></tr>");
  while ( 1 )
  {
    v27 = v23 + 2;
    if ( v23 >= v3 )
      break;
    if ( v40 )
    {
      if ( !*((_DWORD *)v18 + 48) )
      {
        *((_DWORD *)v18 + 48) = v23;
        *(_DWORD *)v18 = 1;
        v17[1] = v14;
        snprintf(&s[1400 * v23 + 4], 0x7Fu, "ipTIME 5G Guest%d", *((_DWORD *)v18 + 48));
      }
      v38 = v4;
      v25 = v23;
      v24 = &s[1400 * v23];
      v26 = v17[1];
    }
    else
    {
      v24 = 0;
      v38 = v4;
      v25 = v23;
      v26 = 0;
    }
    ++v23;
    ++v17;
    v18 += 1400;
    sub_28B04((int)v24, v25, v26, v27, v38);
  }
  v28 = &v50;
  v29 = 1;
  v30 = &v45;
  while ( v29 < v3 )
  {
    if ( v41 )
    {
      if ( !v30[48] )
      {
        v30[48] = v29;
        *v30 = 0;
        v28[1] = v8;
        snprintf((char *)&v44 + 1400 * v29 + 4, 0x7Fu, "ipTIME Guest%d", v30[48]);
      }
      v39 = v4;
      v31 = &v44 + 350 * v29;
      v33 = v28[1];
      v32 = v29;
    }
    else
    {
      v31 = 0;
      v39 = v4;
      v32 = v29;
      v33 = 0;
    }
    v34 = v27;
    ++v29;
    ++v27;
    ++v28;
    v30 += 350;
    sub_28B04((int)v31, v32, v33, v34, v39);
  }
  printf((const char *)&unk_97FC6);
  if ( get_value_post(v42, "action", &v49, 32) )
  {
    if ( !v40 || !get_value_post(v42, "clicked_id", &v49, 32) )
    {
      printf(
        "\n<script>Clicked_Multibssid(document.multibssid_fm, document.getElementById('%s%d'));</script>\n",
        "BSSID_0_0_",
        1);
      goto LABEL_61;
    }
    v35 = "\n<script>Clicked_Multibssid(document.multibssid_fm, document.getElementById('%s'));</script>\n";
    v36 = &v49;
  }
  else
  {
    v35 = "<script>init_multibssid(%d);</script>";
    if ( v4 )
      v36 = (int *)216;
    else
      v36 = (int *)72;
  }
  printf(v35, v36);
LABEL_61:
  printf("</BODY>");
  return printf("<script>parent.iframe_multibssid = true;</script>");
}
// 10424: using guessed type int __fastcall wireless_api_get_max_mbss(_DWORD);
// 10448: using guessed type int __fastcall wireless_get_multibridge_enable(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11990: using guessed type int __fastcall read_mbssid_conf(_DWORD, _DWORD);
// 297B0: using guessed type char s[5544];

//----- (00029E08) --------------------------------------------------------
int __fastcall print_iframe_hiddenwlsetup(int a1, int a2)
{
  int v2; // r4@1
  const char *v3; // r0@1
  int result; // r0@2
  int v5; // r7@4
  const char *v6; // r1@5
  signed int v7; // r5@9
  int v8; // r11@13
  int v9; // r10@13
  char *v10; // r1@14
  int v11; // r5@16
  unsigned int v12; // r0@31
  unsigned int v13; // r0@34
  unsigned int v14; // r0@37
  char *v15; // r3@41
  unsigned int v16; // r2@42
  bool v17; // cf@42
  bool v18; // zf@42
  signed int v19; // r6@45
  signed int v20; // t1@45
  char *v21; // r0@46
  char *v22; // r0@51
  unsigned int v23; // r0@54
  int *v24; // r1@58
  signed int v25; // r2@58
  char *v26; // r0@58
  int v27; // r8@88
  int v28; // r8@91
  int v29; // r0@94
  int v30; // r2@94
  char *v31; // r3@94
  unsigned int v32; // r0@100
  unsigned int v33; // r0@103
  unsigned int v34; // r0@108
  unsigned int v35; // r0@111
  unsigned int v36; // r0@114
  int v37; // r8@117
  unsigned int v38; // r0@120
  int v39; // r0@124
  int v40; // r0@129
  int v41; // r6@130
  int v42; // r11@131
  unsigned int v43; // r5@133
  const char *v44; // r1@135
  int v45; // r8@137
  int v46; // r10@137
  int v47; // r0@144
  int v48; // r8@146
  int v49; // r8@147
  int v50; // r6@150
  void *v51; // r0@160
  int v52; // r1@160
  char *v53; // r2@160
  int v54; // r0@167
  int v55; // r0@169
  signed int v56; // r1@172
  int v57; // r6@175
  char *v58; // r1@176
  bool v59; // zf@181
  int v60; // r0@185
  signed int v61; // r3@188
  const char *v62; // r0@191
  signed int v63; // r1@198
  unsigned int v64; // r2@202
  bool v65; // cf@202
  bool v66; // zf@202
  const char *v67; // r0@213
  int c; // [sp+4h] [bp-125Ch]@132
  char v69; // [sp+8h] [bp-1258h]@18
  int v70; // [sp+Ch] [bp-1254h]@21
  int v71; // [sp+8Ch] [bp-11D4h]@88
  int v72; // [sp+90h] [bp-11D0h]@24
  int v73; // [sp+94h] [bp-11CCh]@24
  unsigned int v74; // [sp+A4h] [bp-11BCh]@35
  int v75; // [sp+A8h] [bp-11B8h]@40
  int v76; // [sp+ACh] [bp-11B4h]@40
  char v77; // [sp+138h] [bp-1128h]@63
  int v78; // [sp+1B0h] [bp-10B0h]@80
  int v79; // [sp+1BCh] [bp-10A4h]@82
  int v80; // [sp+1C0h] [bp-10A0h]@86
  int v81; // [sp+1CCh] [bp-1094h]@84
  int v82; // [sp+3A4h] [bp-EBCh]@91
  unsigned int v83; // [sp+3ACh] [bp-EB4h]@32
  int v84; // [sp+3B0h] [bp-EB0h]@69
  int v85; // [sp+3B4h] [bp-EACh]@72
  unsigned int v86; // [sp+3B8h] [bp-EA8h]@109
  unsigned int v87; // [sp+3C0h] [bp-EA0h]@112
  int v88; // [sp+3D4h] [bp-E8Ch]@94
  unsigned int v89; // [sp+420h] [bp-E40h]@101
  int v90; // [sp+428h] [bp-E38h]@106
  unsigned int v91; // [sp+42Ch] [bp-E34h]@104
  int v92; // [sp+434h] [bp-E2Ch]@106
  int v93; // [sp+4B8h] [bp-DA8h]@20
  unsigned int v94; // [sp+4C4h] [bp-D9Ch]@29
  int v95; // [sp+4C8h] [bp-D98h]@125
  int v96; // [sp+4D0h] [bp-D90h]@53
  int v97; // [sp+4F0h] [bp-D70h]@58
  unsigned int v98; // [sp+570h] [bp-CF0h]@55
  unsigned int v99; // [sp+574h] [bp-CECh]@115
  int v100; // [sp+578h] [bp-CE8h]@76
  int v101; // [sp+57Ch] [bp-CE4h]@127
  int v102; // [sp+580h] [bp-CE0h]@12
  int v103; // [sp+584h] [bp-CDCh]@160
  unsigned int v104; // [sp+604h] [bp-C5Ch]@187
  int v105; // [sp+608h] [bp-C58h]@154
  int v106; // [sp+60Ch] [bp-C54h]@162
  int v107; // [sp+61Ch] [bp-C44h]@180
  int v108; // [sp+620h] [bp-C40h]@175
  int v109; // [sp+624h] [bp-C3Ch]@175
  int v110; // [sp+6B0h] [bp-BB0h]@180
  int v111; // [sp+728h] [bp-B38h]@185
  int v112; // [sp+734h] [bp-B2Ch]@185
  int v113; // [sp+738h] [bp-B28h]@185
  int v114; // [sp+744h] [bp-B1Ch]@185
  int v115; // [sp+91Ch] [bp-944h]@187
  int v116; // [sp+924h] [bp-93Ch]@167
  int v117; // [sp+928h] [bp-938h]@167
  int v118; // [sp+92Ch] [bp-934h]@169
  int v119; // [sp+930h] [bp-930h]@185
  int v120; // [sp+938h] [bp-928h]@185
  int v121; // [sp+94Ch] [bp-914h]@165
  int v122; // [sp+998h] [bp-8C8h]@185
  int v123; // [sp+9A4h] [bp-8BCh]@185
  int v124; // [sp+A3Ch] [bp-824h]@185
  int v125; // [sp+A40h] [bp-820h]@185
  int v126; // [sp+A48h] [bp-818h]@175
  int v127; // [sp+A68h] [bp-7F8h]@175
  int v128; // [sp+AECh] [bp-774h]@185
  int v129; // [sp+AF0h] [bp-770h]@150
  int v130; // [sp+AF8h] [bp-768h]@7
  int v131; // [sp+C0Ch] [bp-654h]@189
  int v132; // [sp+C58h] [bp-608h]@188
  int v133; // [sp+EA4h] [bp-3BCh]@13
  char v134; // [sp+1000h] [bp-260h]@161
  int v135; // [sp+10A4h] [bp-1BCh]@13
  int v136; // [sp+1124h] [bp-13Ch]@2
  char v137; // [sp+1180h] [bp-E0h]@176
  int v138; // [sp+11A4h] [bp-BCh]@175
  char v139; // [sp+11E3h] [bp-7Dh]@41
  int v140; // [sp+11E4h] [bp-7Ch]@41
  int v141; // [sp+1204h] [bp-5Ch]@7
  int v142; // [sp+1224h] [bp-3Ch]@156

  v2 = a2;
  v3 = (const char *)get_parameter_value(a1, "wlmode");
  if ( !v3 )
  {
    result = get_value_post(v2, "wlmode", &v136, 128);
    if ( !result )
      return result;
    v3 = (const char *)&v136;
  }
  v5 = atoi(v3);
  if ( v5 == 1 )
    v6 = "eth1";
  else
    v6 = "eth2";
  sf_strncpy(&v141, v6, 32);
  get_si("hw", &v130);
  memset(&v136, 0, 0x80u);
  if ( !get_value_post(v2, "action", &v136, 128) )
    goto LABEL_12;
  if ( !strcmp((const char *)&v136, "changebssid") )
  {
    v7 = 2;
    goto LABEL_145;
  }
  if ( strcmp((const char *)&v136, "allsubmit") )
  {
    if ( strcmp((const char *)&v136, "bssidonoff") )
    {
LABEL_12:
      v7 = 1;
      read_wireless_conf(&v102, &v141);
LABEL_219:
      v50 = 0;
LABEL_154:
      v49 = v105;
      if ( v105 )
        v49 = 0;
      else
        wireless_api_get_current_channelspec(&v141, &v142);
      goto LABEL_157;
    }
    if ( !get_value_post(v2, "wlmode", &v135, 128) )
      goto LABEL_221;
    v41 = atoi((const char *)&v135);
    if ( !get_value_post(v2, "sidx", &v135, 128) )
      goto LABEL_221;
    v42 = atoi((const char *)&v135);
    if ( !get_value_post(v2, "uiidx", &v135, 128) )
      goto LABEL_221;
    c = atoi((const char *)&v135);
    if ( !get_value_post(v2, "run", &v135, 128) )
      goto LABEL_221;
    v43 = atoi((const char *)&v135);
    if ( v43 > 1 )
      goto LABEL_221;
    if ( v41 == 1 )
      v44 = "eth1";
    else
      v44 = "eth2";
    sf_strncpy(&v140, v44, 32);
    print_iframe_wpsstatus_0(v41, (int)&v140);
    v45 = v42 + (v41 << 16);
    v46 = read_mbssid_conf(v45, &v69);
    if ( !v46 )
      print_iframe_multibssid_0(v41, (int)&v69, c);
    *(_DWORD *)&v69 = v43;
    if ( v46 )
    {
      if ( !v42 )
      {
        set_active_wl(&v140, v41);
        write_wireless_conf(&v69, &v140);
        set_wireless_conf(&v69, &v140);
LABEL_144:
        v47 = signal_start("fwsched");
        signal_save(v47);
LABEL_221:
        v7 = 5;
        goto LABEL_145;
      }
    }
    else
    {
      wireless_api_add_mbss(v45, &v69, 1);
    }
    wireless_api_run_mbss(v45, v43, 1);
    goto LABEL_144;
  }
  if ( !get_value_post(v2, "wlmode", &v133, 128) )
    goto LABEL_223;
  v8 = atoi((const char *)&v133);
  v9 = wireless_api_get_max_mbss(v8);
  sf_strncpy(&v135, "eth2", 32);
  print_iframe_wpsstatus_0(v8, (int)&v135);
  sf_strncpy(&v135, "eth1", 32);
  print_iframe_wpsstatus_0(v8, (int)&v135);
  v10 = v8 == 1 ? "eth1" : "eth2";
  sf_strncpy(&v135, v10, 32);
  memset(&v133, 0, 0x200u);
  v11 = get_value_post(v2, "sidx", &v133, 512);
  if ( v11 )
  {
    v11 = atoi((const char *)&v133);
    if ( v11 >= v9 )
      goto LABEL_223;
  }
  if ( !read_mbssid_conf(v11 + (v8 << 16), &v69) )
    memset(&v69, 0, 0x578u);
  v93 = v8;
  memset(&v133, 0, 0x200u);
  if ( !get_value_post(v2, "ssid", &v133, 512) )
    goto LABEL_223;
  sf_strncpy(&v70, &v133, 32);
  if ( v11 )
  {
    if ( get_value_post(v2, "mbsspolicy", &v133, 512) )
    {
      v12 = atoi((const char *)&v133);
      if ( v12 > 1 )
        goto LABEL_223;
      v83 = v12;
    }
  }
  else if ( get_value_post(v2, "autochannel", &v133, 512) && atoi((const char *)&v133) )
  {
    v72 = 0;
    v73 = 0;
  }
  else
  {
    if ( get_value_post(v2, "ctlchannel", &v133, 512) )
      v72 = atoi((const char *)&v133);
    if ( get_value_post(v2, "cntchannel", &v133, 512) )
      v73 = atoi((const char *)&v133);
    v94 = 0;
  }
  if ( get_value_post(v2, "broadcast", &v133, 512) )
  {
    v13 = atoi((const char *)&v133);
    if ( v13 > 1 )
      goto LABEL_223;
    v74 = v13;
  }
  if ( !get_value_post(v2, "useenterprise", &v133, 512) )
    goto LABEL_226;
  v14 = atoi((const char *)&v133);
  if ( v14 > 1 )
    goto LABEL_223;
  if ( v14 )
  {
    if ( !get_value_post(v2, "enterpriselist", &v133, 512) )
      goto LABEL_223;
    convert_auth_enc((const char *)&v133, 0, &v75, &v76);
    if ( !get_value_post(v2, "radiusserver", &v133, 512) )
      goto LABEL_223;
    sf_strncpy(&v140, &v133, 32);
    v15 = &v139;
    while ( 1 )
    {
      v20 = (unsigned __int8)(v15++)[1];
      v19 = v20;
      if ( !v20 )
        break;
      v16 = (unsigned __int8)(v19 - 48);
      v17 = (unsigned int)v19 >= 0x2E;
      v18 = v19 == 46;
      if ( v19 != 46 )
      {
        v17 = v16 >= 9;
        v18 = v16 == 9;
      }
      if ( !v18 && v17 )
        goto LABEL_223;
    }
    v21 = (char *)&v140;
    while ( 1 )
    {
      v22 = strtok(v21, ".");
      if ( !v22 )
        break;
      ++v19;
      if ( (unsigned int)atoi(v22) > 0xFF )
        v21 = (char *)1;
      else
        v21 = (char *)(v19 > 4);
      if ( v21 )
        goto LABEL_223;
    }
    if ( v19 != 4 )
      goto LABEL_223;
    sf_strncpy(&v96, &v133, 32);
    if ( get_value_post(v2, "radiusport", &v133, 512) )
    {
      v23 = atoi((const char *)&v133);
      if ( v23 >= 0x10000 )
        goto LABEL_223;
      v98 = v23;
    }
    else
    {
      v98 = 1812;
    }
    if ( !get_value_post(v2, "radiussecret", &v133, 512) )
      goto LABEL_223;
    v24 = &v133;
    v25 = 128;
    v26 = (char *)&v97;
  }
  else
  {
LABEL_226:
    if ( !get_value_post(v2, "personallist", &v133, 512) || strstr((const char *)&v133, "wep") )
      goto LABEL_223;
    convert_auth_enc((const char *)&v133, 0, &v75, &v76);
    if ( (unsigned int)(v76 - 3) > 2 )
      goto LABEL_65;
    if ( !get_value_post(v2, "wpapsk", &v133, 512) )
      goto LABEL_223;
    v26 = &v77;
    v24 = &v133;
    v25 = 64;
  }
  sf_strncpy(v26, v24, v25);
LABEL_65:
  if ( v11 )
  {
    if ( get_value_post(v2, "qosenable", &v133, 512) && atoi((const char *)&v133) )
    {
      if ( get_value_post(v2, "txrate", &v133, 512) )
        v84 = 1000 * atoi((const char *)&v133);
      else
        v84 = 0;
      if ( get_value_post(v2, "rxrate", &v133, 512) )
        v85 = 1000 * atoi((const char *)&v133);
      else
        v85 = 0;
    }
    else
    {
      v84 = 0;
      v85 = 0;
    }
  }
  if ( !get_value_post(v2, "uiidx", &v133, 128) )
    goto LABEL_223;
  v100 = atoi((const char *)&v133);
  if ( v11 )
  {
    wireless_api_add_mbss(v11 + (v8 << 16), &v69, 1);
LABEL_129:
    v40 = signal_start("fwsched");
    signal_save(v40);
    goto LABEL_223;
  }
  set_active_wl(&v135, v8);
  write_wireless_conf(&v69, &v135);
  set_wireless_conf(&v69, &v135);
  memset(&v69, 0, 0x578u);
  read_wireless_conf(&v69, &v135);
  if ( get_value_post(v2, "txpower", &v133, 512) )
    v78 = atoi((const char *)&v133);
  if ( get_value_post(v2, "rts", &v133, 512) )
    v79 = atoi((const char *)&v133);
  if ( get_value_post(v2, "beacon", &v133, 512) )
    v81 = atoi((const char *)&v133);
  if ( get_value_post(v2, "fragmentation", &v133, 512) )
    v80 = atoi((const char *)&v133);
  if ( get_value_post(v2, "wirelessmode", &v133, 512) )
  {
    v27 = v71;
    v71 = atoi((const char *)&v133);
    if ( v27 != v71 )
      v72 = 0;
  }
  if ( get_value_post(v2, "channelwidth", &v133, 512) )
  {
    v28 = v82;
    v82 = atoi((const char *)&v133);
    if ( v28 != v82 )
      v72 = 0;
  }
  if ( get_value_post(v2, "country", &v133, 512) )
  {
    v29 = strcmp((const char *)&v133, (const char *)&v88);
    if ( v29 )
    {
      v30 = 0;
      v31 = &v69;
    }
    if ( v29 )
      *((_DWORD *)v31 + 34) = v30;
    sf_strncpy(&v88, &v133, 8);
  }
  if ( get_value_post(v2, "wpsmode", &v133, 512) )
  {
    v32 = atoi((const char *)&v133);
    if ( v32 <= 1 )
      v89 = v32;
  }
  if ( get_value_post(v2, "wpsnoti", &v133, 512) )
  {
    v33 = atoi((const char *)&v133);
    if ( v33 <= 1 )
      v91 = v33;
    if ( v91 )
    {
      v90 = 1;
      strcpy((char *)&v92, "YSM8V3Q23LWW");
    }
  }
  if ( get_value_post(v2, "wmm", &v133, 512) )
  {
    v34 = atoi((const char *)&v133);
    if ( v34 <= 1 )
      v86 = v34;
  }
  if ( get_value_post(v2, "ldpc", &v133, 512) )
  {
    v35 = atoi((const char *)&v133);
    if ( v35 <= 1 )
      v87 = v35;
  }
  if ( get_value_post(v2, "phywatchdog", &v133, 512) )
  {
    v36 = atoi((const char *)&v133);
    if ( v36 <= 1 )
      v99 = v36;
  }
  if ( get_value_post(v2, "channelwidth", &v133, 512) )
  {
    v37 = v82;
    v82 = atoi((const char *)&v133);
    if ( v82 != v37 )
      v72 = 0;
  }
  if ( !get_value_post(v2, "dynchannel", &v133, 512) )
    goto LABEL_126;
  v38 = atoi((const char *)&v133);
  if ( v38 <= 1 )
    v94 = v38;
  if ( !v94 || (v72 = 0, v73 = 0, !get_value_post(v2, "dcsperiodhour", &v133, 512)) )
  {
LABEL_126:
    if ( get_value_post(v2, "mimoant", &v133, 512) )
      v101 = atoi((const char *)&v133);
    write_wireless_conf(&v69, &v135);
    set_wireless_conf(&v69, &v135);
    goto LABEL_129;
  }
  v39 = atoi((const char *)&v133);
  if ( (unsigned int)(v39 - 1) <= 0x63 )
  {
    v95 = 60 * v39;
    goto LABEL_126;
  }
LABEL_223:
  v7 = 3;
LABEL_145:
  if ( !get_value_post(v2, "sidx", &v136, 128) )
  {
    read_wireless_conf(&v102, &v141);
    goto LABEL_219;
  }
  v48 = atoi((const char *)&v136);
  if ( v48 >= wireless_api_get_max_mbss(v48) )
    v49 = 0;
  else
    v49 = v48 & ~(v48 >> 31);
  if ( read_mbssid_conf(v49 + (v5 << 16), &v102) )
  {
    v50 = v129;
  }
  else
  {
    memset(&v102, 0, 0x578u);
    get_value_post(v2, "uiidx", &v136, 128);
    v50 = atoi((const char *)&v136);
    print_iframe_multibssid_0(v5, (int)&v102, v50);
  }
  if ( !v49 )
    goto LABEL_154;
LABEL_157:
  print_js_file((int)"wirelessconf", (int)"basicsetup");
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"hiddenwlsetup_fm\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"hiddenwlsetup\">");
  printf("<input type=hidden name=\"wlmode\" value=\"%d\">", v5);
  printf("<input type=hidden name=\"wlmodetxt\" value=\"%s\">");
  printf("<input type=hidden name=\"action\" value=\"\">");
  printf("<input type=hidden name=\"sidx\" value=\"%d\">", v49);
  if ( v49 && !v129 )
    v129 = v50;
  printf("<input type=hidden name=\"uiidx\" value=\"%d\">", v129);
  v51 = getTags((const char *)&v103);
  printf("<input type=hidden name=\"ssid\" value=\"%s\">", v51);
  printf("<input type=hidden name=\"autochannel\" value=\"%d\">");
  printf("<input type=hidden name=\"ctlchannel\" value=\"%d\">");
  if ( v105 )
    v52 = v106;
  else
    v53 = &v134;
  if ( !v105 )
    v52 = *((_DWORD *)v53 + 138);
  printf("<input type=hidden name=\"cntchannel\" value=\"%d\">", v52, v53);
  if ( check_wifi_regulation(&v121) )
    printf("<input type=hidden name=rwarning value=l>");
  printf("<input type=hidden name=\"run\" value=\"%d\">", v102);
  printf("<input type=hidden name=\"mbsspolicy\" value=\"%d\">", v116);
  v54 = v117;
  if ( v117 )
    v54 = calc_mask(v117, 1000);
  printf("<input type=hidden name=\"txrate\" value=\"%d\">", v54);
  v55 = v118;
  if ( v118 )
    v55 = calc_mask(v118, 1000);
  printf("<input type=hidden name=\"rxrate\" value=\"%d\">", v55);
  if ( v117 )
  {
    v56 = 1;
  }
  else
  {
    v56 = v118;
    if ( v118 )
      v56 = 1;
  }
  printf("<input type=hidden name=\"qosenable\" value=\"%d\">", v56);
  v57 = wireless_check_8021x_enabled(&v102);
  memset(&v138, 0, 0x40u);
  reconvert_auth_enc(v108, v109, (char *)&v138);
  printf("<input type=hidden name=\"useenterprise\" value=\"%d\">", v57);
  printf("<input type=hidden name=\"radiusserver\" value=\"%s\">", &v126);
  printf("<input type=hidden name=\"radiussecret\" value=\"");
  print_escape_str((const char *)&v127);
  printf("\">");
  printf("<input type=hidden name=\"radiusport\" value=\"%d\">");
  printf("<input type=hidden name=\"enterpriselist\" value=\"%s\">");
  if ( v57 )
    v58 = "nouse";
  else
    v58 = &v137;
  if ( !v57 )
    v58 += 36;
  printf("<input type=hidden name=\"personallist\" value=\"%s\">", v58);
  printf("<input type=hidden name=\"wpapsk\" value=\"");
  print_escape_str((const char *)&v110);
  printf("\">");
  printf("<input type=hidden name=\"broadcast\" value=\"%d\">", v107);
  if ( v7 != 3 && v7 != 1 )
  {
    v59 = v7 == 2;
    if ( v7 == 2 )
      v59 = v49 == 0;
    if ( !v59 )
    {
      get_value_post(v2, "txpower", &v136, 128);
      printf("<input type=hidden name=\"txpower\" value=\"%s\">", &v136);
      get_value_post(v2, "beacon", &v136, 128);
      printf("<input type=hidden name=\"beacon\" value=\"%s\">", &v136);
      if ( get_value_post(v2, "rts", &v136, 128) )
        printf("<input type=hidden name=\"rts\" value=\"%s\">", &v136);
      get_value_post(v2, "wpsmode", &v136, 128);
      printf("<input type=hidden name=\"wpsmode\" value=\"%s\">", &v136);
      get_value_post(v2, "wpsnoti", &v136, 128);
      printf("<input type=hidden name=\"wpsnoti\" value=\"%s\">", &v136);
      if ( get_value_post(v2, "fragmentation", &v136, 128) )
        printf("<input type=hidden name=\"fragmentation\" value=\"%s\">", &v136);
      get_value_post(v2, "ldpc", &v136, 128);
      printf("<input type=hidden name=\"ldpc\" value=\"%s\">", &v136);
      get_value_post(v2, "wmm", &v136, 128);
      printf("<input type=hidden name=\"wmm\" value=\"%s\">", &v136);
      get_value_post(v2, "phywatchdog", &v136, 128);
      printf("<input type=hidden name=\"phywatchdog\" value=\"%s\">", &v136);
      get_value_post(v2, "dynchannel", &v136, 128);
      printf("<input type=hidden name=\"dynchannel\" value=\"%s\">", &v136);
      get_value_post(v2, "dcsperiodhour", &v136, 128);
      printf("<input type=hidden name=\"dcsperiodhour\" value=\"%s\">", &v136);
      get_value_post(v2, "wirelessmode", &v136, 128);
      printf("<input type=hidden name=\"wirelessmode\" value=\"%s\">", &v136);
      get_value_post(v2, "country", &v136, 128);
      printf("<input type=hidden name=\"country\" value=\"%s\">", &v136);
      get_value_post(v2, "channelwidth", &v136, 128);
      printf("<input type=hidden name=\"channelwidth\" value=\"%s\">", &v136);
      get_value_post(v2, "mimoant", &v136, 128);
      v62 = "<input type=hidden name=\"mimoant\" value=\"%s\">";
      goto LABEL_197;
    }
  }
  printf("<input type=hidden name=\"txpower\" value=\"%d\">", v111);
  printf("<input type=hidden name=\"beacon\" value=\"%d\">", v114);
  printf("<input type=hidden name=\"rts\" value=\"%d\">", v112);
  printf("<input type=hidden name=\"wpsmode\" value=\"%d\">", v122);
  printf("<input type=hidden name=\"wpsnoti\" value=\"%d\">", v123);
  printf("<input type=hidden name=\"fragmentation\" value=\"%d\">", v113);
  printf("<input type=hidden name=\"ldpc\" value=\"%d\">", v120);
  printf("<input type=hidden name=\"wmm\" value=\"%d\">", v119);
  printf("<input type=hidden name=\"phywatchdog\" value=\"%d\">", v128);
  printf("<input type=hidden name=\"dynchannel\" value=\"%d\">", v124);
  v60 = v125;
  if ( v125 )
    v60 = calc_mask(v125, 60);
  printf("<input type=hidden name=\"dcsperiodhour\" value=\"%d\">", v60);
  printf("<input type=hidden name=\"wirelessmode\" value=\"%d\">", v104);
  printf("<input type=hidden name=\"country\" value=\"%s\">", &v121);
  printf("<input type=hidden name=\"channelwidth\" value=\"%d\">", v115);
  if ( v5 == 1 )
    v61 = v132;
  else
    v61 = v131;
  if ( v61 > 2 )
  {
    v62 = "<input type=hidden name=\"mimoant\" value=\"%d\">";
LABEL_197:
    printf(v62);
  }
  v63 = v115;
  if ( v115 )
  {
    if ( v115 != 80 )
    {
      if ( v115 != 40 )
        goto LABEL_227;
      v64 = v104 - 4;
      v65 = v104 >= 9;
      v66 = v104 == 9;
      if ( v104 != 9 )
      {
        v65 = v64 >= 2;
        v66 = v64 == 2;
      }
      if ( !v66 && v65 )
      {
LABEL_227:
        if ( v104 - 1 <= 2 )
          v63 = 20;
      }
    }
  }
  else
  {
    v63 = 40;
  }
  printf("<input type=hidden name=\"realchanwidth\" value=\"%d\">", v63);
  printf("</form>");
  printf("</BODY>");
  result = printf("<script>parent.iframe_hiddenwlsetup = true;</script>");
  if ( v7 == 1 )
    return printf((const char *)&unk_8B0FA);
  if ( v7 == 2 )
    return printf("<script>\ninit_hiddensetup('%s', false, true, %s);\n</script>\n");
  if ( v7 == 3 )
  {
    v67 = "<script>\ninit_hiddensetup('%s', true, true, true); refresh_wps_view('%s', %s);\n</script>\n";
  }
  else
  {
    if ( v7 != 5 )
      return result;
    v67 = "<script>\ninit_hiddensetup('%s', true, false, false); refresh_wps_view('%s', %s);\n</script>\n";
  }
  return printf(v67);
}
// 10424: using guessed type int __fastcall wireless_api_get_max_mbss(_DWORD);
// 104B4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10724: using guessed type int __fastcall set_wireless_conf(_DWORD, _DWORD);
// 107CC: using guessed type int __fastcall read_wireless_conf(_DWORD, _DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10C64: using guessed type int __fastcall signal_start(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 114F8: using guessed type int __fastcall set_active_wl(_DWORD, _DWORD);
// 115A0: using guessed type int __fastcall wireless_api_run_mbss(_DWORD, _DWORD, _DWORD);
// 1175C: using guessed type int __fastcall wireless_check_8021x_enabled(_DWORD);
// 118D0: using guessed type int __fastcall wireless_api_get_current_channelspec(_DWORD, _DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 11990: using guessed type int __fastcall read_mbssid_conf(_DWORD, _DWORD);
// 11C48: using guessed type int __fastcall check_wifi_regulation(_DWORD);
// 11C9C: using guessed type int __fastcall wireless_api_add_mbss(_DWORD, _DWORD, _DWORD);
// 11F48: using guessed type int __fastcall write_wireless_conf(_DWORD, _DWORD);

//----- (0002B478) --------------------------------------------------------
int __fastcall print_iframe_wpssubmit(int a1, int a2)
{
  int v2; // r7@1
  int v3; // r4@1
  const char *v4; // r1@2
  int v5; // r0@3
  int v6; // r1@6
  const char *v7; // r0@10
  int v8; // r0@15
  int v10; // [sp+0h] [bp-68h]@1
  char v11; // [sp+20h] [bp-48h]@6
  char s; // [sp+40h] [bp-28h]@8
  int v13; // [sp+44h] [bp-24h]@15
  int v14; // [sp+48h] [bp-20h]@15
  char v15; // [sp+4Ch] [bp-1Ch]@9

  v2 = a2;
  v3 = get_value_post(a2, "wlmode", &v10, 32);
  if ( v3 )
  {
    v5 = strcmp((const char *)&v10, "2g");
    v4 = "eth2";
    if ( v5 )
    {
      v3 = 1;
      v4 = "eth1";
    }
    else
    {
      v3 = 0;
    }
  }
  else
  {
    v4 = "eth2";
  }
  sf_strncpy(&v11, v4, 32);
  memset(&v10, 0, 0x20u);
  if ( get_value_post(v2, "action", &v10, 32) )
  {
    print_iframe_wpsstatus_0(v3, (int)&v11);
    v6 = strcmp((const char *)&v10, "start");
    if ( !v6 )
    {
      memset(&s, 0, 0xCu);
      if ( v3 )
      {
        if ( !wireless_get_wps_status("eth2", &v15) )
        {
LABEL_15:
          v14 = 0;
          v13 = 0;
          wireless_reset_wps_status(&v11);
          write_wps_conf(&v11, &s);
          v8 = wireless_set_wps_src(&v11);
          signal_wps(v8);
          goto LABEL_16;
        }
        v7 = "eth2";
      }
      else
      {
        if ( !wireless_get_wps_status("eth1", &v15) )
          goto LABEL_15;
        v7 = "eth1";
      }
      wireless_wps_stop_signal(v7);
      goto LABEL_15;
    }
  }
LABEL_16:
  printf(
    "<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">",
    v6);
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"wpssubmit_fm\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"wpssubmit\">");
  printf("<input type=hidden name=\"wlmode\" value=\"%d\">", v3);
  printf("<input type=hidden name=\"action\" value=\"\">");
  printf((const char *)&unk_8B2C5);
  printf("<script>parent.parent.iframe_wpssubmit = true;</script>");
  return printf("<script>setTimeout(function(){parent.document.wps_fm.submitted.value = '';}, 2000);</script>");
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 1109C: using guessed type int __fastcall wireless_wps_stop_signal(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 1139C: using guessed type int __fastcall write_wps_conf(_DWORD, _DWORD);
// 113E4: using guessed type int __fastcall wireless_reset_wps_status(_DWORD);
// 11AD4: using guessed type int __fastcall wireless_get_wps_status(_DWORD, _DWORD);
// 11B40: using guessed type int __fastcall signal_wps(_DWORD);
// 11D44: using guessed type int __fastcall wireless_set_wps_src(_DWORD);

//----- (0002B630) --------------------------------------------------------
int __fastcall print_iframe_wpsstatus(int a1, int a2)
{
  int v2; // r6@1
  int v3; // r4@1
  int v4; // r7@3
  int v5; // r5@6
  int v6; // r0@7
  int v7; // r8@9
  int v8; // r0@10
  const char *v9; // r0@12
  const char *v10; // r0@21
  int v12; // [sp+0h] [bp-5D8h]@1
  int v13; // [sp+418h] [bp-1C0h]@3
  int v14; // [sp+578h] [bp-60h]@1
  int v15; // [sp+598h] [bp-40h]@1
  int v16; // [sp+5B8h] [bp-20h]@3
  int v17; // [sp+5BCh] [bp-1Ch]@1

  v2 = get_value_post(a2, "firstload", &v14, 32) == 0;
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"wpsstatus_fm\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"wpsstatus\">");
  printf("<input type=hidden name=\"firstload\" value=\"%d\">", v2);
  sf_strncpy(&v15, "eth2", 32);
  read_wireless_conf(&v12, &v15);
  v3 = wireless_get_wps_status(0, &v17);
  if ( v3 != 3 )
    v3 = wireless_get_wps_status(&v15, &v17);
  printf("<input type=hidden name=\"run2g\" value=\"%d\">", v12);
  printf("<input type=hidden name=\"wpsmode2g\" value=\"%d\">", v13);
  sf_strncpy(&v15, "eth1", 32);
  read_wireless_conf(&v12, &v15);
  v4 = wireless_get_wps_status(0, &v16);
  if ( v4 != 3 )
    v4 = wireless_get_wps_status(&v15, &v16);
  printf("<input type=hidden name=\"run5g\" value=\"%d\">", v12);
  printf("<input type=hidden name=\"wpsmode5g\" value=\"%d\">", v13);
  if ( v3 == 3 )
  {
    v6 = istatus_get_intvalue_direct((int)"wps_2g_ts");
    v5 = v6 - get_system_running_time(v6) + 120;
  }
  else
  {
    v5 = 0;
  }
  printf("<input type=hidden name=\"remaintime2g\" value=\"%d\">", v5);
  if ( v4 == 3 )
  {
    v8 = istatus_get_intvalue_direct((int)"wps_5g_ts");
    v7 = v8 - get_system_running_time(v8) + 120;
  }
  else
  {
    v7 = 0;
  }
  printf("<input type=hidden name=\"remaintime5g\" value=\"%d\">", v7);
  switch ( v3 )
  {
    case 0:
      v9 = "<input type=hidden name=\"statusval2g\" value=\"WPS_STOP\">";
      break;
    case 1:
      v9 = "<input type=hidden name=\"statusval2g\" value=\"WPS_IDLE\">";
      break;
    case 2:
      v9 = "<input type=hidden name=\"statusval2g\" value=\"WPS_START\">";
      break;
    case 3:
      v9 = "<input type=hidden name=\"statusval2g\" value=\"WPS_PROCESSING\">";
      break;
    case 4:
      v9 = "<input type=hidden name=\"statusval2g\" value=\"WPS_CONFIGURED\">";
      break;
    case 5:
      v9 = "<input type=hidden name=\"statusval2g\" value=\"WPS_ERROR\">";
      break;
    case 6:
      v9 = "<input type=hidden name=\"statusval2g\" value=\"WPS_TIMEOUT\">";
      break;
    default:
      v9 = "<input type=hidden name=\"statusval2g\" value=\"NONE\">";
      break;
  }
  printf(v9);
  switch ( v4 )
  {
    case 0:
      v10 = "<input type=hidden name=\"statusval5g\" value=\"WPS_STOP\">";
      break;
    case 1:
      v10 = "<input type=hidden name=\"statusval5g\" value=\"WPS_IDLE\">";
      break;
    case 2:
      v10 = "<input type=hidden name=\"statusval5g\" value=\"WPS_START\">";
      break;
    case 3:
      v10 = "<input type=hidden name=\"statusval5g\" value=\"WPS_PROCESSING\">";
      break;
    case 4:
      v10 = "<input type=hidden name=\"statusval5g\" value=\"WPS_CONFIGURED\">";
      break;
    case 5:
      v10 = "<input type=hidden name=\"statusval5g\" value=\"WPS_ERROR\">";
      break;
    case 6:
      v10 = "<input type=hidden name=\"statusval5g\" value=\"WPS_TIMEOUT\">";
      break;
    default:
      v10 = "<input type=hidden name=\"statusval5g\" value=\"NONE\">";
      break;
  }
  printf(v10);
  printf((const char *)&unk_8B2C5);
  printf("<script>parent.parent.iframe_wpsstatus = true;</script>");
  return printf("<script>parent.init_wpsstatus(%d,%s);</script>");
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 106D0: using guessed type int __fastcall get_system_running_time(_DWORD);
// 107CC: using guessed type int __fastcall read_wireless_conf(_DWORD, _DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11AD4: using guessed type int __fastcall wireless_get_wps_status(_DWORD, _DWORD);

//----- (0002B95C) --------------------------------------------------------
int print_iframe_wpssetup()
{
  print_js_file((int)"wirelessconf", (int)"basicsetup");
  sub_286D4();
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"wps_fm\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"wpssetup\">");
  printf("<input type=hidden name=\"submitted\" value=\"\">");
  printf("<input type=hidden name=\"act2gbtn\" value=\"\">");
  printf("<input type=hidden name=\"act5gbtn\" value=\"\">");
  printf("<table class=\"v3_table wl_mbssid_table\" height=\"24px\">");
  printf("<COL WIDTH=\"140\"><COL WIDTH=\"140\"><COL WIDTH=\"%%%%\">");
  printf("<tr height=\"24px\">");
  printf("<td style=\"padding:0 0 0 5; font-size:12px; vertical-align:middle;\">");
  printf("<button type=\"button\" class=\"wl_mbssid_button\" style=\"width:130px; display:inline-block; *display:inline; zoom:1;\" \t\tid=\"wpsconn2g\" onclick=\"onclick_wps_button('2g');\"></button>");
  printf("</td>");
  printf("<td style=\"padding:0 0 0 5; font-size:12px; vertical-align:middle;\">");
  printf("<button type=\"button\" class=\"wl_mbssid_button\" style=\"width:130px; display:inline-block; *display:inline; zoom:1;\" \t\tid=\"wpsconn5g\" onclick=\"onclick_wps_button('5g');\"></button>");
  printf("</td>");
  printf("<td style=\"padding:0 0 0 5; font-size:12px; vertical-align:middle;\">");
  printf("<div id=\"WPSSTATUSLINE\">");
  printf("<p class=\"wl_mbssid_p\" id=\"wpsstatus\" \t\tstyle=\"opacity:0.5; vertical-align:middle; display:inline-block; *display:inline; zoom:1;\"></p>");
  printf("</div></td>");
  printf((const char *)&unk_97FC6);
  printf("<iframe name=\"wpsstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=wpsstatus\" frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  printf("<iframe name=\"wpssubmit_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=wpssubmit\" frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  printf("</BODY>");
  printf("<script>parent.iframe_wpssetup = true;</script>");
  return printf("<script>init_wpssetup();</script>");
}

//----- (0002BAB0) --------------------------------------------------------
int __fastcall wirelessconf_basicsetup(int a1, int a2)
{
  int v2; // r5@1
  const char *v3; // r0@1
  int result; // r0@2
  int v5; // r4@4
  int v6; // r1@4
  int v7; // r0@4
  int v8; // r1@4
  int v9; // r0@4
  int v10; // r1@4
  int v11; // r0@4
  int v12; // r1@4
  int v13; // r0@5
  int v14; // r1@6
  int v15; // r0@6
  int v16; // r1@6
  int v17; // r0@6
  int v18; // r1@6
  int v19; // r0@6
  int v20; // r1@6
  int v21; // r0@6
  int v22; // r1@6
  int v23; // r0@6
  int v24; // r1@6
  int v25; // r0@6
  int v26; // r1@6
  int v27; // r0@6
  int v28; // r1@6
  int v29; // r0@6
  int v30; // r1@6
  int v31; // r5@6
  int v32; // r1@6
  int v33; // r0@6
  int v34; // r1@6
  int v35; // r0@6
  int v36; // r1@6
  int v37; // r0@6
  int v38; // r1@6
  int v39; // r0@6
  int v40; // r1@6
  int v41; // r0@6
  int v42; // r1@6
  int v43; // r0@6
  int v44; // r1@6
  int v45; // r0@6
  int v46; // r1@6
  int v47; // r0@6
  int v48; // r1@6
  int v49; // r0@6
  int v50; // r1@6
  int v51; // r0@6
  int v52; // r1@6
  int v53; // r0@6
  char v54; // [sp+4h] [bp-34h]@2
  int v55; // [sp+24h] [bp-14h]@4

  v2 = a2;
  v3 = (const char *)get_parameter_value(a1, "wlmode");
  if ( !v3 )
  {
    result = get_value_post(v2, "wlmode", &v54, 32);
    if ( !result )
      return result;
    v3 = &v54;
  }
  v5 = atoi(v3);
  sub_286D4();
  print_js_file((int)"wirelessconf", (int)"basicsetup");
  printf("<style>");
  printf("p { margin: 0; }");
  printf("</style>");
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"basicsetup_fm\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"basicsetup\">");
  printf("<input type=hidden name=\"ocolor\" value=\"\">");
  printf("<table class=\"v3_table wl_mbssid_table\" height=\"96px\">");
  printf("<COL WIDTH=\"100\"><COL WIDTH=\"200\"><COL WIDTH=\"%%%%\">");
  printf("<tr height=\"24px\" class=\"wl_mbssid_title\" id=\"basicsetuptitle\"><td class=\"wl_mbssid_td\" colspan=\"3\">");
  printf("<p id=\"basicsetup_title_p\"></p>");
  printf("</td></tr>");
  printf("<tr height=\"24px\" style=\"background-color:#FFFFFF;\" name=\"BASICSETUP_LINE\" id=\"SSID_LINE\"><td class=\"wl_mbssid_td\">");
  v7 = get_ux_text_common(1466, v6);
  printf("<p>%s</p></td>", v7);
  printf("<td class=\"wl_mbssid_td\">");
  puts("<input type=text name=\"ssid\" style=\"width:190px;\" maxlength=\"32\" size=\"32\" value=''>");
  printf("</td><td class=\"wl_mbssid_td\">");
  v9 = get_ux_text_common(1454, v8);
  printf(
    "<input type=\"checkbox\" name=\"broadcast\" id=\"bcast\" value=\"1\" style=\"margin-left:5px;\"><label for=\"bcast\">%s</label>",
    v9);
  printf("</td></tr>");
  printf("<tr height=\"24px\" style=\"background-color:#FFFFFF;\" name=\"BASICSETUP_LINE\" id=\"CHANNEL_LINE\"><td class=\"wl_mbssid_td\">");
  v11 = get_ux_text_common(1455, v10);
  printf("<p>%s</p></td>", v11);
  printf("<td class=\"wl_mbssid_td\">");
  printf("<select name=channel style=\"width:190px;\">");
  printf("</select></td><td class=\"wl_mbssid_td\">");
  get_active_wl(v5, 0, &v55);
  if ( !v55 )
  {
    v13 = get_ux_text_common(904, v12);
    printf(
      "<input type=button class=\"wl_mbssid_button\" style=\"margin-left:5px;\" name='%s' value='%s' \t\t\t\tonclick=\"on"
      "click_searchwlbtn();\">",
      "search_channel_bt",
      v13);
  }
  printf("</td></tr>");
  printf("<tr height=\"24px\" style=\"background-color:#FFFFFF;\" name=\"BASICSETUP_LINE\" id=\"AUTH_LINE\"><td class=\"wl_mbssid_td\">");
  v15 = get_ux_text_common(1453, v14);
  printf("<p>%s</p></td>", v15);
  printf("<td class=\"wl_mbssid_td\">");
  puts("<select id=\"personallist\" name=\"personallist\" style=\"width:190px;\" onchange=\"set_authline_by_select(document, this.value);\">");
  v17 = get_ux_text_common(927, v16);
  printf("<option value=\"%s\">%s \n", "nouse", v17);
  v19 = get_ux_text_common(1059, v18);
  printf("<option value=\"%s\">%s (%s) \n", "wpa2psk_aes", "WPA2PSK + AES", v19);
  printf("<option value=\"%s\">%s", &unk_8C413, &unk_8C425);
  printf("<option value=\"%s\">%s", "wpapsk_aes", "WPAPSK + AES");
  printf("<option value=\"%s\">%s \n", "wpa2psk_tkipaes", "WPA2PSK + TKIP/AES");
  printf("<option value=\"%s\">%s \n", &unk_8C452, &unk_8C468);
  printf("<option value=\"%s\">%s", "wpapsk_tkipaes", "WPAPSK + TKIP/AES");
  printf("<option value=\"%s\">%s", "wpapsk_tkip", "WPAPSK + TKIP");
  printf("<option value=\"%s\">%s", &unk_8C4C3, "WPA2PSK + TKIP");
  printf("<option value=\"%s\">%s", &unk_8C4BD, &unk_8C4D0);
  v21 = get_ux_text_common(905, v20);
  printf((const char *)&unk_8C4E6, "auto_wep", v21, " + WEP");
  v23 = get_ux_text_common(906, v22);
  printf((const char *)&unk_8C4E6, "open_wep", v23, " + WEP");
  v25 = get_ux_text_common(907, v24);
  printf((const char *)&unk_8C4E6, "key_wep", v25, " + WEP");
  puts("</select>");
  puts("<select id=\"enterpriselist\" name=\"enterpriselist\" style=\"width:190px; display:none\">");
  v27 = get_ux_text_common(1059, v26);
  printf("<option value=\"%s\">%s (%s)\n", "wpa2_aes", "WPA2 + AES", v27);
  printf("<option value=\"%s\">%s \n", &unk_8C59B, "WPA/WPA2 + TKIP/AES");
  printf("<option value=\"%s\">%s", "wpa_aes", "WPA + AES");
  puts("</select>");
  printf("</td><td class=\"wl_mbssid_td\">");
  v29 = get_ux_text_common(1467, v28);
  printf(
    "<input type=checkbox name=\"useenterprise\" id=\"uenter\" value=\"1\" style=\"margin-left:5px;\" onclick=\"set_enter"
    "prisemode_by_checkbox(document, this.checked);\"><label for=\"uenter\">%s</label>",
    v29);
  printf("</td></tr>");
  printf("<tr height=\"24px\" style=\"background-color:#FFFFFF;\" name=\"BASICSETUP_LINE\" id=\"PASSWORD_LINE\"><td class=\"wl_mbssid_td\">");
  v31 = get_ux_text_common(1465, v30);
  v33 = get_ux_text_common(1460, v32);
  printf(
    "<p name=\"RADIUSSET\" id=\"RADIUSSET\" style=\"display:none;\">%s</p><p name=\"NORMALSET\" id=\"NORMALSET\">%s</p></td>",
    v31,
    v33);
  printf("</td><td class=\"wl_mbssid_td\" colspan=\"2\">");
  printf("<div class=\"wl_mbssid_div\" name=\"RADIUSSET\" id=\"RADIUSSET\" style=\"display:none;\"><div class=\"wl_mbssid_div\">");
  printf("<input type=\"text\" name=\"radiusserver1\" maxlength=\"3\" size=\"3\" style=\"width:25pt; ime-mode:disabled;\" onfocus=\"this.select();\" onkeyup=\"IPKeyUp('radiusserver',1);\" onkeypress=\"return IPKeyDown('radiusserver',1);\">");
  printf(".<input type=\"text\" name=\"radiusserver2\" maxlength=\"3\" size=\"3\" style=\"width:25pt; ime-mode:disabled;\" onfocus=\"this.select();\" onkeyup=\"IPKeyUp('radiusserver',2);\" onkeypress=\"return IPKeyDown('radiusserver',2);\">");
  printf(".<input type=\"text\" name=\"radiusserver3\" maxlength=\"3\" size=\"3\" style=\"width:25pt; ime-mode:disabled;\" onfocus=\"this.select();\" onkeyup=\"IPKeyUp('radiusserver',3);\" onkeypress=\"return IPKeyDown('radiusserver',3);\">");
  printf(".<input type=\"text\" name=\"radiusserver4\" maxlength=\"3\" size=\"3\" style=\"width:25pt; ime-mode:disabled;\" onfocus=\"this.select();\" onkeyup=\"IPKeyUp('radiusserver',4);\" onkeypress=\"return IPKeyDown('radiusserver',4);\">");
  printf(":<input type=\"text\" name=\"radiusport\" maxlength=5 size=5 style=\"max-width:40pt; ime-mode:disabled;\" value=\"\">");
  printf("</div>");
  printf("<input type=checkbox name=\"manual\" id=\"manport\" value=\"1\" style=\"margin-left:5px; vertical-align:middle;\" onclick=\"set_disenable_by_checkbox(this, document.basicsetup_fm.radiusport);\">");
  v35 = get_ux_text_common(1463, v34);
  printf("<label for=\"manport\"> %s</label>", v35);
  v37 = get_ux_text_common(1460, v36);
  printf((const char *)&unk_8CCAC, v37);
  printf("<input type=\"password\" name=\"radiussecret\" value=\"\" style=\"ime-mode:disabled; width:120px;\" size=\"32\" maxlength=\"64\">");
  printf("<input type=\"text\" name=\"radiussecret_text\" value=\"\" style=\"ime-mode:disabled; width:120px; display:none;\" size=\"32\" maxlength=\"64\">");
  v39 = get_ux_text_common(1461, v38);
  printf(
    "<input type=checkbox name=\"radiuspassview\" id=\"rpassview\" value=\"1\" style=\"vertical-align:middle; margin-left"
    ":5px;\" \t\tonclick=\"set_passview_by_checkbox(this, document.basicsetup_fm.radiussecret);\">\t\t<label for=\"rpassv"
    "iew\"> %s</label>",
    v39);
  printf("</div>");
  printf("<div class=\"wl_mbssid_div\" name=\"NORMALSET\" id=\"NORMALSET\"><input type=\"password\" name=\"password\" value=\"\" style=\"ime-mode:disabled; width:190px;\" size=\"32\" maxlength=\"64\"><input type=\"text\" name=\"password_text\" value=\"\" style=\"ime-mode:disabled; width:190px; display:none;\" size=\"32\" maxlength=\"64\">");
  v41 = get_ux_text_common(1461, v40);
  printf(
    "<input type=checkbox name=\"wpapskpassview\" id=\"wpassview\" value=\"1\" style=\"vertical-align:middle; margin-left"
    ":15px;\" \t\tonclick=\"set_passview_by_checkbox(this, document.basicsetup_fm.password);\">\t\t<label for=\"wpassview"
    "\">%s</label></div>",
    v41);
  v43 = get_ux_text_common(1468, v42);
  printf("<p style=\"display:none;\" name=\"WEPALERT\" id=\"WEPALERT\">%s</p>", v43);
  printf("</td></tr>");
  printf("<tr height=\"24px\" style=\"background-color:#FFFFFF;\" name=\"BASICSETUP_LINE\">");
  printf("<td class=\"wl_mbssid_td\" style=\"padding:0; margin:0;\" colspan=\"3\">");
  printf("</td></tr>");
  printf("<tr height=\"24px\" style=\"display:none; background-color:#FFFFFF;\" name=\"BASICSETUP_LINE\" id=\"POLICY_LINE\"><td class=\"wl_mbssid_td\">");
  v45 = get_ux_text_common(1462, v44);
  printf((const char *)&unk_8D279, v45);
  puts("<select name=mbsspolicy style=\"width:190px;\">");
  v47 = get_ux_text_common(1452, v46);
  printf("<option value=\"%d\">%s</option>", 1, v47);
  v49 = get_ux_text_common(1451, v48);
  printf("<option value=\"%d\">%s</option>", 0, v49);
  printf("</select>");
  printf("</td><td class=\"wl_mbssid_td\">");
  v51 = get_ux_text_common(1464, v50);
  printf(
    "<input type=\"checkbox\" name=\"qosenable\" id=\"qenable\" value=\"1\" style=\"margin-left:5px;\" \t\tonclick=\"set_"
    "disenable_by_checkbox(this, document.basicsetup_fm.txrate); set_disenable_by_checkbox(this, document.basicsetup_fm.r"
    "xrate);\">\t\t<label for=\"qenable\">%s</label>",
    v51);
  v53 = get_ux_text_common(1457, v52);
  printf(
    "<p style=\"padding:0; margin:0 5px 0 0px; display:inline-block; *display:inline; zoom:1; width:65px; text-align:right;\">%s</p>",
    v53);
  printf("<input type=\"text\" name=\"rxrate\" value=\"\" style=\"ime-mode:disabled; width:50px;\" size=\"4\" maxlength=\"4\"> / ");
  printf("<input type=\"text\" name=\"txrate\" value=\"\" style=\"ime-mode:disabled; width:50px;\" size=\"4\" maxlength=\"4\"> Mbps");
  printf("</td></tr>");
  printf("</tr>");
  printf((const char *)&unk_97FC6);
  printf("</BODY>");
  printf("<script>parent.iframe_basicsetup = true;</script>");
  return printf("<script>init_basicsetup('%s');</script>");
}
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11810: using guessed type int __fastcall get_active_wl(_DWORD, _DWORD, _DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);

//----- (0002C170) --------------------------------------------------------
int __fastcall print_iframe_extendsetup(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r5@1
  void *v4; // r1@3
  int *v5; // r4@3
  int v6; // r1@3
  int v7; // r0@3
  int v8; // r1@3
  int v9; // r0@3
  int v10; // r0@3
  int v11; // r1@5
  int v12; // t1@5
  char *v13; // r1@7
  signed int v14; // r4@10
  int v15; // r1@12
  int v16; // r0@12
  char *v17; // r1@13
  int v18; // r1@17
  int v19; // r0@17
  int v20; // r1@17
  int v21; // r0@17
  char *v22; // r2@18
  void *v23; // r0@20
  void *v24; // r0@20
  int v25; // r1@20
  int v26; // r0@22
  void *v27; // r0@22
  int v28; // r1@22
  int v29; // r0@22
  void *v30; // r0@22
  int v31; // r1@22
  int v32; // r0@22
  int v33; // r1@22
  int v34; // r0@24
  void *v35; // r0@24
  int v36; // r1@24
  int v37; // r0@24
  void *v38; // r0@24
  int v39; // r1@24
  signed int v40; // r3@28
  signed int v41; // r2@28
  int v42; // r0@29
  const char *v43; // r0@31
  int v44; // r1@35
  int v45; // r0@35
  int v46; // r0@35
  signed int v47; // r1@36
  int v48; // r1@38
  int v49; // r0@38
  int v50; // r1@38
  int v51; // r0@38
  int v52; // r1@39
  int v53; // r5@40
  int v54; // r1@44
  int v55; // r5@45
  char v57; // [sp+Ch] [bp-464h]@1
  int v58; // [sp+120h] [bp-350h]@27
  int v59; // [sp+16Ch] [bp-304h]@26
  char v60; // [sp+3B8h] [bp-B8h]@4
  int v61; // [sp+438h] [bp-38h]@1

  v2 = a2;
  get_si("hw", &v57);
  onoffswitch();
  sub_286D4();
  v3 = get_value_post(v2, "opened", &v61, 32);
  if ( v3 )
    v3 = atoi((const char *)&v61);
  print_js_file((int)"wirelessconf", (int)"basicsetup");
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden; background-color:#EEEEEE;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"extendsetup_fm\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"extendsetup\">");
  printf("<input type=hidden name=\"opened\" value=\"%d\">", v3);
  printf("<table class=\"v3_table\">");
  printf("<COL WIDTH=\"110\"><COL WIDTH=\"190\"><COL WIDTH=\"110\"><COL WIDTH=\"%%%%\">");
  printf("<tr height=\"24px\" class=\"wl_mbssid_title\" onclick=\"toggle_title(document.getElementsByName('tableunit'), document.getElementById('timg'));\" id=\"extendsetuptitle\">\t\t<td class=\"wl_mbssid_td\" colspan=\"4\">");
  v4 = get_image_dir();
  v5 = (int *)&country_names;
  printf(
    "<p id=\"EXTTITLE\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle; margin:0; padding:0"
    ";\"></p>\t\t<img id=\"timg\" src=\"/%s/menu_list_%s.png\" style=\"display:inline-block; *display:inline; zoom:1; hei"
    "ght:14px; vertical-align:middle; margin-left:5px; width:16px;\">",
    v4);
  printf("</td></tr>");
  printf("<tr height=\"24px\" style=\"background-color:#FFFFFF; %s;\" name=\"tableunit\"><td class=\"wl_mbssid_td\">");
  v7 = get_ux_text_common(1444, v6);
  printf("<p>%s</p></td>", v7);
  printf("<td class=\"wl_mbssid_td\">");
  puts("<select name=\"wirelessmode\" style=\"width:90px;\">");
  printf("</select>");
  puts("<select name=\"channelwidth\" style=\"margin-left:5px; width:80px;\">");
  printf("</select>");
  printf("</td>");
  v9 = get_ux_text_common(1441, v8);
  printf((const char *)&unk_8DC4F, v9);
  printf("<td class=\"wl_mbssid_td\">");
  v10 = puts("<select name=\"country\" style=\"width:120px;\">");
  make_country_names(v10);
  while ( 1 )
  {
    v12 = *v5;
    v5 += 4;
    v11 = v12;
    if ( !v12 )
      break;
    sf_strncpy(&v60, v11, 128);
    printf("<option value=%s> %s </option>", *(v5 - 3), &v60);
  }
  printf("</select>");
  printf("</td></tr>");
  if ( v3 )
    v13 = "";
  else
    v13 = "display:none;";
  if ( v3 )
    v14 = 49;
  else
    v14 = 25;
  printf(
    "<tr height=\"24px\" style=\"background-color:#F7F7F7; %s\" name=\"tableunit\"><td class=\"wl_mbssid_td\">",
    v13);
  v16 = get_ux_text_common(1448, v15);
  printf("<p>%s</p></td>", v16);
  printf("<td class=\"wl_mbssid_td\">");
  printf("<input type=\"text\" name=\"txpower\" maxlength=\"3\" size=\"3\" value=\"\" style=\"width:80px;\"> %% ( 1 ~ 100 )");
  printf("</td><td class=\"wl_mbssid_td\"><p>Beacon</p></td>");
  printf("<td class=\"wl_mbssid_td\">");
  printf("<input type=\"text\" name=\"beacon\" maxlength=\"4\" size=\"4\" value=\"\" style=\"width:80px;\"> ms");
  printf("</td></tr>");
  if ( v3 )
    v17 = "";
  else
    v17 = "display:none;";
  if ( v3 )
    v14 += 24;
  printf(
    "<tr height=\"24px\" style=\"background-color:#FFFFFF; %s\" name=\"tableunit\"><td class=\"wl_mbssid_td\">",
    v17);
  v19 = get_ux_text_common(1446, v18);
  printf("<p>%s</p></td>", v19);
  printf("<td class=\"wl_mbssid_td\">");
  printf("<input type=\"text\" name=\"rts\" maxlength=\"4\" size=\"4\" value=\"\" style=\"width:80px;\"> byte ( 0 ~ 2347 )");
  v21 = get_ux_text_common(1458, v20);
  printf((const char *)&unk_8DC4A, v21);
  printf("<td class=\"wl_mbssid_td\">");
  printf("<input type=\"text\" name=\"fragmentation\" maxlength=\"4\" size=\"4\" value=\"\" style=\"width:80px;\"> byte ( 256 ~ 2346 )");
  printf("</td></tr>");
  if ( v3 )
  {
    v22 = "";
    v14 += 24;
  }
  else
  {
    v22 = "display:none;";
  }
  printf("<tr height=\"24px\" style=\"background-color:#%s; %s\" name=\"tableunit\">", "F7F7F7", v22);
  printf("<td class=\"wl_mbssid_td\"><p>WMM</p></td>");
  printf("<td class=\"wl_mbssid_td\">");
  v23 = get_image_dir();
  printf(
    "<img src=\"/%s/trigger_on.png\" id=\"wmm_id\" style=\"vertical-align:middle; height:22px; display:inline-block; *dis"
    "play:inline; zoom:1;\" onclick=\"change_onoff_val(document, this);\">",
    v23);
  printf("<input type=\"hidden\" name=\"wmm\">");
  printf("</td>");
  printf("<td class=\"wl_mbssid_td\">");
  printf("<p>LDPC</p>");
  printf("</td><td class=\"wl_mbssid_td\">");
  v24 = get_image_dir();
  printf(
    "<img src=\"/%s/trigger_on.png\" id=\"ldpc_id\" style=\"vertical-align:middle; height:22px; display:inline-block; *di"
    "splay:inline; zoom:1;\" onclick=\"change_onoff_val(document, this);\">",
    v24);
  printf("<input type=\"hidden\" name=\"ldpc\">");
  printf("</td>");
  printf((const char *)&unk_8DEC5, "FFFFFF");
  if ( v3 )
    v14 += 24;
  v26 = get_ux_text_common(1449, v25);
  printf((const char *)&unk_8DF0F, v26);
  printf("</td><td class=\"wl_mbssid_td\">");
  v27 = get_image_dir();
  printf(
    "<img src=\"/%s/trigger_on.png\" id=\"phywatchdog_id\" style=\"vertical-align:middle; height:22px; display:inline-blo"
    "ck; *display:inline; zoom:1;\" onclick=\"change_onoff_val(document, this);\">",
    v27);
  printf("<input type=\"hidden\" name=\"phywatchdog\">");
  printf("</td>");
  v29 = get_ux_text_common(1442, v28);
  printf((const char *)&unk_8DF0F, v29);
  printf("</td><td class=\"wl_mbssid_td\">");
  v30 = get_image_dir();
  printf(
    "<img src=\"/%s/trigger_on.png\" id=\"dynchannel_id\" style=\"vertical-align:middle; height:22px; display:inline-bloc"
    "k; *display:inline; zoom:1;\" onclick=\"change_onoff_val(document, this); set_dynchannel_view_by_slider();\">",
    v30);
  printf("<input type=\"hidden\" name=\"dynchannel\">");
  v32 = get_ux_text_common(415, v31);
  printf(
    "<input type=\"text\" name=\"dcsperiodhour\" maxlength=\"3\" size=\"3\" value=\"\" style=\"width:40px; display:inline"
    "-block; *display:inline; zoom:1; vertical-align:middle;\">%s</td>",
    v32);
  printf((const char *)&unk_8DEC5, "F7F7F7");
  if ( v3 )
    v14 += 24;
  v34 = get_ux_text_common(1450, v33);
  printf((const char *)&unk_8DC4F, v34);
  printf("<td class=\"wl_mbssid_td\">");
  v35 = get_image_dir();
  printf(
    "<img src=\"/%s/trigger_on.png\" id=\"wpsmode_id\" style=\"vertical-align:middle; height:22px; display:inline-block; "
    "*display:inline; zoom:1;\" onclick=\"change_onoff_val(document, this);\">",
    v35);
  printf("<input type=\"hidden\" name=\"wpsmode\">");
  printf("</td>");
  v37 = get_ux_text_common(1443, v36);
  printf((const char *)&unk_8DF0F, v37);
  printf("</td><td class=\"wl_mbssid_td\">");
  v38 = get_image_dir();
  printf(
    "<img src=\"/%s/trigger_on.png\" id=\"wpsnoti_id\" style=\"vertical-align:middle; height:22px; display:inline-block; "
    "*display:inline; zoom:1;\" onclick=\"change_onoff_val(document, this);\">",
    v38);
  printf("<input type=\"hidden\" name=\"wpsnoti\">");
  printf("</td>");
  printf((const char *)&unk_8DEC5, "FFFFFF");
  if ( v3 )
    v14 += 24;
  if ( v59 > 2 || v58 > 2 )
  {
    v42 = get_ux_text_common(1476, v39);
    printf("<td class=\"wl_mbssid_td\"><p class=\"wl_mbssid_p\" id=\"MIMOANT_TITLE\">%s</p>", v42);
    printf("</td><td class=\"wl_mbssid_td\">");
    printf("<select name=\"mimoant\">");
    printf("</select>");
    printf("</td>");
    v40 = 1;
    v41 = 7;
  }
  else
  {
    v40 = 0;
    v41 = 6;
  }
  if ( v41 & v40 )
    v43 = "<td class=\"wl_mbssid_td\"></td><td class=\"wl_mbssid_td\"></td></tr>";
  else
    v43 = (const char *)&unk_8E3D9;
  printf(v43);
  if ( v3 )
    v14 += 24;
  printf((const char *)&unk_97FC6);
  printf("</BODY>");
  printf("<script>");
  v45 = get_ux_text_common(1447, v44);
  printf("parent.document.exttitle = '%s';", v45);
  printf("parent.document.options2g = [];");
  printf("parent.document.options2g[%d] = {'value':'%d', 'text':'%s'};", 0, 6, "B,G,N");
  printf("parent.document.options2g[%d] = {'value':'%d', 'text':'%s'};");
  v46 = printf("parent.document.options2g[%d] = {'value':'%d', 'text':'%s'};", 2, 3, "G only");
  if ( wireless_api_support_onlyb(v46) )
  {
    printf("parent.document.options2g[%d] = {'value':'%d', 'text':'%s'};", 3, 2, "B only");
    v47 = 4;
  }
  else
  {
    v47 = 3;
  }
  printf("parent.document.options2g.length = %d;", v47);
  printf("parent.document.options5g = [];");
  printf("parent.document.options5g[%d] = {'value':'%d', 'text':'%s'};", 0, 10, "11ac/11n");
  printf("parent.document.options5g.length = %d;", 1);
  printf("parent.document.chanwidth2g = [];");
  printf("parent.document.chanwidth5g = [];");
  printf("parent.document.chanwidth5g[%d] = {'value':'%d', 'text':'%s'};", 0, 80, "80 MHz");
  printf("parent.document.chanwidth5g[%d] = {'value':'%d', 'text':'%s'};", 1, 40, "40 MHz");
  printf("parent.document.chanwidth5g[%d] = {'value':'%d', 'text':'%s'};", 2, 20, "20 MHz");
  v49 = get_ux_text_common(67, v48);
  printf("parent.document.chanwidth5g[%d] = {'value':'%d', 'text':'%s'};", 3, 0, v49);
  printf("parent.document.chanwidth5g.length = %d;", 4);
  printf("parent.document.chanwidth2g[%d] = {'value':'%d', 'text':'%s'};", 0, 40, "40 MHz");
  printf("parent.document.chanwidth2g[%d] = {'value':'%d', 'text':'%s'};", 1, 20, "20 MHz");
  v51 = get_ux_text_common(67, v50);
  printf("parent.document.chanwidth2g[%d] = {'value':'%d', 'text':'%s'};", 2, 0, v51);
  printf("parent.document.chanwidth2g.length = %d;", 3);
  if ( v59 > 2 )
  {
    printf("parent.document.mimoant5g = [];");
    v52 = 0;
    while ( v59 > 1 )
    {
      v53 = v52 + 1;
      printf("parent.document.mimoant5g[%d] = {'value':'%d', 'text':'%d X %d'};");
      v52 = v53;
      --v59;
    }
    printf("parent.document.mimoant5g.length = %d;", v52);
  }
  if ( v58 > 2 )
  {
    printf("parent.document.mimoant2g = [];");
    v54 = 0;
    while ( v58 > 1 )
    {
      v55 = v54 + 1;
      printf("parent.document.mimoant2g[%d] = {'value':'%d', 'text':'%d X %d'};");
      v54 = v55;
      --v58;
    }
    printf("parent.document.mimoant2g.length = %d;", v54);
  }
  printf("parent.iframe_extendsetup= true;");
  printf("init_extendsetup(%d);", v14);
  return printf("</script>");
}
// 104B4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10CE8: using guessed type int __fastcall make_country_names(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 12134: using guessed type int __fastcall wireless_api_support_onlyb(_DWORD);

//----- (0002CA08) --------------------------------------------------------
signed int __fastcall wirelessconf_basicsetup_0(int a1, int a2)
{
  signed int v2; // r4@1
  int v3; // r1@1
  signed int result; // r0@1
  bool v5; // zf@3
  int v6; // r1@7
  int v7; // r0@7
  int v8; // r0@7
  char *v9; // r0@6
  int v10; // r0@9
  signed int v11; // r1@10
  int v12; // r0@12
  int v13; // r0@13
  int v14; // r0@15
  int v15; // r0@16
  int v16; // r0@18
  int v17; // r0@19
  int v18; // r0@21
  int v19; // r0@22
  int v20; // r0@24
  int v21; // r0@25
  int v22; // r0@27
  int v23; // r0@28
  int v24; // r1@30
  int v25; // r0@30
  int v26; // r1@30
  int v27; // r4@30
  void *v28; // r0@30
  void *v29; // r0@30
  int v30; // r1@30
  int v31; // r0@30
  int v32; // r1@30
  int v33; // r0@30
  int v34; // [sp+0h] [bp-88h]@12

  v2 = sub_2847C(0, a2);
  result = sub_2847C(1u, v3);
  if ( v2 == 1 || result == 1 )
    return result;
  v5 = v2 == 2;
  if ( v2 != 2 )
    v5 = result == 2;
  if ( v5 )
  {
    print_start_main_table(result);
    v7 = get_ux_text_common(936, v6);
    v8 = print_message_box(v7);
    result = print_end_main_table(v8);
  }
  else
  {
    puts("<style type=\"text/css\">");
    puts(".wl_main_table {");
    puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
    puts("\ttable-layout:fixed;");
    puts("}");
    puts(".wl_main_tr {");
    puts("\tborder:0 0 0 0; padding:0 0 0 0;");
    puts("}");
    puts(".wl_main_td {");
    puts("\tpadding:0 0 0 0; font-size:12px;");
    puts("\tvertical-align:middle;");
    puts("}");
    puts(".wl_main_button {");
    puts("\tpadding:0 1 0 1; margin:0 0 0 0; font-size:12px;");
    puts("\tvertical-align:middle;");
    puts("}");
    printf("</style>");
    print_js_file((int)"wirelessconf", (int)"basicsetup");
    printf("<body style=\"padding:0; margin:0;\">");
    printf("<table class=\"v3_table wl_main_table\">");
    printf("<form method=\"get\" action=\"timepro.cgi\" name=\"wireless_main_fm\" style=\"padding:0; margin:0;\">");
    printf("<input type=\"hidden\" name=\"tmenu\" value=\"wirelessconf\">");
    printf("<input type=\"hidden\" name=\"smenu\" value=\"basicsetup\">");
    v9 = getenv("REMOTE_ADDR");
    if ( v9 && (v10 = get_wireless_mode_by_ipaddr(v9)) != 0 )
      v11 = v10 != 2;
    else
      v11 = -1;
    printf("<input type=\"hidden\" name=\"connmode\" value=\"%d\">", v11);
    printf("<tr height=\"509px\" class=\"wl_main_tr\"><td class=\"wl_main_td\">");
    printf("<div style=\"padding:0; margin:0; width:100%%; height:509px; overflow:auto;\">");
    printf("<table class=\"v3_table wl_main_table\">");
    printf("<tr class=\"wl_main_tr\"><td class=\"wl_main_td\">");
    v12 = snprintf((char *)&v34, 0x80u, (const char *)&unk_8EA38);
    if ( is_mobile_agent(v12) )
    {
      print_div_m_str((int)"100%", (int)"100%", (int)"display:inline-block; *display:inline; zoom:1;");
      v13 = printf(
              "<iframe name=\"multibssid_iframe\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scrolling=no></iframe>",
              &v34);
      print_div_m_etr(v13);
    }
    else
    {
      printf(
        "<iframe name=\"multibssid_iframe\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scrolling=no></iframe>",
        &v34);
    }
    printf("</td></tr>");
    printf("<tr class=\"wl_main_tr\"><td class=\"wl_main_td\">");
    v14 = snprintf((char *)&v34, 0x80u, "timepro.cgi?tmenu=iframe&smenu=basicsetup&wlmode=%d", 1);
    if ( is_mobile_agent(v14) )
    {
      print_div_m_str((int)"144", (int)"100%", (int)"display:inline-block; *display:inline; zoom:1;");
      v15 = printf(
              "<iframe name=\"basicsetup_iframe\" src=\"%s\" frameborder=no width=100%% height=144px align=center scrolling=no></iframe>",
              &v34);
      print_div_m_etr(v15);
    }
    else
    {
      printf(
        "<iframe name=\"basicsetup_iframe\" src=\"%s\" frameborder=no width=100%% height=144px align=center scrolling=no></iframe>",
        &v34);
    }
    printf("</td></tr>");
    printf("<tr class=\"wl_main_tr\" id=\"extline\"><td class=\"wl_main_td\">");
    v16 = snprintf((char *)&v34, 0x80u, (const char *)&unk_8EBC7);
    if ( is_mobile_agent(v16) )
    {
      print_div_m_str((int)"100%", (int)"100%", (int)"display:inline-block; *display:inline; zoom:1;");
      v17 = printf(
              "<iframe name=\"extendsetup_iframe\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scroll"
              "ing=no></iframe>",
              &v34);
      print_div_m_etr(v17);
    }
    else
    {
      printf(
        "<iframe name=\"extendsetup_iframe\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scrolling=no></iframe>",
        &v34);
    }
    printf("</td></tr>");
    printf("<tr class=\"wl_main_tr\"><td class=\"wl_main_td\">");
    v18 = snprintf((char *)&v34, 0x80u, "timepro.cgi?tmenu=iframe&smenu=hiddenwlsetup&wlmode=%d", 1);
    if ( is_mobile_agent(v18) )
    {
      print_div_m_str((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
      v19 = printf(
              "<iframe name=\"hiddenwlsetup_iframe\" src=\"%s\" frameborder=no width=0 height=0 align=center scrolling=no></iframe>",
              &v34);
      print_div_m_etr(v19);
    }
    else
    {
      printf(
        "<iframe name=\"hiddenwlsetup_iframe\" src=\"%s\" frameborder=no width=0 height=0 align=center scrolling=no></iframe>",
        &v34);
    }
    v20 = snprintf((char *)&v34, 0x80u, (const char *)&unk_8ED11);
    if ( is_mobile_agent(v20) )
    {
      print_div_m_str((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
      v21 = printf(
              "<iframe name=\"wlsearch_iframe\" src=\"%s\" frameborder=no width=0 height=0 align=center scrolling=no></iframe>",
              &v34);
      print_div_m_etr(v21);
    }
    else
    {
      printf(
        "<iframe name=\"wlsearch_iframe\" src=\"%s\" frameborder=no width=0 height=0 align=center scrolling=no></iframe>",
        &v34);
    }
    printf("</td></tr>");
    printf("</table></div></td></tr>");
    printf("<tr height=\"26px\" class=\"wl_main_tr\"><td class=\"wl_main_td\">");
    printf("<table class=\"v3_table wl_mbssid_table\" height=\"26px\">");
    printf("<COL WIDTH=\"580\"><COL WIDTH=\"%%%%\">");
    printf("<tr class=\"wl_main_tr\"><td class=\"wl_main_td\">");
    v22 = snprintf((char *)&v34, 0x80u, (const char *)&unk_8EE56);
    if ( is_mobile_agent(v22) )
    {
      print_div_m_str((int)"24", (int)"100%", (int)"display:inline-block; *display:inline; zoom:1;");
      v23 = printf(
              "<iframe name=\"wpssetup_iframe\" src=\"%s\" frameborder=no width=100%% height=24px align=center scrolling=no></iframe>",
              &v34);
      print_div_m_etr(v23);
    }
    else
    {
      printf(
        "<iframe name=\"wpssetup_iframe\" src=\"%s\" frameborder=no width=100%% height=24px align=center scrolling=no></iframe>",
        &v34);
    }
    printf("</td><td class=\"wl_main_td\">");
    printf("<button type=\"button\" class=\"wl_main_button\" name=\"apply_btn\" \t\tstyle=\"width:45px; float:right; margin-right:5px;\" onclick=\"onclick_allsubmit();\">");
    v25 = get_ux_text_common(35, v24);
    printf("%s", v25);
    printf("</button>");
    printf("</td></tr></table>");
    printf("</td></tr>");
    printf("</form></table>");
    v27 = get_ux_text_common(1470, v26);
    printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
    puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
    printf("</DIV>");
    puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid; \t\tbox-shadow:5px 5px 20px #888888;\">");
    puts("<table width=\"180\" height=\"70\">");
    printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
    puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
    v28 = get_image_dir();
    printf(
      "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
      v28);
    printf("</SPAN></td>");
    printf(
      "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\t\t<SPAN style=\"vertical-align:middle; di"
      "splay:block; text-align:center;\">%s\n",
      v27);
    printf("</SPAN></td>");
    printf((const char *)&unk_7D215);
    printf("<DIV id=\"%s\" style=\"display:none;\">", "search_mask");
    printf(
      "<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff"
      ";                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50)"
      ";\"                 onclick=\"UnMaskIt(document,'%s');\">\n",
      "search_mask");
    printf("</DIV>");
    puts("<DIV style=\"position:absolute; left:111px; top:128px; width:420px; height:210px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888; overflow:hidden; display:none;\" id=\"loadingwllist\">");
    v29 = get_image_dir();
    printf(
      "<p align=\"center\"><img src=\"/%s/apply_ani.gif\" style=\"width:40px; height:40px; margin-top:20px;\"></p>",
      v29);
    v31 = get_ux_text_common(1471, v30);
    printf("<p align=\"center\" style=\"font-size:16px;\">%s</p>", v31);
    v33 = get_ux_text_common(1472, v32);
    printf("<p align=\"center\" style=\"font-size:16px;\">%s</p>", v33);
    printf("</DIV>");
    puts("<DIV style=\"position:absolute; left:111px; top:128px; width:420px; height:210px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888; overflow:hidden;\" id=\"searchwllist\">");
    printf((const char *)&unk_7D222);
    printf("</body>");
    printf("<script>");
    sub_288A8(0);
    sub_288A8(1);
    printf("init_mainsetup_form();");
    result = printf("</script>");
  }
  return result;
}
// 1121C: using guessed type int __fastcall print_start_main_table(_DWORD);
// 115DC: using guessed type int __fastcall print_end_main_table(_DWORD);
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);
// 11960: using guessed type int __fastcall get_wireless_mode_by_ipaddr(_DWORD);

//----- (0002D044) --------------------------------------------------------
int sub_2D044()
{
  printf("<TR height=20 STYLE=\"background-Color:#%s\">");
  return printf("<TD colspan=4></TD></TR>");
}

//----- (0002D07C) --------------------------------------------------------
int __fastcall sub_2D07C(int a1, int a2)
{
  return memcmp((const void *)(a1 + 4), (const void *)(a2 + 4), 6u);
}

//----- (0002D08C) --------------------------------------------------------
int __fastcall sub_2D08C(int a1)
{
  int v1; // r5@1
  int v2; // r10@1
  int result; // r0@1
  int v4; // r4@2
  int v5; // r11@2
  int v6; // r7@2
  int v7; // r8@6
  int v8; // r10@7
  int v9; // r7@15
  int v10; // r1@15
  void *v11; // r0@18
  const char *v12; // r0@22
  int v13; // r5@26
  int v14; // r7@27
  void *v15; // r0@28
  __int16 v16; // r1@33
  int v17; // r5@33
  char *v18; // r0@33
  size_t v19; // r3@33
  int v20; // r0@36
  char s; // [sp+Ch] [bp-374h]@15
  char v22; // [sp+20Ch] [bp-174h]@1
  char v23; // [sp+30Ch] [bp-74h]@13
  char v24; // [sp+32Ch] [bp-54h]@1
  char v25; // [sp+34Ch] [bp-34h]@6
  __int16 v26; // [sp+350h] [bp-30h]@33
  int v27; // [sp+354h] [bp-2Ch]@1

  v1 = a1;
  v27 = 0;
  v2 = hwinfo_get_max_macauth(a1);
  get_intvalue_post(v1, (int)&unk_8FC4D, (int)&v27);
  strcpy(&v22, "");
  result = get_value_post(v1, "act", &v24, 32);
  if ( !result )
    return result;
  v4 = macdb_read(v27, v2);
  v5 = macauth_get_policy(v27);
  v6 = strcmp(&v24, "unregister");
  if ( v6 )
  {
    if ( strcmp(&v24, "manual_register") )
    {
LABEL_36:
      v20 = macdb_free(v4);
      signal_save(v20);
      return 1;
    }
    if ( !get_value_post(v1, "manual_mac", &v23, 32) )
    {
      macdb_free(v4);
      return 0;
    }
    v9 = macdb_search(v4, &v23);
    strcpy(&s, "");
    get_value_post(v1, "info", &s, 512);
    if ( check_unpermitted_chars(&s) )
      strcpy(&s, "");
    if ( v9 )
    {
      v11 = *(void **)(v9 + 12);
      if ( v11 )
        free(v11);
      *(_DWORD *)(v9 + 12) = strdup(&s);
      macdb_write(v27, v4);
    }
    else if ( *(_DWORD *)v4 < v2 )
    {
      v12 = (const char *)get_ux_text_common(261, v10);
      if ( !strcmp(&s, v12) )
        strcpy(&s, "");
      convert_mac2((int)&v23);
      if ( v5 == 1 )
        wireless_macauth_kickmac(v27, &v23);
      v13 = 0;
      strtomac(&v23, &v25);
      while ( 1 )
      {
        if ( v13 >= *(_DWORD *)v4 )
        {
          v16 = v26;
          v17 = v4 + 16 * *(_DWORD *)v4;
          *(_DWORD *)(v17 + 8) = *(_DWORD *)&v25;
          *(_WORD *)(v17 + 12) = v16;
          v18 = strdup(&s);
          v19 = *(_DWORD *)v4;
          *(_DWORD *)(v17 + 16) = v18;
          *(_DWORD *)v4 = v19 + 1;
          *(_DWORD *)(v4 + 16 * v19 + 4) = 0;
          goto LABEL_34;
        }
        v14 = v4 + 16 * v13;
        if ( !memcmp(&v25, (const void *)(v14 + 8), 6u) )
          break;
        ++v13;
      }
      v15 = *(void **)(v14 + 16);
      if ( v15 )
        free(v15);
      *(_DWORD *)(v4 + 16 * v13 + 16) = strdup(&s);
LABEL_34:
      qsort((void *)(v4 + 4), *(_DWORD *)v4, 0x10u, (__compar_fn_t)sub_2D07C);
      macdb_write(v27, v4);
      wireless_apply_macauth(v27, v4);
    }
  }
  else
  {
    while ( get_value_array_post(v1, "rmmacchk") )
    {
      convert_mac2((int)&v22);
      if ( v5 == 2 )
        wireless_macauth_kickmac(v27, &v22);
      strtomac(&v22, &v25);
      v7 = 0;
      while ( v7 < *(_DWORD *)v4 )
      {
        v8 = v4 + 16 * v7++;
        if ( !memcmp(&v25, (const void *)(v8 + 8), 6u) )
          *(_DWORD *)(v8 + 4) = 1;
      }
      ++v6;
    }
    qsort((void *)(v4 + 4), *(_DWORD *)v4, 0x10u, (__compar_fn_t)sub_2D07C);
    macdb_write(v27, v4);
    wireless_apply_macauth(v27, v4);
    signal_start("fwsched");
  }
  printf(
    "<script>parent.parent.macauth_bsslist.location.href = 'timepro.cgi?tmenu=iframe&smenu=macauth_bsslist&act=refresh&bs"
    "sidx=%d'; </script>",
    v27);
  goto LABEL_36;
}
// 10694: using guessed type int __fastcall macdb_read(_DWORD, _DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10A60: using guessed type int __fastcall strtomac(_DWORD, _DWORD);
// 10C64: using guessed type int __fastcall signal_start(_DWORD);
// 11000: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// 1103C: using guessed type int __fastcall macdb_search(_DWORD, _DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 1136C: using guessed type int __fastcall wireless_macauth_kickmac(_DWORD, _DWORD);
// 11378: using guessed type int __fastcall macdb_free(_DWORD);
// 11534: using guessed type int __fastcall wireless_apply_macauth(_DWORD, _DWORD);
// 116CC: using guessed type int __fastcall macauth_get_policy(_DWORD);
// 11768: using guessed type int __fastcall hwinfo_get_max_macauth(_DWORD);
// 11A8C: using guessed type int __fastcall get_value_array_post(_DWORD, _DWORD);
// 12128: using guessed type int __fastcall macdb_write(_DWORD, _DWORD);

//----- (0002D41C) --------------------------------------------------------
int __fastcall print_iframe_macauth_bss_list(int a1)
{
  int v1; // r4@1
  int v2; // r1@1
  int v3; // r2@1
  int v4; // r4@2
  signed int v5; // r6@4
  signed int v6; // r8@4
  const char *v7; // r1@4
  signed int v8; // r3@6
  int v9; // r4@9
  int v10; // r5@12
  int v11; // r8@13
  void *v12; // r0@13
  void *v13; // r0@13
  int v14; // r1@13
  int v15; // r0@14
  int v16; // r0@16
  int v17; // r1@17
  int v18; // r0@17
  int v19; // r0@19
  const char *v20; // r0@21
  void *v21; // r0@22
  void *v22; // r0@22
  int v23; // r1@22
  int v24; // r0@22
  char *v25; // r0@24
  char *v26; // r8@24
  char *v27; // r1@25
  char *v28; // ST0C_4@27
  int v29; // r0@27
  char *v30; // r1@28
  char *v31; // ST0C_4@30
  int v32; // r0@30
  int v33; // r1@30
  int v34; // r0@32
  void *v35; // r0@32
  const char *v36; // r1@33
  const char *v37; // r1@38
  signed int v39; // [sp+14h] [bp-634h]@8
  int v40; // [sp+18h] [bp-630h]@12
  int v41; // [sp+24h] [bp-624h]@9
  int v42; // [sp+28h] [bp-620h]@13
  int v43; // [sp+59Ch] [bp-ACh]@24
  int v44; // [sp+5BCh] [bp-8Ch]@13
  int v45; // [sp+5DCh] [bp-6Ch]@13
  int v46; // [sp+5FCh] [bp-4Ch]@6
  int v47; // [sp+61Ch] [bp-2Ch]@1

  v1 = a1;
  v47 = 0;
  if ( get_intvalue(a1, &unk_8FC4D, &v47) )
    v4 = SHIWORD(v47);
  else
    v4 = get_wl_mode(v1, v2, v3);
  print_js_file((int)"wirelessconf", (int)"macauth");
  v5 = 0;
  printf("<BODY style=\"padding:0px 0px; margin:0px 0px;\">");
  printf("<form method=get action=timepro.cgi name=bsslist_fm style=\"margin: 0;\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=macauth_bsslist>");
  v6 = 0;
  printf("<input type=hidden name=act >");
  printf("<table style='border-collapse: collapse; width: 100%%;'>");
  printf("<colgroup><COL WIDTH=5%%><COL WIDTH=47%%><COL WIDTH=48%%></colgroup>");
  v7 = "eth2";
  if ( v4 == 1 )
    v7 = "eth1";
  sf_strncpy(&v46, v7, 32);
  wireless_api_get_run(&v46);
  v8 = v4;
  if ( v4 )
    v8 = 1;
  v39 = v8 << 16 * v4;
  while ( 1 )
  {
    v9 = v6 + v39;
    memset(&v41, 0, 0x578u);
    if ( !read_mbssid_conf(v6 + v39, &v41) )
      break;
    if ( v9 == v47 )
      v5 = v6;
    v40 = v6 + 1;
    v10 = macauth_get_policy(v9);
    printf(
      "<TR height=26 ID=bss_row_%d STYLE=\"cursor:pointer; background-Color:#%s\" ONCLICK=\"ClickMacAuthBss(%d, %d);\">",
      v6);
    if ( !v41 )
    {
      v21 = get_image_dir();
      printf(
        "<TD style=\"padding-left:5px; opacity: 0.3;\"><img name=wifi_icon src=\"/%s/wifi_v3_on.png\" style=\" width: 22p"
        "x; height: 22px; \"></TD>",
        v21);
      v22 = getTags((const char *)&v42);
      printf("<TD>%s</TD>", v22);
      printf("<TD ID=bssidx_%d_value>", v9);
      v24 = get_ux_text_common(1437, v23);
      printf("<span style=\"margin-left: 5px; \">%s", v24);
      goto LABEL_23;
    }
    v11 = macauth_get_count(v9);
    wireless_api_get_ifname(v9, &v44);
    get_hwaddr_kernel(&v44, &v45);
    convert_mac(&v45);
    v12 = get_image_dir();
    printf(
      "<TD style=\"padding-left:5px;\"><img name=wifi_icon src=\"/%s/wifi_v3_on.png\" style=\" width: 22px; height: 22px; \"></TD>",
      v12);
    v13 = getTags((const char *)&v42);
    printf((const char *)&unk_8F8B7, v13, &v45);
    printf("<TD ID=bssidx_%d_value>", v9);
    if ( !v10 )
    {
      v15 = get_ux_text_common(925, v14);
      printf("<span style=\"margin-left: 5px; \" class='gray_text'>%s</span>", v15);
      goto LABEL_24;
    }
    if ( v10 == 1 )
    {
      v16 = get_ux_text_common(1411, v14);
      printf("<span style=\"margin-left: 5px; \">%s", v16);
      if ( v11 )
      {
        putchar(40);
        v18 = 144;
LABEL_21:
        v20 = (const char *)get_ux_text_common(v18, v17);
        printf(v20, v11);
        putchar(41);
        goto LABEL_23;
      }
    }
    else
    {
      if ( v10 != 2 )
        goto LABEL_24;
      v19 = get_ux_text_common(1411, v14);
      printf("<span style=\"margin-left: 5px; \">%s", v19);
      if ( v11 )
      {
        putchar(40);
        v18 = 0;
        goto LABEL_21;
      }
    }
LABEL_23:
    printf("</span>");
LABEL_24:
    v25 = getenv("REMOTE_ADDR");
    v26 = "";
    get_internal_pc_hardware_address(v25, &v43);
    convert_mac(&v43);
    printf(
      "<select id=\"bssidx_%d_policy\" style=\"display: none; height: 20px;\" name=\"policy_mode\" onchange=\"SubmitMacAu"
      "thPolicy('%s', %d, %d)\">",
      v9,
      &v43,
      v9,
      v10);
    if ( v10 )
      v27 = "";
    else
      v27 = (char *)&unk_8F6A3;
    v28 = v27;
    v29 = get_ux_text_common(925, (int)v27);
    printf("<option value=\"open\"%s>%s</option>", v28, v29);
    if ( v10 == 1 )
      v30 = (char *)&unk_8F6A3;
    else
      v30 = "";
    v31 = v30;
    v32 = get_ux_text_common(581, (int)v30);
    printf("<option value=\"accept\"%s>%s</option>", v31, v32);
    if ( v10 == 2 )
      v26 = (char *)&unk_8F6A3;
    v34 = get_ux_text_common(582, v33);
    printf("<option value=\"reject\"%s>%s</option>", v26, v34);
    printf("</select>");
    v35 = getTags((const char *)&v42);
    printf("<input type=hidden name=\"m_ssid\" value='%s' disabled>\n", v35);
    if ( v10 )
    {
      v36 = "reject";
      if ( v10 == 1 )
        v36 = "accept";
    }
    else
    {
      v36 = "open";
    }
    printf("<input type=hidden name=\"m_policy\" value=\"%s\" disabled>\n", v36);
    printf("<input type=hidden name=\"m_bssidx\" value=\"%d\" disabled>\n", v9);
    printf("</TD>");
    printf("</TR>");
    v6 = v40;
  }
  while ( v6 <= 3 )
  {
    if ( v6 & 1 )
      v37 = "f7f7f7";
    else
      v37 = "ffffff";
    printf("<TR height=26 STYLE=\"background-Color:#%s\">", v37);
    printf("<TD colspan=%d></TD></TR>", 3);
    ++v6;
  }
  printf("</TABLE>");
  printf("</form>");
  puts("<script>");
  printf("ClickMacAuthBss(%d, %d);", v5, v47);
  puts("</script>");
  puts("<iframe src=\"timepro.cgi?tmenu=iframe&smenu=macauth_bsslist_submit\" name=\"macauth_bsslist_submit\" style=\"display:none;\"></iframe>");
  return puts("</BODY>");
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 107C0: using guessed type int __fastcall get_hwaddr_kernel(_DWORD, _DWORD);
// 108F8: using guessed type int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD);
// 10BA4: using guessed type int __fastcall wireless_api_get_run(_DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);
// 116CC: using guessed type int __fastcall macauth_get_policy(_DWORD);
// 11990: using guessed type int __fastcall read_mbssid_conf(_DWORD, _DWORD);
// 11B64: using guessed type int __fastcall macauth_get_count(_DWORD);
// 11D14: using guessed type int __fastcall wireless_api_get_ifname(_DWORD, _DWORD);

//----- (0002D928) --------------------------------------------------------
int __fastcall print_iframe_macauth_bss_list_submit(int a1, int a2, int a3)
{
  int v3; // r4@1
  const char *v4; // r0@1
  const char *v5; // r5@1
  signed int v6; // r4@2
  const char *v7; // r0@6
  const char *v8; // r4@6
  int v9; // r1@8
  int v10; // r0@9
  int v11; // r0@12
  int v13; // [sp+4h] [bp-14h]@1
  int v14; // [sp+8h] [bp-10h]@1

  v14 = a3;
  v3 = a1;
  v13 = 0;
  v4 = (const char *)get_parameter_value(a1, "act");
  v5 = v4;
  if ( !v4 )
  {
    v6 = -1;
    goto LABEL_19;
  }
  if ( strcmp(v4, "apply") )
  {
    v11 = strcmp(v5, "refresh");
    if ( !v11 )
      v11 = get_intvalue(v3, &unk_8FC4D, &v13);
    goto LABEL_18;
  }
  if ( !get_intvalue(v3, &unk_8FC4B, &v13) )
  {
    v6 = -3;
    goto LABEL_19;
  }
  v7 = (const char *)get_parameter_value(v3, "policy_mode");
  v8 = v7;
  if ( !v7 )
  {
    v6 = -2;
    goto LABEL_19;
  }
  v9 = strcmp(v7, "open");
  if ( v9 )
  {
    if ( !strcmp(v8, "reject") )
    {
      v10 = v13;
      v9 = 2;
    }
    else
    {
      v11 = strcmp(v8, "accept");
      if ( v11 )
        goto LABEL_18;
      v10 = v13;
      v9 = 1;
    }
  }
  else
  {
    v10 = v13;
  }
  v11 = macauth_set_policy(v10, v9);
LABEL_18:
  signal_save(v11);
  v6 = v13;
LABEL_19:
  printf("<BODY>");
  printf("<form method=get action=timepro.cgi name=bsslist_fm>");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=macauth_bsslist_submit>");
  printf("<input type=hidden name=act >");
  printf("<input type=hidden name=policy_mode>");
  printf("<input type=hidden name=m_ssid>");
  printf("<input type=hidden name=m_policy>");
  printf("<input type=hidden name=m_bssidx>");
  printf("</form>");
  if ( v6 >= 0 )
    printf(
      "<script>parent.location.href = \"timepro.cgi?tmenu=iframe&smenu=macauth_bsslist&act=refresh&bssidx=%d\";</script>",
      v6);
  return puts("</BODY>");
}
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 11168: using guessed type int __fastcall macauth_set_policy(_DWORD, _DWORD);
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);

//----- (0002DAD8) --------------------------------------------------------
int __fastcall print_iframe_macauth_dblist(int a1, int a2, int a3)
{
  int v4; // [sp+4h] [bp-Ch]@1
  int v5; // [sp+8h] [bp-8h]@1

  v5 = a3;
  v4 = 0;
  if ( a2 )
    get_intvalue_post(a2, (int)&unk_8FC4D, (int)&v4);
  else
    get_intvalue(a1, &unk_8FC4D, &v4);
  print_js_file((int)"wirelessconf", (int)"macauth");
  printf("<script>");
  printf("</script>");
  puts("<BODY BOTTOMMARGIN=0 RIGHTMARGIN=0 LEFTMARGIN=0 TOPMARGIN=0 MARGINWIDTH=0 MARGINHEIGHT=0 >");
  printf("<form name=\"macauth_dblist_fm\" method=post style=\"margin: 0;\">");
  puts("</form>");
  printf(
    "<iframe src=\"timepro.cgi?tmenu=iframe&smenu=macauth_dblist_submit&bssidx=%d\" name=\"macauth_dblist_submit\" style="
    "\"display: none;\" ></iframe>\n",
    v4);
  return puts("</BODY>");
}
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);

//----- (0002DB7C) --------------------------------------------------------
int __fastcall print_iframe_macauth_dblist_submit(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r7@1
  int v4; // r5@1
  signed int *v5; // r6@8
  int result; // r0@9
  int v7; // r0@10
  int v8; // r0@10
  const char *v9; // r0@11
  char *v10; // r0@13
  int v11; // r9@13
  signed int *v12; // r5@15
  signed int v13; // r4@15
  signed int v14; // t1@20
  signed int v15; // r2@20
  signed int v16; // r10@21
  char v17; // [sp+18h] [bp-80h]@16
  char s; // [sp+38h] [bp-60h]@16
  unsigned __int8 v19; // [sp+58h] [bp-40h]@13
  int v20; // [sp+6Ch] [bp-2Ch]@1

  v2 = a2;
  v3 = a1;
  v20 = 0;
  v4 = hwinfo_get_max_macauth(a1);
  if ( v2 )
    get_intvalue_post(v2, (int)&unk_8FC4D, (int)&v20);
  else
    get_intvalue(v3, &unk_8FC4D, &v20);
  if ( v20 < 0 )
    v20 = 0;
  if ( v2 )
    sub_2D08C(v2);
  v5 = (signed int *)macdb_read(v20, v4);
  if ( v5 )
  {
    print_js_file((int)"wirelessconf", (int)"macauth");
    puts("<BODY BOTTOMMARGIN=0 RIGHTMARGIN=0 LEFTMARGIN=0 TOPMARGIN=0 MARGINWIDTH=0 MARGINHEIGHT=0 >");
    printf("<form name=\"macauth_dblist_fm\" method=post style=\"margin: 0;\">");
    printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
    printf("<input type=hidden name=\"smenu\" value=\"macauth_dblist_submit\">");
    printf("<input type=hidden name=\"act\" value=\"\">");
    v7 = printf("<input type=hidden name=bssidx value=%d>", v20);
    v8 = hwinfo_get_max_macauth(v7);
    printf("<input type=hidden name=\"maxmac_count\" value=\"%d\">", v8);
    printf("<input type=hidden name=\"rmac_count\" value=\"%d\">", *v5);
    printf("<input type=hidden name=\"manual_mac\">");
    printf("<input type=hidden name=\"info\">");
    printf("<table cellspacing=0px cellpadding=0px align=left border=0 width=100%% style='width: 100%%; border-collapse: collapse;'>\n");
    if ( *v5 <= 7 )
      v9 = "<colgroup><COL width=53%%><COL width=39%%><COL width=8%%></colgroup>";
    else
      v9 = "<colgroup><COL width=53%%><COL width=41.5%%><COL width=5.5%%></colgroup>";
    printf(v9);
    strcpy((char *)&v19, "");
    v10 = getenv("REMOTE_ADDR");
    get_internal_pc_hardware_address(v10, &v19);
    v11 = v19;
    if ( v19 )
      v11 = macdb_search(v5, &v19);
    v12 = v5;
    v13 = 0;
    while ( 1 )
    {
      v16 = *v5;
      if ( v13 >= *v5 )
        break;
      snprintf(
        &s,
        0x20u,
        "%02X:%02X:%02X:%02X:%02X:%02X",
        *((_BYTE *)v12 + 8),
        *((_BYTE *)v12 + 9),
        *((_BYTE *)v12 + 10),
        *((_BYTE *)v12 + 11),
        *((_BYTE *)v12 + 12),
        *((_BYTE *)v12 + 13));
      sf_strncpy(&v17, &s, 32);
      convert_mac(&v17);
      v12[4];
      printf(
        "<tr id=\"mac_row_%d\" style=\"cursor:pointer; background-color:#%s; height: 20px;\" onclick=\"ClickMacReg('%d', '%s', '%s');\">",
        v13);
      printf("<td align=left style=\"padding-left:5px;\">");
      if ( v11 == (_DWORD)&v5[4 * v13 + 1] )
        printf("<span style='font: normal normal bold 9pt arial; color:navy;'>");
      printf("%s", &v17);
      if ( v11 == (_DWORD)&v5[4 * v13 + 1] )
        printf("</span>");
      printf("</td>");
      printf("<td align=left style=\"padding-left:5px;\">");
      v14 = v12[4];
      v12 += 4;
      printf("<span title=\"%s\" style=\"color:#888888; overflow:hidden; display:inline-block; white-space:nowrap; text-overflow:ellipsis;\">%s</span>");
      printf("</td>");
      v15 = v13++;
      printf(
        "<td align=left style=\"padding-left:5px;\"><input type=checkbox name=\"rmmacchk\" value=\"%s\" onchange=\"macaut"
        "h_dblist_submit.document.getElementsByName('rmmacchk')[%d].checked = this.checked;\"></td>",
        &s,
        v15);
      puts("</tr>");
    }
    while ( v16 <= 6 )
    {
      ++v16;
      ++v13;
      sub_2D044();
    }
    puts("</table>");
    puts("</form>");
    printf("<script>");
    printf("parent.document.macauth_dblist_fm.innerHTML = document.macauth_dblist_fm.innerHTML;");
    printf("parent.document.macauth_dblist_fm.smenu.value = 'macauth_dblist';");
    printf("</script>");
    macdb_free(v5);
    result = puts("</BODY>");
  }
  else
  {
    result = printf("Memory error: Refresh");
  }
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10694: using guessed type int __fastcall macdb_read(_DWORD, _DWORD);
// 108F8: using guessed type int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);
// 1103C: using guessed type int __fastcall macdb_search(_DWORD, _DWORD);
// 11378: using guessed type int __fastcall macdb_free(_DWORD);
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);
// 11768: using guessed type int __fastcall hwinfo_get_max_macauth(_DWORD);

//----- (0002DF0C) --------------------------------------------------------
int __fastcall print_iframe_macauth_pcinfo(int a1, int a2, int a3)
{
  int v4; // [sp+4h] [bp-Ch]@1
  int v5; // [sp+8h] [bp-8h]@1

  v5 = a3;
  v4 = 0;
  if ( a2 )
    get_intvalue_post(a2, (int)&unk_8FC4D, (int)&v4);
  else
    get_intvalue(a1, &unk_8FC4D, &v4);
  print_js_file((int)"wirelessconf", (int)"macauth");
  printf("<meta name=\"format-detection\" content=\"telephone=no\">");
  puts("<BODY BOTTOMMARGIN=0 RIGHTMARGIN=0 LEFTMARGIN=0 TOPMARGIN=0 MARGINWIDTH=0 MARGINHEIGHT=0 >");
  printf("<form name=\"macauth_pcinfo_fm\" method=post style=\"margin: 0; \">");
  puts("</form>");
  puts("</BODY>");
  printf(
    "<iframe src=\"timepro.cgi?tmenu=iframe&smenu=macauth_pcinfo_status&bssidx=%d\" name=\"macauth_pcinfo_status\" style="
    "\"display:none;\" ></iframe>\n",
    v4);
  return printf(
           "<iframe src=\"timepro.cgi?tmenu=iframe&smenu=macauth_pcinfo_submit&bssidx=%d\" name=\"macauth_pcinfo_submit\""
           " style=\"display:none;\" ></iframe>\n",
           v4);
}
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);

//----- (0002DFB4) --------------------------------------------------------
void __fastcall print_iframe_macauth_pcinfo_status(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r6@1
  int v4; // r7@1
  void *v5; // r0@5
  int v6; // r4@7
  const char *v7; // r1@8
  signed int v8; // r5@11
  int *v9; // r4@11
  int v10; // r8@11
  int *v11; // r6@12
  int v12; // r7@14
  int v13; // r0@15
  int v14; // r1@16
  bool v15; // zf@18
  _BYTE *v16; // r3@21
  int v17; // r8@23
  void *v18; // r7@23
  int v19; // r0@24
  char *v20; // r10@24
  char *v21; // r0@28
  char *v22; // r0@30
  const char *v23; // r1@30
  char *v24; // r0@42
  const char *v25; // r1@43
  int v26; // r2@43
  unsigned int v27; // r7@50
  unsigned int v28; // r11@50
  int v29; // r1@50
  int v30; // r7@50
  int v31; // r9@50
  int v32; // r1@50
  int v33; // r7@50
  int v34; // r10@50
  int v35; // r1@50
  int v36; // r7@50
  int v37; // r1@50
  int v38; // ST28_4@52
  int v39; // r1@52
  char *s1; // ST24_4@52
  int v41; // r1@52
  int v42; // r0@52
  int v43; // ST2C_4@52
  int v44; // r0@52
  char *v45; // ST24_4@54
  int v46; // r1@54
  int v47; // r11@54
  int v48; // r1@54
  int v49; // r0@54
  int v50; // r1@56
  unsigned int v51; // r3@56
  char *v52; // r0@56
  const char *v53; // r2@56
  const char *v54; // r2@58
  char *v55; // r0@58
  int v56; // r3@58
  int v57; // r0@60
  signed int v58; // r1@64
  int v59; // [sp+0h] [bp-3FA8h]@56
  int v60; // [sp+0h] [bp-3FA8h]@58
  int v61; // [sp+4h] [bp-3FA4h]@0
  int v62; // [sp+4h] [bp-3FA4h]@56
  int v63; // [sp+8h] [bp-3FA0h]@56
  int v64; // [sp+Ch] [bp-3F9Ch]@0
  int i; // [sp+30h] [bp-3F78h]@11
  int v66; // [sp+34h] [bp-3F74h]@11
  void *ptr; // [sp+38h] [bp-3F70h]@11
  int v68; // [sp+3Ch] [bp-3F6Ch]@11
  int v69; // [sp+44h] [bp-3F64h]@11
  int v70; // [sp+48h] [bp-3F60h]@41
  int v71; // [sp+4Ch] [bp-3F5Ch]@11
  int v72; // [sp+336Ch] [bp-C3Ch]@4
  int v73; // [sp+3370h] [bp-C38h]@5
  char v74; // [sp+38C0h] [bp-6E8h]@34
  int v75; // [sp+38E4h] [bp-6C4h]@23
  char v76; // [sp+3AC0h] [bp-4E8h]@34
  int v77; // [sp+3AE4h] [bp-4C4h]@17
  int v78; // [sp+3CE4h] [bp-2C4h]@23
  int v79; // [sp+3D64h] [bp-244h]@49
  int v80; // [sp+3DE4h] [bp-1C4h]@42
  int v81; // [sp+3E64h] [bp-144h]@5
  int v82; // [sp+3EE4h] [bp-C4h]@23
  int v83; // [sp+3F24h] [bp-84h]@50
  int v84; // [sp+3F28h] [bp-80h]@50
  int v85; // [sp+3F2Ch] [bp-7Ch]@50
  unsigned int v86; // [sp+3F30h] [bp-78h]@50
  int v87; // [sp+3F50h] [bp-58h]@7
  int v88; // [sp+3F70h] [bp-38h]@50
  int v89; // [sp+3F78h] [bp-30h]@7
  int v90; // [sp+3F7Ch] [bp-2Ch]@1

  v2 = a2;
  v90 = 0;
  v3 = a1;
  v4 = hwinfo_get_max_macauth(a1);
  print_js_file((int)"wirelessconf", (int)"macauth");
  if ( v2 )
    get_intvalue_post(v2, (int)&unk_8FC4D, (int)&v90);
  else
    get_intvalue(v3, &unk_8FC4D, &v90);
  memset(&v72, 0, 0x578u);
  if ( !read_mbssid_conf(v90, &v72) )
    return;
  v5 = getTags((const char *)&v73);
  sf_strncpy(&v81, v5, 128);
  if ( v90 < 0 )
    v90 = 0;
  v6 = SHIWORD(v90);
  if ( !get_active_wl(SHIWORD(v90), &v87, &v89) )
  {
    v7 = "eth2";
    if ( v6 == 1 )
      v7 = "eth1";
    sf_strncpy(&v87, v7, 32);
  }
  v8 = 0;
  v9 = &v69;
  v69 = 0;
  sf_strncpy(&v71, &v87, 32);
  v10 = dhcpd_get_all_dynamic_lease(0, 0);
  ptr = malloc(108 * v10);
  v68 = dhcpd_get_all_dynamic_lease(ptr, v10);
  puts("<BODY BOTTOMMARGIN=0 RIGHTMARGIN=0 LEFTMARGIN=0 TOPMARGIN=0 MARGINWIDTH=0 MARGINHEIGHT=0 >");
  printf("<form name=\"macauth_pcinfo_fm\" method=post style=\"margin: 0; \">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"macauth_pcinfo_status\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  printf("<input type=hidden name=\"bssidx\" value=%d>", v90);
  printf("<input type=hidden name=\"maxmac_count\" value=\"%d\">", v4);
  printf("<table cellspacing=0px cellpadding=0px width=100%% border=0 style='border-collapse: collapse; width: 100%%;'>");
  printf("<colgroup><COL width=\"21%%\"><COL width=\"15%%\"><COL width=\"17%%\"><COL width=\"47%%\"></colgroup>\n");
  v66 = macdb_read(v90, v4);
  wireless_api_get_station_list(&v69);
  for ( i = 0; i < v69; ++i )
  {
    v11 = &v69 + 51 * i + 10;
    convert_mac(&v69 + 51 * i + 10);
    if ( v9[15] != v90 )
      goto LABEL_65;
    if ( v66 )
    {
      v13 = macdb_binary_search(v66, v11);
      v12 = v13;
      if ( v13 )
      {
        v14 = *(_DWORD *)(v13 + 12);
        if ( v14 )
          sf_strncpy(&v77, v14, 512);
      }
    }
    else
    {
      v12 = 0;
    }
    v15 = v66 == 0;
    if ( v66 )
      v15 = v12 == 0;
    if ( v15 || (v16 = *(_BYTE **)(v12 + 12)) == 0 || !*v16 )
    {
      v17 = 0;
      memset(&v82, 0, 0x40u);
      get_ip_by_hwaddr(&v82, v11);
      memset(&v78, 0, 0x80u);
      memset(&v75, 0, 0x200u);
      v18 = ptr;
      while ( v17 < v68 )
      {
        v19 = maccmp((char *)v18 + 20, v11);
        v20 = (char *)v18;
        v18 = (char *)v18 + 108;
        if ( !v19 )
        {
          sf_strncpy(&v78, v20 + 44, 128);
          break;
        }
        ++v17;
      }
      v21 = (char *)convert_euckr_to_utf8(&v78, &v75);
      if ( (_BYTE)v82 )
      {
        if ( (_BYTE)v75 )
        {
          sprintf((char *)&v77, "%s(%s)", &v82, &v75);
          goto LABEL_41;
        }
        v22 = (char *)&v77;
        v23 = (const char *)&v82;
      }
      else
      {
        if ( (_BYTE)v75 )
        {
          v21 = &v76;
          v23 = &v74;
        }
        else
        {
          v23 = "";
        }
        if ( (_BYTE)v75 )
        {
          v22 = v21 + 36;
          v23 += 36;
        }
        else
        {
          v22 = &v76;
        }
        if ( !(_BYTE)v75 )
          v22 += 36;
      }
      strcpy(v22, v23);
    }
LABEL_41:
    if ( v70 & 8 )
    {
      v24 = (char *)&v80;
      if ( v9[57] )
      {
        sprintf((char *)&v80, "%u %% (%d dBm)", v9[24]);
        goto LABEL_49;
      }
      v25 = "%u %%";
      v26 = v9[24];
      goto LABEL_47;
    }
    v24 = (char *)&v80;
    if ( v70 & 1 )
    {
      v25 = "%d Mbps";
      v26 = v9[21];
LABEL_47:
      sprintf(v24, v25, v26);
      goto LABEL_49;
    }
    strcpy((char *)&v80, "");
LABEL_49:
    strcpy((char *)&v79, "");
    if ( v70 & 0x10 )
    {
      memset(&v83, 0, 0x2Cu);
      v27 = v9[18];
      v28 = sub_5B5A0(v9[18], 0x15180u);
      v86 = v28;
      sub_5B648(v27, 0x15180u);
      v30 = v29;
      v31 = calc_mask(v29, 3600);
      v85 = v31;
      sub_5B744(v30, 0xE10u);
      v33 = v32;
      v34 = calc_mask(v32, 60);
      v84 = v34;
      sub_5B744(v33, 0x3Cu);
      v83 = v35;
      v36 = v35;
      get_ux_lang((int)&v88);
      if ( strcmp((const char *)&v88, "kr") )
      {
        if ( !v28 )
        {
          v54 = "%02d:%02d:%02d";
          v55 = (char *)&v79;
          v56 = v31;
          v60 = v34;
          v61 = v36;
          goto LABEL_63;
        }
        v57 = get_ux_text_common(137, v37);
        v53 = "%d%s %02d:%02d:%02d";
        v59 = v57;
        v51 = v28;
        v52 = (char *)&v79;
        v62 = v31;
        v63 = v34;
        v64 = v36;
        goto LABEL_61;
      }
      if ( v28 )
      {
        v38 = get_ux_text_common(137, v37);
        s1 = (char *)get_ux_text_common(417, v39);
        v42 = get_ux_text_common(633, v41);
        v43 = v42;
        v44 = get_ux_text_common(1084, v42);
        snprintf((char *)&v79, 0x80u, "%d%s %d%s %d%s %d%s", v28, v38, v31, s1, v34, v43, v36, v44);
      }
      else if ( v31 )
      {
        v45 = (char *)get_ux_text_common(417, v37);
        v47 = get_ux_text_common(633, v46);
        v49 = get_ux_text_common(1084, v48);
        snprintf((char *)&v79, 0x80u, "%d%s %d%s %d%s", v31, v45, v34, v47, v36, v49);
      }
      else
      {
        if ( v34 )
        {
          v59 = get_ux_text_common(633, v37);
          v63 = get_ux_text_common(1084, v50);
          v51 = v34;
          v62 = v36;
          v52 = (char *)&v79;
          v53 = "%d%s %d%s";
LABEL_61:
          snprintf(v52, 0x80u, v53, v51, v59, v62, v63, v64);
          goto LABEL_64;
        }
        if ( v36 )
        {
          v60 = get_ux_text_common(1084, v37);
          v54 = "%d%s";
          v55 = (char *)&v79;
          v56 = v36;
LABEL_63:
          snprintf(v55, 0x80u, v54, v56, v60, v61);
          goto LABEL_64;
        }
      }
    }
LABEL_64:
    printf(
      "<tr id=\"mac_row_%d\" style=\"cursor:pointer; background-color:#%s; height: 20px; \" onclick=\"ClickMac(%d, '%s', '%s');\">",
      v8);
    v58 = v8++;
    printf(
      "<td name=\"pcmac\" style=\"padding-left:5px; \" onclick=\"ClickMac('%d', '%s', '%s')\">%s</td>",
      v58,
      v11,
      &v75,
      v11,
      &v77);
    printf("<td>%s</td>", &v80);
    printf("<td>%s</td>", &v79);
    printf("<td class = \"gray_text\">%s</td>", &v77);
    printf("</tr>");
LABEL_65:
    v9 += 51;
  }
  while ( v8 <= 6 )
  {
    ++v8;
    sub_2D044();
  }
  puts("</table>");
  puts("</form>");
  puts("</BODY>");
  printf("<script>");
  printf("updatePcInfo();");
  printf("</script>");
  free(ptr);
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10694: using guessed type int __fastcall macdb_read(_DWORD, _DWORD);
// 106AC: using guessed type int __fastcall get_ip_by_hwaddr(_DWORD, _DWORD);
// 108C8: using guessed type int __fastcall dhcpd_get_all_dynamic_lease(_DWORD, _DWORD);
// 10988: using guessed type int __fastcall wireless_api_get_station_list(_DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);
// 11450: using guessed type int __fastcall convert_euckr_to_utf8(_DWORD, _DWORD);
// 11768: using guessed type int __fastcall hwinfo_get_max_macauth(_DWORD);
// 117B0: using guessed type int __fastcall macdb_binary_search(_DWORD, _DWORD);
// 11810: using guessed type int __fastcall get_active_wl(_DWORD, _DWORD, _DWORD);
// 11990: using guessed type int __fastcall read_mbssid_conf(_DWORD, _DWORD);
// 11CB4: using guessed type int __fastcall maccmp(_DWORD, _DWORD);

//----- (0002E7C8) --------------------------------------------------------
int __fastcall wirelessconf_macauth(int a1)
{
  int v1; // r4@1
  int v2; // r1@1
  int v3; // r2@1
  int v4; // r4@1
  const char *v5; // r1@1
  char *v6; // r0@3
  int v7; // r1@3
  int v8; // r0@3
  int v9; // r1@3
  int v10; // r0@3
  int v11; // r1@3
  int v12; // r0@3
  int v13; // r1@3
  int v14; // r0@3
  int v15; // r0@3
  int v16; // r0@4
  int v17; // r1@6
  int v18; // r0@6
  int v19; // r1@6
  int v20; // r0@6
  int v21; // r1@6
  int v22; // r0@6
  int v23; // r1@6
  int v24; // r0@6
  int v25; // r1@6
  int v26; // r0@6
  int v27; // r1@6
  int v28; // r0@6
  int v29; // r1@6
  int v30; // r0@6
  int v31; // r0@6
  int v32; // r0@7
  int v33; // r1@9
  int v34; // r0@9
  const char *v35; // r4@9
  int v36; // r0@9
  int v37; // r1@9
  int v38; // r4@9
  void *v39; // r0@9
  char v41; // [sp+4h] [bp-44h]@3
  char v42; // [sp+24h] [bp-24h]@3
  int v43; // [sp+34h] [bp-14h]@1

  v1 = a1;
  v43 = 0;
  print_js_file((int)"wirelessconf", (int)"macauth");
  get_intvalue(v1, &unk_8FC4D, &v43);
  v4 = get_wl_mode(v1, v2, v3);
  v5 = "eth2";
  if ( v4 == 1 )
    v5 = "eth1";
  sf_strncpy(&v42, v5, 16);
  v6 = getenv("REMOTE_ADDR");
  get_internal_pc_hardware_address(v6, &v41);
  convert_mac(&v41);
  v43 |= v4 << 16;
  printf("<form method=get action=\"timepro.cgi\" name=\"macauth_fm\">");
  printf("<input type=hidden name=tmenu value=wirelessconf%s>");
  printf("<input type=hidden name=\"smenu\" value=\"macauth\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  printf("<input type=hidden name=\"wl_mode\" value=%d>", v4);
  printf("<input type=hidden name=bssidx>");
  printf("<table border=0 style='width: 100%%; border-collapse: collapse; background-color: #EEE;'>");
  printf("<colgroup><COL width=\"20.5%%\"><COL width=\"15%%\"><COL width=\"17%%\"><COL width=\"32.5%%\"><COL width=\"15%%\"></colgroup>\n");
  printf("<tr><td height=104px colspan=6>");
  printf(
    "<iframe src=\"timepro.cgi?tmenu=iframe&smenu=macauth_bsslist&wl_mode=%d&bssidx=%d\" frameborder=\"no\" scrolling=\"y"
    "es\" name=\"macauth_bsslist\" noresize height=104 width=100%% ></iframe>\n",
    v4,
    v43);
  printf("</td></tr>");
  printf("<tr><td style=\"padding-left:5px; background-color:#e6e6e6; border-style:solid; border-color:#c5c5c5; border-width:1px;\" height=30px colspan=6>");
  printf("<p id=ssid_status></p>");
  printf("</td></tr>");
  printf("<tr height=25px>");
  v8 = get_ux_text_common(576, v7);
  printf(
    "<td align=left style=\"padding-left:5px; border-style:solid none solid solid; border-width:1px; border-color:#dddddd"
    ";\"><span>%s</span></td>",
    v8);
  v10 = get_ux_text_common(585, v9);
  printf(
    "<td style=\"border-style:solid none solid none; border-width:1px; border-color:#dddddd;\"><span>%s</span>",
    v10);
  v12 = get_ux_text_common(577, v11);
  printf(
    "<td style=\"border-style:solid none solid none; border-width:1px; border-color:#dddddd;\"><span>%s</span>",
    v12);
  v14 = get_ux_text_common(579, v13);
  printf(
    "<td style=\"border-style:solid none solid none; border-width:1px; border-color:#dddddd;\" colspan=2 ><span>%s</span>",
    v14);
  printf("</tr>");
  v15 = printf("<tr><td colspan=6>");
  if ( is_mobile_agent(v15) )
  {
    print_div_m_str((int)"140px", (int)"100%", (int)"display:inline-block;");
    v16 = printf("<iframe frameborder=\"no\" scrolling=\"yes\" name=\"macauth_pcinfo\" noresize height=140 width=100%% ></iframe>\n");
    print_div_m_etr(v16);
  }
  else
  {
    printf("<iframe frameborder=\"no\" scrolling=\"yes\" name=\"macauth_pcinfo\" noresize height=140 width=100%% ></iframe>\n");
  }
  printf("</td></tr>");
  printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=6></td></tr>");
  v18 = get_ux_text_common(572, v17);
  printf("<tr><td height=30px colspan=6 style=\"padding-left:5px;\"><b style=\"margin-right:26px;\">%s</b>", v18);
  print_hwadress_inputbox((int)"hw", 0, 0);
  print_nbsp(2);
  v20 = get_ux_text_common(261, v19);
  printf(
    "<input type=text name=\"info\" size=28 maxlength=64 value=\"%s\" onfocus=\"FocusMacAuthInfo();\" style=\"color:#8888"
    "88; height: 18px;\">",
    v20);
  v22 = get_ux_text_common(261, v21);
  printf("<input type=hidden name=\"default_info\" value=\"%s\">", v22);
  v24 = get_ux_text_common(588, v23);
  printf(
    "<button type='button' onclick=\"ManualRegisterMacAuth( '%s' );\" style=\"margin-left:23px; padding-top:0; padding-bo"
    "ttom:0; \"><img src=\"/images2/plus_icon.gif\" style=\"margin: 0 2px 2px 0; \">%s</button>",
    &v41,
    v24);
  printf("</td></tr>");
  printf("<tr height=25px>");
  v26 = get_ux_text_common(580, v25);
  printf(
    "<td colspan=3 align=left style=\"padding-left:5px; border-style:solid none solid solid; border-width:1px; border-col"
    "or:#dddddd;\"><span>%s</span></td>",
    v26);
  v28 = get_ux_text_common(579, v27);
  printf(
    "<td style=\"padding-left:5px; border-style:solid none solid none; border-width:1px; border-color:#dddddd;\"><span>%s</span>",
    v28);
  printf("<td style=\"padding-left:5px; border-style:solid none solid none; border-width:1px; border-color:#dddddd;\">");
  convert_mac2((int)&v41);
  v30 = get_ux_text_common(143, v29);
  printf(
    "<span onclick=\"UnRegisterMacAuth( '%s' );\" style=\"cursor:pointer;\"><img src=\"/images2/minus_icon.gif\" style=\""
    "margin:0 2px 2px 0; \">%s</span>",
    &v41,
    v30);
  printf("<input type=\"checkbox\" name=\"del_allchk\" style=\"float: right; margin-right: 29px;\" onclick=\"CheckAllCheckBox(macauth_dblist.macauth_dblist_submit.document, this, 'rmmacchk');CheckAllCheckBox(macauth_dblist.document, this, 'rmmacchk');\"></td>");
  printf("</tr>");
  v31 = printf("<tr><td colspan=6>");
  if ( is_mobile_agent(v31) )
  {
    print_div_m_str((int)"140px", (int)"100%", (int)"display:inline-block;");
    v32 = printf("<iframe frameborder=\"no\" scrolling=\"yes\" name=\"macauth_dblist\" noresize height=140 width=100%% ></iframe>\n");
    print_div_m_etr(v32);
  }
  else
  {
    printf("<iframe frameborder=\"no\" scrolling=\"yes\" name=\"macauth_dblist\" noresize height=140 width=100%% ></iframe>\n");
  }
  printf("</td></tr>");
  printf("<tr style=\"border-style: solid; border-width:1px 0 1px 0; border-color: #ccc; height: 30px;\"><td colspan=3 align=left>");
  printf("<span style=\"margin-left: 5px;\" class=\"gray_text\">");
  v34 = get_ux_text_common(600, v33);
  v35 = (const char *)v34;
  v36 = hwinfo_get_max_macauth(v34);
  printf(v35, v36);
  printf("</span>");
  printf("</td><td colspan=3 align=right></td></tr>");
  printf("</form>");
  printf("</table>");
  printf("<script>");
  printf("addEvent();");
  printf("</script>");
  v38 = get_ux_text_common(34, v37);
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v39 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v39);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:"
    "middle; display:block; text-align:center;\">%s\n",
    v38);
  printf("</SPAN></td>");
  return printf((const char *)&unk_7D215);
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 108F8: using guessed type int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 11768: using guessed type int __fastcall hwinfo_get_max_macauth(_DWORD);
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (0002EC90) --------------------------------------------------------
int sub_2EC90()
{
  printf("<div id=connected_apinfo style=\"display: none;\">");
  printf("<input type=hidden name=m_ssid value=''>");
  printf("<input type=hidden name=m_personal_list value=''>");
  printf("<input type=hidden name=bssid value=''>");
  return printf("</div>");
}

//----- (0002ECD4) --------------------------------------------------------
int __fastcall sub_2ECD4(int a1)
{
  int v1; // r6@1
  int v2; // r1@1
  int v3; // r2@1
  int v4; // r4@1
  const char *v5; // r1@2
  const char *v6; // r1@5
  int v7; // r1@7
  int v8; // r0@7
  int v9; // r1@7
  char *v10; // r5@8
  int v11; // r0@12
  int v12; // r1@12
  char *v13; // r5@13
  int v14; // r0@17
  int v15; // r1@17
  char *v16; // r5@19
  int v17; // r0@20
  int v18; // r1@20
  char *v19; // r5@21
  int v20; // r0@25
  int v21; // r1@25
  int v22; // r0@25
  void *v23; // r0@25
  int v24; // r1@25
  int v25; // r0@25
  int v26; // r1@25
  char *v27; // r8@26
  int v28; // r0@28
  char *v29; // r2@29
  char *v30; // r2@34
  char *v31; // r2@38
  char *v32; // r2@42
  char *v33; // r2@46
  char *v34; // r2@50
  char *v35; // r2@54
  char *v36; // r2@58
  char *v37; // r2@62
  int v38; // r1@65
  char *v39; // r5@66
  int v40; // r0@70
  int v41; // r1@70
  char *v42; // r5@71
  int v43; // r0@75
  int v44; // r1@75
  char *v45; // r5@76
  int v46; // r0@80
  int v47; // r1@80
  int v48; // r0@80
  int v49; // r1@80
  int v50; // r5@80
  char *v51; // r0@80
  int v52; // r0@80
  int v53; // r1@80
  int v54; // r0@80
  int v55; // r1@80
  int v56; // r5@80
  char *v57; // r0@80
  int v58; // r0@80
  int v59; // r1@80
  int v60; // r1@81
  const char *v61; // r0@81
  int v62; // r1@83
  int v63; // r0@83
  const char *v64; // r0@83
  char *v65; // r0@85
  const char *v66; // r2@85
  int *v67; // r3@85
  int v68; // r0@87
  int v69; // r1@90
  int v70; // r0@90
  int v72; // [sp+8h] [bp-BB8h]@7
  char v73; // [sp+580h] [bp-640h]@4
  int v74; // [sp+604h] [bp-5BCh]@4
  int v75; // [sp+750h] [bp-470h]@7
  int v76; // [sp+754h] [bp-46Ch]@25
  int v77; // [sp+7D4h] [bp-3ECh]@25
  int v78; // [sp+7E8h] [bp-3D8h]@28
  int v79; // [sp+7ECh] [bp-3D4h]@25
  int v80; // [sp+864h] [bp-35Ch]@80
  int v81; // [sp+8D0h] [bp-2F0h]@9
  int v82; // [sp+91Ch] [bp-2A4h]@4
  int v83; // [sp+94Ch] [bp-274h]@4
  int v84; // [sp+AF8h] [bp-C8h]@85
  int v85; // [sp+B78h] [bp-48h]@7
  int v86; // [sp+B98h] [bp-28h]@4

  v1 = a1;
  print_js_file((int)"wirelessconf", (int)"multibridge");
  v4 = get_wl_mode(v1, v2, v3);
  if ( v4 == 1 )
    v5 = "eth1";
  else
    v5 = "eth2";
  sf_strncpy(&v86, v5, 16);
  read_wireless_conf(&v73, &v86);
  print_country_code_js((const char *)&v86);
  printf("<form method=post action=timepro.cgi name=mbridge_fm style=\"margin-bottom: 0;\" >");
  printf("<input type=hidden name=tmenu value=wirelessconf%s>");
  printf("<input type=hidden name=smenu value=multibridge>");
  printf("<input type=hidden name=act value=>");
  printf("<input type=hidden name=wl_mode value=%d>", v4);
  printf("<input type=hidden name=mode value=%d>", v74);
  printf("<input type=hidden name=country value=%s>", &v83);
  printf("<input type=hidden name=channel_width value=%d>", v82);
  if ( !strcmp((const char *)&v86, "eth1") )
    v6 = "eth2";
  else
    v6 = "eth1";
  sf_strncpy(&v85, v6, 32);
  read_wireless_conf(&v72, &v85);
  printf("<input type=hidden name=other_wwan_enable value=%d>");
  puts("<table class=v3_table>");
  printf("<tr valign=top><td>");
  printf("<table width=100%% style=\"background-color:#eeeeee; border-collapse:collapse;\" cellpadding=0 cellspacing=0>\n");
  printf("<colgroup><COL width=19%%><COL width=34%%><COL width=31%%><COL width=16%%></colgroup>");
  printf("<tr height=24px style=\"background-color:#FFFFFF; border-bottom: 1px solid #CCC; \">");
  printf("<td id=status_td colspan=4 align=left style=\"padding:0 0 0 5;\">");
  printf("</td>");
  printf("</tr>");
  v8 = get_ux_text_common(645, v7);
  printf("<tr style=\"background-color: #FFFFFF; height: 24px; \"><td style=\"padding-left:5px;\">%s</td>", v8);
  printf("<td colspan=3>");
  puts("<select name=run style= \"width: 205px; height: 20px; border: 1px solid #CCC;\" onchange=\"SetWirelessForm(document, document.mbridge_fm);\">");
  if ( v75 )
  {
    if ( v81 )
      v10 = "selected";
    else
      v10 = "";
  }
  else
  {
    v10 = "";
  }
  v11 = get_ux_text_common(1498, v9);
  printf("<option value=\"wan\" %s>%s</option>\n", v10, v11);
  if ( v75 )
  {
    if ( v81 )
      v13 = "";
    else
      v13 = "selected";
  }
  else
  {
    v13 = "";
  }
  v14 = get_ux_text_common(63, v12);
  printf("<option value=\"bridge\" %s>%s</option>\n", v13, v14);
  if ( v75 || !is_wds_enable(v4) )
    v16 = "";
  else
    v16 = "selected";
  v17 = get_ux_text_common(1434, v15);
  printf("<option value=\"wds\" %s>%s</option>\n", v16, v17);
  if ( is_wds_enable(v4) )
  {
    v19 = "";
  }
  else if ( v75 )
  {
    v19 = "";
  }
  else
  {
    v19 = "selected";
  }
  v20 = get_ux_text_common(1111, v18);
  printf("<option value=\"stop\" %s>%s</option>\n", v19, v20);
  printf("</td>");
  printf("</tr>");
  v22 = get_ux_text_common(908, v21);
  printf("<tr style=\"background-color: #F7F7F7; height: 24px; \"><td style=\"padding-left:5px;\">%s</td>", v22);
  printf("<td colspan=3>");
  v23 = getTags((const char *)&v76);
  printf(
    "<input type=text name=ssid maxlength=32 style=\"width: 205px; padding-left: 4px; border-style:solid;border-color:#88"
    "8;border-width:1px; \" value='%s'>\n",
    v23);
  printf("<input type=hidden name=bssid value=\"%s\">\n", &v77);
  printf("</td>");
  printf("</tr>");
  v25 = get_ux_text_common(48, v24);
  printf(
    "<tr id=\"tr_pw\" style=\"display:none; background-color: #FFFFFF; height: 24px; \"><td style=\"padding-left:5px;\">%s</td>",
    v25);
  printf("<td>");
  puts("<select name=personal_list style=\"width:205px; height: 20px; border: 1px solid #CCC;\" onchange=\"SetWirelessForm(document,document.mbridge_fm);\">");
  if ( v79 )
    v27 = "";
  else
    v27 = "selected";
  v28 = get_ux_text_common(927, v26);
  printf("<option value=\"%s\" %s>%s \n", "nouse", v27, v28);
  if ( v78 == 9 )
  {
    if ( v79 == 4 )
      v29 = "selected";
    else
      v29 = "";
  }
  else
  {
    v29 = "";
  }
  printf("<option value=\"%s\" %s>%s \n", "wpa2psk_aes", v29, "WPA2PSK + AES");
  if ( v78 == 10 )
  {
    v30 = "selected";
    if ( v79 != 4 )
      v30 = "";
  }
  else
  {
    v30 = "";
  }
  printf("<option value=\"%s\" %s>%s", &unk_8C413, v30, &unk_8C425);
  if ( v78 == 5 )
  {
    v31 = "selected";
    if ( v79 != 4 )
      v31 = "";
  }
  else
  {
    v31 = "";
  }
  printf("<option value=\"%s\" %s>%s", "wpapsk_aes", v31, "WPAPSK + AES");
  if ( v78 == 9 )
  {
    v32 = "selected";
    if ( v79 != 5 )
      v32 = "";
  }
  else
  {
    v32 = "";
  }
  printf("<option value=\"%s\" %s>%s \n", "wpa2psk_tkipaes", v32, "WPA2PSK + TKIP/AES");
  if ( v78 == 10 )
  {
    v33 = "selected";
    if ( v79 != 5 )
      v33 = "";
  }
  else
  {
    v33 = "";
  }
  printf("<option value=\"%s\" %s>%s \n", &unk_8C452, v33, &unk_8C468);
  if ( v78 == 5 )
  {
    v34 = "selected";
    if ( v79 != 5 )
      v34 = "";
  }
  else
  {
    v34 = "";
  }
  printf("<option value=\"%s\" %s>%s", "wpapsk_tkipaes", v34, "WPAPSK + TKIP/AES");
  if ( v78 == 5 )
  {
    v35 = "selected";
    if ( v79 != 3 )
      v35 = "";
  }
  else
  {
    v35 = "";
  }
  printf("<option value=\"%s\" %s>%s", "wpapsk_tkip", v35, "WPAPSK + TKIP");
  if ( v78 == 9 )
  {
    v36 = "selected";
    if ( v79 != 3 )
      v36 = "";
  }
  else
  {
    v36 = "";
  }
  printf("<option value=\"%s\" %s>%s", &unk_8C4C3, v36, "WPA2PSK + TKIP");
  if ( v78 == 10 )
  {
    v37 = "selected";
    if ( v79 != 3 )
      v37 = "";
  }
  else
  {
    v37 = "";
  }
  printf("<option value=\"%s\" %s>%s", &unk_8C4BD, v37, &unk_8C4D0);
  if ( v78 == 3 )
  {
    if ( (unsigned int)(v79 - 1) > 1 )
      v39 = "";
    else
      v39 = "selected";
  }
  else
  {
    v39 = "";
  }
  v40 = get_ux_text_common(905, v38);
  printf("<option value=\"%s\" %s>%s%s", "auto_wep", v39, v40, " + WEP");
  if ( v78 == 1 )
  {
    if ( (unsigned int)(v79 - 1) > 1 )
      v42 = "";
    else
      v42 = "selected";
  }
  else
  {
    v42 = "";
  }
  v43 = get_ux_text_common(906, v41);
  printf("<option value=\"%s\" %s>%s%s", "open_wep", v42, v43, " + WEP");
  if ( v78 == 2 )
  {
    if ( (unsigned int)(v79 - 1) > 1 )
      v45 = "";
    else
      v45 = "selected";
  }
  else
  {
    v45 = "";
  }
  v46 = get_ux_text_common(907, v44);
  printf("<option value=\"%s\" %s>%s%s", "key_wep", v45, v46, " + WEP");
  puts("</select>");
  printf("</td>");
  printf("<td>");
  printf("<span id=wpapsk_key>");
  printf(
    "<input type=password size=60 maxlength=64 name=wpapsk_key value='%s' style=\"width:115px;height:20px; margin-right: "
    "5px; padding-left: 4px; ime-mode:disabled; border: 1px solid #CCC; \">",
    &v80);
  printf(
    "<input type=text size=60 maxlength=64 name=wpapsk_key_text style=\"width:115px;height:20px;display:none; margin-righ"
    "t: 5px; padding-left: 4px; ime-mode:disabled; border: 1px solid #CCC; \" value='%s'>",
    &v80);
  v48 = get_ux_text_common(1415, v47);
  printf(
    "<INPUT TYPE=checkbox id=wpapsk_password_view NAME=wpapsk_password_view value=1 style= \"vertical-align: bottom;\" on"
    "click=\"PasswordView(wpapsk_key,wpapsk_key_text,wpapsk_password_view);\" ><label for=wpapsk_password_view> %s</label>",
    v48);
  printf("</span>");
  printf("</td>");
  v50 = get_ux_text_common(35, v49);
  v51 = getenv("REMOTE_ADDR");
  v52 = get_wireless_mode_by_ipaddr(v51);
  printf(
    "<td align=left><input type=button name=apply_bt value=\"%s\" style=\"padding: 0 15px 0 15px; \" onclick=\"ApplyMBrid"
    "ge(document.mbridge_fm,'apply', %d);\"></td>",
    v50,
    v52);
  printf("</tr>");
  v54 = get_ux_text_common(1435, v53);
  printf(
    "<tr id=\"tr_hwaddr\" style=\"background-color: #FFF; height: 24px; \"><td style=\"padding-left:5px;\">%s</td>",
    v54);
  printf("<td colspan=2>");
  print_hwadress_inputbox((int)"wdshw", 0, 0);
  printf("</td>");
  v56 = get_ux_text_common(35, v55);
  v57 = getenv("REMOTE_ADDR");
  v58 = get_wireless_mode_by_ipaddr(v57);
  printf(
    "<td align=left><input type=button name=apply_bt value=\"%s\" style=\"padding: 0 15px 0 15px; \" onclick=\"ApplyMBrid"
    "ge(document.mbridge_fm,'apply', %d)\"></td>",
    v56,
    v58);
  printf("</tr>");
  printf("<tr height=24px style=\"background-color:#eeeeee; border-top: 1px solid #CCC; \">");
  if ( v4 )
  {
    v60 = get_ux_text_common(647, v59);
    v61 = "<td colspan= 3 style=\"padding-left:5;\"><span style=\"margin-left: 2px; \">5GHz %s</span></td>";
  }
  else
  {
    v60 = get_ux_text_common(647, v59);
    v61 = "<td colspan= 3 style=\"padding-left:5;\"><span style=\"margin-left: 2px; \">2.4GHz %s</span></td>";
  }
  printf(v61, v60);
  printf("<td id=\"apscan_button\" onclick=\"startAPScan('%s');\" style=\"cursor:pointer\">", &v86);
  v63 = get_ux_text_common(39, v62);
  printf("<img style=\"border:none\" src=\"/images2/apscan.gif\"> %s", v63);
  printf("</td>");
  printf("</tr>");
  printf("</table>");
  printf("</table></td></tr>");
  printf("<tr style=\"border-style: solid; border-color: #CCC; border-width: 1px 0 1px 0;  \"><td style=\"background-color:#ffffff; padding: 0; \" >");
  v64 = (const char *)get_parameter_value(v1, "act");
  if ( v64 && !strcmp(v64, "apply") )
  {
    v65 = (char *)&v84;
    v66 = (const char *)&unk_920EA;
    v67 = &v86;
  }
  else
  {
    v66 = "timepro.cgi?tmenu=iframe&smenu=ap_list&ifname=%s";
    v65 = (char *)&v84;
    v67 = &v86;
  }
  v68 = snprintf(v65, 0x80u, v66, v67);
  if ( is_mobile_agent(v68) )
  {
    printf("<div style=\"height:360px; width:100%%; -webkit-overflow-scrolling: touch; overflow-y:scroll; overflow-x:hidden; display:inline-block;\">");
    printf(
      "<iframe name=\"iframe_aplist\" src=\"%s\" frameborder=no style=\"width: 100%%; height: 360px;\" align=left; scroll"
      "ing=yes></iframe>",
      &v84);
    printf("</div>");
  }
  else
  {
    printf(
      "<iframe name=\"iframe_aplist\" src=\"%s\" frameborder=no style=\"width: 100%%; height: 360px;\" align=left; scroll"
      "ing=yes></iframe>",
      &v84);
  }
  printf("</td></tr>");
  v70 = get_ux_text_common(1500, v69);
  printf(
    "<tr style=\"height: 51px; background-color: #EEE; \"><td align=left style=\"padding-left:5px;\"><span class=gray_tex"
    "t>%s</span></td></tr>",
    v70);
  puts("</form>");
  printf("</table>");
  printf(
    "<iframe name=\"iframe_mbridge_apply\" src=\"timepro.cgi?tmenu=iframe&smenu=mbridgeapply&ifname=%s\" frameborder=no s"
    "tyle=\"display: none; \" ></iframe>",
    &v86);
  puts("<script>");
  puts("setHWInputsCss( 'wdshw' );");
  printf("SetWirelessForm(document, document.mbridge_fm);");
  printf("addEvent();");
  return printf("</script>");
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 107CC: using guessed type int __fastcall read_wireless_conf(_DWORD, _DWORD);
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);
// 118C4: using guessed type int __fastcall is_wds_enable(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 11960: using guessed type int __fastcall get_wireless_mode_by_ipaddr(_DWORD);

//----- (0002F6FC) --------------------------------------------------------
int __fastcall sub_2F6FC(int a1)
{
  int v1; // r5@1
  void *v2; // r0@1
  int v4; // [sp+0h] [bp-30h]@1

  v1 = a1;
  sf_strncpy(&v4, a1 + 44, 32);
  convert_mac(&v4);
  printf("<div id=connected_apinfo style=\"display: none;\">");
  v2 = getTags((const char *)(v1 + 8));
  printf("<input type=hidden name=m_ssid value='%s'>", v2);
  printf("<input type=hidden name=m_personal_list value=''>");
  printf("<input type=hidden name=bssid value='%s'>", &v4);
  return printf("</div>");
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);

//----- (0002F778) --------------------------------------------------------
int __fastcall sub_2F778(const char *a1, int a2, int a3)
{
  bool v3; // zf@1
  int v4; // r5@1
  const char *v5; // r2@1
  int v6; // r4@1
  signed int v7; // r3@6
  char *v8; // r0@7
  const char *v9; // r1@7
  void *v10; // r0@13
  int v11; // r1@13
  void *v12; // r0@15
  void *v13; // r1@17
  const char *v14; // r0@17
  void *v15; // r0@19
  const char *v16; // r0@25
  void *v17; // r0@26
  int v18; // r1@26
  int v19; // r3@26
  bool v20; // zf@31
  int v21; // r0@39
  int v22; // r1@40
  int v23; // r0@41
  int v24; // r1@44
  const char *v25; // r0@44
  const char *v26; // r0@45
  int v27; // r1@48
  const char *v28; // r0@48
  char v30; // [sp+8h] [bp-40h]@22
  char dest; // [sp+28h] [bp-20h]@7

  v4 = a3;
  v3 = a3 == 0;
  v5 = a1;
  v6 = a2;
  if ( v3 )
    a1 = "<TR height=%d ID=ap_row_%d STYLE=\"cursor:pointer; background-color:#%s\" ONCLICK=\"ClickAP(%d);\">";
  if ( !v3 )
    a1 = "<TR height=%d ID=ap_row_%d class=\"connected\" STYLE=\"cursor:pointer; background-color:#%s\" ONCLICK=\"ClickAP(%d);\">";
  printf(a1, 24, v5);
  v7 = *(_DWORD *)(v6 + 188);
  if ( v7 <= 74 )
  {
    if ( v7 <= 49 )
    {
      v8 = &dest;
      if ( v7 <= 24 )
        v9 = "on_0";
      else
        v9 = "on_50";
    }
    else
    {
      v8 = &dest;
      v9 = "on_75";
    }
  }
  else
  {
    v8 = &dest;
    v9 = "on_100";
  }
  strcpy(v8, v9);
  v10 = get_image_dir();
  printf(
    "<TD style=\"padding-left:5px;\"><img style=\"width:15px; height:15px; margin-left: 3px; \" name=wifi_icon src=\"/%s/"
    "wifi_v3_%s.png\"></TD>",
    v10,
    &dest);
  printf("<TD valign=top style=\"padding-top:5px;\">");
  if ( v4 )
  {
    if ( *(_BYTE *)v6 )
      v12 = getTags((const char *)v6);
    else
      v12 = (void *)get_ux_text_common(924, v11);
    v13 = v12;
    v14 = "<span style=\"max-width: 115px; height:14px; overflow: hidden; text-overflow: ellipsis; display: block; float:"
          " left; margin-right: 4px; \"><b>%s</b></span>";
  }
  else
  {
    if ( *(_BYTE *)v6 )
      v15 = getTags((const char *)v6);
    else
      v15 = (void *)get_ux_text_common(924, v11);
    v13 = v15;
    v14 = "<span style=\"max-width: 115px; height:14px; overflow: hidden; text-overflow: ellipsis; display: block; float:"
          " left; margin-right: 4px; \">%s</span>";
  }
  printf(v14, v13);
  sf_strncpy(&v30, v6 + 128, 32);
  if ( v30 )
  {
    convert_mac(&v30);
    printf("<span class=gray_text>(%s)</span>", &v30);
  }
  printf("</TD>");
  printf("<TD>");
  if ( !*(_DWORD *)(v6 + 204) )
  {
    v16 = "<span style=\"line-height:200%%\" class=gray_text>";
LABEL_30:
    printf(v16);
    goto LABEL_40;
  }
  printf("<span class=gray_text>");
  v17 = add_image_prefix();
  printf("<img style=\"margin-top:5px;\" src=\"%s\" border=0> ", v17);
  v19 = *(_DWORD *)(v6 + 208);
  if ( (unsigned int)(v19 - 9) <= 1 )
  {
    v16 = "WPA2";
    goto LABEL_30;
  }
  if ( v19 == 5 )
  {
    v16 = "WPA";
    goto LABEL_30;
  }
  v20 = v19 == 8;
  if ( v19 != 8 )
    v20 = v19 == 11;
  if ( v20 )
  {
    v16 = "WPA2-Enterprise";
    goto LABEL_30;
  }
  if ( v19 == 4 )
  {
    v16 = "WPA-Enterprise";
    goto LABEL_30;
  }
  if ( (unsigned int)(*(_DWORD *)(v6 + 204) - 1) <= 1 )
  {
    v16 = "WEP";
    goto LABEL_30;
  }
  v21 = get_ux_text_common(1358, v18);
  printf("(%s)", v21);
LABEL_40:
  printf("</span>");
  printf("</TD>");
  if ( v4 == 1 )
  {
    v23 = get_ux_text_common(1433, v22);
    printf("<TD><span id=ap_status>%s</span></TD>", v23);
  }
  else
  {
    printf("<TD></TD>");
  }
  if ( *(_DWORD *)(v6 + 168) )
  {
    printf("<TD align=left>");
    printf("<p class=gray_text>");
    v25 = (const char *)get_ux_text_common(68, v24);
    printf(v25, *(_DWORD *)(v6 + 168));
    printf("</p>");
    printf("</TD>");
    printf("<TD align=right style=\"padding-right:5px;\">");
    if ( v4 )
      v26 = "<p id=norm_power class=gray_text style=\"margin-top:1px; padding-top:1px;\">%d%%";
    else
      v26 = "<p class=gray_text style=\"margin-top:1px; padding-top:1px;\">%d%%";
    printf(v26, *(_DWORD *)(v6 + 188));
  }
  else
  {
    printf("<TD colspan= 2 align=left style=\"padding-right:5px;\">");
    printf("<p class=gray_text>");
    v28 = (const char *)get_ux_text_common(612, v27);
    printf(v28);
    printf("</p>");
  }
  printf("</TD>");
  printf("<TD></TD>");
  return printf("</TR>");
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);

//----- (0002FAB0) --------------------------------------------------------
int __fastcall sub_2FAB0(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r6@1
  void *v4; // r0@1
  int v6; // [sp+0h] [bp-50h]@1

  v2 = a1;
  v3 = a2;
  printf("<div id=connected_apinfo style=\"display: none;\">");
  v4 = getTags((const char *)(v2 + 468));
  printf("<input type=hidden name=m_ssid value='%s'>", v4);
  reconvert_auth_enc(*(_DWORD *)(v2 + 616), *(_DWORD *)(v2 + 620), (char *)&v6);
  printf("<input type=hidden name=m_personal_list value='%s'>", &v6);
  printf("<input type=hidden name=m_wpapsk value='%s'>", v2 + 740);
  printf("<input type=hidden name=bssid value='%s'>", v3);
  return printf("</div>");
}

//----- (0002FB3C) --------------------------------------------------------
int __fastcall sub_2FB3C(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r5@1
  void *v4; // r0@3
  int result; // r0@3
  int v6; // [sp+0h] [bp-70h]@3
  char v7; // [sp+40h] [bp-30h]@1

  v2 = a1;
  v3 = a2;
  sf_strncpy(&v7, a1 + 128, 32);
  convert_mac(&v7);
  if ( v3 )
    printf("<div id=connected_apinfo style=\"display: none;\">");
  v4 = getTags((const char *)v2);
  printf("<input type=hidden name=m_ssid value='%s'>", v4);
  reconvert_auth_enc(*(_DWORD *)(v2 + 208), *(_DWORD *)(v2 + 204), (char *)&v6);
  printf("<input type=hidden name=m_personal_list value='%s'>", &v6);
  result = printf("<input type=hidden name=bssid value='%s'>", &v7);
  if ( v3 )
    result = printf("</div>");
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);

//----- (0002FBE4) --------------------------------------------------------
int __fastcall sub_2FBE4(int a1, int a2)
{
  int v2; // r6@1
  int v3; // r2@1
  int v4; // r1@1
  int result; // r0@2
  int v6; // [sp+0h] [bp-410h]@3
  char v7; // [sp+200h] [bp-210h]@3

  v2 = a2;
  v3 = *(_DWORD *)(a2 + 188);
  v4 = *(_DWORD *)(a1 + 188);
  if ( v4 == v3 )
  {
    sf_strncpy(&v7, a1, 512);
    sf_strncpy(&v6, v2, 512);
    strtoupper(&v7);
    strtoupper(&v6);
    result = strcmp(&v7, (const char *)&v6);
  }
  else
  {
    result = v4 < v3;
  }
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 11300: using guessed type int __fastcall strtoupper(_DWORD);

//----- (0002FC5C) --------------------------------------------------------
int __fastcall sub_2FC5C(int a1)
{
  int v1; // r4@1
  int v2; // r1@2
  int v3; // r2@2
  int v4; // r6@3
  const char *v5; // r1@3
  int v6; // r0@27
  int v7; // r0@27
  char v9; // [sp+4h] [bp-6D4h]@5
  int v10; // [sp+1D4h] [bp-504h]@6
  int v11; // [sp+1D8h] [bp-500h]@15
  int v12; // [sp+26Ch] [bp-46Ch]@17
  int v13; // [sp+270h] [bp-468h]@17
  char v14; // [sp+2E8h] [bp-3F0h]@19
  int v15; // [sp+354h] [bp-384h]@6
  char v16; // [sp+358h] [bp-380h]@27
  int v17; // [sp+378h] [bp-360h]@20
  int v18; // [sp+57Ch] [bp-15Ch]@8
  int v19; // [sp+584h] [bp-154h]@26
  int v20; // [sp+5A8h] [bp-130h]@7
  int v21; // [sp+5BCh] [bp-11Ch]@26
  int v22; // [sp+628h] [bp-B0h]@26
  int v23; // [sp+63Ch] [bp-9Ch]@7
  int v24; // [sp+67Ch] [bp-5Ch]@1
  int v25; // [sp+69Ch] [bp-3Ch]@5
  int v26; // [sp+6BCh] [bp-1Ch]@21

  v1 = a1;
  if ( !get_value_post(a1, "act", &v24, 32) || strcmp((const char *)&v24, "apply") )
    return 0;
  v4 = get_wl_mode_post(v1, v2, v3);
  v5 = "eth2";
  if ( v4 == 1 )
    v5 = "eth1";
  sf_strncpy(&v25, v5, 32);
  read_wireless_conf(&v9, &v25);
  if ( !get_value_post(v1, "run", &v24, 32) )
    return 0;
  v10 = 0;
  v15 = 0;
  while ( wds_get_config(v4, 0, &v18) )
  {
    sf_strncpy(&v23, &v20, 20);
    convert_mac2((int)&v23);
    wds_remove(v4, &v23);
  }
  if ( !strcmp((const char *)&v24, "wan") || !strcmp((const char *)&v24, "bridge") )
  {
    if ( get_value_post(v1, "run", &v23, 32) )
    {
      v10 = 1;
      if ( !strcmp((const char *)&v23, "wan") )
      {
        v15 = 1;
        system((const char *)&unk_92928);
      }
      if ( get_value_post(v1, "ssid", &v23, 64) )
        sf_strncpy(&v11, &v23, 33);
      if ( get_value_post(v1, "personal_list", &v23, 32) )
      {
        convert_auth_enc((const char *)&v23, 0, &v12, &v13);
        if ( (unsigned int)(v13 - 3) > 2 )
        {
LABEL_20:
          v17 = 1;
LABEL_27:
          wireless_api_clear_mbridge_connection_status(&v16);
          write_wireless_conf(&v9, &v25);
          wireless_api_apply_mbssid(v4);
          v6 = signal_start("fwsched");
          v7 = signal_update(v6);
          signal_save(v7);
          return 0;
        }
        if ( get_value_post(v1, "wpapsk_key", &v23, 32) )
        {
          sf_strncpy(&v14, &v23, 65);
          goto LABEL_20;
        }
      }
    }
  }
  else
  {
    if ( strcmp((const char *)&v24, "wds") )
      goto LABEL_27;
    if ( get_intvalue_post(v1, (int)"wl_mode", (int)&v26) )
    {
      memset(&v18, 0, 0xC0u);
      if ( get_value_post(v1, "wdshw", &v23, 32) )
      {
        if ( strlen((const char *)&v23) == 17 )
        {
          sf_strncpy(&v20, &v23, 20);
          convert_mac2((int)&v20);
          if ( !get_value_post(v1, "ssid", &v23, 32) )
            strcpy((char *)&v23, "");
          sf_strncpy(&v21, &v23, 64);
          sf_strncpy(&v19, &v23, 32);
          v22 = v26;
          wds_add(&v18);
          goto LABEL_27;
        }
      }
    }
  }
  return 0;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 107CC: using guessed type int __fastcall read_wireless_conf(_DWORD, _DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10B98: using guessed type int __fastcall wds_remove(_DWORD, _DWORD);
// 10C64: using guessed type int __fastcall signal_start(_DWORD);
// 10F64: using guessed type int __fastcall wireless_api_clear_mbridge_connection_status(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 119F0: using guessed type int __fastcall wds_get_config(_DWORD, _DWORD, _DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);
// 11F24: using guessed type int __fastcall wireless_api_apply_mbssid(_DWORD);
// 11F48: using guessed type int __fastcall write_wireless_conf(_DWORD, _DWORD);
// 120D4: using guessed type int __fastcall wds_add(_DWORD);

//----- (0003000C) --------------------------------------------------------
int sub_3000C()
{
  return printf("<TR ID=ap_row_%d class=\"connected\" style=\"display: none; \" ></TR>", 0);
}

//----- (0003001C) --------------------------------------------------------
int __fastcall sub_3001C(_DWORD *a1, int a2, char *a3, int a4)
{
  char *v4; // r7@1
  _DWORD *v5; // r10@1
  int v6; // r5@1
  char *v7; // r6@2
  int i; // r8@4
  int v9; // r4@9
  signed int v10; // r3@12
  signed int v11; // r9@16
  signed int v12; // r10@18
  int v13; // r2@25
  char *v14; // r0@29
  const char *v15; // r1@29
  void *v16; // r0@37
  void *v17; // r0@37
  char *v18; // r0@39
  int v19; // r1@39
  int v20; // r11@46
  int v21; // r7@49
  const char *v22; // r0@52
  void *v23; // r0@53
  int v24; // r1@53
  bool v25; // zf@60
  int v26; // r0@66
  int v27; // r1@67
  int v28; // r0@70
  int v29; // r1@72
  const char *v30; // r0@72
  const char *v31; // r0@72
  int v32; // r1@73
  int v33; // r1@73
  int v34; // r9@75
  int v35; // r0@80
  int v36; // r0@84
  int v37; // r1@84
  const char *v38; // r0@84
  int v39; // r0@87
  int v40; // r0@89
  int v41; // r1@91
  const char *v42; // r0@91
  int v43; // r1@94
  const char *v44; // r0@94
  int v46; // [sp+0h] [bp-118h]@1
  int v47; // [sp+4h] [bp-114h]@1
  char v48; // [sp+8h] [bp-110h]@2
  char dest; // [sp+DCh] [bp-3Ch]@29
  int v50; // [sp+ECh] [bp-2Ch]@67

  v4 = a3;
  v5 = a1;
  v6 = a2;
  v46 = a2 + 852;
  v47 = a4;
  if ( !get_ifstatus(a2 + 852) || (v7 = &v48, !wireless_api_get_mbridge_status(v46, &v48)) )
    v7 = 0;
  for ( i = 0; i < *v5; ++i )
  {
    if ( !strcmp((const char *)&v5[53 * i + 12], (const char *)(v6 + 468)) )
      goto LABEL_10;
  }
  if ( i == *v5 )
  {
    v9 = 0;
    goto LABEL_11;
  }
LABEL_10:
  v9 = (int)&v5[53 * i + 12];
LABEL_11:
  printf("<TR ID=ap_row_%d class=\"connected\" STYLE=\"height:24px; cursor:pointer; background-color:#%s\" ONCLICK=\"ClickAP(%d);\">");
  if ( v7 )
  {
    v10 = *((_DWORD *)v7 + 47);
  }
  else if ( v9 )
  {
    v10 = *(_DWORD *)(v9 + 188);
  }
  else
  {
    v10 = 0;
  }
  v11 = (signed int)v7;
  if ( v7 )
    v11 = 1;
  v12 = v9;
  if ( v9 )
    v12 = 1;
  if ( v12 & v11 && !*((_DWORD *)v7 + 47) )
  {
    v10 = *(_DWORD *)(v9 + 188);
    *((_DWORD *)v7 + 47) = v10;
  }
  if ( !(v12 | v11) )
  {
    v14 = &dest;
    goto LABEL_36;
  }
  if ( v10 )
    v13 = 0;
  else
    v13 = v11 & 1;
  if ( !v13 && v10 <= 74 )
  {
    if ( v10 > 49 )
    {
      v14 = &dest;
      v15 = "on_75";
      goto LABEL_37;
    }
    v14 = &dest;
    if ( v10 > 24 )
    {
      v15 = "on_50";
      goto LABEL_37;
    }
LABEL_36:
    v15 = "on_0";
    goto LABEL_37;
  }
  v14 = &dest;
  v15 = "on_100";
LABEL_37:
  strcpy(v14, v15);
  v16 = get_image_dir();
  printf(
    "<TD style=\"padding-left:5px;\"><img style=\"height:15px; width:15px; margin-left: 3px; \" name=wifi_icon src=\"/%s/"
    "wifi_v3_%s.png\"></TD>",
    v16,
    &dest);
  printf("<TD style=\"padding-top:2px;\">");
  v17 = getTags((const char *)(v6 + 468));
  printf((const char *)&unk_92ABB, v17);
  strcpy(v4, "");
  if ( v11 && *(_DWORD *)(v6 + 464) )
  {
    v18 = v4;
    v19 = (int)(v7 + 128);
  }
  else
  {
    if ( !v12 )
      goto LABEL_43;
    v18 = v4;
    v19 = v9 + 128;
  }
  sf_strncpy(v18, v19, 32);
LABEL_43:
  if ( *v4 )
  {
    convert_mac(v4);
    printf("<span class=gray_text>(%s)</span>", v4);
  }
  printf("</TD>");
  printf("<TD>");
  if ( v12 )
    v20 = *(_DWORD *)(v9 + 204);
  else
    v20 = *(_DWORD *)(v6 + 620);
  if ( v12 )
    v21 = *(_DWORD *)(v9 + 208);
  else
    v21 = *(_DWORD *)(v6 + 616);
  if ( v20 )
  {
    printf("<span class=gray_text>");
    v23 = add_image_prefix();
    printf("<img style=\"margin-top:5px;\" src=\"%s\" border=0> ", v23);
    if ( (unsigned int)(v21 - 9) > 1 )
    {
      if ( v21 == 5 )
      {
        v22 = "WPA";
      }
      else if ( (unsigned int)(v20 - 1) > 1 )
      {
        v25 = v21 == 8;
        if ( v21 != 8 )
          v25 = v21 == 11;
        if ( v25 )
        {
          v22 = "WPA2-Enterprise";
        }
        else
        {
          if ( v21 != 4 )
          {
            v26 = get_ux_text_common(1358, v24);
            printf("(%s)", v26);
            goto LABEL_67;
          }
          v22 = "WPA-Enterprise";
        }
      }
      else
      {
        v22 = "WEP";
      }
    }
    else
    {
      v22 = "WPA2";
    }
  }
  else
  {
    v22 = "<span style=\"line-height:200%%\" class=gray_text>";
  }
  printf(v22);
LABEL_67:
  printf("</span>");
  printf("</TD>");
  wireless_api_get_mbridge_connection_status(v46, &v50);
  if ( v50 != 3 || is_wds_enable(v47) || *(_DWORD *)(v6 + 464) )
  {
    if ( v50 == 3 )
      v34 = v11 & 1;
    else
      v34 = 0;
    if ( v34 )
    {
      if ( *(_DWORD *)(v6 + 164) <= 2 || wireless_api_get_keyinfo_status(v46) )
      {
        if ( *(_DWORD *)(v6 + 464) && *(_DWORD *)(v6 + 848) )
          v35 = 1709;
        else
          v35 = 607;
      }
      else
      {
        v35 = 609;
      }
      v36 = get_ux_text_common(v35, v27);
      printf("<TD><span id=ap_status>%s</span></TD>", v36);
      printf("<TD align=left>");
      printf("<p class=gray_text>");
      v38 = (const char *)get_ux_text_common(68, v37);
      printf(v38, *((_DWORD *)v7 + 42));
      printf("</p></TD>");
      printf("<TD align=right style=\"padding-right:5px;\">");
      printf("<p id=norm_power class=gray_text style=\"margin-top:1px; padding-top:1px;\">");
      if ( *((_DWORD *)v7 + 47) )
        printf("%d%%");
    }
    else
    {
      if ( v50 )
        v39 = 611;
      else
        v39 = 608;
      v40 = get_ux_text_common(v39, v27);
      printf("<TD><span id=ap_status class=gray_text>%s</span>", v40);
      printf("</TD>");
      if ( v12 && *(_DWORD *)(v9 + 168) )
      {
        printf("<TD align=left>");
        printf("<p class=gray_text>");
        v42 = (const char *)get_ux_text_common(68, v41);
        printf(v42, *(_DWORD *)(v9 + 168));
        printf("</p>");
        printf("</TD>");
        printf("<TD align=right style=\"padding-right:5px;\">");
        v31 = "<p id=norm_power class=gray_text style=\"margin-top:1px; padding-top:1px;\">%d%%";
        goto LABEL_92;
      }
      printf("<TD colspan= 2 align=left style=\"padding-right:5px;\">");
      printf("<p class=gray_text>");
      v44 = (const char *)get_ux_text_common(612, v43);
      printf(v44);
    }
    printf("</p>");
    goto LABEL_96;
  }
  v28 = get_ux_text_common(1109, v27);
  printf("<TD><span id=ap_status class=gray_text>%s</span>", v28);
  printf("</TD>");
  if ( v12 && *(_DWORD *)(v9 + 168) )
  {
    printf("<TD align=left>");
    printf("<p class=gray_text>");
    v30 = (const char *)get_ux_text_common(68, v29);
    printf(v30, *(_DWORD *)(v9 + 168));
    printf("</p>");
    printf("</TD>");
    printf("<TD align=right style=\"padding-right:5px;\">");
    v31 = (const char *)&unk_92B1F;
LABEL_92:
    v33 = *(_DWORD *)(v9 + 188);
    goto LABEL_93;
  }
  printf("<TD colspan= 2 align=left style=\"padding-right:5px;\">");
  v33 = get_ux_text_common(612, v32);
  v31 = "<p class=gray_text>%s</p>";
LABEL_93:
  printf(v31, v33);
LABEL_96:
  printf("</TD>");
  printf("<TD></TD>");
  printf("</TR>");
  return i;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);
// 10EA4: using guessed type int __fastcall wireless_api_get_keyinfo_status(_DWORD);
// 117EC: using guessed type int __fastcall wireless_api_get_mbridge_connection_status(_DWORD, _DWORD);
// 118C4: using guessed type int __fastcall is_wds_enable(_DWORD);
// 11C54: using guessed type int __fastcall wireless_api_get_mbridge_status(_DWORD, _DWORD);
// 12020: using guessed type int __fastcall get_ifstatus(_DWORD);

//----- (0003059C) --------------------------------------------------------
int __fastcall sub_3059C(int a1)
{
  int v1; // r4@1
  void *v2; // r0@1
  int v3; // r1@1
  void *v4; // r0@2
  int v5; // r1@6
  int v6; // r0@6
  int v7; // r1@6
  int v8; // r0@6
  char v10; // [sp+8h] [bp-40h]@4
  char v11; // [sp+28h] [bp-20h]@1

  v1 = a1;
  printf(
    "<TR height=%d ID=ap_row_%d class=\"connected\" STYLE=\"cursor:pointer; background-color:#%s\" ONCLICK=\"ClickAP(%d);\">",
    24);
  strcpy(&v11, "on_0");
  v2 = get_image_dir();
  printf(
    "<TD style=\"padding-left:5px;\"><img style=\"width:15px; height:15px; margin-left: 3px; \" name=wifi_icon src=\"/%s/"
    "wifi_v3_%s.png\"></TD>",
    v2,
    &v11);
  printf("<TD valign=top style=\"padding-top:5px;\">");
  if ( *(_BYTE *)(v1 + 8) )
    v4 = getTags((const char *)(v1 + 8));
  else
    v4 = (void *)get_ux_text_common(924, v3);
  printf(
    "<span style=\"max-width: 115px; height:14px; overflow: hidden; text-overflow: ellipsis; display: block; float: left;"
    " margin-right: 4px; \"><b>%s</b></span>",
    v4);
  sf_strncpy(&v10, v1 + 44, 32);
  if ( v10 )
  {
    convert_mac(&v10);
    printf("<span class=gray_text>(%s)</span>", &v10);
  }
  printf("</TD>");
  printf("<TD><span style=\"line-height:200%%\" class=gray_text></span></TD>");
  v6 = get_ux_text_common(1433, v5);
  printf("<TD><span id=ap_status>%s</span></TD>", v6);
  v8 = get_ux_text_common(612, v7);
  printf((const char *)&unk_92C18, v8);
  printf("<TD></TD>");
  return printf("</TR>");
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);

//----- (000306D0) --------------------------------------------------------
int __fastcall print_iframe_apinfo_status(int a1)
{
  int v1; // r4@1
  int result; // r0@1
  const char *v3; // r0@2
  int v4; // r8@2
  const char *v5; // r0@5
  int v6; // r6@8
  int v7; // r7@12
  int v8; // r5@12
  int *v9; // r4@14
  int v10; // r1@24
  int v11; // r0@24
  int v12; // r1@24
  int v13; // r0@24
  int v14; // r1@24
  int v15; // r0@24
  int v16; // r1@24
  int v17; // r0@24
  int v18; // r1@24
  int v19; // r0@24
  int v20; // r1@24
  int v21; // r0@24
  int v22; // r1@24
  int v23; // r0@24
  int v24; // [sp+0h] [bp-DB10h]@12
  char v25; // [sp+8h] [bp-DB08h]@12
  char v26; // [sp+28h] [bp-DAE8h]@12
  int v27; // [sp+D430h] [bp-6E0h]@12
  int v28; // [sp+D600h] [bp-510h]@12
  char v29; // [sp+D604h] [bp-50Ch]@13
  int v30; // [sp+D784h] [bp-38Ch]@24
  int v31; // [sp+D7FCh] [bp-314h]@12
  int v32; // [sp+D9A8h] [bp-168h]@17
  int v33; // [sp+D9B0h] [bp-160h]@23
  int v34; // [sp+D9D4h] [bp-13Ch]@19
  int v35; // [sp+DA68h] [bp-A8h]@8
  int v36; // [sp+DA88h] [bp-88h]@15
  int v37; // [sp+DAA8h] [bp-68h]@12
  int v38; // [sp+DAC8h] [bp-48h]@2
  int v39; // [sp+DAE8h] [bp-28h]@24
  int v40; // [sp+DAECh] [bp-24h]@11

  v1 = a1;
  result = get_parameter_value(a1, "ifname");
  if ( !result )
    return result;
  sf_strncpy(&v38, result, 32);
  v3 = (const char *)get_parameter_value(v1, "act");
  v4 = (int)v3;
  if ( v3 )
  {
    if ( !strcmp(v3, "scan") )
    {
      if ( !strcmp((const char *)&v38, "eth2") )
        v5 = "wireless_apscan.2g";
      else
        v5 = "wireless_apscan.5g";
      signal_start(v5);
    }
    v6 = 0;
    snprintf((char *)&v35, 0x20u, "apscan.%s", &v38);
    do
    {
      ++v6;
      sleep(1u);
    }
    while ( v6 != 30 && check_process(&v35) );
    get_intvalue(v1, "apply_bss", &v40);
    result = printf(
               "<script>parent.location.href = \"timepro.cgi?tmenu=iframe&smenu=ap_list&ifname=%s&apply_bss=%d\";</script>",
               &v38,
               v40);
  }
  else
  {
    sf_strncpy(&v37, &v38, 32);
    v7 = strcmp((const char *)&v38, "eth1") == 0;
    read_wireless_conf(&v27, &v38);
    memset(&v24, v4, 0xD430u);
    sf_strncpy(&v25, &v37, 32);
    sf_strncpy(&v26, &v31, 8);
    wireless_api_get_ap_list_from_tempfile(&v24);
    print_js_file((int)"wirelessconf", (int)"multibridge");
    printf("<body>");
    printf("<table cellpadding=0 cellspacing=0>");
    v8 = v28;
    if ( v28 )
    {
      if ( v29 )
      {
        sub_3001C(&v24, (int)&v27, (char *)&v36, v7);
        sub_2FAB0((int)&v27, (int)&v36);
        v9 = (int *)&v29;
      }
      else
      {
        v9 = 0;
      }
    }
    else
    {
      v9 = (int *)is_wds_enable(v7);
      if ( v9 )
      {
        v9 = (int *)wds_get_config(v7, v8, &v32);
        if ( v9 )
        {
          while ( v8 < v24 )
          {
            if ( !maccmp(&v24 + 53 * v8 + 44, &v34) )
            {
              v9 = &v24 + 53 * v8 + 12;
              sub_2F778(0, (int)(&v24 + 53 * v8 + 12), 1);
              sub_2FB3C((int)(&v24 + 53 * v8 + 12), 1);
              goto LABEL_24;
            }
            ++v8;
          }
          sub_3059C((int)&v32);
          v9 = &v33;
          sub_2F6FC((int)&v32);
        }
      }
      else
      {
        sub_3000C();
        sub_2EC90();
      }
    }
LABEL_24:
    printf("</table>");
    wireless_api_get_mbridge_connection_status(&v30, &v39);
    printf("<script>");
    printf("printStatus( {");
    printf("\tstatus_list : { ");
    v11 = get_ux_text_common(1109, v10);
    printf("\t\tstopped : \"%s\", ", v11);
    v13 = get_ux_text_common(609, v12);
    printf("\t\tinvalid_pw : \"%s\", ", v13);
    v15 = get_ux_text_common(1709, v14);
    printf("\t\twwan_connected : \"%s\", ", v15);
    v17 = get_ux_text_common(607, v16);
    printf("\t\tbridge_connected : \"%s\", ", v17);
    v19 = get_ux_text_common(1433, v18);
    printf("\t\twds_connected : \"%s\", ", v19);
    v21 = get_ux_text_common(611, v20);
    printf("\t\ttry_connect : \"%s\",", v21);
    v23 = get_ux_text_common(608, v22);
    printf("\t\tconnection_failed: \"%s\"", v23);
    printf("\t},");
    printf("\tifname : \"%s\", ", &v38);
    if ( v9 )
      printf("\tssid : \"%s\"", v9);
    else
      printf("\tssid : \"\"");
    printf("});");
    if ( !v28 || v39 == 3 || !v39 )
      printf("UnMaskIt(parent.parent.document,'apply_mask');");
    printf("</script>");
    result = printf("</body>");
  }
  return result;
}
// 104F0: using guessed type int __fastcall wireless_api_get_ap_list_from_tempfile(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 107CC: using guessed type int __fastcall read_wireless_conf(_DWORD, _DWORD);
// 10C64: using guessed type int __fastcall signal_start(_DWORD);
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);
// 117EC: using guessed type int __fastcall wireless_api_get_mbridge_connection_status(_DWORD, _DWORD);
// 118C4: using guessed type int __fastcall is_wds_enable(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 119F0: using guessed type int __fastcall wds_get_config(_DWORD, _DWORD, _DWORD);
// 11CB4: using guessed type int __fastcall maccmp(_DWORD, _DWORD);
// 11D50: using guessed type int __fastcall check_process(_DWORD);

//----- (00030B48) --------------------------------------------------------
int __fastcall print_iframe_mbridge_apply(int a1, int a2)
{
  int v2; // r4@1
  int result; // r0@2
  int v4; // [sp+0h] [bp-30h]@1

  v2 = a2;
  if ( !get_value(a1, "ifname", &v4, 32) && (result = get_value_post(v2, "ifname", &v4, 32)) == 0 )
    return result;
  sub_2FC5C(v2);
  strcmp((const char *)&v4, "eth1");
  print_js_file((int)"wirelessconf", (int)"multibridge");
  printf("<form method=post action=timepro.cgi name=mbridge_apply_fm>");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=mbridgeapply>");
  printf("<input type=hidden name=ifname value=\"%s\">", &v4);
  printf("<input type=hidden name=act value=>");
  printf("<input type=hidden name=wl_mode value=%d>");
  printf("<input type=hidden name=run>");
  printf("<input type=hidden name=ssid>");
  printf("<input type=hidden name=personal_list>");
  printf("<input type=hidden name=wpapsk_key>");
  printf("<input type=hidden name=wdshw>");
  printf("</form>");
  puts("<script>");
  printf("SetWirelessForm(parent.document, parent.document.mbridge_fm);");
  result = puts("</script>");
  return result;
}
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00030C8C) --------------------------------------------------------
int __fastcall print_iframe_ap_list(int a1)
{
  int v1; // r4@1
  int v2; // r1@1
  const char *v3; // r0@2
  int v4; // r6@3
  const char *v5; // r5@3
  int v6; // r7@3
  signed int v7; // r4@6
  void *v8; // r5@10
  int v9; // r1@10
  int v10; // r0@10
  const char *v11; // r0@11
  const char *v13; // r0@14
  int v14; // r7@14
  const char *v15; // r0@19
  int v16; // r6@21
  int v17; // r5@21
  const char *v18; // r4@22
  signed int v19; // r11@34
  int *v20; // r6@36
  int v21; // r5@36
  const char *v22; // r0@42
  int v23; // r4@45
  const char *v24; // r1@47
  int v25; // r1@51
  int v26; // r0@51
  int s[12]; // [sp+8h] [bp-DE18h]@16
  char base; // [sp+38h] [bp-DDE8h]@18
  int v29; // [sp+D438h] [bp-9E8h]@3
  int v30; // [sp+D608h] [bp-818h]@6
  unsigned __int8 v31; // [sp+D60Ch] [bp-814h]@22
  int v32; // [sp+D78Ch] [bp-694h]@7
  int v33; // [sp+D804h] [bp-61Ch]@16
  int v34; // [sp+D9B0h] [bp-470h]@51
  int v35; // [sp+DBB0h] [bp-270h]@7
  int v36; // [sp+DC84h] [bp-19Ch]@25
  int v37; // [sp+DCB0h] [bp-170h]@27
  signed int v38; // [sp+DD44h] [bp-DCh]@51
  signed int v39; // [sp+DD48h] [bp-D8h]@51
  signed int v40; // [sp+DD4Ch] [bp-D4h]@51
  signed int v41; // [sp+DD50h] [bp-D0h]@51
  int v42; // [sp+DD54h] [bp-CCh]@51
  signed int v43; // [sp+DD74h] [bp-ACh]@51
  int v44; // [sp+DD78h] [bp-A8h]@3
  int v45; // [sp+DD98h] [bp-88h]@23
  int v46; // [sp+DDB8h] [bp-68h]@3
  int v47; // [sp+DDD8h] [bp-48h]@3

  v1 = a1;
  v2 = get_parameter_value(a1, "ifname");
  if ( !v2 )
  {
    v3 = "No ifname Error";
    return printf(v3, v2);
  }
  sf_strncpy(&v47, v2, 32);
  sf_strncpy(&v46, &v47, 32);
  v4 = strcmp((const char *)&v47, "eth1");
  read_wireless_conf(&v29, &v47);
  printf("<meta name=\"format-detection\" content=\"telephone=no\">");
  printf("<BODY style=\"padding:0px 0px; margin:0px 0px;\">");
  print_js_file((int)"wirelessconf", (int)"multibridge");
  v5 = (const char *)get_parameter_value(v1, "act");
  snprintf((char *)&v44, 0x20u, "apscan.%s", &v47);
  v6 = check_process(&v44);
  if ( !v6 && (!v5 || strcmp(v5, "scan")) )
  {
    printf("<table border-collapse=collapse; width=100%%; cellspacing=0; cellpadding=0>");
    v13 = (const char *)get_parameter_value(v1, "apply_bss");
    v14 = (int)v13;
    if ( v13 )
      v14 = atoi(v13);
    memset(s, 0, 0xD430u);
    sf_strncpy(&s[2], &v46, 32);
    sf_strncpy(&s[10], &v33, 8);
    wireless_api_get_ap_list_from_tempfile(s);
    if ( v14 )
      wireless_api_enable_bss(&v46, 1);
    qsort(&base, s[0], 0xD4u, (__compar_fn_t)sub_2FBE4);
    if ( s[0] <= 4 )
      v15 = "<COL WIDTH=4.5%%><COL WIDTH=37%%><COL WIDTH=19%%><COL WIDTH=23.5%%><COL WIDTH=8%%><COL WIDTH=5%%><COL WIDTH=3%%>";
    else
      v15 = "<COL WIDTH=4.5%%><COL WIDTH=40%%><COL WIDTH=19%%><COL WIDTH=23.5%%><COL WIDTH=8%%><COL WIDTH=5%%><COL WIDTH=0%%>";
    v16 = v4 == 0;
    printf(v15);
    v17 = v30;
    if ( v30 )
    {
      v18 = (const char *)v31;
      if ( v31 )
      {
        sub_3001C(s, (int)&v29, (char *)&v45, v16);
        sub_2FAB0((int)&v29, (int)&v45);
LABEL_32:
        v18 = 0;
LABEL_34:
        v19 = 1;
        goto LABEL_36;
      }
    }
    else
    {
      v18 = (const char *)is_wds_enable(v16);
      if ( !v18 )
      {
        sub_3000C();
        sub_2EC90();
        goto LABEL_34;
      }
      v18 = (const char *)wds_get_config(v16, v17, &v36);
      if ( v18 )
      {
        while ( v17 < s[0] )
        {
          if ( !maccmp(&s[53 * v17 + 44], &v37) )
          {
            v18 = (const char *)&s[53 * v17 + 12];
            sub_2F778(0, (int)&s[53 * v17 + 12], 1);
            sub_2FB3C((int)&s[53 * v17 + 12], 1);
            goto LABEL_34;
          }
          ++v17;
        }
        sub_3059C((int)&v36);
        sub_2F6FC((int)&v36);
        goto LABEL_32;
      }
    }
    v19 = (signed int)v18;
LABEL_36:
    v20 = s;
    v21 = 0;
    while ( v21 < s[0] )
    {
      if ( *((_BYTE *)v20 + 48)
        && (!v30 || strcmp((const char *)&s[53 * v21 + 12], (const char *)&v31))
        && (!v18 || strcmp((const char *)&s[53 * v21 + 12], v18)) )
      {
        v22 = (const char *)v19++;
        sub_2F778(v22, (int)&s[53 * v21 + 12], 0);
        sub_2FB3C((int)&s[53 * v21 + 12], 0);
      }
      ++v21;
      v20 += 53;
    }
    v23 = 0;
    while ( v23 < 14 - v19 )
    {
      if ( ((_BYTE)v23 + (_BYTE)v19) & 1 )
        v24 = "f7f7f7";
      else
        v24 = "ffffff";
      ++v23;
      printf("<TR STYLE=\"height: 24px; background-color:#%s\">", v24);
      printf("<TD colspan=%d></TD></TR>", 7);
    }
    printf("</TABLE>");
    printf("</form>");
    memset(&v38, 0, 0x34u);
    v38 = 65;
    v39 = 144;
    v40 = 500;
    v41 = 24;
    strcpy((char *)&v42, (const char *)&unk_86952);
    v43 = 100;
    v26 = get_ux_text_common(38, v25);
    snprintf((char *)&v34, 0x200u, "<span class=\"gray_text\">%s</span>", v26);
    print_mask_0((int)"apscan_guide_mask", (int)&v34, (int)&v38);
    puts("<script>");
    printf("ClickAP();");
    puts("</script>");
    printf(
      "<iframe name=\"iframe_update_apinfostatus\" src=\"timepro.cgi?tmenu=iframe&smenu=apinfostatus&ifname=%s\" framebor"
      "der=no style=\"display: none; \" ></iframe>",
      &v47);
    printf("<script>");
    printf("EnableObj2(parent.document.getElementById('bridge_frequency'));");
    printf("EnableObj2(parent.document.getElementsByName('run')[0]);");
    printf("EnableObj2(parent.document.getElementsByName('apply_bt')[0]);");
    printf("EnableObj2(parent.document.getElementsByName('apply_bt')[1]);");
    puts("enableAPScan(parent.document);");
    v3 = "</script>";
    return printf(v3, v2);
  }
  printf("<table cellspacing=0 cellpadding=0 style=\"border-collapse: collapse; width: 100%%;\">");
  v7 = v30;
  if ( v30 )
  {
    if ( wireless_api_get_mbridge_status(&v32, &v35) )
    {
      v7 = 0;
    }
    else
    {
      v7 = 1;
      wireless_api_enable_bss(&v46, 0);
    }
  }
  v8 = get_image_dir();
  v10 = get_ux_text_common(1515, v9);
  printf(
    "<tr height=312><td width=230 align=right valign=center style=\"padding-top:11px; \"><img src=\"/%s/apply_ani.gif\"><"
    "/td><td style=\"padding:3 0 0 2; padding-top: 11px;\" align=left>%s</td></tr>",
    v8,
    v10);
  printf("</table>");
  puts("<script>");
  puts("DisableAllObj2(parent.document.mbridge_fm);");
  printf("UnMaskIt(parent.document,'apply_mask');");
  puts("</script>");
  if ( v6 )
    v11 = "<iframe name=\"iframe_update_apinfostatus\" src=\"timepro.cgi?tmenu=iframe&smenu=apinfostatus&act=wait&ifname="
          "%s&apply_bss=%d\" frameborder=no style=\"display: none; \" ></iframe>";
  else
    v11 = "<iframe name=\"iframe_update_apinfostatus\" src=\"timepro.cgi?tmenu=iframe&smenu=apinfostatus&act=scan&ifname="
          "%s&apply_bss=%d\" frameborder=no style=\"display: none; \" ></iframe>";
  return printf(v11, &v47, v7);
}
// 104F0: using guessed type int __fastcall wireless_api_get_ap_list_from_tempfile(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 107CC: using guessed type int __fastcall read_wireless_conf(_DWORD, _DWORD);
// 11780: using guessed type int __fastcall wireless_api_enable_bss(_DWORD, _DWORD);
// 118C4: using guessed type int __fastcall is_wds_enable(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 119F0: using guessed type int __fastcall wds_get_config(_DWORD, _DWORD, _DWORD);
// 11C54: using guessed type int __fastcall wireless_api_get_mbridge_status(_DWORD, _DWORD);
// 11CB4: using guessed type int __fastcall maccmp(_DWORD, _DWORD);
// 11D50: using guessed type int __fastcall check_process(_DWORD);
// 30C8C: using guessed type int s[12];

//----- (000312BC) --------------------------------------------------------
int __fastcall wirelessconf_multibridge(int a1)
{
  int v1; // r1@1
  int v2; // r5@1
  void *v3; // r0@1

  sub_2ECD4(a1);
  v2 = get_ux_text_common(34, v1);
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v3 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v3);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:"
    "middle; display:block; text-align:center;\">%s\n",
    v2);
  printf("</SPAN></td>");
  return printf((const char *)&unk_7D215);
}

//----- (00031378) --------------------------------------------------------
int __fastcall print_init_name(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // r5@1
  int v6; // r4@1
  int v7; // r6@1
  int v8; // r8@1

  v5 = a1;
  v6 = a2;
  v7 = a3;
  v8 = a4;
  puts("<form method=get action=timepro.cgi name=wizard>");
  puts("<input type=hidden name=tmenu value=wirelesswizard>");
  printf("<input type=hidden name=step value=%d>\n", v5);
  if ( v6 )
    printf("<input type=hidden name=ifname value=%s>\n", v6);
  if ( v7 )
    printf("<input type=hidden name=country value=%s>\n", v7);
  if ( v8 )
    printf("<input type=hidden name=ssid value=\"%s\">\n", v8);
  if ( a5 )
    printf("<input type=hidden name=channel value=%s>\n", a5);
  puts("<input type=hidden name=commit value=>");
  return puts("<input type=hidden name=nextstep value=>");
}

//----- (00031434) --------------------------------------------------------
int __fastcall print_iframe_checkssid(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r5@1
  const char *v4; // r0@3
  bool v5; // zf@3
  int v6; // r1@11
  const char *v7; // r0@11
  int v8; // r0@11
  int v9; // r1@11
  const char *v10; // r0@11
  int v11; // r7@13
  struct_name *v12; // r5@14
  int v13; // r1@14
  signed int v14; // r6@18
  int v15; // r0@22
  const char *v16; // r0@23
  int v17; // r0@23
  const char *v18; // r0@24
  int v19; // r1@25
  int v20; // r4@26
  int v21; // r1@26
  int v22; // r0@26
  int v23; // r0@27
  const char *v24; // r0@29
  char v26; // [sp+8h] [bp-E8h]@1
  char v27; // [sp+88h] [bp-68h]@1
  char s1; // [sp+A8h] [bp-48h]@1
  char v29; // [sp+C8h] [bp-28h]@1

  v2 = a2;
  v3 = a1;
  get_value(a1, "country", &v29, 16);
  strcpy(&s1, "");
  get_value(v3, "stage", &s1, 32);
  strcpy(&v26, "");
  get_value(v3, "ssid", &v26, 128);
  if ( !get_value(v3, "ifname", &v27, 32) )
    strcpy(&v27, "eth2");
  v4 = (const char *)strcmp(&s1, "init");
  v5 = v4 == 0;
  if ( !v4 )
    v4 = "<body class=check_ssid_body>";
  if ( !v5 )
    v4 = "<body class=gray_body>";
  puts(v4);
  puts("<form method=get action=timepro.cgi name=check_fm>");
  puts("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=%s>\n");
  printf("<input type=hidden name=country value=%s>\n", &v29);
  puts("<input type=hidden name=ssid value=>");
  printf("<input type=hidden name=ifname value=%s>\n", &v27);
  if ( !strcmp(&s1, "init") )
  {
    puts("<input type=hidden name=stage value=start>");
  }
  else if ( !strcmp(&s1, "start") )
  {
    if ( v2 )
    {
      printf("<script>");
      printf("DisableObj(parent.document.wizard.ovtest_bt);");
      printf("DisableObj(parent.document.wizard.ssid);");
      printf("DisableObj(parent.document.wizard.prev_bt);");
      printf("DisableObj(parent.document.wizard.next_bt);");
      printf("</script>");
      v7 = (const char *)get_ux_text_common(1511, v6);
      v8 = printf(v7);
      br(v8);
      v10 = (const char *)get_ux_text_common(1512, v9);
      printf(v10);
    }
    ifup(&v27);
    wireless_api_start_ap_scan(&v27);
    printf("<meta http-equiv=refresh content=\"5; URL=timepro.cgi?tmenu=iframe&smenu=%s&stage=end&country=%s&ssid=%s&ifname=%s\">");
  }
  else
  {
    v11 = strcmp(&s1, "end");
    if ( !v11 )
    {
      puts("<input type=hidden name=stage value=start>");
      v12 = (struct_name *)malloc(0xD430u);
      memset(v12, 0, 0xD430u);
      sf_strncpy(&v12->gap4[4], &v27, 32);
      sf_strncpy(&v12->gap4[36], &v29, 8);
      wireless_api_get_ap_list(v12);
      wireless_api_stop_ap_scan(&v27);
      while ( 1 )
      {
        if ( v11 >= v12->field_0 )
        {
          v14 = 0;
          goto LABEL_20;
        }
        if ( !strcmp(&v26, &v12->gap4[212 * v11 + 44]) )
          break;
        ++v11;
      }
      v14 = 1;
LABEL_20:
      if ( v2 )
      {
        if ( v14 )
        {
          v16 = (const char *)get_ux_text_common(1513, v13);
          v17 = printf(v16);
          br(v17);
          v15 = 1514;
        }
        else
        {
          v15 = 1509;
        }
        v18 = (const char *)get_ux_text_common(v15, v13);
        printf(v18);
        printf("<script>");
        printf("EnableObj(parent.document.wizard.ovtest_bt);");
        printf("EnableObj(parent.document.wizard.ssid);");
        printf("EnableObj(parent.document.wizard.prev_bt);");
        printf("EnableObj(parent.document.wizard.next_bt);");
      }
      else
      {
        printf("<script>");
        if ( v14 )
        {
          v20 = get_ux_text_common(1513, v19);
          v22 = get_ux_text_common(1514, v21);
          printf("alert('%s\\n%s');\n", v20, v22);
        }
        else
        {
          v23 = get_ux_text_common(1510, v19);
          printf("alert('%s');", v23);
        }
        puts("parent.document.getElementById('ssidcheck_msg').style.display = \"none\";");
        puts("parent.document.getElementById('maintable').style.display = \"block\";");
        if ( v14 )
        {
          puts("parent.document.basicsetup_fm.ssid.focus();");
          v24 = "parent.document.basicsetup_fm.ssid.select();";
        }
        else
        {
          v24 = "parent.document.basicsetup_fm.apply_bt.focus();";
        }
        puts(v24);
      }
      printf("</script>");
      free(v12);
    }
  }
  printf("</form>");
  return printf("</body>");
}
// 105A4: using guessed type int __fastcall wireless_api_start_ap_scan(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10688: using guessed type int __fastcall ifup(_DWORD);
// 10874: using guessed type int __fastcall wireless_api_get_ap_list(_DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 118A0: using guessed type int __fastcall wireless_api_stop_ap_scan(_DWORD);

//----- (00031840) --------------------------------------------------------
char *__fastcall get_init_name(int a1, char *a2, int a3, int a4, char *a5)
{
  char *v5; // r4@1
  int v6; // r7@1
  int v7; // r6@1
  int v8; // r5@1
  char *result; // r0@7
  int v10; // [sp+0h] [bp-598h]@4
  char v11; // [sp+4h] [bp-594h]@6
  char v12; // [sp+3CCh] [bp-1CCh]@4

  v5 = a2;
  v6 = a3;
  v7 = a4;
  v8 = a1;
  if ( !get_value(a1, "ifname", a2, 32) )
    strcpy(v5, "eth2");
  if ( !get_value(v8, "country", v6, 16) )
  {
    memset(&v10, 0, 0x578u);
    read_wireless_conf(&v10, v5);
    sf_strncpy(v6, &v12, 16);
  }
  if ( !get_value(v8, "ssid", v7, 128) )
  {
    memset(&v10, 0, 0x578u);
    read_wireless_conf(&v10, v5);
    sf_strncpy(v7, &v11, 128);
  }
  result = (char *)get_value(v8, "channel", a5, 16);
  if ( !result )
    result = strcpy(a5, "11.9");
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 107CC: using guessed type int __fastcall read_wireless_conf(_DWORD, _DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00031960) --------------------------------------------------------
int __fastcall sub_31960(const char *a1, const char *a2, int a3)
{
  const char *v3; // r4@1
  const char *v4; // r5@1
  int v5; // r6@1
  char *v6; // r7@1
  int v7; // r0@2
  int v8; // r5@4
  signed int v9; // r3@6
  int v10; // r0@9
  signed int v11; // r3@9
  int result; // r0@11

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = strchr(a2, 46);
  if ( v6 )
  {
    *v6 = 0;
    v8 = atoi(v4);
    *(_DWORD *)v5 = v8;
    if ( !strcmp(v3, "eth1") )
    {
      *(_DWORD *)(v5 + 4) = v8;
LABEL_6:
      v9 = 80;
      goto LABEL_9;
    }
    *(_DWORD *)(v5 + 4) = atoi(v6 + 1);
  }
  else
  {
    v7 = atoi(v4);
    *(_DWORD *)(v5 + 4) = v7;
    *(_DWORD *)v5 = v7;
    if ( !strcmp(v3, "eth1") )
      goto LABEL_6;
  }
  v9 = 40;
LABEL_9:
  *(_DWORD *)(v5 + 16) = v9;
  v10 = strcmp(v3, "eth1");
  v11 = 5000;
  if ( v10 )
    v11 = 2412;
  result = 0;
  *(_DWORD *)(v5 + 8) = v11 + 5 * (*(_DWORD *)v5 - 1);
  return result;
}

//----- (00031A34) --------------------------------------------------------
int sub_31A34()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r0@1
  int v3; // r1@1
  const char *v4; // r0@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r0@1
  int v9; // r0@1
  int v10; // r1@1
  const char *v11; // r0@1
  int v12; // r0@1
  int v13; // r0@1
  int v14; // r0@1
  int v15; // r0@1
  int v16; // r1@1
  int v17; // r0@1
  int v18; // r0@1

  puts("<form method=get action=timepro.cgi name=wizard>");
  puts("<input type=hidden name=tmenu value=wirelesswizard>");
  puts("<input type=hidden name=step>");
  printf("<input type=hidden name=ifname value=%s>\n", "eth2");
  v1 = get_ux_text_common(1528, v0);
  v2 = print_wizard_top(v1, 0);
  str(v2);
  puts("<td height=190 class=wizardbody_td>");
  v4 = (const char *)get_ux_text_common(1523, v3);
  v5 = printf(v4);
  br(v5);
  v7 = get_ux_text_common(1524, v6);
  v8 = printf("%s", v7);
  v9 = br(v8);
  br(v9);
  printf("<span class=gray_text>");
  v11 = (const char *)get_ux_text_common(1525, v10);
  v12 = printf(v11);
  v13 = br(v12);
  br(v13);
  printf("</span>");
  v14 = printf("</td>");
  etr(v14);
  v15 = print_blank_line(1, 2);
  str(v15);
  printf("<td class=wizardbottom_td align=right>");
  v17 = get_ux_text_common(1645, v16);
  printf((const char *)&unk_93A2A, v17);
  v18 = printf("</td>");
  etr(v18);
  return puts("</form>");
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (00031B54) --------------------------------------------------------
int __fastcall common_step0(int a1)
{
  int v1; // r1@1
  int v2; // r6@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r0@1
  int v6; // r1@1
  const char *v7; // r0@1
  int v8; // r0@1
  int v9; // r1@1
  const char *v10; // r0@1
  int v11; // r0@1
  int v12; // r0@1
  int v13; // r0@1
  int v14; // r0@1
  int v15; // r1@1
  int v16; // r0@1
  int v17; // r1@1
  int v18; // r0@1
  int v19; // r0@1
  char v21; // [sp+8h] [bp-D0h]@1
  char v22; // [sp+88h] [bp-50h]@1
  char v23; // [sp+A8h] [bp-30h]@1
  char v24; // [sp+B8h] [bp-20h]@1

  get_init_name(a1, &v22, (int)&v24, (int)&v21, &v23);
  print_init_name(2, (int)&v22, 0, 0, 0);
  v2 = get_ux_text_common(1531, v1);
  v4 = get_ux_text_common(1532, v3);
  v5 = print_wireless_wizard_top(v2, v4, &v22);
  str(v5);
  puts("<td height=190 class=wizardbody_td>");
  v7 = (const char *)get_ux_text_common(1529, v6);
  v8 = printf(v7);
  br(v8);
  v10 = (const char *)get_ux_text_common(1530, v9);
  v11 = printf(v10);
  v12 = br(v11);
  br(v12);
  puts("<select name=country>");
  print_country_code_option(&v24);
  printf("</select><br><br>");
  v13 = printf("</td>");
  etr(v13);
  v14 = print_blank_line(1, 2);
  str(v14);
  printf("<td class=wizardbottom_td align=right>");
  v16 = get_ux_text_common(1646, v15);
  printf("<input type=button class=navi_bt name=next value='%s' onclick=\"WirelessWizardGotoPage(0);\">", v16);
  v18 = get_ux_text_common(1645, v17);
  printf("<input type=button class=navi_bt name=next value='%s' onclick=\"WirelessWizardGotoPage(3);\">", v18);
  v19 = printf("</td>");
  etr(v19);
  return puts("</form>");
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (00031C8C) --------------------------------------------------------
int __fastcall ap_step3(int a1)
{
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r0@1
  int v4; // r1@1
  const char *v5; // r0@1
  int v6; // r0@1
  int v7; // r1@1
  const char *v8; // r0@1
  int v9; // r0@1
  int v10; // r0@1
  int v11; // r1@1
  const char *v12; // r0@1
  int v13; // r0@1
  int v14; // r1@1
  const char *v15; // r0@1
  int v16; // r0@1
  int v17; // r1@1
  const char *v18; // r0@1
  int v19; // r0@1
  int v20; // r0@1
  int v21; // r1@1
  const char *v22; // r0@1
  int v23; // r1@1
  int v24; // r0@1
  int v25; // r0@1
  int v26; // r0@1
  int v27; // r0@1
  int v28; // r0@1
  int v29; // r0@1
  int v30; // r1@1
  int v31; // r0@1
  int v32; // r1@1
  int v33; // r5@1
  int v34; // r1@1
  int v35; // r0@1
  int v36; // r0@1
  int v38; // [sp+8h] [bp+0h]@1
  char v39; // [sp+88h] [bp+80h]@1
  char v40; // [sp+A8h] [bp+A0h]@1
  char v41; // [sp+B8h] [bp+B0h]@1

  get_init_name(a1, &v39, (int)&v41, (int)&v38, &v40);
  print_init_name(3, (int)&v39, (int)&v41, 0, 0);
  puts("<input type=hidden name=dupcheck value=0>");
  v2 = get_ux_text_common(1542, v1);
  v3 = print_wireless_wizard_top(v2, 0, &v39);
  str(v3);
  puts("<td height=190 class=wizardbody_td>");
  v5 = (const char *)get_ux_text_common(1536, v4);
  v6 = printf(v5);
  br(v6);
  v8 = (const char *)get_ux_text_common(1537, v7);
  v9 = printf(v8);
  v10 = br(v9);
  br(v10);
  v12 = (const char *)get_ux_text_common(1538, v11);
  v13 = printf(v12);
  br(v13);
  v15 = (const char *)get_ux_text_common(1539, v14);
  v16 = printf(v15);
  br(v16);
  v18 = (const char *)get_ux_text_common(1541, v17);
  v19 = printf(v18);
  v20 = br(v19);
  br(v20);
  v22 = (const char *)get_ux_text_common(1540, v21);
  printf(v22);
  print_nbsp(3);
  printf("<input type=text name=ssid size=24 maxlength=32 value=\"%s\">", &v38);
  v24 = get_ux_text_common(1519, v23);
  v25 = printf(
          "<input type=button name=ovtest_bt value=\"%s\" onclick=\"document.wizard.dupcheck.value=1; CheckSSIDOverlap();\">",
          v24);
  br(v25);
  v26 = printf("<table height=35 class=wizard_outline_table>");
  str(v26);
  printf("<td>");
  printf(
    "<iframe name=check_ssid src=\"timepro.cgi?tmenu=iframe&smenu=checkssid&stage=init&country=%s&ifname=%s\" width=400 h"
    "eight=35 frameborder=no scrolling=no>",
    &v41,
    &v39);
  printf("</iframe>");
  v27 = printf("</td>");
  etr(v27);
  printf("</table>");
  v28 = puts("</td>");
  etr(v28);
  v29 = print_blank_line(1, 2);
  str(v29);
  printf("<td class=wizardbottom_td align=right>");
  v31 = get_ux_text_common(1646, v30);
  printf("<input type=button class=navi_bt name=prev_bt value='%s' onclick=\"WirelessWizardGotoPage(2);\">", v31);
  v33 = get_ux_text_common(1645, v32);
  v35 = get_ux_text_common(155, v34);
  printf(
    "<input type=button class=navi_bt name=next_bt value='%s' onclick=\"if(document.wizard.dupcheck.value==0) alert('%s')"
    "; else WirelessWizardGotoPage(4);\">",
    v33,
    v35);
  v36 = printf("</td>");
  etr(v36);
  return puts("</form>");
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (00031E80) --------------------------------------------------------
int __fastcall ap_step4(int a1)
{
  int v1; // r1@1
  int v2; // r6@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r0@1
  int v6; // r1@1
  const char *v7; // r0@1
  int v8; // r0@1
  int v9; // r1@1
  const char *v10; // r0@1
  int v11; // r0@1
  int v12; // r1@1
  int v13; // r0@1
  int v14; // r0@1
  int v15; // r0@1
  int v16; // r1@1
  int v17; // r0@1
  int v18; // r1@1
  int v19; // r0@1
  int v20; // r0@1
  char v22; // [sp+8h] [bp-A0h]@1
  char v23; // [sp+88h] [bp-20h]@1
  int v24; // [sp+A8h] [bp+0h]@1
  char v25; // [sp+B8h] [bp+10h]@1

  get_init_name(a1, &v23, (int)&v25, (int)&v22, (char *)&v24);
  print_init_name(4, (int)&v23, (int)&v25, (int)&v22, (int)&v24);
  v2 = get_ux_text_common(1555, v1);
  v4 = get_ux_text_common(1556, v3);
  v5 = print_wireless_wizard_top(v2, v4, &v23);
  str(v5);
  puts("<td height=190 class=wizardbody_td>");
  v7 = (const char *)get_ux_text_common(1543, v6);
  v8 = printf(v7);
  br(v8);
  printf((const char *)&unk_93DF5);
  printf("<span class=gray_text>");
  v10 = (const char *)get_ux_text_common(1544, v9);
  v11 = printf(v10);
  br(v11);
  printf("</span>");
  printf("</td><td align=right>");
  v13 = get_ux_text_common(1554, v12);
  printf(
    "<input type=button name=search_bt value=\"%s\" onclick=\"parent.iframe_scan.document.scan_fm.submit();\" disabled>",
    v13);
  printf("</td></tr>");
  printf("</table>");
  printf("<table height=150 class=wizard_outline_table><tr><td>");
  printf(
    "<iframe name=iframe_scan src=\"timepro.cgi?tmenu=iframe&smenu=channelscan&wizard=1&stage=start&country=%s&ifname=%s&"
    "bw=%d\" width=520 height=150 frameborder=no scrolling=auto name=wizardscan >",
    &v25,
    &v23,
    40);
  printf("</iframe>");
  printf("</td></tr></table>");
  v14 = printf("</td>");
  etr(v14);
  v15 = print_blank_line(1, 2);
  str(v15);
  printf("<td colspan=2 class=wizardbottom_td align=right>");
  v17 = get_ux_text_common(1646, v16);
  printf("<input type=button class=navi_bt name=prev_bt value='%s' onclick=\"WirelessWizardGotoPage(3);\">", v17);
  v19 = get_ux_text_common(1645, v18);
  printf("<input type=button class=navi_bt name=next_bt value='%s' onclick=\"WirelessWizardGotoPage(5);\">", v19);
  v20 = printf("</td>");
  etr(v20);
  return puts("</form>");
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (00032034) --------------------------------------------------------
int __fastcall ap_step5(int a1)
{
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r0@1
  int v4; // r1@1
  const char *v5; // r0@1
  int v6; // r0@1
  int v7; // r0@1
  int v8; // r1@1
  int v9; // r0@1
  const char *v10; // r0@1
  int v11; // r0@1
  int v12; // r0@1
  int v13; // r1@1
  int v14; // r6@1
  int v15; // r1@1
  void *v16; // r0@1
  int v17; // r0@1
  int v18; // r0@1
  int v19; // r1@1
  int v20; // r0@1
  int v21; // r0@1
  int v22; // r0@1
  int v23; // r1@1
  const char *v24; // r0@1
  int v25; // r0@1
  int v26; // r0@1
  int v27; // r0@1
  int v28; // r1@1
  int v29; // r0@1
  int v30; // r1@1
  int v31; // r0@1
  int v32; // r0@1
  char v34; // [sp+Ch] [bp-C4h]@1
  char v35; // [sp+8Ch] [bp-44h]@1
  int v36; // [sp+ACh] [bp-24h]@1
  char v37; // [sp+C0h] [bp-10h]@1
  int v38; // [sp+D0h] [bp+0h]@1

  get_init_name(a1, &v35, (int)&v38, (int)&v34, &v37);
  print_init_name(5, (int)&v35, (int)&v38, (int)&v34, (int)&v37);
  v2 = get_ux_text_common(1559, v1);
  v3 = print_wireless_wizard_top(v2, 0, &v35);
  str(v3);
  puts("<td height=190 class=wizardbody_td>");
  v5 = (const char *)get_ux_text_common(1557, v4);
  v6 = printf(v5);
  br(v6);
  v7 = printf("<table width=450 class=wizard_outline_table>");
  str(v7);
  v9 = get_ux_text_common(1520, v8);
  printf("<td width=180>%s</td>", v9);
  v10 = get_country_string((const char *)&v38);
  v11 = printf("<td>%s</td>", v10);
  etr(v11);
  v12 = sub_31960(&v35, &v37, (int)&v36);
  str(v12);
  v14 = get_ux_text_common(1507, v13);
  v16 = get_channelspec_str((int)&v36, v15);
  v17 = printf((const char *)&unk_940A7, v14, v16);
  v18 = etr(v17);
  str(v18);
  v20 = get_ux_text_common(1522, v19);
  v21 = printf((const char *)&unk_940A7, v20, &v34);
  etr(v21);
  v22 = printf("</table>");
  br(v22);
  v24 = (const char *)get_ux_text_common(1558, v23);
  v25 = printf(v24);
  br(v25);
  v26 = printf("</td>");
  etr(v26);
  v27 = print_blank_line(1, 2);
  str(v27);
  printf("<td colspan=2 class=wizardbottom_td align=right>");
  v29 = get_ux_text_common(1646, v28);
  printf("<input type=button class=navi_bt name=prev_bt value='%s' onclick=\"WirelessWizardGotoPage(4);\">", v29);
  v31 = get_ux_text_common(1645, v30);
  printf("<input type=button class=navi_bt name=next_bt value='%s' onclick=\"WirelessWizardGotoPage(6);\">", v31);
  v32 = printf("</td>");
  etr(v32);
  return puts("</form>");
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (000321F8) --------------------------------------------------------
int __fastcall ap_step6(int a1)
{
  int v1; // r7@1
  int v2; // r0@1
  signed int v3; // r3@1
  int v4; // r1@5
  int v5; // r5@5
  int v6; // r1@5
  int v7; // r0@5
  char *v8; // r4@5
  int v9; // r0@5
  int v10; // r1@5
  char *v11; // r6@6
  int v12; // r0@8
  int v13; // r1@8
  int v14; // r0@8
  int v15; // r0@8
  int v16; // r1@8
  char *v17; // r6@9
  int v18; // r0@11
  int v19; // r1@11
  int v20; // r0@11
  int v21; // r1@11
  int v22; // r0@13
  int v23; // r0@13
  int v24; // r0@13
  int v25; // r1@13
  int v26; // r0@13
  int v27; // r1@13
  int v28; // r0@13
  int v29; // r0@13
  char v31; // [sp+Ch] [bp-DCh]@1
  char v32; // [sp+8Ch] [bp-5Ch]@1
  char v33; // [sp+ACh] [bp-3Ch]@1
  char v34; // [sp+BCh] [bp-2Ch]@1
  int v35; // [sp+CCh] [bp-1Ch]@1

  v1 = a1;
  get_init_name(a1, &v32, (int)&v34, (int)&v31, &v33);
  v2 = get_intvalue(v1, "auth_type", &v35);
  if ( !v2 )
    v3 = 10;
  if ( !v2 )
    v35 = v3;
  get_init_name(v1, &v32, (int)&v34, (int)&v31, &v33);
  print_init_name(6, (int)&v32, (int)&v34, (int)&v31, (int)&v33);
  v5 = get_ux_text_common(1564, v4);
  v7 = get_ux_text_common(1563, v6);
  v8 = "checked";
  v9 = print_wireless_wizard_top(v5, v7, &v32);
  str(v9);
  puts("<td height=190 class=wizardbody_td>");
  if ( v35 == 10 )
    v11 = "checked";
  else
    v11 = "";
  v12 = get_ux_text_common(1568, v10);
  printf("<input type=radio name=auth_type value=%d %s> %s<br>", 10, v11, v12);
  print_nbsp(7);
  v14 = get_ux_text_common(1569, v13);
  v15 = printf("%s<br>", v14);
  br(v15);
  if ( v35 == 1 )
    v17 = "checked";
  else
    v17 = "";
  v18 = get_ux_text_common(1561, v16);
  printf("<input type=radio name=auth_type value=%d %s> %s<br>", 1, v17, v18);
  print_nbsp(7);
  v20 = get_ux_text_common(1562, v19);
  printf("%s<br>", v20);
  if ( v35 != 100 )
    v8 = "";
  v22 = get_ux_text_common(1560, v21);
  printf("<input type=radio name=auth_type value=%d %s> %s<br>", 100, v8, v22);
  v23 = printf("</td>");
  etr(v23);
  v24 = print_blank_line(1, 2);
  str(v24);
  printf("<td colspan=2 class=wizardbottom_td align=right>");
  v26 = get_ux_text_common(1646, v25);
  printf("<input type=button class=navi_bt name=prev_bt value='%s' onclick=\"WirelessWizardGotoPage(5);\">", v26);
  v28 = get_ux_text_common(1645, v27);
  printf("<input type=button class=navi_bt name=next_bt value='%s' onclick=\"WirelessWizardGotoPage(7);\">", v28);
  v29 = printf("</td>");
  etr(v29);
  return puts("</form>");
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (00032400) --------------------------------------------------------
int __fastcall ap_step7(int a1)
{
  int v1; // r8@1
  int v2; // r0@1
  signed int v3; // r3@1
  signed int v4; // r3@7
  int v5; // r1@10
  int v6; // r5@11
  int v7; // r1@11
  int v8; // r0@11
  char *v9; // r4@11
  int v10; // r0@11
  int v11; // r1@11
  char *v12; // r6@12
  int v13; // r0@14
  int v14; // r1@14
  int v15; // r0@14
  int v16; // r1@14
  int v17; // r0@14
  int v18; // r0@14
  int v19; // r1@14
  int v20; // r0@16
  int v21; // r1@16
  int v22; // r0@16
  int v23; // r1@16
  int v24; // r0@16
  int v25; // r1@16
  int v26; // r0@16
  int v27; // r0@16
  int v28; // r1@16
  int v29; // r0@16
  int v30; // r5@17
  int v31; // r1@17
  int v32; // r0@17
  int v33; // r0@17
  int v34; // r1@17
  const char *v35; // r0@17
  int v36; // r1@17
  const char *v37; // r0@17
  int v38; // r0@17
  int v39; // r0@17
  const char *v40; // r0@18
  int v41; // r0@18
  int v42; // r0@18
  int v43; // r1@18
  int v44; // r0@18
  int v45; // r1@18
  int v46; // r0@18
  int v47; // r0@18
  char v49; // [sp+8h] [bp-A0h]@1
  char v50; // [sp+88h] [bp-20h]@1
  int v51; // [sp+A8h] [bp+0h]@1
  char v52; // [sp+B8h] [bp+10h]@1
  int v53; // [sp+C8h] [bp+20h]@5
  int v54; // [sp+CCh] [bp+24h]@1

  v1 = a1;
  get_init_name(a1, &v50, (int)&v52, (int)&v49, (char *)&v51);
  print_init_name(7, (int)&v50, (int)&v52, (int)&v49, (int)&v51);
  v2 = get_intvalue(v1, "auth_type", &v54);
  if ( !v2 )
    v3 = 10;
  if ( !v2 )
    v54 = v3;
  if ( !get_intvalue(v1, "encrypt_type", &v53) )
  {
    if ( v54 == 10 )
      v4 = 4;
    else
      v4 = 1;
    v53 = v4;
  }
  printf("<input type=hidden name=auth_type value=%d>\n", v54);
  if ( v54 == 10 )
  {
    v6 = get_ux_text_common(1579, v5);
    v8 = get_ux_text_common(1578, v7);
    v9 = "checked";
    v10 = print_wireless_wizard_top(v6, v8, &v50);
    str(v10);
    puts("<td height=190 class=wizardbody_td>");
    if ( v53 == 4 )
      v12 = "checked";
    else
      v12 = "";
    v13 = get_ux_text_common(1575, v11);
    printf((const char *)&unk_942B3, 4, v12, v13);
    print_nbsp(7);
    v15 = get_ux_text_common(1576, v14);
    printf("%s<br>", v15);
    print_nbsp(7);
    v17 = get_ux_text_common(1577, v16);
    v18 = printf("%s<br>", v17);
    br(v18);
    if ( v53 != 3 )
      v9 = "";
    v20 = get_ux_text_common(1580, v19);
    printf((const char *)&unk_942B3, 3, v9, v20);
    print_nbsp(7);
    v22 = get_ux_text_common(1581, v21);
    printf("%s<br>", v22);
    print_nbsp(7);
    v24 = get_ux_text_common(1582, v23);
    printf("%s<br>", v24);
    print_nbsp(7);
    v26 = get_ux_text_common(1583, v25);
    v27 = printf("%s<br>", v26);
    br(v27);
    v29 = 1570;
  }
  else
  {
    v30 = get_ux_text_common(1574, v5);
    v32 = get_ux_text_common(1573, v31);
    v33 = print_wireless_wizard_top(v30, v32, &v50);
    str(v33);
    puts("<td height=190 class=wizardbody_td>");
    printf("<input type=radio name=encrypt_type value=%d %s>");
    v35 = (const char *)get_ux_text_common(1572, v34);
    printf(v35, 64);
    printf("<br><br>");
    printf("<input type=radio name=encrypt_type value=%d %s>");
    v37 = (const char *)get_ux_text_common(1572, v36);
    v38 = printf(v37, 128);
    v39 = br(v38);
    br(v39);
    v29 = 1571;
  }
  v40 = (const char *)get_ux_text_common(v29, v28);
  printf(v40);
  v41 = printf("</td>");
  etr(v41);
  v42 = print_blank_line(1, 2);
  str(v42);
  printf("<td colspan=2 class=wizardbottom_td align=right>");
  v44 = get_ux_text_common(1646, v43);
  printf("<input type=button class=navi_bt name=prev_bt value='%s' onclick=\"WirelessWizardGotoPage(6);\">", v44);
  v46 = get_ux_text_common(1645, v45);
  printf("<input type=button class=navi_bt name=next_bt value='%s' onclick=\"WirelessWizardGotoPage(8);\">", v46);
  v47 = printf("</td>");
  etr(v47);
  return puts("</form>");
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (00032724) --------------------------------------------------------
int __fastcall ap_step8(int a1)
{
  int v1; // r4@1
  int v2; // r0@1
  signed int v3; // r3@1
  signed int v4; // r3@7
  signed int v5; // r4@13
  int v6; // r1@19
  int v7; // r0@20
  int v8; // r0@22
  int v9; // r0@22
  int v10; // r1@22
  const char *v11; // r0@22
  int v12; // r1@22
  const char *v13; // r0@22
  int v14; // r1@22
  int v15; // r0@23
  int v16; // r0@23
  const char *v17; // r0@24
  signed int v18; // r1@25
  int v19; // r1@28
  const char *v20; // r0@28
  int v21; // r0@28
  int v22; // r0@28
  int v23; // r0@28
  int v24; // r1@28
  int v25; // r0@28
  int v26; // r1@28
  int v27; // r0@28
  int v28; // r0@28
  char dest; // [sp+8h] [bp-1A0h]@1
  char v31; // [sp+108h] [bp-A0h]@1
  char v32; // [sp+188h] [bp-20h]@1
  int v33; // [sp+1A8h] [bp+0h]@1
  char v34; // [sp+1B8h] [bp+10h]@1
  int v35; // [sp+1C8h] [bp+20h]@5
  int v36; // [sp+1CCh] [bp+24h]@1

  v1 = a1;
  get_init_name(a1, &v32, (int)&v34, (int)&v31, (char *)&v33);
  print_init_name(8, (int)&v32, (int)&v34, (int)&v31, (int)&v33);
  strcpy(&dest, "");
  v2 = get_intvalue(v1, "auth_type", &v36);
  if ( !v2 )
    v3 = 5;
  if ( !v2 )
    v36 = v3;
  if ( !get_intvalue(v1, "encrypt_type", &v35) )
  {
    if ( v36 == 10 )
      v4 = 3;
    else
      v4 = 2;
    v35 = v4;
  }
  if ( !get_value(v1, "key", &dest, 256) )
    strcpy(&dest, "");
  if ( (unsigned int)(v35 - 3) > 1 )
  {
    if ( v35 == 1 )
    {
      v5 = 5;
    }
    else if ( v35 == 2 )
    {
      v5 = 13;
    }
    else
    {
      v5 = 64;
    }
  }
  else
  {
    v5 = 64;
  }
  printf("<input type=hidden name=auth_type value=%d>\n", v36);
  printf("<input type=hidden name=encrypt_type value=%d>\n", v35);
  if ( v5 == 64 )
    v7 = 1588;
  else
    v7 = 1587;
  v8 = get_ux_text_common(v7, v6);
  v9 = print_wireless_wizard_top(v8, 0, &v32);
  str(v9);
  puts("<td height=190 class=wizardbody_td>");
  printf("<table class=blank_table>");
  printf("<tr><td width=100>");
  v11 = (const char *)get_ux_text_common(1585, v10);
  printf(v11);
  printf("</td><td>");
  printf("<input type=password name=key value='%s' size=%d maxlength=%d><br>", &dest, v5 + 3, v5);
  printf("</td></tr>");
  printf("<tr><td>");
  v13 = (const char *)get_ux_text_common(1584, v12);
  printf(v13);
  printf("</td><td>");
  printf("<input type=password name=confirm_key value='%s' size=%d maxlength=%d><br>", &dest, v5 + 3, v5);
  printf("</td></tr>");
  printf("</table>");
  if ( (unsigned int)(v35 - 3) > 1 )
  {
    v17 = (const char *)get_ux_text_common(1590, v14);
    if ( v35 == 1 )
      v18 = 5;
    else
      v18 = 13;
    printf(v17, v18);
    v16 = printf("<br>");
  }
  else
  {
    v15 = get_ux_text_common(1589, v14);
    v16 = printf("%s<br>", v15);
  }
  br(v16);
  v20 = (const char *)get_ux_text_common(1586, v19);
  v21 = printf(v20);
  br(v21);
  v22 = printf("</td>");
  etr(v22);
  v23 = print_blank_line(1, 2);
  str(v23);
  printf("<td colspan=2 class=wizardbottom_td align=right>");
  v25 = get_ux_text_common(1646, v24);
  printf("<input type=button class=navi_bt name=prev_bt value='%s' onclick=\"WirelessWizardGotoPage(7);\">", v25);
  v27 = get_ux_text_common(1645, v26);
  printf("<input type=button class=navi_bt name=next_bt value='%s' onclick=\"WirelessWizardGotoPage(9);\">", v27);
  v28 = printf("</td>");
  etr(v28);
  return puts("</form>");
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (00032A04) --------------------------------------------------------
int __fastcall ap_step9(int a1)
{
  int v1; // r4@1
  int v2; // r0@1
  signed int v3; // r3@1
  int v4; // r1@9
  int v5; // r0@9
  int v6; // r0@9
  int v7; // r1@9
  const char *v8; // r0@9
  int v9; // r0@9
  int v10; // r0@9
  int v11; // r1@9
  int v12; // r0@9
  const char *v13; // r0@9
  int v14; // r0@9
  int v15; // r0@9
  int v16; // r1@9
  int v17; // r5@9
  int v18; // r1@9
  void *v19; // r0@9
  int v20; // r0@9
  int v21; // r0@9
  int v22; // r1@9
  int v23; // r0@9
  int v24; // r0@9
  int v25; // r0@9
  int v26; // r1@9
  int v27; // r0@9
  int v28; // r1@9
  int v29; // r0@11
  void *v30; // r0@13
  int v31; // r0@13
  int v32; // r0@13
  int v33; // r1@13
  int v34; // r0@13
  int v35; // r1@13
  void *v36; // r0@15
  int v37; // r0@15
  int v38; // r0@15
  int v39; // r1@15
  const char *v40; // r0@15
  int v41; // r0@15
  int v42; // r0@15
  int v43; // r0@15
  int v44; // r1@15
  int v45; // r0@15
  int v46; // r1@15
  int v47; // r0@16
  int v48; // r4@18
  int v49; // r0@18
  char v51; // [sp+8h] [bp-728h]@1
  int v52; // [sp+A8h] [bp-688h]@12
  int v53; // [sp+ACh] [bp-684h]@14
  char dest; // [sp+580h] [bp-1B0h]@1
  char v55; // [sp+680h] [bp-B0h]@1
  char s1; // [sp+700h] [bp-30h]@1
  char v57; // [sp+720h] [bp-10h]@9
  int v58; // [sp+734h] [bp+4h]@1
  int v59; // [sp+744h] [bp+14h]@1
  int v60; // [sp+754h] [bp+24h]@5
  int v61; // [sp+758h] [bp+28h]@1
  int v62; // [sp+75Ch] [bp+2Ch]@9

  v1 = a1;
  get_init_name(a1, &s1, (int)&v59, (int)&v55, (char *)&v58);
  print_init_name(8, (int)&s1, (int)&v59, (int)&v55, (int)&v58);
  memset(&v51, 0, 0x578u);
  read_wireless_conf(&v51, &s1);
  strcpy(&dest, "");
  v2 = get_intvalue(v1, "auth_type", &v61);
  if ( !v2 )
    v3 = 3;
  if ( !v2 )
    v61 = v3;
  if ( !get_intvalue(v1, "encrypt_type", &v60) )
    v60 = 0;
  if ( !get_value(v1, "key", &dest, 256) )
    strcpy(&dest, "");
  printf("<input type=hidden name=key value=%s>\n", &dest);
  printf("<input type=hidden name=encrypt_type value=%d>\n", v60);
  printf("<input type=hidden name=auth_type value=%d>\n", v61);
  get_active_wl(0, 0, &v62);
  printf("<input type=hidden name=modechange value=%d>\n");
  v5 = get_ux_text_common(1593, v4);
  v6 = print_wireless_wizard_top(v5, 0, &s1);
  str(v6);
  puts("<td height=190 class=wizardbody_td>");
  v8 = (const char *)get_ux_text_common(1591, v7);
  v9 = printf(v8);
  br(v9);
  v10 = printf("<table width=450 class=wizard_outline_table>");
  str(v10);
  v12 = get_ux_text_common(1520, v11);
  printf("<td width=180>%s</td>", v12);
  v13 = get_country_string((const char *)&v59);
  v14 = printf("<td>%s</td>", v13);
  etr(v14);
  v15 = sub_31960(&s1, (const char *)&v58, (int)&v57);
  str(v15);
  v17 = get_ux_text_common(1507, v16);
  v19 = get_channelspec_str((int)&v57, v18);
  v20 = printf((const char *)&unk_940A7, v17, v19);
  v21 = etr(v20);
  str(v21);
  v23 = get_ux_text_common(1522, v22);
  v24 = printf((const char *)&unk_940A7, v23, &v55);
  v25 = etr(v24);
  str(v25);
  v27 = get_ux_text_common(1521, v26);
  printf("<td>%s</td>\n", v27);
  printf("<td>");
  if ( v61 == 1 )
    v61 = 3;
  v29 = v61;
  if ( v61 == 100 )
    v29 = v52;
  v30 = get_auth_type_string(v29, v28);
  printf("%s", v30);
  v31 = printf("</td>");
  v32 = etr(v31);
  str(v32);
  v34 = get_ux_text_common(1508, v33);
  printf("<td>%s</td>\n", v34);
  printf("<td>");
  if ( v61 == 100 )
    v60 = v53;
  v36 = get_enc_type_string(v60, v35);
  printf("%s", v36);
  v37 = printf("</td>");
  etr(v37);
  v38 = printf("</table>");
  br(v38);
  v40 = (const char *)get_ux_text_common(1592, v39);
  v41 = printf(v40);
  br(v41);
  v42 = printf("</td>");
  etr(v42);
  v43 = print_blank_line(1, 2);
  str(v43);
  printf("<td colspan=2 class=wizardbottom_td align=right>");
  v45 = get_ux_text_common(1646, v44);
  printf("<input type=button class=navi_bt name=prev_bt value='%s' onclick=\"WirelessWizardGotoPage(8);\">", v45);
  if ( !strcmp(&s1, "eth1") )
    v47 = 1506;
  else
    v47 = 1505;
  v48 = get_ux_text_common(v47, v46);
  strcmp(&s1, "eth1");
  printf("<input type=button class=navi_bt name=next_bt value='%s' onclick=\"WirelessWizardGotoPage('%s');\">", v48);
  v49 = printf("</td>");
  etr(v49);
  return puts("</form>");
}
// 107CC: using guessed type int __fastcall read_wireless_conf(_DWORD, _DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 11810: using guessed type int __fastcall get_active_wl(_DWORD, _DWORD, _DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (00032DCC) --------------------------------------------------------
int __fastcall getWifiStatus(int a1)
{
  int v1; // r4@1
  char *v2; // r0@1
  signed int v3; // r3@3
  signed int v5; // [sp+0h] [bp-5D8h]@3
  char ssid; // [sp+4h] [bp-5D4h]@3
  int v7; // [sp+88h] [bp-550h]@3
  int v8; // [sp+8Ch] [bp-54Ch]@3
  int v9; // [sp+90h] [bp-548h]@3
  int v10; // [sp+94h] [bp-544h]@3
  int v11; // [sp+98h] [bp-540h]@3
  int v12; // [sp+A0h] [bp-538h]@8
  int encrypt_type; // [sp+A4h] [bp-534h]@8
  int v14; // [sp+BCh] [bp-51Ch]@11
  int v15; // [sp+C0h] [bp-518h]@11
  char v16; // [sp+C4h] [bp-514h]@11
  char key; // [sp+130h] [bp-4A8h]@9
  char contry; // [sp+3CCh] [bp-20Ch]@3
  int activeWirelessInterface; // [sp+578h] [bp-60h]@1
  int v20; // [sp+598h] [bp-40h]@3
  int v21; // [sp+59Ch] [bp-3Ch]@3
  int v22; // [sp+5A0h] [bp-38h]@3
  int v23; // [sp+5A4h] [bp-34h]@3
  int v24; // [sp+5A8h] [bp-30h]@3
  int channel; // [sp+5ACh] [bp-2Ch]@3
  int v26; // [sp+5BCh] [bp-1Ch]@3

  v1 = a1;
  v2 = (char *)get_value(a1, "ifname", &activeWirelessInterface, 32);
  if ( !v2 )
    v2 = strcpy((char *)&activeWirelessInterface, "eth2");
  clear_active_wl(v2);
  set_active_wl(&activeWirelessInterface, 0);
  memset(&v5, 0, 0x578u);
  read_wireless_conf(&v5, &activeWirelessInterface);
  get_value(v1, "country", &contry, 8);
  get_value(v1, "ssid", &ssid, 128);
  get_value(v1, "channel", &channel, 16);
  sub_31960((const char *)&activeWirelessInterface, (const char *)&channel, (int)&v20);
  v7 = v20;
  v8 = v21;
  v9 = v22;
  v10 = v23;
  v11 = v24;
  get_intvalue(v1, "auth_type", &v26);
  v3 = v26;
  if ( v26 != 100 )
  {
    if ( v26 == 1 )
      v3 = 3;
    if ( v26 == 1 )
      v26 = v3;
    v12 = v26;
    get_intvalue(v1, "encrypt_type", &encrypt_type);
    if ( (unsigned int)(encrypt_type - 3) > 1 )
    {
      if ( encrypt_type )
      {
        get_value(v1, "key", &v16, 27);
        v14 = 1;
        v15 = 0;
      }
    }
    else
    {
      get_value(v1, "key", &key, 108);
    }
  }
  v5 = 1;
  return write_wireless_conf(&v5, &activeWirelessInterface);
}
// 104A8: using guessed type int __fastcall clear_active_wl(_DWORD);
// 107CC: using guessed type int __fastcall read_wireless_conf(_DWORD, _DWORD);
// 11384: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);
// 114F8: using guessed type int __fastcall set_active_wl(_DWORD, _DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 11F48: using guessed type int __fastcall write_wireless_conf(_DWORD, _DWORD);

//----- (00032F90) --------------------------------------------------------
int __fastcall goReboot(int a1, int a2)
{
  int v2; // r0@1
  int v3; // r0@1
  int v4; // r1@1
  const char *v5; // r0@1
  int v6; // r0@1
  int v7; // r1@1
  const char *v8; // r0@1
  int v9; // r0@1
  int v10; // r0@1
  int v11; // r5@1
  int v12; // r0@1
  int v13; // r0@1
  int v14; // r0@1
  int v15; // r0@1

  v2 = get_ux_text_common(1594, a2);
  v3 = print_wizard_top(v2, 0);
  str(v3);
  puts("<td height=190 class=wizardbody_td>");
  printf("<table><tr><td>");
  v5 = (const char *)get_ux_text_common(1595, v4);
  v6 = printf(v5);
  br(v6);
  v8 = (const char *)get_ux_text_common(1596, v7);
  v9 = printf(v8);
  br(v9);
  printf("</td></tr>");
  print_blank_line(1, 5);
  v10 = printf("<tr><td>");
  v11 = hwinfo_get_reboot_duration(v10);
  print_html_progress_bar(v11, 500, 50);
  printf("</td></tr>");
  printf("</table>");
  v12 = puts("</td>");
  etr(v12);
  v13 = print_blank_line(1, 2);
  str(v13);
  printf("<td colspan=2 class=wizardbottom_td align=right>");
  v14 = printf("</td>");
  etr(v14);
  puts("</form>");
  v15 = printf("<meta http-equiv=refresh content=\"%d; URL=timepro.cgi?tmenu=wirelesswizard&step=finish\">", v11);
  return send_system_reboot_signal(v15);
}
// 10934: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// 10A24: using guessed type int __fastcall send_system_reboot_signal(_DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 114E0: using guessed type int __fastcall print_html_progress_bar(_DWORD, _DWORD, _DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (00033094) --------------------------------------------------------
int __fastcall print_wireless_wizard(int a1)
{
  int v1; // r4@1
  int v2; // r1@13
  int v4; // [sp+0h] [bp-30h]@1

  v1 = a1;
  puts("<body bgcolor=#dedede style=\"margin-left:0; margin-right:0; margin-top:0px; margin-bottom:0;\">");
  puts("<table width=550 height=293 class=wizardtable_td bgcolor=#ffffff >");
  if ( get_value(v1, "step", &v4, 32) && strcmp((const char *)&v4, "0") )
  {
    if ( !strcmp((const char *)&v4, "2") )
    {
      common_step0(v1);
    }
    else
    {
      if ( !strcmp((const char *)&v4, "save") )
        goto LABEL_32;
      if ( !strcmp((const char *)&v4, "finish") )
      {
        common_wl_wizard_finish(v1);
        goto LABEL_29;
      }
      if ( !strcmp((const char *)&v4, "finish5g") )
      {
        common_wl_wizard_finish5g(v1);
        goto LABEL_29;
      }
      if ( !strcmp((const char *)&v4, "save5g") )
      {
LABEL_32:
        common_wizard_save(v1);
        goto LABEL_29;
      }
      if ( !strcmp((const char *)&v4, "reboot") )
      {
        goReboot(v1, v2);
      }
      else if ( !strcmp((const char *)&v4, "3") )
      {
        ap_step3(v1);
      }
      else if ( !strcmp((const char *)&v4, "4") )
      {
        ap_step4(v1);
      }
      else if ( !strcmp((const char *)&v4, "5") )
      {
        ap_step5(v1);
      }
      else if ( !strcmp((const char *)&v4, "6") )
      {
        ap_step6(v1);
      }
      else if ( !strcmp((const char *)&v4, "7") )
      {
        ap_step7(v1);
      }
      else if ( !strcmp((const char *)&v4, "8") )
      {
        ap_step8(v1);
      }
      else if ( !strcmp((const char *)&v4, "9") )
      {
        ap_step9(v1);
      }
    }
  }
  else
  {
    sub_31A34();
  }
LABEL_29:
  printf("</table>");
  return printf("</body>");
}
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (000332E8) --------------------------------------------------------
int __fastcall printCheckSSID(int a1)
{
  return print_iframe_checkssid(a1, 1);
}

//----- (000332F0) --------------------------------------------------------
int __fastcall print_iframe_checkssid1(int a1)
{
  return print_iframe_checkssid(a1, 0);
}

//----- (000332F8) --------------------------------------------------------
_BYTE *__fastcall sub_332F8(_BYTE *result)
{
  char v1; // r3@4
  int v2; // t1@4

  while ( 1 )
  {
    v2 = *result++;
    v1 = v2;
    if ( !v2 )
      break;
    if ( (unsigned __int8)(v1 - 97) <= 0x19u )
      *(result - 1) = v1 - 32;
  }
  return result;
}

//----- (00033320) --------------------------------------------------------
int sub_33320()
{
  printf("<TR height=24 STYLE=\"cursor:pointer; background-Color:#%s\">");
  return printf("<TD width=100%% colspan=6 CLASS=text_gray></TD></TR>");
}

//----- (00033358) --------------------------------------------------------
int sub_33358()
{
  printf("<TR height=\"0\" id=\"_-guard_line\" class=\"pf_tr\" style=\"display:none;\">");
  return printf("<TD colspan=\"6\"></TD></TR>");
}

//----- (00033378) --------------------------------------------------------
int sub_33378()
{
  void *v0; // r0@1
  int v1; // r1@1
  int v2; // r0@1

  printf("<TR height=\"24\" ID=\"_-new_line\" class=\"pf_tr\" style=\"cursor:pointer; background-color:#%s;\">\n");
  puts("<TD align=\"left\" width=\"30\" class=\"pf_td\">");
  puts("<SPAN id=\"_-new_line_span_1\" class=\"pf_span\" style=\"padding-left:5px;\"                 onclick=\"onClickedPFRule('user','','','','','','','','','','','','','','','','','');\">");
  v0 = get_image_dir();
  printf("<img src=\"/%s/pf_new_rule.gif\">\n", v0);
  puts("</SPAN></TD>");
  puts("<TD align=\"left\" colspan=\"5\" class=\"pf_td\">");
  puts("<a name=\"_-new_line\" class=\"pf_a\">");
  printf("<SPAN ID=\"_-new_line_span_2\" class=\"pf_span\" style=\"color:#4789FF;\"                onclick=\"onClickedPFRule('user','','','','','','','','','','','','','','','','','');\">");
  v2 = get_ux_text_common(917, v1);
  return printf("%s</SPAN></A></TD></TR>", v2);
}

//----- (00033418) --------------------------------------------------------
int sub_33418()
{
  puts("<style type=\"text/css\">");
  puts(".pf_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".pf_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".pf_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".left_padding_td {");
  puts("\tpadding:0 0 0 5; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pf_p {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pf_span {");
  puts("\tpadding:0 0 0 0; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pf_select {");
  puts("\tpadding:0 0 0 0; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pf_textbox {");
  puts("\tpadding:1px 0 1px 0; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pf_button {");
  puts("\tpadding:0 1px 0 1px; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pf_checkbox {");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pf_a {");
  puts("\tvertical-align:middle; text-decoration:none;");
  puts("\tdisplay:inline-block; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;");
  puts("}");
  puts(".pf_overflowable {");
  puts("\tpadding:0 0 0 0; margin:0 0 0 0; border:none none none none; vertical-align:middle; text-decoration:none;");
  puts("\tdisplay:inline-block; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;");
  puts("}");
  puts(".pf_opacity_30 {");
  puts("\topacity:0.3;");
  puts("\t-moz-opacity:0.3;");
  puts("\t-khtml-opacity:0.3;");
  puts("\tfilter:alpha(opacity=30);");
  puts("}");
  printf("::-webkit-input-placeholder {");
  printf("\tcolor:#B4B4B4;");
  putchar(125);
  printf(":-moz-placeholder {");
  printf("\tcolor:#B4B4B4;");
  printf("\topacity:1;");
  putchar(125);
  printf((const char *)&unk_94D6E);
  printf("\tcolor:#B4B4B4;");
  printf("\topacity:1;");
  putchar(125);
  printf(":-ms-input-placeholder {");
  printf("\tcolor:#B4B4B4;");
  putchar(125);
  return printf("</style>");
}

//----- (000336F4) --------------------------------------------------------
int __fastcall sub_336F4(int result, int a2)
{
  int v2; // r7@1
  int v3; // r4@1
  int v4; // r9@1
  int v5; // r6@2
  int v6; // r8@2
  signed int v7; // r10@2
  int v8; // r3@3
  int v9; // t1@3
  int v10; // r5@6
  const char *v11; // r0@6
  const char *v12; // r2@6
  bool v13; // zf@6
  const char *v14; // r2@12
  bool v15; // zf@12
  int v16; // r5@20
  char *v17; // r0@23
  const char *v18; // r2@23
  int v19; // r3@26
  int v20; // t1@26
  int v21; // [sp+0h] [bp-378h]@12
  int v22; // [sp+0h] [bp-378h]@23
  int v23; // [sp+4h] [bp-374h]@12
  char s; // [sp+1Ch] [bp-35Ch]@2
  char v25; // [sp+21Ch] [bp-15Ch]@12
  char v26; // [sp+31Ch] [bp-5Ch]@12
  char v27; // [sp+33Ch] [bp-3Ch]@12

  v2 = result;
  v3 = *(_DWORD *)(result + 536);
  v4 = a2;
  if ( !v3 )
    return result;
  v5 = v3 + 20;
  v6 = v3 + 20;
  v7 = 10;
  memset(&s, 0, 0x200u);
  do
  {
    v9 = *(_DWORD *)(v6 + 4);
    v6 += 4;
    v8 = v9;
    if ( v9 )
      snprintf(&s, 0x200u, "%s%d ", &s, v8);
    --v7;
  }
  while ( v7 );
  v10 = v2 + 4;
  printf("<TR height=\"24\" id=\"%s\" class=\"pf_tr\" style=\"cursor:pointer; background-color:#%s;\" ", v2 + 4);
  v11 = (const char *)*(_BYTE *)(v2 + 516);
  v12 = "true";
  v13 = v11 == 0;
  if ( !*(_BYTE *)(v2 + 516) )
    v11 = "true";
  if ( !v13 )
    v11 = "false";
  if ( !*(_BYTE *)(v2 + 517) )
    v12 = "false";
  printf(
    "onclick=\"onClickedPFRule('trigger_status','%s','','','%s','','','','','%d','%d','%s','%s',%s,'%d','', %s)\">\n",
    v10,
    v3,
    *(_DWORD *)(v3 + 8),
    *(_DWORD *)(v3 + 12),
    v3 + 16,
    &s,
    v11,
    v4,
    v12);
  printf(
    "<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"30\" style=\"color:%s; padding-left:5px;\">%d</TD>\n",
    &v27,
    v4);
  puts("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"100\">");
  printf("<a name=\"%s\" title=\"%s\" class=\"pf_a\" style=\"width:80px; color:%s;\">%s</a>\n", v10, v10, &v27, v10);
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v27);
  memset(&v25, 0, 0x100u);
  memset(&v26, 0, 0x20u);
  snprintf(&v25, 0x100u, "%s", v3 + 64);
  printf("<SPAN style=\"width:140px;\" class=\"pf_overflowable\" title=\"%s\">%s</SPAN></TD>\n", &v25, &v25);
  printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v27);
  sf_strncpy(&v26, v3, 32);
  sub_332F8(&v26);
  snprintf(&v25, 0x100u, "%s", &v26);
  v14 = *(const char **)(v3 + 12);
  v15 = v14 == 0;
  if ( v14 )
  {
    v23 = *(_DWORD *)(v3 + 12);
    v21 = *(_DWORD *)(v3 + 8);
  }
  if ( v14 )
    v14 = "%s(%d~%d)";
  if ( v15 )
    v21 = *(_DWORD *)(v3 + 8);
  if ( v15 )
    v14 = "%s(%d)";
  snprintf(&v25, 0x100u, v14, &v25, v21, v23);
  printf("<SPAN style=\"width:140px;\" class=\"pf_overflowable\" title=\"%s\">%s</SPAN></TD>\n", &v25, &v25);
  printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v27);
  memset(&v25, 0, 0x100u);
  memset(&v26, 0, 0x20u);
  sf_strncpy(&v26, v3 + 16, 32);
  sub_332F8(&v26);
  snprintf(&v25, 0x100u, "%s(", &v26);
  v16 = 0;
  do
  {
    v20 = *(_DWORD *)(v5 + 4);
    v5 += 4;
    v19 = v20;
    if ( !v20 )
      break;
    if ( v16++ != 9 && *(_DWORD *)(v5 + 4) )
    {
      v22 = v19;
      v17 = &v25;
      v18 = "%s%d,";
    }
    else
    {
      v18 = "%s%d";
      v17 = &v25;
      v22 = v19;
    }
    snprintf(v17, 0x100u, v18, &v25, v22);
  }
  while ( v16 != 10 );
  snprintf(&v25, 0x100u, "%s)", &v25);
  printf("<SPAN style=\"width:140px;\" class=\"pf_overflowable\" title=\"%s\">%s</SPAN></TD>\n", &v25, &v25);
  printf("<TD height=\"24\" align=\"right\" class=\"pf_td\" style=\"color:%s;\">\n", &v27);
  result = puts((const char *)&unk_95032);
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);

//----- (00033A44) --------------------------------------------------------
int __fastcall sub_33A44(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r7@1
  char *v4; // r0@3
  const char *v5; // r1@3
  int result; // r0@5
  int v7; // r4@5
  const char *v8; // r0@6
  int v9; // lr@6
  int v10; // r8@6
  bool v11; // zf@6
  const char *v12; // r3@6
  const char *v13; // ST18_4@12
  const char *v14; // ST24_4@12
  int v15; // ST10_4@12
  int v16; // r3@12
  int v17; // [sp+14h] [bp-174h]@6
  char v18; // [sp+2Ch] [bp-15Ch]@12
  char v19; // [sp+12Ch] [bp-5Ch]@12
  char v20; // [sp+14Ch] [bp-3Ch]@3

  v2 = a1;
  v3 = a2;
  if ( *(_BYTE *)(a1 + 516) && *(_BYTE *)(a1 + 524) != 1 )
  {
    v4 = &v20;
    v5 = "#000000";
  }
  else
  {
    v5 = "#B4B4B4";
    v4 = &v20;
  }
  result = sf_strncpy(v4, v5, 20);
  v7 = *(_DWORD *)(v2 + 532);
  if ( !v7 )
    return result;
  v8 = (const char *)*(_BYTE *)(v2 + 516);
  v9 = *(_DWORD *)(v7 + 12);
  v10 = *(_DWORD *)(v7 + 8);
  v11 = v8 == 0;
  v12 = "true";
  v17 = *(_DWORD *)(v7 + 20);
  if ( !*(_BYTE *)(v2 + 516) )
    v8 = "true";
  if ( !v11 )
    v8 = "false";
  if ( !*(_BYTE *)(v2 + 517) )
    v12 = "false";
  v13 = v8;
  v14 = v12;
  v15 = *(_DWORD *)(v7 + 16);
  printf(
    "<TR height=\"24\" id=\"%s\" class=\"pf_tr\" style=\"cursor:pointer; background-color:#%s;\" \t\tonclick=\"onClickedP"
    "FRule('upnp','%s','','%s','%s','%d','%d','%d','%d','','','','',%s,'%d','%d',%s);\">\n",
    v2 + 4);
  printf(
    "<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"30\" style=\"color:%s; padding-left:5px;\">%d</TD>\n",
    &v20,
    v3);
  puts("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"100\">");
  printf(
    "<a name=\"%s\" title=\"%s\" class=\"pf_a\" style=\"width:80px; color:%s;\">%s</a>\n",
    v2 + 4,
    v2 + 4,
    &v20,
    v2 + 4,
    v7,
    v10,
    v9,
    v15,
    v17,
    v13,
    v3,
    1,
    v14);
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v20);
  memset(&v18, 0, 0x100u);
  memset(&v19, 0, 0x20u);
  snprintf(&v18, 0x100u, "%s", v7 + 24);
  printf("<SPAN style=\"width:140px;\" class=\"pf_overflowable\" title=\"%s\">%s</SPAN></TD>\n", &v18, &v18);
  printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v20);
  memset(&v18, 0, 0x100u);
  memset(&v19, 0, 0x20u);
  sf_strncpy(&v19, v7, 32);
  sub_332F8(&v19);
  v16 = *(_DWORD *)(v7 + 12);
  if ( v16 )
    snprintf(&v18, 0x100u, (const char *)&unk_9510F, &v18, &v19, *(_DWORD *)(v7 + 8), v16);
  else
    snprintf(&v18, 0x100u, (const char *)&unk_9511B, &v18, &v19, *(_DWORD *)(v7 + 8));
  printf("<SPAN style=\"width:140px;\" class=\"pf_overflowable\" title=\"%s\">%s</SPAN></TD>\n");
  printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v20);
  puts((const char *)&unk_95124);
  printf("<TD height=\"24\" align=\"right\" class=\"pf_td\" style=\"color:%s; %s\">\n", &v20);
  *(_BYTE *)(v2 + 517);
  printf("<input type=\"checkbox\" name=\"delcheck\" value=\"%s/%d\" %s>\n", v7, *(_DWORD *)(v7 + 8));
  result = puts((const char *)&unk_95032);
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);

//----- (00033D18) --------------------------------------------------------
int __fastcall sub_33D18(int a1, int a2, int a3)
{
  int v3; // r11@1
  int v4; // r6@1
  int v5; // r8@1
  __int64 v6; // r4@1
  char *v7; // r0@3
  const char *v8; // r1@3
  int result; // r0@5
  const char *v10; // r1@7
  const char *v11; // r3@7
  bool v12; // zf@7
  int v13; // r9@14
  signed int v14; // r4@14
  int v15; // r3@15
  int v16; // t1@15
  const char *v17; // r2@18
  const char *v18; // r0@19
  int v19; // r1@26
  int v20; // r0@26
  int v21; // r2@26
  const char *v22; // r2@30
  char *v23; // r0@35
  const char *v24; // r2@35
  int v25; // r3@36
  int v26; // r9@40
  int v27; // r8@40
  char *v28; // r0@43
  const char *v29; // r2@43
  int v30; // r3@46
  int v31; // t1@46
  size_t v32; // r1@49
  char *v33; // r0@50
  const char *v34; // r2@50
  char *v35; // r3@50
  int v36; // r2@52
  char *v37; // r0@53
  const char *v38; // r2@56
  int v39; // r1@59
  int v40; // r5@59
  int v41; // r4@59
  char *v42; // r0@62
  const char *v43; // r2@62
  int v44; // r3@65
  int v45; // t1@65
  char *v46; // r2@69
  __int64 v47; // [sp+0h] [bp-388h]@13
  int v48; // [sp+0h] [bp-388h]@43
  int v49; // [sp+0h] [bp-388h]@62
  int v50; // [sp+24h] [bp-364h]@14
  char s; // [sp+2Ch] [bp-35Ch]@14
  char v52; // [sp+22Ch] [bp-15Ch]@24
  char v53; // [sp+32Ch] [bp-5Ch]@24
  char v54; // [sp+34Ch] [bp-3Ch]@3

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = *(_QWORD *)(a2 + 532);
  if ( *(_BYTE *)(a2 + 516) && *(_BYTE *)(a2 + 524) != 1 )
  {
    v7 = &v54;
    v8 = "#000000";
  }
  else
  {
    v8 = "#B4B4B4";
    v7 = &v54;
  }
  result = sf_strncpy(v7, v8, 20);
  if ( !v6 )
    return result;
  printf("<TR height=\"24\" id=\"%s\" class=\"pf_tr\" style=\"cursor:pointer; background-color:#%s;\" ", v4 + 4);
  if ( v3 == 1 )
  {
    v10 = (const char *)*(_BYTE *)(v4 + 516);
    v11 = "true";
    v12 = v10 == 0;
    if ( !*(_BYTE *)(v4 + 516) )
      v10 = "true";
    if ( !v12 )
      v10 = "false";
    if ( !*(_BYTE *)(v4 + 517) )
      v11 = "false";
    printf(
      "onclick=\"onClickedPFRule('user','%s','0','%s','%s','%d','%d','%d','%d','','','','',%s,'%d','%d', %s)\">\n",
      v4 + 4,
      (_DWORD)v6 + 24,
      (_DWORD)v6,
      *(_DWORD *)(v6 + 8),
      *(_DWORD *)(v6 + 12),
      *(_DWORD *)(v6 + 16),
      *(_DWORD *)(v6 + 20),
      v10,
      v5,
      1,
      v11);
  }
  else
  {
    memset(&s, 0, 0x200u);
    v50 = v6;
    v13 = HIDWORD(v6) + 20;
    v14 = 10;
    do
    {
      v16 = *(_DWORD *)(v13 + 4);
      v13 += 4;
      v15 = v16;
      if ( v16 )
        snprintf(&s, 0x200u, "%s%d ", &s, v15);
      --v14;
    }
    while ( v14 );
    v17 = "true";
    if ( *(_BYTE *)(v4 + 516) )
      v18 = "false";
    else
      v18 = "true";
    if ( !*(_BYTE *)(v4 + 517) )
      v17 = "false";
    LODWORD(v6) = v50;
    printf(
      "onclick=\"onClickedPFRule('trigger','%s','trigger','','%s','','','','','%d','%d','%s','%s',%s,'%d','', %s)\">\n",
      v4 + 4,
      HIDWORD(v6),
      *(_DWORD *)(HIDWORD(v6) + 8),
      *(_DWORD *)(HIDWORD(v6) + 12),
      HIDWORD(v6) + 16,
      &s,
      v18,
      v5,
      v17);
  }
  printf(
    "<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"30\" style=\"color:%s; padding-left:5px;\">%d</TD>\n",
    &v54,
    v5);
  puts("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"100\">");
  printf(
    "<a name=\"%s\" title=\"%s\" class=\"pf_a\" style=\"width:80px; color:%s;\">%s</a>\n",
    v4 + 4,
    v4 + 4,
    &v54,
    v4 + 4);
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v54);
  memset(&v52, 0, 0x100u);
  memset(&v53, 0, 0x20u);
  if ( v3 == 1 )
  {
    snprintf(&v52, 0x100u, "%s", (_DWORD)v6 + 24);
  }
  else
  {
    sf_strncpy(&v53, HIDWORD(v6), 32);
    sub_332F8(&v53);
    v20 = get_ux_text_common(1020, v19);
    snprintf(&v52, 0x100u, "%s-%s", v20, &v53);
    v21 = *(_DWORD *)(HIDWORD(v6) + 12);
    if ( v21 )
      v47 = *(_QWORD *)(HIDWORD(v6) + 8);
    else
      LODWORD(v47) = *(_DWORD *)(HIDWORD(v6) + 8);
    if ( v21 )
      v22 = "%s(%d~%d)";
    else
      v22 = "%s(%d)";
    snprintf(&v52, 0x100u, v22, &v52, v47);
  }
  printf("<SPAN style=\"width:140px;\" class=\"pf_overflowable\" title=\"%s\">%s</SPAN></TD>\n", &v52, &v52);
  printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v54);
  memset(&v52, 0, 0x100u);
  memset(&v53, 0, 0x20u);
  if ( v3 == 1 )
  {
    sf_strncpy(&v53, v6, 32);
    sub_332F8(&v53);
    if ( !strcmp((const char *)v6, "gre") )
    {
      LODWORD(v47) = &v53;
      v23 = &v52;
      v24 = "%s%s";
    }
    else
    {
      v25 = *(_DWORD *)(v6 + 12);
      if ( v25 )
      {
        snprintf(&v52, 0x100u, (const char *)&unk_9510F, &v52, &v53, *(_DWORD *)(v6 + 8), v25);
        goto LABEL_48;
      }
      v24 = (const char *)&unk_9511B;
      v23 = &v52;
      LODWORD(v47) = &v53;
      HIDWORD(v47) = *(_DWORD *)(v6 + 8);
    }
    snprintf(v23, 0x100u, v24, v23, v47);
  }
  else
  {
    v26 = 0;
    sf_strncpy(&v53, HIDWORD(v6) + 16, 32);
    sub_332F8(&v53);
    snprintf(&v52, 0x100u, "%s(", &v53);
    v27 = HIDWORD(v6) + 20;
    do
    {
      v31 = *(_DWORD *)(v27 + 4);
      v27 += 4;
      v30 = v31;
      if ( !v31 )
        break;
      if ( v26++ != 9 && *(_DWORD *)(v27 + 4) )
      {
        v48 = v30;
        v28 = &v52;
        v29 = "%s%d,";
      }
      else
      {
        v29 = "%s%d";
        v28 = &v52;
        v48 = v30;
      }
      snprintf(v28, 0x100u, v29, &v52, v48);
    }
    while ( v26 != 10 );
    snprintf(&v52, 0x100u, "%s)", &v52);
  }
LABEL_48:
  printf("<SPAN style=\"width:140px;\" class=\"pf_overflowable\" title=\"%s\">%s</SPAN></TD>\n", &v52, &v52);
  printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v54);
  memset(&v52, 0, 0x100u);
  memset(&v53, 0, 0x20u);
  if ( v3 == 1 )
  {
    sf_strncpy(&v53, v6, 32);
    sub_332F8(&v53);
    if ( strcmp((const char *)v6, "gre") )
    {
      if ( *(_DWORD *)(v6 + 16) )
      {
        v36 = *(_DWORD *)(v6 + 20);
        if ( v36 )
        {
          LODWORD(v47) = *(_DWORD *)(v6 + 16);
          v37 = &v52;
          HIDWORD(v47) = *(_DWORD *)(v6 + 20);
          v32 = 256;
        }
        else
        {
          LODWORD(v47) = *(_DWORD *)(v6 + 16);
          v37 = &v52;
        }
        if ( v36 )
        {
          v38 = "%s(%d~%d)";
        }
        else
        {
          v32 = 256;
          v38 = "%s(%d)";
        }
        snprintf(v37, v32, v38, &v53, v47);
      }
      goto LABEL_68;
    }
    v33 = &v52;
    v34 = "%s";
    v35 = &v53;
  }
  else
  {
    v39 = HIDWORD(v6) + 16;
    v40 = HIDWORD(v6) + 20;
    sf_strncpy(&v53, v39, 32);
    v41 = 0;
    sub_332F8(&v53);
    snprintf(&v52, 0x100u, "%s(", &v53);
    do
    {
      v45 = *(_DWORD *)(v40 + 4);
      v40 += 4;
      v44 = v45;
      if ( !v45 )
        break;
      if ( v41++ != 9 && *(_DWORD *)(v40 + 4) )
      {
        v49 = v44;
        v42 = &v52;
        v43 = "%s%d,";
      }
      else
      {
        v43 = "%s%d";
        v42 = &v52;
        v49 = v44;
      }
      snprintf(v42, 0x100u, v43, &v52, v49);
    }
    while ( v41 != 10 );
    v34 = "%s)";
    v33 = &v52;
    v35 = &v52;
  }
  snprintf(v33, 0x100u, v34, v35);
LABEL_68:
  printf("<SPAN style=\"width:140px;\" class=\"pf_overflowable\" title=\"%s\">%s</SPAN></TD>\n");
  printf("<TD height=\"24\" align=\"right\" class=\"pf_td\" style=\"color:%s; %s\">\n", &v54);
  if ( *(_BYTE *)(v4 + 517) )
    v46 = "disabled";
  else
    v46 = "";
  printf("<input type=\"checkbox\" name=\"delcheck\" value=\"%s\" %s>\n", v4 + 4, v46, "disabled");
  result = puts((const char *)&unk_95032);
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);

//----- (00034390) --------------------------------------------------------
const char *__fastcall sub_34390(const char *a1, const char *a2, int a3, signed int a4)
{
  const char *v4; // r6@1
  const char *v5; // r4@1
  int v6; // r5@1
  v7 *v7; // r8@1
  size_t v8; // r7@2
  char *v9; // r0@4
  const char *v10; // r6@7
  char *v11; // r0@7
  v12 *v12; // r4@9
  void *v13; // r7@15
  signed int v14; // r2@15
  _BYTE *v15; // r3@15
  _BYTE *v16; // r1@16
  int v17; // t1@16

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v7 = (v7 *)a4;
  if ( !a1 )
    return v4;
  v8 = strlen(a2);
  while ( strncmp(v4, v5, v8) )
  {
    v9 = strchr(v4, 38);
    v4 = v9;
    if ( !v9 )
      return v4;
    v4 = v9 + 1;
  }
  if ( !v4 )
    return v4;
  v10 = &v4[v8 + 1];
  v11 = strchr(v10, 38);
  if ( !v11 )
    v11 = (char *)&v10[strlen(v10)];
  v12 = (v12 *)(v11 - v10);
  if ( v11 == v10 )
  {
    v4 = (const char *)(v11 - v10);
  }
  else
  {
    if ( (signed int)v7 <= (signed int)v12 )
      v12 = (v12 *)((char *)&v7[-1].field_0 + 3);
    if ( strchr(v10, 37) )
      v12 = (v12 *)(3 * (_DWORD)v12);
    v13 = malloc((size_t)&v12->field_0 + 1);
    memcpy(v13, v10, (size_t)v12);
    v14 = 0;
    v15 = v13;
    *((_BYTE *)&v12->field_0 + (_DWORD)v13) = 0;
    while ( v14 < (signed int)v12 )
    {
      v16 = v15;
      v17 = *v15++;
      if ( v17 == 43 )
        *(v15 - 1) = 32;
      if ( *(v15 - 1) == 38 )
      {
        *v16 = 0;
        break;
      }
      ++v14;
    }
    v4 = (const char *)1;
    decode_string(v13);
    sf_strncpy(v6, v13, v7);
    free(v13);
  }
  return v4;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 109C4: using guessed type int __fastcall decode_string(_DWORD);

//----- (000344C8) --------------------------------------------------------
_DWORD *__fastcall sub_344C8(int a1)
{
  const char *v1; // r5@1
  _DWORD *v2; // r10@1
  _DWORD *v3; // r11@1
  char *v4; // r8@1
  _DWORD *v5; // r4@2
  v6 *v6; // r6@3
  int v7; // r8@13
  int v8; // r1@16
  const char *v9; // r4@17
  int v10; // r9@18
  int v11; // r4@25
  int v12; // r0@25
  int v13; // r0@33
  int v14; // r0@39
  int v15; // r4@44
  int v16; // r0@44
  const char *v17; // r7@48
  int v18; // r7@52
  int v19; // r0@52
  int v20; // r7@58
  int v21; // r0@58
  int v22; // r7@66
  signed int v23; // r0@67
  signed int v24; // r3@67
  signed int v25; // r8@67
  int v26; // r1@68
  bool v27; // zf@68
  char *v28; // r3@74
  signed int i; // r5@74
  const char *v30; // r6@76
  int v31; // t1@77
  int v32; // r4@80
  signed int v33; // r9@80
  signed int v34; // r3@80
  unsigned int v35; // ST04_4@81
  int v36; // r0@81
  const char *v37; // r2@84
  int v38; // t1@85
  int v39; // t1@89
  int v40; // r2@93
  char nptr[512]; // [sp+8h] [bp-428h]@67
  char s; // [sp+208h] [bp-228h]@1

  v1 = (const char *)a1;
  v2 = malloc(0x21Cu);
  v3 = v2;
  init_pf_rule();
  memset(&s, 0, 0x200u);
  v4 = (char *)sub_34390(v1, "mode", (int)&s, 512);
  if ( !v4 )
    goto LABEL_7;
  v4 = (char *)(pf_line_spchar_validate(&s) == 0);
  v5 = (_DWORD *)strcmp(&s, "user");
  if ( v5 )
  {
    v6 = (v6 *)strcmp(&s, "trigger");
    if ( !v6 )
    {
      v5 = malloc(0x58u);
      init_tr_netfilter();
      insert_tr_to_rule(v2, v5);
      v2[132] = 1;
      goto LABEL_8;
    }
    v4 = 0;
LABEL_7:
    v5 = v4;
    v6 = (v6 *)v4;
    goto LABEL_8;
  }
  v6 = (v6 *)malloc(0x30u);
  init_pf_netfilter();
  insert_nf_to_rule(v2, v6);
  v2[132] = 0;
LABEL_8:
  memset(&s, 0, 0x200u);
  if ( v4 )
  {
    v4 = (char *)sub_34390(v1, "name", (int)&s, 512);
    if ( v4 )
    {
      v4 = (char *)(pf_line_spchar_validate(&s) == 0);
      sf_strncpy(v2 + 1, &s, 512);
    }
  }
  memset(&s, 0, 0x200u);
  if ( !v4 )
    goto LABEL_98;
  if ( sub_34390(v1, "disabled", (int)&s, 512) )
  {
    v7 = pf_line_spchar_validate(&s);
    if ( atoi(&s) == 1 )
      *((_BYTE *)v2 + 516) = 0;
    if ( v7 )
      goto LABEL_98;
  }
  v8 = v2[132];
  if ( v8 )
  {
    if ( v8 != 1 )
      goto LABEL_98;
    memset(&s, 0, 0x200u);
    v17 = sub_34390(v1, "trigger_protocol", (int)&s, 8);
    if ( v17 )
    {
      v17 = (const char *)(pf_line_spchar_validate(&s) == 0);
      sf_strncpy(v5, &s, 8);
    }
    memset(&s, 0, 0x200u);
    if ( v17 )
    {
      v17 = sub_34390(v1, "trigger_sport", (int)&s, 512);
      if ( v17 )
      {
        v18 = pf_line_spchar_validate(&s);
        v19 = atoi(&s);
        if ( (unsigned int)(v19 - 1) <= 0xFFFE )
        {
          v17 = (const char *)(v18 == 0);
          v5[2] = v19;
        }
        else
        {
          v17 = 0;
        }
      }
    }
    memset(&s, 0, 0x200u);
    if ( v17 )
    {
      if ( sub_34390(v1, "trigger_eport", (int)&s, 512) )
      {
        v20 = pf_line_spchar_validate(&s);
        v21 = atoi(&s);
        if ( (unsigned int)(v21 - 1) <= 0xFFFE )
        {
          v17 = (const char *)(v20 == 0);
          v5[3] = v21;
        }
        else
        {
          v17 = 0;
        }
      }
      else
      {
        v17 = (const char *)1;
      }
    }
    memset(&s, 0, 0x200u);
    if ( v17 )
    {
      v17 = sub_34390(v1, (const char *)&unk_95360, (int)&s, 8);
      if ( v17 )
      {
        v17 = (const char *)(pf_line_spchar_validate(&s) == 0);
        sf_strncpy(v5 + 4, &s, 8);
      }
    }
    memset(&s, 0, 0x200u);
    if ( !v17 )
      goto LABEL_98;
    if ( !sub_34390(v1, "forward_ports", (int)&s, 512) )
      goto LABEL_98;
    v22 = pf_line_spchar_validate(&s);
    if ( !s )
      goto LABEL_98;
    sf_strncpy(nptr, &s, 512);
    v23 = strlen(nptr);
    v24 = 0;
    v25 = v23;
    while ( v24 < v23 )
    {
      v26 = (unsigned __int8)nptr[v24];
      v27 = v26 == 32;
      if ( v26 != 32 )
        v27 = v26 == 44;
      if ( v27 )
        nptr[v24] = 0;
      ++v24;
    }
    v28 = nptr;
    for ( i = 0; ; ++i )
    {
      v30 = v28;
      if ( i >= v23 )
        break;
      v31 = (unsigned __int8)*v28++;
      if ( v31 )
        goto LABEL_80;
    }
    v30 = 0;
LABEL_80:
    v32 = (int)(v5 + 5);
    v33 = 0;
    v34 = 65534;
    while ( 1 )
    {
      v40 = v33 <= 9;
      if ( !v30 )
        v40 = 0;
      if ( !v40 )
        break;
      v35 = v34;
      v36 = atoi(v30);
      v34 = v35;
      if ( v36 - 1 > v35 )
        goto LABEL_98;
      *(_DWORD *)(v32 + 4) = v36;
      v32 += 4;
      while ( 1 )
      {
        v37 = v30;
        if ( i >= v25 )
          break;
        v38 = *v30++;
        if ( !v38 )
          break;
        ++i;
      }
      while ( 1 )
      {
        v30 = v37;
        if ( i >= v25 )
          break;
        v39 = *v37++;
        if ( v39 )
          goto LABEL_92;
        ++i;
      }
      v30 = 0;
LABEL_92:
      ++v33;
    }
    v15 = v22 == 0;
  }
  else
  {
    memset(&s, 0, 0x200u);
    v9 = sub_34390(v1, "internal_ip", (int)&s, 20);
    if ( v9 )
    {
      v10 = pf_line_spchar_validate(&s);
      sf_strncpy(&v6->field_24, &s, 20);
      v9 = (const char *)is_valid_pf_ipv4(&v6->field_24);
      if ( v9 )
        v9 = (const char *)(v10 == 0);
    }
    memset(&s, 0, 0x200u);
    if ( v9 )
    {
      v9 = sub_34390(v1, "protocol", (int)&s, 8);
      if ( v9 )
      {
        v9 = (const char *)(pf_line_spchar_validate(&s) == 0);
        sf_strncpy(v6, &s, 8);
      }
    }
    memset(&s, 0, 0x200u);
    if ( v9 && sub_34390(v1, "ext_sport", (int)&s, 512) )
    {
      v11 = pf_line_spchar_validate(&s);
      v12 = atoi(&s);
      if ( (unsigned int)(v12 - 1) <= 0xFFFE )
      {
        v9 = (const char *)(v11 == 0);
        v6->field_8 = v12;
      }
      else
      {
        v9 = 0;
      }
    }
    else if ( strcmp((const char *)v6, "gre") )
    {
      v9 = 0;
    }
    memset(&s, 0, 0x200u);
    if ( v9 )
    {
      if ( sub_34390(v1, "ext_eport", (int)&s, 512) )
      {
        v9 = (const char *)(pf_line_spchar_validate(&s) == 0);
        v13 = atoi(&s);
        if ( (unsigned int)(v13 - 1) <= 0xFFFE )
          v6->field_12 = v13;
        else
          v9 = 0;
      }
      else
      {
        v9 = (const char *)1;
      }
    }
    memset(&s, 0, 0x200u);
    if ( v9 )
    {
      if ( sub_34390(v1, "int_sport", (int)&s, 512) )
      {
        v9 = (const char *)(pf_line_spchar_validate(&s) == 0);
        v14 = atoi(&s);
        if ( (unsigned int)(v14 - 1) <= 0xFFFE )
          v6->field_16 = v14;
        else
          v9 = 0;
      }
      else
      {
        v9 = (const char *)1;
      }
    }
    memset(&s, 0, 0x200u);
    if ( !v9 )
      goto LABEL_98;
    if ( !sub_34390(v1, "int_eport", (int)&s, 512) )
      return v3;
    v15 = pf_line_spchar_validate(&s) == 0;
    v16 = atoi(&s);
    if ( (unsigned int)(v16 - 1) > 0xFFFE )
      goto LABEL_98;
    v6->field_20 = v16;
  }
  if ( v15 )
    return v3;
LABEL_98:
  v3 = 0;
  delete_pf_rule(0, v2);
  return v3;
}
// 103B8: using guessed type int __fastcall insert_nf_to_rule(_DWORD, _DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10A84: using guessed type int __fastcall is_valid_pf_ipv4(_DWORD);
// 10C94: using guessed type int __fastcall delete_pf_rule(_DWORD, _DWORD);
// 10CF4: using guessed type int init_pf_netfilter(void);
// 10E2C: using guessed type int init_pf_rule(void);
// 1169C: using guessed type int __fastcall pf_line_spchar_validate(_DWORD);
// 118AC: using guessed type int init_tr_netfilter(void);
// 11D38: using guessed type int __fastcall insert_tr_to_rule(_DWORD, _DWORD);
// 344C8: using guessed type char nptr[512];

//----- (00034C4C) --------------------------------------------------------
int __fastcall sub_34C4C(int result)
{
  if ( result )
    result = delete_pf_rule(0, result);
  return result;
}
// 10C94: using guessed type int __fastcall delete_pf_rule(_DWORD, _DWORD);

//----- (00034C5C) --------------------------------------------------------
int __fastcall sub_34C5C(int a1, int a2, int a3)
{
  int v3; // r4@1
  int v4; // r8@1
  int v5; // r7@1
  int v6; // r6@2
  char *v7; // r0@6
  const char *v8; // r8@9
  char *v9; // r0@9
  signed int v10; // r5@12
  void *v11; // r6@16
  signed int v12; // r2@16
  _BYTE *v13; // r3@16
  _BYTE *v14; // r1@17
  int v15; // t1@17

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( !a1 )
    return v3;
  v6 = 0;
  while ( 1 )
  {
    if ( strncmp((const char *)v3, "delcheck", 8u) )
      goto LABEL_6;
    if ( v6 == v4 )
      break;
    ++v6;
LABEL_6:
    v7 = strchr((const char *)v3, 38);
    v3 = (int)v7;
    if ( !v7 )
      return v3;
    v3 = (int)(v7 + 1);
  }
  if ( !v3 )
    return v3;
  v8 = (const char *)(v3 + 9);
  v9 = strchr((const char *)(v3 + 9), 38);
  if ( !v9 )
    v9 = (char *)&v8[strlen((const char *)(v3 + 9))];
  v3 = v9 - v8;
  if ( v9 == v8 )
    return v3;
  v10 = 511;
  if ( v3 < 511 )
    v10 = v9 - v8;
  if ( strchr(v8, 37) )
    v10 *= 3;
  v11 = malloc(v10 + 1);
  memcpy(v11, v8, v10);
  v12 = 0;
  v13 = v11;
  *((_BYTE *)v11 + v10) = 0;
  while ( v12 < v10 )
  {
    v14 = v13;
    v15 = *v13++;
    if ( v15 == 43 )
      *(v13 - 1) = 32;
    if ( *(v13 - 1) == 38 )
    {
      *v14 = 0;
      break;
    }
    ++v12;
  }
  v3 = 1;
  decode_string(v11);
  sf_strncpy(v5, v11, 512);
  free(v11);
  return v3;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 109C4: using guessed type int __fastcall decode_string(_DWORD);

//----- (00034D98) --------------------------------------------------------
signed int __fastcall sub_34D98(const char *a1)
{
  const char *v1; // r4@1
  const char *v2; // r0@2
  _DWORD *v3; // r5@4
  int v4; // r0@5
  _DWORD *v5; // r1@5
  signed int v6; // r2@5
  const char *v7; // r0@5
  int v8; // r0@7
  int v9; // r0@10
  _DWORD *v10; // r1@10
  signed int v11; // r2@10
  const char *v12; // r0@10
  signed int v13; // r4@13
  int v14; // r5@14
  int *v15; // r6@15
  int v16; // r0@20
  int v18; // [sp+0h] [bp-C850h]@15
  char s; // [sp+C800h] [bp-50h]@4
  int v20; // [sp+C820h] [bp-30h]@2

  v1 = a1;
  if ( !a1 )
    return -1;
  v2 = sub_34390(a1, "act", (int)&v20, 32);
  if ( !v2 )
  {
    v13 = -1;
    goto LABEL_20;
  }
  if ( strcmp((const char *)&v20, "add") )
  {
    if ( !strcmp((const char *)&v20, "modify") )
    {
      memset(&s, 0, 0x20u);
      v3 = sub_344C8((int)v1);
      if ( sub_34390(v1, "priority", (int)&s, 32) )
      {
        v9 = atoi(&s);
        v10 = v3;
        v11 = v9;
        v12 = "user_pf";
      }
      else
      {
        v12 = "user_pf";
        v10 = v3;
        v11 = -1;
      }
      v8 = portforward_modify_rule(v12, v10, v11);
      goto LABEL_13;
    }
    v14 = strcmp((const char *)&v20, "del");
    if ( v14 )
      return -1;
    v15 = &v18;
    memset(&v18, 0, 0xC800u);
    do
    {
      if ( !sub_34C5C((int)v1, v14, (int)v15) )
        break;
      ++v14;
      v15 += 128;
    }
    while ( v14 != 100 );
    v2 = (const char *)portforward_remove_rules("user_pf", &v18, v14);
    v13 = (signed int)v2;
    goto LABEL_20;
  }
  memset(&s, 0, 0x20u);
  v3 = sub_344C8((int)v1);
  if ( sub_34390(v1, "priority", (int)&s, 32) )
  {
    v4 = atoi(&s);
    v5 = v3;
    v6 = v4;
    v7 = "user_pf";
  }
  else
  {
    v7 = "user_pf";
    v5 = v3;
    v6 = 100;
  }
  v8 = portforward_add_rule(v7, v5, v6);
LABEL_13:
  v13 = v8;
  v2 = (const char *)sub_34C4C((int)v3);
LABEL_20:
  v16 = signal_update(v2);
  signal_save(v16);
  return v13;
}
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10D84: using guessed type int __fastcall portforward_add_rule(_DWORD, _DWORD, _DWORD);
// 11750: using guessed type int __fastcall portforward_remove_rules(_DWORD, _DWORD, _DWORD);
// 11A74: using guessed type int __fastcall portforward_modify_rule(_DWORD, _DWORD, _DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);

//----- (00034F6C) --------------------------------------------------------
signed int __fastcall sub_34F6C(const char *a1)
{
  const char *v1; // r5@1
  const char *v2; // r0@2
  signed int v3; // r4@3
  int v4; // r4@4
  int *v5; // r6@5
  int v6; // r0@9
  int v8; // [sp+0h] [bp-C830h]@5
  char v9; // [sp+C800h] [bp-30h]@2

  v1 = a1;
  if ( !a1 )
    return -1;
  v2 = sub_34390(a1, "act", (int)&v9, 32);
  if ( v2 )
  {
    v4 = strcmp(&v9, "del");
    if ( v4 )
      return -1;
    v5 = &v8;
    memset(&v8, 0, 0xC800u);
    do
    {
      if ( !sub_34C5C((int)v1, v4, (int)v5) )
        break;
      ++v4;
      v5 += 128;
    }
    while ( v4 != 100 );
    v2 = (const char *)portforward_remove_rules("upnp_pf", &v8, v4);
    v3 = (signed int)v2;
    goto LABEL_9;
  }
  v3 = -1;
LABEL_9:
  v6 = signal_update(v2);
  signal_save(v6);
  return v3;
}
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 11750: using guessed type int __fastcall portforward_remove_rules(_DWORD, _DWORD, _DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);

//----- (00035030) --------------------------------------------------------
int __fastcall sub_35030(int a1)
{
  int v1; // r6@1
  FILE *v2; // r5@1
  signed int v3; // r10@2
  char *v4; // r8@2
  char *v5; // r0@5
  const char *v6; // r9@5
  char *v7; // r0@8
  int v8; // r9@8
  char *v9; // r1@8
  const char *v10; // r0@9
  char *v11; // r0@11
  char *v12; // r4@11
  const char *v13; // r0@12
  char v14; // r3@14
  char *v15; // r1@22
  const char *v16; // r0@23
  char *v17; // r4@27
  const char *v18; // r0@30
  char *v19; // r4@30
  int v20; // r1@34
  int v21; // r0@34
  int v22; // r1@34
  int v23; // r0@34
  int v24; // r1@34
  int v25; // r0@34
  int v26; // r1@34
  int v27; // r0@34
  int v28; // r1@34
  int v29; // r0@34
  void *v30; // r5@34
  int v31; // r1@34
  int v32; // r0@34
  int *v33; // r5@34
  int v34; // r0@34
  const char *v35; // r0@35
  const char *v36; // r0@36
  int v37; // r1@38
  int v38; // r0@38
  int v39; // r1@38
  int v40; // r0@38
  int v41; // r1@38
  int v42; // r0@38
  int v43; // r1@38
  int v44; // r0@38
  int v45; // r1@38
  int v46; // r0@38
  void *v47; // r5@38
  int v48; // r1@38
  int v49; // r0@38
  int v50; // r0@38
  int v51; // r0@39
  int v52; // r1@41
  int v53; // r0@41
  int v54; // r1@41
  int v55; // r0@41
  int v56; // r1@41
  int v57; // r0@41
  int v58; // r1@41
  int v59; // r0@41
  void *v60; // r5@41
  int v61; // r1@41
  int v62; // r0@41
  int v63; // r0@41
  const char *v64; // r0@42
  int v65; // r1@45
  int v66; // r0@45
  int v67; // r1@45
  int v68; // r0@45
  int v69; // r1@45
  int v70; // r0@45
  int v71; // r1@45
  int v72; // r0@45
  void *v73; // r5@45
  int v74; // r1@45
  int v75; // r0@45
  int v76; // r0@45
  int result; // r0@49
  int v78; // r1@50
  int v79; // r0@50
  int v80; // r1@50
  int v81; // r0@50
  int v82; // r1@50
  int v83; // r0@50
  int v84; // r1@50
  int v85; // r0@50
  int v86; // r1@50
  int v87; // r0@50
  int v88; // r0@50
  int v89; // r0@53
  void *v90; // r0@55
  int v91; // r1@55
  int v92; // r0@55
  int v93; // r1@55
  int v94; // r0@55
  FILE *v95; // r5@55
  int v96; // r8@56
  char *v97; // r0@58
  int v98; // r1@63
  int v99; // r0@63
  int v100; // r1@63
  int v101; // r0@63
  void *v102; // r0@63
  int v103; // r1@63
  int v104; // r0@63
  char *v105; // r1@64
  int v106; // r1@66
  char *v107; // r1@67
  char *v108; // r0@69
  bool v109; // zf@69
  char *v110; // r1@69
  char *v111; // r0@69
  char *v112; // r1@74
  char *v113; // r7@77
  signed int v114; // r5@77
  int v115; // r0@79
  int v116; // r0@82
  const char *v117; // r0@82
  int v118; // r1@82
  int v119; // r0@83
  void *v120; // r0@84
  int v121; // r1@84
  int v122; // r0@84
  int v123; // r1@84
  int v124; // r0@84
  int v125; // r1@84
  int v126; // r0@84
  void *v127; // r0@84
  int v128; // r1@84
  int v129; // r0@84
  int v130; // r1@84
  int v131; // r0@84
  void *v132; // r0@84
  int v133; // r1@84
  int v134; // r0@84
  int v135; // r1@84
  int v136; // r0@84
  int v137; // r1@84
  int v138; // r0@84
  void *v139; // r5@84
  int v140; // r1@84
  int v141; // r0@84
  void *v142; // r5@84
  int v143; // r1@84
  int v144; // r0@84
  int v145; // r0@84
  int v146; // r0@85
  void *v147; // r5@87
  int v148; // r1@87
  int v149; // r0@87
  int v150; // r1@87
  const char *v151; // r0@87
  int v152; // r1@87
  const char *v153; // r0@87
  void *v154; // r6@92
  int v155; // r1@92
  int v156; // r0@92
  void *v157; // r0@92
  char v158; // [sp+1Ch] [bp-4DCh]@5
  char v159; // [sp+21h] [bp-4D7h]@71
  char v160; // [sp+26h] [bp-4D2h]@76
  char v161; // [sp+2Bh] [bp-4CDh]@76
  char v162; // [sp+21Ch] [bp-2DCh]@58
  int v163; // [sp+41Ch] [bp-DCh]@34
  char v164; // [sp+49Ch] [bp-5Ch]@66
  char v165; // [sp+4B0h] [bp-48h]@63
  char v166; // [sp+4C4h] [bp-34h]@63

  v1 = a1;
  print_js_file((int)"natrouterconf", (int)"portforward");
  sub_33418();
  puts("<script language=JavaScript>");
  puts("function SelectServer()");
  puts("{");
  puts("\tvar F = document.portforward_fm;");
  puts("\tButtonViewControl('modify', document);");
  puts("\t\tF.protocol.value = 'tcp';");
  puts("\t\tF.ext_sport.value = '';\tF.ext_eport.value='';");
  puts("\t\tF.int_sport.value = '';\tF.int_eport.value='';");
  puts("\t\tF.trigger_sport.value = '';\tF.trigger_eport.value='';");
  puts("\t\tF.forward_ports.value = '';");
  puts("\tif(F.sel_server.value == '0') {");
  puts("\tChangeInputForm('user',document);");
  puts("\t\tEnableObj_For_PF(F.protocol);\tEnableObj_For_PF(F.int_sport);\tEnableObj_For_PF(F.int_eport);");
  puts("\t}");
  v2 = fopen("/var/virtsvr_rule", "r");
  if ( v2 )
  {
    v3 = 1;
    v4 = 0;
    while ( 1 )
    {
      v17 = (char *)feof(v2);
      if ( v17 || v3 == 11 )
        break;
      memset(&v158, 0, 0x200u);
      fgets(&v158, 512, v2);
      v5 = strtok(&v158, ":");
      v6 = v5;
      if ( v5 )
      {
        printf("\telse if(F.sel_server.value == '%s') {\n", v5);
        puts("\tChangeInputForm('user',document);");
        puts("\t\tF.int_eport.value='';");
        if ( !strcmp(v6, "pptp") )
        {
          puts("\t\tF.protocol.value = 'tcp';");
          puts("\t\tF.ext_sport.value = '1723';\tF.ext_eport.value='';");
          puts("\t\tF.int_sport.value = '1723';\tF.int_eport.value='';");
          puts("\t\tEnableObj_For_PF(F.protocol);\tEnableObj_For_PF(F.int_sport);\tEnableObj_For_PF(F.int_eport);");
        }
        else
        {
          strtok(v17, ":");
          v7 = strtok(v17, ":");
          v8 = atoi(v7);
          strtok(v17, ":");
          strtok(v17, ":");
          strtok(v17, ":");
          v9 = strtok(v17, ":");
          if ( v8 <= 1 )
          {
            printf("\t\tF.protocol.value = '%s';\n", v9);
            v10 = "\t\tEnableObj_For_PF(F.protocol);";
          }
          else
          {
            v10 = "\t\tDisableObj_For_PF(F.protocol);";
          }
          printf(v10, v9);
          strtok(0, ":");
          v11 = strtok(0, ":");
          v12 = v11;
          if ( v8 <= 1 )
          {
            if ( v11 )
            {
              v4 = strchr(v11, 45);
              if ( v4 )
                v14 = 0;
              if ( v4 )
                *v4 = v14;
              printf("\t\tF.int_sport.value = '%s';\n", v12);
            }
            if ( v4 )
              printf("\t\tF.int_eport.value = '%s';\n", v12);
            printf("\t\tEnableObj_For_PF(F.int_sport);");
            v13 = "\t\tEnableObj_For_PF(F.int_eport);";
          }
          else
          {
            puts("\t\tF.int_sport.value = '';");
            puts("\t\tF.int_eport.value = '';");
            printf("\t\tDisableObj_For_PF(F.int_sport);");
            v13 = "\t\tDisableObj_For_PF(F.int_eport);";
          }
          printf(v13);
          strtok(0, ":");
          v15 = strtok(0, ":");
          if ( v8 <= 1 )
          {
            printf("\t\tF.ext_sport.value = '%s';\n", v15);
            puts("\t\tF.ext_eport.value = '';");
            printf("\t\tEnableObj_For_PF(F.ext_sport);");
            v16 = "\t\tEnableObj_For_PF(F.ext_eport);";
          }
          else
          {
            puts("\t\tF.ext_sport.value = '';");
            puts("\t\tF.ext_eport.value = '';");
            printf("\t\tDisableObj_For_PF(F.ext_sport);");
            v16 = "\t\tDisableObj_For_PF(F.ext_eport);";
          }
          printf(v16);
        }
        ++v3;
        puts("\t}");
      }
    }
    fclose(v2);
  }
  puts("\telse if(F.sel_server.value == 'NULL') {");
  puts("\tChangeInputForm('user',document);");
  puts("\t\tF.protocol.value = 'tcp';");
  puts("\t\tF.ext_sport.value = '';\tF.ext_eport.value='';");
  puts("\t\tF.int_sport.value = '';\tF.int_eport.value='';");
  puts("\t\tEnableObj_For_PF(F.protocol);\tEnableObj_For_PF(F.int_sport);\tEnableObj_For_PF(F.int_eport);");
  puts("\t}");
  puts("\telse if(F.sel_server.value == 'trigger') {");
  puts("\tChangeInputForm('trigger',document);");
  puts("\t\tF.protocol.value = 'tcp';");
  puts("\t\tF.ext_sport.value = '';\tF.ext_eport.value='';");
  puts("\t\tF.int_sport.value = '';\tF.int_eport.value='';");
  puts("\t\tEnableObj_For_PF(F.protocol);\tEnableObj_For_PF(F.int_sport);\tEnableObj_For_PF(F.int_eport);");
  puts("\t}");
  puts("}");
  puts("</script>");
  printf("<table class=v3_table>");
  printf("<form method=get action=\"timepro.cgi\" name=\"portforward_fm\">");
  printf("<input type=hidden name=\"tmenu\" value=\"natrouterconf\">");
  printf("<input type=hidden name=\"smenu\" value=\"portforward\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  printf("<input type=hidden name=\"clicked_name\" value=\"\">");
  printf("<input type=hidden name=\"clicked_bg\" value=\"\">");
  printf("<input type=hidden name=\"old_priority\" value=\"\">");
  printf("<input type=hidden name=\"cur_priority\" value=\"\">");
  printf("<input type=hidden name=\"rule_count\" value=\"0\">");
  printf("<tr class=\"pf_tr\"><td colspan=2 width=100%% class=\"pf_td\" style=\"vertical-align:top;\">");
  if ( v1 )
  {
    v18 = (const char *)get_parameter_value(v1, "mode");
    v19 = (char *)v18;
    if ( !v18 || !strcmp(v18, "user") )
      goto LABEL_34;
    if ( !strcmp(v19, "all") )
    {
      puts("<input type=\"hidden\" name=\"mode\" value=\"all\">");
      printf("<TABLE width=100%% class=\"pf_table\">");
      printf("<COL WIDTH=\"45\"><COL WIDTH=\"100\"><COL WIDTH=\"140\"><COL WIDTH=\"140\"><COL WIDTH=\"120\"><COL WIDTH=\"%%\">\n");
      printf("<TR height=\"24\" class=\"pf_tr\">");
      v38 = get_ux_text_common(988, v37);
      printf("<TD class=\"pf_td\"><P align=\"center\" class=\"pf_p\">%s</P></TD>\n", v38);
      v40 = get_ux_text_common(1404, v39);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v40);
      v42 = get_ux_text_common(950, v41);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v42);
      v44 = get_ux_text_common(944, v43);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v44);
      v46 = get_ux_text_common(946, v45);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v46);
      v47 = get_image_dir();
      v49 = get_ux_text_common(143, v48);
      printf(
        "<TD class=\"pf_td\"><P align=\"right\" class=\"pf_p\" style=\"margin:0; padding-right:17px;\">\t\t\t<a class=\"p"
        "f_a\" style=\"cursor:pointer; padding-bottom:3px;\" onclick=\"onDeleteClicked('user');\">\t\t\t<img src=\"/%s/mi"
        "nus_icon.gif\">%s</a>&nbsp;<input type=\"checkbox\" name=\"alldel_user\" \t\t\tonclick=\"onAllDeleteChecked('use"
        "r',document,this.checked);\"></P></TD>\n",
        v47,
        v49);
      printf("</TR>");
      printf("<TR style=\"border-collapse:collapse; position:relative; border-top:1px rgba(128,128,128,0.3); solid !important;\t\t\tborder-bottom:1px rgba(128,128,128,0.3); solid !important;\">");
      printf("<TD colspan=\"6\" width=\"100%%\" height=\"216\" class=\"pf_td\">");
      v50 = snprintf((char *)&v163, 0x80u, "timepro.cgi?tmenu=iframe&smenu=user_portforward&mode=all");
      if ( is_mobile_agent(v50) )
      {
        print_div_m_str((int)"216", (int)"100%", (int)"display:inline-block");
        v51 = printf(
                "<iframe name=\"user_portforward\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scroll"
                "ing=yes>\t\t\t\t</iframe>",
                &v163);
        print_div_m_etr(v51);
      }
      else
      {
        printf(
          "<iframe name=\"user_portforward\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scrolling=ye"
          "s>\t\t\t\t</iframe>",
          &v163);
      }
      printf("</TD></TR>");
      printf("<TR height=\"24\" class=\"pf_tr\">");
      v53 = get_ux_text_common(988, v52);
      printf("<TD class=\"pf_td\"><P align=\"center\" class=\"pf_p\">%s</P></TD>\n", v53);
      v55 = get_ux_text_common(1363, v54);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v55);
      v57 = get_ux_text_common(950, v56);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v57);
      v59 = get_ux_text_common(944, v58);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v59);
      puts("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\"></P></TD>");
      v60 = get_image_dir();
      v62 = get_ux_text_common(143, v61);
      printf(
        "<TD class=\"pf_td\"><P align=\"right\" class=\"pf_p\" style=\"margin:0; padding-right:17px;\">\t\t\t<a class=\"p"
        "f_a\" style=\"cursor:pointer; padding-bottom:3px;\" onclick=\"onDeleteClicked('upnp');\">\t\t\t<img src=\"/%s/mi"
        "nus_icon.gif\">%s</a>&nbsp;<input type=\"checkbox\" name=\"alldel_upnp\" \t\t\tonclick=\"onAllDeleteChecked('upn"
        "p',document,this.checked);\"></P></TD>\n",
        v60,
        v62);
      v33 = &v163;
      printf("</TR>");
      printf("<TR style=\"border-collapse:collapse; position:relative; border-top:1px rgba(128,128,128,0.3); solid !important;\t\t\tborder-bottom:1px rgba(128,128,128,0.3); solid !important;\">");
      printf("<TD colspan=\"6\" width=\"100%%\" height=\"144\" class=\"pf_td\">");
      v63 = snprintf((char *)&v163, 0x80u, "timepro.cgi?tmenu=iframe&smenu=upnp_portforward&mode=all");
      if ( is_mobile_agent(v63) )
      {
        v64 = "144";
LABEL_47:
        print_div_m_str((int)v64, (int)"100%", (int)"display:inline-block");
        v36 = (const char *)&unk_9618D;
        goto LABEL_53;
      }
    }
    else
    {
      if ( strcmp(v19, "upnp") )
      {
        result = strcmp(v19, "trigger_status");
        if ( result )
          return result;
        puts("<input type=\"hidden\" name=\"mode\" value=\"trigger_status\">");
        v33 = &v163;
        printf("<TABLE width=100%% class=\"pf_table\">");
        printf("<COL WIDTH=\"45\"><COL WIDTH=\"100\"><COL WIDTH=\"140\"><COL WIDTH=\"140\"><COL WIDTH=\"120\"><COL WIDTH=\"%%\">\n");
        printf("<TR height=\"24\" class=\"pf_tr\">");
        v79 = get_ux_text_common(988, v78);
        printf("<TD class=\"pf_td\"><P align=\"center\" class=\"pf_p\">%s</P></TD>\n", v79);
        v81 = get_ux_text_common(1016, v80);
        printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v81);
        v83 = get_ux_text_common(950, v82);
        printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v83);
        v85 = get_ux_text_common(1019, v84);
        printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v85);
        v87 = get_ux_text_common(1013, v86);
        printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v87);
        puts("<TD class=\"pf_td\"><P align=\"right\" class=\"pf_p\" style=\"margin:0; padding-right:17px;\"></P></TD>");
        printf("</TR>");
        printf("<TR style=\"border-collapse:collapse; position:relative; border-top:1px rgba(128,128,128,0.3); solid !important;\t\t\tborder-bottom:1px rgba(128,128,128,0.3); solid !important;\">");
        printf("<TD colspan=\"6\" width=\"100%%\" height=\"384\" class=\"pf_td\">");
        v88 = snprintf((char *)&v163, 0x80u, (const char *)&unk_96318);
        if ( !is_mobile_agent(v88) )
        {
          v35 = "<iframe name=\"trigger_portforward\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scr"
                "olling=yes>\t\t\t\t</iframe>";
          goto LABEL_54;
        }
        print_div_m_str((int)"384", (int)"100%", (int)"display:inline-block");
        v36 = "<iframe name=\"trigger_portforward\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scrol"
              "ling=yes>\t\t\t\t</iframe>";
        goto LABEL_53;
      }
      puts("<input type=\"hidden\" name=\"mode\" value=\"upnp\">");
      printf("<TABLE width=100%% class=\"pf_table\">");
      printf("<COL WIDTH=\"45\"><COL WIDTH=\"100\"><COL WIDTH=\"140\"><COL WIDTH=\"140\"><COL WIDTH=\"120\"><COL WIDTH=\"%%\">\n");
      printf("<TR height=\"24\" class=\"pf_tr\">");
      v66 = get_ux_text_common(988, v65);
      printf("<TD class=\"pf_td\"><P align=\"center\" class=\"pf_p\">%s</P></TD>\n", v66);
      v68 = get_ux_text_common(1404, v67);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v68);
      v70 = get_ux_text_common(950, v69);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v70);
      v72 = get_ux_text_common(944, v71);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v72);
      puts("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\"></P></TD>");
      v73 = get_image_dir();
      v75 = get_ux_text_common(143, v74);
      printf(
        "<TD class=\"pf_td\"><P align=\"right\" class=\"pf_p\" style=\"margin:0; padding-right:17px;\">\t\t\t<a class=\"p"
        "f_a\" style=\"cursor:pointer; padding-bottom:3px;\" onclick=\"onDeleteClicked('upnp');\">\t\t\t<img src=\"/%s/mi"
        "nus_icon.gif\">%s</a>&nbsp;<input type=\"checkbox\" name=\"alldel_upnp\" \t\t\tonclick=\"onAllDeleteChecked('upn"
        "p',document,this.checked);\"></P></TD>\n",
        v73,
        v75);
      v33 = &v163;
      printf("</TR>");
      printf("<TR style=\"border-collapse:collapse; position:relative; border-top:1px rgba(128,128,128,0.3); solid !important;\t\t\tborder-bottom:1px rgba(128,128,128,0.3); solid !important;\">");
      printf("<TD colspan=\"6\" width=\"100%%\" height=\"384\" class=\"pf_td\">");
      v76 = snprintf((char *)&v163, 0x80u, (const char *)&unk_96236);
      if ( is_mobile_agent(v76) )
      {
        v64 = "384";
        goto LABEL_47;
      }
    }
    v35 = (const char *)&unk_9618D;
    goto LABEL_54;
  }
  v19 = 0;
LABEL_34:
  puts("<input type=\"hidden\" name=\"mode\" value=\"user\">");
  printf("<TABLE width=100%% class=\"pf_table\">");
  printf("<COL WIDTH=\"45\"><COL WIDTH=\"100\"><COL WIDTH=\"140\"><COL WIDTH=\"140\"><COL WIDTH=\"120\"><COL WIDTH=\"%%\">\n");
  printf("<TR height=\"24\" class=\"pf_tr\">");
  v21 = get_ux_text_common(988, v20);
  printf("<TD class=\"pf_td\"><P align=\"center\" class=\"pf_p\">%s</P></TD>\n", v21);
  v23 = get_ux_text_common(1404, v22);
  printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v23);
  v25 = get_ux_text_common(950, v24);
  printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v25);
  v27 = get_ux_text_common(944, v26);
  printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v27);
  v29 = get_ux_text_common(946, v28);
  printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v29);
  v30 = get_image_dir();
  v32 = get_ux_text_common(143, v31);
  printf(
    "<TD class=\"pf_td\"><P align=\"right\" class=\"pf_p\" style=\"margin:0; padding-right:17px;\">\t\t\t<a class=\"pf_a\""
    " style=\"cursor:pointer; padding-bottom:3px;\" onclick=\"onDeleteClicked('user');\">\t\t\t<img src=\"/%s/minus_icon."
    "gif\">%s</a>&nbsp;<input type=\"checkbox\" name=\"alldel_user\" \t\t\tonclick=\"onAllDeleteChecked('user',document,t"
    "his.checked);\"></P></TD>\n",
    v30,
    v32);
  v33 = &v163;
  printf("</TR>");
  printf("<TR style=\"border-collapse:collapse; position:relative; border-top:1px rgba(128,128,128,0.3); solid !important;\t\t\tborder-bottom:1px rgba(128,128,128,0.3); solid !important;\">");
  printf("<TD colspan=\"6\" width=\"100%%\" height=\"384\" class=\"pf_td\">");
  v34 = snprintf((char *)&v163, 0x80u, (const char *)&unk_95E16);
  if ( !is_mobile_agent(v34) )
  {
    v35 = "<iframe name=\"user_portforward\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scrolling=ye"
          "s>\t\t\t\t</iframe>";
LABEL_54:
    printf(v35, v33);
    goto LABEL_55;
  }
  print_div_m_str((int)"384", (int)"100%", (int)"display:inline-block");
  v36 = "<iframe name=\"user_portforward\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scrolling=yes>"
        "\t\t\t\t</iframe>";
LABEL_53:
  v89 = printf(v36, v33);
  print_div_m_etr(v89);
LABEL_55:
  printf((const char *)&unk_7FF8C);
  printf("</td></tr>");
  puts("<tr height=\"100\" class=\"pf_tr\" style=\"background-Color:#eeeeee;\">");
  printf("<td width=557 class=\"pf_td\">");
  printf("<TABLE width=557 class=\"pf_table\">");
  puts("<TR id=\"form_line_1\" height=\"24\" class=\"pf_tr\">");
  puts("<TD width=\"10\" align=\"center\" class=\"pf_td\">");
  v90 = get_image_dir();
  printf("<img src=\"/%s/pf_square_icon.gif\"></TD>\n", v90);
  printf("<TD width=\"70\" class=\"pf_td\">");
  v92 = get_ux_text_common(1071, v91);
  printf("<span class=\"pf_span\">%s</span></TD>", v92);
  printf("<TD width=\"155\" align=\"left\" class=\"pf_td\">");
  printf("<input type=\"text\" name=\"rule_name\" size=\"21\" style=\"width:145px;\" maxlength=\"127\" class=\"pf_textbox\" \t\tonkeydown=\"ButtonViewControl('modify'); return true;\">");
  printf("</TD><TD width=\"160\" align=\"left\" class=\"pf_td\" id=\"SELMENUBOXTD\">");
  printf("<select name=\"sel_server\" class=\"pf_select\" style=\"width:160px;\" onchange=\"SelectServer();\">");
  v94 = get_ux_text_common(959, v93);
  printf("<option value=\"0\">%s</option>", v94);
  v95 = fopen("/var/virtsvr_rule", "r");
  if ( v95 )
  {
    v19 = 0;
    v96 = 0;
    while ( !feof(v95) )
    {
      memset(&v162, 0, 0x200u);
      fgets(&v162, 512, v95);
      v97 = strtok(&v162, ":");
      v19 = v97;
      if ( v97 )
      {
        if ( v96 == 10 )
          break;
        printf("<option value=\"%s\">", v97);
        ++v96;
        v19 = strtok(0, ":");
        printf("%s</option>", v19);
      }
    }
    fclose(v95);
  }
  printf("<option value=\"NULL\">---------------------------</option>");
  v99 = get_ux_text_common(1018, v98);
  printf("<option value=\"trigger\">%s</option>", v99);
  printf("</select>");
  printf("</TD><TD width=\"162\" class=\"pf_td\" align=\"left\" id=\"DISABLEBOXTD\">");
  printf("<SPAN class=\"pf_span\">");
  v101 = get_ux_text_common(987, v100);
  printf(
    "<input type=\"checkbox\" class=\"pf_checkbox\" name=\"disable\" id=\"disable_id\" onclick=\"onCheckedDisable();\">\n"
    "\t\t<label for=\"disable_id\">%s</label>\n",
    v101);
  printf("</SPAN>");
  printf("</TD></TR>");
  puts("<TR id=\"form_line_2\" height=\"24\" class=\"pf_tr\">");
  puts("<TD width=\"10\" align=\"center\" class=\"pf_td\">");
  v102 = get_image_dir();
  printf("<img src=\"/%s/pf_square_icon.gif\"></TD>\n", v102);
  printf("<TD width=\"70\" class=\"pf_td\">");
  v104 = get_ux_text_common(945, v103);
  printf("<span class=\"pf_span\">%s</span></TD>", v104);
  printf("<TD width=\"155\" align=\"left\" class=\"pf_td\">");
  get_ifconfig((int)"br0", (int)&v166, (int)&v165);
  if ( v166 )
    v105 = &v166;
  else
    v105 = "";
  sf_strncpy(&v164, v105, 20);
  if ( v164 )
  {
    v107 = strtok(&v164, ".");
    if ( !v107 )
      v107 = "0";
    sf_strncpy(&v158, v107, 5);
    v108 = strtok(0, ".");
    v110 = v108;
    v109 = v108 == 0;
    v111 = &v158;
    if ( v109 )
      v110 = "0";
    else
      v111 = &v159;
    if ( v109 )
      v111 += 5;
    sf_strncpy(v111, v110, 5);
    v112 = strtok(0, ".");
    if ( !v112 )
      v112 = "0";
    sf_strncpy(&v160, v112, 5);
    sf_strncpy(&v161, &unk_947D9, 5);
  }
  else
  {
    v161 = 0;
    v160 = 0;
    v159 = 0;
    v158 = 0;
  }
  v113 = &v158;
  v114 = 1;
  do
  {
    v115 = get_ux_text_common(442, v106);
    printf(
      "<input type=text name=\"%s%d\" maxlength=3 size=3 style=\"width:34px; ime-mode:disabled;\" class=\"pf_textbox\" va"
      "lue=\"%s\" onfocus=\"this.select();\" onkeypress=\"return IPKeyDown('%s', %d);\" title=\"%s%d\" onkeydown=\"Button"
      "ViewControl('modify'); return true;\" onkeyup=\"IPKeyUp('%s',%d);\">",
      "internal_ip",
      v114,
      v113,
      "internal_ip",
      v114,
      v115,
      v114,
      "internal_ip",
      v114);
    if ( v114 != 4 )
      putchar(46);
    ++v114;
    v113 += 5;
  }
  while ( v114 != 5 );
  printf("</TD>");
  printf("<TD width=\"322\" colspan=\"2\" class=\"pf_td\" id=\"CURCONNBOXTD\">");
  v116 = printf("<SPAN class=\"pf_span\">");
  v117 = (const char *)get_remote_addr(v116);
  snprintf(&v166, 0x14u, v117);
  if ( strcmp(&v166, "Twin IP") )
  {
    v119 = get_ux_text_common(929, v118);
    printf(
      "<input type=\"checkbox\" class=\"pf_checkbox\" name=\"re_ip\" id=\"re_ip_id\" onclick=\"onCheckedReip(this,'intern"
      "al_ip','%s');\">\n"
      "\t\t\t<label for=\"re_ip_id\">%s</label>\n",
      &v166,
      v119);
  }
  printf("</SPAN>");
  printf("</TD>");
  printf("</TR>");
  puts("<TR id=\"form_line_3\" height=\"24\" class=\"pf_tr\">");
  puts("<TD width=\"10\" align=\"center\" class=\"pf_td\">");
  v120 = get_image_dir();
  printf("<img src=\"/%s/pf_square_icon.gif\"></TD>\n", v120);
  printf("<TD width=\"70\" class=\"pf_td\">");
  v122 = get_ux_text_common(1007, v121);
  printf("<span class=\"pf_span\">%s</span></TD>", v122);
  printf("<TD width=\"477\" colspan=\"3\" align=\"left\" class=\"pf_td\">");
  printf("<SPAN class=\"pf_span\" width=\"80\">");
  printf("<select class=\"pf_select\" name=\"protocol\" style=\"width:80px;\" onchange=\"onChangeProtocol(document);\">");
  printf("<option value=\"tcp\">TCP</option>");
  printf("<option value=\"udp\">UDP</option>");
  printf("<option value=\"tcpudp\">TCP/UDP</option>");
  printf("<option value=\"gre\">GRE</option>");
  printf("</select>");
  printf("</SPAN>");
  printf("<SPAN class=\"pf_span\" width=\"146\">");
  v124 = get_ux_text_common(944, v123);
  printf("<SPAN class=\"pf_span\" style=\"padding:0px 5px 0px 5px;\">%s</SPAN>", v124);
  printf("<input type=\"text\" name=\"ext_sport\" class=\"pf_textbox\" size=5 maxlength=5 style=\"width:42px;\" \t\tonkeydown=\"ButtonViewControl('modify'); return true;\"> ~ ");
  printf("<input type=\"text\" name=\"ext_eport\" class=\"pf_textbox\" size=5 maxlength=5 style=\"width:42px;\" \t\tonkeydown=\"ButtonViewControl('modify'); return true;\">");
  printf("</SPAN>");
  printf("<SPAN class=\"pf_span\" width=\"146\" id=\"INTPORTBOX\">");
  v126 = get_ux_text_common(946, v125);
  printf("<SPAN class=\"pf_span\" style=\"padding:0px 5px 0px 5px;\">%s</SPAN>", v126);
  printf("<input type=\"text\" name=\"int_sport\" class=\"pf_textbox\" size=5 maxlength=5 style=\"width:42px;\" \t\tonkeydown=\"ButtonViewControl('modify'); return true;\"> ~ ");
  printf("<input type=\"text\" name=\"int_eport\" class=\"pf_textbox\" size=5 maxlength=5 style=\"width:42px;\" \t\tonkeydown=\"ButtonViewControl('modify'); return true;\">");
  printf("</SPAN>");
  printf("</TD>");
  printf("</TR>");
  puts("<TR id=\"form_line_trigger1\" height=\"24\" class=\"pf_tr\" style=\"display:none;\">");
  puts("<TD width=\"10\" align=\"center\" class=\"pf_td\">");
  v127 = get_image_dir();
  printf("<img src=\"/%s/pf_square_icon.gif\"></TD>\n", v127);
  printf("<TD width=\"70\" class=\"pf_td\">");
  v129 = get_ux_text_common(1021, v128);
  printf("<span class=\"pf_span\">%s</span></TD>", v129);
  printf("<TD width=\"155\" align=\"left\" class=\"pf_td\">");
  printf("<select class=\"pf_select\" name=\"trigger_protocol\" style=\"width:80px;\" onchange=\"ButtonViewControl('modify');\">");
  printf("<option value=\"tcp\">TCP</option>");
  printf("<option value=\"udp\">UDP</option>");
  printf("</select>");
  printf("</TD>");
  printf("<TD width=\"322\" colspan=\"2\" class=\"pf_td\" align=\"left\">");
  printf("<SPAN class=\"pf_span\">");
  v131 = get_ux_text_common(1015, v130);
  printf("<SPAN class=\"pf_span\" style=\"padding-right:5px;\">%s</SPAN>", v131);
  printf("<input type=\"text\" name=\"trigger_sport\" class=\"pf_textbox\" size=5 maxlength=5 style=\"width:42px;\" \t\tonkeydown=\"ButtonViewControl('modify'); return true;\"> ~ ");
  printf("<input type=\"text\" name=\"trigger_eport\" class=\"pf_textbox\" size=5 maxlength=5 style=\"width:42px;\" \t\tonkeydown=\"ButtonViewControl('modify'); return true;\">");
  printf("</SPAN>");
  printf("</TD>");
  printf("</TR>");
  puts("<TR id=\"form_line_trigger2\" height=\"24\" class=\"pf_tr\" style=\"display:none;\">");
  puts("<TD width=\"10\" align=\"center\" class=\"pf_td\">");
  v132 = get_image_dir();
  printf("<img src=\"/%s/pf_square_icon.gif\"></TD>\n", v132);
  printf("<TD width=\"70\" class=\"pf_td\">");
  v134 = get_ux_text_common(1014, v133);
  printf("<span class=\"pf_span\">%s</span></TD>", v134);
  printf("<TD width=\"155\" align=\"left\" class=\"pf_td\">");
  printf("<select class=\"pf_select\" name=\"forward_protocol\" style=\"width:80px;\" onchange=\"ButtonViewControl('modify');\">");
  printf("<option value=\"tcp\">TCP</option>");
  printf("<option value=\"udp\">UDP</option>");
  printf("</select>");
  printf("</TD>");
  printf("<TD width=\"322\" colspan=\"2\" class=\"pf_td\" align=\"left\">");
  v136 = get_ux_text_common(1015, v135);
  printf("<SPAN class=\"pf_span\" style=\"padding-right:5px;\">%s</SPAN>", v136);
  printf("<input type=\"text\" name=\"forward_ports\" class=\"pf_textbox\" size=26 maxlength=127 style=\"width:160px;\" \t\tonkeydown=\"ButtonViewControl('modify'); return true;\">");
  printf("</TD>");
  printf("</TR>");
  printf("</TABLE>");
  printf("</td>");
  puts("<td width=\"85\" align=\"right\" height=\"100\" class=\"pf_td\" id=\"PRIORITYBOX\">");
  puts("<TABLE class=\"pf_table\" style=\"width:85px;\">");
  printf("<TR class=\"pf_tr\" style=\"height:24px;\">");
  puts("<TD class=\"pf_td\" align=\"right\">");
  puts("<SPAN class=\"pf_span\">");
  v138 = get_ux_text_common(989, v137);
  printf(
    "%s <input type=\"text\" name=\"priority\" class=\"pf_textbox\"                 size=3 maxlength=3 style=\"width:37px"
    ";\" onchange=\"onChangedPriority(%d);\">",
    v138,
    100);
  puts("</SPAN>");
  printf("</TD>");
  printf("</TR>");
  printf("<TR class=\"pf_tr\" style=\"height:24px;\">");
  puts("<TD class=\"pf_td\" align=\"right\">");
  printf("<button type=\"button\" name=\"pri_up\" class=\"pf_button\" style=\"width:80px; text-align: left; padding-left: 5px; white-space:nowrap;\" onclick=\"onRowUpClicked();\">");
  v139 = get_image_dir();
  v141 = get_ux_text_common(954, v140);
  printf("<img src=\"/%s/fw_up.gif\" style='margin: 0 2px 1px 0;'>%s</button>", v139, v141);
  printf("</TD>");
  printf("</TR>");
  printf("<TR class=\"pf_tr\" style=\"height:24px;\">");
  puts("<TD class=\"pf_td\" align=\"right\">");
  printf("<button type=\"button\" name=\"pri_down\" class=\"pf_button\" style=\"width:80px; text-align: left; padding-left: 5px; white-space:nowrap;\" onclick=\"onRowDownClicked();\">");
  v142 = get_image_dir();
  v144 = get_ux_text_common(953, v143);
  printf("<img src=\"/%s/fw_down.gif\" style='margin: 0 2px 1px 0;'>%s</button>", v142, v144);
  printf("</TD>");
  printf("</TR>");
  printf("<TR class=\"pf_tr\" style=\"height:24px;\">");
  puts("<TD class=\"pf_td\" align=\"right\">");
  printf("&nbsp;");
  printf("</TD>");
  printf("</TR>");
  printf("</TABLE>");
  printf("</td></tr>");
  puts("<tr id=\"form_line_5\" height=\"26\" class=\"pf_tr\">");
  puts("<td colspan=2 class=\"pf_td\" align=\"center\">");
  printf("<TABLE class=\"pf_table\" width=\"100%%\">\n");
  puts("<TD class=\"pf_td\" width=\"466\">");
  v145 = snprintf((char *)&v163, 0x100u, (const char *)&unk_97610);
  if ( is_mobile_agent(v145) )
  {
    print_div_m_str((int)"26", (int)"466", (int)"display:inline-block; vertical-align:middle;");
    v146 = printf(
             "<iframe name=\"restore_iframe\" src=\"%s\" frameborder=no width=466 height=26 align=center scrolling=no></iframe>",
             &v163);
    print_div_m_etr(v146);
  }
  else
  {
    printf(
      "<iframe name=\"restore_iframe\" src=\"%s\" frameborder=no width=466 height=26 align=center scrolling=no></iframe>",
      &v163);
  }
  puts("</TD>");
  puts("<TD class=\"pf_td\" align=\"right\" style=\"padding-right:5px;\">");
  puts("<button type=\"button\" class=\"pf_button\" name=\"new_rule_btn\" style=\"width:65px;\" onclick=\"onNewRuleBtnClicked();\">");
  v147 = get_image_dir();
  v149 = get_ux_text_common(919, v148);
  printf("<img src=\"/%s/pf_plus_icon.gif\"> %s\n", v147, v149);
  puts("</button>");
  memset(&v166, 0, 0x14u);
  get_ifconfig((int)"br0", (int)&v166, (int)&v165);
  printf(
    "<button type=\"button\" class=\"pf_button\" name=\"apply_btn\" style=\"width:45px;\" onclick=\"onApplyBtnClicked('%s"
    "','%s',%d);\">\n",
    &v166,
    &v165,
    100);
  v151 = (const char *)get_ux_text_common(35, v150);
  puts(v151);
  puts("</button>");
  puts("<button type=\"button\" class=\"pf_button\" name=\"cancel_btn\" style=\"width:45px;\" onclick=\"onCancelBtnClicked();\">");
  v153 = (const char *)get_ux_text_common(64, v152);
  puts(v153);
  puts("</button>");
  puts("</TD>");
  puts("</TABLE>");
  puts("</td>");
  puts("</tr>");
  puts("<tr id=\"form_line_blank\" height=\"26\" class=\"pf_tr\" style=\"display:none;\">");
  puts("<td colspan=2 class=\"pf_td\" align=\"center\">");
  printf("</td></tr>");
  printf("</form>");
  puts("</table>");
  if ( v1 )
    v19 = (char *)get_parameter_value(v1, "mode");
  if ( v19 )
  {
    if ( !strcmp(v19, "upnp") )
    {
      printf("<SCRIPT>");
      printf("var obj = parent.frames[3].document.getElementById('pf_select_menu');");
      printf("if(obj){");
      printf("obj.value = 'upnp';");
      putchar(125);
      printf("</SCRIPT>");
    }
  }
  printf(
    "<DIV ID=\"%s\" style=\"position:absolute; left:%dpx; top:%dpx; width:%dpx; height:%dpx; z-index:1; background-color:"
    "#ffffff;                 opacity:1.0; display:none;\">\n",
    "restore_mask");
  printf("<table width=\"%d\" height=\"%d\">\n", 642, 536);
  printf("<tr><td width=\"100%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"height:30px; vertical-align:middle; display:block; text-align:center;\">");
  v154 = get_image_dir();
  v156 = get_ux_text_common(951, v155);
  printf("<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; vertical-align:middle;\">%s", v154, v156);
  printf("</SPAN></td></tr></table></DIV>");
  printf(
    "<DIV ID=\"%s\" style=\"position:absolute; left:%dpx; top:%dpx; width:%dpx; height:%dpx; z-index:1; background-color:"
    "#ffffff;                 opacity:1.0; display:none;\">\n",
    "apply_mask");
  printf("<table width=\"%d\" height=\"%d\">\n", 642, 536);
  printf("<tr><td width=\"100%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"height:30px; vertical-align:middle; display:block; text-align:center;\">");
  v157 = get_image_dir();
  printf("<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; vertical-align:middle;\">", v157);
  printf("</SPAN></td></tr></table></DIV>");
  printf(
    "<DIV ID=\"%s\" style=\"position:absolute; left:%dpx; top:%dpx; width:%dpx; height:%dpx; z-index:1; background-color:"
    "#ffffff;                 opacity:0.4; display:none;\">\n",
    "fixed_mask",
    0,
    408,
    642,
    128);
  printf("<table width=\"%d\" height=\"%d\">\n", 642, 128);
  printf("<tr><td width=\"100%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"height:30px; vertical-align:middle; display:block; text-align:center;\">");
  return printf("</SPAN></td></tr></table></DIV>");
}
// 104CC: using guessed type int __fastcall get_remote_addr(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);

//----- (00036620) --------------------------------------------------------
int __fastcall print_iframe_restore_portforward(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  int result; // r0@1
  int v8; // r1@2
  int v9; // r0@3
  int v10; // r0@5
  int v11; // r0@5
  int v12; // r0@5
  int v13; // [sp+0h] [bp-88h]@1

  v2 = a2;
  printf("<BODY style=\"height:26px; display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"portforward_file_fm\" enctype=\"multipart/form-data\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"restore_portforward\">");
  printf("<input type=\"hidden\" name=\"commit\" value=\"pf_restore\">");
  printf("<table class=v3_table width=100%% height=26 style=\"vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0;\">");
  printf("<tr style=\"vertical-align:middle;\" height=24><td width=94>");
  v4 = get_ux_text_common(958, v3);
  printf(
    "<input type=button name=\"saverulebtn\" value=\"%s\" onclick=\"self.location.href='download_portforward.cgi'\" ",
    v4);
  printf("style=\"width:94px; font-size:12px; padding:1 0 1 0; margin:0 0 0 5; text-align:center;\"></td>");
  v6 = get_ux_text_common(956, v5);
  printf("<td width=94><input type=button value=\"%s\" onclick=\"parent.Portforward_Restore();\" ", v6);
  printf("style=\"width:94px; font-size:12px; padding:1 0 1 0; margin:0 0 0 5; text-align:center;\"></td>");
  printf("<td><input type=file name=\"pf_restore_file\" maxlength=100 style=\"padding:1 0 1 0; margin:0 0 0 5;\"></td>");
  printf((const char *)&unk_97FC1);
  printf("</BODY>");
  result = get_value_post_multipart(v2, "commit", &v13, 128);
  if ( !result )
    return result;
  printf("<script>");
  if ( portforward_update_by_file("/tmp/user_pf.set.tmp", "user_pf") == -1 )
    v9 = 955;
  else
    v9 = 957;
  v10 = get_ux_text_common(v9, v8);
  printf("alert('%s');", v10);
  printf("parent.UnMaskIt(parent.document,'restore_mask');");
  printf("parent.onChangedPFView(parent.parent.frames[3].document.getElementById('pf_select_menu').value);");
  printf("parent.onLoadCompleted(parent.document);");
  v11 = printf("</script>");
  v12 = signal_update(v11);
  result = signal_save(v12);
  return result;
}
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10C7C: using guessed type int __fastcall portforward_update_by_file(_DWORD, _DWORD);
// 111B0: using guessed type int __fastcall get_value_post_multipart(_DWORD, _DWORD, _DWORD, _DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);

//----- (00036788) --------------------------------------------------------
int __fastcall print_iframe_user_portforward(int a1, const char *a2)
{
  int v2; // r4@1
  const char *v3; // r8@1
  const char *v4; // r4@1
  signed int v5; // r10@4
  int v6; // r6@6
  int v7; // r5@6
  int v8; // r7@10
  int v9; // r6@14
  int v10; // r7@14
  int result; // r0@18
  int v12; // r5@18
  int i; // r6@19
  int v14; // r7@24
  int v15; // r6@28
  int v16; // r7@28
  int v17; // r5@32
  signed int j; // r3@32
  int v19; // r1@38
  int v20; // r1@40
  const char *v21; // r0@40
  bool v22; // nf@41
  unsigned __int8 v23; // vf@41
  int v24; // r3@48
  int v25; // r6@48
  int v26; // r4@48
  int v27; // lr@48
  int v28; // r12@48
  int v29; // r4@49
  signed int v30; // r6@49
  int v31; // r7@49
  int v32; // r3@50
  int v33; // t1@50
  const char *v34; // r0@53
  const char *v35; // r2@53
  bool v36; // zf@53
  const char *v37; // r0@60
  char v38; // [sp+24h] [bp-26Ch]@49
  char v39; // [sp+224h] [bp-6Ch]@37
  char s; // [sp+244h] [bp-4Ch]@2
  char v41; // [sp+263h] [bp-2Dh]@3
  int v42; // [sp+264h] [bp-2Ch]@1
  int v43; // [sp+268h] [bp-28h]@1
  unsigned int v44; // [sp+26Ch] [bp-24h]@1

  v2 = a1;
  v3 = a2;
  v44 = 0;
  v42 = 0;
  v43 = 0;
  print_js_file((int)"natrouterconf", (int)"portforward");
  sub_33418();
  v4 = (const char *)get_parameter_value(v2, "mode");
  if ( !v4 )
  {
    memset(&s, 0, 0x20u);
    if ( sub_34390(v3, "view_mode", (int)&s, 32) )
    {
      v41 = (char)v4;
      v4 = &s;
    }
  }
  printf("<BODY style=\"padding:0px 0px 0px 0px; margin:0px 0px 0px 0px;\">");
  printf("<form method=post action=\"timepro.cgi\" name=\"user_portforward_fm\" style=\"margin:0px 0px 0px 0px; padding:0px 0px 0px 0px;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"user_portforward\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  printf("<input type=hidden name=\"view_mode\" value=\"%s\">");
  printf("<input type=hidden name=\"mode\" value=\"\">");
  printf("<input type=hidden name=\"name\" value=\"\">");
  printf("<input type=hidden name=\"int_sport\" value=\"\">");
  printf("<input type=hidden name=\"int_eport\" value=\"\">");
  printf("<input type=hidden name=\"ext_sport\" value=\"\">");
  printf("<input type=hidden name=\"ext_eport\" value=\"\">");
  printf("<input type=hidden name=\"trigger_protocol\" value=\"\">");
  printf("<input type=hidden name=\"trigger_sport\" value=\"\">");
  printf("<input type=hidden name=\"trigger_eport\" value=\"\">");
  printf("<input type=hidden name=\"forward_ports\" value=\"\">");
  printf("<input type=hidden name=\"forward_protocol\" value=\"\">");
  printf("<input type=hidden name=\"internal_ip\" value=\"\">");
  printf("<input type=hidden name=\"protocol\" value=\"\">");
  printf("<input type=hidden name=\"disabled\" value=\"\">");
  printf("<input type=hidden name=\"priority\" value=\"\">");
  printf("<input type=hidden name=\"old_priority\" value=\"\">");
  printf("<table style=\"table-layout:fixed; border-collapse:collapse; border-style:none none none none; width:100%%;\">\n");
  printf("<COL WIDTH=\"45\"><COL WIDTH=\"100\"><COL WIDTH=\"140\"><COL WIDTH=\"140\"><COL WIDTH=\"120\"><COL WIDTH=\"%%\">\n");
  v5 = sub_34D98(v3);
  portforward_read_db("user_pf", &v42);
  if ( !v4 || !strcmp(v4, "user") )
  {
    v6 = v42;
    v7 = 0;
    while ( v6 && !*(_DWORD *)(v6 + 528) )
    {
      sub_33D18(1, v6, ++v7);
      v6 = *(_DWORD *)v6;
    }
    v8 = v7;
    sub_33358();
    while ( v6 && *(_DWORD *)(v6 + 528) == 1 )
    {
      ++v7;
      ++v8;
      sub_33D18(2, v6, v7);
      v6 = *(_DWORD *)v6;
    }
    v9 = 0;
    sub_33378();
    v10 = 15 - v8;
    while ( v9 < v10 )
    {
      ++v9;
      sub_33320();
    }
    goto LABEL_31;
  }
  result = strcmp(v4, "all");
  v12 = result;
  if ( result )
    return result;
  for ( i = v42; i && !*(_DWORD *)(i + 528); i = *(_DWORD *)i )
    sub_33D18(1, i, ++v12);
  v14 = v12;
  sub_33358();
  while ( i && *(_DWORD *)(i + 528) == 1 )
  {
    ++v12;
    ++v14;
    sub_33D18(2, i, v12);
    i = *(_DWORD *)i;
  }
  v15 = 0;
  sub_33378();
  v16 = 8 - v14;
  while ( v15 < v16 )
  {
    ++v15;
    sub_33320();
  }
LABEL_31:
  printf((const char *)&unk_97FC6);
  puts("<SCRIPT language=\"javascript\">");
  puts((const char *)&unk_98524);
  puts("function onNewLineClicked(mode){");
  puts("\tvar obj = document.getElementById(\"_-new_line\");");
  puts("\tif(obj){ \n\tobj.scrollIntoView(true);");
  puts("\tif(mode){");
  puts("\t\tonClickedPFRule(mode,'','','','','','','','','','','','','','','');\n}");
  puts("\telse{");
  puts("\t\tonClickedPFRule('user','','','','','','','','','','','','','','','');\n}");
  puts("\t}\n}");
  if ( v5 == -1 )
  {
    if ( !v4 || !strcmp(v4, "all") )
      printf("onNewLineClicked();");
    else
      printf("onNewLineClicked('%s');", v4);
    memset(&v39, 0, 0x20u);
    if ( !sub_34390(v3, "act", (int)&v39, 32) || strcmp(&v39, "add") || v44 <= 0x63 )
      goto LABEL_67;
    v20 = get_ux_text_common(952, v19);
    v21 = "alert('%s');";
  }
  else
  {
    v17 = v42;
    for ( j = 1; ; ++j )
    {
      v23 = 0;
      v22 = v17 < 0;
      if ( v17 )
      {
        v23 = __OFSUB__(j, v5);
        v22 = j - v5 < 0;
      }
      if ( !(v22 ^ v23) )
        break;
      v17 = *(_DWORD *)v17;
    }
    if ( v17 )
    {
      if ( *(_DWORD *)(v17 + 528) )
      {
        v29 = *(_DWORD *)(v17 + 536);
        v30 = 10;
        v31 = v29 + 20;
        memset(&v38, 0, 0x200u);
        do
        {
          v33 = *(_DWORD *)(v31 + 4);
          v31 += 4;
          v32 = v33;
          if ( v33 )
            snprintf(&v38, 0x200u, "%s%d ", &v38, v32);
          --v30;
        }
        while ( v30 );
        v34 = (const char *)*(_BYTE *)(v17 + 516);
        v35 = "true";
        v36 = v34 == 0;
        if ( !*(_BYTE *)(v17 + 516) )
          v34 = "true";
        if ( !v36 )
          v34 = "false";
        if ( !*(_BYTE *)(v17 + 517) )
          v35 = "false";
        printf(
          "onClickedPFRule('trigger','%s','trigger','','%s','','','','','%d','%d','%s','%s',%s,'%d','', %s);",
          v17 + 4,
          v29,
          *(_DWORD *)(v29 + 8),
          *(_DWORD *)(v29 + 12),
          v29 + 16,
          &v38,
          v34,
          v5,
          v35);
      }
      else
      {
        v24 = *(_DWORD *)(v17 + 532);
        v25 = *(_DWORD *)(v24 + 8);
        v26 = *(_DWORD *)(v24 + 12);
        v27 = *(_DWORD *)(v24 + 16);
        *(_BYTE *)(v17 + 516);
        v28 = *(_DWORD *)(v24 + 20);
        *(_BYTE *)(v17 + 517);
        printf(
          "onClickedPFRule('user','%s','0','%s','%s','%d','%d','%d','%d','','','','',%s,'%d','%d', %s);",
          v17 + 4,
          v24 + 24);
      }
      printf("\tvar obj = document.getElementById('%s');", v17 + 4);
      v37 = "\tif(obj) obj.scrollIntoView(true);";
      goto LABEL_66;
    }
    if ( !v4 || !strcmp(v4, "all") )
    {
      v37 = "onNewLineClicked();";
LABEL_66:
      printf(v37);
      goto LABEL_67;
    }
    v21 = "onNewLineClicked('%s');";
    v20 = (int)v4;
  }
  printf(v21, v20);
LABEL_67:
  printf("parent.document.portforward_fm.rule_count.value = %d;", v44);
  printf("onLoadCompleted(parent.document);");
  printf("</SCRIPT>");
  printf("</BODY>");
  result = free_portforward_list(&v42);
  return result;
}
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 11DBC: using guessed type int __fastcall portforward_read_db(_DWORD, _DWORD);
// 11E94: using guessed type int __fastcall free_portforward_list(_DWORD);

//----- (00036E3C) --------------------------------------------------------
int __fastcall print_iframe_upnp_portforward(int a1, const char *a2)
{
  int v2; // r4@1
  const char *v3; // r6@1
  const char *v4; // r4@1
  int v5; // r5@6
  int j; // r6@6
  int v7; // r6@9
  int v8; // r7@9
  int result; // r0@15
  int v10; // r5@15
  int i; // r6@16
  int v12; // r6@19
  int v13; // r7@19
  char s; // [sp+4h] [bp-44h]@2
  char v15; // [sp+23h] [bp-25h]@3
  int v16; // [sp+24h] [bp-24h]@1
  int v17; // [sp+28h] [bp-20h]@1
  int v18; // [sp+2Ch] [bp-1Ch]@1

  v2 = a1;
  v3 = a2;
  v18 = 0;
  v16 = 0;
  v17 = 0;
  print_js_file((int)"natrouterconf", (int)"portforward");
  sub_33418();
  v4 = (const char *)get_parameter_value(v2, "mode");
  if ( !v4 )
  {
    memset(&s, 0, 0x20u);
    if ( sub_34390(v3, "view_mode", (int)&s, 32) )
    {
      v15 = (char)v4;
      v4 = &s;
    }
  }
  printf("<BODY style=\"padding:0px 0px 0px 0px; margin:0px 0px 0px 0px;\">");
  printf("<form method=post action=\"timepro.cgi\" name=\"upnp_portforward_fm\" style=\"margin:0px 0px 0px 0px; padding:0px 0px 0px 0px;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"upnp_portforward\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  printf("<input type=hidden name=\"view_mode\" value=\"%s\">");
  printf("<input type=hidden name=\"mode\" value=\"\">");
  printf("<input type=hidden name=\"priority\" value=\"\">");
  printf("<input type=hidden name=\"old_priority\" value=\"\">");
  printf("<table style=\"table-layout:fixed; border-collapse:collapse; border-style:none none none none; width:100%%;\">\n");
  printf("<COL WIDTH=\"45\"><COL WIDTH=\"100\"><COL WIDTH=\"140\"><COL WIDTH=\"140\"><COL WIDTH=\"120\"><COL WIDTH=\"%%\">\n");
  sub_34F6C(v3);
  if ( v4 && strcmp(v4, "upnp") )
  {
    result = strcmp(v4, "all");
    v10 = result;
    if ( result )
      return result;
    portforward_read_db("upnp_pf", &v16);
    for ( i = v16; i && !*(_DWORD *)(i + 528); i = *(_DWORD *)i )
      sub_33A44(i, ++v10);
    v12 = 0;
    v13 = 6 - v10;
    while ( v12 < v13 )
    {
      ++v10;
      ++v12;
      sub_33320();
    }
  }
  else
  {
    portforward_read_db("upnp_pf", &v16);
    v5 = 0;
    for ( j = v16; j && !*(_DWORD *)(j + 528); j = *(_DWORD *)j )
      sub_33A44(j, ++v5);
    v7 = 0;
    v8 = 16 - v5;
    while ( v7 < v8 )
    {
      ++v5;
      ++v7;
      sub_33320();
    }
  }
  printf((const char *)&unk_97FC6);
  puts("<SCRIPT language=\"javascript\">");
  puts((const char *)&unk_98524);
  if ( v4 )
  {
    if ( !strcmp(v4, "upnp") )
      printf("onClickedPFRule('upnp','','','','','','','','','','','','','','','');");
  }
  printf("</SCRIPT>");
  printf("</BODY>");
  return free_portforward_list(&v16);
}
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 11DBC: using guessed type int __fastcall portforward_read_db(_DWORD, _DWORD);
// 11E94: using guessed type int __fastcall free_portforward_list(_DWORD);

//----- (00037100) --------------------------------------------------------
int __fastcall print_iframe_tirgger_portforward(int a1)
{
  int v1; // r5@1
  int v2; // r6@1
  int i; // r4@1
  int v4; // r6@7
  int v6; // [sp+0h] [bp-20h]@1
  int v7; // [sp+4h] [bp-1Ch]@1
  int v8; // [sp+8h] [bp-18h]@1
  int v9; // [sp+Ch] [bp-14h]@1

  v6 = a1;
  v1 = 0;
  v2 = 0;
  v9 = 0;
  v7 = 0;
  v8 = 0;
  print_js_file((int)"natrouterconf", (int)"portforward");
  sub_33418();
  printf("<BODY style=\"padding:0px 0px 0px 0px; margin:0px 0px 0px 0px;\">");
  printf("<form method=post action=\"timepro.cgi\" name=\"trigger_portforward_fm\" style=\"margin:0px 0px 0px 0px; padding:0px 0px 0px 0px;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"trigger_portforward\">");
  printf("<table style=\"table-layout:fixed; border-collapse:collapse; border-style:none none none none; width:100%%;\">\n");
  printf("<COL WIDTH=\"45\"><COL WIDTH=\"100\"><COL WIDTH=\"140\"><COL WIDTH=\"140\"><COL WIDTH=\"120\"><COL WIDTH=\"%%\">\n");
  portforward_read_db("user_pf", &v7);
  for ( i = v7; i; i = *(_DWORD *)i )
  {
    if ( *(_DWORD *)(i + 528) == 1 && *(_BYTE *)(*(_DWORD *)(i + 536) + 64) )
    {
      ++v1;
      ++v2;
      sub_336F4(i, v1);
    }
  }
  v4 = 16 - v2;
  while ( i < v4 )
  {
    ++v1;
    ++i;
    sub_33320();
  }
  printf((const char *)&unk_97FC6);
  puts("<SCRIPT language=\"javascript\">");
  puts((const char *)&unk_98524);
  printf("onClickedPFRule('trigger_status','','','','','','','','','','','','','','','');");
  printf("</SCRIPT>");
  printf("</BODY>");
  free_portforward_list(&v7);
  return v6;
}
// 11DBC: using guessed type int __fastcall portforward_read_db(_DWORD, _DWORD);
// 11E94: using guessed type int __fastcall free_portforward_list(_DWORD);

//----- (00037240) --------------------------------------------------------
FILE *__fastcall preferenceReset(int a1, int a2)
{
  FILE *result; // r0@1
  FILE *v3; // r4@1
  char v4; // [sp+8h] [bp-90h]@1
  void *ptr; // [sp+88h] [bp-10h]@1
  size_t n; // [sp+8Ch] [bp-Ch]@1

  n = 0;
  get_value_post_multipart_file(a2, "pf_restore_file", &ptr, &v4);
  result = fopen("/tmp/user_pf.set.tmp", "w+");
  v3 = result;
  if ( !result )
    return result;
  fwrite(ptr, 1u, n, result);
  result = (FILE *)fclose(v3);
  return result;
}
// 11018: using guessed type int __fastcall get_value_post_multipart_file(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (000372B8) --------------------------------------------------------
signed int __fastcall natrouterconf_portforward(int a1)
{
  int v1; // r4@1
  signed int result; // r0@1

  v1 = a1;
  result = print_natoff_warning();
  if ( !result )
    result = sub_35030(v1);
  return result;
}

//----- (000372D8) --------------------------------------------------------
signed int __fastcall sub_372D8(const char *a1, int a2)
{
  int v2; // r4@1
  int v3; // r0@1
  unsigned int v4; // r3@1
  int i; // r2@1
  char *v6; // r3@4
  signed int result; // r0@5

  v2 = a2;
  v3 = atoi(a1);
  v4 = 0;
  for ( i = 0; i < v3; ++i )
    v4 |= 0x80000000 >> i;
  v6 = inet_ntoa((struct in_addr)__rev(v4));
  if ( v6 )
  {
    sf_strncpy(v2, v6, 20);
    result = 0;
  }
  else
  {
    result = -1;
  }
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);

//----- (00037334) --------------------------------------------------------
signed int __fastcall sub_37334(int a1)
{
  int v1; // r4@1
  signed int v2; // r5@2
  int *v3; // r7@6
  int v4; // r5@6
  int v5; // r0@19
  char s; // [sp+8h] [bp-2AF8h]@3
  signed int v8; // [sp+Ch] [bp-2AF4h]@16
  int v9; // [sp+28ACh] [bp-254h]@6
  int v10; // [sp+28B0h] [bp-250h]@6
  char v11; // [sp+2A40h] [bp-C0h]@3
  int v12; // [sp+2A44h] [bp-BCh]@14
  int v13; // [sp+2A4Ch] [bp-B4h]@14
  int v14; // [sp+2A60h] [bp-A0h]@14
  int v15; // [sp+2A74h] [bp-8Ch]@16
  int v16; // [sp+2AA8h] [bp-58h]@7
  int v17; // [sp+2AC8h] [bp-38h]@1

  v1 = a1;
  if ( !get_value_post(a1, "act", &v17, 32) )
    return 0;
  memset(&s, 0, 0x68u);
  memset(&v11, 0, 0x68u);
  read_rt_db(&s);
  if ( !strcmp((const char *)&v17, "delete") || !strcmp((const char *)&v17, "modify") )
  {
    memset(&v10, 0, 0x190u);
    v3 = &v9;
    v4 = 0;
    while ( get_value_array_post(v1, "delchk") )
    {
      ++v4;
      v3[1] = atoi((const char *)&v16);
      ++v3;
    }
    delete_rt_entry_list(&s, &v10, v4);
    v2 = 2;
  }
  else
  {
    v2 = 1;
  }
  if ( !strcmp((const char *)&v17, "add") || !strcmp((const char *)&v17, "modify") )
  {
    get_value_post(v1, "rtselect", &v17, 32);
    if ( check_unpermitted_chars(&v17) )
      return 0;
    sf_strncpy(&v12, &v17, 8);
    get_ip_value_post(v1, "targetip", &v13);
    strcpy((char *)&v14, "");
    if ( get_value_post(v1, "netmask", &v17, 32) )
      sub_372D8((const char *)&v17, (int)&v14);
    strcpy((char *)&v15, "");
    get_ip_value_post(v1, "gw", &v15);
    if ( v8 <= 99 )
      add_rt_entry(&s);
    v2 = 3;
  }
  v5 = write_rt_db(&s);
  signal_save(v5);
  return v2;
}
// 103DC: using guessed type int __fastcall read_rt_db(_DWORD);
// 1043C: using guessed type int __fastcall delete_rt_entry_list(_DWORD, _DWORD, _DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10D90: using guessed type int __cdecl add_rt_entry(_DWORD);
// 11000: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11A8C: using guessed type int __fastcall get_value_array_post(_DWORD, _DWORD);
// 11CF0: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// 11D74: using guessed type int __fastcall write_rt_db(_DWORD);

//----- (00037584) --------------------------------------------------------
int __fastcall print_iframe_natrouterconf_router_status(int a1, int a2)
{
  signed int v2; // r7@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r1@1
  int v8; // r0@1
  int v9; // r1@1
  int v10; // r0@1
  int v11; // r1@1
  int v12; // r0@1
  void *v13; // r4@1
  int v14; // r1@1
  int v15; // r0@1
  void *v16; // r1@1
  int v17; // r4@1
  int v18; // r9@2
  int v19; // r1@2
  int v20; // r0@3
  const char *v21; // r0@5
  int v22; // r5@7
  const char *v23; // r1@8
  void *v24; // r0@10
  int v25; // r1@10
  int v26; // r0@10
  const char *v27; // r1@12
  const char *v28; // r0@19
  int v30; // [sp+0h] [bp-29D0h]@1
  int v31; // [sp+4h] [bp-29CCh]@6
  int v32; // [sp+28A8h] [bp-128h]@5

  v2 = sub_37334(a2);
  memset(&v30, 0, 0x68u);
  read_rt_db(&v30);
  print_js_file((int)"natrouterconf", (int)"router");
  puts("<form method=post action=\"timepro.cgi\" name=\"router_list_fm\" style='margin: 0;'>");
  puts("<input type=hidden name=\"tmenu\" value='iframe'>");
  puts("<input type=hidden name=\"smenu\" value='natrouterconf_router_status'>");
  puts("<input type=hidden name=\"act\" value=\"delete\">");
  printf("<table id='natrouterconf_list' style='width: 100%%; height: 100%%;' border='0' cellpadding='0' cellspacing='0'>");
  printf("<colgroup><col width=27px><col width=104px><col width=147px><col width=160px><col width=136px></colgroup>");
  printf("<tr class='title'>");
  v4 = get_ux_text_common(935, v3);
  printf("<td style='text-align:center; height:24px;'>%s</td>", v4);
  v6 = get_ux_text_common(1357, v5);
  printf("<td>%s</td>", v6);
  v8 = get_ux_text_common(1314, v7);
  printf("<td>%s</td>", v8);
  v10 = get_ux_text_common(596, v9);
  printf("<td>%s</td>", v10);
  v12 = get_ux_text_common(382, v11);
  printf("<td>%s</td>", v12);
  puts("<td align=right width=68>");
  v13 = get_image_dir();
  v15 = get_ux_text_common(143, v14);
  v16 = v13;
  v17 = 0;
  printf(
    "<span onclick=\"deleteRT();\" style='cursor:pointer;'><img src='/%s/minus_icon.gif' style='margin-bottom:1px;'>%s</span>",
    v16,
    v15);
  puts("<input type=checkbox name=\"allchk\" onclick=\"CheckAllCheckBox(document, this, 'delchk');\" style='margin-right:16px;'>");
  puts("</td>");
  printf("</tr>");
  while ( v17 < v31 )
  {
    v18 = 104 * v17;
    if ( !strcmp((const char *)&v30 + 104 * v17 + 12, "host") )
      v20 = 413;
    else
      v20 = 915;
    v21 = (const char *)get_ux_text_common(v20, v19);
    strcpy((char *)&v32, v21);
    printf("<tr style='background-color:#%s; height:24px; cursor:pointer;' onclick='clickRT(%d);'>");
    printf("<td align=center><span>%d</span></td>", v17 + 1);
    printf("<td><span>%s</span></td>", &v32);
    printf("<td><span>%s</span></td>", (char *)&v30 + v18 + 20);
    printf("<td><span>%s</span></td>", (char *)&v30 + v18 + 40);
    printf("<td><span>%s</span></td>", (char *)&v30 + v18 + 60);
    printf("<td align=right>");
    printf("<input type=checkbox name=\"delchk\" value=\"%d\" style='margin-right:16px;'>", v17++);
    printf("</td>");
    printf("</tr>");
  }
  v22 = v17 + 1;
  if ( v17 & 1 )
    v23 = "f7f7f7";
  else
    v23 = "ffffff";
  printf(
    "<TR id='add_rule_tr' height=24px STYLE=\"background-Color:#%s; cursor: pointer;\" onclick='clearInputValue();'>",
    v23);
  v24 = get_image_dir();
  printf("<TD align=center><span style='padding-left:5px;'><img src='/%s/pf_new_rule.gif'></span></TD>", v24);
  v26 = get_ux_text_common(918, v25);
  printf("<TD colspan=5 align=left style='color:#4789FF;'>%s</TD>", v26);
  printf("</TR>");
  while ( v22 <= 15 )
  {
    if ( v22 & 1 )
      v27 = "f7f7f7";
    else
      v27 = "ffffff";
    ++v22;
    printf("<TR height=24px STYLE=\"background-Color:#%s\">", v27);
    printf("<TD colspan=6></TD></TR>");
  }
  printf("</table>");
  puts("</form>");
  printf("<script>");
  printf("parent.document.getElementById('natrouterconf_list').outerHTML = document.getElementById('natrouterconf_list').outerHTML;");
  if ( v2 == 2 )
  {
    printf("parent.parent.document.getElementsByName('index')[0].value = '';");
LABEL_20:
    printf("parent.window.clearInputValue();");
    v28 = "parent.window.natrouterSetCursor(( parent.document.getElementsByTagName('span').length - 2 ) / 5);";
    goto LABEL_21;
  }
  if ( v2 )
    goto LABEL_20;
  v28 = "highlightAddedTr();";
LABEL_21:
  printf(v28);
  printf("UnMask(parent.parent.document, 'apply_mask');");
  return printf("</script>");
}
// 103DC: using guessed type int __fastcall read_rt_db(_DWORD);

//----- (00037910) --------------------------------------------------------
int print_iframe_natrouterconf_router_list()
{
  print_js_file((int)"natrouterconf", (int)"router");
  printf("<style>");
  printf("body { margin: 0; }");
  printf(".title td { background-color: #EEE; }");
  printf(".selected { background-color: #C9D5E9 !important; }");
  printf("</style>");
  puts("<form method=post action=\"timepro.cgi\" name=\"router_list_fm\" style='margin: 0;'>");
  printf("<table id='natrouterconf_list'>");
  printf("</table>");
  printf("</form>");
  return printf("<iframe name=\"natrouterconf_router_status\" src=\"timepro.cgi?tmenu=iframe&smenu=natrouterconf_router_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (000379A4) --------------------------------------------------------
int __fastcall print_iframe_natrouterconf_router_setup(int a1, int a2)
{
  signed int v2; // r4@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r1@1
  int v9; // r0@1
  int v10; // r0@1
  int v11; // r0@1
  int v12; // r1@1
  int v13; // r0@1
  int v14; // r1@1
  int v15; // r0@1
  int v16; // r1@1
  int v17; // r0@1
  int v18; // r1@1
  int v19; // r0@1
  int v20; // r1@1
  int v21; // r0@1
  int v22; // r0@1
  int v23; // r0@1
  int v24; // r1@1
  const char *v25; // r0@1
  int v26; // r0@1
  const char *v27; // r0@2

  v2 = sub_37334(a2);
  print_js_file((int)"natrouterconf", (int)"router");
  puts("<form method=post action=\"timepro.cgi\" name=\"router_setup_fm\">");
  puts("<input type=hidden name=\"tmenu\" value='iframe'>");
  puts("<input type=hidden name=\"smenu\" value='natrouterconf_router_setup'>");
  puts("<input type=hidden name=\"act\" value=\"\">");
  printf("<input type=hidden name=\"delchk\" value=''>");
  printf("<input type=hidden name=\"rtselect\" value=''>");
  printf("<input type=hidden name=\"netmask\" value=''>");
  printf("<input type=hidden name=\"targetip1\" value=''>");
  printf("<input type=hidden name=\"targetip2\" value=''>");
  printf("<input type=hidden name=\"targetip3\" value=''>");
  printf("<input type=hidden name=\"targetip4\" value=''>");
  printf("<input type=hidden name=\"gw1\" value=''>");
  printf("<input type=hidden name=\"gw2\" value=''>");
  printf("<input type=hidden name=\"gw3\" value=''>");
  printf("<input type=hidden name=\"gw4\" value=''>");
  puts("</form>");
  printf("<table id='setup_table' cellspacing=0px cellpadding=0px style='border-top:1px solid #CCC; width:100%%;'>\n");
  printf("<colgroup><col width='8%%'><col width='25.5%%'><col width='6%%'><col width='8%%'><col width='11%%'><col width='25.5%%'><col width='16%%'></colgroup>");
  printf("<input type=hidden name=\"index\" value=''>");
  v3 = print_blank_line(7, 10);
  str(v3);
  v5 = get_ux_text_common(1357, v4);
  printf("<td>%s</td>", v5);
  puts("<td>");
  puts("<select name=\"rtselect\" onchange=\"rttypeOnchange()\" style='width:70px;'>");
  v7 = get_ux_text_common(916, v6);
  printf("<option value=\"net\">%s\n", v7);
  v9 = get_ux_text_common(414, v8);
  printf("<option value=\"host\">%s\n", v9);
  puts("</select>");
  puts("</td>");
  v10 = puts("<td colspan=5>");
  etr(v10);
  v11 = print_blank_line(7, 5);
  str(v11);
  v13 = get_ux_text_common(1314, v12);
  printf("<td>%s</td>", v13);
  puts("<td>");
  print_html_ip_address((int)"targetip", 0, 1);
  puts("</td>");
  v15 = get_ux_text_common(596, v14);
  printf("<td>%s</td>", v15);
  puts("<td>");
  puts("<input type=text name=\"netmask\" maxlength=2 size=2 style=\"width:30px\">");
  puts("</td>");
  v17 = get_ux_text_common(382, v16);
  printf("<td>%s</td>", v17);
  puts("<td>");
  print_html_ip_address((int)"gw", 0, 1);
  puts("</td>");
  puts("<td  align=left>");
  v19 = get_ux_text_common(6, v18);
  printf("<input type=button name=\"addbt\" value=\"%s\" onclick=\"AddSubmit('add')\">\n", v19);
  v21 = get_ux_text_common(639, v20);
  printf(
    "<input type=button name=\"modifybt\" value=\"%s\" onclick=\"AddSubmit('modify')\" style='display:none;'>\n",
    v21);
  v22 = puts("</td>");
  etr(v22);
  v23 = print_blank_line(7, 15);
  str(v23);
  puts("<td colspan=7 align=left><font color='gray'>");
  v25 = (const char *)get_ux_text_common(598, v24);
  printf(v25, 100);
  v26 = puts("</td>");
  etr(v26);
  print_blank_line(7, 5);
  printf("<tr style='background-color: #CCC; height: 1px;'><td colspan=7></td></tr>");
  puts("</table>");
  printf("<script>");
  if ( v2 )
    v27 = "parent.document.getElementsByName('natrouterconf_router_list')[0].contentWindow.document.getElementsByName('na"
          "trouterconf_router_status')[0].contentWindow.location.href = 'timepro.cgi?tmenu=iframe&smenu=natrouterconf_router_status';";
  else
    v27 = "parent.document.getElementById('setup_table').outerHTML = document.getElementById('setup_table').outerHTML;";
  printf(v27);
  printf("document.getElementById('setup_table').outerHTML = '';");
  printf("UnMask(parent.document, 'apply_mask');");
  return printf("</script>");
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (00037CE4) --------------------------------------------------------
int natrouterconf_router()
{
  int v0; // r0@1
  int v1; // r1@1
  int v2; // r5@1
  void *v3; // r0@1

  printf("<table cellpadding='0px' cellspacing='0px' style='width: 641px;padding: 0;margin: 0;'>");
  printf("<iframe name=\"natrouterconf_router_list\" src=\"timepro.cgi?tmenu=iframe&smenu=natrouterconf_router_list\" frameborder=no style='width:100%%; height:408px;'></iframe>");
  print_js_file((int)"natrouterconf", (int)"router");
  printf("<style>");
  printf("#setup_table tr { background-color: #EEE; }");
  printf("#setup_table td { background-color: inherit; padding-left: 10px; }");
  printf("input[type='text'] { border: 1px solid #CCC; text-align: center; }");
  printf("</style>");
  puts("<tr><td>");
  puts("<form method=post action=\"timepro.cgi\" name=\"router_setup_fm\" style='margin: 0;'>");
  puts("<table id='setup_table' cellspacing=0px cellpadding=0px style='border-top:1px solid #CCC;'>");
  printf("</table>");
  printf("</form>");
  printf("</td></tr>");
  v0 = printf("<iframe name=\"natrouterconf_router_setup\" src=\"timepro.cgi?tmenu=iframe&smenu=natrouterconf_router_setup\" frameborder=no style='display:none;'></iframe>");
  print_end_main_table(v0);
  v2 = get_ux_text_common(34, v1);
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v3 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v3);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:"
    "middle; display:block; text-align:center;\">%s\n",
    v2);
  printf("</SPAN></td>");
  return printf((const char *)&unk_7D215);
}
// 115DC: using guessed type int __fastcall print_end_main_table(_DWORD);

//----- (00037E5C) --------------------------------------------------------
int __fastcall sub_37E5C(int a1, int a2, int a3)
{
  int v3; // r5@1
  int v4; // r4@1
  int v5; // r6@1

  v3 = a3;
  v4 = a1;
  v5 = a2;
  printf(
    "<TR height=20 ID=%s STYLE=\"cursor:pointer; background-color:#%s;\" ONCLICK=\"clickNatrouterconfMiscTr(this);\">",
    a1);
  return printf("<TD></TD><TD>%s</TD><TD CLASS=text_gray ID=%s_value >%s</TD><TD>%s</TD></TR>\n", v5, v4, v3);
}

//----- (00037EBC) --------------------------------------------------------
int __fastcall sub_37EBC(const char *a1, int a2)
{
  int v2; // r5@1
  const char *v3; // r4@1
  void *v4; // r0@3

  v2 = a2;
  v3 = a1;
  if ( !strcmp(a1, "reboot_mask") )
  {
    printf("<style>");
    printf("#%s p { margin: 5px 0 5px 15px; text-align: left; }", v3);
    printf("</style>");
  }
  printf("<DIV id=\"%s\" style=\"display:none;\">", v3);
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v4 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v4);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:"
    "middle; display:block; text-align:center;\">%s\n",
    v2);
  printf("</SPAN></td>");
  return printf((const char *)&unk_7D215);
}

//----- (00037FA4) --------------------------------------------------------
int __fastcall sub_37FA4(int a1)
{
  int v1; // r5@1
  int result; // r0@1
  int v3; // r6@2
  int v4; // r0@3
  int v5; // r10@3
  int v6; // r5@4
  int v7; // r4@7
  int v8; // r0@14
  signed int v9; // r4@14
  const char *v10; // r1@19
  int v11; // r0@21
  int v12; // r0@25
  int v13; // r4@25
  int v14; // r0@27
  int v15; // r8@28
  int v16; // r0@29
  int v17; // r4@29
  bool v18; // zf@29
  const char *v19; // r0@29
  int v20; // r0@32
  int v21; // r6@32
  int v22; // r7@44
  int v23; // r0@46
  const char *v24; // r0@46
  const char *v25; // r0@48
  const char *v26; // r0@52
  int v27; // r0@57
  int v28; // r0@61
  char v29; // [sp+4h] [bp-21Ch]@36
  int v30; // [sp+84h] [bp-19Ch]@3
  char v31; // [sp+88h] [bp-198h]@33
  char v32; // [sp+104h] [bp-11Ch]@1
  char v33; // [sp+184h] [bp-9Ch]@54
  char v34; // [sp+1A4h] [bp-7Ch]@31
  char v35; // [sp+1C4h] [bp-5Ch]@8
  char s[24]; // [sp+1E4h] [bp-3Ch]@3
  int v37; // [sp+1FCh] [bp-24h]@23
  int v38; // [sp+200h] [bp-20h]@4

  v1 = a1;
  result = get_value_post(a1, "act", &v32, 128);
  if ( !result )
    return result;
  v3 = strcmp(&v32, "addftpport");
  if ( !v3 )
  {
    memset(s, 0, 0x18u);
    v4 = get_value_post(v1, "ftp_port", &v30, 128);
    v5 = v4;
    if ( v4 )
    {
      v6 = read_ftp_private_port(s, 6);
      *(&v38 + v6 - 7) = atoi((const char *)&v30);
      v4 = write_ftp_private_port(s, 6);
LABEL_59:
      v5 = v3;
      goto LABEL_61;
    }
    goto LABEL_61;
  }
  if ( !strcmp(&v32, "delftpport") )
  {
    v4 = read_ftp_private_port(s, 6);
    v5 = v4;
    if ( !v4 )
      goto LABEL_61;
    v7 = 0;
    do
    {
      snprintf(&v35, 0x20u, "port%d_ch", v7);
      if ( get_value_post(v1, &v35, &v30, 32) && !strcmp((const char *)&v30, "checked") )
        *(_DWORD *)&s[4 * v7] = 0;
      ++v7;
    }
    while ( v7 != 6 );
    v4 = write_ftp_private_port(s, 6);
LABEL_60:
    v5 = 0;
    goto LABEL_61;
  }
  if ( !strcmp(&v32, "natonoff") )
  {
    get_value_post(v1, "nat_run", &v32, 128);
    v8 = atoi(&v32);
    v9 = v8;
    if ( v8 )
      v9 = 1;
    if ( !v9 && sysconf_nat_get(v8 + 1) || (v4 = sysconf_nat_get(1)) == 0 )
    {
      sysconf_nat_set(v9, 0);
      v10 = "@{77}";
      if ( v9 )
        v10 = "@{78}";
      v11 = syslog_msg(1, v10);
      v4 = saveconf(v11);
    }
    goto LABEL_58;
  }
  v5 = strcmp(&v32, "pppoe");
  if ( !v5 )
  {
    get_value_post(v1, "pppoe_relay", &v32, 128);
    v37 = atoi(&v32) != 0;
    v4 = set_pppoe_relay_enabled();
    goto LABEL_61;
  }
  v5 = strcmp(&v32, "upnp_relay");
  if ( v5 )
  {
    v4 = strcmp(&v32, "dmztwinip");
    v15 = v4;
    if ( v4 )
      goto LABEL_60;
    get_value_post(v1, "wanid", &v35, 32);
    v16 = atoi(&v35);
    v17 = v16;
    v18 = v16 == 1;
    v19 = "wan2";
    if ( v18 )
      v19 = "wan1";
    dmztwinip_read_config(v19, &v30);
    snprintf(&v34, 0x20u, "w%dmode", v17);
    v4 = get_value_post(v1, &v34, &v35, 32);
    if ( !v4 )
    {
LABEL_58:
      v5 = 1;
      goto LABEL_61;
    }
    v20 = atoi(&v35);
    v21 = v20;
    if ( v30 == 2 )
    {
      v5 = 1;
      dhcpd_remove_static_lease(v15, &v31);
      dhcpd_remove_dynamic_lease(v15, &v31);
    }
    else
    {
      if ( v20 == 2 )
      {
        snprintf(&v29, 0x80u, "w%dhw", v17);
        v5 = 1;
        get_hw_value_post(v1, &v29, s);
        dhcpd_remove_static_lease(0, s);
        dhcpd_remove_dynamic_lease(0, s);
        goto LABEL_44;
      }
      v5 = 0;
    }
    if ( v21 == 1 )
    {
      if ( v30 == 2 )
      {
        dmztwinip_apply_off(v17, &v30);
        write_file("/proc/driver/twinip", "0");
      }
      snprintf(&v29, 0x80u, "w%dip", v17);
      get_ip_value_post(v1, &v29, &v35);
      dmztwinip_apply_dmz(v17, &v35, &v30);
      goto LABEL_47;
    }
    if ( v21 != 2 )
    {
      if ( !v21 )
      {
        dmztwinip_apply_off(v17, &v30);
        write_file("/proc/driver/twinip", "0");
      }
LABEL_47:
      v30 = v21;
      if ( v17 == 1 )
        v25 = "wan1";
      else
        v25 = "wan2";
      v4 = dmztwinip_write_config(v25, &v30);
      if ( v30 == 2 )
      {
        dhcpd_remove_static_lease(0, &v31);
        dhcpd_remove_dynamic_lease(0, &v31);
        if ( v17 == 1 )
          v26 = "wan1";
        else
          v26 = "wan2";
        v4 = get_wan_ip(v26, &v33);
        if ( v4 )
          v4 = dhcpd_add_static_lease(&v33, &v31);
      }
      else if ( !v5 )
      {
        goto LABEL_61;
      }
      v27 = dhcpd_stop(v4);
      v4 = dhcpd_start(v27);
      goto LABEL_60;
    }
LABEL_44:
    snprintf(&v29, 0x80u, "w%dhw", v17);
    get_hw_value_post(v1, &v29, s);
    snprintf(&v29, 0x80u, (const char *)&unk_99CD9, v17);
    get_value_post(v1, &v29, &v35, 32);
    v22 = atoi(&v35);
    if ( v30 == 1 )
      dmztwinip_apply_off(v17, &v30);
    v23 = get_twinip_wan_virtual_ip((int)"wan1");
    snprintf(&v29, 0x80u, "1 %s ", v23);
    v24 = (const char *)get_twinip_wan_virtual_ip((int)"wan2");
    strcat(&v29, v24);
    write_file("/proc/driver/twinip", &v29);
    dmztwinip_apply_twinip(v17, s, v22, &v30);
    goto LABEL_47;
  }
  v12 = get_intvalue_post(v1, (int)"upnp_relay", (int)&v37);
  v13 = v37;
  v4 = get_upnp_relay(v12);
  if ( v13 != v4 )
  {
    v4 = set_upnp_relay(v37);
    v3 = v37;
    if ( !v37 )
      goto LABEL_59;
    discover_upper_upnp_igd(v4);
    v14 = portforward_upnp_relay_init("user_pf");
    v4 = nas_service_upnp_relay_init(v14);
  }
LABEL_61:
  v28 = signal_update(v4);
  signal_save(v28);
  if ( v5 )
    signal_reboot(3);
  return 1;
}
// 1049C: using guessed type int __fastcall dmztwinip_write_config(_DWORD, _DWORD);
// 105BC: using guessed type int __fastcall dmztwinip_apply_dmz(_DWORD, _DWORD, _DWORD);
// 1079C: using guessed type int __fastcall dmztwinip_read_config(_DWORD, _DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10B68: using guessed type int __fastcall sysconf_nat_set(_DWORD, _DWORD);
// 10C34: using guessed type int __fastcall dhcpd_remove_static_lease(_DWORD, _DWORD);
// 10F88: using guessed type int set_pppoe_relay_enabled(void);
// 10FF4: using guessed type int __fastcall saveconf(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 1124C: using guessed type int __fastcall set_upnp_relay(_DWORD);
// 112E8: using guessed type int __fastcall read_ftp_private_port(_DWORD, _DWORD);
// 11348: using guessed type int __fastcall discover_upper_upnp_igd(_DWORD);
// 113C0: using guessed type int __fastcall get_upnp_relay(_DWORD);
// 113CC: using guessed type int syslog_msg(_DWORD, const char *, ...);
// 11414: using guessed type int __fastcall sysconf_nat_get(_DWORD);
// 11564: using guessed type int __fastcall write_ftp_private_port(_DWORD, _DWORD);
// 11630: using guessed type int __fastcall dmztwinip_apply_off(_DWORD, _DWORD);
// 11678: using guessed type int __fastcall signal_reboot(_DWORD);
// 11690: using guessed type int __fastcall nas_service_upnp_relay_init(_DWORD);
// 11858: using guessed type int __fastcall get_hw_value_post(_DWORD, _DWORD, _DWORD);
// 1187C: using guessed type int __fastcall dhcpd_add_static_lease(_DWORD, _DWORD);
// 11930: using guessed type int __fastcall dhcpd_stop(_DWORD);
// 119B4: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);
// 11CF0: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// 11E58: using guessed type int __fastcall dmztwinip_apply_twinip(_DWORD, _DWORD, _DWORD, _DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);
// 11F54: using guessed type int __fastcall dhcpd_remove_dynamic_lease(_DWORD, _DWORD);
// 11F84: using guessed type int __fastcall write_file(_DWORD, _DWORD);
// 12098: using guessed type int __fastcall portforward_upnp_relay_init(_DWORD);
// 37FA4: using guessed type char s[24];

//----- (000385B0) --------------------------------------------------------
int sub_385B0()
{
  char *v0; // r0@1
  char *v1; // r5@1
  int v2; // r0@1
  int v3; // r1@1
  char *v4; // r4@2
  int v5; // r0@4
  int v6; // r0@4
  int v7; // r1@4
  char *v8; // r8@5
  int v9; // r0@7
  int v10; // r0@7
  int v11; // r1@7
  int v12; // r0@9
  int v13; // r0@9
  int v14; // r1@9
  int v15; // r0@9
  char *v16; // r0@10
  char *v17; // r1@10
  int v18; // r2@10
  int v19; // r0@12
  int v20; // r0@12
  int v21; // r1@13
  const char *v22; // r0@13
  int v23; // r0@14
  int v24; // r1@14
  int v25; // r0@14
  char *v26; // r0@14
  const char *v27; // r1@14
  int v28; // r2@18
  int v29; // r1@20
  int v30; // r0@20
  int v31; // r0@20
  int v32; // r1@20
  int v33; // r0@20
  int v34; // r1@20
  int v35; // r0@22
  const char *v36; // r0@23
  signed int v38; // [sp+0h] [bp-230h]@9
  char v39; // [sp+14h] [bp-21Ch]@9
  char v40; // [sp+114h] [bp-11Ch]@12
  int v41; // [sp+194h] [bp-9Ch]@1
  char v42; // [sp+198h] [bp-98h]@19
  int v43; // [sp+1ACh] [bp-84h]@10
  char v44; // [sp+1C0h] [bp-70h]@11
  char v45; // [sp+1D4h] [bp-5Ch]@11
  char dest[4]; // [sp+1E8h] [bp-48h]@1
  char s; // [sp+1ECh] [bp-44h]@1
  char v48; // [sp+1FCh] [bp-34h]@1
  int v49; // [sp+210h] [bp-20h]@1
  int v50; // [sp+214h] [bp-1Ch]@1

  v49 = 0;
  v50 = 0;
  *(_DWORD *)dest = 0;
  memset(&s, 0, 0x10u);
  v0 = getenv("REMOTE_ADDR");
  v1 = "checked";
  get_internal_pc_hardware_address(v0, &v48);
  v2 = dmztwinip_read_config("wan1", &v41);
  str(v2);
  puts("<td colspan=3>");
  printf("<input type=hidden name=opmode value=%d>", v41);
  if ( v41 )
    v4 = "";
  else
    v4 = "checked";
  v5 = get_ux_text_common(926, v3);
  v6 = printf(
         "<input type=radio id='w%dmode_off' name=\"w%dmode\" value=0 onclick='select_twinipdmz(this.value,%d)' %s><label"
         " for='w%dmode_off'><span class=\"bold_item_text\">%s</span></label>",
         1,
         1,
         1,
         v4,
         1,
         v5);
  br(v6);
  if ( v41 == 1 )
    v8 = "checked";
  else
    v8 = "";
  v9 = get_ux_text_common(149, v7);
  v10 = printf(
          "<input type=radio id='w%dmode_dmz' name=\"w%dmode\" value=1 onclick='select_twinipdmz(this.value,%d)' %s><labe"
          "l for='w%dmode_dmz'><span class=\"bold_item_text\">DMZ</span> (%s)</label>",
          1,
          1,
          1,
          v8,
          1,
          v9);
  br(v10);
  if ( v41 != 2 )
    v1 = "";
  v12 = get_ux_text_common(1354, v11);
  printf((const char *)&unk_99E79, 1, 1, 1, v1, 1, v12);
  v13 = puts("</td>");
  etr(v13);
  print_blank_line(2, 5);
  printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=2></td></tr>");
  printf("<tr id=\"w%dipaddr\" style='display:%s; height:30px;'>\n", 1);
  v15 = get_ux_text_common(428, v14);
  printf("<td style='padding-left:9px;'>%s</td>", v15);
  puts("<td >");
  snprintf(&v39, 0x100u, "w%dip", 1);
  if ( v41 == 1 )
  {
    v16 = &v39;
    v17 = (char *)&v43;
    v18 = 2;
  }
  else
  {
    get_ifconfig((int)"br0", (int)&v45, (int)&v44);
    v16 = &v39;
    v17 = &v45;
    v18 = 3;
  }
  v19 = print_html_ip_address((int)v16, v17, v18);
  v20 = get_remote_addr(v19);
  snprintf(&v40, 0x80u, "%s", v20);
  print_nbsp(1);
  if ( strcmp(&v40, "Twin IP") )
  {
    v38 = 1;
    printf("<input type=checkbox id=ip_checkbox%d name='re_ip' onclick=\"OnCheckEnableIP(this, '%s', '%s')\"><label for='ip_checkbox%d'>");
    v22 = (const char *)get_ux_text_common(426, v21);
    printf(v22, &v40);
    printf("</label>");
  }
  v23 = puts("</td>");
  etr(v23);
  printf("<tr id=\"w%dhwaddr\" style='display:%s; height:30px;'>\n", 1);
  v25 = get_ux_text_common(591, v24);
  printf("<td style='padding-left:10px;'>%s</td>", v25);
  puts("<td align=left>");
  v26 = (char *)snprintf(&v39, 0x100u, "w%dhw", 1, v38);
  if ( v41 == 2 )
    v26 = &v39;
  else
    v27 = 0;
  if ( v41 == 2 )
  {
    v27 = &v42;
    v28 = 0;
  }
  else
  {
    v26 = &v39;
    v28 = (int)v27;
  }
  print_hwadress_inputbox((int)v26, v27, v28);
  print_nbsp(3);
  snprintf(&v39, 0x100u, (const char *)&unk_9A072, 1);
  printf(
    "<button type='button' name='macbutton_dynamic' style='width: 20px; height: 20px; vertical-align: top; position: rela"
    "tive;' onclick='popup_search_mac(\"%s\");'>",
    &v39);
  printf("<img src='/images2/fw_search.gif' style='width:16px; height:16px; position: absolute; left: 0; top: 0;'></button>");
  print_nbsp(1);
  convert_mac(&v48);
  printf("<input type=checkbox id='mac_checkbox%d' name=\"get_w%dhosthw\" onclick='get_hwaddr(this,%d,\"%s\")'>\n");
  v30 = get_ux_text_common(383, v29);
  printf("<label for='mac_checkbox%d'>%s</label>", 1, v30);
  v31 = puts("</td>");
  etr(v31);
  printf("<tr id=\"w%dlease_time\" style='display:%s; height:30px; '>\n", 1);
  v33 = get_ux_text_common(1355, v32);
  printf("<td style='padding-left:10px;'>%s</td>", v33);
  puts("<td colspan=7 align=left>");
  read_real_ipclone_leasetime("wan1", &v49);
  if ( !v49 )
    v49 = 60;
  get_ux_text_common(1083, v34);
  printf("<input type=text name=\"w%dleasetime\" id=\"w%dleasetime\"size=5 maxlength=5 value=\"%d\" style='width:50px;'> %s\n");
  v35 = puts("</td>");
  etr(v35);
  if ( dest[0] )
    return printf("<script>select_twinipdmz(%d,%d); </script>", v41, 1);
  v36 = (const char *)get_twinip_wan_virtual_ip((int)"wan1");
  strcpy(dest, v36);
  return printf("<script>select_twinipdmz(%d,%d); </script>", v41, 1);
}
// 104CC: using guessed type int __fastcall get_remote_addr(_DWORD);
// 1079C: using guessed type int __fastcall dmztwinip_read_config(_DWORD, _DWORD);
// 108F8: using guessed type int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 11264: using guessed type int __fastcall read_real_ipclone_leasetime(_DWORD, _DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (00038A30) --------------------------------------------------------
int __fastcall print_iframe_natrouterconf_misc_select(int a1)
{
  int v1; // r4@1
  int result; // r0@1
  int v3; // r4@3
  int v4; // r9@3
  int v5; // r0@3
  int v6; // r0@3
  int v7; // r1@3
  int v8; // r0@3
  int v9; // r1@3
  int v10; // r0@3
  int v11; // r0@3
  int v12; // r0@3
  int *v13; // r6@5
  signed int v14; // r7@5
  int v15; // t1@6
  signed int v16; // r3@6
  int v17; // r0@7
  int v18; // r1@11
  int v19; // r0@11
  int v20; // r0@11
  int v21; // [sp+14h] [bp-BC8Ch]@3
  char v22[48096]; // [sp+20h] [bp-BC80h]@3
  int v23; // [sp+BC20h] [bp-80h]@1
  int v24; // [sp+BC3Ch] [bp-64h]@5
  int v25; // [sp+BC40h] [bp-60h]@5
  int v26; // [sp+BC44h] [bp-5Ch]@5
  int v27; // [sp+BC48h] [bp-58h]@5
  int v28; // [sp+BC4Ch] [bp-54h]@5
  int v29; // [sp+BC50h] [bp-50h]@5
  int v30; // [sp+BC54h] [bp-4Ch]@5
  int v31; // [sp+BC58h] [bp-48h]@5
  int v32; // [sp+BC5Ch] [bp-44h]@5
  int v33; // [sp+BC60h] [bp-40h]@5
  int v34; // [sp+BC64h] [bp-3Ch]@5
  int v35; // [sp+BC68h] [bp-38h]@2

  v1 = a1;
  result = get_value(a1, "formname", &v23, 32);
  if ( !result )
    return result;
  result = get_value(v1, "macprefix", &v35, 16);
  if ( !result )
    return result;
  print_js_file((int)"natrouterconf", (int)"misc");
  printf("<style>");
  v3 = 0;
  printf("body { margin: 0; padding: 0; }");
  v4 = 0;
  printf("tr { border: 1px solid #CCC; }");
  printf(".selected { background-color: #E8E8E8 !important; }");
  printf("</style>");
  memset(v22, 0, 0xBC00u);
  v5 = get_hostinfo_from_arp("br0", 256, v22);
  v21 = v5;
  v6 = print_start_content_table(v5);
  str(v6);
  v8 = get_ux_text_common(985, v7);
  printf(
    "<td style='text-align:center; padding: 4px 0 3px 0; background-color:#EEE; width: 170px; border-right: 1px solid #CCC;'>%s</td>",
    v8);
  v10 = get_ux_text_common(984, v9);
  v11 = printf("<td style='text-align:center; background-color: #EEE;'>%s</td>", v10);
  v12 = etr(v11);
  while ( v3 < v21 )
  {
    v12 = strcmp(&v22[188 * v3 + 148], "00:00:00:00:00:00");
    if ( v12 )
    {
      convert_mac(&v22[188 * v3 + 148]);
      printf(
        "<tr onmouseover='trMouseOverEvent(this);' onmouseout='trMouseOutEvent(this);' onclick='SelectMacFromPopup_%d(); "
        "UnMaskIt(parent.document, \"search_popup\");'>",
        v3);
      printf("<td style='padding: 5px 10px 4px 10px; border-right: 1px solid #CCC;'>");
      v13 = &v24;
      printf("<script>");
      sscanf(&v22[188 * v3 + 148], "%02X-%02X-%02X-%02X-%02X-%02X", &v25, &v26, &v27, &v28, &v29, &v30);
      v14 = 1;
      sscanf(&v22[188 * v3 + 128], "%03d.%03d.%03d.%03d", &v31, &v32, &v33, &v34);
      printf("function SelectMacFromPopup_%d() {", v3);
      do
      {
        v15 = v13[1];
        ++v13;
        v16 = v14++;
        printf("parent.document.%s.%s%d.value = '%02X';", &v23, &v35, v16, v15);
      }
      while ( v14 != 7 );
      ++v4;
      putchar(125);
      printf("</script>");
      printf("<span>%s</span></td>", &v22[188 * v3 + 148]);
      v17 = printf("<td style='padding-left: 10px;'>%s</td>", &v22[188 * v3 + 128]);
      v12 = etr(v17);
    }
    ++v3;
  }
  if ( !v4 )
  {
    str(v12);
    printf("<td colspan=2>");
    v19 = get_ux_text_common(986, v18);
    v20 = printf("%s", v19);
    v12 = etr(v20);
  }
  print_end_content_table(v12);
  result = printf("</table>");
  return result;
}
// 107B4: using guessed type int __fastcall get_hostinfo_from_arp(_DWORD, _DWORD, _DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 11954: using guessed type int __fastcall print_start_content_table(_DWORD);
// 11D98: using guessed type int __fastcall print_end_content_table(_DWORD);
// 38A30: using guessed type char var_BC80[48096];

//----- (00038D24) --------------------------------------------------------
int __fastcall sub_38D24(const char *a1)
{
  const char *v1; // r5@1
  int result; // r0@2
  int v3; // r4@3
  int *v4; // r5@4
  int v5; // r0@4
  int v6; // r0@4
  int v7; // r1@4
  int v8; // r0@4
  int v9; // r1@4
  const char *v10; // r0@4
  int v11; // r1@4
  int v12; // r0@4
  int v13; // r0@4
  int v14; // r0@4
  int v15; // t1@5
  int v16; // r1@9
  int v17; // r0@9
  int v18; // r0@9
  char *v19; // r4@11
  int v20; // r0@11
  int v21; // r1@11
  int v22; // r0@11
  int v23; // r1@11
  char *v24; // r6@12
  int v25; // r0@14
  int v26; // r1@14
  int v27; // r0@16
  int v28; // r0@16
  int v29; // r0@16
  int v30; // r1@16
  const char *v31; // r0@16
  int v32; // r1@16
  int v33; // r0@16
  char *v34; // r4@20
  int v35; // r0@20
  int v36; // r1@20
  int v37; // r0@20
  int v38; // r0@20
  int v39; // r1@20
  char *v40; // r6@21
  int v41; // r0@23
  int v42; // r0@23
  int v43; // r1@23
  int v44; // r0@25
  int v45; // r0@25
  int v46; // r0@25
  int v47; // r1@25
  const char *v48; // r0@25
  char *v49; // r4@27
  int v50; // r0@27
  int v51; // r1@27
  int v52; // r0@27
  int v53; // r0@27
  int v54; // r1@27
  char *v55; // r6@28
  int v56; // r0@30
  int v57; // r0@30
  int v58; // r1@30
  int v59; // r0@32
  int v60; // r0@32
  int v61; // [sp+0h] [bp-28h]@4

  v1 = a1;
  if ( !strcmp(a1, "dmztwinip1") )
  {
    printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=2></td></tr>");
    print_blank_line(2, 2);
    return sub_385B0();
  }
  v3 = strcmp(v1, "ftp");
  if ( !v3 )
  {
    v4 = &v61;
    printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=8></td></tr>");
    print_blank_line(8, 4);
    memset(&v61, 0, 0x18u);
    v5 = read_ftp_private_port(&v61, 6);
    v6 = printf("<input type=hidden name=\"ftp_port_count\" value=\"%d\">\n", v5);
    str(v6);
    v8 = get_ux_text_common(705, v7);
    printf("<td rowspan=2 style='padding-left:9px;'>%s</td>", v8);
    puts("<td colspan=5>");
    v10 = (const char *)get_ux_text_common(992, v9);
    printf(v10);
    print_nbsp(3);
    puts("<input type=text name=\"ftp_port\" maxlength=5 size=5 value=\"\">");
    puts("</td>");
    printf("<td align=right style='width:10%%; height:25px;'>\n");
    v12 = get_ux_text_common(6, v11);
    printf("<input type=button name=\"ftp_apply\" value=\"%s\" onclick=\"addFtpPort(%d);\">\n", v12, 5);
    puts("</td>");
    v13 = printf("<td></td>");
    v14 = etr(v13);
    str(v14);
    do
    {
      puts("<td width=60>");
      printf("<input type=checkbox id='port%d_ch' name=\"port%d_ch\">", v3, v3);
      printf("<input type=hidden name=\"port%d\" value=\"%d\">", v3, *v4);
      v15 = *v4;
      ++v4;
      if ( v15 )
      {
        printf("<label for='port%d_ch'>", v3);
        printf("%d", *(v4 - 1));
        printf("</label>");
      }
      else
      {
        putchar(45);
      }
      ++v3;
      puts("</td>");
    }
    while ( v3 != 5 );
    puts("<td align=right style='height:25px;'>");
    v17 = get_ux_text_common(143, v16);
    printf("<input type=button name=\"ftp_del\" value=\"%s\" onclick=\"delFtpPort();\">\n", v17);
    puts("</td>");
    v18 = puts("<td></td>");
    return etr(v18);
  }
  if ( !strcmp(v1, "natonoff") )
  {
    printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=2></td></tr>");
    v19 = "";
    v20 = print_blank_line(2, 2);
    str(v20);
    v22 = get_ux_text_common(731, v21);
    printf("<td style='padding-left:9px;'>%s</td>", v22);
    puts("<td colspan=5>");
    if ( sysconf_nat_get(1) )
      v24 = "checked";
    else
      v24 = "";
    v25 = get_ux_text_common(1104, v23);
    printf("<input type=radio id='nat_on' name=\"nat_run\" value=1 %s><label for='nat_on'>%s</label>", v24, v25);
    print_nbsp(10);
    if ( !sysconf_nat_get(1) )
      v19 = "checked";
    v27 = get_ux_text_common(1111, v26);
    printf("<input type=radio id='nat_off' name=\"nat_run\" value=0 %s><label for='nat_off'>%s</label>", v19, v27);
    printf("</td>");
    v28 = printf("<td colspan=2></td>");
    v29 = etr(v28);
    str(v29);
    printf("<td></td>");
    printf((const char *)&unk_9A92C);
    v31 = (const char *)get_ux_text_common(729, v30);
    printf(v31);
    v33 = get_ux_text_common(730, v32);
    printf("%s", v33);
LABEL_17:
    v18 = printf("</span></td>");
    return etr(v18);
  }
  if ( !strcmp(v1, "pppoe") )
  {
    printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=2></td></tr>");
    v34 = "";
    v35 = print_blank_line(2, 2);
    str(v35);
    v37 = get_ux_text_common(999, v36);
    printf("<td style='padding-left:9px;'>%s</td>", v37);
    v38 = puts("<td colspan=7>");
    if ( get_pppoe_relay_enabled(v38) )
      v40 = "checked";
    else
      v40 = "";
    v41 = get_ux_text_common(1104, v39);
    printf("<input type=radio id='pppoe_on' name=\"pppoe_relay\" value=1 %s><label for='pppoe_on'>%s</label>", v40, v41);
    v42 = print_nbsp(10);
    if ( !get_pppoe_relay_enabled(v42) )
      v34 = "checked";
    v44 = get_ux_text_common(1111, v43);
    printf(
      "<input type=radio id='pppoe_off' name=\"pppoe_relay\" value=0 %s><label for='pppoe_off'>%s</label>",
      v34,
      v44);
    v45 = printf("</td>");
    etr(v45);
    v46 = print_blank_line(2, 5);
    str(v46);
    printf("<td></td>");
    printf((const char *)&unk_9A92C);
    v48 = (const char *)get_ux_text_common(998, v47);
    printf(v48);
    goto LABEL_17;
  }
  result = strcmp(v1, "upnp_relay");
  if ( result )
    return result;
  printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=2></td></tr>");
  v49 = "";
  v50 = print_blank_line(2, 2);
  str(v50);
  v52 = get_ux_text_common(1364, v51);
  printf("<td style='padding-left:9px;'>%s</td>", v52);
  v53 = puts("<td colspan=7>");
  if ( get_upnp_relay(v53) )
    v55 = "checked";
  else
    v55 = "";
  v56 = get_ux_text_common(1104, v54);
  printf(
    "<input type=radio id='upnp_relay_on' name=\"upnp_relay\" value=1 %s><label for='upnp_relay_on'>%s</label>",
    v55,
    v56);
  v57 = print_nbsp(10);
  if ( !get_upnp_relay(v57) )
    v49 = "checked";
  v59 = get_ux_text_common(1111, v58);
  printf(
    "<input type=radio id='upnp_relay_off' name=\"upnp_relay\" value=0 %s><label for='upnp_relay_off'>%s</label>",
    v49,
    v59);
  v60 = printf("</td>");
  etr(v60);
  result = print_blank_line(2, 5);
  return result;
}
// 10508: using guessed type int __fastcall get_pppoe_relay_enabled(_DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 112E8: using guessed type int __fastcall read_ftp_private_port(_DWORD, _DWORD);
// 113C0: using guessed type int __fastcall get_upnp_relay(_DWORD);
// 11414: using guessed type int __fastcall sysconf_nat_get(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (0003920C) --------------------------------------------------------
int __fastcall sub_3920C(const char *a1, int a2)
{
  const char *v2; // r4@1
  int v3; // r5@1

  v2 = a1;
  v3 = a2;
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%% ID=%s_table STYLE=\"display:none;\">", a1);
  printf("<colgroup><col width=25%%></colgroup>");
  printf(
    "<tr><td height=20 valign=center style=\"padding:3px;width:180px;\">&nbsp; <b>%s</b></td><td align=right>%s</td></tr>",
    v3);
  sub_38D24(v2);
  return puts((const char *)&unk_7FF8C);
}

//----- (00039274) --------------------------------------------------------
int __fastcall sub_39274(int result, int a2, signed int a3, int a4)
{
  int v4; // r7@1
  int v5; // r5@1
  signed int v6; // r6@1
  signed int v7; // r4@2
  signed int v8; // r4@3
  signed int v9; // r2@4
  signed int v10; // r3@7
  int v11; // [sp+0h] [bp-18h]@1

  v11 = a4;
  v4 = result;
  v5 = a2;
  v6 = a3;
  if ( result )
  {
    v7 = 1;
    while ( v7 <= v6 )
    {
      v10 = v7++;
      result = printf("<input type='hidden' name='w%d%s%d'>", v4, v5, v10, v11);
    }
  }
  else
  {
    v8 = 1;
    while ( v8 <= v6 )
    {
      v9 = v8++;
      result = printf("<input type='hidden' name='%s%d'>", v5, v9);
    }
  }
  return result;
}

//----- (000392E0) --------------------------------------------------------
int __fastcall sub_392E0(int a1)
{
  int v1; // r4@1
  int v2; // r3@1
  int v3; // r3@1

  v1 = a1;
  printf("<form method=post action='timepro.cgi' name='natrouterconf_misc_dmztwinip%d_fm'>", a1);
  printf("<input type=hidden name='tmenu' value='iframe'>");
  printf("<input type=hidden name='smenu' value='natrouterconf_misc_submit'>");
  printf("<input type=hidden name='act' value='dmztwinip'>");
  printf("<input type=hidden name='wanid' value='%d'>", v1);
  printf("<input type=hidden name='w%dmode' value=''>", v1);
  printf("<input type=hidden name='w%dleasetime'>", v1);
  printf("<input type=hidden name='get_w%dhosthw'>", v1);
  sub_39274(v1, (int)"ip", 4, v2);
  sub_39274(v1, (int)"hw", 6, v3);
  return printf("</form>");
}

//----- (00039394) --------------------------------------------------------
int __fastcall print_iframe_natrouterconf_misc_submit(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r1@1
  int v8; // r0@1
  int v9; // r1@1
  int v10; // r0@1
  int v11; // r1@1
  int v12; // r0@1

  v2 = sub_37FA4(a2);
  print_js_file((int)"natrouterconf", (int)"misc");
  sub_392E0(1);
  puts("<form method=post action=\"timepro.cgi\" name=\"natrouterconf_misc_ftp_fm\">");
  puts("<input type=hidden name=\"tmenu\" value='iframe'>");
  puts("<input type=hidden name=\"smenu\" value='natrouterconf_misc_submit'>");
  puts("<input type=hidden name=\"act\" value=\"dmztwinip\">");
  puts("<input type=hidden name=\"ftp_port\" value=\"\">");
  puts("<input type=hidden name=\"port0_ch\" value=\"\">");
  puts("<input type=hidden name=\"port1_ch\" value=\"\">");
  puts("<input type=hidden name=\"port2_ch\" value=\"\">");
  puts("<input type=hidden name=\"port3_ch\" value=\"\">");
  puts("<input type=hidden name=\"port4_ch\" value=\"\">");
  printf("</form>");
  puts("<form method=post action=\"timepro.cgi\" name=\"natrouterconf_misc_natonoff_fm\">");
  puts("<input type=hidden name=\"tmenu\" value='iframe'>");
  puts("<input type=hidden name=\"smenu\" value='natrouterconf_misc_submit'>");
  puts("<input type=hidden name=\"act\" value=\"natonoff\">");
  puts("<input type=hidden name=\"nat_run\" value=\"\">");
  printf("</form>");
  puts("<form method=post action=\"timepro.cgi\" name=\"natrouterconf_misc_pppoe_fm\">");
  puts("<input type=hidden name=\"tmenu\" value='iframe'>");
  puts("<input type=hidden name=\"smenu\" value='natrouterconf_misc_submit'>");
  puts("<input type=hidden name=\"act\" value=\"pppoe\">");
  puts("<input type=hidden name=\"pppoe_relay\" value=\"\">");
  printf("</form>");
  puts("<form method=post action=\"timepro.cgi\" name=\"natrouterconf_misc_upnp_relay_fm\">");
  puts("<input type=hidden name=\"tmenu\" value='iframe'>");
  puts("<input type=hidden name=\"smenu\" value='natrouterconf_misc_submit'>");
  puts("<input type=hidden name=\"act\" value=\"upnp_relay\">");
  puts("<input type=hidden name=\"upnp_relay\" value=\"\">");
  printf("</form>");
  printf("<table>");
  puts("<tr height=245 style=\"background-Color:#eeeeee\"><td id='apply_html' valign=top colspan=2>");
  v4 = get_ux_text_common(734, v3);
  sub_3920C("dmztwinip1", v4);
  v6 = get_ux_text_common(735, v5);
  sub_3920C("ftp", v6);
  v8 = get_ux_text_common(736, v7);
  sub_3920C("natonoff", v8);
  v10 = get_ux_text_common(737, v9);
  sub_3920C("pppoe", v10);
  v12 = get_ux_text_common(738, v11);
  sub_3920C("upnp_relay", v12);
  printf("</td></tr>");
  printf("</table>");
  printf("<script>");
  printf("parent.document.getElementById('apply_html').innerHTML = document.getElementById('apply_html').innerHTML;");
  if ( v2 )
    printf("parent.document.getElementsByName('natrouterconf_misc_menu')[0].contentWindow.document.getElementsByName('natrouterconf_misc_status')[0].contentWindow.location.reload();");
  printf("setTimeout(function() {UnMaskIt(parent.document, 'apply_mask');}, 500);");
  return printf("</script>");
}

//----- (000395FC) --------------------------------------------------------
int print_iframe_natrouterconf_misc_status()
{
  int v0; // r1@1
  const char *v1; // r0@4
  int v2; // r7@8
  int v3; // r0@8
  int v4; // r6@8
  void *v5; // r0@8
  int v6; // r1@8
  void *v7; // r4@8
  void *v8; // r6@8
  int v9; // r10@8
  int v10; // r0@9
  char *v11; // r8@9
  size_t v12; // r0@18
  int v13; // r1@20
  int v14; // r0@20
  int *v15; // r6@20
  int v16; // r7@22
  int v17; // t1@22
  size_t v18; // r0@23
  int v19; // r1@23
  char *v20; // r3@23
  int v21; // r0@29
  int v22; // r1@29
  int v23; // r0@30
  const char *v24; // r0@32
  int v25; // r1@32
  int v26; // r0@32
  int v27; // r0@32
  int v28; // r1@32
  int v29; // r0@33
  const char *v30; // r0@35
  int v31; // r1@35
  int v32; // r0@35
  int v33; // r0@35
  int v34; // r1@35
  int v35; // r0@36
  const char *v36; // r0@38
  int v37; // r1@38
  int v38; // r0@38
  signed int i; // r3@38
  char *v40; // r1@41
  int v41; // r4@43
  int v43; // [sp+0h] [bp-818h]@20
  char s; // [sp+Ch] [bp-80Ch]@6
  char v45; // [sp+22Ch] [bp-5ECh]@8
  int v46; // [sp+42Ch] [bp-3ECh]@20
  int v47; // [sp+62Ch] [bp-1ECh]@4
  int v48; // [sp+72Ch] [bp-ECh]@8
  int v49; // [sp+7ACh] [bp-6Ch]@1
  char v50; // [sp+7B0h] [bp-68h]@7
  char v51; // [sp+7C4h] [bp-54h]@5
  int v52; // [sp+7D4h] [bp-44h]@20
  char v53; // [sp+7D8h] [bp-40h]@8
  char v54; // [sp+7F0h] [bp-28h]@24

  print_js_file((int)"natrouterconf", (int)"misc");
  printf("<BODY style=\"padding:0px 0px; margin:0px 0px;\">");
  printf("<form method=post action=\"timepro.cgi\" id=\"main_form\" name=\"main_form\" style=\"margin:0;\">");
  puts("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=\"smenu\" value=\"natrouterconf_misc\">");
  printf("<table style=\"border-collapse:collapse; border-style:none none none none; width:100%%;\" cellspacing=0px cellpadding=0px>\n");
  printf("<COL WIDTH=9><COL WIDTH=220><COL width=350><COL>");
  dmztwinip_read_config("wan1", &v49);
  if ( v49 == 1 )
  {
    strcpy((char *)&v47, "DMZ");
    if ( v51 )
    {
      sprintf(&s, (const char *)&unk_9B324, &v51);
      strcat((char *)&v47, &s);
    }
  }
  else if ( v49 == 2 )
  {
    strcpy((char *)&v47, "Twin IP");
    if ( v50 )
    {
      v2 = 0;
      sprintf(&s, " - %s", &v50);
      strcat((char *)&v47, &s);
      memset(&v53, 0, 0x20u);
      get_ip_by_hwaddr(&v53, &v50);
      memset(&v48, 0, 0x80u);
      memset(&v45, 0, 0x200u);
      v3 = dhcpd_get_all_dynamic_lease(0, 0);
      v4 = v3;
      v5 = malloc(108 * v3);
      v6 = v4;
      v7 = v5;
      v8 = v5;
      v9 = dhcpd_get_all_dynamic_lease(v5, v6);
      while ( v2 < v9 )
      {
        v10 = maccmp((char *)v8 + 20, &v50);
        v11 = (char *)v8;
        v8 = (char *)v8 + 108;
        if ( !v10 )
        {
          sf_strncpy(&v48, v11 + 44, 128);
          break;
        }
        ++v2;
      }
      convert_euckr_to_utf8(&v48, &v45);
      if ( v53 || v45 )
      {
        if ( v45 )
          snprintf(&s, 0x220u, "(%s, %s)", &v53, &v45);
        else
          snprintf(&s, 0x220u, "(%s)", &v53);
        v12 = strlen((const char *)&v47);
        strncat((char *)&v47, &s, 255 - v12);
      }
      free(v7);
    }
  }
  else if ( !v49 )
  {
    v1 = (const char *)get_ux_text_common(926, v0);
    strcpy((char *)&v47, v1);
  }
  strcpy((char *)&v46, "");
  v14 = get_ux_text_common(734, v13);
  v43 = 0;
  sub_37E5C((int)"dmztwinip1", v14, (int)&v47);
  memset(&v53, 0, 0x18u);
  strcpy((char *)&v47, "");
  strcpy((char *)&v46, "");
  v15 = &v52;
  read_ftp_private_port(&v53, 6);
  while ( 1 )
  {
    v17 = v15[1];
    ++v15;
    v16 = v17;
    if ( !v17 )
      break;
    snprintf((char *)&v49, 0x10u, "%d, ", v16, v43);
    strcat((char *)&v47, (const char *)&v49);
  }
  v18 = strlen((const char *)&v47);
  if ( v18 > 1 )
    v20 = &v54;
  if ( v18 > 1 )
    v20 += 8;
  if ( v18 > 1 )
    v20[v18 - 462] = v16;
  v21 = get_ux_text_common(735, v19);
  sub_37E5C((int)"ftp", v21, (int)&v47);
  if ( sysconf_nat_get(1) )
    v23 = 1104;
  else
    v23 = 1111;
  v24 = (const char *)get_ux_text_common(v23, v22);
  strcpy((char *)&v47, v24);
  strcpy((char *)&v46, "");
  v26 = get_ux_text_common(736, v25);
  v27 = sub_37E5C((int)"natonoff", v26, (int)&v47);
  if ( get_pppoe_relay_enabled(v27) )
    v29 = 1104;
  else
    v29 = 1111;
  v30 = (const char *)get_ux_text_common(v29, v28);
  strcpy((char *)&v47, v30);
  strcpy((char *)&v46, "");
  v32 = get_ux_text_common(737, v31);
  v33 = sub_37E5C((int)"pppoe", v32, (int)&v47);
  if ( get_upnp_relay(v33) )
    v35 = 1104;
  else
    v35 = 1111;
  v36 = (const char *)get_ux_text_common(v35, v34);
  strcpy((char *)&v47, v36);
  strcpy((char *)&v46, "");
  v38 = get_ux_text_common(738, v37);
  sub_37E5C((int)"upnp_relay", v38, (int)&v47);
  for ( i = 5; ; i = v41 )
  {
    v40 = i & 1 ? "f7f7f7" : "ffffff";
    v41 = i + 1;
    printf("<TR height=20 STYLE=\"background-Color:#%s\">", v40);
    printf("<TD></TD><TD></TD><TD CLASS=text_gray></TD><TD></TD></TR>");
    if ( v41 == 13 )
      break;
  }
  printf("</table>");
  printf("</form>");
  printf("<script>");
  printf("parent.document.getElementById('main_form').outerHTML = document.getElementById('main_form').outerHTML;");
  printf("setTimeout(function() {parent.window.clickNatrouterconfMiscTr();}, 50);");
  printf("</script>");
  return printf("</BODY>");
}
// 10508: using guessed type int __fastcall get_pppoe_relay_enabled(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 106AC: using guessed type int __fastcall get_ip_by_hwaddr(_DWORD, _DWORD);
// 1079C: using guessed type int __fastcall dmztwinip_read_config(_DWORD, _DWORD);
// 108C8: using guessed type int __fastcall dhcpd_get_all_dynamic_lease(_DWORD, _DWORD);
// 112E8: using guessed type int __fastcall read_ftp_private_port(_DWORD, _DWORD);
// 113C0: using guessed type int __fastcall get_upnp_relay(_DWORD);
// 11414: using guessed type int __fastcall sysconf_nat_get(_DWORD);
// 11450: using guessed type int __fastcall convert_euckr_to_utf8(_DWORD, _DWORD);
// 11CB4: using guessed type int __fastcall maccmp(_DWORD, _DWORD);

//----- (00039B90) --------------------------------------------------------
int print_iframe_natrouterconf_misc()
{
  print_js_file((int)"natrouterconf", (int)"misc");
  printf("<BODY style=\"padding:0px 0px; margin:0px 0px;\">");
  printf("<form method=post action=\"timepro.cgi\" id=\"main_form\" name=\"main_form\" style=\"margin:0;\">");
  printf("</form>");
  printf("<iframe name=\"natrouterconf_misc_status\" src=\"timepro.cgi?tmenu=iframe&smenu=natrouterconf_misc_status\" frameborder=no style='display:none;'></iframe>");
  return printf("</BODY>");
}

//----- (00039BE8) --------------------------------------------------------
int sub_39BE8()
{
  int v0; // r0@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r5@1
  int v7; // r0@1
  int v8; // r1@1
  int v9; // r0@1
  int v10; // r1@1
  int v11; // r0@1
  int v13; // [sp+0h] [bp-110h]@1

  strcpy((char *)&v13, "");
  print_js_file((int)"natrouterconf", (int)"misc");
  printf("<style>");
  printf("input[type='text'] { text-align: center; }");
  printf("</style>");
  printf("<form method=\"post\" action=\"timepro.cgi\" name=\"natrouterconf_fm\" style='margin:0;'>");
  printf("<input type=hidden id=\"menu_id\" name=\"menu_id\" value=\"\">");
  v0 = puts("<table style=\"border-collapse:collapse; border-style:none solid solid solid; border-width:0px 1px 1px 1px; border-color:#eeeeee;width:642px; \" cellspacing=0px cellpadding=0px>");
  str(v0);
  printf("<td width=100%% height=%d colspan=2>", 260);
  printf("<iframe name=\"natrouterconf_misc_menu\" src=\"timepro.cgi?tmenu=iframe&smenu=natrouterconf_misc\" frameborder=no width=100%% height=260 align=left scrolling=yes></iframe>");
  v1 = printf("</td>");
  etr(v1);
  printf("<tr height=245 style=\"background-Color:#eeeeee\"><td id='apply_html' valign=top colspan=2></td></tr>");
  printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=2></td></tr>");
  printf((const char *)&unk_9B71B);
  printf("<td align=right id='apply_bt_dmztwinip1' style='padding: 4px 4px 0 0; display:none;'>");
  v3 = get_ux_text_common(35, v2);
  printf("<input type=\"button\" name='apply' id=\"w1_apply\" value=\"%s\" onclick=\"submit_dmztwinip(1, false)\">", v3);
  printf("</td>");
  printf("<td align=right id='apply_bt_natonoff' style='padding:4px 4px 0 0; display:none;'>");
  v5 = get_ux_text_common(36, v4);
  v6 = v5;
  v7 = hwinfo_get_reboot_duration(v5);
  printf("<input type=button name=\"nat_apply\" value=\"%s\" onclick=\"applyNatOnOff(%d);\">\n", v6, v7);
  printf("</td>");
  printf("<td align=right id='apply_bt_pppoe' style='padding:4px 4px 0 0; display:none;'>");
  v9 = get_ux_text_common(35, v8);
  printf("<input type=button name=\"pppoe_relay_apply\" value=\"%s\" onclick=\"ApplyPPPoE();\">\n", v9);
  printf("</td>");
  printf("<td align=right id='apply_bt_upnp_relay' style='padding:4px 4px 0 0; display:none;'>");
  v11 = get_ux_text_common(35, v10);
  printf("<input type=button name=\"upnp_relay_apply\" value=\"%s\" onclick=\"Apply_UPNP_RELAY();\">\n", v11);
  printf("</td>");
  printf("</td></tr>");
  printf("</table>");
  printf("</form>");
  return printf("<iframe name=\"natrouterconf_misc_submit\" src=\"timepro.cgi?tmenu=iframe&smenu=natrouterconf_misc_submit\" frameborder=no style='display:none;'></iframe>");
}
// 10934: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);

//----- (00039DA8) --------------------------------------------------------
int sub_39DA8()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1

  sub_39BE8();
  printf("<DIV id=\"%s\" style=\"display:none;\">", &unk_9BAB0);
  printf(
    "<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff; "
    "                opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\" "
    "onclick=\"UnMaskIt(document, '%s');\">\n",
    &unk_9BAB0);
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:151; top:128; height:210px; width:340px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  printf("<iframe name=\"mac_list\" frameborder=no style='width:340px; height:210px;'></iframe>");
  printf("</DIV>");
  printf("</DIV>");
  v1 = get_ux_text_common(34, v0);
  sub_37EBC("apply_mask", v1);
  v3 = get_ux_text_common(728, v2);
  return sub_37EBC("reboot_mask", v3);
}

//----- (00039E44) --------------------------------------------------------
_BYTE *__fastcall sub_39E44(_BYTE *result)
{
  char v1; // r3@4
  int v2; // t1@4

  while ( 1 )
  {
    v2 = *result++;
    v1 = v2;
    if ( !v2 )
      break;
    if ( (unsigned __int8)(v1 - 97) <= 0x19u )
      *(result - 1) = v1 - 32;
  }
  return result;
}

//----- (00039E6C) --------------------------------------------------------
int sub_39E6C()
{
  printf("<TR height=24 STYLE=\"cursor:pointer; background-Color:#%s\">");
  return printf("<TD width=100%% colspan=10 CLASS=text_gray></TD></TR>");
}

//----- (00039EA4) --------------------------------------------------------
int __fastcall sub_39EA4(unsigned int a1)
{
  unsigned int v1; // r4@1
  const char *v2; // r0@3
  void *v3; // r0@5
  const char *v4; // r0@7
  int v5; // r1@9
  int v6; // r0@9

  v1 = a1;
  printf("<TR height=\"24\" ID=\"_-new_line\" class=\"fw_tr\" style=\"cursor:pointer; background-color:#%s;\">\n");
  puts("<TD align=\"left\" width=\"30\" class=\"fw_td\">");
  if ( v1 <= 1 || v1 != 2 )
    v2 = "<SPAN id=\"_-new_line_span_1\" class=\"fw_span\" style=\"padding-left:5px;\"\t\t\t onclick=\"onClickedFWRule('i"
         "nternet','','','','','','','','','','','','','','','','','');\">";
  else
    v2 = "<SPAN id=\"_-new_line_span_1\" class=\"fw_span\" style=\"padding-left:5px;\"\t\t\t onclick=\"onClickedFWRule('w"
         "ifi','','','','','','','','','','','','','','','','','');\">";
  puts(v2);
  v3 = get_image_dir();
  printf("<img src=\"/%s/pf_new_rule.gif\">\n", v3);
  puts("</SPAN></TD>");
  puts("<TD align=\"left\" colspan=\"9\" class=\"fw_td\">");
  puts("<a name=\"_-new_line\" class=\"fw_a\">");
  if ( v1 <= 1 || v1 != 2 )
    v4 = "<SPAN ID=\"_-new_line_span_2\" class=\"fw_span\" style=\"color:#4789FF;\"\t\t \tonclick=\"onClickedFWRule('inte"
         "rnet','','','','','','','','','','','','','','','','','');\">";
  else
    v4 = "<SPAN ID=\"_-new_line_span_2\" class=\"fw_span\" style=\"color:#4789FF;\"\t\t \tonclick=\"onClickedFWRule('wifi"
         "','','','','','','','','','','','','','','','','','');\">";
  printf(v4);
  v6 = get_ux_text_common(325, v5);
  return printf("%s</SPAN></A></TD></TR>", v6);
}

//----- (00039F78) --------------------------------------------------------
int sub_39F78()
{
  puts("<style type=\"text/css\">");
  puts(".fw_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".fw_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".fw_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".left_padding_td {");
  puts("\tpadding:0 0 0 5; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".fw_p {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".fw_span {");
  puts("\tpadding:0 0 0 0; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".fw_select {");
  puts("\tpadding:0 0 0 0; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".fw_textbox {");
  puts("\tpadding:1px 0 1px 0; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".fw_button {");
  puts("\tpadding:0 1px 0 1px; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".fw_checkbox {");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".fw_a {");
  puts("\tvertical-align:middle; text-decoration:none;");
  puts("\tdisplay:inline-block; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;");
  puts("}");
  puts(".fw_overflowable {");
  puts("\tpadding:0 0 0 0; margin:0 0 0 0; border:none none none none; vertical-align:middle; text-decoration:none;");
  puts("\tdisplay:inline-block; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;");
  puts("}");
  puts(".fw_opacity_30 {");
  puts("\topacity:0.3;");
  puts("\t-moz-opacity:0.3;");
  puts("\t-khtml-opacity:0.3;");
  puts("\tfilter:alpha(opacity=30);");
  puts("}");
  printf("::-webkit-input-placeholder {");
  printf("\tcolor:#B4B4B4;");
  putchar(125);
  printf(":-moz-placeholder {");
  printf("\tcolor:#B4B4B4;");
  printf("\topacity:1;");
  putchar(125);
  printf((const char *)&unk_94D6E);
  printf("\tcolor:#B4B4B4;");
  printf("\topacity:1;");
  putchar(125);
  printf(":-ms-input-placeholder {");
  printf("\tcolor:#B4B4B4;");
  putchar(125);
  return printf("</style>");
}

//----- (0003A254) --------------------------------------------------------
int __fastcall sub_3A254(int a1, char *a2)
{
  int v2; // r5@1
  char *v3; // r0@3
  int v4; // r1@5
  char *v5; // r1@6
  char *v6; // r0@8
  bool v7; // zf@8
  const char *v8; // r1@8
  char *v9; // r0@8
  char *v10; // r0@13
  bool v11; // zf@13
  const char *v12; // r1@13
  char *v13; // r0@13
  char *v14; // r6@20
  signed int v15; // r4@20
  int v16; // r0@21
  int v17; // r0@24
  char v19; // [sp+18h] [bp-38h]@8
  char v20; // [sp+1Dh] [bp-33h]@10
  char v21; // [sp+22h] [bp-2Eh]@15
  char v22; // [sp+27h] [bp-29h]@18
  char dest; // [sp+2Ch] [bp-24h]@3

  v2 = a1;
  if ( a2 && *a2 )
  {
    v3 = &dest;
  }
  else
  {
    a2 = "";
    v3 = &dest;
  }
  strcpy(v3, a2);
  if ( dest )
  {
    v5 = strtok(&dest, ".");
    if ( !v5 )
      v5 = "0";
    strcpy(&v19, v5);
    v6 = strtok(0, ".");
    v8 = v6;
    v7 = v6 == 0;
    v9 = &v19;
    if ( v7 )
      v8 = "0";
    else
      v9 = &v20;
    if ( v7 )
      v9 += 5;
    strcpy(v9, v8);
    v10 = strtok(0, ".");
    v12 = v10;
    v11 = v10 == 0;
    v13 = &v19;
    if ( v11 )
      v12 = "0";
    else
      v13 = &v21;
    if ( v11 )
      v13 += 10;
    strcpy(v13, v12);
    strcpy(&v22, (const char *)&unk_9BD46);
  }
  else
  {
    v22 = 0;
    v21 = 0;
    v20 = 0;
    v19 = 0;
  }
  v14 = &v19;
  v15 = 1;
  do
  {
    v16 = get_ux_text_common(442, v4);
    printf(
      "<input type=text name=\"%s%d\" maxlength=3 size=3 style=\"width:25px; ime-mode:disabled;\" class=\"fw_textbox\" va"
      "lue=\"%s\" onfocus=\"this.select();\" onkeypress=\"return IPKeyDown('%s', %d);\" title=\"%s%d\" onkeydown=\"Button"
      "ViewControl('modify'); return true;\" onkeyup=\"IPKeyUp('%s',%d);\">",
      v2,
      v15,
      v14,
      v2,
      v15,
      v16,
      v15,
      v2,
      v15,
      *(_DWORD *)&v19);
    if ( v15 != 4 )
      putchar(46);
    ++v15;
    v14 += 5;
  }
  while ( v15 != 5 );
  v17 = get_ux_text_common(442, v4);
  return printf(
           "~<input type=text name=\"%s%d\" maxlength=3 size=3 style=\"width:25px; ime-mode:disabled;\" onfocus=\"this.se"
           "lect();\"                    class=\"fw_textbox\" onkeypress=\"return IPKeyDown('%s', %d);\" title=\"%s%d\" \t"
           "\t\tonkeyup=\"IPKeyUp('%s',%d);\" onkeydown=\"ButtonViewControl('modify'); return true;\">",
           v2,
           5,
           v2,
           5,
           v17,
           5,
           v2,
           5);
}

//----- (0003A3C0) --------------------------------------------------------
char *__fastcall sub_3A3C0(int a1)
{
  int v1; // r5@1
  int v2; // r1@2
  int v3; // r0@2
  int v4; // r1@2
  int v5; // r0@2
  int v6; // r1@2
  int v7; // r0@2
  int v8; // r1@2
  int v9; // r0@2
  int v10; // r1@2
  int v11; // r0@2
  int v12; // r1@2
  int v13; // r0@2
  int v14; // r1@2
  int v15; // r0@2
  int v16; // r1@2
  int v17; // r0@2

  v1 = a1;
  if ( byte_CA4DC[0] )
    return &byte_CA4DC[21 * v1];
  sf_strncpy(byte_CA4DC, "Mon", 6);
  v3 = get_ux_text_common(323, v2);
  sf_strncpy(&unk_CA4E2, v3, 15);
  sf_strncpy(&unk_CA4F1, "Tue", 6);
  v5 = get_ux_text_common(345, v4);
  sf_strncpy(&unk_CA4F7, v5, 15);
  sf_strncpy(&unk_CA506, "Wed", 6);
  v7 = get_ux_text_common(346, v6);
  sf_strncpy(&unk_CA50C, v7, 15);
  sf_strncpy(&unk_CA51B, "Thu", 6);
  v9 = get_ux_text_common(343, v8);
  sf_strncpy(&unk_CA521, v9, 15);
  sf_strncpy(&unk_CA530, "Fri", 6);
  v11 = get_ux_text_common(316, v10);
  sf_strncpy(&unk_CA536, v11, 15);
  sf_strncpy(&unk_CA545, "Sat", 6);
  v13 = get_ux_text_common(336, v12);
  sf_strncpy(&unk_CA54B, v13, 15);
  sf_strncpy(&unk_CA55A, "Sun", 6);
  v15 = get_ux_text_common(341, v14);
  sf_strncpy(&unk_CA560, v15, 15);
  sf_strncpy(&unk_CA56F, "Every", 6);
  v17 = get_ux_text_common(308, v16);
  sf_strncpy(&unk_CA575, v17, 15);
  return &byte_CA4DC[21 * v1];
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);

//----- (0003A54C) --------------------------------------------------------
char *__fastcall sub_3A54C(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r0@2
  int v4; // r1@2
  int v5; // r0@2
  int v6; // r1@2
  int v7; // r0@2
  int v8; // r1@2
  int v9; // r0@2
  int v10; // r1@2
  int v11; // r0@2
  int v12; // r1@2
  int v13; // r0@2
  int v14; // r1@2
  int v15; // r0@2

  v2 = a1;
  if ( byte_CA584[0] )
    return &byte_CA584[16 * v2];
  v3 = get_ux_text_common(341, a2);
  sf_strncpy(byte_CA584, v3, 16);
  v5 = get_ux_text_common(323, v4);
  sf_strncpy(&unk_CA594, v5, 16);
  v7 = get_ux_text_common(345, v6);
  sf_strncpy(&unk_CA5A4, v7, 16);
  v9 = get_ux_text_common(346, v8);
  sf_strncpy(&unk_CA5B4, v9, 16);
  v11 = get_ux_text_common(343, v10);
  sf_strncpy(&unk_CA5C4, v11, 16);
  v13 = get_ux_text_common(316, v12);
  sf_strncpy(&unk_CA5D4, v13, 16);
  v15 = get_ux_text_common(336, v14);
  sf_strncpy(&unk_CA5E4, v15, 16);
  return &byte_CA584[16 * v2];
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);

//----- (0003A620) --------------------------------------------------------
signed int __fastcall sub_3A620(const char **a1, const char *a2)
{
  const char *v2; // r6@1
  const char **v3; // r5@1
  signed int i; // r4@1
  const char *v5; // r0@4
  const char *v6; // t1@4
  int v7; // r3@4

  v2 = a2;
  v3 = a1;
  for ( i = 0; ; ++i )
  {
    v6 = *v3;
    ++v3;
    v5 = v6;
    v7 = i <= 199;
    if ( !v6 )
      v7 = 0;
    if ( !v7 )
      return 0;
    if ( !strcmp(v5, v2) )
      break;
  }
  return 1;
}

//----- (0003A678) --------------------------------------------------------
char *__fastcall sub_3A678(int a1)
{
  char *result; // r0@3
  const char *v2; // r4@4

  if ( *(_BYTE *)(a1 + 16) || *(_BYTE *)(a1 + 144) )
  {
    v2 = (const char *)(a1 + 8);
    if ( !strcmp((const char *)(a1 + 8), "ip") )
    {
      result = "ip";
    }
    else if ( !strcmp(v2, "ipmac") )
    {
      result = "ip";
    }
    else
    {
      result = "mac";
    }
  }
  else
  {
    result = "all";
  }
  return result;
}

//----- (0003A6EC) --------------------------------------------------------
const char *__fastcall sub_3A6EC(char *src)
{
  const char *result; // r0@1
  int v2; // [sp+0h] [bp-28h]@1

  strncpy((char *)&v2, src, 0x20u);
  strtok((char *)&v2, ".");
  strtok(0, ".");
  strtok(0, ".");
  result = strtok(0, ".");
  if ( result )
    result = (const char *)atoi(result);
  return result;
}

//----- (0003A754) --------------------------------------------------------
int __fastcall sub_3A754(int result)
{
  if ( result )
    result = delete_fw_rule(0, result);
  return result;
}
// 107D8: using guessed type int __fastcall delete_fw_rule(_DWORD, _DWORD);

//----- (0003A764) --------------------------------------------------------
const char *__fastcall sub_3A764(const char *a1, const char *a2, int a3, signed int a4)
{
  const char *v4; // r6@1
  const char *v5; // r4@1
  int v6; // r5@1
  signed int v7; // r8@1
  size_t v8; // r7@2
  char *v9; // r0@4
  const char *v10; // r6@7
  char *v11; // r0@7
  signed int v12; // r4@9
  void *v13; // r7@15
  signed int v14; // r2@15
  _BYTE *v15; // r3@15
  _BYTE *v16; // r1@16
  int v17; // t1@16

  v4 = a1;
  v5 = a2;
  v6 = a3;
  v7 = a4;
  if ( !a1 )
    return v4;
  v8 = strlen(a2);
  while ( strncmp(v4, v5, v8) )
  {
    v9 = strchr(v4, 38);
    v4 = v9;
    if ( !v9 )
      return v4;
    v4 = v9 + 1;
  }
  if ( !v4 )
    return v4;
  v10 = &v4[v8 + 1];
  v11 = strchr(v10, 38);
  if ( !v11 )
    v11 = (char *)&v10[strlen(v10)];
  v12 = v11 - v10;
  if ( v11 == v10 )
  {
    v4 = (const char *)(v11 - v10);
  }
  else
  {
    if ( v7 <= v12 )
      v12 = v7 - 1;
    if ( strchr(v10, 37) )
      v12 *= 3;
    v13 = malloc(v12 + 1);
    memcpy(v13, v10, v12);
    v14 = 0;
    v15 = v13;
    *((_BYTE *)v13 + v12) = 0;
    while ( v14 < v12 )
    {
      v16 = v15;
      v17 = *v15++;
      if ( v17 == 43 )
        *(v15 - 1) = 32;
      if ( *(v15 - 1) == 38 )
      {
        *v16 = 0;
        break;
      }
      ++v14;
    }
    v4 = (const char *)1;
    decode_string(v13);
    sf_strncpy(v6, v13, v7);
    free(v13);
  }
  return v4;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 109C4: using guessed type int __fastcall decode_string(_DWORD);

//----- (0003A89C) --------------------------------------------------------
void *__fastcall sub_3A89C(const char *a1)
{
  const char *v1; // r6@1
  void *v2; // r8@1
  void *v3; // r9@1
  void *v4; // r5@1
  const char *v5; // r7@1
  signed int v6; // r10@24
  int v7; // r10@32
  int v8; // r0@45
  int v9; // r7@51
  const char *v10; // r10@69
  unsigned int v11; // r3@84
  bool v12; // zf@98
  char *v13; // r0@98
  const char *v14; // r4@99
  int v15; // r0@111
  char *v16; // r0@140
  int v17; // r10@141
  int v18; // r0@153
  int v19; // r10@154
  signed int v20; // r3@170
  int v21; // r7@171
  int v23; // [sp+0h] [bp-288h]@1
  char s1; // [sp+200h] [bp-88h]@98
  char v25; // [sp+220h] [bp-68h]@94
  char dest; // [sp+240h] [bp-48h]@4

  v1 = a1;
  v2 = malloc(0x224u);
  v3 = v2;
  v4 = malloc(0x1C8u);
  init_fw_rule(v2);
  init_fw_netfilter(v4);
  *((_DWORD *)v2 + 133) = v4;
  memset(&v23, 0, 0x200u);
  v5 = sub_3A764(v1, "mode", (int)&v23, 32);
  if ( v5 )
  {
    if ( fw_spchar_validate(&v23) )
    {
      v5 = 0;
    }
    else
    {
      v5 = (const char *)1;
      strcpy(&dest, (const char *)&v23);
    }
  }
  memset(&v23, 0, 0x200u);
  if ( v5 )
  {
    v5 = sub_3A764(v1, "name", (int)&v23, 512);
    if ( v5 )
    {
      strncpy((char *)v2, (const char *)&v23, 0x200u);
      *((_BYTE *)v2 + 511) = 0;
      v5 = (const char *)(fw_spchar_validate(&v23) == 0);
    }
  }
  memset(&v23, 0, 0x200u);
  if ( v5 )
  {
    v5 = sub_3A764(v1, "days", (int)&v23, 32);
    if ( v5 )
    {
      if ( fw_spchar_validate(&v23) )
      {
        v5 = 0;
      }
      else
      {
        v5 = (const char *)1;
        *((_DWORD *)v2 + 129) = atoi((const char *)&v23);
      }
    }
  }
  memset(&v23, 0, 0x200u);
  if ( v5 )
  {
    v5 = sub_3A764(v1, "policy", (int)&v23, 32);
    if ( v5 )
    {
      v5 = (const char *)fw_spchar_validate(&v23);
      if ( v5 )
      {
        v5 = 0;
      }
      else if ( !strcmp((const char *)&v23, "accept") )
      {
        v5 = (const char *)1;
        *((_DWORD *)v4 + 112) = 1;
      }
      else if ( !strcmp((const char *)&v23, "drop") )
      {
        v5 = (const char *)1;
        *((_DWORD *)v4 + 112) = 0;
      }
    }
  }
  memset(&v23, 0, 0x200u);
  if ( v5 )
  {
    v5 = sub_3A764(v1, "stime", (int)&v23, 32);
    if ( v5 )
    {
      v5 = (const char *)(fw_spchar_validate(&v23) == 0);
      if ( !strcmp((const char *)&v23, "all") )
      {
        *((_DWORD *)v2 + 130) = 0;
        v6 = 1;
        *((_DWORD *)v2 + 131) = 0;
        goto LABEL_31;
      }
      if ( v5 )
        *((_DWORD *)v2 + 130) = atoi((const char *)&v23);
      if ( *((_DWORD *)v2 + 130) < 0x960u )
      {
        v6 = 0;
        goto LABEL_31;
      }
      v5 = 0;
    }
  }
  v6 = (signed int)v5;
LABEL_31:
  if ( v6 == 1 )
    v7 = 0;
  else
    v7 = (unsigned __int8)v5 & 1;
  memset(&v23, 0, 0x200u);
  if ( v7 )
  {
    if ( sub_3A764(v1, "etime", (int)&v23, 32) )
    {
      if ( fw_spchar_validate(&v23) )
      {
        v5 = 0;
      }
      else
      {
        v5 = (const char *)1;
        *((_DWORD *)v2 + 131) = atoi((const char *)&v23);
      }
      if ( *((_DWORD *)v2 + 131) >= 0x960u )
        v5 = 0;
    }
    else
    {
      v5 = (const char *)1;
    }
  }
  memset(&v23, 0, 0x200u);
  if ( !v5 )
    goto LABEL_181;
  if ( sub_3A764(v1, "disabled", (int)&v23, 32) )
  {
    if ( fw_spchar_validate(&v23) )
      goto LABEL_181;
    v8 = atoi((const char *)&v23);
    if ( v8 )
    {
      if ( v8 != 1 )
        goto LABEL_181;
      *((_DWORD *)v2 + 128) = 0;
    }
    else
    {
      *((_DWORD *)v2 + 128) = 1;
    }
  }
  v9 = strcmp(&dest, "internet");
  if ( !v9 )
  {
    memset(&v23, 0, 0x200u);
    if ( sub_3A764(v1, "direction", (int)&v23, 8) )
    {
      if ( !fw_spchar_validate(&v23) )
      {
        if ( !strcmp((const char *)&v23, "inout")
          || !strcmp((const char *)&v23, "outin")
          || !strcmp((const char *)&v23, "both") )
        {
          v9 = 1;
          strcpy((char *)v4, (const char *)&v23);
        }
        else
        {
          v9 = 0;
        }
      }
    }
    else
    {
      v9 = 0;
    }
    memset(&v23, 0, 0x200u);
    if ( v9
      && sub_3A764(v1, "protocol", (int)&v23, 8)
      && !fw_spchar_validate(&v23)
      && (!strcmp((const char *)&v23, "none")
       || !strcmp((const char *)&v23, "tcp")
       || !strcmp((const char *)&v23, "udp")
       || !strcmp((const char *)&v23, "icmp")
       || !strcmp((const char *)&v23, "gre")
       || !strcmp((const char *)&v23, "tcpudp")) )
    {
      strcpy((char *)v4 + 432, (const char *)&v23);
      if ( !strcmp((const char *)v4 + 432, "none")
        || !strcmp((const char *)v4 + 432, "gre")
        || !strcmp((const char *)v4 + 432, "icmp") )
      {
        goto LABEL_188;
      }
      memset(&v23, 0, 0x200u);
      if ( sub_3A764(v1, "sport", (int)&v23, 8) )
      {
        if ( fw_spchar_validate(&v23) )
        {
          v10 = 0;
        }
        else
        {
          v10 = (const char *)1;
          *((_DWORD *)v4 + 110) = atoi((const char *)&v23);
        }
        if ( *((_DWORD *)v4 + 110) >= 0x10000u )
          v10 = 0;
      }
      else
      {
        v10 = (const char *)1;
      }
      memset(&v23, 0, 0x200u);
      if ( !v10 )
        goto LABEL_90;
      if ( !sub_3A764(v1, "eport", (int)&v23, 8) )
      {
LABEL_188:
        v10 = (const char *)1;
      }
      else
      {
        if ( fw_spchar_validate(&v23) )
        {
          v10 = 0;
        }
        else
        {
          v10 = (const char *)1;
          *((_DWORD *)v4 + 111) = atoi((const char *)&v23);
        }
        v11 = *((_DWORD *)v4 + 111);
        if ( v11 >= 0x10000 )
          v10 = 0;
        if ( *((_DWORD *)v4 + 110) > (signed int)v11 )
          v10 = 0;
      }
    }
    else
    {
      v10 = 0;
    }
LABEL_90:
    memset(&v23, 0, 0x200u);
    if ( v10 )
    {
      v10 = sub_3A764(v1, "src_addr_type", (int)&v23, 8);
      if ( v10 )
      {
        if ( fw_spchar_validate(&v23) )
        {
          v10 = 0;
        }
        else
        {
          v10 = (const char *)1;
          strcpy(&v25, (const char *)&v23);
        }
      }
    }
    memset(&v23, 0, 0x200u);
    if ( !v10 || !sub_3A764(v1, "dest_addr_type", (int)&v23, 8) || fw_spchar_validate(&v23) )
      goto LABEL_169;
    strcpy(&s1, (const char *)&v23);
    v12 = strcmp(&v25, "all") == 0;
    v13 = (char *)v4 + 8;
    if ( v12 )
    {
      strcpy(v13, "ip");
LABEL_121:
      if ( strcmp(&s1, "all") )
      {
        memset(&v23, 0, 0x200u);
        if ( sub_3A764(v1, "dest_start", (int)&v23, 32) )
        {
          if ( fw_spchar_validate(&v23) )
          {
            v14 = 0;
          }
          else
          {
            v14 = (const char *)1;
            strcpy((char *)v4 + 80, (const char *)&v23);
          }
          if ( validate_ipv4_addr((char *)v4 + 80) )
            v14 = 0;
        }
        else
        {
          v14 = (const char *)1;
        }
        memset(&v23, 0, 0x200u);
        if ( sub_3A764(v1, "dest_end", (int)&v23, 32) )
        {
          if ( fw_spchar_validate(&v23) )
          {
            v14 = 0;
          }
          else if ( v14 )
          {
            v14 = (const char *)1;
            strcpy((char *)v4 + 112, (const char *)&v23);
          }
          if ( validate_ipv4_addr((char *)v4 + 112) )
            v14 = 0;
        }
        goto LABEL_170;
      }
      goto LABEL_168;
    }
    strcpy(v13, &v25);
    v14 = (const char *)strcmp(&v25, "ip");
    if ( v14 )
    {
      v14 = (const char *)strcmp(&v25, "mac");
      if ( v14 )
        goto LABEL_169;
      memset(&v23, 0, 0x200u);
      if ( !sub_3A764(v1, (const char *)&unk_9C3EC, (int)&v23, 32) )
        goto LABEL_169;
      if ( !fw_spchar_validate(&v23) )
      {
        v14 = (const char *)1;
        strcpy((char *)v4 + 144, (const char *)&v23);
      }
      v15 = validate_mac_addr((char *)v4 + 144);
    }
    else
    {
      memset(&v23, 0, 0x200u);
      if ( sub_3A764(v1, (const char *)&unk_9C3EC, (int)&v23, 32) )
      {
        if ( !fw_spchar_validate(&v23) )
        {
          v14 = (const char *)1;
          strcpy((char *)v4 + 16, (const char *)&v23);
        }
        if ( validate_ipv4_addr((char *)v4 + 16) )
          v14 = 0;
      }
      else
      {
        v14 = 0;
      }
      memset(&v23, 0, 0x200u);
      if ( !sub_3A764(v1, "src_end", (int)&v23, 32) )
      {
LABEL_120:
        if ( !v14 )
        {
LABEL_170:
          v20 = 0;
          goto LABEL_180;
        }
        goto LABEL_121;
      }
      if ( fw_spchar_validate(&v23) )
      {
        v14 = 0;
      }
      else if ( v14 )
      {
        v14 = (const char *)1;
        strcpy((char *)v4 + 48, (const char *)&v23);
      }
      v15 = validate_ipv4_addr((char *)v4 + 48);
    }
    if ( !v15 )
      goto LABEL_120;
LABEL_169:
    v14 = 0;
    goto LABEL_170;
  }
  if ( !strcmp(&dest, "site") )
  {
    memset(&v23, 0, 0x200u);
    if ( !sub_3A764(v1, "src_addr_type", (int)&v23, 8) || (v14 = (const char *)fw_spchar_validate(&v23)) != 0 )
    {
      v14 = 0;
      goto LABEL_164;
    }
    strcpy(&v25, (const char *)&v23);
    v12 = strcmp(&v25, "all") == 0;
    v16 = (char *)v4 + 8;
    if ( v12 )
    {
      v14 = (const char *)1;
      strcpy(v16, "ip");
      goto LABEL_164;
    }
    strcpy(v16, &v25);
    v17 = strcmp(&v25, "ip");
    if ( v17 )
    {
      v19 = strcmp(&v25, "mac");
      if ( v19 )
        goto LABEL_164;
      memset(&v23, 0, 0x200u);
      v14 = sub_3A764(v1, (const char *)&unk_9C3EC, (int)&v23, 32);
      if ( !v14 )
        goto LABEL_164;
      if ( fw_spchar_validate(&v23) )
      {
        v14 = (const char *)v19;
      }
      else
      {
        v14 = (const char *)1;
        strcpy((char *)v4 + 144, (const char *)&v23);
      }
      v18 = validate_mac_addr((char *)v4 + 144);
    }
    else
    {
      memset(&v23, 0, 0x200u);
      v14 = sub_3A764(v1, (const char *)&unk_9C3EC, (int)&v23, 32);
      if ( v14 )
      {
        if ( fw_spchar_validate(&v23) )
        {
          v14 = (const char *)v17;
        }
        else
        {
          v14 = (const char *)1;
          strcpy((char *)v4 + 16, (const char *)&v23);
        }
        if ( validate_ipv4_addr((char *)v4 + 16) )
          v14 = 0;
      }
      memset(&v23, 0, 0x200u);
      if ( !sub_3A764(v1, "src_end", (int)&v23, 32) )
      {
LABEL_164:
        memset(&v23, 0, 0x200u);
        if ( !v14 )
          goto LABEL_170;
        v14 = sub_3A764(v1, "dest_start", (int)&v23, 256);
        if ( !v14 )
          goto LABEL_170;
        if ( !fw_spchar_validate(&v23) )
        {
          convert_url_to_new(&v23, (char *)v4 + 176);
LABEL_168:
          v14 = (const char *)1;
          goto LABEL_170;
        }
        goto LABEL_169;
      }
      if ( fw_spchar_validate(&v23) )
      {
        v14 = 0;
      }
      else if ( v14 )
      {
        v14 = (const char *)1;
        strcpy((char *)v4 + 48, (const char *)&v23);
      }
      v18 = validate_ipv4_addr((char *)v4 + 48);
    }
    if ( v18 )
      v14 = 0;
    goto LABEL_164;
  }
  v21 = strcmp(&dest, "wifi");
  if ( v21 )
  {
LABEL_181:
    v3 = 0;
    delete_fw_rule(0, v2);
    return v3;
  }
  memset(&v23, 0, 0x200u);
  v14 = sub_3A764(v1, "band", (int)&v23, 8);
  if ( v14 )
  {
    v14 = (const char *)(fw_spchar_validate(&v23) == 0);
    if ( !strcmp((const char *)&v23, "2g") || !strcmp((const char *)&v23, "5g") || !strcmp((const char *)&v23, "all") )
    {
      if ( v14 )
      {
        v14 = (const char *)1;
        strcpy((char *)v2 + 536, (const char *)&v23);
      }
    }
    else
    {
      v14 = (const char *)v21;
    }
  }
  v20 = 1;
LABEL_180:
  *((_DWORD *)v2 + 132) = v20;
  if ( !v14 )
    goto LABEL_181;
  return v3;
}
// 10790: using guessed type int __fastcall init_fw_rule(_DWORD);
// 107D8: using guessed type int __fastcall delete_fw_rule(_DWORD, _DWORD);
// 10ED4: using guessed type int __fastcall validate_mac_addr(_DWORD);
// 110A8: using guessed type int __fastcall validate_ipv4_addr(_DWORD);
// 111E0: using guessed type int __fastcall convert_url_to_new(_DWORD, _DWORD);
// 113FC: using guessed type int __fastcall init_fw_netfilter(_DWORD);
// 120B0: using guessed type int __fastcall fw_spchar_validate(_DWORD);

//----- (0003B534) --------------------------------------------------------
int __fastcall sub_3B534(int a1, int a2, int a3)
{
  int v3; // r7@1
  int v4; // r4@1
  const char *v5; // r3@1
  int v6; // lr@1
  const char *v7; // r5@3
  const char *v8; // r1@4
  void *v9; // r1@11
  const char *v10; // r0@11
  int v11; // r1@13
  int v12; // r0@13
  int v13; // r1@13
  const char *v14; // r0@13
  int v15; // r1@13
  int v16; // r0@13
  int v17; // r1@13
  const char *v18; // r0@13
  void *v19; // r3@14
  const char *v20; // r2@14
  char *v21; // r0@14
  void *v22; // r0@17
  int v23; // r1@18
  int v24; // r6@18
  int v25; // r5@20
  int v26; // r10@20
  int v27; // r0@21
  int v28; // r1@21
  int v29; // r1@22
  int v30; // r6@23
  int v31; // r7@24
  int v32; // r1@24
  int v33; // r5@28
  int v34; // r0@29
  char *v35; // r0@31
  int v37; // [sp+Ch] [bp-14Ch]@3
  int v38; // [sp+10h] [bp-148h]@3
  const char *v39; // [sp+14h] [bp-144h]@3
  int v40; // [sp+18h] [bp-140h]@3
  char s; // [sp+24h] [bp-134h]@6
  char dest; // [sp+124h] [bp-34h]@6
  char v43; // [sp+138h] [bp-20h]@33

  v3 = a3;
  v4 = a2;
  v5 = "true";
  v6 = *(_DWORD *)(a2 + 516);
  if ( *(_DWORD *)(a2 + 512) )
    v5 = "false";
  v7 = (const char *)(a2 + 536);
  v38 = *(_DWORD *)(a2 + 524);
  v39 = v5;
  v37 = *(_DWORD *)(a2 + 520);
  v40 = a2 + 536;
  printf("<TR height=\"24\" ID=\"%s\" class=\"fw_tr\" style=\"cursor:pointer; background-color:#%s;\" \t\tonclick=\"onClickedFWRule('%s','%s','','','','','','',0,0,'','','%s',%d,'%04d','%04d',%s,0,'%s');\">\n");
  if ( *(_DWORD *)(v4 + 512) )
    v8 = "#000000";
  else
    v8 = "#B4B4B4";
  strcpy(&dest, v8);
  printf(
    "<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"30\" style=\"color:%s; padding-left:5px;\"></TD>\n",
    &dest);
  puts("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"80\">");
  printf(
    "<a name=\"%s\" title=\"%s\" class=\"fw_a\" style=\"width:80px; color:%s;\">%s</a>\n",
    v4,
    v4,
    &dest,
    v4,
    "drop",
    v6,
    v37,
    v38,
    v39,
    v40);
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"80\" style=\"color:%s;\">\n", &dest);
  puts("<SPAN style=\"width:80px;\" class=\"fw_overflowable\" title=\"5G WiFi\">");
  memset(&s, 0, 0x100u);
  strcpy(&s, v7);
  if ( !strcmp(v7, "2g") )
    strcpy(&s, "2.4g");
  if ( !strcmp(v7, "all") )
    strcpy(&s, "all");
  sub_39E44(&s);
  printf("WiFi %s", &s);
  puts("</SPAN>");
  puts("</TD>");
  printf("<TD height=\"24\" align=\"center\" class=\"fw_td\" width=\"20\" style=\"color:%s;\">\n", &dest);
  if ( *(_DWORD *)(v4 + 512) )
  {
    v9 = get_image_dir();
    v10 = "<img src=\"/%s/fw_right_arrow.gif\">";
  }
  else
  {
    v9 = get_image_dir();
    v10 = "<img src=\"/%s/fw_right_arrow.gif\" class=\"fw_opacity_30\">";
  }
  printf(v10, v9);
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"90\" style=\"color:%s;\">\n", &dest);
  v12 = get_ux_text_common(298, v11);
  printf("<SPAN style=\"width:90px;\" class=\"fw_overflowable\" title=\"%s\">\n", v12);
  v14 = (const char *)get_ux_text_common(298, v13);
  printf(v14);
  puts("</SPAN>");
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"70\" style=\"color:%s;\">\n", &dest);
  puts("<SPAN style=\"width:70px;\" class=\"fw_overflowable\" title=\"ALL\">");
  printf("ALL");
  puts("</SPAN>");
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"30\" style=\"color:%s;\">\n", &dest);
  v16 = get_ux_text_common(329, v15);
  printf("<SPAN style=\"width:30px;\" class=\"fw_overflowable\" title=\"%s\">\n", v16);
  v18 = (const char *)get_ux_text_common(329, v17);
  printf(v18);
  printf("</SPAN>");
  puts("</TD>");
  printf("<TD height=\"24\" align=\"right\" class=\"fw_td\" width=\"15\" style=\"color:%s;\">\n", &dest);
  if ( *(_DWORD *)(v4 + 512) )
  {
    if ( v3 == 1 )
    {
      v19 = get_image_dir();
      v20 = "/%s/fw_play.gif";
      v21 = &s;
    }
    else
    {
      v22 = get_image_dir();
      v20 = "/%s/fw_pause.gif";
      v19 = v22;
      v21 = &s;
    }
  }
  else
  {
    v19 = get_image_dir();
    v20 = "/%s/fw_stop_gray.gif";
    v21 = &s;
  }
  snprintf(v21, 0x100u, v20, v19);
  printf("<img src=\"%s\" style=\"margin-right:3px; vertical-align:middle;\">\n", &s);
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"155\" style=\"color:%s;\">\n", &dest);
  memset(&s, 0, 0x100u);
  v24 = *(_DWORD *)(v4 + 520);
  if ( v24 )
  {
    v25 = calc_mask(*(_DWORD *)(v4 + 520), 100);
    sub_5B744(v24, 0x64u);
    v26 = v29;
  }
  else
  {
    if ( !*(_DWORD *)(v4 + 524) )
    {
      v27 = get_ux_text_common(300, v23);
      snprintf(&s, 0x100u, "%s ", v27);
      goto LABEL_27;
    }
    v25 = *(_DWORD *)(v4 + 520);
    v26 = *(_DWORD *)(v4 + 520);
  }
  v30 = *(_DWORD *)(v4 + 524);
  if ( v30 )
  {
    v31 = calc_mask(*(_DWORD *)(v4 + 524), 100);
    sub_5B744(v30, 0x64u);
  }
  else
  {
    v31 = 0;
    v32 = 0;
  }
  snprintf(&s, 0x100u, "%02d:%02d~%02d:%02d ", v25, v26, v31, v32);
LABEL_27:
  if ( *(_DWORD *)(v4 + 516) )
  {
    v33 = 0;
    do
    {
      if ( (*(_DWORD *)(v4 + 516) >> v33) & 1 )
      {
        v35 = sub_3A54C(v33, v28);
        snprintf(&s, 0x100u, "%s%s/", &s, v35);
      }
      ++v33;
    }
    while ( v33 != 7 );
    *(&v43 + strlen(&s) - 277) = 0;
  }
  else
  {
    v34 = get_ux_text_common(308, v28);
    snprintf(&s, 0x100u, "%s %s", &s, v34);
  }
  printf("<SPAN style=\"width:155px;\" class=\"fw_overflowable\" title=\"%s\">\n", &s);
  printf("%s", &s);
  puts("</SPAN>");
  puts("</TD>");
  printf("<TD height=\"24\" align=\"right\" class=\"fw_td\" style=\"%s\">\n");
  printf("<input type=\"checkbox\" name=\"delcheck\" value=\"%s\">\n", v4);
  puts("</TD>");
  return puts("</TR>");
}

//----- (0003BA78) --------------------------------------------------------
int __fastcall sub_3BA78(int a1, int a2, int a3)
{
  const char *v3; // r7@1
  int v4; // r5@1
  int v5; // r8@1
  const char *v6; // r1@2
  int v7; // r4@4
  const char *v8; // r3@4
  int v9; // r6@4
  const char *v10; // r11@4
  const char *v11; // r2@6
  char *v12; // r0@8
  int v13; // r0@8
  char *v14; // r12@8
  int v15; // r2@9
  bool v16; // zf@11
  int v17; // r3@16
  bool v18; // zf@20
  int v19; // r1@24
  const char *v20; // r0@26
  char *v21; // r0@28
  const char *v22; // r2@28
  int v23; // r3@28
  const char *v24; // r0@35
  void *v25; // r3@41
  const char *v26; // r2@41
  char *v27; // r0@41
  int v28; // r0@43
  int v29; // r3@43
  void *v30; // r0@49
  int v31; // r1@50
  const char *v32; // r0@53
  char *v33; // r0@55
  const char *v34; // r2@55
  int v35; // r3@55
  int v36; // r0@56
  char *v37; // r0@61
  const char *v38; // r1@61
  int v39; // r2@67
  bool v40; // zf@67
  char *v41; // r0@68
  const char *v42; // r2@68
  int v43; // r1@76
  int v44; // r0@77
  int v45; // r0@79
  void *v46; // r3@80
  const char *v47; // r2@80
  char *v48; // r0@80
  void *v49; // r0@83
  int v50; // r1@84
  int v51; // r6@84
  int v52; // r4@86
  int v53; // r8@86
  int v54; // r0@87
  int v55; // r1@87
  int v56; // r1@88
  int v57; // r6@89
  int v58; // r7@90
  int v59; // r1@90
  int v60; // r4@94
  int v61; // r0@95
  char *v62; // r0@97
  int v64; // [sp+0h] [bp-1A8h]@24
  int v65; // [sp+4h] [bp-1A4h]@24
  const char *v66; // [sp+54h] [bp-154h]@6
  const char *v67; // [sp+58h] [bp-150h]@8
  char *v68; // [sp+5Ch] [bp-14Ch]@8
  int v69; // [sp+60h] [bp-148h]@1
  char s; // [sp+6Ch] [bp-13Ch]@26
  char dest; // [sp+16Ch] [bp-3Ch]@4
  char v72; // [sp+180h] [bp-28h]@99

  v3 = *(const char **)(a2 + 512);
  v4 = a2;
  v5 = a1;
  v69 = a3;
  if ( v3 )
    v6 = "#000000";
  else
    v6 = "#B4B4B4";
  strcpy(&dest, v6);
  v7 = *(_DWORD *)(v4 + 532);
  v8 = "ffffff";
  v9 = *(_BYTE *)(v7 + 176);
  v10 = "drop";
  if ( !(v5 & 1) )
    v8 = "f7f7f7";
  v11 = "internet";
  v66 = v8;
  if ( *(_BYTE *)(v7 + 176) )
    v11 = "site";
  v67 = v11;
  v12 = sub_3A678(*(_DWORD *)(v4 + 532));
  v68 = v12;
  v13 = strcmp(v12, "ip");
  v14 = (char *)*(_BYTE *)(v7 + 80);
  if ( v13 )
    v15 = v7 + 144;
  else
    v15 = v7 + 16;
  v16 = v14 == 0;
  if ( !*(_BYTE *)(v7 + 80) )
    v14 = "all";
  if ( !v16 )
    v14 = "ip";
  if ( v9 )
    v17 = v7 + 176;
  else
    v17 = v7 + 80;
  if ( *(_DWORD *)(v7 + 448) == 1 )
    v10 = "accept";
  v18 = v3 == 0;
  if ( v3 )
    v3 = "false";
  if ( v18 )
    v3 = "true";
  printf(
    "<TR height=\"24\" ID=\"%s\" class=\"fw_tr\" style=\"cursor:pointer; background-color:#%s;\" \t\tonclick=\"onClickedF"
    "WRule('%s','%s','%s','%s','%s','%s','%s','%s',%d,%d,'%s','%s','%s',%d,'%04d','%04d',%s,%d);\">\n",
    v4,
    v66,
    v67,
    v4,
    v68,
    v15,
    v7 + 48,
    v14,
    v17,
    v7 + 112,
    *(_DWORD *)(v7 + 440),
    *(_DWORD *)(v7 + 444),
    v7,
    v7 + 432,
    v10,
    *(_DWORD *)(v4 + 516),
    *(_DWORD *)(v4 + 520),
    *(_DWORD *)(v4 + 524),
    v3,
    v5);
  printf(
    "<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"30\" style=\"color:%s; padding-left:5px;\">%d</TD>\n",
    &dest,
    v5);
  puts("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"80\">");
  printf("<a name=\"%s\" title=\"%s\" class=\"fw_a\" style=\"width:80px; color:%s;\">%s</a>\n", v4, v4, &dest, v4);
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"80\" style=\"color:%s;\">\n", &dest);
  if ( !strcmp((const char *)(v7 + 8), "ip") )
  {
    if ( *(_BYTE *)(v7 + 48) )
    {
      v20 = sub_3A6EC((char *)(v7 + 48));
      snprintf(&s, 0x100u, "%s~%d", v7 + 16, v20);
      goto LABEL_39;
    }
    if ( *(_BYTE *)(v7 + 16) )
    {
      v21 = &s;
      v22 = "%s";
      v23 = v7 + 16;
    }
    else
    {
      v23 = get_ux_text_common(298, v19);
      v22 = "%s";
      v21 = &s;
    }
    goto LABEL_32;
  }
  if ( !strcmp((const char *)(v7 + 8), "mac") )
  {
    v22 = "%s";
    v21 = &s;
    v23 = v7 + 144;
LABEL_32:
    snprintf(v21, 0x100u, v22, v23);
    goto LABEL_39;
  }
  if ( !strcmp((const char *)(v7 + 8), "ipmac") )
  {
    if ( *(_BYTE *)(v7 + 48) )
    {
      v24 = sub_3A6EC((char *)(v7 + 48));
      snprintf(&s, 0x100u, "%s~%d", v7 + 16, v24);
    }
    else
    {
      snprintf(&s, 0x100u, "%s", v7 + 16);
    }
    strcat(&s, "/");
    strcat(&s, (const char *)(v7 + 144));
  }
  else
  {
    strcpy(&s, "ERROR");
  }
LABEL_39:
  printf("<SPAN style=\"width:80px;\" class=\"fw_overflowable\" title=\"%s\">\n", &s);
  printf("%s", &s);
  puts("</SPAN>");
  puts("</TD>");
  printf("<TD height=\"24\" align=\"center\" class=\"fw_td\" width=\"20\" style=\"color:%s;\">\n", &dest);
  if ( !strcmp((const char *)v7, "inout") )
  {
    if ( *(_DWORD *)(v4 + 512) )
    {
      v25 = get_image_dir();
      v26 = "<img src=\"/%s/fw_right_arrow.gif\">";
      v27 = &s;
    }
    else
    {
      v25 = get_image_dir();
      v26 = "<img src=\"/%s/fw_right_arrow.gif\" class=\"fw_opacity_30\">";
      v27 = &s;
    }
  }
  else
  {
    v28 = strcmp((const char *)v7, "outin");
    v29 = *(_DWORD *)(v4 + 512);
    if ( v28 )
    {
      if ( v29 )
      {
        v25 = get_image_dir();
        v26 = "<img src=\"/%s/fw_both_arrow.gif\">";
        v27 = &s;
      }
      else
      {
        v30 = get_image_dir();
        v26 = "<img src=\"/%s/fw_both_arrow.gif\" class=\"fw_opacity_30\">";
        v25 = v30;
        v27 = &s;
      }
    }
    else if ( v29 )
    {
      v25 = get_image_dir();
      v26 = "<img src=\"/%s/fw_left_arrow.gif\">";
      v27 = &s;
    }
    else
    {
      v25 = get_image_dir();
      v26 = "<img src=\"/%s/fw_left_arrow.gif\" class=\"fw_opacity_30\">";
      v27 = &s;
    }
  }
  snprintf(v27, 0x100u, v26, v25);
  printf("%s", &s);
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"90\" style=\"color:%s;\">\n", &dest);
  if ( *(_BYTE *)(v7 + 176) )
  {
    strcpy(&s, (const char *)(v7 + 176));
  }
  else if ( *(_BYTE *)(v7 + 112) )
  {
    v32 = sub_3A6EC((char *)(v7 + 112));
    snprintf(&s, 0x100u, "%s~%d", v7 + 80, v32);
  }
  else
  {
    if ( *(_BYTE *)(v7 + 80) )
    {
      v33 = &s;
      v34 = "%s";
      v35 = v7 + 80;
    }
    else
    {
      v36 = get_ux_text_common(298, v31);
      v34 = "%s";
      v35 = v36;
      v33 = &s;
    }
    snprintf(v33, 0x100u, v34, v35);
  }
  printf("<SPAN style=\"width:90px;\" class=\"fw_overflowable\" title=\"%s\">\n", &s);
  printf("%s", &s);
  puts("</SPAN>");
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"70\" style=\"color:%s;\">\n", &dest);
  if ( *(_BYTE *)(v7 + 176) )
  {
    strcpy(&s, " ");
    goto LABEL_76;
  }
  if ( !strcmp((const char *)(v7 + 432), "none") )
  {
    v37 = &s;
    v38 = "all";
  }
  else
  {
    if ( strcmp((const char *)(v7 + 432), "icmp") && strcmp((const char *)(v7 + 432), "gre") )
    {
      if ( *(_DWORD *)(v7 + 440) )
      {
        v39 = *(_DWORD *)(v7 + 444);
        v40 = v39 == 0;
        if ( v39 )
        {
          v64 = *(_DWORD *)(v7 + 444);
          v41 = &s;
          v42 = "%d~%d(%s)";
        }
        else
        {
          v41 = &s;
          v42 = "%d(%s)";
        }
        if ( v40 )
          v64 = v7 + 432;
        else
          v65 = v7 + 432;
        snprintf(v41, 0x100u, v42);
      }
      else
      {
        snprintf(&s, 0x100u, "%s", v7 + 432);
      }
      goto LABEL_75;
    }
    v37 = &s;
    v38 = (const char *)(v7 + 432);
  }
  strcpy(v37, v38);
LABEL_75:
  sub_39E44(&s);
LABEL_76:
  printf("<SPAN style=\"width:70px;\" class=\"fw_overflowable\" title=\"%s\">\n", &s);
  printf("%s", &s);
  puts("</SPAN>");
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"30\" style=\"color:%s;\">\n", &dest);
  if ( *(_DWORD *)(v7 + 448) == 1 )
    v44 = 328;
  else
    v44 = 329;
  v45 = get_ux_text_common(v44, v43);
  snprintf(&s, 0x100u, "%s", v45, v64, v65);
  printf("<SPAN style=\"width:30px;\" class=\"fw_overflowable\" title=\"%s\">%s<SPAN>", &s, &s);
  puts("</TD>");
  printf("<TD height=\"24\" align=\"right\" class=\"fw_td\" style=\"color:%s; width:15px;\">\n", &dest);
  if ( *(_DWORD *)(v4 + 512) )
  {
    if ( v69 == 1 )
    {
      v46 = get_image_dir();
      v47 = "/%s/fw_play.gif";
      v48 = &s;
    }
    else
    {
      v49 = get_image_dir();
      v47 = "/%s/fw_pause.gif";
      v46 = v49;
      v48 = &s;
    }
  }
  else
  {
    v46 = get_image_dir();
    v47 = "/%s/fw_stop_gray.gif";
    v48 = &s;
  }
  snprintf(v48, 0x100u, v47, v46);
  printf("<img src=\"%s\" style=\"margin-right:3px; vertical-align:middle;\">\n", &s);
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"155\" style=\"color:%s;\">\n", &dest);
  memset(&s, 0, 0x100u);
  v51 = *(_DWORD *)(v4 + 520);
  if ( v51 )
  {
    v52 = calc_mask(*(_DWORD *)(v4 + 520), 100);
    sub_5B744(v51, 0x64u);
    v53 = v56;
  }
  else
  {
    if ( !*(_DWORD *)(v4 + 524) )
    {
      v54 = get_ux_text_common(300, v50);
      snprintf(&s, 0x100u, "%s ", v54);
      goto LABEL_93;
    }
    v52 = *(_DWORD *)(v4 + 520);
    v53 = *(_DWORD *)(v4 + 520);
  }
  v57 = *(_DWORD *)(v4 + 524);
  if ( v57 )
  {
    v58 = calc_mask(*(_DWORD *)(v4 + 524), 100);
    sub_5B744(v57, 0x64u);
  }
  else
  {
    v58 = 0;
    v59 = 0;
  }
  snprintf(&s, 0x100u, "%02d:%02d~%02d:%02d ", v52, v53, v58, v59);
LABEL_93:
  if ( *(_DWORD *)(v4 + 516) )
  {
    v60 = 0;
    do
    {
      if ( (*(_DWORD *)(v4 + 516) >> v60) & 1 )
      {
        v62 = sub_3A54C(v60, v55);
        snprintf(&s, 0x100u, "%s%s/", &s, v62);
      }
      ++v60;
    }
    while ( v60 != 7 );
    *(&v72 + strlen(&s) - 277) = 0;
  }
  else
  {
    v61 = get_ux_text_common(308, v55);
    snprintf(&s, 0x100u, "%s %s", &s, v61);
  }
  printf("<SPAN style=\"width:155px;\" class=\"fw_overflowable\" title=\"%s\">\n", &s);
  printf("%s", &s);
  puts("</SPAN>");
  puts("</TD>");
  printf("<TD height=\"24\" align=\"right\" class=\"fw_td\" style=\"%s\">\n");
  printf("<input type=\"checkbox\" name=\"delcheck\" value=\"%s\">\n", v4);
  puts("</TD>");
  return printf("</TR>");
}

//----- (0003C3C8) --------------------------------------------------------
int __fastcall sub_3C3C8(int a1, int a2)
{
  int v2; // r3@1
  int result; // r0@1
  int v4; // r2@4
  int v5; // r2@8

  v2 = a1;
  result = a2;
  if ( a2 )
  {
    result = 0;
    while ( v2 )
    {
      v5 = *(_DWORD *)(v2 + 528);
      v2 = *(_DWORD *)(v2 + 544);
      if ( v5 == 1 )
        ++result;
    }
  }
  else
  {
    while ( v2 )
    {
      v4 = *(_DWORD *)(v2 + 528);
      v2 = *(_DWORD *)(v2 + 544);
      if ( !v4 )
        ++result;
    }
  }
  return result;
}

//----- (0003C414) --------------------------------------------------------
int __fastcall sub_3C414(int a1)
{
  int v1; // r6@1
  int v2; // r4@1

  v1 = a1;
  v2 = lock_file("/var/run/stat_fw.set");
  fw_read_status("/var/run/stat_fw.set", v1);
  return unlock_file(v2);
}
// 10AB4: using guessed type int __fastcall fw_read_status(_DWORD, _DWORD);
// 1211C: using guessed type int __fastcall lock_file(_DWORD);

//----- (0003C448) --------------------------------------------------------
signed int __fastcall sub_3C448(const char *a1)
{
  const char *v1; // r4@1
  const char *v2; // r0@2
  void *v3; // r5@4
  int v4; // r0@5
  const char *v5; // r1@5
  signed int v6; // r3@5
  void *v7; // r2@5
  const char *v8; // r0@5
  int v9; // r0@7
  int v10; // r0@10
  const char *v11; // r1@10
  signed int v12; // r3@10
  void *v13; // r2@10
  const char *v14; // r0@10
  signed int v15; // r4@13
  int v16; // r0@14
  int v17; // r6@14
  int *v18; // r8@15
  int v19; // r5@16
  int v20; // r7@16
  char *v21; // r0@20
  const char *v22; // r11@23
  char *v23; // r0@23
  signed int v24; // r5@25
  char *v25; // r0@26
  void *v26; // r7@30
  _BYTE *v27; // r3@30
  signed int i; // r2@30
  _BYTE *v29; // r1@31
  int v30; // t1@31
  int *v31; // r0@37
  int v32; // r0@40
  int v34; // [sp+0h] [bp-19248h]@15
  char v35; // [sp+19000h] [bp-248h]@4
  int v36; // [sp+19200h] [bp-48h]@2

  v1 = a1;
  if ( !a1 )
    return -1;
  memset(&v36, 0, 0x20u);
  v2 = sub_3A764(v1, "act", (int)&v36, 32);
  if ( v2 )
  {
    if ( !strcmp((const char *)&v36, "add") )
    {
      v3 = sub_3A89C(v1);
      memset(&v35, 0, 0x200u);
      if ( sub_3A764(v1, "priority", (int)&v35, 32) )
      {
        v4 = atoi(&v35);
        v5 = "/var/run/stat_fw.set";
        v6 = v4;
        v7 = v3;
        v8 = "user_fw";
      }
      else
      {
        v8 = "user_fw";
        v7 = v3;
        v5 = "/var/run/stat_fw.set";
        v6 = 200;
      }
      v9 = fw_add_db(v8, v5, v7, v6);
LABEL_13:
      v15 = v9;
      v2 = (const char *)sub_3A754((int)v3);
      goto LABEL_40;
    }
    if ( !strcmp((const char *)&v36, "modify") )
    {
      v3 = sub_3A89C(v1);
      memset(&v35, 0, 0x200u);
      if ( sub_3A764(v1, "priority", (int)&v35, 32) )
      {
        v10 = atoi(&v35);
        v11 = "/var/run/stat_fw.set";
        v12 = v10;
        v13 = v3;
        v14 = "user_fw";
      }
      else
      {
        v14 = "user_fw";
        v13 = v3;
        v11 = "/var/run/stat_fw.set";
        v12 = -1;
      }
      v9 = fw_modify_db(v14, v11, v13, v12);
      goto LABEL_13;
    }
    v16 = strcmp((const char *)&v36, "del");
    v17 = v16;
    if ( v16 )
      return -1;
    v18 = &v34;
    memset(&v34, 0, 0x19000u);
    while ( 1 )
    {
      v19 = (int)v1;
      v20 = 0;
      while ( 1 )
      {
        if ( strncmp((const char *)v19, "delcheck", 8u) )
          goto LABEL_20;
        if ( v20 == v17 )
          break;
        ++v20;
LABEL_20:
        v21 = strchr((const char *)v19, 38);
        if ( !v21 )
          goto LABEL_38;
        v19 = (int)(v21 + 1);
      }
      if ( v19 )
      {
        v22 = (const char *)(v19 + 9);
        v23 = strchr((const char *)(v19 + 9), 38);
        if ( !v23 )
          v23 = (char *)&v22[strlen((const char *)(v19 + 9))];
        v24 = v23 - v22;
        if ( v23 != v22 )
        {
          v25 = strchr(v22, 37);
          if ( v24 >= 511 )
            v24 = 511;
          if ( v25 )
            v24 *= 3;
          v26 = malloc(v24 + 1);
          memcpy(v26, v22, v24);
          *((_BYTE *)v26 + v24) = 0;
          v27 = v26;
          for ( i = 0; i < v24; ++i )
          {
            v29 = v27;
            v30 = *v27++;
            if ( v30 == 43 )
              *(v27 - 1) = 32;
            if ( *(v27 - 1) == 38 )
            {
              *v29 = 0;
              break;
            }
          }
          ++v17;
          decode_string(v26);
          v31 = v18;
          v18 += 128;
          sf_strncpy(v31, v26, 512);
          free(v26);
          if ( v17 != 200 )
            continue;
        }
      }
LABEL_38:
      v2 = (const char *)fw_delete_rules("user_fw", "/var/run/stat_fw.set", &v34, v17);
      v15 = (signed int)v2;
      goto LABEL_40;
    }
    return -1;
  }
  v15 = -1;
LABEL_40:
  v32 = signal_update(v2);
  signal_save(v32);
  return v15;
}
// 103F4: using guessed type int __fastcall fw_add_db(_DWORD, _DWORD, _DWORD, _DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 109C4: using guessed type int __fastcall decode_string(_DWORD);
// 11D08: using guessed type int __fastcall fw_delete_rules(_DWORD, _DWORD, _DWORD, _DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);
// 11F9C: using guessed type int __fastcall fw_modify_db(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0003C758) --------------------------------------------------------
int __fastcall print_iframe_firewall(int a1, const char *a2)
{
  int v2; // r4@1
  const char *v3; // r8@1
  const char *v4; // r4@1
  int v5; // r6@6
  int v6; // r7@6
  int v7; // r5@6
  int v8; // r2@7
  int v9; // r6@10
  int v10; // r0@11
  int v11; // r2@16
  int v12; // r0@17
  int v13; // r5@22
  int v14; // r7@22
  int v15; // r6@26
  signed int v16; // r7@27
  int v17; // r5@27
  int v18; // r1@29
  int v19; // r2@29
  int v20; // r0@29
  int v21; // r7@34
  int result; // r0@38
  int i; // r5@39
  int v24; // r6@42
  int v25; // r7@42
  int v26; // r0@45
  int v27; // r1@51
  int v28; // r2@51
  int v29; // r0@51
  int v30; // r5@56
  int v31; // r7@56
  int v32; // r5@60
  signed int j; // r3@60
  int v34; // r1@66
  int v35; // r1@68
  const char *v36; // r0@68
  bool v37; // nf@70
  unsigned __int8 v38; // vf@70
  int v39; // r4@76
  const char *v40; // r2@76
  int v41; // r6@76
  char *v42; // r0@78
  int v43; // r0@78
  int v44; // r2@78
  char *v45; // r8@78
  bool v46; // zf@82
  int v47; // r3@87
  const char *v48; // r0@89
  const char *v49; // r9@91
  const char *v50; // r3@96
  const char *v51; // r0@99
  signed int v52; // [sp+4Ch] [bp-3ACh]@4
  const char *v53; // [sp+50h] [bp-3A8h]@78
  char *v54; // [sp+54h] [bp-3A4h]@78
  char s; // [sp+60h] [bp-398h]@1
  char v56; // [sp+384h] [bp-74h]@65
  char v57; // [sp+3A4h] [bp-54h]@2
  char v58; // [sp+3C3h] [bp-35h]@3
  int v59; // [sp+3C4h] [bp-34h]@1
  int v60; // [sp+3C8h] [bp-30h]@1
  int v61; // [sp+3CCh] [bp-2Ch]@1

  v2 = a1;
  v3 = a2;
  memset(&s, 0, 0x324u);
  v59 = 0;
  v60 = 0;
  v61 = 0;
  print_js_file((int)"firewallconf", (int)"firewall");
  sub_39F78();
  v4 = (const char *)get_parameter_value(v2, "mode");
  if ( !v4 )
  {
    memset(&v57, 0, 0x20u);
    if ( sub_3A764(v3, "view_mode", (int)&v57, 32) )
    {
      v58 = (char)v4;
      v4 = &v57;
    }
  }
  printf("<BODY style=\"padding:0px 0px 0px 0px; margin:0px 0px 0px 0px;\">");
  printf("<form method=post action=\"timepro.cgi\" name=\"firewall_iframe_fm\" style=\"margin:0px 0px 0px 0px; padding:0px 0px 0px 0px;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"firewall\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  printf("<input type=hidden name=\"view_mode\" value=\"%s\">");
  printf("<input type=hidden name=\"mode\" value=\"\">");
  printf("<input type=hidden name=\"name\" value=\"\">");
  printf("<input type=hidden name=\"src_addr_type\" value=\"\">");
  printf("<input type=hidden name=\"src_start\" value=\"\">");
  printf("<input type=hidden name=\"src_end\" value=\"\">");
  printf("<input type=hidden name=\"dest_addr_type\" value=\"\">");
  printf("<input type=hidden name=\"dest_start\" value=\"\">");
  printf("<input type=hidden name=\"dest_end\" value=\"\">");
  printf("<input type=hidden name=\"sport\" value=\"\">");
  printf("<input type=hidden name=\"eport\" value=\"\">");
  printf("<input type=hidden name=\"direction\" value=\"\">");
  printf("<input type=hidden name=\"protocol\" value=\"\">");
  printf("<input type=hidden name=\"policy\" value=\"\">");
  printf("<input type=hidden name=\"days\" value=\"\">");
  printf("<input type=hidden name=\"stime\" value=\"\">");
  printf("<input type=hidden name=\"etime\" value=\"\">");
  printf("<input type=hidden name=\"disabled\" value=\"\">");
  printf("<input type=hidden name=\"priority\" value=\"\">");
  printf("<input type=hidden name=\"old_priority\" value=\"\">");
  printf("<input type=hidden name=\"band\" value=\"\">");
  printf("<table style=\"table-layout:fixed; border-collapse:collapse; border-style:none none none none; width:100%%;\">\n");
  printf("<COL WIDTH=\"45\"><COL WIDTH=\"65\"><COL WIDTH=\"80\"><COL WIDTH=\"20\">\t\t<COL WIDTH=\"90\"><COL WIDTH=\"70\"><COL WIDTH=\"30\"><COL WIDTH=\"15\"><COL WIDTH=\"155\"><COL WIDTH=\"%%\">\n");
  v52 = sub_3C448(v3);
  if ( !v4 || !strncmp(v4, "all", 3u) )
  {
    v5 = 1;
    v6 = 0;
    sub_3C414((int)&s);
    fw_read_db("user_fw", &v59);
    v7 = v60;
    while ( v7 && !*(_DWORD *)(v7 + 528) )
    {
      v8 = sub_3A620((const char **)&s, (const char *)v7) != 0;
      sub_3BA78(v5, v7, v8);
      v7 = *(_DWORD *)(v7 + 544);
      ++v6;
      ++v5;
    }
    v9 = v6;
    printf("<TR height=\"0\" id=\"_-guard_line\" class=\"fw_tr\" style=\"display:none;\">");
    printf((const char *)&unk_9D189);
    while ( 1 )
    {
      if ( !v7 || *(_DWORD *)(v7 + 528) != 1 )
      {
        v13 = 0;
        free_fw_status_list(&s);
        sub_39EA4(0);
        v14 = 15 - v6;
        while ( v13 < v14 )
        {
          ++v13;
          sub_39E6C();
        }
        goto LABEL_59;
      }
      v10 = strcmp((const char *)(v7 + 536), "2g");
      if ( v10 )
      {
        if ( strcmp((const char *)(v7 + 536), "5g") )
          goto LABEL_16;
        v10 = 1;
      }
      if ( check_wireless_ifrun(v10) )
      {
LABEL_16:
        v11 = sub_3A620((const char **)&s, (const char *)v7);
        ++v9;
        if ( v11 )
        {
          v12 = v9;
          v11 = 1;
        }
        else
        {
          v12 = v9;
        }
        ++v6;
        sub_3B534(v12, v7, v11);
        v7 = *(_DWORD *)(v7 + 544);
      }
      else
      {
        v7 = *(_DWORD *)(v7 + 544);
      }
    }
  }
  v15 = strncmp(v4, "internet", 8u);
  if ( v15 )
  {
    result = strncmp(v4, "wifi", 4u);
    if ( result )
      return result;
    sub_3C414((int)&s);
    fw_read_db("user_fw", &v59);
    for ( i = v60; i && !*(_DWORD *)(i + 528); i = *(_DWORD *)(i + 544) )
      ;
    v24 = 0;
    v25 = 0;
    while ( 1 )
    {
      if ( !i || *(_DWORD *)(i + 528) != 1 )
      {
        sub_39EA4(2u);
        v30 = 0;
        v31 = 15 - v25;
        while ( v30 < v31 )
        {
          ++v30;
          sub_39E6C();
        }
        goto LABEL_59;
      }
      v26 = strcmp((const char *)(i + 536), "2g");
      if ( v26 )
      {
        if ( strcmp((const char *)(i + 536), "5g") )
          goto LABEL_50;
        v26 = 1;
      }
      if ( check_wireless_ifrun(v26) )
      {
LABEL_50:
        ++v24;
        if ( sub_3A620((const char **)&s, (const char *)i) )
        {
          sub_3C3C8(v60, 1);
          v27 = i;
          v28 = 1;
          v29 = v24;
        }
        else
        {
          sub_3C3C8(v60, 1);
          v27 = i;
          v28 = 0;
          v29 = v24;
        }
        sub_3B534(v29, v27, v28);
        i = *(_DWORD *)(i + 544);
        ++v25;
      }
      else
      {
        i = *(_DWORD *)(i + 544);
      }
    }
  }
  v16 = 1;
  sub_3C414((int)&s);
  fw_read_db("user_fw", &v59);
  v17 = v60;
  while ( v17 && !*(_DWORD *)(v17 + 528) )
  {
    if ( sub_3A620((const char **)&s, (const char *)v17) )
    {
      sub_3C3C8(v60, 0);
      v18 = v17;
      v19 = 1;
      v20 = v16;
    }
    else
    {
      sub_3C3C8(v60, 0);
      v18 = v17;
      v19 = 0;
      v20 = v16;
    }
    sub_3BA78(v20, v18, v19);
    v17 = *(_DWORD *)(v17 + 544);
    ++v15;
    ++v16;
  }
  free_fw_status_list(&s);
  sub_39EA4(1u);
  v21 = 0;
  while ( v21 < 15 - v15 )
  {
    ++v21;
    sub_39E6C();
  }
LABEL_59:
  printf((const char *)&unk_97FC6);
  puts("<SCRIPT language=\"javascript\">");
  puts((const char *)&unk_98524);
  puts("function onNewLineClicked(mode){");
  puts("\tvar obj = document.getElementById(\"_-new_line\");");
  puts("\tif(obj){ \n\tobj.scrollIntoView(true);");
  puts("\tif(mode){");
  puts("\t\tonClickedFWRule(mode,'','','','','','','','','','','','','','','','','');\n}");
  puts("\telse{");
  puts("\t\tonClickedFWRule('internet','','','','','','','','','','','','','','','','','');\n}");
  puts("\t}\n}");
  if ( v52 == -1 )
  {
    if ( !v4 || !strcmp(v4, "all") )
      printf("onNewLineClicked();");
    else
      printf("onNewLineClicked('%s');", v4);
    memset(&v56, 0, 0x20u);
    if ( !sub_3A764(v3, "act", (int)&v56, 32) || strcmp(&v56, "add") || v59 <= 199 )
      goto LABEL_106;
    v35 = get_ux_text_common(327, v34);
    v36 = "alert('%s');";
  }
  else
  {
    v32 = v60;
    for ( j = 1; ; ++j )
    {
      v38 = 0;
      v37 = v32 < 0;
      if ( v32 )
      {
        v38 = __OFSUB__(j, v52);
        v37 = j - v52 < 0;
      }
      if ( !(v37 ^ v38) )
        break;
      v32 = *(_DWORD *)(v32 + 544);
    }
    if ( v32 )
    {
      if ( *(_DWORD *)(v32 + 528) )
      {
        if ( strcmp(v4, "internet") )
        {
          v50 = "true";
          if ( *(_DWORD *)(v32 + 512) )
            v50 = "false";
          printf(
            "onClickedFWRule('%s','%s','','','','','','',0,0,'','','%s',%d,'%04d','%04d',%s,0,'%s');",
            "wifi",
            v32,
            "drop",
            *(_DWORD *)(v32 + 516),
            *(_DWORD *)(v32 + 520),
            *(_DWORD *)(v32 + 524),
            v50,
            v32 + 536);
          goto LABEL_99;
        }
      }
      else if ( strcmp(v4, "wifi") )
      {
        v39 = *(_DWORD *)(v32 + 532);
        v40 = "internet";
        v41 = *(_BYTE *)(v39 + 176);
        if ( *(_BYTE *)(v39 + 176) )
          v40 = "site";
        v53 = v40;
        v42 = sub_3A678(*(_DWORD *)(v32 + 532));
        v54 = v42;
        v43 = strcmp(v42, "ip");
        v45 = (char *)*(_BYTE *)(v39 + 80);
        if ( !v43 )
          v44 = v39 + 16;
        if ( v43 )
          v44 = v39 + 144;
        v46 = v45 == 0;
        if ( !*(_BYTE *)(v39 + 80) )
          v45 = "all";
        if ( !v46 )
          v45 = "ip";
        if ( v41 )
          v47 = v39 + 176;
        else
          v47 = v39 + 80;
        v48 = "drop";
        if ( *(_DWORD *)(v39 + 448) == 1 )
          v48 = "accept";
        v49 = "false";
        if ( !*(_DWORD *)(v32 + 512) )
          v49 = "true";
        printf(
          "onClickedFWRule('%s','%s','%s','%s','%s','%s','%s','%s',%d,%d,'%s','%s','%s',%d,'%04d','%04d',%s,%d);",
          v53,
          v32,
          v54,
          v44,
          v39 + 48,
          v45,
          v47,
          v39 + 112,
          *(_DWORD *)(v39 + 440),
          *(_DWORD *)(v39 + 444),
          v39,
          v39 + 432,
          v48,
          *(_DWORD *)(v32 + 516),
          *(_DWORD *)(v32 + 520),
          *(_DWORD *)(v32 + 524),
          v49,
          v52);
        goto LABEL_99;
      }
      printf("onNewLineClicked('%s');", v4);
LABEL_99:
      printf("\tvar obj = document.getElementById('%s');", v32);
      v51 = "\tif(obj) obj.scrollIntoView(true);";
LABEL_105:
      printf(v51);
      goto LABEL_106;
    }
    if ( !v4 || !strcmp(v4, "all") )
    {
      v51 = "onNewLineClicked();";
      goto LABEL_105;
    }
    v36 = "onNewLineClicked('%s');";
    v35 = (int)v4;
  }
  printf(v36, v35);
LABEL_106:
  printf("parent.document.firewall_fm.rule_count.value = %d;", v59);
  printf("onLoadCompleted(parent.document);");
  printf("</SCRIPT>");
  printf("</BODY>");
  return free_fw_list(&v59);
}
// 10964: using guessed type int __fastcall free_fw_list(_DWORD);
// 10F4C: using guessed type int __fastcall free_fw_status_list(_DWORD);
// 115E8: using guessed type int __fastcall fw_read_db(_DWORD, _DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 11C30: using guessed type int __fastcall check_wireless_ifrun(_DWORD);

//----- (0003D11C) --------------------------------------------------------
int print_iframe_macsearch_firewall()
{
  void *v0; // r4@1
  int v1; // r7@1
  int v2; // r1@1
  int v3; // r0@1
  char *v4; // r0@1
  void *v5; // r8@2
  int i; // r6@2
  int v7; // r0@4
  char *v8; // r0@9
  char *v9; // r0@10
  void *v10; // r5@10
  int v11; // r1@10
  int v12; // r6@10
  int v13; // r0@18
  char v15; // [sp+4h] [bp-64h]@1
  char v16; // [sp+18h] [bp-50h]@1
  char v17; // [sp+2Ch] [bp-3Ch]@1

  sub_39F78();
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"firewall_maclist_fm\" style=\"margin:0; border:0; padding:0;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"macsearch_firewall\">");
  printf("<table class=v3_table height=22>");
  v0 = malloc(0xBC00u);
  memset(v0, 0, 0xBC00u);
  v1 = get_hostinfo_from_arp("br0", 256, v0);
  get_ifconfig((int)"br0", (int)&v16, (int)&v15);
  puts("<select name=\"macselect\" class=\"fw_select\" style=\"width:145px; overflow:hidden;\" \t\tonchange=\"parent.onClickedMacSelect(parent.document);\">");
  v3 = get_ux_text_common(322, v2);
  printf("<option value=\"none\">%s</option>", v3);
  v4 = getenv("REMOTE_ADDR");
  get_internal_pc_hardware_address(v4, &v17);
  if ( v17 )
  {
    v5 = v0;
    for ( i = 0; i < v1; ++i )
    {
      v7 = strcmp((const char *)v5 + 148, &v17);
      v5 = (char *)v5 + 188;
      if ( !v7 )
      {
        if ( !dhcpd_search_static_lease(0, &v17) )
        {
          v8 = getenv("REMOTE_ADDR");
          printf((const char *)&unk_9D4AD, &v17, &v17, v8);
        }
        break;
      }
    }
  }
  v9 = getenv("REMOTE_ADDR");
  v10 = v0;
  get_internal_pc_hardware_address(v9, &v17);
  v12 = 0;
  while ( v12 < v1 )
  {
    if ( !dhcpd_search_static_lease((char *)v10 + 128, 0)
      && !dhcpd_search_static_lease(0, (char *)v10 + 148)
      && strcmp(&v17, (const char *)v10 + 148)
      && check_same_network((char *)v10 + 128, &v16, &v15) )
    {
      printf((const char *)&unk_9D4AD, (char *)v10 + 148, (char *)v10 + 148, (char *)v10 + 128);
    }
    ++v12;
    v10 = (char *)v10 + 188;
  }
  v13 = get_ux_text_common(334, v11);
  printf("<option value=\"search\">%s</option>", v13);
  printf("</select>");
  free(v0);
  printf((const char *)&unk_97FC6);
  return printf("</BODY>");
}
// 107B4: using guessed type int __fastcall get_hostinfo_from_arp(_DWORD, _DWORD, _DWORD);
// 108F8: using guessed type int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD);
// 11E1C: using guessed type int __fastcall check_same_network(_DWORD, _DWORD, _DWORD);
// 11E34: using guessed type int __fastcall dhcpd_search_static_lease(_DWORD, _DWORD);

//----- (0003D33C) --------------------------------------------------------
int __fastcall sub_3D33C(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r1@2
  int v8; // r0@3
  int v9; // r0@5
  int v10; // r0@5
  int v11; // r0@5
  int v13; // [sp+0h] [bp-88h]@1

  v2 = a2;
  sub_39F78();
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"firewall_file_fm\" enctype=\"multipart/form-data\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"restore_firewall\">");
  printf("<input type=\"hidden\" name=\"commit\" value=\"fw_restore\">");
  printf("<table class=v3_table height=26>");
  printf("<tr class=\"fw_tr\"><td width=\"10\" class=\"fw_td\"></td><td width=94 class=\"fw_td\">");
  v4 = get_ux_text_common(337, v3);
  printf(
    "<input type=button name=\"saverulebtn\" value=\"%s\" onclick=\"self.location.href='download_firewall.cgi'\" ",
    v4);
  printf("class=\"fw_button\" style=\"width:94px; text-align:center;\"></td>");
  v6 = get_ux_text_common(333, v5);
  printf("<td width=94><input type=button value=\"%s\" onclick=\"parent.Firewall_Restore();\" ", v6);
  printf("class=\"fw_button\" style=\"width:94px; text-align:center;\"></td>");
  printf("<td><input type=file name=\"fw_restore_file\" maxlength=100 style=\"padding:1 0 1 0; margin:0 0 0 5;\"></td>");
  printf((const char *)&unk_97FC1);
  printf("</BODY>");
  printf("<script>");
  if ( get_value_post_multipart(v2, "commit", &v13, 128) )
  {
    if ( firewall_update_by_file("/tmp/user_fw.set.tmp", "/var/run/stat_fw.set", "user_fw") == -1 )
      v8 = 379;
    else
      v8 = 380;
    v9 = get_ux_text_common(v8, v7);
    printf("alert('%s');", v9);
    printf("parent.UnMaskIt(parent.document,'restore_mask');");
    v10 = printf("parent.onChangedFWView(parent.parent.frames[3].document.getElementById('fw_select_menu').value);");
    v11 = signal_update(v10);
    signal_save(v11);
  }
  printf("parent.onLoadCompleted(parent.document);");
  return printf("</script>");
}
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10CA0: using guessed type int __fastcall firewall_update_by_file(_DWORD, _DWORD, _DWORD);
// 111B0: using guessed type int __fastcall get_value_post_multipart(_DWORD, _DWORD, _DWORD, _DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);

//----- (0003D4B0) --------------------------------------------------------
FILE *__fastcall firmwareReset(int a1, int a2)
{
  FILE *result; // r0@1
  FILE *v3; // r4@1
  char v4; // [sp+8h] [bp-90h]@1
  void *ptr; // [sp+88h] [bp-10h]@1
  size_t n; // [sp+8Ch] [bp-Ch]@1

  n = 0;
  get_value_post_multipart_file(a2, "fw_restore_file", &ptr, &v4);
  result = fopen("/tmp/user_fw.set.tmp", "w+");
  v3 = result;
  if ( !result )
    return result;
  fwrite(ptr, 1u, n, result);
  result = (FILE *)fclose(v3);
  return result;
}
// 11018: using guessed type int __fastcall get_value_post_multipart_file(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0003D528) --------------------------------------------------------
int __fastcall firewallconf_firewall(const char *a1)
{
  const char *v1; // r4@1
  int result; // r0@1
  int v3; // r1@2
  int v4; // r0@2
  int v5; // r1@2
  int v6; // r0@2
  int v7; // r1@2
  int v8; // r0@2
  int v9; // r1@2
  int v10; // r0@2
  int v11; // r1@2
  int v12; // r0@2
  int v13; // r1@2
  int v14; // r0@2
  int v15; // r1@2
  int v16; // r0@2
  void *v17; // r5@2
  int v18; // r1@2
  int v19; // r0@2
  const char *v20; // r0@3
  char *v21; // r5@5
  char *v22; // r0@5
  const char *v23; // r1@5
  char *v24; // r0@10
  int v25; // r0@11
  void *v26; // r0@13
  int v27; // r1@13
  int v28; // r0@15
  int v29; // r1@15
  int v30; // r0@15
  int v31; // r1@15
  int v32; // r1@16
  int v33; // r0@17
  int v34; // r1@17
  int v35; // r1@17
  const char *v36; // r0@17
  int v37; // r1@21
  int v38; // r0@21
  int v39; // r1@21
  int v40; // r0@21
  void *v41; // r0@21
  int v42; // r1@21
  int v43; // r0@21
  int v44; // r1@21
  int v45; // r0@21
  int v46; // r1@21
  int v47; // r0@21
  void *v48; // r0@21
  int v49; // r1@21
  int v50; // r0@22
  int v51; // r1@23
  int v52; // r0@24
  int v53; // r0@25
  void *v54; // r4@25
  int v55; // r1@25
  int v56; // r0@25
  void *v57; // r0@25
  int v58; // r1@25
  int v59; // r0@25
  int v60; // r1@25
  int v61; // r0@25
  int v62; // r1@25
  int v63; // r0@25
  int v64; // r1@25
  int v65; // r0@25
  int v66; // r4@25
  char *v67; // r0@28
  int v68; // r0@29
  int v69; // r4@31
  void *v70; // r0@31
  void *v71; // r0@31
  void *v72; // r0@31
  int v73; // r1@31
  int v74; // r0@31
  int v75; // r1@31
  int v76; // r0@31
  int v77; // r1@31
  int v78; // r0@31
  void *v79; // r0@31
  int v80; // r1@31
  int v81; // r0@31
  int v82; // r1@31
  int v83; // r0@31
  char *v84; // r7@32
  char *v85; // r6@32
  char *v86; // r5@32
  char *v87; // r0@32
  char *v88; // r7@33
  char *v89; // r6@33
  char *v90; // r5@33
  char *v91; // r0@33
  int v92; // r4@33
  int v93; // r1@33
  int v94; // r0@33
  int v95; // r4@35
  int v96; // r1@37
  int v97; // r0@37
  void *v98; // r4@37
  int v99; // r1@37
  int v100; // r0@37
  void *v101; // r4@37
  int v102; // r1@37
  int v103; // r0@37
  char *v104; // r0@37
  int v105; // r0@38
  void *v106; // r4@40
  int v107; // r1@40
  int v108; // r0@40
  int v109; // r1@40
  const char *v110; // r0@40
  int v111; // r1@40
  const char *v112; // r0@40
  void *v113; // r6@40
  int v114; // r1@40
  int v115; // r0@40
  void *v116; // r0@40
  char v117; // [sp+10h] [bp-C0h]@5
  char v118; // [sp+90h] [bp-40h]@25
  char v119; // [sp+A4h] [bp-2Ch]@25

  v1 = a1;
  result = print_natoff_warning();
  if ( result )
    return result;
  print_js_file((int)"firewallconf", (int)"firewall");
  sub_39F78();
  printf("<table class=v3_table>");
  printf("<form method=get action=\"timepro.cgi\" name=\"firewall_fm\">");
  printf("<input type=hidden name=\"tmenu\" value=\"firewallconf\">");
  printf("<input type=hidden name=\"smenu\" value=\"firewall\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  printf("<input type=hidden name=\"clicked_name\" value=\"\">");
  printf("<input type=hidden name=\"clicked_bg\" value=\"\">");
  printf("<input type=hidden name=\"old_priority\" value=\"\">");
  printf("<input type=hidden name=\"cur_priority\" value=\"\">");
  printf("<input type=hidden name=\"wireless_id\" value=\"\">");
  printf("<input type=hidden name=\"rule_count\" value=\"0\">");
  printf("<tr class=\"fw_tr\"><td colspan=2 width=100%% class=\"fw_td\" style=\"vertical-align:top;\">");
  printf("<TABLE width=100%% class=\"fw_table\">");
  printf("<COL WIDTH=\"45\"><COL WIDTH=\"65\"><COL WIDTH=\"80\"><COL WIDTH=\"20\">\t\t<COL WIDTH=\"90\"><COL WIDTH=\"70\"><COL WIDTH=\"40\"><COL WIDTH=\"15\"><COL WIDTH=\"145\"><COL WIDTH=\"%%\">\n");
  puts("<TR height=\"24\" class=\"fw_tr\">");
  v4 = get_ux_text_common(331, v3);
  printf("<TD class=\"fw_td\"><P align=\"left\" class=\"fw_p\" style=\"padding-left: 5px;\">%s</P></TD>\n", v4);
  v6 = get_ux_text_common(324, v5);
  printf("<TD class=\"fw_td\"><P align=\"left\" class=\"fw_p\">%s</P></TD>\n", v6);
  v8 = get_ux_text_common(320, v7);
  printf("<TD class=\"fw_td\"><P align=\"left\" class=\"fw_p\">%s</P></TD>\n", v8);
  puts("<TD class=\"fw_td\"></TD>");
  v10 = get_ux_text_common(311, v9);
  printf("<TD class=\"fw_td\"><P align=\"left\" class=\"fw_p\">%s</P></TD>\n", v10);
  v12 = get_ux_text_common(342, v11);
  printf("<TD class=\"fw_td\"><P align=\"left\" class=\"fw_p\">%s</P></TD>\n", v12);
  v14 = get_ux_text_common(312, v13);
  printf("<TD class=\"fw_td\"><P align=\"left\" class=\"fw_p\">%s</P></TD>\n", v14);
  puts("<TD class=\"fw_td\"></TD>");
  v16 = get_ux_text_common(338, v15);
  printf("<TD class=\"fw_td\"><P align=\"left\" class=\"fw_p\">%s</P></TD>\n", v16);
  printf("<TD class=\"fw_td\"><P align=\"right\" class=\"fw_p\" style=\"margin:0; padding-right:17px;\">");
  printf("<a class=\"fw_a\" style=\"cursor:pointer; padding-bottom:3px;\" onclick=\"onDeleteClicked();\">");
  v17 = get_image_dir();
  v19 = get_ux_text_common(143, v18);
  printf("<img src=\"/%s/minus_icon.gif\">%s</a>&nbsp;<input type=\"checkbox\" name=\"alldel\"", v17, v19);
  printf("onclick=\"onAllDeleteChecked(document, this.checked);\">");
  puts("</P></TD>");
  printf("</TR>");
  printf("<TR style=\"border-collapse:collapse; position:relative; border-top:1px rgba(128,128,128,0.3) solid !important; \t\tborder-bottom:1px rgba(128,128,128,0.3) solid !important;\">");
  printf("<TD colspan=10 width=100%% height=384 class=\"fw_td\">");
  if ( v1 && (v20 = (const char *)get_parameter_value(v1, "mode"), (v1 = v20) != 0) && strncmp(v20, "all", 3u) )
  {
    if ( !strncmp(v1, "internet", 8u) )
    {
      v21 = &v117;
      puts("<input type=hidden name=\"mode\" value=\"internet\">\n");
      v22 = &v117;
      v23 = "timepro.cgi?tmenu=iframe&smenu=firewall&mode=internet";
    }
    else
    {
      result = strncmp(v1, "wifi", 4u);
      if ( result )
        return result;
      v21 = &v117;
      puts("<input type=hidden name=\"mode\" value=\"wifi\">\n");
      v23 = (const char *)&unk_9DE29;
      v22 = &v117;
    }
  }
  else
  {
    v21 = &v117;
    puts("<input type=hidden name=\"mode\" value=\"all\">\n");
    v22 = &v117;
    v23 = "timepro.cgi?tmenu=iframe&smenu=firewall&mode=all";
  }
  v24 = strcpy(v22, v23);
  if ( is_mobile_agent(v24) )
  {
    print_div_m_str((int)"384", (int)"100%", (int)"display:inline-block;");
    v25 = printf(
            "<iframe name=\"firewall_iframe\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scrolling=yes></iframe>",
            v21);
    print_div_m_etr(v25);
  }
  else
  {
    printf(
      "<iframe name=\"firewall_iframe\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scrolling=yes></iframe>",
      v21);
  }
  puts("</TD></TR>");
  puts("</TABLE>");
  puts("</td></tr>");
  puts("<tr height=\"100\" class=\"fw_tr\" style=\"background-Color:#eeeeee\">");
  puts("<td width=572 class=\"fw_td\">");
  puts("<TABLE width=572 class=\"fw_table\">");
  puts("<TR id=\"form_line_1\" height=\"22\" class=\"fw_tr\">");
  puts("<TD width=\"10\" align=\"center\" class=\"fw_td\">");
  v26 = get_image_dir();
  printf("<img src=\"/%s/pf_square_icon.gif\"></TD>\n", v26);
  puts("<TD width=\"110\" class=\"fw_td\">");
  puts("<select name=\"formselect\" class=\"fw_select\" style=\"width:110px;\" onchange=\"onChangeMode();\">");
  if ( !v1 || !strncmp(v1, "all", 3u) )
  {
    v28 = get_ux_text_common(313, v27);
    printf("<option value=\"internet\">%s</option>\n", v28);
    v30 = get_ux_text_common(314, v29);
    printf("<option value=\"site\">%s</option>\n", v30);
    goto LABEL_19;
  }
  if ( !strncmp(v1, "internet", 8u) )
  {
    v33 = get_ux_text_common(313, v32);
    printf("<option value=\"internet\">%s</option>\n", v33);
    v35 = get_ux_text_common(314, v34);
    v36 = "<option value=\"site\">%s</option>\n";
LABEL_20:
    printf(v36, v35);
    goto LABEL_21;
  }
  if ( !strncmp(v1, "wifi", 4u) )
  {
LABEL_19:
    v35 = get_ux_text_common(315, v31);
    v36 = "<option value=\"wifi\">%s</option>\n";
    goto LABEL_20;
  }
LABEL_21:
  puts("</select>");
  puts("</TD>");
  puts("<TD width=\"155\" align=\"left\" class=\"left_padding_td\">");
  v38 = get_ux_text_common(335, v37);
  printf(
    "<input type=\"text\" name=\"rule_name\" size=\"21\" maxlength=\"127\" class=\"fw_textbox\" \t\tstyle=\"width:145px;\""
    " placeholder=\"%s\" onkeydown=\"ButtonViewControl('modify'); return true;\">\n",
    v38);
  puts("</TD>");
  puts("<TD width=\"292\" align=\"left\" class=\"fw_td\">");
  puts("<SPAN class=\"fw_span\">");
  v40 = get_ux_text_common(307, v39);
  printf(
    "<input type=\"checkbox\" class=\"fw_checkbox\" name=\"disable\" id=\"disable_id\" onclick=\"onCheckedDisable();\">\n"
    "\t\t<label for=\"disable_id\">%s</label>\n",
    v40);
  puts("</SPAN>");
  puts("</TD>");
  puts("</TR>");
  puts("<TR id=\"form_line_2\" height=\"22\" class=\"fw_tr\">");
  puts("<TD width=\"10\" align=\"center\" class=\"fw_td\">");
  v41 = get_image_dir();
  printf("<img src=\"/%s/pf_square_icon.gif\"></TD>\n", v41);
  puts("<TD width=\"110\" class=\"fw_td\">");
  puts("<select name=\"direction\" class=\"fw_select\" style=\"width:110px;\" onchange=\"onChangeDirection();\">");
  v43 = get_ux_text_common(305, v42);
  printf("<option value=\"inout\">%s</option>\n", v43);
  v45 = get_ux_text_common(306, v44);
  printf("<option value=\"outin\">%s</option>\n", v45);
  v47 = get_ux_text_common(304, v46);
  printf("<option value=\"both\">%s</option>\n", v47);
  puts("</select>");
  puts("</TD>");
  puts("<TD width=\"155\" align=\"left\" class=\"left_padding_td\">");
  puts("<select name=\"protocol\" class=\"fw_select\" style=\"width:145px;\" onchange=\"onChangeProtocol();\">");
  puts("<option value=\"none\"></option>");
  puts("<option value=\"tcp\"></option>");
  puts("<option value=\"udp\"></option>");
  puts("<option value=\"icmp\"></option>");
  puts("<option value=\"gre\"></option>");
  puts("<option value=\"tcpudp\"></option>");
  puts("</select>");
  puts("</TD>");
  puts("<TD width=\"292\" align=\"left\" class=\"fw_td\">");
  printf("<input type=\"text\" name=\"sport\" class=\"fw_textbox\" size=5 maxlength=5 style=\"width:42px;\" \t\t\tonkeydown=\"ButtonViewControl('modify'); return true;\"> ~ ");
  puts("<input type=\"text\" name=\"eport\" class=\"fw_textbox\" size=5 maxlength=5 style=\"width:42px;\" \t\t\tonkeydown=\"ButtonViewControl('modify'); return true;\">");
  puts("</TD>");
  puts("</TR>");
  puts("<TR id=\"form_line_wifi\" height=\"22\" class=\"fw_tr\" style=\"display:none;\">");
  puts("<TD width=\"10\" align=\"center\" class=\"fw_td\">");
  v48 = get_image_dir();
  printf("<img src=\"/%s/pf_square_icon.gif\"></TD>\n", v48);
  puts("<TD width=\"110\" class=\"fw_td\">");
  puts("<select name=\"wireless\" class=\"fw_select\" style=\"width:110px;\" onchange=\"\">");
  if ( check_wireless_ifrun(1) )
  {
    v50 = get_ux_text_common(297, v49);
    printf("<option value=\"5g\">%s</option>\n", v50);
  }
  if ( check_wireless_ifrun(0) )
  {
    v52 = get_ux_text_common(296, v51);
    printf("<option value=\"2g\">%s</option>\n", v52);
  }
  v53 = get_ux_text_common(301, v51);
  printf("<option value=\"all\">%s</option>\n", v53);
  puts("</select>");
  puts("</TD>");
  puts("<TD colspan=\"2\" align=\"left\" class=\"left_padding_td\">");
  v54 = get_image_dir();
  v56 = get_ux_text_common(298, v55);
  printf("<img src=\"/%s/fw_right_arrow.gif\"> %s", v54, v56);
  puts("</TD>");
  puts("</TR>");
  puts("<TR id=\"form_line_3\" height=\"22\" class=\"fw_tr\">");
  puts("<TD width=\"10\" class=\"fw_td\" align=\"center\">");
  v57 = get_image_dir();
  printf("<img src=\"/%s/pf_square_icon.gif\"></TD>\n", v57);
  puts("<TD width=\"110\" class=\"fw_td\">");
  puts("<select name=\"internal_type\" class=\"fw_select\" style=\"width:110px;\" onchange=\"onChangeInternalType();\">");
  v59 = get_ux_text_common(318, v58);
  printf("<option value=\"ip\">%s</option>\n", v59);
  v61 = get_ux_text_common(317, v60);
  printf("<option value=\"all\">%s</option>\n", v61);
  v63 = get_ux_text_common(319, v62);
  printf("<option value=\"mac\">%s</option>\n", v63);
  v65 = get_ux_text_common(339, v64);
  printf("<option value=\"search\">%s</option>\n", v65);
  puts("</select>");
  puts("</TD>");
  puts("<TD ID=\"IPBOXTD\" class=\"left_padding_td\" width=\"155\" align=\"left\" style=\"\">");
  get_ifconfig((int)"br0", (int)&v119, (int)&v118);
  sub_3A254((int)"ipaddr", &v119);
  v66 = 0;
  puts("</TD>");
  puts("<TD ID=\"MACBOXTD\" class=\"left_padding_td\" width=\"155\" align=\"left\" style=\"display:none;\">");
  while ( 1 )
  {
    ++v66;
    printf(
      "<input type=text id='%s%d' size=2 maxlength=2 style=\"width:21px; ime-mode: disabled;\" class=\"fw_textbox\" onkey"
      "down=\"ButtonViewControl('modify'); return true\" onfocus='this.select();' onkeypress=\"return HWKeyDown('%s',%d);"
      "\" onkeyup=\"HWKeyUp('%s',%d);\"",
      "macaddr",
      v66,
      "macaddr",
      v66,
      "macaddr",
      v66);
    putchar(62);
    if ( v66 == 6 )
      break;
    putchar(58);
  }
  puts("</TD>");
  puts("<TD ID=\"MACSEARCHBOXTD\" class=\"left_padding_td\" width=\"155\" align=\"left\" style=\"display:none;\">");
  v67 = strcpy(&v117, (const char *)&unk_9E9A0);
  if ( is_mobile_agent(v67) )
  {
    print_div_m_str((int)"22", (int)"155", (int)"display:inline-block; vertical-align:middle;");
    v68 = printf(
            "<iframe name=\"macsearch_iframe\" src=\"%s\" frameborder=no width=155 height=22 align=center scrolling=no></iframe>",
            &v117);
    print_div_m_etr(v68);
  }
  else
  {
    printf(
      "<iframe name=\"macsearch_iframe\" src=\"%s\" frameborder=no width=155 height=22 align=center scrolling=no></iframe>",
      &v117);
  }
  v69 = 0;
  puts("</TD>");
  puts("<TD width=\"292\" class=\"fw_td\" align=\"left\">");
  v70 = get_image_dir();
  printf("<SPAN ID=\"DIRSPAN_RIGHT\" class=\"fw_span\"><img src=\"/%s/fw_right_arrow.gif\"></SPAN>", v70);
  v71 = get_image_dir();
  printf(
    "<SPAN ID=\"DIRSPAN_LEFT\" class=\"fw_span\" style=\"display:none;\"><img src=\"/%s/fw_left_arrow.gif\"></SPAN>",
    v71);
  v72 = get_image_dir();
  printf((const char *)&unk_9EB2C, v72);
  puts("<SPAN ID=\"RIGHTIPBOX\" class=\"fw_span\">");
  puts("<select name=\"external_type\" class=\"fw_select\" style=\"width:90px;\" onchange=\"onChangeExternalType();\">");
  v74 = get_ux_text_common(309, v73);
  printf("<option value=\"all\">%s</option>\n", v74);
  v76 = get_ux_text_common(310, v75);
  printf("<option value=\"ip\">%s</option>\n", v76);
  puts("</select>");
  sub_3A254((int)"extaddr", 0);
  puts("</SPAN>");
  printf("<SPAN ID=\"RIGHTSITEBOX\" class=\"fw_span\" style=\"display:none;\">");
  v78 = get_ux_text_common(340, v77);
  printf(
    "<input type=\"text\" name=\"sites\" class=\"fw_textbox\" size=\"28\" maxlength=\"127\" style=\"width:220px;\" placeh"
    "older=\"%s\" \t\tonkeydown=\"ButtonViewControl('modify'); return true;\">\n",
    v78);
  puts("</SPAN>");
  puts("</TD>");
  puts("</TR>");
  puts("<TR id=\"form_line_4\" height=\"22\" class=\"fw_tr\">");
  puts("<TD width=\"10\" align=\"center\" class=\"fw_td\">");
  v79 = get_image_dir();
  printf("<img src=\"/%s/pf_square_icon.gif\"></TD>\n", v79);
  puts("<TD width=\"110\" class=\"fw_td\">");
  puts("<select name=\"policy\" class=\"fw_select\" style=\"width:110px;\" onchange=\"ButtonViewControl('modify');\">");
  v81 = get_ux_text_common(329, v80);
  printf("<option value=\"drop\">%s</option>\n", v81);
  v83 = get_ux_text_common(328, v82);
  printf("<option value=\"accept\">%s</option>\n", v83);
  puts("</select>");
  puts("</TD>");
  puts("<TD class=\"left_padding_td\" colspan=\"2\">");
  puts("<SPAN class=\"fw_span\">");
  do
  {
    v84 = sub_3A3C0(v69);
    v85 = sub_3A3C0(v69);
    v86 = sub_3A3C0(v69);
    v87 = sub_3A3C0(v69++);
    printf(
      "<input type=\"checkbox\" class=\"fw_checkbox\" name=\"%s\" id=\"%s_id\" onclick=\"ButtonViewControl('modify');\">\t"
      "\t\t<label for=\"%s_id\">%s</label>",
      v84,
      v85,
      v86,
      v87 + 6);
  }
  while ( v69 != 7 );
  v88 = sub_3A3C0(7);
  v89 = sub_3A3C0(7);
  v90 = sub_3A3C0(7);
  v91 = sub_3A3C0(7);
  v92 = 0;
  printf(
    "<input type=\"checkbox\" class=\"fw_checkbox\" name=\"%s\" id=\"%s_id\" onclick=\"onCheckedEvery();\">\t\t<label for"
    "=\"%s_id\">%s</label>",
    v88,
    v89,
    v90,
    v91 + 6);
  puts("<select class=\"fw_select\" name=\"start_time\" onclick=\"onChangeStartTime();\">");
  v94 = get_ux_text_common(300, v93);
  printf("<option value=\"all\">%s\n", v94);
  do
  {
    ++v92;
    printf("<option value=\"%s\">%s\n");
  }
  while ( v92 != 48 );
  v95 = 0;
  puts("</select>");
  putchar(126);
  puts("<select class=\"fw_select\" name=\"end_time\" onclick=\"ButtonViewControl('modify');\">");
  do
  {
    ++v95;
    printf("<option value=\"%s\">%s\n");
  }
  while ( v95 != 48 );
  puts("</select>");
  puts("</SPAN>");
  puts("</TD>");
  puts("</TR>");
  puts("<TR id=\"form_blank_line\" height=\"22\" class=\"fw_tr\" style=\"display:none;\">");
  puts("<TD colspan=\"4\">&nbsp;</TD>");
  puts("</TR>");
  puts("</TABLE>");
  puts("</td>");
  puts("<td width=\"70\" align=\"right\" height=\"100\" class=\"fw_td\">");
  puts("<TABLE class=\"fw_table\" style=\"width:70px;\">");
  printf("<TR class=\"fw_tr\" style=\"height:22px;\">");
  puts("<TD class=\"fw_td\" align=\"right\">");
  puts("<SPAN class=\"fw_span\" style=\"white-space: nowrap;\">");
  v97 = get_ux_text_common(331, v96);
  printf(
    "%s <input type=\"text\" name=\"priority\" class=\"fw_textbox\" \t\tsize=3 maxlength=3 style=\"width:34px;\" onchange"
    "=\"onChangedPriority(%d);\">",
    v97,
    200);
  puts("</SPAN>");
  printf("</TD>");
  printf("</TR>");
  printf("<TR class=\"fw_tr\" style=\"height:22px;\">");
  puts("<TD class=\"fw_td\" align=\"right\">");
  printf("<button type=\"button\" name=\"pri_up\" class=\"fw_button\" style=\"width:75px; white-space:nowrap;\" onclick=\"onRowUpClicked();\">");
  v98 = get_image_dir();
  v100 = get_ux_text_common(332, v99);
  printf("<img src=\"/%s/fw_up.gif\">%s</button>", v98, v100);
  printf("</TD>");
  printf("</TR>");
  printf("<TR class=\"fw_tr\" style=\"height:22px;\">");
  puts("<TD class=\"fw_td\" align=\"right\">");
  printf("<button type=\"button\" name=\"pri_down\" class=\"fw_button\" style=\"width:75px; white-space:nowrap;\" onclick=\"onRowDownClicked();\">");
  v101 = get_image_dir();
  v103 = get_ux_text_common(330, v102);
  printf("<img src=\"/%s/fw_down.gif\">%s</button>", v101, v103);
  printf("</TD>");
  printf("</TR>");
  printf("<TR class=\"fw_tr\" style=\"height:22px;\">");
  puts("<TD class=\"fw_td\" align=\"right\">");
  printf("&nbsp;");
  printf("</TD>");
  printf("</TR>");
  printf("</TABLE>");
  puts("</td></tr>");
  puts("<tr id=\"form_line_5\" height=\"26\" class=\"fw_tr\">");
  puts("<td colspan=2 class=\"fw_td\" align=\"center\">");
  printf("<TABLE class=\"fw_table\" width=\"100%%\">\n");
  puts("<TD class=\"fw_td\" width=\"466\">");
  v104 = strcpy(&v117, (const char *)&unk_9F3A2);
  if ( is_mobile_agent(v104) )
  {
    print_div_m_str((int)"26", (int)"466", (int)"display:inline-block; vertical-align:middle;");
    v105 = printf(
             "<iframe name=\"restore_iframe\" src=\"%s\" frameborder=no width=466 height=26 align=center scrolling=no></iframe>",
             &v117);
    print_div_m_etr(v105);
  }
  else
  {
    printf(
      "<iframe name=\"restore_iframe\" src=\"%s\" frameborder=no width=466 height=26 align=center scrolling=no></iframe>",
      &v117);
  }
  puts("</TD>");
  puts("<TD class=\"fw_td\" align=\"right\" style=\"padding-right:5px;\">");
  puts("<button type=\"button\" class=\"fw_button\" name=\"new_rule_btn\" style=\"width:65px;\" onclick=\"onNewRuleBtnClicked();\">");
  v106 = get_image_dir();
  v108 = get_ux_text_common(326, v107);
  printf("<img src=\"/%s/pf_plus_icon.gif\"> %s\n", v106, v108);
  puts("</button>");
  printf(
    "<button type=\"button\" class=\"fw_button\" name=\"apply_btn\" style=\"width:45px;\" onclick=\"onApplyBtnClicked('%s"
    "','%s',%d);\">\n",
    &v119,
    &v118,
    200);
  v110 = (const char *)get_ux_text_common(302, v109);
  puts(v110);
  puts("</button>");
  puts("<button type=\"button\" class=\"fw_button\" name=\"cancel_btn\" style=\"width:45px;\" onclick=\"onCancelBtnClicked();\">");
  v112 = (const char *)get_ux_text_common(303, v111);
  puts(v112);
  puts("</button>");
  puts("</TD>");
  puts("</TABLE>");
  puts("</td>");
  puts("</tr>");
  printf("</form>");
  puts("</table>");
  printf(
    "<DIV ID=\"%s\" style=\"position:absolute; left:%dpx; top:%dpx; width:%dpx; height:%dpx; z-index:1; background-color:"
    "#ffffff; \t\topacity:1.0; display:none;\">\n",
    "restore_mask");
  printf("<table width=\"%d\" height=\"%d\">\n", 642, 536);
  printf("<tr><td width=\"100%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"height:30px; vertical-align:middle; display:block; text-align:center;\">");
  v113 = get_image_dir();
  v115 = get_ux_text_common(378, v114);
  printf("<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; vertical-align:middle;\">%s", v113, v115);
  printf("</SPAN></td></tr></table></DIV>");
  printf(
    "<DIV ID=\"%s\" style=\"position:absolute; left:%dpx; top:%dpx; width:%dpx; height:%dpx; z-index:1; background-color:"
    "#ffffff; \t\topacity:1.0; display:none;\">\n",
    "apply_mask");
  printf("<table width=\"%d\" height=\"%d\">\n", 642, 536);
  printf("<tr><td width=\"100%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"height:30px; vertical-align:middle; display:block; text-align:center;\">");
  v116 = get_image_dir();
  printf("<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; vertical-align:middle;\">", v116);
  return printf("</SPAN></td></tr></table></DIV>");
}
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 11C30: using guessed type int __fastcall check_wireless_ifrun(_DWORD);

//----- (0003E49C) --------------------------------------------------------
int firewallconf_firewall_real()
{
  return firewallconf_firewall(0);
}
// 3E49C: using guessed type int firewallconf_firewall_real();

//----- (0003E4A8) --------------------------------------------------------
int __fastcall firewallconf_firewall_real_2(const char *a1)
{
  return firewallconf_firewall(a1);
}

//----- (0003E4B0) --------------------------------------------------------
int __fastcall sub_3E4B0(int a1)
{
  return printf("<script>alert(\"%s\");</script>\n", a1);
}

//----- (0003E4C0) --------------------------------------------------------
signed int __fastcall sub_3E4C0(int a1)
{
  char *v1; // r4@3
  char *v2; // r0@3
  char *v3; // r4@5
  char *v4; // r0@5
  char *v5; // r4@7
  char *v6; // r0@7
  int v7; // r3@9
  int v8; // r1@10
  signed int result; // r0@12
  char v10; // [sp+4h] [bp-7Ch]@1
  char s; // [sp+18h] [bp-68h]@1
  char v12; // [sp+2Ch] [bp-54h]@1
  char v13; // [sp+3Ch] [bp-44h]@7
  char v14[12]; // [sp+40h] [bp-40h]@10
  char v15; // [sp+4Ch] [bp-34h]@5
  char v16[12]; // [sp+50h] [bp-30h]@10
  char v17; // [sp+5Ch] [bp-24h]@3
  char v18[12]; // [sp+60h] [bp-20h]@10
  char v19; // [sp+6Ch] [bp-14h]@4

  sf_strncpy(&v12, a1, 20);
  get_lan_ipconfig(&s, &v10, 0);
  if ( s && v10 )
  {
    v1 = &v17;
    v2 = strtok(&v12, ".");
    do
    {
      *((_DWORD *)v1 + 1) = atoi(v2);
      v1 += 4;
      v2 = strtok(0, ".");
    }
    while ( v1 != &v19 );
    v3 = &v15;
    v4 = strtok(&s, ".");
    do
    {
      *((_DWORD *)v3 + 1) = atoi(v4);
      v3 += 4;
      v4 = strtok(0, ".");
    }
    while ( v3 != &v17 );
    v5 = &v13;
    v6 = strtok(&v10, ".");
    do
    {
      *((_DWORD *)v5 + 1) = atoi(v6);
      v5 += 4;
      v6 = strtok(0, ".");
    }
    while ( v5 != &v15 );
    v7 = 0;
    while ( 1 )
    {
      v8 = *(_DWORD *)&v14[v7];
      if ( (*(_DWORD *)&v18[v7] ^ *(_DWORD *)&v16[v7]) & v8 )
        break;
      *(_DWORD *)&v14[v7] = ~v8;
      v7 += 4;
      if ( v7 == 16 )
        goto LABEL_12;
    }
    result = 0;
  }
  else
  {
LABEL_12:
    result = 1;
  }
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 120E0: using guessed type int __fastcall get_lan_ipconfig(_DWORD, _DWORD, _DWORD);
// 3E4C0: using guessed type char var_20[12];
// 3E4C0: using guessed type char var_40[12];
// 3E4C0: using guessed type char var_30[12];

//----- (0003E5E8) --------------------------------------------------------
int __fastcall sub_3E5E8(const char *a1, int a2)
{
  const char *v2; // r4@1
  int v3; // r6@1
  int v4; // r7@1
  int v5; // r10@1
  signed int v6; // r1@2
  const char *v7; // r1@5
  int v8; // r0@7
  int v9; // r0@7
  const char *v10; // r1@8
  int v11; // r0@10
  int v12; // r0@10
  const char *v13; // r1@11
  int v14; // r5@14
  int v15; // r1@14
  int v16; // r0@14
  int v17; // r1@14
  char *v18; // r10@15
  int v19; // r0@17
  int v20; // r1@17
  int v21; // r0@17
  int v22; // r0@17
  int v23; // r7@18
  int v24; // r1@20
  int v25; // r0@20
  int v26; // r6@21
  int v27; // r1@21
  int v28; // r0@21
  int v29; // r0@22
  char *v30; // r5@23
  int v31; // r6@25
  int v32; // r1@25
  int v33; // r0@26
  int v34; // r0@28
  int v35; // r1@28
  int v36; // r0@28
  char *v37; // r1@29
  int v38; // r2@29
  int v39; // r1@31
  int v40; // r0@31
  void *v41; // r5@31
  int v42; // r1@31
  int v43; // r0@31
  int v44; // r1@31
  int v45; // r0@31
  int v46; // r1@31
  const char *v47; // r0@31
  int v48; // r1@31
  int v49; // r0@31
  void *v50; // r5@31
  int v51; // r1@31
  int v52; // r0@31
  char v54; // [sp+10h] [bp-40h]@28

  v2 = a1;
  v3 = a2;
  check_valid_account(a1);
  v4 = get_remote_mgmt_port();
  v5 = get_remote_mgmt_flag();
  printf("<form name=\"%s_ipform\" method=post action=\"timepro.cgi\" style=\"padding:0; margin:0;\">\n", v2);
  puts("<input type=hidden name=\"tmenu\" value=\"firewallconf\">");
  puts("<input type=hidden name=\"smenu\" value=\"accesslist\">");
  puts("<input type=\"hidden\" name=\"act\" value=\"\">");
  printf("<input type=\"hidden\" name=\"nopassword\" value=\"%d\">\n");
  if ( !strcmp(v2, "ext") )
    v6 = *(_DWORD *)(v3 + 32);
  else
    v6 = *(_DWORD *)(v3 + 68);
  if ( v6 > 9 )
    v7 = "true";
  else
    v7 = "false";
  v8 = printf("<input type=\"hidden\" name=\"nomore\" value=\"%s\">\n", v7);
  v9 = get_remote_addr(v8);
  if ( accesslist_already_regist(v2, v9) )
    v10 = "true";
  else
    v10 = "false";
  v11 = printf("<input type=\"hidden\" name=\"noadd\" value=\"%s\">\n", v10);
  v12 = get_remote_addr(v11);
  if ( sub_3E4C0(v12) )
    v13 = "true";
  else
    v13 = "false";
  printf("<input type=\"hidden\" name=\"isinternal\" value=\"%s\">\n", v13);
  puts("<table class=\"v3_table access_main_table\" width=\"642\" style=\"padding:0; margin:0;\">");
  printf("<COL width=\"170\"><COL width=\"200\"><COL width=\"192\"><COL width=\"60\"><COL width=\"20\">");
  if ( !strcmp(v2, "ext") )
  {
    v14 = strcmp((const char *)v3, "run") == 0;
    printf("<tr class=\"access_main_tr\" style=\"background-color:#E3E3E3;\" height=\"24\">\t\t\t<td class=\"access_main_td\" style=\"border-top:1px #CCC solid; border-bottom:1px #CCC solid;\" colspan=\"5\">");
    v16 = get_ux_text_common(164, v15);
    printf("<p class=\"access_main_p\"><b>%s</b></p>", v16);
    printf("</td></tr>");
    printf("<tr class=\"access_main_tr\" height=\"24\"><td class=\"access_main_td\" style=\"border-bottom:1px #CCC solid;\">");
    if ( v5 )
      v18 = "checked";
    else
      v18 = "";
    v19 = get_ux_text_common(168, v17);
    printf(
      "<input type=checkbox id=\"extuse\" class=navi_chk name=rmgmt_chk %s onclick=\"disableFormAccessList();\">\t\t\t<la"
      "bel for=\"extuse\">%s</label>",
      v18,
      v19);
    printf("</td><td class=\"access_main_td\" style=\"border-bottom:1px #CCC solid;\">");
    v21 = get_ux_text_common(3, v20);
    printf("<span class=\"access_main_span\" style=\"margin-right:5px;\">%s</span>", v21);
    printf("<input type=text name=rmgmt_port maxlength=5 size=5 value=%d style=\"width:45px;\">\n", v4);
    printf("</td><td class=\"access_main_td\" style=\"border-bottom:1px #CCC solid;\" colspan=\"2\" align=\"right\">");
    v22 = strcmp(v2, "ext");
    if ( v22 )
      v23 = *(_DWORD *)(v3 + 68);
    else
      v23 = *(_DWORD *)(v3 + 32);
    v26 = get_remote_addr(v22);
    v28 = get_ux_text_common(35, v27);
    printf(
      "<button class=\"access_main_button\" style=\"width:55px;\" onclick=\"%s_RemoteConn(%d, '%s'); return ClickEventPro"
      "pagater(event);\">\t\t\t%s</button>",
      v2,
      v23,
      v26,
      v28);
    printf("</td><td class=\"access_main_td\" style=\"border-bottom:1px #CCC solid;\">");
  }
  else
  {
    v14 = strcmp((const char *)(v3 + 36), "run") == 0;
    printf("<tr class=\"access_main_tr\" style=\"background-color:#E3E3E3;\" height=\"24\">\t\t\t<td class=\"access_main_td\" style=\"border-top:1px #CCC solid; border-bottom:1px #CCC solid;\" colspan=\"5\">");
    v25 = get_ux_text_common(166, v24);
    printf("<p class=\"access_main_p\"><b>%s</b></p>", v25);
  }
  printf("</td></tr>");
  v29 = printf("<tr class=\"access_main_tr\" height=\"24\">\t\t<td class=\"access_main_td\" style=\"border-bottom:1px #CCC solid;\">");
  if ( v14 )
    v30 = "checked";
  else
    v30 = "";
  v31 = get_remote_addr(v29);
  if ( !strcmp(v2, "ext") )
    v33 = 165;
  else
    v33 = 167;
  v34 = get_ux_text_common(v33, v32);
  printf(
    "<input type=checkbox class=navi_chk name=%s_chk %s onclick=\"disableFormAccessList(); %s_partsubmit(this,'%s');\" id"
    "=\"%s_chkid\">\t\t<label for=\"%s_chkid\">%s</label>",
    v2,
    v30,
    v2,
    v31,
    v2,
    v2,
    v34);
  printf("</td><td class=\"access_main_td\" colspan=\"2\" style=\"border-bottom:1px #CCC solid;\">");
  v36 = get_ux_text_common(1121, v35);
  printf("<span class=\"access_main_span\">%s</span>", v36);
  printf("<span class=\"access_main_span\" style=\"margin-left:5px;\">");
  snprintf(&v54, 0x20u, "%s_regip", v2);
  if ( !strcmp(v2, "ext") )
  {
    v37 = "";
    v38 = 1;
  }
  else
  {
    v37 = "";
    v38 = 3;
  }
  print_html_ip_address((int)&v54, v37, v38);
  printf((const char *)&unk_9FD1B);
  v40 = get_ux_text_common(1, v39);
  printf(
    "<input type=text name=\"%s_ipexplan\" size=12 maxlength=12 placeholder=\"%s\" style=\"width:135px;\">\n",
    v2,
    v40);
  printf("</span>");
  printf("</td><td class=\"access_main_td\" align=\"right\" style=\"border-bottom:1px #CCC solid;\">");
  v41 = get_image_dir();
  v43 = get_ux_text_common(6, v42);
  printf(
    "<button id=\"%sbt\"class=\"access_main_button\" style=\"width:55px;\" onclick=\"%s_IPadd(); return ClickEventPropaga"
    "ter(event);\">\t\t<span class=\"access_main_span\"><img src=\"/%s/plus_icon.gif\" style=\"padding-right:4px;\">%s</s"
    "pan>\t\t</button>",
    v2,
    v2,
    v41,
    v43);
  printf("</td><td class=\"access_main_td\" style=\"border-bottom:1px #CCC solid;\">");
  printf("</td></tr>");
  printf("<tr class=\"access_main_tr\" height=\"22\">\t\t<td class=\"access_main_td\" style=\"border-bottom:1px #CCC solid;\" colspan=\"5\">");
  puts("<table class=\"v3_table access_main_table\" width=\"642\" style=\"padding:0; margin:0;\">");
  printf("<COL width=\"260\"><COL width=\"292\"><COL width=\"70\"><COL width=\"20\">");
  printf("<tr class=\"access_main_tr\" height=\"22\"><td class=\"access_main_td\">");
  v45 = get_ux_text_common(442, v44);
  printf(
    "<p class=\"access_main_p\" style=\"*display:inline; zoom:1;\">%s</p>\t\t<span class=\"access_main_span\" style=\"mar"
    "gin-left:5px; *display:inline; zoom:1;\">\t\t<font color=\"gray\">",
    v45);
  v47 = (const char *)get_ux_text_common(2, v46);
  printf(v47, 10);
  printf("</font></span>");
  printf("</td><td class=\"access_main_td\">");
  v49 = get_ux_text_common(246, v48);
  printf("<span class=\"access_main_span\">%s</span>", v49);
  printf("</td><td class=\"access_main_td\" align=\"right\">");
  v50 = get_image_dir();
  v52 = get_ux_text_common(143, v51);
  printf(
    "<span class=\"access_main_span\" style=\"cursor:pointer;\" onclick=\"%s_IPdel();\">\t\t<img src=\"/%s/minus_icon.gif"
    "\" class=\"access_main_span\" style=\"width:10px; height:10px;\">\t\t<span class=\"access_main_span\">%s</span></span>",
    v2,
    v50,
    v52);
  printf("<input type=checkbox name=\"%s_allcheck\" onclick=\"%s_allcheckfunc(this);\">\n", v2, v2);
  printf("</td><td class=\"access_main_td\">");
  printf("</td></tr>");
  printf("</table>");
  printf("</td></tr>");
  puts("</table>");
  return printf("</form>");
}
// 104CC: using guessed type int __fastcall get_remote_addr(_DWORD);
// 10A3C: using guessed type int get_remote_mgmt_port(void);
// 10CDC: using guessed type int __fastcall accesslist_already_regist(_DWORD, _DWORD);
// 10DCC: using guessed type int __fastcall check_valid_account(_DWORD);
// 118DC: using guessed type int get_remote_mgmt_flag(void);

//----- (0003EAE0) --------------------------------------------------------
int __fastcall print_iframe_hasetup(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r0@5
  int v4; // r0@6
  int v5; // r1@7
  int v6; // r0@8
  int v7; // r0@14
  int v8; // r0@15
  int v9; // r1@16
  int v10; // r0@17
  char *v11; // r0@18
  const char *v12; // r1@18
  int v13; // r0@19
  int v14; // r0@26
  char *v15; // r5@34
  int v16; // r1@34
  char *v17; // r0@36
  int v18; // r0@37
  int v19; // r0@38
  int v20; // r5@48
  int v21; // r1@50
  int v22; // r0@51
  int v23; // r5@55
  int v24; // r1@57
  int v25; // r0@58
  int v26; // r0@61
  int v27; // r0@61
  char v28; // r3@66
  char v29; // r3@70
  char v30; // r3@74
  char v31; // r3@78
  char v32; // r3@82
  char v33; // r3@86
  int v34; // r0@91
  signed int v35; // r3@91
  int v36; // r0@100
  char *v37; // r0@101
  int v38; // r0@108
  int v39; // r0@108
  int v40; // r0@119
  int v41; // r0@119
  char v43; // [sp+Ch] [bp-4DCh]@102
  char v44; // [sp+10Ch] [bp-3DCh]@101
  char v45; // [sp+20Ch] [bp-2DCh]@99
  char dest; // [sp+30Ch] [bp-1DCh]@49
  char s; // [sp+38Ch] [bp-15Ch]@1
  int v48; // [sp+3ACh] [bp-13Ch]@44
  char s1; // [sp+3B0h] [bp-138h]@5
  int v50; // [sp+3D0h] [bp-118h]@35
  char v51; // [sp+3D4h] [bp-114h]@3
  int v52; // [sp+414h] [bp-D4h]@3
  int v53; // [sp+454h] [bp-94h]@1
  int v54; // [sp+494h] [bp-54h]@32
  char v55; // [sp+4B4h] [bp-34h]@6
  char v56; // [sp+4B5h] [bp-33h]@72
  char v57; // [sp+4B6h] [bp-32h]@76
  char v58; // [sp+4B7h] [bp-31h]@80
  char v59; // [sp+4B8h] [bp-30h]@84
  char v60; // [sp+4B9h] [bp-2Fh]@88
  int v61; // [sp+4C8h] [bp-20h]@88
  int v62; // [sp+4CCh] [bp-1Ch]@88

  v2 = a2;
  memset(&s, 0, 0x48u);
  accesslist_set_read_config(&s);
  if ( !get_value_post(v2, "act", &v53, 64) )
    memset(&v53, 0, 0x40u);
  memset(&v52, 0, 0x40u);
  if ( get_value_post(v2, "act", &v51, 64) )
  {
    if ( !strcmp(&v51, "int_run") )
    {
      v3 = strcmp(&s1, "run");
      if ( v3 )
      {
        v4 = get_remote_addr(v3);
        sf_strncpy(&v55, v4, 20);
        if ( !accesslist_already_regist("int", &v55) && sub_3E4C0((int)&v55) )
        {
          v6 = get_ux_text_common(1120, v5);
          accesslist_add_ip("int", &v55, v6, &s);
        }
        accesslist_iptables_cmd(2);
        snprintf(&s1, 0x20u, "run");
      }
      goto LABEL_61;
    }
    if ( !strcmp(&v51, (const char *)&unk_A021B) )
    {
      if ( strcmp(&s1, "stop") )
      {
        accesslist_iptables_cmd(4);
        strcpy(&s1, "stop");
      }
      goto LABEL_61;
    }
    if ( !strcmp(&v51, "ext_run") )
    {
      v7 = strcmp(&s, "run");
      if ( v7 )
      {
        v8 = get_remote_addr(v7);
        sf_strncpy(&v55, v8, 20);
        if ( !accesslist_already_regist("ext", &v55) && !sub_3E4C0((int)&v55) )
        {
          v10 = get_ux_text_common(1120, v9);
          accesslist_add_ip("ext", &v55, v10, &s);
        }
        accesslist_iptables_cmd(1);
        v11 = &s;
        v12 = "run";
        goto LABEL_24;
      }
      goto LABEL_25;
    }
    if ( !strcmp(&v51, "ext_stop") )
    {
      if ( strcmp(&s, "stop") )
      {
        accesslist_iptables_cmd(3);
        v12 = "stop";
        v11 = &s;
LABEL_24:
        strcpy(v11, v12);
      }
LABEL_25:
      if ( get_value_post(v2, &unk_A022C, &v51, 64) )
      {
        v14 = atoi(&v51);
        set_remote_mgmt_port(v14);
      }
      v13 = get_value_post(v2, "rmgmt_chk", &v51, 64) && !strcmp(&v51, "on");
      set_remote_mgmt_flag(v13);
      goto LABEL_61;
    }
    if ( !strcmp(&v51, "int_ipadd") )
    {
      get_ip_value_post(v2, "int_regip", &v55);
      get_value_post(v2, "int_ipexplan", &v54, 32);
      if ( check_unpermitted_chars(&v54) )
        strcpy((char *)&v54, " ");
      v15 = &v55;
      if ( !accesslist_already_regist("int", &v55) )
      {
        if ( v50 <= 9 )
        {
          v17 = "int";
LABEL_47:
          accesslist_add_ip(v17, v15, &v54, &s);
          goto LABEL_61;
        }
LABEL_37:
        v18 = 1123;
LABEL_38:
        v19 = get_ux_text_common(v18, v16);
        sub_3E4B0(v19);
LABEL_61:
        v26 = accesslist_set_write_config(&s);
        v27 = signal_update(v26);
        signal_save(v27);
        goto LABEL_62;
      }
    }
    else
    {
      if ( strcmp(&v51, "ext_ipadd") )
      {
        v20 = strcmp(&v51, "int_del");
        if ( v20 )
        {
          v23 = strcmp(&v51, "ext_del");
          if ( !v23 )
          {
            strcpy(&dest, "");
            while ( get_value_array_post(v2, "ext_delchk") )
            {
              if ( !accesslist_remove_ip("ext", &dest, &s) )
              {
                v25 = get_ux_text_common(1124, v24);
                sub_3E4B0(v25);
              }
              ++v23;
            }
          }
        }
        else
        {
          strcpy(&dest, "");
          while ( get_value_array_post(v2, &unk_A0294) )
          {
            if ( !accesslist_remove_ip("int", &dest, &s) )
            {
              v22 = get_ux_text_common(1124, v21);
              sub_3E4B0(v22);
            }
            ++v20;
          }
        }
        goto LABEL_61;
      }
      get_ip_value_post(v2, "ext_regip", &v55);
      get_value_post(v2, "ext_ipexplan", &v54, 32);
      if ( check_unpermitted_chars(&v54) )
        strcpy((char *)&v54, " ");
      v15 = &v55;
      if ( !accesslist_already_regist("ext", &v55) )
      {
        if ( v48 <= 9 )
        {
          v17 = "ext";
          goto LABEL_47;
        }
        goto LABEL_37;
      }
    }
    v18 = 1125;
    goto LABEL_38;
  }
LABEL_62:
  if ( get_value_post(v2, "act", &dest, 128) && !strcmp(&dest, "dos_submit") )
  {
    if ( get_value_post(v2, "synflood", &v51, 32) && !strcmp(&v51, "on") )
      v28 = 49;
    else
      v28 = 48;
    v55 = v28;
    if ( get_value_post(v2, "smurf", &v51, 32) && !strcmp(&v51, "on") )
      v29 = 49;
    else
      v29 = 48;
    v56 = v29;
    if ( get_value_post(v2, "sourceroute", &v51, 32) && !strcmp(&v51, "on") )
      v30 = 49;
    else
      v30 = 48;
    v57 = v30;
    if ( get_value_post(v2, "ipspoof", &v51, 32) && !strcmp(&v51, "on") )
      v31 = 49;
    else
      v31 = 48;
    v58 = v31;
    if ( get_value_post(v2, "icmpblock", &v51, 32) && !strcmp(&v51, "on") )
      v32 = 49;
    else
      v32 = 48;
    v59 = v32;
    if ( get_value_post(v2, "internal_icmpbk", &v51, 32) && !strcmp(&v51, "on") )
      v33 = 49;
    else
      v33 = 48;
    v60 = v33;
    get_arp_protection(&v61, &v62, &v54);
    if ( !get_intvalue_post(v2, (int)"arp_protection", (int)&v61) )
      v61 = 0;
    if ( v61 )
    {
      v34 = get_intvalue_post(v2, (int)"period", (int)&v62);
      if ( !v34 )
        v35 = 10;
      if ( !v34 )
        v62 = v35;
      if ( !get_value_post(v2, "ifname", &v54, 32) )
        strcpy((char *)&v54, "vlan1");
    }
    if ( check_unpermitted_chars(&v54) )
      strcpy((char *)&v54, "vlan1");
    set_arp_protection(v61, v62, &v54);
    if ( !get_value_post(v2, "csrf", &v45, 256) )
      goto LABEL_108;
    v36 = atoi(&v45);
    set_csrf_op(v36);
    if ( get_value_post(v2, "whitedomains", &v45, 256) )
    {
      sf_strncpy(&v44, &v45, 256);
      sf_strncpy(&v43, &v44, 256);
      strtoupper(&v43);
      if ( strstr(&v43, "<SCRIPT>") )
        strcpy(&v44, "");
      if ( !check_unpermitted_chars(&v44) )
        goto LABEL_107;
      v37 = &v44;
    }
    else
    {
      v37 = &v44;
    }
    strcpy(v37, "");
LABEL_107:
    set_csrf_whites(&v44);
LABEL_108:
    v38 = apply_dos_config(&v55);
    v39 = signal_update(v38);
    signal_save(v39);
  }
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"firewallconf_hasetup\">");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  if ( !strcmp((const char *)&v53, "ext_run")
    || !strcmp((const char *)&v53, "ext_stop")
    || !strcmp((const char *)&v53, "ext_ipadd")
    || !strcmp((const char *)&v53, "ext_del") )
  {
    printf("if(parent.window.refresh_extlist) parent.window.refresh_extlist();");
  }
  if ( !strcmp((const char *)&v53, "int_run")
    || !strcmp((const char *)&v53, (const char *)&unk_A021B)
    || !strcmp((const char *)&v53, "int_ipadd")
    || !strcmp((const char *)&v53, "int_del") )
  {
    printf("if(parent.window.refresh_intlist) parent.window.refresh_intlist();");
  }
  v40 = printf("UnMaskIt(parent.document, 'apply_mask');");
  v41 = get_remote_addr(v40);
  if ( !sub_3E4C0(v41)
    && (!strcmp((const char *)&v53, "ext_run") || !strcmp((const char *)&v53, "ext_stop"))
    && get_value_post(v2, "rmgmt_chk", &v53, 64)
    && get_value_post(v2, &unk_A022C, &v52, 64)
    && !strcmp((const char *)&v53, "on") )
  {
    printf("if(parent.window.redirect_loginpage_and_logout)parent.window.redirect_loginpage_and_logout('%s');", &v52);
  }
  return printf("</script>");
}
// 104CC: using guessed type int __fastcall get_remote_addr(_DWORD);
// 1058C: using guessed type int __fastcall set_csrf_op(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 106E8: using guessed type int __fastcall set_csrf_whites(_DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 108E0: using guessed type int __fastcall accesslist_iptables_cmd(_DWORD);
// 10CDC: using guessed type int __fastcall accesslist_already_regist(_DWORD, _DWORD);
// 10D54: using guessed type int __fastcall set_arp_protection(_DWORD, _DWORD, _DWORD);
// 11000: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 111F8: using guessed type int __fastcall get_arp_protection(_DWORD, _DWORD, _DWORD);
// 11300: using guessed type int __fastcall strtoupper(_DWORD);
// 114B0: using guessed type int __fastcall set_remote_mgmt_flag(_DWORD);
// 11504: using guessed type int __fastcall apply_dos_config(_DWORD);
// 116D8: using guessed type int __fastcall accesslist_add_ip(_DWORD, _DWORD, _DWORD, _DWORD);
// 11834: using guessed type int __fastcall accesslist_remove_ip(_DWORD, _DWORD, _DWORD);
// 11918: using guessed type int __fastcall accesslist_set_write_config(_DWORD);
// 11A8C: using guessed type int __fastcall get_value_array_post(_DWORD, _DWORD);
// 11BD0: using guessed type int __fastcall set_remote_mgmt_port(_DWORD);
// 11CF0: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// 11D5C: using guessed type int __fastcall accesslist_set_read_config(_DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);

//----- (0003F5AC) --------------------------------------------------------
int __fastcall print_iframe_haext(int a1)
{
  signed int v1; // r4@1
  char *v2; // r1@4
  signed int v3; // r5@7
  const char *v4; // r1@9
  int v5; // r0@13
  const char *v6; // r4@14
  int v7; // r0@16
  int v8; // r0@16
  const char *v9; // r7@17
  int v10; // r0@19
  const char *v11; // r3@20
  char v13; // [sp+4h] [bp-ACh]@2
  char v14; // [sp+84h] [bp-2Ch]@2

  check_valid_account(a1);
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0;\">");
  puts("<form name=\"ext_ipform_list\" method=post action=\"timepro.cgi\" style=\"padding:0; margin:0;\">");
  puts("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  puts("<input type=hidden name=\"smenu\" value=\"haext\">");
  puts("<input type=\"hidden\" name=\"act\" value=\"\">");
  v1 = 0;
  printf("<input type=\"hidden\" name=\"nopassword\" value=\"%d\">\n");
  printf("<input type=\"hidden\" name=\"maxcount\" value=\"%d\">\n", 10);
  printf("<table class=\"v3_table access_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"30\"><COL width=\"230\"><COL width=\"292\"><COL width=\"70\"><COL width=\"%%%%\">");
  do
  {
    if ( !accesslist_get_ip("ext", v1, &v14, &v13) )
      break;
    v2 = v1++ & 1 ? "F7F7F7" : "FFFFFF";
    printf(
      "<tr class=\"access_main_tr\" height=\"22\" style=\"background-color:#%s;\"><td class=\"access_main_td\">",
      v2);
    printf("<p class=\"access_main_p\">%d</p>", v1);
    printf("</td><td class=\"access_main_td\">");
    printf("<span class=\"access_main_span\">%s</span>", &v14);
    printf("</td><td class=\"access_main_td\">");
    printf("<span class=\"access_main_span\"><font color=\"gray\">%s</font></span>", &v13);
    printf("</td><td class=\"access_main_td\" align=\"right\">");
    printf("<input type=checkbox name=\"ext_delchk\" value=\"%s\">\n", &v14);
    printf("</td><td class=\"access_main_td\">");
    printf("</td></tr>");
  }
  while ( v1 != 10 );
  printf("<input type=\"hidden\" name=\"rcount\" value=\"%d\">\n", v1);
  v3 = v1;
  while ( v3 <= 2 )
  {
    if ( v3 & 1 )
      v4 = "F7F7F7";
    else
      v4 = "FFFFFF";
    ++v3;
    printf(
      "<tr class=\"access_main_tr\" height=\"22\" style=\"background-color:#%s;\"><td class=\"access_main_td\" colspan=\"5\">",
      v4);
    printf("</td></tr>");
  }
  puts("</table>");
  puts("</form>");
  v5 = printf("</BODY>");
  if ( v1 > 9 )
    v6 = "true";
  else
    v6 = "false";
  v7 = get_remote_addr(v5);
  v8 = accesslist_already_regist("ext", v7);
  if ( v8 )
    v9 = "false";
  else
    v9 = "true";
  v10 = get_remote_addr(v8);
  if ( sub_3E4C0(v10) )
    v11 = "true";
  else
    v11 = "false";
  return printf(
           "<script>if(parent.window.init_accessform)parent.window.init_accessform('ext', %s,%s,%s);</script>",
           v6,
           v9,
           v11);
}
// 104CC: using guessed type int __fastcall get_remote_addr(_DWORD);
// 10808: using guessed type int __fastcall accesslist_get_ip(_DWORD, _DWORD, _DWORD, _DWORD);
// 10CDC: using guessed type int __fastcall accesslist_already_regist(_DWORD, _DWORD);
// 10DCC: using guessed type int __fastcall check_valid_account(_DWORD);

//----- (0003F7E0) --------------------------------------------------------
int __fastcall print_iframe_haint(int a1)
{
  signed int v1; // r4@1
  char *v2; // r1@4
  signed int v3; // r5@7
  const char *v4; // r1@9
  int v5; // r0@13
  const char *v6; // r4@14
  int v7; // r0@16
  int v8; // r0@16
  const char *v9; // r7@17
  int v10; // r0@19
  const char *v11; // r3@20
  char v13; // [sp+4h] [bp-ACh]@2
  char v14; // [sp+84h] [bp-2Ch]@2

  check_valid_account(a1);
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0;\">");
  puts("<form name=\"int_ipform_list\" method=post action=\"timepro.cgi\" style=\"padding:0; margin:0;\">");
  puts("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  puts("<input type=hidden name=\"smenu\" value=\"haint\">");
  puts("<input type=\"hidden\" name=\"act\" value=\"\">");
  v1 = 0;
  printf("<input type=\"hidden\" name=\"nopassword\" value=\"%d\">\n");
  printf("<input type=\"hidden\" name=\"maxcount\" value=\"%d\">\n", 10);
  printf("<table class=\"v3_table access_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"30\"><COL width=\"230\"><COL width=\"292\"><COL width=\"70\"><COL width=\"%%%%\">");
  do
  {
    if ( !accesslist_get_ip("int", v1, &v14, &v13) )
      break;
    v2 = v1++ & 1 ? "F7F7F7" : "FFFFFF";
    printf(
      "<tr class=\"access_main_tr\" height=\"22\" style=\"background-color:#%s;\"><td class=\"access_main_td\">",
      v2);
    printf("<p class=\"access_main_p\">%d</p>", v1);
    printf("</td><td class=\"access_main_td\">");
    printf("<span class=\"access_main_span\">%s</span>", &v14);
    printf("</td><td class=\"access_main_td\">");
    printf("<span class=\"access_main_span\"><font color=\"gray\">%s</font></span>", &v13);
    printf("</td><td class=\"access_main_td\" align=\"right\">");
    printf("<input type=checkbox name=\"int_delchk\" value=\"%s\">\n", &v14);
    printf("</td><td class=\"access_main_td\">");
    printf("</td></tr>");
  }
  while ( v1 != 10 );
  printf("<input type=\"hidden\" name=\"rcount\" value=\"%d\">\n", v1);
  v3 = v1;
  while ( v3 <= 2 )
  {
    if ( v3 & 1 )
      v4 = "F7F7F7";
    else
      v4 = "FFFFFF";
    ++v3;
    printf(
      "<tr class=\"access_main_tr\" height=\"22\" style=\"background-color:#%s;\"><td class=\"access_main_td\" colspan=\"5\">",
      v4);
    printf("</td></tr>");
  }
  puts("</table>");
  puts("</form>");
  v5 = printf("</BODY>");
  if ( v1 > 9 )
    v6 = "true";
  else
    v6 = "false";
  v7 = get_remote_addr(v5);
  v8 = accesslist_already_regist("int", v7);
  if ( v8 )
    v9 = "false";
  else
    v9 = "true";
  v10 = get_remote_addr(v8);
  if ( sub_3E4C0(v10) )
    v11 = "true";
  else
    v11 = "false";
  return printf(
           "<script>if(parent.window.init_accessform)parent.window.init_accessform('int', %s,%s,%s);</script>",
           v6,
           v9,
           v11);
}
// 104CC: using guessed type int __fastcall get_remote_addr(_DWORD);
// 10808: using guessed type int __fastcall accesslist_get_ip(_DWORD, _DWORD, _DWORD, _DWORD);
// 10CDC: using guessed type int __fastcall accesslist_already_regist(_DWORD, _DWORD);
// 10DCC: using guessed type int __fastcall check_valid_account(_DWORD);

//----- (0003FA14) --------------------------------------------------------
int __fastcall sub_3FA14(int a1)
{
  int v1; // r4@1
  int v2; // r0@1
  int v3; // r0@2
  int v4; // r0@4
  int v5; // r0@5

  v1 = a1;
  printf("<table class=\"v3_table access_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<tr class=\"access_main_tr\"><td class=\"access_main_td\">");
  sub_3E5E8("ext", v1);
  printf("</td></tr>");
  v2 = printf("<tr class=\"access_main_tr\"><td class=\"access_main_td\">");
  if ( is_mobile_agent(v2) )
  {
    print_div_m_str((int)"66", (int)"100%%", (int)"display:inline-block; *display:inline; zoom:1;");
    v3 = printf("<iframe name=\"haext_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=haext\"                         frameborder=no width=100%% height=66 align=center scrolling=auto></iframe>");
    print_div_m_etr(v3);
  }
  else
  {
    printf("<iframe name=\"haext_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=haext\"                         frameborder=no width=100%% height=66 align=center scrolling=auto></iframe>");
  }
  printf("</td></tr>");
  printf("<tr class=\"access_main_tr\"><td class=\"access_main_td\">");
  sub_3E5E8("int", v1);
  printf("</td></tr>");
  v4 = printf("<tr class=\"access_main_tr\"><td class=\"access_main_td\">");
  if ( is_mobile_agent(v4) )
  {
    print_div_m_str((int)"66", (int)"100%%", (int)"display:inline-block; *display:inline; zoom:1;");
    v5 = printf("<iframe name=\"haint_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=haint\"                         frameborder=no width=100%% height=66 align=center scrolling=auto></iframe>");
    print_div_m_etr(v5);
  }
  else
  {
    printf("<iframe name=\"haint_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=haint\"                         frameborder=no width=100%% height=66 align=center scrolling=auto></iframe>");
  }
  printf("</td></tr></table>");
  puts("<script language=JavaScript>");
  printf("disableFormAccessList();");
  return puts("</script>");
}
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (0003FB38) --------------------------------------------------------
signed int firewallconf_accesslist()
{
  signed int result; // r0@1
  int v1; // r5@1
  int v2; // r1@2
  int v3; // r4@2
  void *v4; // r0@2
  int v5; // r0@2
  int v6; // r7@2
  int v7; // r1@2
  void *v8; // r10@2
  char *v9; // r8@3
  int v10; // r0@5
  int v11; // r1@5
  int v12; // r0@5
  int v13; // r1@5
  void *v14; // r8@5
  char *v15; // r7@6
  int v16; // r0@8
  char *v17; // r7@8
  int v18; // r1@8
  int v19; // r0@8
  int v20; // r1@8
  const char *v21; // r0@8
  int v22; // r1@8
  char *v23; // r10@9
  int v24; // r0@11
  int v25; // r1@11
  int v26; // r0@13
  int v27; // r1@13
  const char *v28; // r0@13
  void *v29; // r1@13
  char *v30; // r2@14
  char *v31; // r1@17
  void *v32; // r1@19
  char *v33; // r2@20
  char *v34; // r1@23
  void *v35; // r1@25
  char *v36; // r2@26
  char *v37; // r1@29
  void *v38; // r1@31
  char *v39; // r2@32
  char *v40; // r1@35
  int v41; // r1@37
  void *v42; // r7@37
  char *v43; // r6@38
  int v44; // r0@40
  char *v45; // r1@41
  int v46; // r1@43
  void *v47; // r7@43
  char *v48; // r6@44
  int v49; // r0@46
  char *v50; // r1@47
  int v51; // r1@49
  int v52; // r0@49
  int v53; // r0@49
  int v54; // r0@50
  void *v55; // r0@52
  int v56; // [sp+0h] [bp-1A0h]@2
  char v57; // [sp+100h] [bp-A0h]@2
  char v58; // [sp+148h] [bp-58h]@5
  char v59; // [sp+168h] [bp-38h]@2
  char v60; // [sp+169h] [bp-37h]@19
  char v61; // [sp+16Ah] [bp-36h]@25
  char v62; // [sp+16Bh] [bp-35h]@31
  char v63; // [sp+16Ch] [bp-34h]@37
  char v64; // [sp+16Dh] [bp-33h]@43
  int v65; // [sp+178h] [bp-28h]@5
  int v66; // [sp+17Ch] [bp-24h]@5

  result = print_natoff_warning();
  v1 = result;
  if ( result )
    return result;
  print_js_file((int)"firewallconf", (int)"accesslist");
  puts("<style type=\"text/css\">");
  puts(".access_main_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".access_main_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".access_main_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".access_main_p {");
  puts("\tpadding:0 0 0 5px; display:inline-block;");
  puts("\tvertical-align:middle; margin:0;");
  puts("}");
  puts(".access_main_span {");
  puts("\tdisplay:inline-block; vertical-align:middle;");
  puts("}");
  puts(".access_main_button {");
  puts("\tpadding:0 1 0 1; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".access_main_td input[type=checkbox], .access_main_td input[type=radio] {");
  puts("display:inline-block; vertical-align:middle;");
  puts("}");
  puts("#access_div_msg p {");
  puts("margin:5 0 5 15px; text-align:left;");
  puts("}");
  puts(".access_ellipsis {");
  puts("text-overflow:ellipsis; overflow:hidden; white-space:nowrap; text-align:left;");
  puts("}");
  printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td {cursor:default;}");
  printf("</style>");
  puts("<table class=\"v3_table access_main_table\" width=\"642\" style=\"padding:0; margin:0;\">");
  printf("<COL width=\"642\">");
  printf("<tr class=\"access_main_tr\"><td class=\"access_main_td\">");
  memset(&v57, v1, 0x48u);
  accesslist_set_read_config(&v57);
  sub_3FA14((int)&v57);
  printf("</td></tr>");
  printf("<tr class=\"access_main_tr\"><td class=\"access_main_td\">");
  read_dos_config(&v59);
  printf("<form method=post action=\"timepro.cgi\" name=\"firewallconfetc\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"firewallconf\">");
  printf("<input type=hidden name=\"smenu\" value=\"etc\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  puts("<table class=\"v3_table access_main_table\" width=\"642\" style=\"padding:0; margin:0;\">");
  printf("<COL width=\"311\"><COL width=\"311\"><COL width=\"20\">");
  printf("<tr class=\"access_main_tr\" height=\"24\" style=\"background-color:#E3E3E3; cursor:pointer;\" onclick=\"onclick_etclist();\" id=\"etctitle\">\t\t<td class=\"access_main_td\" colspan=\"3\" style=\"border-top:1px #CCC solid; border-bottom:1px #CCC solid;\">");
  v3 = get_ux_text_common(746, v2);
  v4 = get_image_dir();
  printf(
    "<span class=\"access_main_span\" style=\"padding:0 0 0 5px;\"><b>%s</b></span>\t\t<img src=\"/%s/menu_list_closed.pn"
    "g\" \t\tstyle=\"margin-left:5px; width:16px; height:14px; vertical-align:middle; display:inline-block; *display:inli"
    "ne; zoom:1;\" \t\tid=\"timg\">",
    v3,
    v4);
  v5 = printf("</td></tr>");
  v6 = get_csrf_op(v5);
  get_csrf_whites(&v56);
  printf("<tr class=\"access_main_tr\" height=\"24\" style=\"background-color:#FFFFFF; display:none;\" name=\"etcline\">\t\t<td class=\"access_main_td\" style=\"padding:0 0 0 5px;\">");
  v8 = get_image_dir();
  if ( v6 )
    v9 = "on";
  else
    v9 = "off";
  v10 = get_ux_text_common(217, v7);
  printf(
    "<img src=\"/%s/trigger_%s.png\" id=\"csrf_img\" onclick=\"onclick_onoffbtn(this);\" \t\tstyle=\"vertical-align:middl"
    "e; height:22px; display:inline-block; *display:inline; zoom:1; cursor:pointer;\">\t\t<span class=\"access_main_span\">%s</span>",
    v8,
    v9,
    v10);
  printf("<input type=\"hidden\" name=\"csrf\" value=\"%d\">");
  printf("</td><td class=\"access_main_td\">");
  printf("</td><td class=\"access_main_td\"></td></tr>");
  printf("<tr class=\"access_main_tr\" height=\"24\" style=\"background-color:#F7F7F7; display:none;\" name=\"etcline\">\t\t<td class=\"access_main_td\" colspan=\"2\" style=\"padding:0 0 0 5px;\">");
  v12 = get_ux_text_common(219, v11);
  printf(
    "<input type=text name=\"whitedomains\" maxlength=256 size=64 value='%s' style=\"width:605px;\" placeholder=\"%s\">\n",
    &v56,
    v12);
  printf("</td><td class=\"access_main_td\">");
  printf("</td></tr>");
  get_arp_protection(&v65, &v66, &v58);
  printf("<tr class=\"access_main_tr\" height=\"24\" style=\"background-color:#FFFFFF; display:none;\" name=\"etcline\">\t\t<td class=\"access_main_td\" colspan=\"2\" style=\"padding:0 0 0 5px;\">");
  v14 = get_image_dir();
  if ( v65 )
    v15 = "on";
  else
    v15 = "off";
  v16 = get_ux_text_common(45, v13);
  printf((const char *)&unk_A119C, v14, v15, v16);
  v17 = "";
  printf("<input type=\"hidden\" name=\"arp_protection\" value=\"%d\">");
  printf("<span class=\"access_main_span\" style=\"margin-left:10px;\">");
  v19 = get_ux_text_common(43, v18);
  printf("%s<input type=text name=period size=3 maxlength=3 value=%d>", v19, v66);
  v21 = (const char *)get_ux_text_common(41, v20);
  printf(v21);
  printf("<select name=ifname>");
  if ( !strcmp(&v58, "vlan1") )
    v23 = "selected";
  else
    v23 = "";
  v24 = get_ux_text_common(1440, v22);
  printf("<option value=%s %s> %s", "vlan1", v23, v24);
  if ( !strcmp(&v58, "br0") )
    v17 = "selected";
  v26 = get_ux_text_common(21, v25);
  printf("<option value=%s %s> %s", "br0", v17, v26);
  printf("</select>");
  v28 = (const char *)get_ux_text_common(42, v27);
  printf(v28);
  printf("</span>");
  printf("</td><td class=\"access_main_td\">");
  printf("</td></tr>");
  printf(
    "<tr class=\"access_main_tr\" height=\"24\" style=\"background-color:#%s; display:none;\" name=\"etcline\">\t\t<td cl"
    "ass=\"access_main_td\" style=\"padding:0 0 0 5px;\">",
    "F7F7F7");
  v29 = get_image_dir();
  if ( v59 == 48 )
    v30 = "off";
  else
    v30 = "on";
  printf(
    "<img src=\"/%s/trigger_%s.png\" id=\"synflood_img\" onclick=\"onclick_onoffbtn(this);\" \t\tstyle=\"vertical-align:m"
    "iddle; height:22px; display:inline-block; *display:inline; zoom:1; cursor:pointer;\">\t\t<span class=\"access_main_s"
    "pan\">SYN Flood</span>",
    v29,
    v30);
  if ( v59 == 48 )
    v31 = "off";
  else
    v31 = "on";
  printf("<input type=\"hidden\" name=\"synflood\" value=\"%s\">", v31);
  printf("</td><td class=\"access_main_td\">");
  v32 = get_image_dir();
  if ( v60 == 48 )
    v33 = "off";
  else
    v33 = "on";
  printf(
    "<img src=\"/%s/trigger_%s.png\" id=\"smurf_img\" onclick=\"onclick_onoffbtn(this);\" \t\tstyle=\"vertical-align:midd"
    "le; height:22px; display:inline-block; *display:inline; zoom:1; cursor:pointer;\">\t\t<span class=\"access_main_span\">Smurf</span>",
    v32,
    v33);
  if ( v60 == 48 )
    v34 = "off";
  else
    v34 = "on";
  printf("<input type=\"hidden\" name=\"smurf\" value=\"%s\">", v34);
  printf("</td><td class=\"access_main_td\"></td></tr>");
  printf(
    "<tr class=\"access_main_tr\" height=\"24\"style=\"background-color:#%s; display:none;\" name=\"etcline\">\t\t<td cla"
    "ss=\"access_main_td\" style=\"padding:0 0 0 5px;\">",
    "FFFFFF");
  v35 = get_image_dir();
  if ( v61 == 48 )
    v36 = "off";
  else
    v36 = "on";
  printf(
    "<img src=\"/%s/trigger_%s.png\" id=\"sourceroute_img\" onclick=\"onclick_onoffbtn(this);\" \t\tstyle=\"vertical-alig"
    "n:middle; height:22px; display:inline-block; *display:inline; zoom:1; cursor:pointer;\">\t\t<span class=\"access_mai"
    "n_span\">IP source routing</span>",
    v35,
    v36);
  if ( v61 == 48 )
    v37 = "off";
  else
    v37 = "on";
  printf("<input type=\"hidden\" name=\"sourceroute\" value=\"%s\">", v37);
  printf("</td><td class=\"access_main_td\">");
  v38 = get_image_dir();
  if ( v62 == 48 )
    v39 = "off";
  else
    v39 = "on";
  printf(
    "<img src=\"/%s/trigger_%s.png\" id=\"ipspoof_img\" onclick=\"onclick_onoffbtn(this);\" \t\tstyle=\"vertical-align:mi"
    "ddle; height:22px; display:inline-block; *display:inline; zoom:1; cursor:pointer;\">\t\t<span class=\"access_main_sp"
    "an\">IP Spoofing</span>",
    v38,
    v39);
  if ( v62 == 48 )
    v40 = "off";
  else
    v40 = "on";
  printf("<input type=\"hidden\" name=\"ipspoof\" value=\"%s\">", v40);
  printf("</td><td class=\"access_main_td\"></td></tr>");
  printf(
    "<tr class=\"access_main_tr\" height=\"24\" style=\"background-color:#%s; display:none;\" name=\"etcline\">\t\t<td cl"
    "ass=\"access_main_td\" style=\"padding:0 0 0 5px;\">",
    "F7F7F7");
  v42 = get_image_dir();
  if ( v63 == 48 )
    v43 = "off";
  else
    v43 = "on";
  v44 = get_ux_text_common(215, v41);
  printf(
    "<img src=\"/%s/trigger_%s.png\" id=\"icmpblock_img\" onclick=\"onclick_onoffbtn(this);\" \t\tstyle=\"vertical-align:"
    "middle; height:22px; display:inline-block; *display:inline; zoom:1; cursor:pointer;\">\t\t<span class=\"access_main_"
    "span\">%s</span>",
    v42,
    v43,
    v44);
  if ( v63 == 48 )
    v45 = "off";
  else
    v45 = "on";
  printf("<input type=\"hidden\" name=\"icmpblock\" value=\"%s\">", v45);
  printf("</td><td class=\"access_main_td\">");
  v47 = get_image_dir();
  if ( v64 == 48 )
    v48 = "off";
  else
    v48 = "on";
  v49 = get_ux_text_common(216, v46);
  printf(
    "<img src=\"/%s/trigger_%s.png\" id=\"internal_icmpbk_img\" onclick=\"onclick_onoffbtn(this);\" \t\tstyle=\"vertical-"
    "align:middle; height:22px; display:inline-block; *display:inline; zoom:1; cursor:pointer;\">\t\t<span class=\"access"
    "_main_span\">%s</span>",
    v47,
    v48,
    v49);
  if ( v64 == 48 )
    v50 = "off";
  else
    v50 = "on";
  printf("<input type=\"hidden\" name=\"internal_icmpbk\" value=\"%s\">", v50);
  printf("</td><td class=\"access_main_td\"></td></tr>");
  printf(
    "<tr class=\"access_main_tr\" height=\"24\" style=\"background-color:#%s; display:none;\" name=\"etcline\">\t\t\t<td "
    "class=\"access_main_td\" colspan=\"3\"></td></tr>",
    "FFFFFF");
  printf("<tr class=\"access_main_tr\" height=\"5\" name=\"etcline\" style=\"display:none;\">\t\t<td class=\"access_main_td\" colspan=\"3\" style=\"border-top:1px #CCC solid;\"></td></tr>");
  printf("<tr class=\"access_main_tr\" height=\"24\" name=\"etcline\" style=\"display:none;\">\t\t<td class=\"access_main_td\" colspan=\"2\" align=\"right\">");
  v52 = get_ux_text_common(35, v51);
  printf(
    "<button class=\"access_main_button\" onclick=\"submitDoS(); return ClickEventPropagater(event);\" style=\"width:55px"
    ";\">\t\t%s</button>",
    v52);
  printf("</td><td class=\"access_main_td\">");
  printf("</td></tr>");
  printf("</table>");
  printf("</form>");
  printf("<script>");
  printf("ChangeARPProtection();");
  printf("</script>");
  printf("</td></tr>");
  v53 = printf("</table>");
  if ( is_mobile_agent(v53) )
  {
    print_div_m_str((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v54 = printf("<iframe name=\"hasetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hasetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    print_div_m_etr(v54);
  }
  else
  {
    printf("<iframe name=\"hasetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hasetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v55 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v55);
  printf("</SPAN></td>");
  printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"access_div_msg\">\n");
  printf("</SPAN></td>");
  printf((const char *)&unk_7D215);
  result = printf("<script>init_accesslist();</script>");
  return result;
}
// 108EC: using guessed type int __fastcall read_dos_config(_DWORD);
// 10C40: using guessed type int __fastcall get_csrf_whites(_DWORD);
// 111F8: using guessed type int __fastcall get_arp_protection(_DWORD, _DWORD, _DWORD);
// 113B4: using guessed type int __fastcall get_csrf_op(_DWORD);
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);
// 11D5C: using guessed type int __fastcall accesslist_set_read_config(_DWORD);

//----- (00040374) --------------------------------------------------------
int __fastcall sub_40374(int a1, int a2, int a3, int a4)
{
  int v4; // r5@1
  int v5; // r6@1
  int v6; // r4@1
  int v7; // r7@1

  v4 = a4;
  v5 = a3;
  v6 = a1;
  v7 = a2;
  printf(
    "<TR height=20px ID=%s STYLE=\"cursor:pointer; background-color:#%s;\" ONCLICK=\"clickQosMenu(%d, '%s');\">",
    a1);
  printf("<TD style='width:130px;'><span style='margin-left:  5px; '>%s</span></TD>", v7);
  printf("<TD ID=%s_value CLASS=text_gray style='width:100px;'>%s</TD>", v6, v5);
  return printf("<TD ID=%s_value2 style='width:410px;'>%s</TD></TR>\n", v6, v4);
}

//----- (000403F8) --------------------------------------------------------
int __fastcall sub_403F8(int a1, int a2)
{
  int v2; // r5@1
  void *v3; // r0@1

  v2 = a2;
  printf("<DIV id=\"%s\" style=\"display:none;\">", a1);
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v3 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v3);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:"
    "middle; display:block; text-align:center;\">%s\n",
    v2);
  printf("</SPAN></td>");
  return printf((const char *)&unk_7D215);
}

//----- (000404A8) --------------------------------------------------------
int __fastcall sub_404A8(int a1)
{
  int v1; // r4@1
  int v2; // r0@1
  char *v3; // r6@1
  int v4; // r1@1
  char *v5; // r8@2
  int v6; // r0@4
  int v7; // r1@4
  char *v8; // r8@5
  int v9; // r0@7
  int v10; // r1@7
  char *v11; // r8@8
  int v12; // r0@10
  int v13; // r1@10
  char *v14; // r8@11
  int v15; // r0@13
  int v16; // r1@13
  int v17; // r0@15
  int v18; // r1@15
  int v19; // r0@15
  int v20; // r1@15
  int v21; // r2@15
  unsigned int v22; // r0@16
  unsigned int v23; // r1@16
  int v24; // r1@18
  int v25; // r0@18
  int v26; // r1@18
  int v27; // r2@18
  unsigned int v28; // r0@19
  unsigned int v29; // r1@19
  int v30; // r0@21
  int v31; // r0@21
  int v32; // r5@21
  int v33; // r1@21
  int v34; // r0@21
  int *v36; // [sp+0h] [bp-50h]@1
  char *v37; // [sp+4h] [bp-4Ch]@1
  int (__fastcall *v38)(_DWORD, unsigned int); // [sp+8h] [bp-48h]@0
  char v39; // [sp+Ch] [bp-44h]@1
  unsigned int v40; // [sp+2Ch] [bp-24h]@1
  unsigned int v41; // [sp+30h] [bp-20h]@1
  char v42; // [sp+36h] [bp-1Ah]@1
  char v43; // [sp+37h] [bp-19h]@1

  v1 = a1;
  v41 = 0;
  v40 = 0;
  v43 = 0;
  v42 = 0;
  v36 = (int *)&v41;
  v37 = &v43;
  max_bandwidth_get(a1, &v39, &v40, &v42);
  printf("<style>");
  printf(".dot { width: 4px; height: 4px; background-color: black; margin: 8px; float: left; }");
  printf("</style>");
  v2 = printf("<form method=post action=\"timepro.cgi\" name=\"bandwidth_fm%d\" style='margin: 0;'>\n", v1);
  str(v2);
  printf("<td style='width:25%%;'>\n");
  printf("<div class='dot'></div>");
  v3 = "selected";
  printf("<select name=\"svc\" onChange=\"selectService('%d')\" style='width:100px;'>\n", v1);
  if ( !strcmp(&v39, "userdefine") )
    v5 = "selected";
  else
    v5 = "";
  v6 = get_ux_text_common(1024, v4);
  printf("<option value=\"userdefine\" %s> %s \n", v5, v6);
  if ( !strcmp(&v39, "xdsl") )
    v8 = "selected";
  else
    v8 = "";
  v9 = get_ux_text_common(1036, v7);
  printf("<option value=\"xdsl\" %s> %s \n", v8, v9);
  if ( !strcmp(&v39, "optical") )
    v11 = "selected";
  else
    v11 = "";
  v12 = get_ux_text_common(1035, v10);
  printf("<option value=\"optical\" %s> %s \n", v11, v12);
  if ( !strcmp(&v39, "liteoptical") )
    v14 = "selected";
  else
    v14 = "";
  v15 = get_ux_text_common(1033, v13);
  printf("<option value=\"liteoptical\" %s> %s \n", v14, v15);
  if ( strcmp(&v39, (const char *)&unk_A22E2) )
    v3 = "";
  v17 = get_ux_text_common(1034, v16);
  printf("<option value=\"gigaoptical\" %s> %s \n", v3, v17);
  puts("</select>");
  puts("</td>");
  v19 = get_ux_text_common(154, v18);
  printf("<td style='width:55px;'>%s</td>", v19);
  puts("<td style='width:135px;'>");
  if ( v42 )
  {
    printf("<input type=number name=\"dn\" value=\"%d\" min=0 style='width:60px;'>\n", v40);
  }
  else
  {
    v22 = sub_5BA1C(v40, v20, v21, 0, (int)&v41, (int)&v43, v38);
    sub_5BB1C(v22, v23, 0, 0x3F500000u);
    printf("<input type=number name=\"dn\" value=\"%g\" min=0 style='width:60px;'>\n");
  }
  printf("<span>Mbps</span>");
  puts("</td>");
  v25 = get_ux_text_common(1360, v24);
  printf("<td style='width:45px'>%s</td>", v25);
  puts("<td>");
  if ( v43 )
  {
    printf("<input type=number name=\"up\" value=\"%d\" min=0 style='width:60px;'>\n", v41);
  }
  else
  {
    v28 = sub_5BA1C(v41, v26, v27, 0, (int)v36, (int)v37, v38);
    sub_5BB1C(v28, v29, 0, 0x3F500000u);
    printf("<input type=number name=\"up\" value=\"%g\" min=0 style='width:60px;'>\n");
  }
  printf("<span>Mbps</span>");
  v30 = puts("</td>");
  etr(v30);
  printf("</form>");
  print_blank_line(5, 59);
  printf("<tr>");
  v31 = printf("<td colspan=5 align=right>");
  v32 = hwinfo_get_reboot_duration(v31);
  v34 = get_ux_text_common(35, v33);
  printf(
    "<button type='button' name='bandwidth_submit_button' style='width: 40px;font-size: 12px;height: 20px;padding: 0; mar"
    "gin:2px 10px;' onclick='bandwidthSubmit(%d, %d);'>%s</button>",
    v1,
    v32,
    v34,
    v36,
    v37);
  printf("</td>");
  return printf("</tr>");
}
// 10934: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// 11A5C: using guessed type int __fastcall max_bandwidth_get(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00040800) --------------------------------------------------------
int __fastcall sub_40800(const char *a1)
{
  const char *v1; // r4@1
  const unsigned __int16 **v2; // r0@1
  const char *v3; // r3@1
  int v4; // r1@3

  v1 = a1;
  v2 = _ctype_b_loc();
  v3 = v1;
  while ( (*v2)[*v3] & 8 )
  {
    v4 = (v3++)[1];
    if ( !v4 )
      return atoi(v1);
  }
  return -7;
}

//----- (00040850) --------------------------------------------------------
int __fastcall sub_40850(int a1)
{
  int v1; // r6@1
  int v2; // r2@1
  const char *v3; // r10@2
  char *v4; // r9@2
  int v5; // r0@3
  int v6; // r0@5
  int v7; // r1@9
  int v8; // r7@12
  char v10; // [sp+8h] [bp-B8h]@2
  int v11; // [sp+88h] [bp-38h]@1
  char s; // [sp+8Ch] [bp-34h]@1
  int v13; // [sp+9Ch] [bp-24h]@1

  v1 = a1;
  v11 = 7103844;
  memset(&s, 0, 0x10u);
  tc_count_file_read(&v13);
  v2 = 0;
  while ( 1 )
  {
    v8 = v2 + 1;
    if ( !get_value_array_post(v1, &v11) )
      break;
    v3 = strtok(&v10, " ");
    v4 = strtok(0, " ");
    if ( v3 )
    {
      v5 = atoi(v3);
      class_destroy(v5);
    }
    if ( v4 )
    {
      v6 = atoi(v4);
      class_destroy(v6);
    }
    if ( v3 )
      v3 = (const char *)atoi(v3);
    if ( v4 )
      v7 = atoi(v4);
    else
      v7 = 0;
    class_priority_order_write(v3, v7, -1);
    v2 = v8;
    --v13;
  }
  tc_count_file_write(v13);
  return 0;
}
// 10580: using guessed type int __fastcall tc_count_file_read(_DWORD);
// 1184C: using guessed type int __fastcall class_destroy(_DWORD);
// 11888: using guessed type int __fastcall tc_count_file_write(_DWORD);
// 11A8C: using guessed type int __fastcall get_value_array_post(_DWORD, _DWORD);
// 11ABC: using guessed type int __fastcall class_priority_order_write(_DWORD, _DWORD, _DWORD);

//----- (0004095C) --------------------------------------------------------
int __fastcall sub_4095C(int a1)
{
  int v1; // r5@1
  int v2; // r0@1
  int v3; // r0@3
  int v5; // [sp+0h] [bp-30h]@1

  v1 = a1;
  v2 = get_value_post(a1, "wan_idx", &v5, 32);
  if ( v2 )
    v2 = atoi((const char *)&v5);
  tc_open(v2);
  v3 = sub_40850(v1);
  tc_close(v3);
  tc_reconfig();
  return 0;
}
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 116B4: using guessed type int tc_reconfig(void);
// 11F3C: using guessed type int __fastcall tc_close(_DWORD);
// 12050: using guessed type int __fastcall tc_open(_DWORD);

//----- (000409D0) --------------------------------------------------------
int __fastcall sub_409D0(int a1, int a2, int a3, int a4)
{
  int v4; // r6@1
  int v5; // r4@1
  int v6; // r5@1
  int v7; // r10@1
  signed int v8; // r7@1
  int v9; // r1@1
  const char *v10; // r0@1
  int v11; // r1@1
  const char *v12; // r0@1
  int v13; // r3@1
  int v14; // r1@4
  char *v15; // r1@5
  char *v16; // r0@7
  int v17; // r11@8
  const char *v18; // r0@8
  const char *v19; // r0@11
  int v20; // r1@11
  char *v21; // r0@12
  void *v22; // r1@12
  signed int v23; // r2@15
  int v24; // r0@16
  const char *v25; // r10@19
  char *v26; // r0@23
  const char *v27; // r1@23
  int v28; // r3@26
  int v29; // r3@33
  __int16 v30; // r2@33
  unsigned __int8 v31; // r3@34
  int v32; // r3@37
  int v33; // r3@44
  int v34; // r1@53
  int v35; // r6@53
  int v36; // r0@56
  int v37; // r0@58
  signed int v38; // r1@62
  int v39; // r0@65
  unsigned int v40; // r1@65
  signed int v41; // r1@70
  int v42; // r0@73
  unsigned int v43; // r1@73
  int v44; // r1@76
  int v45; // r2@79
  int v46; // r0@81
  char s[18]; // [sp+4h] [bp-29Ch]@1
  char v49; // [sp+16h] [bp-28Ah]@1
  char dest; // [sp+84h] [bp-21Ch]@1
  char v51; // [sp+95h] [bp-20Bh]@1
  char v52[4]; // [sp+104h] [bp-19Ch]@1
  char v53; // [sp+108h] [bp-198h]@1
  int v54; // [sp+184h] [bp-11Ch]@1
  char v55; // [sp+188h] [bp-118h]@1
  int v56; // [sp+204h] [bp-9Ch]@39
  int v57; // [sp+208h] [bp-98h]@42
  unsigned __int16 v58; // [sp+20Ch] [bp-94h]@33
  __int16 v59; // [sp+20Eh] [bp-92h]@33
  __int16 v60; // [sp+210h] [bp-90h]@43
  __int16 v61; // [sp+212h] [bp-8Eh]@47
  unsigned __int8 v62; // [sp+214h] [bp-8Ch]@36
  char v63; // [sp+216h] [bp-8Ah]@36
  char v64; // [sp+217h] [bp-89h]@4
  char v65; // [sp+237h] [bp-69h]@4
  char v66; // [sp+257h] [bp-49h]@23

  v4 = a3;
  v5 = a1;
  v6 = a2;
  v7 = a4;
  v8 = 0;
  memcpy(s, "isolated, bounded", 0x12u);
  memset(&v49, 0, 0x6Eu);
  memcpy(&dest, "isolated, borrow", 0x11u);
  memset(&v51, 0, 0x6Fu);
  *(_DWORD *)v52 = 0;
  memset(&v53, 0, 0x7Cu);
  v54 = 0;
  memset(&v55, 0, 0x7Cu);
  v10 = (const char *)get_ux_text_common(1048, v9);
  strcpy(v52, v10);
  v12 = (const char *)get_ux_text_common(1047, v11);
  strcpy((char *)&v54, v12);
  v13 = *(_DWORD *)(v4 + 52);
  if ( !(v13 & 1) )
  {
    if ( !(v13 & 2) )
      return 0;
    v8 = 1;
  }
  printf("<tr style='background-color:#%s; height:20px; cursor: pointer;' onclick='loadInputValue(%d);'>");
  printf("<td name='index'><span style='margin-left: 10px;'>%d</span></td>\n", v7 + 1);
  puts("<td name='ip_address'>");
  strcpy(&v64, "");
  strcpy(&v65, "");
  v14 = v8 + 1;
  if ( *(_DWORD *)(v4 + 96 * v8 + 112) > 0x20u )
  {
    strcpy(&v64, (const char *)(v4 + 96 * v14));
    strcpy((char *)&unk_CA5F4, (const char *)(v4 + 96 * v8 + 120));
    strtok((char *)&unk_CA5F4, ".");
    strtok(0, ".");
    strtok(0, ".");
    v15 = strtok(0, ".");
    if ( !v15 )
    {
      strcpy((char *)&unk_CA5F4, "");
      v15 = (char *)&unk_CA5F4;
    }
    v16 = &v65;
    goto LABEL_10;
  }
  v17 = 96 * v14;
  v18 = (const char *)get_twinip_wan_virtual_ip((int)"wan1");
  if ( strcmp((const char *)(v4 + v17), v18) )
  {
    v19 = (const char *)get_twinip_wan_virtual_ip((int)"wan2");
    if ( !strcmp((const char *)(v4 + v17), v19) )
    {
      v21 = &v64;
      v22 = &unk_A2609;
    }
    else
    {
      if ( !*(_BYTE *)(v4 + v17) )
      {
        v24 = get_ux_text_common(20, v20);
        v23 = 64;
        v22 = (void *)v24;
        v21 = &v64;
        goto LABEL_17;
      }
      v21 = &v64;
      v22 = (void *)(v4 + v17);
    }
    v23 = 16;
LABEL_17:
    sf_strncpy(v21, v22, v23);
    goto LABEL_18;
  }
  v15 = "Twin IP";
  v16 = &v64;
LABEL_10:
  strcpy(v16, v15);
LABEL_18:
  if ( (!v5 || (v25 = (const char *)(v5 + 8), !strcmp((const char *)(v5 + 8), "USER_TYPE")))
    && (!v6 || (v25 = (const char *)(v6 + 8), !strcmp((const char *)(v6 + 8), "USER_TYPE"))) )
  {
    v28 = *(_DWORD *)(v4 + 96 * v8 + 92);
    switch ( v28 )
    {
      case 6:
        v27 = "TCP";
        v26 = &v66;
        break;
      case 17:
        v27 = "UDP";
        v26 = &v66;
        break;
      case 255:
        v27 = "TCP/UDP";
        v26 = &v66;
        break;
      default:
        v27 = "";
        v26 = &v66;
        break;
    }
  }
  else if ( !strcmp(v25, "SQ_TYPE") )
  {
    v26 = &v66;
    v27 = "ALL";
  }
  else
  {
    v26 = &v66;
    v27 = v25;
  }
  strcpy(v26, v27);
  v29 = v4 + 96 * v8;
  v30 = *(_WORD *)(v29 + 142);
  LOWORD(v29) = *(_WORD *)(v29 + 140);
  v59 = v30;
  v58 = v29;
  if ( v5 )
    v31 = *(_BYTE *)(v5 + 45);
  else
    v31 = *(_BYTE *)(v6 + 45);
  v62 = v31;
  v63 = *(_DWORD *)(v4 + 96 * v8 + 112) >> 31;
  if ( v5 )
  {
    v32 = *(_DWORD *)(v5 + 40);
    if ( *(_BYTE *)(v5 + 44) )
      v32 = *(_DWORD *)(v5 + 40) << 10;
    v56 = v32;
  }
  else
  {
    v56 = 0;
  }
  if ( !v6 )
    v57 = 0;
  v60 = 0;
  if ( v6 )
  {
    v33 = *(_DWORD *)(v6 + 40);
    if ( *(_BYTE *)(v6 + 44) )
      v33 = *(_DWORD *)(v6 + 40) << 10;
    v57 = v33;
  }
  v61 = 0;
  printf("%s", &v64);
  if ( v65 )
    printf("~%s", &v65);
  puts("</td>");
  puts("<td name='protocol'>");
  printf("%s", &v66);
  print_nbsp(1);
  if ( v59 )
  {
    printf("%d - %d", v58);
  }
  else if ( v58 )
  {
    printf("%d", v58);
  }
  puts("</td>");
  puts("<td name='property'>");
  printf("%s", &s[128 * v62]);
  v35 = v4 + 96 * v8;
  if ( *(_BYTE *)(v35 + 120) || *(_DWORD *)(v35 + 112) )
  {
    if ( v63 )
      v36 = 1028;
    else
      v36 = 1027;
    v37 = get_ux_text_common(v36, v34);
    printf("(%s)\n", v37);
  }
  puts("</td>");
  puts("<td name='download'>");
  if ( v56 )
  {
    if ( v56 << 22 )
    {
      v39 = sub_5BA40(v56);
      sub_5BB1C(v39, v40, 0, 0x3F500000u);
      printf("%gMbps");
    }
    else
    {
      if ( v56 < 0 )
        v38 = v56 + 1023;
      else
        v38 = v56;
      printf("%dMbps", v38 >> 10);
    }
  }
  else
  {
    printf("------");
  }
  puts("</td>");
  puts("<td name='upload'>");
  if ( v57 )
  {
    if ( v57 << 22 )
    {
      v42 = sub_5BA40(v57);
      sub_5BB1C(v42, v43, 0, 0x3F500000u);
      printf("%gMbps");
    }
    else
    {
      if ( v57 < 0 )
        v41 = v57 + 1023;
      else
        v41 = v57;
      printf("%dMbps", v41 >> 10, 0);
    }
  }
  else
  {
    printf("------");
  }
  puts("</td>");
  puts("<td align=right >");
  if ( v5 )
    v44 = *(_DWORD *)v5;
  else
    v44 = 0;
  if ( v6 )
    v45 = *(_DWORD *)v6;
  else
    v45 = 0;
  printf("<input type=checkbox name=\"del\" value=\"%d %d\"\n", v44, v45);
  v46 = puts("</td>");
  etr(v46);
  return 0;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 409D0: using guessed type char s[18];

//----- (00040FFC) --------------------------------------------------------
int __fastcall sub_40FFC(int a1, int a2)
{
  int result; // r0@2
  const unsigned __int16 *v3; // r2@5
  char *v4; // r3@5
  int v5; // t1@6
  char v6; // [sp+0h] [bp-108h]@2

  if ( a1 )
    result = get_value_post(a1, a2, &v6, 256);
  else
    result = get_value(0, a2, &v6, 256);
  if ( !result )
    return result;
  v3 = *_ctype_b_loc();
  v4 = &v6 - 1;
  while ( 1 )
  {
    v5 = (unsigned __int8)(v4++)[1];
    if ( !(v3[v5] & 8) )
      break;
    if ( !v4[1] )
      return atoi(&v6);
  }
  result = -7;
  return result;
}
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00041074) --------------------------------------------------------
int __fastcall sub_41074(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r8@1
  int v4; // r1@1
  int v5; // r6@26
  char *v6; // r0@28
  const char *v7; // r1@28
  char *i; // r0@30
  char *v9; // r0@33
  signed int v10; // r4@33
  int v11; // r5@36
  int v12; // r0@44
  signed int v13; // r6@46
  signed int v14; // r7@53
  signed int v15; // r0@55
  signed int v16; // r2@59
  int v17; // r0@61
  signed int v18; // r5@64
  signed int v19; // r0@66
  int v20; // r0@69
  signed int v21; // r2@71
  int v22; // r0@73
  bool v23; // zf@76
  bool v24; // nf@76
  int v26; // r0@87
  char dest; // [sp+14h] [bp-19Ch]@3
  char v28; // [sp+94h] [bp-11Ch]@36
  int s; // [sp+114h] [bp-9Ch]@1
  int v30; // [sp+118h] [bp-98h]@2
  __int16 v31; // [sp+11Ch] [bp-94h]@17
  __int16 v32; // [sp+11Eh] [bp-92h]@19
  __int16 v33; // [sp+120h] [bp-90h]@5
  __int16 v34; // [sp+122h] [bp-8Eh]@9
  char v35; // [sp+124h] [bp-8Ch]@12
  unsigned __int8 v36; // [sp+125h] [bp-8Bh]@23
  char v37; // [sp+126h] [bp-8Ah]@15
  char v38; // [sp+127h] [bp-89h]@13
  char v39; // [sp+147h] [bp-69h]@13
  char v40; // [sp+167h] [bp-49h]@21
  int v41; // [sp+188h] [bp-28h]@80
  __int16 v42; // [sp+18Ch] [bp-24h]@1
  __int16 v43; // [sp+18Eh] [bp-22h]@1

  v2 = a1;
  v3 = a2;
  v42 = 0;
  v43 = 0;
  memset(&s, 0, 0x74u);
  s = sub_40FFC(v2, (int)"dn");
  if ( s < 0 || (v30 = sub_40FFC(v2, (int)"up"), v30 < 0) )
  {
    v20 = 1428;
    goto LABEL_87;
  }
  v33 = get_value_post(v2, "dnu", &dest, 128) && atoi(&dest) == 1;
  v34 = get_value_post(v2, "unu", &dest, 128) && atoi(&dest) == 1;
  if ( get_value_post(v2, "property", &dest, 128) )
    v35 = atoi(&dest);
  get_ip_value_post(v2, "sip", &v38);
  get_ip_value_post(v2, "eip", &v39);
  if ( get_value_post(v2, "bpichk", &dest, 32) && !strcmp(&dest, "true") )
    v37 = 1;
  if ( get_value_post(v2, "portfrom", &dest, 32) )
    v31 = atoi(&dest);
  if ( get_value_post(v2, "portto", &dest, 32) )
    v32 = atoi(&dest);
  if ( get_value_post(v2, "protocol", &dest, 32) )
    strcpy(&v40, &dest);
  if ( get_value_post(v2, "priority", &dest, 32) )
    v36 = atoi(&dest);
  if ( !strcmp(&v38, &v39) )
    strcpy(&v39, "");
  v5 = 0;
LABEL_27:
  if ( v5 )
  {
    v6 = &dest;
    v7 = &v39;
  }
  else
  {
    v6 = &dest;
    v7 = &v38;
  }
  strcpy(v6, v7);
  for ( i = &dest; ; i = 0 )
  {
    v9 = strtok(i, ".");
    v10 = (signed int)v9;
    if ( !v9 )
    {
      if ( ++v5 != 2 )
        goto LABEL_27;
      if ( get_value_post(v2, "iptype", &v28, 32) && (v11 = atoi(&v28)) != 0 )
      {
        strcpy(&v39, "");
        if ( v11 == 1 )
        {
          v12 = get_twinip_wan_virtual_ip((int)"wan1");
          sf_strncpy(&v38, v12, 16);
        }
      }
      else if ( v39 && check_ippool_range(&v38, &v39) )
      {
        if ( v37 )
          v10 = 2147483648;
        else
          v10 = 33;
      }
      else
      {
        strcpy(&v39, "");
        v10 = 0;
      }
      if ( !strcmp(&v40, "tcpudp") )
      {
        v13 = 255;
      }
      else if ( !strcmp(&v40, "tcp") )
      {
        v13 = 6;
      }
      else if ( !strcmp(&v40, "udp") )
      {
        v13 = 17;
      }
      else
      {
        v13 = 0;
        v31 = 0;
        v32 = 0;
      }
      if ( s )
      {
        if ( v3 == 1 )
          v15 = 2;
        else
          v15 = 3;
        if ( check_bandwidth_limitation(v15) < 0 )
          goto LABEL_69;
        if ( v3 == 1 )
          v16 = 2;
        else
          v16 = 3;
        v17 = class_create("USER_TYPE", 0, v16, s);
        v14 = v17;
        if ( v17 < 0 )
          goto LABEL_74;
        filter_add_to_class(v17, v13, &v38, v10);
      }
      else
      {
        v14 = -2;
      }
      if ( !v30 )
      {
        v18 = -2;
LABEL_76:
        v23 = v18 == 0;
        v24 = v18 < 0;
        if ( v18 > 0 )
        {
          v23 = v14 == 0;
          v24 = v14 < 0;
        }
        if ( !v24 && !v23 )
          class_make_couple(v14, v18);
        tc_count_file_read(&v41);
        if ( v41 > 126 )
        {
          v20 = 1427;
          goto LABEL_87;
        }
        tc_count_file_write(++v41);
        if ( v41 <= v36 )
          v36 = 0;
        return class_priority_order_write(v14, v18, v36);
      }
      if ( v3 == 1 )
        v19 = 4;
      else
        v19 = 5;
      if ( check_bandwidth_limitation(v19) < 0 )
      {
LABEL_69:
        v20 = 1430;
        goto LABEL_87;
      }
      if ( v3 == 1 )
        v21 = 4;
      else
        v21 = 5;
      v22 = class_create("USER_TYPE", 0, v21, v30);
      v18 = v22;
      if ( v22 >= 0 )
      {
        filter_add_to_class(v22, v13, &v38, v10);
        goto LABEL_76;
      }
LABEL_74:
      v20 = 1429;
      goto LABEL_87;
    }
    if ( (unsigned int)atoi(v9) > 0xFF )
      break;
  }
  v20 = 435;
LABEL_87:
  v26 = get_ux_text_common(v20, v4);
  return printf("<script>alert('%s');</script>", v26);
}
// 10580: using guessed type int __fastcall tc_count_file_read(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10A18: using guessed type int __fastcall class_make_couple(_DWORD, _DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11240: using guessed type int __fastcall class_create(_DWORD, _DWORD, _DWORD, _DWORD);
// 114D4: using guessed type int __cdecl filter_add_to_class(_DWORD, _DWORD, _DWORD, _DWORD);
// 11888: using guessed type int __fastcall tc_count_file_write(_DWORD);
// 11ABC: using guessed type int __fastcall class_priority_order_write(_DWORD, _DWORD, _DWORD);
// 11B34: using guessed type int __fastcall check_ippool_range(_DWORD, _DWORD);
// 11CF0: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// 11E88: using guessed type int __fastcall check_bandwidth_limitation(_DWORD);

//----- (000416A4) --------------------------------------------------------
int __fastcall sub_416A4(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r1@1
  int v4; // r4@1
  int v5; // r1@1
  int v6; // r0@1

  v2 = get_ux_text_common(1048, a2);
  v4 = get_ux_text_common(1047, v3);
  v6 = get_ux_text_common(1027, v5);
  return printf(
           "<script>var lang = { sharing_bounded: \"%s\", sharing_borrow: \"%s\", bpi_off: \"%s\" };</script>",
           v2,
           v4,
           v6);
}

//----- (000416E4) --------------------------------------------------------
int print_iframe_trafficconf_qos_menu()
{
  int v0; // r0@1
  int v1; // r1@1

  printf("<style>");
  printf("body { margin: 0; }");
  printf((const char *)&unk_A2794);
  v0 = printf("</style>");
  sub_416A4(v0, v1);
  print_js_file((int)"trafficconf", (int)"qos");
  printf("<table id='menu_list_table' style=\"border-collapse:collapse; border-style:none none none none; width:100%%;\" cellspacing=0px cellpadding=0px>\n");
  printf("</table>");
  return printf("<iframe name=\"trafficconf_qos_menu_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_qos_menu_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (00041758) --------------------------------------------------------
int __fastcall print_iframe_trafficconf_qos_menu_status(int a1)
{
  int v1; // r6@1
  int v2; // r1@1
  int v3; // r0@2
  const char *v4; // r0@4
  int v5; // r1@4
  int v6; // r0@4
  int v7; // r1@4
  int v8; // r0@5
  const char *v9; // r0@13
  int v10; // r1@13
  int v11; // r3@15
  char *v12; // r0@15
  int v13; // r5@16
  int v14; // r1@16
  int v15; // r2@16
  int v16; // r3@16
  unsigned int v17; // r0@16
  unsigned int v18; // r1@16
  __int64 v19; // r0@16
  const char *v20; // r2@16
  int v21; // r1@19
  int v22; // r3@21
  unsigned int v23; // r2@21
  int v24; // r5@22
  int v25; // r1@22
  int v26; // r2@22
  int v27; // r3@22
  unsigned int v28; // r0@22
  unsigned int v29; // r1@22
  __int64 v30; // r0@22
  const char *v31; // r2@22
  char *v32; // r0@22
  int v33; // r0@23
  int v34; // r1@25
  int v35; // r0@25
  int v36; // r0@25
  int v37; // r1@25
  int v38; // r0@26
  const char *v39; // r0@28
  int v40; // r1@28
  int v41; // r0@28
  const char *v42; // r0@30
  __int64 v44; // [sp+0h] [bp-Ch]@4
  int (__fastcall *v45)(_DWORD, unsigned int); // [sp+8h] [bp-4h]@0
  char dest; // [sp+Ch] [bp+0h]@4
  char v47; // [sp+20Ch] [bp+200h]@4
  char s; // [sp+30Ch] [bp+300h]@15
  char v49; // [sp+34Ch] [bp+340h]@4
  char v50; // [sp+36Ch] [bp+360h]@28
  unsigned int v51; // [sp+38Ch] [bp+380h]@4
  unsigned int v52; // [sp+390h] [bp+384h]@4
  int v53; // [sp+394h] [bp+388h]@4
  int v54; // [sp+398h] [bp+38Ch]@1
  char v55; // [sp+39Fh] [bp+393h]@4

  v1 = a1;
  printf("<body style=\"padding:0px 0px; margin:0px 0px;\">");
  printf("<table id='menu_list_table' style=\"border-collapse:collapse; border-style:none none none none; width:100%%;\" cellspacing=0px cellpadding=0px>\n");
  v54 = 0;
  tc_mode_get(&v54);
  if ( v54 )
    v3 = 1104;
  else
    v3 = 1111;
  v4 = (const char *)get_ux_text_common(v3, v2);
  strcpy(&v47, v4);
  strcpy(&dest, "");
  v6 = get_ux_text_common(938, v5);
  sub_40374((int)"onoff", v6, (int)&v47, (int)&dest);
  v53 = 0;
  v52 = 0;
  v51 = 0;
  v55 = 0;
  LOBYTE(v54) = 0;
  tc_mode_get(&v53);
  HIDWORD(v44) = &v55;
  max_bandwidth_get(1, &v49, &v51, &v54);
  if ( !strcmp(&v49, "xdsl") )
  {
    v8 = 1036;
  }
  else if ( !strcmp(&v49, "optical") )
  {
    v8 = 1035;
  }
  else if ( !strcmp(&v49, "liteoptical") )
  {
    v8 = 1033;
  }
  else if ( !strcmp(&v49, (const char *)&unk_A22E2) )
  {
    v8 = 1034;
  }
  else
  {
    v8 = 1024;
  }
  v9 = (const char *)get_ux_text_common(v8, v7);
  strcpy(&v47, v9);
  strcpy(&dest, "");
  if ( (_BYTE)v54 )
  {
    v11 = get_ux_text_common(154, v10);
    v12 = &s;
    LODWORD(v44) = v51;
  }
  else
  {
    if ( v51 << 22 )
    {
      v13 = get_ux_text_common(154, v10);
      v17 = sub_5BA1C(v51, v14, v15, v16, (int)&v52, (int)&v55, v45);
      LODWORD(v19) = sub_5BB1C(v17, v18, 0, 0x3F500000u);
      v20 = "%s[%gMbps] ";
      v11 = v13;
      v44 = v19;
      v12 = &s;
      goto LABEL_19;
    }
    v11 = get_ux_text_common(154, v10);
    v12 = &s;
    LODWORD(v44) = v51 >> 10;
  }
  v20 = "%s[%dMbps] ";
LABEL_19:
  snprintf(v12, 0x20u, v20, v11, (_DWORD)v44);
  strcat(&dest, &s);
  if ( v55 )
  {
    v33 = get_ux_text_common(1360, v21);
    v23 = v52;
    v22 = v33;
  }
  else
  {
    if ( v52 << 22 )
    {
      v24 = get_ux_text_common(1360, v21);
      v28 = sub_5BA1C(v52, v25, v26, v27, v44, SHIDWORD(v44), v45);
      LODWORD(v30) = sub_5BB1C(v28, v29, 0, 0x3F500000u);
      v31 = "%s[%gMbps]";
      v22 = v24;
      v44 = v30;
      v32 = &s;
      goto LABEL_25;
    }
    v22 = get_ux_text_common(1360, v21);
    v23 = v52 >> 10;
  }
  LODWORD(v44) = v23;
  v32 = &s;
  v31 = "%s[%dMbps]";
LABEL_25:
  snprintf(v32, 0x20u, v31, v22, v44);
  strcat(&dest, &s);
  v35 = get_ux_text_common(1023, v34);
  v36 = sub_40374((int)"type", v35, (int)&v47, (int)&dest);
  if ( smart_qos_mode_get(v36) )
    v38 = 1104;
  else
    v38 = 1111;
  v39 = (const char *)get_ux_text_common(v38, v37);
  strcpy(&v47, v39);
  strcpy(&dest, "");
  v41 = get_ux_text_common(1100, v40);
  sub_40374((int)"smartqos", v41, (int)&v47, (int)&dest);
  printf("</table>");
  printf("<script>");
  printf("parent.document.getElementById('menu_list_table').outerHTML = document.getElementById('menu_list_table').outerHTML;");
  if ( get_value(v1, "menu", &v50, 32) )
  {
    if ( strstr(&v50, "setup_tc") )
    {
      v42 = "parent.window.clickQosMenu(0, 'onoff');";
LABEL_35:
      printf(v42);
      goto LABEL_36;
    }
    if ( strstr(&v50, "setup_bandwidth") )
    {
      v42 = "parent.window.clickQosMenu(1, 'type');";
      goto LABEL_35;
    }
    if ( strstr(&v50, (const char *)&unk_A2A2E) )
    {
      v42 = "parent.window.clickQosMenu(2, 'smartqos');";
      goto LABEL_35;
    }
  }
LABEL_36:
  printf("</script>");
  return printf("</body>");
}
// 10748: using guessed type int __fastcall tc_mode_get(_DWORD);
// 1106C: using guessed type int __fastcall smart_qos_mode_get(_DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 11A5C: using guessed type int __fastcall max_bandwidth_get(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00041B6C) --------------------------------------------------------
int print_iframe_trafficonf_qos_list()
{
  int v0; // r0@1
  int v1; // r1@1

  printf("<style>");
  printf("body, td { padding: 0; margin: 0; }");
  printf((const char *)&unk_A2794);
  v0 = printf("</style>");
  sub_416A4(v0, v1);
  print_js_file((int)"trafficconf", (int)"qos");
  puts("<form id='rule_list_form' method=post action=\"timepro.cgi\" name=\"rule_list_fm\" style='margin: 0;'>");
  printf("</form>");
  return printf("<iframe name=\"trafficconf_qos_list_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_qos_list_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (00041BE0) --------------------------------------------------------
int __fastcall print_iframe_trafficonf_qos_list_status(int a1, int a2)
{
  int v2; // r6@1
  int v3; // r5@1
  int v4; // r0@1
  signed int v5; // r4@4
  int v6; // r0@4
  int v7; // r8@4
  int v8; // r7@13
  int v9; // r8@13
  char *v10; // r0@15
  char *v11; // r1@18
  int v12; // r1@20
  int v13; // r0@20
  int v14; // r4@23
  int v15; // r0@24
  int v16; // r10@24
  char v17; // r3@25
  int v18; // r0@25
  int v19; // r1@28
  int v20; // r7@28
  int v21; // r2@28
  int v22; // r3@31
  const char *v23; // r0@34
  void *v24; // r0@36
  int v25; // r1@36
  int v26; // r0@36
  const char *v27; // r1@38
  int v28; // r0@42
  int v29; // r7@42
  const char *v30; // r0@48
  int v31; // r0@51
  int v32; // r0@54
  char v34; // [sp+Ch] [bp-174h]@14
  char v35; // [sp+4Ch] [bp-134h]@20
  char v36; // [sp+10Ch] [bp-74h]@7
  char v37; // [sp+12Ch] [bp-54h]@1
  unsigned int v38; // [sp+14Ch] [bp-34h]@4
  unsigned int v39; // [sp+150h] [bp-30h]@4
  char v40; // [sp+156h] [bp-2Ah]@4
  char v41; // [sp+157h] [bp-29h]@4

  v2 = a1;
  v3 = a2;
  v4 = get_value_post(a2, "act", &v37, 32);
  if ( v4 )
  {
    v4 = strcmp(&v37, "delete");
    if ( !v4 )
      v4 = sub_4095C(v3);
  }
  tc_open(v4);
  v5 = 0;
  print_js_file((int)"trafficconf", (int)"qos");
  printf("<body>");
  puts("<form id='rule_list_form' method=post action=\"timepro.cgi\" name=\"rule_list_fm\" style='margin: 0;'>");
  puts("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  puts("<input type=hidden name=\"smenu\" value=\"trafficconf_qos_list_status\">");
  puts("<input type=hidden name=\"act\" value=\"delete\">");
  v6 = printf("<table cellspacing=0 cellpadding=0 style='width:100%%;'>");
  v39 = 0;
  v38 = 0;
  v41 = 0;
  v40 = 0;
  v7 = smart_qos_mode_get(v6);
  if ( !v7 )
  {
    v14 = 0;
    printf("<colgroup><col width=5%%><col width=20%%><col width=23%%><col width=22%%><col width=9%%><col width=9%%><col width=12%%></colgroup>");
    while ( 1 )
    {
      v15 = class_get(v14);
      v16 = v15;
      if ( !*(_DWORD *)v15 )
      {
LABEL_33:
        v5 = v7 + 1;
        if ( v7 <= 14 )
          v23 = "<script>parent.parent.document.getElementById('userrule_delete_button').style.margin = '';</script>";
        else
          v23 = "<script>parent.parent.document.getElementById('userrule_delete_button').style.margin = '0 17px 0 0';</script>";
        printf(v23);
        printf("<TR id='add_rule_tr' height=20px STYLE=\"background-Color:#%s; cursor:pointer;\" onclick='clearInputValue(%d);'>");
        v24 = get_image_dir();
        printf(
          "<TD style='width:5%%;'><span style='padding-left:10px;'><img src='/%s/pf_new_rule.gif'></span></TD>",
          v24);
        v26 = get_ux_text_common(918, v25);
        printf("<TD colspan=6 align=left style='color:#4789FF; width:95%%;'>%s</TD>", v26);
        printf("</TR>");
        goto LABEL_41;
      }
      v17 = *(_BYTE *)(v15 + 38);
      v18 = *(_DWORD *)(v15 + 248);
      if ( (unsigned __int8)(v17 - 2) <= 1u )
        break;
      if ( !v18 )
      {
        v20 = v7 + 1;
        v19 = v16;
        v21 = v16;
LABEL_31:
        v22 = v7;
        v7 = v20;
        sub_409D0(v18, v19, v21, v22);
      }
      if ( ++v14 == 254 )
        goto LABEL_33;
    }
    if ( v18 )
      v18 = class_find();
    v19 = v18;
    v20 = v7 + 1;
    v18 = v16;
    v21 = v16;
    goto LABEL_31;
  }
  do
  {
    if ( istatus_get_index_info_direct("sqpc+", v5, 0) == -1 )
      break;
    ++v5;
  }
  while ( v5 != 254 );
  printf("<colgroup><col width=5%%><col width=20%%><col width=23%%><col width=22%%><col width=9%%><col width=9%%><col width=12%%></colgroup>");
  max_bandwidth_get(1, &v36, &v38, &v40);
  if ( !v40 )
    v38 >>= 10;
  if ( !v41 )
    v39 >>= 10;
  if ( v5 )
  {
    v38 = sub_5B5A0(v38, v5);
    v39 = sub_5B5A0(v39, v5);
  }
  v8 = 0;
  v9 = 0;
  do
  {
    if ( istatus_get_index_info_direct("sqpc+", v9, &v34) == -1 )
      break;
    v10 = strstr(&v34, "wan");
    if ( v10 && atoi(v10 + 3) == 1 )
    {
      if ( v8 & 1 )
        v11 = "F7F7F7";
      else
        v11 = "FFF";
      ++v8;
      printf("<tr style='background-color:#%s; height:20px;'>", v11);
      printf("<td><span style='margin-left: 10px;'>%d</span></td>\n", v8);
      printf("<td name='ip_address'>");
      printf("%s</td>", &v35);
      printf("<td name='protocol'>ALL</td>");
      v13 = get_ux_text_common(1048, v12);
      printf("<td name='property'>%s</td>", v13);
      printf("<td name='download' align=right>%dMbps</td>", v38);
      printf("<td name='upload' align=right>%dMbps</td>", v39);
      printf("<td align=right ></td>");
    }
    ++v9;
  }
  while ( v9 != 254 );
LABEL_41:
  while ( v5 <= 14 )
  {
    if ( v5 & 1 )
      v27 = "f7f7f7";
    else
      v27 = "ffffff";
    printf("<TR height=20px STYLE=\"background-Color:#%s\"><TD colspan=7></TD></TR>", v27);
    ++v5;
  }
  printf("</table>");
  printf("</form>");
  printf("<script>");
  v28 = printf("parent.document.getElementById('rule_list_form').outerHTML = document.getElementById('rule_list_form').outerHTML;");
  v29 = smart_qos_mode_get(v28);
  if ( get_value_post(v3, "act", &v37, 32) )
  {
    printf("setTimeout(function() { UnMaskIt(parent.parent.document, 'apply_mask'); }, 500);");
    printf("parent.parent.document.getElementsByName('allchk')[0].checked = false;");
  }
  if ( get_value(v2, "menu", &v37, 32) )
  {
    if ( !v29 )
    {
      v30 = "parent.parent.document.getElementById('userrule_delete_button').style.display = '';";
LABEL_53:
      printf(v30);
      goto LABEL_54;
    }
LABEL_49:
    printf("parent.parent.document.getElementById('userrule_delete_button').style.display = 'none';");
    printf("(function sq_init_page() {");
    printf("\tif(!parent.parent.menuWindow(parent.parent.document).getSelectedTr) {");
    printf("\t\tsetTimeout(sq_init_page, 20); return;");
    printf("\t}");
    printf("\tif(!parent.parent.menuWindow(parent.parent.document).getSelectedTr( ))");
    printf("\t\tmenuWindow(parent.parent.document).clickQosMenu(0, 'onoff');");
    printf("})();");
    v30 = "setTimeout(function() { location.href = \"timepro.cgi?tmenu=iframe&smenu=trafficconf_qos_list_status\";}, 3000);";
    goto LABEL_53;
  }
  if ( v29 )
    goto LABEL_49;
  if ( !get_value(v2, "index", &v37, 32) )
  {
    printf("(function qos_init_page() { ");
    printf("\tif(!parent.parent.menuWindow(parent.parent.document).getSelectedTr) {");
    printf("\t\tsetTimeout(qos_init_page, 20); return; ");
    printf("\t}");
    printf("\tif(!parent.parent.menuWindow(parent.parent.document).getSelectedTr())");
    printf("\t\tparent.clearInputValue(parent.getTrIndex(parent.document.getElementById('add_rule_tr')));");
    v30 = "})();";
    goto LABEL_53;
  }
  v31 = atoi(&v37);
  printf("parent.window.loadInputValue(%d, true );", v31);
LABEL_54:
  printf("</script>");
  v32 = printf("</body>");
  return tc_close(v32);
}
// 10BE0: using guessed type int __fastcall istatus_get_index_info_direct(_DWORD, _DWORD, _DWORD);
// 1106C: using guessed type int __fastcall smart_qos_mode_get(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 1133C: using guessed type int class_find(void);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 11A5C: using guessed type int __fastcall max_bandwidth_get(_DWORD, _DWORD, _DWORD, _DWORD);
// 11EF4: using guessed type int __fastcall class_get(_DWORD);
// 11F3C: using guessed type int __fastcall tc_close(_DWORD);
// 12050: using guessed type int __fastcall tc_open(_DWORD);

//----- (00042164) --------------------------------------------------------
int __fastcall print_iframe_trafficconf_qos_setup(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r5@4
  int v4; // r0@6
  int v5; // r0@9
  char *v6; // r1@9
  int v7; // r5@11
  int v8; // r7@13
  int v9; // r8@15
  int v10; // r6@17
  int v11; // r0@24
  int v12; // r6@25
  int v13; // r0@26
  signed int v14; // r5@27
  int v15; // r0@36
  int v16; // r0@37
  int v17; // r7@39
  int v18; // r0@39
  int v19; // r0@44
  int result; // r0@45
  const char *v21; // r0@47
  const char *v22; // r0@54
  char v23; // [sp+8h] [bp-B0h]@19
  char s1; // [sp+28h] [bp-90h]@11
  char v25; // [sp+48h] [bp-70h]@3
  char v26; // [sp+68h] [bp-50h]@1
  int v27; // [sp+88h] [bp-30h]@22
  int v28; // [sp+8Ch] [bp-2Ch]@19
  int v29; // [sp+90h] [bp-28h]@6
  unsigned __int8 v30; // [sp+97h] [bp-21h]@19

  v2 = a2;
  print_js_file((int)"trafficconf", (int)"qos");
  if ( get_value_post(v2, "act", &v26, 32) )
  {
    if ( strstr(&v26, "setup_tc_wan") )
    {
      if ( get_value_post(v2, "run", &v25, 32) )
        v3 = atoi(&v25) & 1;
      else
        v3 = 0;
      v4 = tc_mode_get(&v29);
      if ( v3 != v29 )
        v4 = tc_mode_set(v3);
      goto LABEL_44;
    }
    if ( strstr(&v26, "setup_bandwidth_wan") )
    {
      v5 = get_value_post(v2, "svc", &v25, 32);
      v6 = "";
      if ( v5 )
        v6 = &v25;
      sf_strncpy(&s1, v6, 32);
      v7 = get_value_post(v2, "dn", &v25, 32);
      if ( v7 )
        v7 = sub_40800(&v25);
      v8 = get_value_post(v2, "up", &v25, 32);
      if ( v8 )
        v8 = sub_40800(&v25);
      v9 = get_value_post(v2, "dnu", &v25, 32);
      if ( v9 )
        v9 = (unsigned __int8)atoi(&v25);
      v10 = get_value_post(v2, "upu", &v25, 32);
      if ( v10 )
        v10 = (unsigned __int8)atoi(&v25);
      max_bandwidth_get(1, &v23, &v28, &v30);
      v4 = strcmp(&s1, &v23);
      if ( v4 || v7 != v28 || v30 != v9 || v8 != v27 || (unsigned __int8)v29 != v10 )
      {
        tc_open(v4);
        v11 = max_bandwidth_set(1, &s1, v7, v9);
        tc_close(v11);
        v4 = tc_count_file_write(0);
      }
      goto LABEL_44;
    }
    v12 = lock_file("tc_lock_file");
    if ( !strcmp(&v26, "add") )
    {
      v13 = get_value_post(v2, "wan_idx", &v25, 32);
      if ( v13 )
      {
        v13 = atoi(&v25);
        v14 = v13;
      }
      else
      {
        v14 = 1;
      }
      tc_open(v13);
    }
    else
    {
      if ( !strcmp(&v26, "delete") )
      {
        sub_4095C(v2);
LABEL_43:
        v4 = unlock_file(v12);
LABEL_44:
        v19 = signal_update(v4);
        signal_save(v19);
        goto LABEL_45;
      }
      if ( strcmp(&v26, "modify") )
      {
        if ( !strcmp(&v26, (const char *)&unk_A3405) )
        {
          v17 = smart_qos_mode_get(0);
          v18 = get_value_post(v2, "run", &v25, 32);
          if ( v18 )
            v18 = strcmp(&v25, "1") == 0;
          if ( v18 != v17 )
          {
            smart_qos_mode_set();
            istatus_remove_tag_prefix("sqpc+");
          }
        }
        goto LABEL_43;
      }
      if ( get_value_post(v2, "wan_idx", &v25, 32) )
        v14 = atoi(&v25);
      else
        v14 = 1;
      v15 = tc_count_file_read(&v29);
      tc_open(v15);
      sub_40850(v2);
    }
    v16 = sub_41074(v2, v14);
    tc_close(v16);
    tc_reconfig();
    goto LABEL_43;
  }
LABEL_45:
  puts("<form method=post action=\"timepro.cgi\" name=\"qos_onoff_fm\">");
  puts("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  puts("<input type=hidden name=\"smenu\" value=\"trafficconf_qos_setup\">");
  puts("<input type=hidden name=\"act\" value=\"setup_tc_wan\">");
  puts("<input type=hidden name=\"run\" value=\"\">");
  printf("</form>");
  puts("<form method=post action=\"timepro.cgi\" name=\"qos_wan1_bandwidth_fm\">");
  puts("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  puts("<input type=hidden name=\"smenu\" value=\"trafficconf_qos_setup\">");
  puts("<input type=hidden name=\"act\" value=\"setup_bandwidth_wan1\">");
  puts("<input type=hidden name=\"svc\" value=\"\">");
  puts("<input type=hidden name=\"dn\" value=\"\">");
  printf("<input type=hidden name=\"dnu\" value=\"%d\">\n", 0);
  puts("<input type=hidden name=\"up\" value=\"\">");
  printf("<input type=hidden name=\"upu\" value=\"%d\">\n", 0);
  printf("</form>");
  puts("<form method=post action=\"timepro.cgi\" name=\"qos_smartqos_fm\">");
  puts("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  puts("<input type=hidden name=\"smenu\" value=\"trafficconf_qos_setup\">");
  puts("<input type=hidden name=\"act\" value=\"setup_smartqos_wan1\">");
  puts("<input type=hidden name=\"run\" value=\"\">");
  printf("</form>");
  puts("<form method=post action=\"timepro.cgi\" name=\"qos_rule_fm\">");
  puts("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  puts("<input type=hidden name=\"smenu\" value=\"trafficconf_qos_setup\">");
  puts("<input type=hidden name=\"act\" value=\"\">");
  puts("<input type=hidden name=\"property\" value=\"\">");
  puts("<input type=hidden name=\"priority\" value=\"\">");
  puts("<input type=hidden name=\"dn\" value=\"\">");
  printf("<input type=hidden name=\"dnu\" value=\"%d\">\n", 0);
  puts("<input type=hidden name=\"up\" value=\"\">");
  printf("<input type=hidden name=\"upu\" value=\"%d\">\n", 0);
  puts("<input type=hidden name=\"iptype\" value=\"\">");
  puts("<input type=hidden name=\"sip1\" value=\"\">");
  puts("<input type=hidden name=\"sip2\" value=\"\">");
  puts("<input type=hidden name=\"sip3\" value=\"\">");
  puts("<input type=hidden name=\"sip4\" value=\"\">");
  puts("<input type=hidden name=\"eip1\" value=\"\">");
  puts("<input type=hidden name=\"eip2\" value=\"\">");
  puts("<input type=hidden name=\"eip3\" value=\"\">");
  puts("<input type=hidden name=\"eip4\" value=\"\">");
  puts("<input type=hidden name=\"bpichk\" value=\"\">");
  puts("<input type=hidden name=\"protocol\" value=\"\">");
  puts("<input type=hidden name=\"portfrom\" value=\"\">");
  puts("<input type=hidden name=\"portto\" value=\"\">");
  puts("<input type=hidden name=\"del\" value=\"\">");
  puts("<input type=hidden name=\"wan_idx\" value=\"\">");
  printf("</form>");
  result = get_value_post(v2, "act", &v26, 32);
  if ( !result )
    return result;
  printf("<script>");
  printf("setTimeout(function() {");
  printf("UnMaskIt(parent.document, 'apply_mask');");
  printf("menuWindow(parent.document).document.getElementsByName('trafficconf_qos_menu_status')[0]");
  printf((const char *)&unk_A39C2);
  if ( strstr(&v26, "setup_tc_wan") )
  {
    v21 = "&menu=setup_tc';";
  }
  else if ( strstr(&v26, "setup_bandwidth_wan") )
  {
    v21 = "&menu=setup_bandwidth';";
  }
  else if ( strstr(&v26, "setup_smartqos_wan") )
  {
    v21 = "&menu=setup_smartqos';";
  }
  else
  {
    v21 = "';";
  }
  printf(v21);
  printf("parent.document.getElementsByName('trafficconf_qos_list')[0].contentWindow.document.getElementsByName('trafficconf_qos_list_status')[0]");
  printf((const char *)&unk_A3AF8);
  if ( strstr(&v26, "setup_tc_wan") )
  {
    v22 = "&menu=setup_tc';";
  }
  else if ( strstr(&v26, "setup_bandwidth_wan") )
  {
    v22 = "&menu=setup_bandwidth';";
  }
  else if ( strstr(&v26, "setup_smartqos_wan") )
  {
    v22 = "&menu=setup_smartqos';";
  }
  else
  {
    v22 = "';";
  }
  printf(v22);
  printf("}, 500);");
  result = printf("</script>");
  return result;
}
// 10580: using guessed type int __fastcall tc_count_file_read(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10748: using guessed type int __fastcall tc_mode_get(_DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10970: using guessed type int __fastcall tc_mode_set(_DWORD);
// 10EEC: using guessed type int smart_qos_mode_set(void);
// 11048: using guessed type int __fastcall max_bandwidth_set(_DWORD, _DWORD, _DWORD, _DWORD);
// 1106C: using guessed type int __fastcall smart_qos_mode_get(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 116B4: using guessed type int tc_reconfig(void);
// 11888: using guessed type int __fastcall tc_count_file_write(_DWORD);
// 11A5C: using guessed type int __fastcall max_bandwidth_get(_DWORD, _DWORD, _DWORD, _DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);
// 11F3C: using guessed type int __fastcall tc_close(_DWORD);
// 11F6C: using guessed type int __fastcall istatus_remove_tag_prefix(_DWORD);
// 12050: using guessed type int __fastcall tc_open(_DWORD);
// 1211C: using guessed type int __fastcall lock_file(_DWORD);

//----- (000428AC) --------------------------------------------------------
int __fastcall sub_428AC(const char *a1)
{
  const char *v1; // r4@1
  char *v2; // r4@2
  int v3; // r0@2
  int v4; // r1@2
  char *v5; // r6@3
  int v6; // r0@5
  int v7; // r1@5
  int v8; // r0@7
  int v9; // r0@7
  int v10; // r0@7
  int v11; // r0@7
  int v12; // r4@7
  int v13; // r1@7
  int v14; // r0@7
  signed int v15; // r0@10
  int result; // r0@12
  char *v17; // r4@14
  int v18; // r0@14
  int v19; // r1@14
  char *v20; // r6@15
  int v21; // r0@17
  int v22; // r0@17
  int v23; // r1@17
  int v24; // r0@19
  int v25; // r0@19
  int v26; // r0@19
  int v27; // r1@19
  int v28; // r0@19
  int v29; // r0@20
  int v30; // r1@22
  int v31; // r0@22
  int v32; // r1@22
  int v33; // r0@22
  int v34; // r1@22
  int v35; // r0@22
  int v36; // r1@22
  int v37; // r0@22
  int v38; // r1@22
  int v39; // r0@22
  int v40; // r1@22
  int v41; // r0@22
  int v42; // r1@22
  int v43; // r0@22
  int v44; // r1@22
  int v45; // r0@22
  char *v46; // r1@25
  int v47; // r1@27
  int v48; // r1@27
  const char *v49; // r0@27
  int v50; // r1@27
  int v51; // r0@27
  int v52; // r1@27
  int v53; // r0@27
  int v54; // r1@27
  int v55; // r0@27
  int v56; // r1@27
  int v57; // r0@27
  int v58; // r1@27
  int v59; // r0@27
  int v60; // r1@27
  int v61; // r0@27
  int v62; // r1@27
  int v63; // r0@27
  char dest; // [sp+1Ch] [bp-64h]@23
  char v65; // [sp+3Ch] [bp-44h]@22
  char v66; // [sp+50h] [bp-30h]@22
  char v67; // [sp+64h] [bp-1Ch]@27
  int v68; // [sp+6Ch] [bp-14h]@2

  v1 = a1;
  if ( !strcmp(a1, "onoff") )
  {
    v2 = "";
    v3 = tc_mode_get(&v68);
    str(v3);
    puts("<td colspan=3 style='padding-left: 5px;'>");
    puts("<form method=post action=\"timepro.cgi\" name=\"onoff_fm\" style='margin: 0;'>");
    if ( v68 )
      v5 = "checked";
    else
      v5 = "";
    v6 = get_ux_text_common(1104, v4);
    printf("<input id=\"orun_true\" type=radio name=\"run\" value=1 %s><label for=\"orun_true\">%s</label>", v5, v6);
    print_nbsp(10);
    if ( !v68 )
      v2 = "checked";
    v8 = get_ux_text_common(1111, v7);
    printf("<input id=\"orun_false\" type=radio name=\"run\" value=0 %s><label for=\"orun_false\">%s</label>", v2, v8);
    printf("</form>");
    v9 = puts("</td>");
    etr(v9);
    v10 = print_blank_line(3, 60);
    str(v10);
    v11 = printf("<td colspan=3 align=right>");
    v12 = hwinfo_get_reboot_duration(v11);
    v14 = get_ux_text_common(35, v13);
    printf(
      "<button type='button' name='onoff_submit_button' style='width: 40px;font-size: 12px;height: 20px;padding: 0; margi"
      "n:2px 10px;' onclick='onoffSubmit(%d);'>%s</button>",
      v12,
      v14);
LABEL_20:
    v29 = printf("</td>");
    return etr(v29);
  }
  if ( !strncmp(v1, "type", 4u) )
  {
    if ( !strcmp(v1, "type") )
      v15 = 1;
    else
      v15 = atoi(v1 + 4);
    result = sub_404A8(v15);
  }
  else
  {
    if ( !strcmp(v1, "smartqos") )
    {
      str(0);
      v17 = "";
      puts("<form method=post action=\"timepro.cgi\" name=\"smartqos_fm\" style='margin: 0;'>");
      v18 = printf("<td style='padding-left: 5px;'>");
      if ( smart_qos_mode_get(v18) )
        v20 = "checked";
      else
        v20 = "";
      v21 = get_ux_text_common(1104, v19);
      printf("<input type=radio id=\"srun_true\" name=\"run\" value=1 %s><label for=\"srun_true\">%s</label>", v20, v21);
      v22 = print_nbsp(10);
      if ( !smart_qos_mode_get(v22) )
        v17 = "checked";
      v24 = get_ux_text_common(1111, v23);
      printf(
        "<input type=radio id=\"srun_false\" name=\"run\" value=0 %s><label for=\"srun_false\">%s</label>",
        v17,
        v24);
      printf("</td>");
      v25 = printf("</form>");
      etr(v25);
      v26 = print_blank_line(3, 60);
      str(v26);
      printf("<td colspan=3 align=right>");
      v28 = get_ux_text_common(35, v27);
      printf(
        "<button type='button' name='smartqos_submit_button' style='width: 40px;font-size: 12px;height: 20px;padding: 0; "
        "margin:2px 10px;' onclick='smartqosSubmit();'>%s</button>",
        v28);
      goto LABEL_20;
    }
    result = strcmp(v1, "rule");
    if ( !result )
    {
      printf("<style>");
      printf("#rule_table td select { width:100px; height: 20px; }");
      printf("#rule_table input[type='text'][name^='ip'] { width: 30px !important; padding-left: 2px; }");
      printf((const char *)&unk_A3F98);
      printf("</style>");
      puts("<form method=post action=\"timepro.cgi\" name=\"rule_fm\" style='margin: 0;'>");
      puts("<tr style='height: 22px;'>");
      puts("<td>");
      printf("<div class='dot'></div>");
      puts("<select name=\"property\" onchange='checkChanges(); changedProperty(document);'>");
      v31 = get_ux_text_common(1038, v30);
      printf("<option value=\"%d\" > %s\n", 2, v31);
      v33 = get_ux_text_common(1039, v32);
      printf("<option value=\"%d\" > %s\n", 3, v33);
      puts("</select>");
      puts("</td>");
      printf("<td colspan=3>");
      v35 = get_ux_text_common(1032, v34);
      printf("<span>%s</span>", v35);
      puts((const char *)&unk_A40C6);
      v37 = get_ux_text_common(1049, v36);
      printf("<span style='margin-left:42px;'>%s</span>", v37);
      puts("<input type=number name=\"up\" value=\"0\" min=0 style=\"width:60px; margin-left: 4px; margin-right: 2px; padding-left: 2px;\" onchange='checkChanges();' onkeyup='checkChanges();'><span>Mbps</span>");
      puts("</td>");
      printf("<td align=right>");
      v39 = get_ux_text_common(1043, v38);
      printf(
        "<span>%s</span><input type='number' name='priority' min=1 style='width: 40px; margin: 0 5px; padding-left: 2px;'"
        " onchange='checkChanges();' onkeyup='checkChanges();'>",
        v39);
      printf("</td>");
      puts("</tr>");
      puts("<tr style='height: 22px;'>");
      puts("<td>");
      printf("<div class='dot'></div>");
      puts("<select name=\"iptype\" onchange='changedIptype( document ); checkChanges()'>");
      v41 = get_ux_text_common(1030, v40);
      printf("<option value=\"single\" >%s</option>", v41);
      v43 = get_ux_text_common(1029, v42);
      printf((const char *)&unk_A4387, v43);
      printf("<option value=\"twinip\" >Twin IP</option>");
      v45 = get_ux_text_common(1026, v44);
      printf("<option value=\"all\" >%s</option>", v45);
      puts("</select>");
      puts("</td>");
      puts("<td colspan=3>");
      get_ifconfig((int)"br0", (int)&v66, (int)&v65);
      print_html_ip_address((int)"ip", &v66, 3);
      if ( v66 )
        sf_strncpy(&dest, &v66, 32);
      else
        strcpy(&dest, "");
      strtok(&dest, ".");
      strtok(0, ".");
      strtok(0, ".");
      v46 = strtok(0, ".");
      if ( !v46 )
        v46 = "";
      strcpy(&v67, v46);
      printf("<span id='ip_tilde'>&nbsp;~&nbsp;</span>");
      get_ux_text_common(442, v47);
      printf("<input type=text name=\"%s%d\" maxlength=3 size=3 style=\"width:30px; ime-mode:disabled;\" value=\"%s\" onfocus=\"this.select();\"                    onkeyup=\"IPKeyUp('%s',%d);\" onkeypress=\"return IPKeyDown('%s', %d)\" title=\"%s%d\">");
      printf("<script>");
      printf("if( document.getElementsByName('ip4')[0].addEventListener ) {");
      printf("document.getElementsByName('ip4')[0].addEventListener('keyup', function() { checkChanges()});");
      printf("document.getElementsByName('ip5')[0].addEventListener('keyup', function() { checkChanges()});");
      printf("} else {");
      printf("document.getElementsByName('ip4')[0].attachEvent('keyup', function() { checkChanges()});");
      printf("document.getElementsByName('ip5')[0].attachEvent('keyup', function() { checkChanges()});");
      putchar(125);
      printf("</script>");
      print_nbsp(1);
      printf("<input id=bpi_checkbox type=checkbox name=bpichk style='vertical-align:bottom;' onclick='checkChanges();'>");
      printf("<label id=bpi_text for=bpi_checkbox>");
      v49 = (const char *)get_ux_text_common(1025, v48);
      printf(v49);
      printf("</label>");
      puts("</td>");
      printf("<td align=right>");
      v51 = get_ux_text_common(1044, v50);
      printf(
        "<button type='button' name='pri_up' style='width:70px; font-size:12px; height:20px; padding: 0px; margin: 0 5px "
        "0 0;' onclick='movePriorityUp();'><img src='/images2/fw_up.gif' style='margin:0 3px 3px 0;'>%s</button>",
        v51);
      printf("</td>");
      puts("</tr>");
      puts("<tr style='height: 22px;'>");
      puts("<td>");
      printf("<div class='dot'></div>");
      puts("<select name=\"port_select\" onchange='changedPortSelect( document ); checkChanges();'>");
      v53 = get_ux_text_common(1037, v52);
      printf("<option value=\"manual\" >%s</option>", v53);
      printf("<option value=\"www\" >WWW</option>");
      printf("<option value=\"ms\" >MS stream</option>");
      puts("</select>");
      puts("</td>");
      puts("<td style='width:142px;'>");
      puts("<select name=\"protocol\" style='width:96px;' onchange='checkChanges();changedProtocol(document);'>");
      printf("<option value=\"all\">------</option>");
      printf("<option value=\"tcpudp\">TCP/UDP</option>");
      printf("<option value=\"tcp\">TCP</option>");
      printf("<option value=\"udp\">UDP</option>");
      puts("</select>");
      puts("</td>");
      puts("<td colspan=2 align=left>");
      printf("<input type=number name='portfrom' min=1 max=65535 style='width:55px; float: left;' onchange='checkChanges()'>");
      printf("<span class='port_tilde'>&nbsp;~&nbsp</span>");
      printf("<input type=number name='portto' min=1 max=65535 style='width:55px;' onchange='checkChanges()'>");
      puts("</td>");
      printf("<td align=right>");
      v55 = get_ux_text_common(1042, v54);
      printf(
        "<button type='button' name='pri_down' style='width:70px; font-size:12px; height:20px; padding: 0px; margin: 0 5p"
        "x 0 0;' onclick='movePriorityDown();'><img src='/images2/fw_down.gif' style='margin:0 3px 3px 0;'>%s</button>",
        v55);
      printf("</td>");
      puts("</tr>");
      printf("<tr>");
      printf("<td align='right' colspan=5 style='padding-right:5px; padding-top: 12px;'>");
      printf("<button type='button' name='new_rule_btn' style='width: 60px;font-size: 12px;height: 20px;padding: 0; margin:2px;' onclick='clickNewRuleButton();'>");
      v57 = get_ux_text_common(1031, v56);
      printf("<img src='/images2/pf_plus_icon.gif' style='margin: 1px 2px 1px 1px;'>%s", v57);
      printf("</button>");
      v59 = get_ux_text_common(35, v58);
      printf(
        "<button type='button' name='apply_btn' style='width: 50px;font-size: 12px;height: 20px;padding: 0; margin:2px;' "
        "onclick='ruleSubmit(\"add\");'>%s</button>",
        v59);
      v61 = get_ux_text_common(639, v60);
      printf(
        "<button type='button' name='modify_btn' style='width: 50px;font-size: 12px;height: 20px;padding: 0; margin:2px;'"
        " onclick='ruleSubmit(\"modify\");'>%s</button>",
        v61);
      v63 = get_ux_text_common(64, v62);
      printf(
        "<button type='button' name='cancel_btn' style='width: 50px;font-size: 12px;height: 20px;padding: 0; margin:2px;'"
        " onclick='clickCancelButton();'>%s</button>",
        v63);
      printf("</td>");
      printf("</tr>");
      result = printf("</form>");
    }
  }
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10748: using guessed type int __fastcall tc_mode_get(_DWORD);
// 10934: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 1106C: using guessed type int __fastcall smart_qos_mode_get(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (00043070) --------------------------------------------------------
int __fastcall sub_43070(const char *a1, int a2)
{
  const char *v2; // r4@1
  int v3; // r5@1

  v2 = a1;
  v3 = a2;
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%% ID=%s_table STYLE=\"display:none;\">", a1);
  printf(
    "<tr><td height=20 valign=center style=\"padding:3px;width:130px;\">&nbsp;<b>%s</b></td><td align=right>%s</td></tr>",
    v3);
  printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=5></td></tr>");
  sub_428AC(v2);
  return puts((const char *)&unk_7FF8C);
}

//----- (000430D4) --------------------------------------------------------
int trafficconf_qos()
{
  int v0; // r0@1
  int v1; // r1@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r1@1
  int v9; // r0@1
  int v10; // r1@1
  int v11; // r0@1
  int v12; // r1@1
  int v13; // r0@1
  int v14; // r0@1
  const char *v15; // r0@2
  void *v16; // r4@4
  int v17; // r1@4
  int v18; // r0@4
  int v19; // r0@4
  int v20; // r1@4
  int v21; // r0@4
  int v22; // r1@4
  int v23; // r0@4
  int v24; // r1@4
  int v25; // r0@4
  int v26; // r1@4
  int v27; // r0@4
  int v28; // r0@4
  int v29; // r1@4
  int v30; // r0@4
  int v31; // r1@4
  int v32; // r0@4

  puts("<table class=menu_main_table cellpadding=0px cellspacing=0px style='width:640px; margin: 0;'>");
  printf("<style>");
  printf("input[type='text'], input[type='number'] { border: 1px solid #CCC; padding-left: 2px; }");
  v0 = printf("</style>");
  sub_416A4(v0, v1);
  print_js_file((int)"trafficconf", (int)"qos");
  printf("<tr><td>");
  printf("<table style=\"border-collapse:collapse; border-style:none none none none; width:100%%;\" cellspacing=0px cellpadding=0px>\n");
  printf("<tr><td>");
  printf("<iframe name=\"trafficconf_qos_menu\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_qos_menu\" frameborder=no style='width:100%%; height:60px;'></iframe>");
  printf("</td></tr>");
  printf("<tr style='height:20px; background-color: #DBDBDB; border-top: 1px solid #CCC;'><td>");
  v3 = get_ux_text_common(1046, v2);
  printf("<b style='margin-left: 5px;'>%s</b>", v3);
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=100%% style='background-color:#EEE; border-bottom: 1px solid #CCC;'>");
  printf("<colgroup><col width=5%%><col width=20%%><col width=23%%><col width=22%%><col width=9%%><col width=9%%><col width=12%%></colgroup>");
  printf("<tr style='height: 20px;'>");
  printf("<td></td>");
  v5 = get_ux_text_common(442, v4);
  printf("<td>%s</td>", v5);
  v7 = get_ux_text_common(1007, v6);
  printf("<td>%s</td>", v7);
  v9 = get_ux_text_common(1041, v8);
  printf("<td>%s</td>", v9);
  v11 = get_ux_text_common(154, v10);
  printf("<td>%s</td>", v11);
  v13 = get_ux_text_common(1360, v12);
  printf("<td>%s</td>", v13);
  v14 = printf("<td align=right>");
  if ( smart_qos_mode_get(v14) )
    v15 = "<span id='userrule_delete_button' style='display: none;'>";
  else
    v15 = "<span id='userrule_delete_button'>";
  printf(v15);
  v16 = get_image_dir();
  v18 = get_ux_text_common(143, v17);
  printf("<span style='cursor:pointer;' onclick='deleteUserRule();'><img src='/%s/minus_icon.gif'>%s</span>", v16, v18);
  puts("<input type=checkbox name=\"allchk\" onclick=\"CheckAllCheckBox(document.getElementsByName('trafficconf_qos_list')[0].contentWindow.document, this, 'del');\">");
  printf("</span>");
  v19 = puts("</td>");
  etr(v19);
  printf("</table>");
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<iframe name=\"trafficconf_qos_list\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_qos_list\" frameborder=no style='width:100%%; height:300px;'></iframe>");
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<table cellspacing=0 cellpadding=0 width=100%% style='border-top: 1px solid #CCC;'>");
  puts("<tr id='apply_html' style=\"background-Color:#eeeeee\"><td valign=top colspan=2>");
  v21 = get_ux_text_common(938, v20);
  sub_43070("onoff", v21);
  v23 = get_ux_text_common(1023, v22);
  sub_43070("type", v23);
  v25 = get_ux_text_common(1100, v24);
  sub_43070("smartqos", v25);
  v27 = get_ux_text_common(1022, v26);
  sub_43070("rule", v27);
  printf("</td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("</table>");
  printf("<iframe name=\"trafficconf_qos_setup\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_qos_setup\" frameborder=no style='display:none;'></iframe>");
  printf("</td></tr>");
  printf("<script>");
  printf("DisableObj(document.getElementsByName('ip1')[0]);");
  printf("DisableObj(document.getElementsByName('ip2')[0]);");
  printf("DisableObj(document.getElementsByName('ip3')[0]);");
  v28 = printf("</script>");
  print_end_main_table(v28);
  v30 = get_ux_text_common(34, v29);
  sub_403F8((int)"apply_mask", v30);
  v32 = get_ux_text_common(1346, v31);
  return sub_403F8((int)"reboot_mask", v32);
}
// 1106C: using guessed type int __fastcall smart_qos_mode_get(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 115DC: using guessed type int __fastcall print_end_main_table(_DWORD);

//----- (00043400) --------------------------------------------------------
int __fastcall sub_43400(signed __int64 a1, char *a2)
{
  char *v2; // r6@1
  int v3; // r7@3
  int v4; // r0@3
  const char *v5; // r1@3
  int v6; // r3@3
  char *v7; // r0@3
  int v9; // r0@6

  v2 = a2;
  if ( (unsigned __int64)a1 > 0x40000000 )
  {
    v3 = a1 >> 30;
    v6 = calc_mask(a1 & 0x3FFFFFFF, 108003328);
    v5 = "%d.%d GB";
    v7 = v2;
    return sprintf(v7, v5, v3, v6);
  }
  if ( (unsigned int)a1 > 0x100000 )
  {
    v3 = (unsigned int)a1 >> 20;
    v4 = sub_5C530(a1 & 0xFFFFF, 105472LL);
    v5 = "%d.%d MB";
    v6 = v4;
    v7 = v2;
    return sprintf(v7, v5, v3, v6);
  }
  if ( (unsigned int)a1 <= 0x400 )
    return sprintf(a2, "%d B", (_DWORD)a1);
  v3 = (unsigned int)a1 >> 10;
  v9 = sub_5C530(a1 & 0x3FF, 103LL);
  v5 = "%d.%d KB";
  v6 = v9;
  v7 = v2;
  return sprintf(v7, v5, v3, v6);
}

//----- (000434EC) --------------------------------------------------------
FILE *__fastcall sub_434EC(int a1)
{
  int v1; // r5@1
  const char *v2; // r0@1
  FILE *result; // r0@1
  char *v4; // r10@3
  char *v5; // r0@4
  const char *v6; // r7@4
  const char *v7; // r0@7
  char *v8; // r0@8
  const char *v9; // r7@8
  int v10; // r7@11
  char *v11; // r0@14
  const char *v12; // r7@14
  char *v13; // r0@20
  const char *v14; // r8@20
  char *v15; // r0@23
  int *v16; // r2@24
  int *v17; // r3@24
  in_addr_t i; // r9@27
  int v19; // r0@33
  int v20; // r3@34
  int v21; // r3@36
  __int64 v22; // r0@39
  int v23; // r2@39
  int v24; // r3@39
  __int64 v25; // r0@39
  unsigned int *v26; // r0@42
  unsigned int *v27; // r8@42
  in_addr_t *v28; // r7@42
  int v29; // r0@49
  in_addr_t v30; // r3@50
  int v31; // r3@52
  int v32; // r2@55
  in_addr_t v33; // r3@55
  bool v34; // zf@55
  unsigned int v35; // r1@65
  unsigned int v36; // r2@65
  unsigned int v37; // r3@77
  int *v38; // r2@81
  int *v39; // r3@81
  FILE *stream; // [sp+0h] [bp-2B8h]@1
  in_addr_t v41; // [sp+4h] [bp-2B4h]@2
  int v42; // [sp+8h] [bp-2B0h]@1
  in_addr_t v43; // [sp+Ch] [bp-2ACh]@1
  in_addr_t v44; // [sp+10h] [bp-2A8h]@2
  in_addr_t v45; // [sp+14h] [bp-2A4h]@2
  char v46; // [sp+18h] [bp-2A0h]@3
  in_addr_t v47; // [sp+218h] [bp-A0h]@3
  in_addr_t v48; // [sp+22Ch] [bp-8Ch]@25
  int v49; // [sp+230h] [bp-88h]@24
  int v50; // [sp+238h] [bp-80h]@25
  int v51; // [sp+240h] [bp-78h]@24
  char s2; // [sp+254h] [bp-64h]@2
  char v53; // [sp+268h] [bp-50h]@2
  char v54; // [sp+27Ch] [bp-3Ch]@2

  v1 = a1;
  v42 = lock_file("trafficconf_conninfo_connection_lock_file");
  v2 = (const char *)get_twinip_wan_virtual_ip((int)"wan1");
  v43 = inet_addr(v2);
  system("cat /proc/net/ip_conntrack > /var/run/ip_conntrack");
  result = fopen("/var/run/ip_conntrack", "r");
  stream = result;
  if ( !result )
    return result;
  get_ifconfig((int)"br0", (int)&s2, (int)&v53);
  v44 = inet_addr(&s2);
  v41 = inet_addr(&v53);
  get_wan_ip("wan1", &v54);
  v45 = inet_addr(&v54);
LABEL_78:
  while ( fgets(&v46, 512, stream) )
  {
    memset(&v47, 0, 0x38u);
    v4 = strtok(&v46, " ");
    if ( strcmp(v4, "EXPECTING:") )
    {
      do
      {
        v5 = strtok(0, " ");
        v6 = v5;
      }
      while ( v5 && strncmp(v5, "src=", 4u) );
      sscanf(v6, "src=%s", &v54);
      v47 = inet_addr(&v54);
      if ( v47 == -1 )
      {
        v7 = "Data format is wrong!<BR>";
LABEL_44:
        puts(v7);
      }
      else
      {
        do
        {
          v8 = strtok(0, " ");
          v9 = v8;
        }
        while ( v8 && strncmp(v8, "dst=", 4u) );
        sscanf(v9, "dst=%s", &v54);
        if ( strcmp(&v54, &s2) )
        {
          v10 = (v44 ^ v47) & v41;
          if ( !v10 )
            goto LABEL_20;
          if ( v45 == v47 || v43 == v47 )
          {
            v10 = 0;
LABEL_20:
            while ( 1 )
            {
              v13 = strtok(0, " ");
              v14 = v13;
              if ( !v13 )
                break;
              if ( !strncmp(v13, "org=", 4u) )
              {
                if ( v10 )
                {
                  v38 = (int *)&v48;
                  v39 = &v50;
                }
                else
                {
                  v38 = &v49;
                  v39 = &v51;
                }
                sscanf(v14, "org=%d:%llu", v38, v39, stream);
                v15 = strtok(0, " ");
                if ( v10 )
                {
                  v16 = &v49;
                  v17 = &v51;
                }
                else
                {
                  v16 = (int *)&v48;
                  v17 = &v50;
                }
                sscanf(v15, "rpl=%d:%llu", v16, v17);
                break;
              }
            }
            for ( i = *(_DWORD *)v1; i; i = *(_DWORD *)(i + 52) )
            {
              if ( *(_DWORD *)i == v47 )
              {
                if ( !strcmp(v4, "tcp") )
                {
                  ++*(_DWORD *)(i + 4);
                }
                else if ( !strcmp(v4, "udp") )
                {
                  ++*(_DWORD *)(i + 8);
                }
                else
                {
                  v19 = strcmp(v4, "icmp");
                  if ( v19 )
                    v20 = *(_DWORD *)(i + 16);
                  else
                    v20 = *(_DWORD *)(i + 12);
                  v21 = v20 + 1;
                  if ( v19 )
                    *(_DWORD *)(i + 16) = v21;
                  else
                    *(_DWORD *)(i + 12) = v21;
                }
                v22 = *(_QWORD *)(i + 32);
                *(_DWORD *)(i + 20) += v48;
                v23 = *(_DWORD *)(i + 24);
                v24 = v49;
                *(_QWORD *)(i + 32) = v22 + *(_QWORD *)&v50;
                v25 = *(_QWORD *)(i + 40);
                *(_DWORD *)(i + 24) = v23 + v24;
                *(_QWORD *)(i + 40) = v25 + *(_QWORD *)&v51;
                goto LABEL_78;
              }
            }
            v26 = (unsigned int *)malloc(0x38u);
            v27 = v26;
            v28 = v26;
            if ( !v26 )
            {
              v7 = "Out of memory!";
              goto LABEL_44;
            }
            memset(v26, 0, 0x38u);
            *v28 = v47;
            if ( !strcmp(v4, "tcp") )
            {
              ++v28[1];
            }
            else if ( !strcmp(v4, "udp") )
            {
              ++v28[2];
            }
            else
            {
              v29 = strcmp(v4, "icmp");
              if ( v29 )
                v30 = v28[4];
              else
                v30 = v28[3];
              v31 = v30 + 1;
              if ( v29 )
                v28[4] = v31;
              else
                v28[3] = v31;
            }
            v28[5] = v48;
            *((_QWORD *)v28 + 4) = *(_QWORD *)&v50;
            v28[6] = v49;
            v32 = v51;
            *((_QWORD *)v28 + 5) = *(_QWORD *)&v51;
            v33 = *(_DWORD *)v1;
            v34 = *(_DWORD *)v1 == 0;
            if ( *(_DWORD *)v1 )
            {
              v33 = *(_DWORD *)(v1 + 4);
              v32 = 0;
            }
            else
            {
              v28[13] = 0;
              v28[12] = 0;
            }
            if ( v34 )
            {
              *(_DWORD *)(v1 + 4) = v28;
              *(_DWORD *)v1 = v28;
            }
            else
            {
              v28[13] = v32;
              v28[12] = v33;
              *(_DWORD *)(v33 + 52) = v28;
            }
            if ( !v34 )
              *(_DWORD *)(v1 + 4) = v28;
            do
            {
              v37 = v27[12];
              if ( !v37 )
                break;
              if ( __rev(*v27) < __rev(*(_DWORD *)v37) )
              {
                v35 = v27[13];
                v36 = *(_DWORD *)(v37 + 48);
                *(_DWORD *)(v37 + 52) = v35;
                if ( v35 )
                  *(_DWORD *)(v35 + 48) = v37;
                else
                  *(_DWORD *)(v1 + 4) = v37;
                if ( v36 )
                {
                  v27[13] = v37;
                  *(_DWORD *)(v37 + 48) = v27;
                }
                else
                {
                  *(_DWORD *)(v37 + 48) = v27;
                }
                if ( v36 )
                {
                  v27[12] = v36;
                  *(_DWORD *)(v36 + 52) = v27;
                }
                else
                {
                  v27[13] = v37;
                  v27[12] = 0;
                }
                if ( !v36 )
                  *(_DWORD *)v1 = v27;
              }
              v27 = (unsigned int *)v27[12];
            }
            while ( v27 );
          }
          else
          {
            do
            {
              v11 = strtok(0, " ");
              v12 = v11;
            }
            while ( v11 && strncmp(v11, "src=", 4u) );
            sscanf(v12, "src=%s", &v54);
            v47 = inet_addr(&v54);
            if ( v47 != -1 )
            {
              v10 = 1;
              goto LABEL_20;
            }
          }
        }
      }
    }
  }
  fclose(stream);
  unlink("/var/run/ip_conntrack");
  result = (FILE *)unlock_file(v42);
  return result;
}
// 119B4: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);
// 1211C: using guessed type int __fastcall lock_file(_DWORD);

//----- (00043A24) --------------------------------------------------------
int sub_43A24()
{
  return get_file_value("/proc/sys/net/nf_conntrack_max", 1);
}
// 10D3C: using guessed type int __fastcall get_file_value(_DWORD, _DWORD);

//----- (00043A34) --------------------------------------------------------
int __fastcall sub_43A34(unsigned int a1, unsigned int a2, unsigned int a3, unsigned int a4, int a5)
{
  unsigned int v5; // r9@1
  unsigned int v6; // r7@1
  unsigned int v7; // r11@1
  unsigned int v8; // r10@1
  int v9; // r5@1
  int v10; // r4@1
  unsigned int v11; // r8@1
  unsigned int v12; // r0@1
  int v13; // r2@1
  int v14; // r3@1
  unsigned int v15; // r0@1
  int v16; // r2@1
  int v17; // r3@1
  int v18; // r0@1
  signed int v19; // r6@2
  unsigned int v20; // ST04_4@5
  unsigned int v21; // ST00_4@5
  unsigned int v22; // r0@5
  int v23; // r2@5
  unsigned int v24; // r0@5
  int v25; // r2@5
  unsigned int v26; // r0@5
  unsigned int v27; // r3@5
  int v28; // r2@5
  int v29; // r1@5
  int v30; // r0@5
  int v31; // ST0C_4@7
  unsigned int v32; // ST08_4@7
  unsigned int v33; // ST04_4@7
  unsigned int v34; // r0@7
  int v35; // r3@7
  unsigned int v36; // r0@7
  int v37; // r2@7
  int v38; // r0@8
  unsigned int v39; // ST0C_4@9
  unsigned int v40; // ST04_4@9
  unsigned int v41; // r0@9
  int v42; // r3@9
  unsigned int v43; // r0@9
  int v44; // r2@9
  int v45; // r3@9
  int v46; // r0@10
  unsigned int v47; // r0@11
  int v48; // r2@11
  int v49; // r3@11
  unsigned int v50; // ST04_4@11
  unsigned int v51; // r0@11
  int v52; // r3@11
  signed int v53; // r0@12
  int v54; // r1@14
  unsigned int v55; // r0@15
  int v56; // r2@15
  int v57; // r3@15
  unsigned int v58; // r0@15
  int v59; // r2@15
  int v60; // r3@15
  int v61; // r0@15
  unsigned int v62; // r0@15
  unsigned int v63; // r0@17
  int v64; // r2@17
  int v65; // r3@17
  unsigned int v66; // r0@17
  int v67; // r2@17
  int v68; // r3@17
  int v69; // r0@17
  unsigned int v70; // r0@17
  unsigned int v71; // r0@19
  int v72; // r2@19
  int v73; // r3@19
  unsigned int v74; // r0@19
  int v75; // r2@19
  int v76; // r3@19
  int v77; // r0@19
  unsigned int v78; // r0@19
  int v79; // r7@21
  unsigned int v80; // r0@21
  int v81; // r2@21
  int v82; // r3@21
  unsigned int v83; // r0@21
  int v84; // r2@21
  int v85; // r3@21
  int v86; // r0@21
  unsigned int v87; // r0@21
  int v88; // r1@22
  int v89; // r0@22
  unsigned int v91; // [sp+0h] [bp-40h]@5
  signed int v92; // [sp+Ch] [bp-34h]@14
  int v93; // [sp+10h] [bp-30h]@6
  unsigned int v94; // [sp+14h] [bp-2Ch]@1

  v5 = a2;
  v6 = a1;
  v7 = a3;
  v8 = a4;
  v9 = a2 + a1 + a3 + a4;
  v10 = sub_43A24();
  v11 = sub_5C130(v9);
  v12 = sub_5C130(v10);
  v15 = sub_5C374(v11, v12, v13, v14);
  v18 = sub_5C1DC(v15, 0x42C80000u, v16, v17);
  v94 = sub_5C4D4(v18);
  if ( a5 )
  {
    printf("<table border='0' cellpadding='0' cellspacing='0' width='%d'>\n", 420);
    v19 = 380;
    puts("<tr>");
    printf("<td width='%d'><font color='gray'>0</td>\n", 95);
    printf("<td width='%d'><font color='gray'>2</td>\n", 99);
    printf("<td width='%d'><font color='gray'>10</td>\n", 99);
    printf("<td width='%d'><font color='gray'>50</td>\n", 99);
    printf("<td width='10'><font color='gray'>100%%</td>\n");
    puts("<td width='38'></td>");
    puts("</tr>");
    puts("</table>");
  }
  else
  {
    v19 = 212;
  }
  if ( v9 > v10 / 2 )
  {
    v20 = sub_5C130(3 * v19 >> 2);
    v21 = sub_5C130(v10 / -2 + v9);
    v22 = sub_5C130(v10 / -2 + v10);
    v91 = sub_5C374(v21, v22, v23, v21);
    v24 = sub_5C130((unsigned int)v19 >> 2);
    v26 = sub_5C1DC(v91, v24, v25, v91);
    v28 = v20;
    v29 = v26;
    v30 = v20;
LABEL_10:
    v46 = sub_5BF98(v30, v29, v28, v27);
    goto LABEL_12;
  }
  v93 = calc_mask(v10, 10);
  if ( v9 > v93 )
  {
    v31 = calc_mask(v10, -10);
    v32 = sub_5C130((unsigned int)v19 >> 1);
    v33 = sub_5C130(v31 + v9);
    v34 = sub_5C130(v31 + v10 / 2);
    v91 = sub_5C374(v33, v34, v33, v35);
    v36 = sub_5C130((unsigned int)v19 >> 2);
    v29 = sub_5C1DC(v91, v36, v37, v91);
    v30 = v32;
    goto LABEL_10;
  }
  v38 = calc_mask(v10, 50);
  if ( v9 > v38 )
  {
    v39 = sub_5C130(v19 >> 2);
    v91 = calc_mask(v10, -50);
    v40 = sub_5C130(v91 + v9);
    v41 = sub_5C130(v91 + v93);
    v43 = sub_5C374(v40, v41, v40, v42);
    v29 = sub_5C1DC(v43, v39, v44, v45);
    v30 = v39;
    goto LABEL_10;
  }
  v91 = v19 >> 2;
  v47 = sub_5C130(v38);
  v50 = sub_5C374(v11, v47, v48, v49);
  v51 = sub_5C130(v19 >> 2);
  v46 = sub_5C1DC(v50, v51, v50, v52);
LABEL_12:
  v53 = sub_5C4D4(v46);
  if ( v53 < 5 )
    v53 = 5;
  v92 = v53;
  printf("<table border='0' cellpadding='0' cellspacing='0' style='border: 1px solid #CCC;' width='%d'>\n", v19 + 40);
  puts((const char *)&unk_A5804);
  puts((const char *)&unk_A57B8);
  printf("\t\t\t<table border='0' cellpadding='0' cellspacing='1' width='%d'>\n", v92);
  puts((const char *)&unk_A5801);
  if ( v6 )
  {
    v55 = sub_5C130(v6);
    v58 = sub_5C374(v55, v11, v56, v57);
    v61 = sub_5C1DC(v58, 0x42C80000u, v59, v60);
    v62 = sub_5C4D4(v61);
    printf("\t\t\t\t\t<td width='%d%%' height='9' bgcolor='#4D9DCE' title='TCP %d'></td>\n", v62, v6);
  }
  if ( v5 )
  {
    v63 = sub_5C130(v5);
    v66 = sub_5C374(v63, v11, v64, v65);
    v69 = sub_5C1DC(v66, 0x42C80000u, v67, v68);
    v70 = sub_5C4D4(v69);
    printf("\t\t\t\t\t<td width='%d%%' height='9' bgcolor='#FD8116' title='UDP %d'></td>\n", v70, v5);
  }
  if ( v7 )
  {
    v71 = sub_5C130(v7);
    v74 = sub_5C374(v71, v11, v72, v73);
    v77 = sub_5C1DC(v74, 0x42C80000u, v75, v76);
    v78 = sub_5C4D4(v77);
    printf("\t\t\t\t\t<td width='%d%%' height='9' bgcolor='#74CA2D' title='ICMP %d'></td>\n", v78, v7);
  }
  if ( v8 )
  {
    v79 = get_ux_text_common(1358, v54);
    v80 = sub_5C130(v8);
    v83 = sub_5C374(v80, v11, v81, v82);
    v86 = sub_5C1DC(v83, 0x42C80000u, v84, v85);
    v87 = sub_5C4D4(v86);
    printf("\t\t\t\t\t<td width='%d%%' height='9' bgcolor='#F0C800' title='%s %d'></td>\n", v87, v79, v8, v91);
  }
  puts((const char *)&unk_A592E);
  puts((const char *)&unk_A5938);
  puts((const char *)&unk_A5944);
  printf("\t\t<td width='%d'></td>", v19 - v92);
  sub_5B744(100 * v9, v10);
  v89 = calc_mask(100 * v88, v10);
  printf("\t\t<td width='96' align='center'><font color='gray'>%d.%02d%% (%d)</td>\n", v94, v89, v9, v91);
  puts((const char *)&unk_A5931);
  return puts("</table>");
}

//----- (00043EE4) --------------------------------------------------------
int print_iframe_trafficconf_conninfo_info()
{
  printf("<style>");
  printf("body { margin: 0; }");
  printf("table { border: 0; }");
  printf("#conninfo_info_table >tbody >tr >td { background-color:#FFF; }");
  printf("#conninfo_info_table >tbody >tr >td { background-color: inehrit; }");
  printf("</style>");
  printf("<body>");
  printf("<table id=conninfo_info_table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=100%% style='background-color:#EEE;'>");
  printf("</table>");
  printf("<iframe name=\"trafficconf_conninfo_info_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_conninfo_info_status\" frameborder=no style='display:none;'></iframe>");
  printf("<iframe name=\"trafficconf_conninfo_info_submit\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_conninfo_info_submit\" frameborder=no style='display:none;'></iframe>");
  return printf("</body>");
}

//----- (00043F7C) --------------------------------------------------------
int print_iframe_trafficconf_conninfo_info_status()
{
  int v0; // r4@1
  int v1; // r6@2
  signed int v2; // r3@2
  signed int v3; // r10@4
  char *v4; // r0@5
  int v5; // r0@5
  int v6; // r7@5
  char *v7; // r1@6
  const char *v8; // r0@8
  char *v9; // r0@9
  const char *v10; // r1@9
  const char *v11; // r0@10
  int v12; // r6@20
  int v13; // ST10_4@20
  int v14; // ST0C_4@20
  int v15; // r0@20
  char *v16; // r1@22
  const char *v17; // r0@25
  char *v18; // r1@28
  int v19; // r0@30
  int v20; // r0@30
  char *v21; // r1@31
  const char *v22; // r0@34
  char *v23; // r1@37
  int v24; // r0@39
  char *v25; // r1@42
  signed int v26; // r6@40
  signed int v28; // [sp+14h] [bp-264h]@4
  int v29; // [sp+18h] [bp-260h]@1
  char v30; // [sp+20h] [bp-258h]@17
  char v31; // [sp+120h] [bp-158h]@24
  char s; // [sp+1A0h] [bp-D8h]@5
  char v33; // [sp+1CCh] [bp-ACh]@16
  char v34; // [sp+20Ch] [bp-6Ch]@9
  char v35; // [sp+220h] [bp-58h]@5
  char s2; // [sp+234h] [bp-44h]@1
  int v37; // [sp+248h] [bp-30h]@1
  int v38; // [sp+24Ch] [bp-2Ch]@1

  v29 = sub_43A24();
  v37 = 0;
  v38 = 0;
  sub_434EC((int)&v37);
  get_wan_ip("wan1", &s2);
  printf("<body>");
  printf("<table id=conninfo_info_table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=100%% style='background-color:#EEE;'>");
  v0 = v37;
  if ( !v37 )
    goto LABEL_46;
  v1 = v37;
  v2 = 0;
  do
  {
    v1 = *(_DWORD *)(v1 + 52);
    ++v2;
  }
  while ( v1 );
  v28 = v2;
  v3 = 0;
  do
  {
    v4 = inet_ntoa(*(struct in_addr *)v0);
    sf_strncpy(&v35, v4, 20);
    memset(&s, 0, 0x6Cu);
    v5 = dhcpd_get_dynamic_lease(&v35, &s);
    str(v5);
    v6 = v3 & 1;
    if ( v3 & 1 )
      v7 = "background-color:#F7F7F7;";
    else
      v7 = "";
    printf("<td rowspan=2 width=170 style='padding-left: 5px; height:42px; %s'>\n", v7);
    v8 = (const char *)get_twinip_wan_virtual_ip((int)"wan1");
    if ( !strcmp(&v35, v8) )
    {
      v9 = &v34;
      v10 = "Twin IP(1)";
LABEL_12:
      strcpy(v9, v10);
      goto LABEL_16;
    }
    v11 = (const char *)get_twinip_wan_virtual_ip((int)"wan2");
    if ( !strcmp(&v35, v11) )
    {
      v10 = "Twin IP(2)";
      v9 = &v34;
      goto LABEL_12;
    }
    if ( !strcmp(&v35, &s2) )
    {
      v9 = &v34;
      v10 = "CPU(WAN1)";
      goto LABEL_12;
    }
    sf_strncpy(&v34, &v35, 20);
LABEL_16:
    printf("%s", &v34);
    if ( v33 )
    {
      memset(&v30, 0, 0x100u);
      convert_euckr_to_utf8(&v33, &v30);
      printf("<br>(%s)", &v30);
    }
    puts("</td>");
    printf("<td rowspan=2 width=267px %s>\n");
    if ( v29 )
    {
      sub_43A34(*(_DWORD *)(v0 + 4), *(_DWORD *)(v0 + 8), *(_DWORD *)(v0 + 12), *(_DWORD *)(v0 + 16), 0);
    }
    else
    {
      v12 = *(_DWORD *)(v0 + 8);
      v13 = *(_DWORD *)(v0 + 4);
      v14 = *(_DWORD *)(v0 + 12);
      v15 = get_ux_text_common(1358, *(_DWORD *)(v0 + 4));
      printf(
        "<span style='font: normal normal normal 10px arial;'>TCP: %d, UDP: %d, ICMP: %d, %s: %d</span>",
        v13,
        v12,
        v14,
        v15,
        *(_DWORD *)(v0 + 16));
    }
    puts("</td>");
    if ( v3 & 1 )
      v16 = "background-color:#F7F7F7;";
    else
      v16 = "";
    ++v3;
    printf("<td width=92px style='vertical-align:bottom; %s'>%d</td>\n", v16, *(_DWORD *)(v0 + 20));
    sub_43400(*(_QWORD *)(v0 + 32), &v31);
    if ( v28 <= 8 )
      v17 = "<td width=109 style='vertical-align: bottom; %s'>%s</td>\n";
    else
      v17 = "<td width=94 style='vertical-align: bottom; %s'>%s</td>\n";
    if ( v6 )
      v18 = "background-color:#F7F7F7;";
    else
      v18 = "";
    v19 = printf(v17, v18, &v31);
    v20 = etr(v19);
    str(v20);
    if ( v6 )
      v21 = "background-color:#F7F7F7;";
    else
      v21 = "";
    printf("<td width=92 style='vertical-align:top; %s'>%d</td>\n", v21, *(_DWORD *)(v0 + 24));
    sub_43400(*(_QWORD *)(v0 + 40), &v31);
    if ( v28 <= 8 )
      v22 = "<td width=109 style='vertical-align:top; %s'>%s</td>\n";
    else
      v22 = "<td width=94 style='vertical-align:top; %s'>%s</td>\n";
    if ( v6 )
      v23 = "background-color:#F7F7F7;";
    else
      v23 = "";
    v24 = printf(v22, v23, &v31);
    etr(v24);
    v0 = *(_DWORD *)(v0 + 52);
  }
  while ( v0 );
  v26 = v3;
  while ( v26 <= 7 )
  {
    if ( v26 & 1 )
      v25 = "background-color:#F7F7F7;";
    else
      v25 = "";
    ++v26;
    printf("<tr><td colspan=4 style='height: 42px; %s'></td></tr>", v25);
  }
LABEL_46:
  printf("</table>");
  printf("<script>");
  printf("parent.document.getElementById('conninfo_info_table').outerHTML = document.getElementById('conninfo_info_table').outerHTML;");
  printf("setTimeout(function() { location.reload(); }, 3000);");
  printf("</script>");
  return printf("</body>");
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 112D0: using guessed type int __fastcall dhcpd_get_dynamic_lease(_DWORD, _DWORD);
// 11450: using guessed type int __fastcall convert_euckr_to_utf8(_DWORD, _DWORD);
// 119B4: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);

//----- (00044324) --------------------------------------------------------
int print_iframe_trafficconf_conninfo_total()
{
  printf("<style>");
  printf("body { margin: 0; }");
  printf("table { border: 0; }");
  printf("tr { background-color: #FFF; }");
  printf("</style>");
  printf("<body>");
  printf("<table id=conninfo_total_table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=100%%'>");
  printf("</table>");
  printf("<iframe name=\"trafficconf_conninfo_total_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_conninfo_total_status\" frameborder=no style='display:none;'></iframe>");
  return printf("</body>");
}

//----- (000443A4) --------------------------------------------------------
int print_iframe_trafficconf_conninfo_total_status()
{
  int v0; // r6@1
  int v1; // r7@2
  unsigned int v2; // r10@2
  int v3; // r0@2
  int v4; // r1@2
  unsigned int v5; // r8@2
  unsigned int v6; // r9@2
  unsigned int v7; // r11@2
  __int64 v8; // r4@3
  __int64 v9; // r2@3
  int v10; // r1@5
  int v11; // r0@7
  int v12; // r0@8
  int v13; // r0@8
  int v14; // r0@8
  signed __int64 v16; // [sp+8h] [bp-E8h]@2
  signed __int64 v17; // [sp+10h] [bp-E0h]@2
  int v18; // [sp+1Ch] [bp-D4h]@2
  char v19; // [sp+20h] [bp-D0h]@8
  char s; // [sp+A0h] [bp-50h]@2
  int v21; // [sp+C0h] [bp-30h]@1
  int v22; // [sp+C4h] [bp-2Ch]@1

  v0 = 0;
  v21 = 0;
  v22 = 0;
  sub_434EC((int)&v21);
  printf("<body>");
  printf("<table id=conninfo_total_table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=100%%>");
  if ( v21 )
  {
    v18 = sub_43A24();
    v1 = 0;
    v2 = 0;
    v3 = sprintf(&s, "%d", v18);
    v4 = v21;
    v5 = 0;
    v16 = 0LL;
    v6 = 0;
    v17 = 0LL;
    v7 = 0;
    while ( v4 )
    {
      v7 += *(_DWORD *)(v4 + 4);
      v6 += *(_DWORD *)(v4 + 8);
      v5 += *(_DWORD *)(v4 + 12);
      v2 += *(_DWORD *)(v4 + 16);
      v1 += *(_DWORD *)(v4 + 20);
      v17 += *(_QWORD *)(v4 + 32);
      v8 = *(_QWORD *)(v4 + 40);
      v0 += *(_DWORD *)(v4 + 24);
      HIDWORD(v9) = HIDWORD(v16);
      v4 = *(_DWORD *)(v4 + 52);
      LODWORD(v9) = v16 + v8;
      v16 = v9 + v8;
    }
    str(v3);
    puts("<td rowspan=2 height=40 style='padding-left:5px;'>");
    if ( v18 )
    {
      sub_43A34(v7, v6, v5, v2, 1);
    }
    else
    {
      v11 = get_ux_text_common(1358, v10);
      printf(
        "<span style='font: normal normal normal 10px arial;'>TCP: %d, UDP: %d, ICMP: %d, %s: %d</span>",
        v7,
        v6,
        v5,
        v11,
        v2);
    }
    puts("</td>");
    printf("<td width=90 style='vertical-align:bottom;'>%d</td>\n", v1);
    sub_43400(v17, &v19);
    v12 = printf("<td width=111 style='vertical-align:bottom;'>%s</td>\n", &v19);
    v13 = etr(v12);
    str(v13);
    printf("<td width=90 style='vertical-align:top;'>%d</td>\n", v0);
    sub_43400(v16, &v19);
    v14 = printf("<td width=111 style='vertical-align:top;'>%s</td>\n", &v19);
    etr(v14);
  }
  printf("</table>");
  printf("<script>");
  printf("parent.document.getElementById('conninfo_total_table').outerHTML = document.getElementById('conninfo_total_table').outerHTML;");
  printf("setTimeout(function() { location.reload(); }, 3000);");
  printf("</script>");
  return printf("</body>");
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);

//----- (000445B8) --------------------------------------------------------
signed int trafficconf_conninfo()
{
  signed int result; // r0@1
  int v1; // r4@1
  int v2; // r1@2
  int v3; // r0@2
  int v4; // r5@3
  int v5; // r3@3
  int v6; // r2@3
  int v7; // r0@3
  int v8; // r1@3
  int v9; // r12@4
  int v10; // r4@6
  int v11; // r1@6
  int v12; // r1@6
  int v13; // r6@6
  int *v14; // r3@7
  int v15; // r1@9
  int v16; // r0@9
  int v17; // r1@9
  int v18; // r0@9
  int v19; // r0@9
  int v20; // r0@9
  int v21; // r1@9
  int v22; // r0@9
  int v23; // r1@9
  int v24; // r0@9
  int v25; // r0@9
  int v26; // r0@10
  int v27; // r0@10
  int v28; // r1@10
  int v29; // r0@10
  int v30; // r0@10
  int v31; // r1@10
  int v32; // r0@10
  int v33; // r1@10
  int v34; // r0@10
  int v35; // r1@10
  int v36; // r0@10
  int v37; // r1@10
  int v38; // r0@10
  int v39; // r0@10
  int v40; // r0@10
  int v41; // r1@10
  int v42; // r0@10
  int v43; // r1@10
  int v44; // r0@10
  int v45; // r0@10
  int v46; // r0@10
  int v47; // r0@10
  const char *v48; // r0@11
  int v49; // r0@13
  int v50; // r1@13
  int v51; // r4@13
  void *v52; // r0@13
  int v53; // [sp+0h] [bp-38h]@3
  int v54; // [sp+20h] [bp-18h]@2
  int v55; // [sp+24h] [bp-14h]@2

  result = print_natoff_warning();
  v1 = result;
  if ( result )
    return result;
  puts("<table id='trafficconf_conninfo_main_table' cellpadding=0px cellspacing=0px width=641px>");
  v54 = v1;
  v55 = v1;
  sub_434EC((int)&v54);
  printf("<tr style='background-color: #E3E3E3; height: 24px;'>");
  printf("<td style='border-style:solid; border-color: #CCC; border-width: 1px 0 1px 0;'>");
  v3 = get_ux_text_common(1235, v2);
  printf("<b style='padding-left: 5px;'>%s</b>", v3);
  printf("</td>");
  printf("</tr>");
  puts("<tr><td>");
  printf("<table cellspacing=0px cellpadding=0px style='background-color:#EEE; width: 100%%'>\n");
  if ( v54 )
  {
    v4 = sub_43A24();
    sprintf((char *)&v53, "%d", v4);
    v5 = v54;
    v6 = v1;
    v7 = v1;
    v8 = v1;
    while ( v5 )
    {
      v8 += *(_DWORD *)(v5 + 4);
      v7 += *(_DWORD *)(v5 + 8);
      v6 += *(_DWORD *)(v5 + 12);
      v9 = *(_DWORD *)(v5 + 16);
      v5 = *(_DWORD *)(v5 + 52);
      v1 += v9;
    }
    v10 = v7 + v8 + v6 + v1;
    str(v7);
    v13 = get_ux_text_common(1234, v11);
    if ( v4 )
      v14 = &v53;
    else
      v14 = (int *)get_ux_text_common(933, v12);
    printf("<td rowspan=2 width=440px style='padding-left: 5px;'>%s (%d / %s) </td>\n", v13, v10, v14);
    v16 = get_ux_text_common(1230, v15);
    printf("<td style='width:90px;'>%s</td>", v16);
    v18 = get_ux_text_common(1229, v17);
    v19 = printf("<td style='width:111px;'>%s</td>", v18);
    v20 = etr(v19);
    str(v20);
    v22 = get_ux_text_common(1232, v21);
    printf("<td style='width:90px;'>%s</td>", v22);
    v24 = get_ux_text_common(1231, v23);
    v25 = printf("<td style='width:111px;'>%s</td>", v24);
    etr(v25);
  }
  printf("</table>");
  v26 = printf("</td></tr>");
  str(v26);
  printf("<td>");
  printf("<iframe name=\"trafficconf_conninfo_total\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_conninfo_total\" frameborder=no style='width:100%%; height:40px;'></iframe>");
  v27 = printf("</td>");
  etr(v27);
  printf("<tr style='background-color: #E3E3E3; height: 24px;'>");
  v29 = get_ux_text_common(1228, v28);
  printf(
    "<td style='border-style:solid; border-color:#CCC; border-width: 1px 0 1px 0;'><b style='padding-left:5px;'>%s</b></td>",
    v29);
  printf("</tr>");
  printf("<tr><td>");
  v30 = printf("<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=100%% style='background-color:#EEE; border-bottom: 1px solid #CCC; padding-left:5px;'>");
  str(v30);
  v32 = get_ux_text_common(442, v31);
  printf("<td rowspan=2 style='width:170px;'>%s</td>", v32);
  v34 = get_ux_text_common(1233, v33);
  printf("<td rowspan=2 colspan=2 style='width:265px;'>%s</td>", v34);
  v36 = get_ux_text_common(1230, v35);
  printf("<td style='width:90px;'>%s</td>", v36);
  v38 = get_ux_text_common(1229, v37);
  v39 = printf("<td style='width:111px;'>%s</td>", v38);
  v40 = etr(v39);
  str(v40);
  v42 = get_ux_text_common(1232, v41);
  printf("<td style='width:90px;'>%s</td>", v42);
  v44 = get_ux_text_common(1231, v43);
  v45 = printf("<td style='width:111px;'>%s</td>", v44);
  etr(v45);
  printf("</table>");
  v46 = printf("</td></tr>");
  str(v46);
  v47 = printf("<td style='border-bottom: 1px solid #CCC; '>");
  if ( is_mobile_agent(v47) )
  {
    printf("<div style=\"height:336px; width:100%%; -webkit-overflow-scrolling: touch; overflow-y:scroll; overflow-x:hidden; display:inline-block;\">");
    printf("<iframe name=\"trafficconf_conninfo_info\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_conninfo_info\" frameborder=no style='width:100%%; height:336px;'></iframe>");
    v48 = "</div>";
  }
  else
  {
    v48 = "<iframe name=\"trafficconf_conninfo_info\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_conninfo_info\" fr"
          "ameborder=no style='width:100%%; height:336px;'></iframe>";
  }
  printf(v48);
  v49 = printf("</td>");
  etr(v49);
  printf("</table>");
  v51 = get_ux_text_common(34, v50);
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v52 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v52);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:"
    "middle; display:block; text-align:center;\">%s\n",
    v51);
  printf("</SPAN></td>");
  result = printf((const char *)&unk_7D215);
  return result;
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (00044984) --------------------------------------------------------
int __fastcall sub_44984(_DWORD *a1)
{
  _DWORD *v1; // r4@1

  v1 = a1;
  *a1 = get_file_value("/proc/sys/net/nf_conntrack_max", 1);
  v1[1] = get_file_value("/proc/sys/net/netfilter/udp_conntrack_max", 1);
  v1[2] = get_file_value("/proc/sys/net/netfilter/icmp_conntrack_max", 1);
  v1[3] = get_file_value("/proc/sys/net/netfilter/max_rate_per_ip", 1);
  return 0;
}
// 10D3C: using guessed type int __fastcall get_file_value(_DWORD, _DWORD);

//----- (000449E4) --------------------------------------------------------
int __fastcall sub_449E4(_DWORD *a1)
{
  _DWORD *v1; // r4@1

  v1 = a1;
  write_file_intval("/proc/sys/net/nf_conntrack_max", *a1);
  write_file_intval("/proc/sys/net/netfilter/udp_conntrack_max", v1[1]);
  write_file_intval("/proc/sys/net/netfilter/icmp_conntrack_max", v1[2]);
  write_file_intval("/proc/sys/net/netfilter/max_rate_per_ip", v1[3]);
  iconfig_set_intvalue_direct("ip_conntrack_max", *v1);
  iconfig_set_intvalue_direct("udp_conntrack_max", v1[1]);
  iconfig_set_intvalue_direct("icmp_conntrack_max", v1[2]);
  iconfig_set_intvalue_direct("max_rate_per_ip", v1[3]);
  return 0;
}
// 11BE8: using guessed type int __fastcall iconfig_set_intvalue_direct(_DWORD, _DWORD);
// 12080: using guessed type int __fastcall write_file_intval(_DWORD, _DWORD);

//----- (00044A74) --------------------------------------------------------
int __fastcall sub_44A74(int a1)
{
  int v1; // r4@1

  v1 = a1;
  *(_DWORD *)(a1 + 16) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_syn_sent", 1);
  *(_DWORD *)(v1 + 20) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_syn_recv", 1);
  *(_DWORD *)(v1 + 24) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_established", 1);
  *(_DWORD *)(v1 + 28) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_fin_wait", 1);
  *(_DWORD *)(v1 + 32) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_close_wait", 1);
  *(_DWORD *)(v1 + 36) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_last_ack", 1);
  *(_DWORD *)(v1 + 40) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_time_wait", 1);
  *(_DWORD *)(v1 + 44) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_close", 1);
  *(_DWORD *)(v1 + 48) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_udp_timeout", 1);
  *(_DWORD *)(v1 + 52) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_udp_timeout_stream", 1);
  *(_DWORD *)(v1 + 56) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_icmp_timeout", 1);
  *(_DWORD *)(v1 + 60) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_generic_timeout", 1);
  return 0;
}
// 10D3C: using guessed type int __fastcall get_file_value(_DWORD, _DWORD);

//----- (00044B74) --------------------------------------------------------
int __fastcall sub_44B74(int a1)
{
  int v1; // r4@1

  v1 = a1;
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_syn_sent", *(_DWORD *)(a1 + 16));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_syn_recv", *(_DWORD *)(v1 + 20));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_established", *(_DWORD *)(v1 + 24));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_fin_wait", *(_DWORD *)(v1 + 28));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_close_wait", *(_DWORD *)(v1 + 32));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_last_ack", *(_DWORD *)(v1 + 36));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_time_wait", *(_DWORD *)(v1 + 40));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_close", *(_DWORD *)(v1 + 44));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_udp_timeout", *(_DWORD *)(v1 + 48));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_udp_timeout_stream", *(_DWORD *)(v1 + 52));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_icmp_timeout", *(_DWORD *)(v1 + 56));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_generic_timeout", *(_DWORD *)(v1 + 60));
  iconfig_set_intvalue_direct("tcp_timeout_syn_sent", *(_DWORD *)(v1 + 16));
  iconfig_set_intvalue_direct("tcp_timeout_syn_recv", *(_DWORD *)(v1 + 20));
  iconfig_set_intvalue_direct("tcp_timeout_eastablished", *(_DWORD *)(v1 + 24));
  iconfig_set_intvalue_direct("tcp_timeout_fin_wait", *(_DWORD *)(v1 + 28));
  iconfig_set_intvalue_direct("tcp_timeout_close_wait", *(_DWORD *)(v1 + 32));
  iconfig_set_intvalue_direct("tcp_timeout_last_ack", *(_DWORD *)(v1 + 36));
  iconfig_set_intvalue_direct("tcp_timeout_time_wait", *(_DWORD *)(v1 + 40));
  iconfig_set_intvalue_direct("tcp_timeout_close", *(_DWORD *)(v1 + 44));
  iconfig_set_intvalue_direct("udp_timeout", *(_DWORD *)(v1 + 48));
  iconfig_set_intvalue_direct("udp_timeout_stream", *(_DWORD *)(v1 + 52));
  iconfig_set_intvalue_direct("icmp_timeout", *(_DWORD *)(v1 + 56));
  iconfig_set_intvalue_direct("generic_timeout", *(_DWORD *)(v1 + 60));
  return 0;
}
// 11BE8: using guessed type int __fastcall iconfig_set_intvalue_direct(_DWORD, _DWORD);
// 12080: using guessed type int __fastcall write_file_intval(_DWORD, _DWORD);

//----- (00044D04) --------------------------------------------------------
int __fastcall sub_44D04(int a1)
{
  int v1; // r4@1
  int v2; // r0@3
  int v4; // [sp+0h] [bp-90h]@3
  char v5; // [sp+4h] [bp-8Ch]@3
  char v6; // [sp+8h] [bp-88h]@3
  char v7; // [sp+Ch] [bp-84h]@3
  char v8; // [sp+40h] [bp-50h]@1

  v1 = a1;
  if ( !get_value_post(a1, "act", &v8, 64) || strcmp(&v8, "apply") )
    return 0;
  get_intvalue_post(v1, (int)"all", (int)&v4);
  get_intvalue_post(v1, (int)"udp_max", (int)&v5);
  get_intvalue_post(v1, (int)"icmp_max", (int)&v6);
  get_intvalue_post(v1, (int)"rate_per_ip", (int)&v7);
  v2 = sub_449E4(&v4);
  signal_save(v2);
  return 0;
}
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00044DB4) --------------------------------------------------------
int __fastcall sub_44DB4(int a1)
{
  int v1; // r4@1
  int v2; // r0@3
  int v4; // [sp+0h] [bp-90h]@3
  char v5; // [sp+10h] [bp-80h]@3
  char v6; // [sp+14h] [bp-7Ch]@3
  char v7; // [sp+18h] [bp-78h]@3
  char v8; // [sp+1Ch] [bp-74h]@3
  char v9; // [sp+20h] [bp-70h]@3
  char v10; // [sp+24h] [bp-6Ch]@3
  char v11; // [sp+28h] [bp-68h]@3
  char v12; // [sp+2Ch] [bp-64h]@3
  char v13; // [sp+30h] [bp-60h]@3
  char v14; // [sp+34h] [bp-5Ch]@3
  char v15; // [sp+38h] [bp-58h]@3
  char v16; // [sp+3Ch] [bp-54h]@3
  char v17; // [sp+40h] [bp-50h]@1

  v1 = a1;
  if ( !get_value_post(a1, "act", &v17, 64) || strcmp(&v17, "apply_timeout") )
    return 0;
  get_intvalue_post(v1, (int)"tcp_timeout_syn_sent", (int)&v5);
  get_intvalue_post(v1, (int)"tcp_timeout_syn_recv", (int)&v6);
  get_intvalue_post(v1, (int)"tcp_timeout_eastablished", (int)&v7);
  get_intvalue_post(v1, (int)"tcp_timeout_fin_wait", (int)&v8);
  get_intvalue_post(v1, (int)"tcp_timeout_close_wait", (int)&v9);
  get_intvalue_post(v1, (int)"tcp_timeout_last_ack", (int)&v10);
  get_intvalue_post(v1, (int)"tcp_timeout_time_wait", (int)&v11);
  get_intvalue_post(v1, (int)"tcp_timeout_close_value", (int)&v12);
  get_intvalue_post(v1, (int)"udp_timeout", (int)&v13);
  get_intvalue_post(v1, (int)"udp_timeout_stream", (int)&v14);
  get_intvalue_post(v1, (int)"icmp_timeout", (int)&v15);
  get_intvalue_post(v1, (int)"generic_timeout", (int)&v16);
  v2 = sub_44B74((int)&v4);
  signal_save(v2);
  return 0;
}
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00044F04) --------------------------------------------------------
int sub_44F04()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r0@1
  void *v5; // r0@1
  int v6; // r1@1
  const char *v7; // r0@1
  int v8; // r1@1
  const char *v9; // r0@1
  int v10; // r0@1

  printf("<tr><td>");
  printf("<iframe name=\"trafficconf_connctrl_connctrl\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_connctrl_connctrl\" frameborder=no style='width:100%%; height:100px;'></iframe>");
  printf("</td></tr>");
  printf("<tr style='background-color:#EEE; height: 32px;'>");
  printf("<td align=left colspan=4 style='background-color: #EEE; padding-left: 5px; border-width: 1px 0 1px 0; border-style: solid; border-color: #CCC;'>");
  v1 = get_ux_text_common(1098, v0);
  printf("<input type=button name=default_bt value=\"%s\" onclick=\"DefaultConnCtrl();\">", v1);
  print_nbsp(3);
  v3 = get_ux_text_common(35, v2);
  printf("<input type=button name=apply_bt value=\"%s\" onclick=\"ApplyConnCtrl();\">", v3);
  v4 = printf("</td>");
  etr(v4);
  printf("<tr style='background-color:#F7F7F7'>");
  printf("<td align=left colspan=4 style='background-color:#EEE; padding: 5px;'>");
  v5 = get_image_dir();
  printf("<img src='/%s/warning.gif' style='width:14px; height: 14px; vertical-align:bottom;'>", v5);
  printf("<span class=gray_text>");
  v7 = (const char *)get_ux_text_common(117, v6);
  printf(v7);
  printf("</span>");
  printf("<span class=gray_text style='display:block;'>");
  v9 = (const char *)get_ux_text_common(118, v8);
  printf(v9);
  printf("</span>");
  v10 = printf("</td>");
  return etr(v10);
}
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);

//----- (00045014) --------------------------------------------------------
int print_iframe_trafficconf_connctrl_connctrl()
{
  printf("<style>");
  printf("tr { height: 25px; }");
  printf("body { margin: 0; }");
  printf("form { margin: 0; }");
  printf("</style>");
  puts("<form method=post action=timepro.cgi name=connctrl_fm>");
  printf("<table id='trafficconf_connctrl_connctrl_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  printf("</table>");
  printf("</form>");
  return printf("<iframe name=\"trafficconf_connctrl_connctrl_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_connctrl_connctrl_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (00045094) --------------------------------------------------------
int __fastcall print_iframe_connctrl_connctrl_status(int a1, int a2)
{
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r4@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r1@1
  int v8; // r0@1
  int v9; // r0@1
  int v10; // r1@1
  int v11; // r0@1
  int v12; // r9@1
  int v13; // r1@1
  int v14; // r0@1
  int v15; // r1@1
  int v16; // r9@1
  int v17; // r1@1
  int v18; // r0@1
  int v19; // r0@1
  int v20; // r1@1
  int v21; // r0@1
  int v22; // r10@1
  int v23; // r1@1
  int v24; // r0@1
  int v25; // r1@1
  int v26; // r10@1
  int v27; // r1@1
  int v28; // r0@1
  int v29; // r0@1
  int v30; // r1@1
  int v31; // r0@1
  int v32; // r1@1
  int v33; // r0@1
  int v34; // r0@1
  int v36; // [sp+0h] [bp-A0h]@1
  int v37; // [sp+4h] [bp-9Ch]@1
  int v38; // [sp+8h] [bp-98h]@1
  int v39; // [sp+Ch] [bp-94h]@1
  int v40; // [sp+40h] [bp-60h]@1
  int v41; // [sp+44h] [bp-5Ch]@1
  int v42; // [sp+48h] [bp-58h]@1
  int v43; // [sp+4Ch] [bp-54h]@1

  sub_44D04(a2);
  sub_44984(&v40);
  hwinfo_get_conntrack_default(&v36);
  puts("<form method=post action=timepro.cgi name=connctrl_fm>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=trafficconf_connctrl_connctrl_status>");
  puts("<input type=hidden name=act value=>");
  printf("<input type=hidden name=default_all value=%d>\n", v36);
  printf("<input type=hidden name=default_udp_max value=%d>\n", v37);
  printf("<input type=hidden name=default_icmp_max value=%d>\n", v38);
  printf("<input type=hidden name=default_rate_per_ip value=%d>\n", v39);
  printf("<table id='trafficconf_connctrl_connctrl_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  printf("<tr %s>", "");
  v3 = get_ux_text_common(112, v2);
  printf("<td style='padding-left: 5px; width: 180px;'>%s</td>", v3);
  printf("<td colspan=3>");
  v4 = v40;
  v6 = get_ux_text_common(116, v5);
  printf("<input type=number name=all style='width:66px;' min=0 value=%d> %s", v4, v6);
  print_nbsp(1);
  v8 = get_ux_text_common(114, v7);
  printf("( 0 : %s, 512 ~ )", v8);
  v9 = printf("</td>");
  etr(v9);
  printf("<tr %s>", "style='background-color:#F7F7F7'");
  v11 = get_ux_text_common(115, v10);
  printf("<td style='padding-left: 5px; width: 180px;'>%s</td>", v11);
  printf("<td colspan=3>");
  v12 = v41;
  v14 = get_ux_text_common(116, v13);
  printf("<input type=number name=udp_max style='width:66px;' min=0 value=%d> %s", v12, v14);
  print_nbsp(1);
  v16 = get_ux_text_common(114, v15);
  v18 = get_ux_text_common(112, v17);
  printf("( 0 : %s ,10 ~ %s )", v16, v18);
  v19 = printf("</td>");
  etr(v19);
  printf("<tr %s>", "");
  v21 = get_ux_text_common(111, v20);
  printf("<td style='padding-left: 5px; width: 180px;'>%s</td>", v21);
  printf("<td colspan=3>");
  v22 = v42;
  v24 = get_ux_text_common(116, v23);
  printf("<input type=number name=icmp_max style='width:66px;' min=0 value=%d> %s", v22, v24);
  print_nbsp(1);
  v26 = get_ux_text_common(114, v25);
  v28 = get_ux_text_common(112, v27);
  printf("( 0 : %s ,1 ~ %s )", v26, v28);
  v29 = printf("</td>");
  etr(v29);
  printf("<tr %s>", "style='background-color:#F7F7F7'");
  v31 = get_ux_text_common(113, v30);
  printf("<td style='padding-left: 5px; width: 180px;'>%s</td>", v31);
  printf("<td colspan=3>");
  printf("<input type=number name=rate_per_ip style='width:66px;' min=0 value=%d> %%", v43);
  print_nbsp(1);
  v33 = get_ux_text_common(114, v32);
  printf("( 0 : %s ,1 ~ 100 )", v33);
  v34 = printf("</td>");
  etr(v34);
  printf("</table>");
  printf("</form>");
  printf("<script>");
  printf("parent.document.getElementById('trafficconf_connctrl_connctrl_table').outerHTML = document.getElementById('trafficconf_connctrl_connctrl_table').outerHTML;");
  printf("setTimeout(function() {UnMaskIt(parent.parent.document, 'apply_mask');}, 500);");
  return printf("</script>");
}
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 118B8: using guessed type int __fastcall hwinfo_get_conntrack_default(_DWORD);

//----- (00045390) --------------------------------------------------------
int sub_45390()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r0@1

  printf("<tr style='background-color:#E3E3E3;'><td style='border-width: 1px 0 1px 0; border-color: #CCC; border-style: solid; padding-left: 5px;'>");
  v1 = get_ux_text_common(120, v0);
  printf("<b>%s</b>", v1);
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<iframe name=\"trafficconf_connctrl_timeout\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_connctrl_timeout\" frameborder=no style='width:100%%; height:150px;'></iframe>");
  printf("</td></tr>");
  printf("<tr style='background-color:#EEE; height: 32px;'>");
  printf("<td align=left colspan=4 style='padding-left: 5px; border-width: 1px 0 1px 0; border-style: solid; border-color: #CCC;'>");
  v3 = get_ux_text_common(1098, v2);
  printf("<input type=button name=default_bt value=\"%s\" onclick=\"DefaultConnTimeout();\">", v3);
  print_nbsp(3);
  v5 = get_ux_text_common(35, v4);
  printf("<input type=button name=apply_bt value=\"%s\" onclick=\"ApplyConnTimeout();\">", v5);
  v6 = printf("</td>");
  return etr(v6);
}
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);

//----- (0004544C) --------------------------------------------------------
int print_iframe_trafficconf_connctrl_timeout()
{
  printf("<style>");
  printf("tr { height: 25px; }");
  printf("body { margin: 0; }");
  printf("form { margin: 0; }");
  printf("</style>");
  puts("<form method=post action=timepro.cgi name=conntimeout_fm>");
  printf("<table id='trafficconf_connctrl_timeout_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  printf("</table>");
  printf("</form>");
  return printf("<iframe name=\"trafficconf_connctrl_timeout_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_connctrl_timeout_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (000454CC) --------------------------------------------------------
int __fastcall print_iframe_trafficconf_connctrl_timeour_status(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r9@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r0@1
  int v9; // r11@1
  int v10; // r1@1
  int v11; // r0@1
  int v12; // r11@1
  int v13; // r1@1
  int v14; // r0@1
  int v15; // r0@1
  int v16; // r11@1
  int v17; // r1@1
  int v18; // r0@1
  int v19; // r11@1
  int v20; // r1@1
  int v21; // r0@1
  int v22; // r0@1
  int v23; // r11@1
  int v24; // r1@1
  int v25; // r0@1
  int v26; // r11@1
  int v27; // r1@1
  int v28; // r0@1
  int v29; // r0@1
  int v30; // r10@1
  int v31; // r1@1
  int v32; // r0@1
  int v33; // r10@1
  int v34; // r1@1
  int v35; // r0@1
  int v36; // r0@1
  int v37; // r8@1
  int v38; // r1@1
  int v39; // r0@1
  int v40; // r6@1
  int v41; // r1@1
  int v42; // r0@1
  int v43; // r0@1
  int v45; // [sp+0h] [bp-A8h]@1
  int v46; // [sp+10h] [bp-98h]@1
  int v47; // [sp+14h] [bp-94h]@1
  int v48; // [sp+18h] [bp-90h]@1
  int v49; // [sp+1Ch] [bp-8Ch]@1
  int v50; // [sp+20h] [bp-88h]@1
  int v51; // [sp+24h] [bp-84h]@1
  int v52; // [sp+28h] [bp-80h]@1
  int v53; // [sp+2Ch] [bp-7Ch]@1
  int v54; // [sp+30h] [bp-78h]@1
  int v55; // [sp+34h] [bp-74h]@1
  int v56; // [sp+38h] [bp-70h]@1
  int v57; // [sp+3Ch] [bp-6Ch]@1
  char v58; // [sp+40h] [bp-68h]@1
  int v59; // [sp+50h] [bp-58h]@1
  int v60; // [sp+54h] [bp-54h]@1
  int v61; // [sp+58h] [bp-50h]@1
  int v62; // [sp+5Ch] [bp-4Ch]@1
  int v63; // [sp+60h] [bp-48h]@1
  int v64; // [sp+64h] [bp-44h]@1
  int v65; // [sp+68h] [bp-40h]@1
  int v66; // [sp+6Ch] [bp-3Ch]@1
  int v67; // [sp+70h] [bp-38h]@1
  int v68; // [sp+74h] [bp-34h]@1
  int v69; // [sp+78h] [bp-30h]@1
  int v70; // [sp+7Ch] [bp-2Ch]@1

  sub_44DB4(a2);
  sub_44A74((int)&v58);
  hwinfo_get_conntrack_default(&v45);
  puts("<form method=post action=timepro.cgi name=conntimeout_fm>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=trafficconf_connctrl_timeout_status>");
  puts("<input type=hidden name=act value=>");
  printf("<input type=hidden name=default_tcp_timeout_syn_sent value=%d>\n", v46);
  printf("<input type=hidden name=default_tcp_timeout_syn_recv value=%d>\n", v47);
  printf("<input type=hidden name=default_tcp_timeout_eastablished value=%d>\n", v48);
  printf("<input type=hidden name=default_tcp_timeout_fin_wait value=%d>\n", v49);
  printf("<input type=hidden name=default_tcp_timeout_close_wait value=%d>\n", v50);
  printf("<input type=hidden name=default_tcp_timeout_last_ack value=%d>\n", v51);
  printf("<input type=hidden name=default_tcp_timeout_time_wait value=%d>\n", v52);
  printf("<input type=hidden name=default_tcp_timeout_close_value value=%d>\n", v53);
  printf("<input type=hidden name=default_udp_timeout value=%d>\n", v54);
  printf("<input type=hidden name=default_udp_timeout_stream value=%d>\n", v55);
  printf("<input type=hidden name=default_icmp_timeout value=%d>\n", v56);
  printf("<input type=hidden name=default_generic_timeout value=%d>\n", v57);
  printf("<table id='trafficconf_connctrl_timeout_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  printf("<tr %s>", "");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "TCP SYN SENT TIMEOUT");
  printf("<td >");
  v2 = v59;
  v4 = get_ux_text_common(1083, v3);
  printf("<input type=number name=tcp_timeout_syn_sent style='width:66px;' min=0 value=%d> %s", v2, v4);
  printf("</td>");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "TCP SYN RECV TIMEOUT");
  printf("<td >");
  v5 = v60;
  v7 = get_ux_text_common(1083, v6);
  printf("<input type=number name=tcp_timeout_syn_recv style='width:66px;' min=0 value=%d> %s", v5, v7);
  v8 = printf("</td>");
  etr(v8);
  printf("<tr %s>", "style='background-color:#F7F7F7'");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "TCP ESTABLISHED TIMEOUT");
  printf("<td >");
  v9 = v61;
  v11 = get_ux_text_common(1083, v10);
  printf("<input type=number name=tcp_timeout_eastablished style='width:66px;' min=0 value=%d> %s", v9, v11);
  printf("</td>");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "TCP FIN WAIT TIMEOUT");
  printf("<td >");
  v12 = v62;
  v14 = get_ux_text_common(1083, v13);
  printf("<input type=number name=tcp_timeout_fin_wait style='width:66px;' min=0 value=%d> %s", v12, v14);
  v15 = printf("</td>");
  etr(v15);
  printf("<tr %s>", "");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "TCP CLOSE WAIT TIMEOUT");
  printf("<td >");
  v16 = v63;
  v18 = get_ux_text_common(1083, v17);
  printf("<input type=number name=tcp_timeout_close_wait style='width:66px;' min=0 value=%d> %s", v16, v18);
  printf("</td>");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "TCP LAST ACK TIMEOUT");
  printf("<td >");
  v19 = v64;
  v21 = get_ux_text_common(1083, v20);
  printf("<input type=number name=tcp_timeout_last_ack style='width:66px;' min=0 value=%d> %s", v19, v21);
  v22 = printf("</td>");
  etr(v22);
  printf("<tr %s>", "style='background-color:#F7F7F7'");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "TCP TIME WAIT TIMEOUT");
  printf("<td >");
  v23 = v65;
  v25 = get_ux_text_common(1083, v24);
  printf("<input type=number name=tcp_timeout_time_wait style='width:66px;' min=0 value=%d> %s", v23, v25);
  printf("</td>");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "TCP CLOSE TIMEOUT");
  printf("<td >");
  v26 = v66;
  v28 = get_ux_text_common(1083, v27);
  printf("<input type=number name=tcp_timeout_close_value style='width:66px;' min=0 value=%d> %s", v26, v28);
  v29 = printf("</td>");
  etr(v29);
  printf("<tr %s>", "");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "UDP TIMEOUT");
  printf("<td >");
  v30 = v67;
  v32 = get_ux_text_common(1083, v31);
  printf("<input type=number name=udp_timeout style='width:66px;' min=0 value=%d> %s", v30, v32);
  printf("</td>");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "UDP STREAM TIMEOUT");
  printf("<td >");
  v33 = v68;
  v35 = get_ux_text_common(1083, v34);
  printf("<input type=number name=udp_timeout_stream style='width:66px;' min=0 value=%d> %s", v33, v35);
  v36 = printf("</td>");
  etr(v36);
  printf("<tr %s>", "style='background-color:#F7F7F7'");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "ICMP TIMEOUT");
  printf("<td >");
  v37 = v69;
  v39 = get_ux_text_common(1083, v38);
  printf("<input type=number name=icmp_timeout style='width:66px;' min=0 value=%d> %s", v37, v39);
  printf("</td>");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "GENERIC TIMEOUT");
  printf("<td >");
  v40 = v70;
  v42 = get_ux_text_common(1083, v41);
  printf("<input type=number name=generic_timeout style='width:66px;' min=0 value=%d> %s", v40, v42);
  v43 = printf("</td>");
  etr(v43);
  printf("</table>");
  printf("</form>");
  printf("<script>");
  printf("parent.document.getElementById('trafficconf_connctrl_timeout_table').outerHTML = document.getElementById('trafficconf_connctrl_timeout_table').outerHTML;");
  printf("setTimeout(function() {UnMaskIt(parent.parent.document, 'apply_mask');}, 500);");
  return printf("</script>");
}
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 118B8: using guessed type int __fastcall hwinfo_get_conntrack_default(_DWORD);

//----- (000459FC) --------------------------------------------------------
signed int trafficconf_connctrl()
{
  signed int result; // r0@1
  int v1; // r0@2
  int v2; // r1@2
  int v3; // r4@2
  void *v4; // r0@2

  result = print_natoff_warning();
  if ( result )
    return result;
  print_js_file((int)"trafficconf", (int)"connctrl");
  printf("<style>");
  printf("tr { height: 25px; }");
  printf("</style>");
  puts("<table id='trafficconf_connctrl_main_table' cellpadding=0px cellspacing=0px width=641px>");
  sub_44F04();
  v1 = sub_45390();
  print_end_main_table(v1);
  v3 = get_ux_text_common(34, v2);
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v4 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v4);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:"
    "middle; display:block; text-align:center;\">%s\n",
    v3);
  printf("</SPAN></td>");
  result = printf((const char *)&unk_7D215);
  return result;
}
// 115DC: using guessed type int __fastcall print_end_main_table(_DWORD);

//----- (00045B18) --------------------------------------------------------
int print_iframe_switch_portmirror()
{
  print_js_file((int)"trafficconf", (int)"switch");
  printf("<style>");
  printf("body { margin: 0; }");
  printf("form { margin: 0; }");
  printf("td { padding: 10px 0 10px 2px; }");
  printf("</style>");
  puts("<form method=post action=timepro.cgi name=portmirror_fm>");
  printf("<table id='trafficconf_switch_portmirror_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  printf("</table>");
  printf("</form>");
  return printf("<iframe name=\"trafficconf_switch_portmirror_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_switch_portmirror_status\" frameborder=no style='display: none;'></iframe>");
}

//----- (00045BAC) --------------------------------------------------------
int __fastcall print_iframe_trafficconf_switch_portmirror_status(int a1, int a2)
{
  int v2; // r5@1
  signed int v3; // r4@2
  int v4; // r0@7
  int v5; // r0@9
  int v6; // r0@13
  int v7; // r0@13
  int v8; // r1@13
  const char *v9; // r0@13
  int v10; // r1@13
  int v11; // r1@14
  const char *v12; // r0@14
  int v13; // r0@16
  char v15; // [sp+4h] [bp-414h]@1
  int v16; // [sp+284h] [bp-194h]@13
  char v17; // [sp+3B0h] [bp-68h]@1
  char v18; // [sp+3D0h] [bp-48h]@8
  char v19; // [sp+3E8h] [bp-30h]@13
  int v20; // [sp+400h] [bp-18h]@8
  int v21; // [sp+404h] [bp-14h]@13

  v2 = a2;
  get_si("hw", &v15);
  if ( !get_value_post(v2, "act", &v17, 32) )
  {
    v3 = 0;
    goto LABEL_13;
  }
  if ( strcmp(&v17, "apply_mirror") )
  {
    v3 = 0;
    goto LABEL_13;
  }
  if ( get_value_post(v2, "mirror_chk", &v17, 32) && !strcmp(&v17, "on") )
  {
    v4 = get_value_post(v2, "portmirror", &v17, 32);
    if ( !v4 )
      goto LABEL_12;
    v4 = trunk_read_config(0, &v18, &v20);
    if ( v20 )
      goto LABEL_12;
    v5 = atoi(&v17);
  }
  else
  {
    v5 = 0;
  }
  v4 = set_sniff_port(v5);
LABEL_12:
  v3 = 1;
  signal_save(v4);
LABEL_13:
  print_js_file((int)"trafficconf", (int)"switch");
  puts("<form method=post action=timepro.cgi name=portmirror_fm>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=trafficconf_switch_portmirror_status>");
  puts("<input type=hidden name=act value=>");
  printf("<input type=hidden name=portmirror value=%d>\n", v16);
  v6 = printf("<table id='trafficconf_switch_portmirror_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  str(v6);
  v7 = printf("<td width=85%% >");
  get_sniff_port(v7);
  printf("<input type=checkbox id=mirror_chk name=mirror_chk %s> ");
  printf("<label for=mirror_chk>");
  v9 = (const char *)get_ux_text_common(990, v8);
  printf(v9, v16);
  printf("</label>");
  printf("</td>");
  puts("<td align=center>");
  trunk_read_config(0, &v19, &v21);
  if ( v21 )
  {
    v11 = get_ux_text_common(35, v10);
    v12 = "<input type=button name=apply_bt value=\"%s\" onclick=\"ApplyPortMirror(true);\" >";
  }
  else
  {
    v11 = get_ux_text_common(35, v10);
    v12 = "<input type=button name=apply_bt value=\"%s\" onclick=\"ApplyPortMirror(false);\" >";
  }
  printf(v12, v11);
  v13 = printf("</td>");
  etr(v13);
  printf("</table>");
  puts("</form>");
  printf("<script>");
  printf("parent.document.getElementById('trafficconf_switch_portmirror_table').outerHTML = document.getElementById('trafficconf_switch_portmirror_table').outerHTML;");
  if ( v3 )
    printf("refreshPortTrunk(parent.parent.document);");
  printf("setTimeout(function() { UnMaskIt(parent.parent.document, 'apply_mask'); }, 500);");
  return printf("</script>");
}
// 104B4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// 10640: using guessed type int __fastcall trunk_read_config(_DWORD, _DWORD, _DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 10F7C: using guessed type int __fastcall get_sniff_port(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11F30: using guessed type int __fastcall set_sniff_port(_DWORD);

//----- (00045E3C) --------------------------------------------------------
int __fastcall sub_45E3C(int a1)
{
  int v1; // r5@1
  int result; // r0@1
  int v3; // r0@3
  char v4; // [sp+4h] [bp-34h]@1
  int v5; // [sp+24h] [bp-14h]@1

  v1 = a1;
  v5 = 0;
  result = get_value_post(a1, "act", &v4, 32);
  if ( !result )
    return result;
  result = strcmp(&v4, "jumbo");
  if ( result )
    return result;
  get_intvalue_post(v1, (int)"enable", (int)&v5);
  set_jumbo_frame_control(v5);
  v3 = apply_jumbo_frame_control(v5);
  result = signal_save(v3);
  return result;
}
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10CB8: using guessed type int __fastcall set_jumbo_frame_control(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11DA4: using guessed type int __fastcall apply_jumbo_frame_control(_DWORD);

//----- (00045EB8) --------------------------------------------------------
int sub_45EB8()
{
  int v0; // r1@1
  int v1; // r0@1

  printf("<tr class='menu'><td>");
  v1 = get_ux_text_common(461, v0);
  printf("<b>%s</b>", v1);
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<iframe name=\"trafficconf_switch_jumboframe\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_switch_jumboframe\" frameborder=no style='width:100%%; height:42px; background-color:#EEE;'></iframe>");
  return printf("</td></tr>");
}

//----- (00045F14) --------------------------------------------------------
int print_iframe_trafficconf_switch_jumboframe()
{
  print_js_file((int)"trafficconf", (int)"switch");
  printf("<style>");
  printf("body { margin: 0; }");
  printf("form { margin: 0; }");
  printf("td { padding: 10px 0 10px 2px; }");
  printf("</style>");
  puts("<form method=post action=timepro.cgi name=jumboframe_fm>");
  printf("<table id='trafficconf_switch_jumboframe_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  printf("</table>");
  printf("</form>");
  return printf("<iframe name=\"trafficconf_switch_jumboframe_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_switch_jumboframe_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (00045FA8) --------------------------------------------------------
int __fastcall print_iframe_trafficconf_switch_jumboframe_status(int a1, int a2)
{
  int v2; // r0@1
  int v3; // r0@1
  int v4; // r1@1
  const char *v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r0@1

  v2 = sub_45E3C(a2);
  get_jumbo_frame_control(v2);
  puts("<form method=post action=timepro.cgi name=jumboframe_fm>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=trafficconf_switch_jumboframe_status>");
  puts("<input type=hidden name=act value=jumbo>");
  v3 = printf("<table id='trafficconf_switch_jumboframe_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  str(v3);
  printf("<td width=85%%>");
  printf("<input type=checkbox id=enable name=enable value=1 %s>");
  print_nbsp(2);
  printf("<label for=enable>");
  v5 = (const char *)get_ux_text_common(460, v4);
  printf(v5);
  printf("</label>");
  printf("</td>");
  puts("<td align=center>");
  v7 = get_ux_text_common(35, v6);
  printf("<input type=button name=apply_bt value=\"%s\" onclick=\"ApplyJumboFrame();\">", v7);
  v8 = printf("</td>");
  etr(v8);
  printf("</table>");
  puts("</form>");
  printf("<script>");
  printf("parent.document.getElementById('trafficconf_switch_jumboframe_table').outerHTML = document.getElementById('trafficconf_switch_jumboframe_table').outerHTML;");
  printf("setTimeout(function() { UnMaskIt(parent.parent.document, 'apply_mask'); }, 500);");
  return printf("</script>");
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 11F90: using guessed type int __fastcall get_jumbo_frame_control(_DWORD);

//----- (000460E0) --------------------------------------------------------
int __fastcall sub_460E0(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r6@1
  int result; // r0@1
  int v5; // r0@7
  int v6; // [sp+0h] [bp-30h]@1

  v2 = a2;
  v3 = a1;
  result = get_value_post(a1, "act", &v6, 32);
  if ( !result )
    return result;
  if ( !strcmp((const char *)&v6, "apply_trunk") )
  {
    if ( get_value_post(v3, "trunk_chk", &v6, 32) && !strcmp((const char *)&v6, "on") && !get_sniff_port(0) )
      v5 = trunk_add_config("TRUNK", v2);
    else
      v5 = trunk_remove_config("TRUNK", -1);
    signal_save(v5);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10A9C: using guessed type int __fastcall trunk_add_config(_DWORD, _DWORD);
// 10F7C: using guessed type int __fastcall get_sniff_port(_DWORD);
// 11078: using guessed type int __fastcall trunk_remove_config(_DWORD, _DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (000461A0) --------------------------------------------------------
int sub_461A0()
{
  int v0; // r1@1
  int v1; // r0@1

  printf("<tr class='menu'><td>");
  v1 = get_ux_text_common(761, v0);
  printf("<b>%s</b>", v1);
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<iframe name=\"trafficconf_switch_trunk\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_switch_trunk\" frameborder=no style='width:100%%; height:60px; background-color:#EEE;'></iframe>");
  return printf("</td></tr>");
}

//----- (000461FC) --------------------------------------------------------
int print_iframe_trafficconf_switch_trunk()
{
  print_js_file((int)"trafficconf", (int)"switch");
  printf("<style>");
  printf("body { margin: 0; }");
  printf("form { margin: 0; }");
  printf("td { padding-top: 10px; padding-left: 2px; }");
  printf("</style>");
  puts("<form method=post action=timepro.cgi name=trunk_fm>");
  printf("<table id='trafficconf_switch_trunk_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  printf("</table>");
  printf("</form>");
  return printf("<iframe name=\"trafficconf_switch_trunk_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_switch_trunk_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (00046290) --------------------------------------------------------
int __fastcall print_iframe_trafficconf_switch_trunk_status(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r6@1
  signed int v4; // r4@1
  int v5; // r0@8
  char *v6; // r1@9
  int v7; // r1@11
  const char *v8; // r0@11
  int v9; // r0@11
  int v10; // r1@11
  int v11; // r1@12
  const char *v12; // r0@12
  int v13; // r0@14
  int v14; // r0@14
  int v15; // r1@14
  const char *v16; // r0@14
  int v17; // r0@14
  int v19; // [sp+0h] [bp-4D8h]@1
  int v20; // [sp+274h] [bp-264h]@7
  int v21; // [sp+394h] [bp-144h]@1
  char v22; // [sp+3ACh] [bp-12Ch]@1
  int v23; // [sp+4ACh] [bp-2Ch]@8
  int v24; // [sp+4C4h] [bp-14h]@8

  v2 = a2;
  get_si("hw", &v19);
  v3 = sub_460E0(v2, v21);
  v4 = 1;
  strcpy(&v22, "");
  while ( v4 <= v20 )
  {
    if ( (v21 >> (v4 - 1)) & 1 )
    {
      if ( v22 )
        sprintf(&v22, "%s,%d", &v22, v4);
      else
        sprintf(&v22, "%d", v4);
    }
    ++v4;
  }
  trunk_read_config(0, &v23, &v24);
  print_js_file((int)"trafficconf", (int)"switch");
  puts("<form method=post action=timepro.cgi name=trunk_fm>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=trafficconf_switch_trunk_status>");
  puts("<input type=hidden name=act value=apply_trunk>");
  v5 = printf("<table id='trafficconf_switch_trunk_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  str(v5);
  printf("<td width=85%%>");
  if ( v24 )
    v6 = "checked";
  else
    v6 = "";
  printf("<input type=checkbox id=trunk_chk name=trunk_chk %s> ", v6, "");
  printf("<label for=trunk_chk>");
  v8 = (const char *)get_ux_text_common(1348, v7);
  printf(v8, &v22);
  printf("</label>");
  printf("</td>");
  v9 = puts("<td align=center>");
  if ( get_sniff_port(v9) )
  {
    v11 = get_ux_text_common(35, v10);
    v12 = "<input type=button name=apply_bt value=\"%s\" onclick='ApplyTrunk(true);'>";
  }
  else
  {
    v11 = get_ux_text_common(35, v10);
    v12 = "<input type=button name=apply_bt value=\"%s\" onclick='ApplyTrunk(false);'>";
  }
  printf(v12, v11);
  v13 = printf("</td>");
  v14 = etr(v13);
  str(v14);
  printf("<td align=left colspan=2 style='padding: 0 0 10px 16px;'><font color='gray'>");
  print_nbsp(3);
  v16 = (const char *)get_ux_text_common(1349, v15);
  printf(v16);
  v17 = puts("</td>");
  etr(v17);
  printf("</table>");
  puts("</form>");
  printf("<script>");
  printf("parent.document.getElementById('trafficconf_switch_trunk_table').outerHTML = document.getElementById('trafficconf_switch_trunk_table').outerHTML;");
  if ( v3 )
    printf("refreshPortmirror(parent.parent.document);");
  printf("setTimeout(function() { UnMaskIt(parent.parent.document, 'apply_mask'); }, 500);");
  return printf("</script>");
}
// 104B4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// 10640: using guessed type int __fastcall trunk_read_config(_DWORD, _DWORD, _DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 10F7C: using guessed type int __fastcall get_sniff_port(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);

//----- (000464FC) --------------------------------------------------------
int trafficconf_switch()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r5@1
  void *v4; // r0@1

  printf("<style>");
  printf("tr.menu { height: 24px; background-color: #E7E7E7; }");
  printf("tr.menu td { border-width: 1px 0; border-color: #CCC; border-style: solid; }");
  printf("tr.menu td b { padding-left: 5px; }");
  printf("</style>");
  print_js_file((int)"trafficconf", (int)"switch");
  puts("<table cellpadding=0px cellspacing=0px style='width: 641px; border-bottom: 1px solid #CCC;'>");
  printf("<tr class='menu'><td>");
  v1 = get_ux_text_common(991, v0);
  printf("<b>%s</b>", v1);
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<iframe name=\"trafficconf_switch_portmirror\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_switch_portmirror\" frameborder=no style='width:100%%; height:42px; background-color:#EEE;'></iframe>");
  printf("</td></tr>");
  sub_45EB8();
  sub_461A0();
  printf("</table>");
  v3 = get_ux_text_common(34, v2);
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v4 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v4);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:"
    "middle; display:block; text-align:center;\">%s\n",
    v3);
  printf("</SPAN></td>");
  return printf((const char *)&unk_7D215);
}

//----- (00046684) --------------------------------------------------------
int __fastcall sub_46684(const char *a1, int a2, int a3)
{
  bool v3; // zf@1
  int v4; // r4@3

  v3 = ((unsigned __int8)a1 & 1) == 0;
  if ( !((unsigned __int8)a1 & 1) )
    a1 = "<tr style='background-color:#FFF; height: %dpx;'>";
  v4 = a2;
  if ( !v3 )
    a1 = "<tr style='background-color:#F7F7F7; height: %dpx;'>";
  printf((const char *)(_BYTE)a1, a3);
  printf((const char *)(unsigned __int8)"<td colspan=%d></td>", v4 + 2);
  return printf((const char *)(unsigned __int8)"</tr>");
}

//----- (000466C8) --------------------------------------------------------
int __fastcall sub_466C8(int a1, signed int a2)
{
  signed int v2; // r4@1
  int v3; // r5@1
  const char *v4; // r0@2
  int v5; // r6@5
  int v6; // r1@9
  int v7; // r0@9
  const char *v8; // r0@9
  char *v9; // r7@10
  int v10; // r1@10
  char *v11; // r10@11
  int v12; // r0@13
  int v13; // r1@13
  int v14; // r0@15
  char *v15; // r1@20
  char *v16; // r1@23
  char *v17; // r1@26
  char *v18; // r1@29
  int v19; // r1@31
  int v20; // r0@31
  int v22; // [sp+0h] [bp-60h]@5
  char v23; // [sp+20h] [bp-40h]@10
  char s1; // [sp+2Ah] [bp-36h]@16
  int v25; // [sp+34h] [bp-2Ch]@16

  v2 = a2;
  v3 = a1;
  if ( dword_CA614 & 1 )
    v4 = "<tr style='background-color:#F7F7F7;'>";
  else
    v4 = "<tr style='background-color:#FFF;'>";
  ++dword_CA614;
  printf(v4);
  if ( v2 <= 0x10000 )
  {
    snprintf((char *)&v22, 0x20u, "%d", v2);
    v5 = *(_DWORD *)(v3 + 4 * v2 + 776);
  }
  else
  {
    snprintf((char *)&v22, 0x20u, "WAN%d", v2 - 0x10000);
    v5 = *(_DWORD *)(v3 + 4 * (v2 - 65311) + 4);
  }
  printf("<td style='width:115px;'><span style='padding-left: 5px;'>%s</span></td>", &v22);
  if ( v2 == 1 || v2 != *(_DWORD *)(v3 + 628) )
  {
    v9 = "selected";
    read_portconfig(v2, &v23);
    puts("<td style='width:110px;'>");
    printf("<select name=mode%d style='width:90px;' onchange=\"SelectLinkMode(%d);\">\n", v2, v2);
    if ( !strcmp(&v23, "auto") )
      v11 = "selected";
    else
      v11 = "";
    v12 = get_ux_text_common(836, v10);
    printf("<option value=auto %s>%s", v11, v12);
    if ( strcmp(&v23, "forced") )
      v9 = "";
    v14 = get_ux_text_common(842, v13);
    printf("<option value=forced %s>%s</option>", v9, v14);
    printf("</select>");
    printf("</td>");
    puts("<td style='width:110px;'>");
    printf("<select name=speed%d style='width:90px;' onchange=\"SelectLinkMode(%d);\">\n", v2, v2);
    if ( !strcmp(&v23, "auto") )
    {
      sprintf(&s1, "%d", v5);
      strcpy((char *)&v25, "full");
    }
    if ( v5 == 1000 )
    {
      strcmp(&s1, "1000");
      printf("<option value=1000 %s>1Gbps</option>\n");
    }
    if ( !strcmp(&s1, "100") )
      v15 = "selected";
    else
      v15 = "";
    printf("<option value=100 %s>100Mbps</option>\n", v15);
    if ( !strcmp(&s1, "10") )
      v16 = "selected";
    else
      v16 = "";
    printf("<option value=10 %s>10Mbps</option>\n", v16);
    printf("</select>");
    printf("</td>");
    puts("<td style='width:110px;'>");
    printf("<select name=duplex%d style='width:90px;'>\n", v2);
    if ( !strcmp((const char *)&v25, "full") )
      v17 = "selected";
    else
      v17 = "";
    printf("<option value=full %s>FULL</option>\n", v17);
    if ( !strcmp((const char *)&v25, "half") )
      v18 = "selected";
    else
      v18 = "";
    printf("<option value=half %s>HALF</option>\n", v18);
    printf("</select>");
    printf("</td>");
    puts("<td align=center>");
    v20 = get_ux_text_common(35, v19);
    printf("<input type=button name=\"port%d_bt\" value=\"%s\" onclick=\"ApplyLinkSetup(%d);\"\"></td>\n", v2, v20, v2);
    printf("</td>");
    v8 = "<td style='width:50px;'></td>";
  }
  else
  {
    puts("<td colspan=5>");
    v7 = get_ux_text_common(837, v6);
    printf("%s</td>\n", v7);
    v8 = "</tr>";
  }
  return printf(v8);
}
// 11480: using guessed type int __fastcall read_portconfig(_DWORD, _DWORD);
// CA614: using guessed type int dword_CA614;

//----- (00046A24) --------------------------------------------------------
int sub_46A24()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r1@1
  int v9; // r0@1

  printf("<tr class='menu'><td>");
  v1 = get_ux_text_common(852, v0);
  printf("<b>%s</b>", v1);
  printf("</td></tr>");
  printf("<tr class='title'>");
  printf("<td>");
  printf("<table cellpadding=0px cellspacing=0px width=100%% style='padding-left: 5px;'>\n");
  v3 = get_ux_text_common(992, v2);
  printf("<td style='width:115px;'><span>%s</span></td>", v3);
  v5 = get_ux_text_common(1107, v4);
  printf("<td style='width:110px;'><span>%s</span></td>", v5);
  v7 = get_ux_text_common(853, v6);
  printf("<td style='width:110px;'><span>%s</span></td>", v7);
  v9 = get_ux_text_common(839, v8);
  printf("<td style='width:110px;'><span>%s</span></td>", v9);
  printf("<td></td>");
  printf("<td style='width:50px;'></td>");
  printf("</table>");
  printf("</td>");
  printf("</tr>");
  printf("<tr><td>");
  printf("<iframe name=\"trafficconf_linksetup_linksetup\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_linksetup_linksetup\" frameborder=no style='width:100%%; height:120px;'></iframe>");
  return printf("</td></tr>");
}

//----- (00046B3C) --------------------------------------------------------
int print_iframe_trafficconf_linksetup_linksetup()
{
  print_js_file((int)"trafficconf", (int)"linksetup");
  printf("<style>");
  printf("body { margin: 0; }");
  printf("form { margin: 0; }");
  printf("tr { height: 24px; }");
  printf("</style>");
  puts("<form method=post action=timepro.cgi name=linksetup_fm>");
  printf("<table id='trafficconf_linksetup_linksetup_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  printf("</table>");
  printf("</form>");
  return printf("<iframe name=\"trafficconf_linksetup_linksetup_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_linksetup_linksetup_status\" frameborder=no style='display: none;'></iframe>");
}

//----- (00046BD0) --------------------------------------------------------
int __fastcall print_iframe_trafficconf_linksetup_linksetup_status(int a1, int a2)
{
  int v2; // r6@1
  int v3; // r4@1
  int v4; // r4@5
  const char *v5; // r2@13
  bool v6; // nf@13
  unsigned __int8 v7; // vf@13
  int v8; // r3@14
  const char *v9; // r1@17
  unsigned int v10; // r0@21
  signed int v11; // r5@22
  signed int v12; // r1@23
  signed int v13; // r5@25
  signed int v14; // r1@26
  const char *i; // r0@28
  int v16; // r5@30
  signed int v17; // r5@31
  int v18; // r1@32
  signed int v19; // r5@34
  signed int v20; // r1@35
  char v22; // [sp+4h] [bp-424h]@22
  int v23; // [sp+278h] [bp-1B0h]@27
  int v24; // [sp+27Ch] [bp-1ACh]@24
  char v25; // [sp+3B0h] [bp-78h]@1
  char s; // [sp+3D0h] [bp-58h]@5
  char v27; // [sp+3F0h] [bp-38h]@5
  __int16 v28; // [sp+3FAh] [bp-2Eh]@8
  int v29; // [sp+404h] [bp-24h]@10

  v2 = a2;
  v3 = get_value_post(a2, "act", &v25, 32);
  if ( v3 )
  {
    if ( !strcmp(&v25, "setport") )
    {
      v3 = get_value_post(v2, "port", &v25, 32);
      if ( v3 )
      {
        v4 = atoi(&v25);
        read_portconfig(v4, &v27);
        snprintf(&s, 0x20u, "mode%d", v4);
        if ( get_value_post(v2, &s, &v25, 32) )
          sf_strncpy(&v27, &v25, 10);
        snprintf(&s, 0x20u, "speed%d", v4);
        if ( get_value_post(v2, &s, &v25, 32) )
          sf_strncpy(&v28, &v25, 10);
        if ( !strcmp((const char *)&v28, "1000") )
        {
          strcpy((char *)&v29, "full");
        }
        else
        {
          sprintf(&s, "duplex%d", v4);
          if ( get_value_post(v2, &s, &v25, 32) )
            sf_strncpy(&v29, &v25, 10);
        }
        set_port_config(v4, &v27);
        write_portconfig(v4, &v27);
        v7 = __OFSUB__(v4, 0x10000);
        v6 = v4 - 0x10000 < 0;
        if ( v4 >= 0x10000 )
          v8 = v4 - 0x10000;
        else
          v8 = v4;
        if ( v4 >= 0x10000 )
        {
          v9 = (const char *)&unk_A93F9;
        }
        else
        {
          v9 = "%s: LAN %d";
          v5 = "@{38}";
        }
        v3 = 1;
        if ( !(v6 ^ v7) )
          v5 = "@{38}";
        syslog_msg(1, v9, v5, v8);
        v10 = sleep(2u);
        signal_save(v10);
      }
    }
    else
    {
      v3 = 0;
    }
  }
  v11 = 1;
  get_si("hw", &v22);
  print_js_file((int)"trafficconf", (int)"linksetup");
  puts("<form method=post action=timepro.cgi name=linksetup_fm>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=trafficconf_linksetup_linksetup_status>");
  puts("<input type=hidden name=act value=>");
  puts("<input type=hidden name=port value=>");
  printf("<table id='trafficconf_linksetup_linksetup_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  while ( v11 <= v24 )
  {
    v12 = v11++ + 0x10000;
    sub_466C8((int)&v22, v12);
  }
  v13 = 1;
  while ( v13 <= v23 )
  {
    v14 = v13++;
    sub_466C8((int)&v22, v14);
  }
  for ( i = 0; ; i = (const char *)v16 )
  {
    v16 = (int)(i + 1);
    if ( (signed int)(&i[v23] + v24) > 4 )
      break;
    sub_46684(i, 4, 24);
  }
  v17 = 1;
  printf("</table>");
  puts("</form>");
  puts("<script>");
  printf("parent.document.getElementById('trafficconf_linksetup_linksetup_table').outerHTML = document.getElementById('trafficconf_linksetup_linksetup_table').outerHTML;");
  while ( v17 <= v24 )
  {
    v18 = v17++ + 0x10000;
    printf("parent.window.SelectLinkMode(%d);\n", v18);
  }
  v19 = 1;
  while ( v19 <= v23 )
  {
    v20 = v19++;
    printf("parent.window.SelectLinkMode(%d);\n", v20);
  }
  if ( v3 == 1 )
  {
    printf("setTimeout(function() {");
    printf("refreshLinkStatus(parent.parent.document);");
    printf("refreshLinkStat(parent.parent.document);");
    printf("}, 2000);");
  }
  printf("setTimeout(function() { UnMaskIt(parent.parent.document, 'apply_mask'); }, 500);");
  return printf("</script>");
}
// 104B4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10B08: using guessed type int __fastcall set_port_config(_DWORD, _DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 113CC: using guessed type int syslog_msg(_DWORD, const char *, ...);
// 11480: using guessed type int __fastcall read_portconfig(_DWORD, _DWORD);
// 11900: using guessed type int __fastcall write_portconfig(_DWORD, _DWORD);

//----- (00046F88) --------------------------------------------------------
signed int __fastcall sub_46F88(signed int result, int a2, _QWORD *a3)
{
  __int64 v3; // r0@12

  if ( result == 128 )
  {
    v3 = *(_QWORD *)(a2 + 56);
    goto LABEL_34;
  }
  if ( result > 128 )
  {
    if ( result == 2048 )
    {
      v3 = *(_QWORD *)(a2 + 88);
      goto LABEL_34;
    }
    if ( result > 2048 )
    {
      if ( result == 0x2000 )
      {
        v3 = *(_QWORD *)(a2 + 104);
        goto LABEL_34;
      }
      if ( result == 0x4000 )
      {
        v3 = *(_QWORD *)(a2 + 112);
        goto LABEL_34;
      }
      if ( result == 4096 )
      {
        v3 = *(_QWORD *)(a2 + 96);
        goto LABEL_34;
      }
    }
    else
    {
      if ( result == 512 )
      {
        v3 = *(_QWORD *)(a2 + 72);
        goto LABEL_34;
      }
      if ( result == 1024 )
      {
        v3 = *(_QWORD *)(a2 + 80);
        goto LABEL_34;
      }
      if ( result == 256 )
      {
        v3 = *(_QWORD *)(a2 + 64);
        goto LABEL_34;
      }
    }
  }
  else
  {
    if ( result == 8 )
    {
      v3 = *(_QWORD *)(a2 + 24);
      goto LABEL_34;
    }
    if ( result <= 8 )
    {
      if ( result == 2 )
      {
        v3 = *(_QWORD *)(a2 + 8);
      }
      else
      {
        if ( result != 4 )
        {
          if ( result != 1 )
            return 0;
          *a3 = *(_QWORD *)a2;
          return result;
        }
        v3 = *(_QWORD *)(a2 + 16);
      }
LABEL_34:
      *a3 = v3;
      return 1;
    }
    if ( result == 32 )
    {
      v3 = *(_QWORD *)(a2 + 40);
      goto LABEL_34;
    }
    if ( result == 64 )
    {
      v3 = *(_QWORD *)(a2 + 48);
      goto LABEL_34;
    }
    if ( result == 16 )
    {
      v3 = *(_QWORD *)(a2 + 32);
      goto LABEL_34;
    }
  }
  return 0;
}

//----- (000470AC) --------------------------------------------------------
int __fastcall sub_470AC(int a1, int a2, int a3, signed int a4)
{
  int result; // r0@1
  int v5; // r4@1
  int v6; // r7@1
  signed int v7; // r5@1
  int v8; // r0@9
  int v9; // r0@29
  size_t v10; // r1@29
  const char *v11; // r2@29
  char *v12; // r0@29
  int v13; // r0@35
  signed int v14; // r6@36
  bool v15; // zf@36
  const char *v16; // r0@37
  int *v17; // r1@39
  const char *v18; // r0@40
  signed int v19; // r8@45
  int v20; // r2@48
  const char *v21; // r0@48
  int v22; // [sp+0h] [bp-A8h]@29
  __int64 v23; // [sp+80h] [bp-28h]@44

  result = a2 & a1;
  v5 = a2;
  v6 = a3;
  v7 = a4;
  if ( !result )
    return result;
  if ( a2 != 128 )
  {
    if ( a2 > 128 )
    {
      if ( a2 == 2048 )
      {
        v8 = 855;
        goto LABEL_35;
      }
      if ( a2 > 2048 )
      {
        if ( a2 == 0x2000 )
        {
          v8 = 857;
          goto LABEL_35;
        }
        if ( a2 == 0x4000 )
        {
          v8 = 860;
          goto LABEL_35;
        }
        if ( a2 == 4096 )
        {
          v8 = 858;
          goto LABEL_35;
        }
      }
      else
      {
        if ( a2 == 512 )
        {
          v8 = 859;
          goto LABEL_35;
        }
        if ( a2 == 1024 )
        {
          v8 = 856;
          goto LABEL_35;
        }
        if ( a2 == 256 )
        {
          v8 = 851;
          goto LABEL_35;
        }
      }
    }
    else
    {
      if ( a2 == 8 )
      {
        v8 = 849;
        goto LABEL_35;
      }
      if ( a2 > 8 )
      {
        if ( a2 == 32 )
        {
          v8 = 846;
          goto LABEL_35;
        }
        if ( a2 == 64 )
        {
          v8 = 845;
          goto LABEL_35;
        }
        if ( a2 == 16 )
        {
          v8 = 847;
          goto LABEL_35;
        }
      }
      else
      {
        if ( a2 == 2 )
        {
          v8 = 844;
          goto LABEL_35;
        }
        if ( a2 == 4 )
        {
          v8 = 843;
          goto LABEL_35;
        }
        if ( a2 == 1 )
        {
          v8 = 850;
LABEL_35:
          v13 = get_ux_text_common(v8, a2);
          v10 = 128;
          v11 = (const char *)v13;
          v12 = (char *)&v22;
          goto LABEL_36;
        }
      }
    }
    strcpy((char *)&v22, "");
    return 0;
  }
  v9 = get_ux_text_common(848, 128);
  v10 = v5;
  v11 = (const char *)v9;
  v12 = (char *)&v22;
LABEL_36:
  snprintf(v12, v10, v11);
  v14 = 1;
  v15 = (dword_CA618++ & 1) == 0;
  if ( v15 )
    v16 = "<tr style='background-color:#FFF; height: 20px;'>";
  else
    v16 = "<tr style='background-color:#F7F7F7; height: 20px;'>";
  printf(v16);
  v17 = &v22;
  if ( v7 > 6 )
  {
    v18 = "<td style='width:120px; padding: 0 3px; font-size:9px;'><span style='padding-left: 5px;'>%s</span></td>";
  }
  else
  {
    v18 = "<td style='width:120px;'><span style='padding-left: 5px;'>%s</span></td>";
    v17 = &v22;
  }
  printf(v18, v17);
  while ( v14 <= v7 )
  {
    sub_46F88(v5, v6, &v23);
    if ( v14 == v7 )
      v19 = 79;
    else
      v19 = 95;
    if ( v7 <= 6 )
    {
      v20 = itoa_with_comma(v23, HIDWORD(v23), 1);
      v21 = "<td style='width:%dpx;'><span>%s</span></td>";
    }
    else
    {
      v20 = itoa_with_comma(v23, HIDWORD(v23), 1);
      v21 = "<td style='width:%dpx; padding: 0 3px; font-size:9px;'><span>%s</span></td>";
    }
    ++v14;
    v6 += 120;
    printf(v21, v19, v20);
  }
  printf("<td style='width:25px;'></td>");
  printf("</tr>");
  return 1;
}
// 11438: using guessed type int __fastcall itoa_with_comma(_DWORD, _DWORD, _DWORD);
// CA618: using guessed type int dword_CA618;

//----- (000472F4) --------------------------------------------------------
int sub_472F4()
{
  int result; // r0@1
  int v1; // r1@2
  int v2; // r0@2
  int v3; // r1@2
  int v4; // r0@3
  char v5; // [sp+4h] [bp-3B4h]@1
  int v6; // [sp+CCh] [bp-2ECh]@1

  result = get_si("hw", &v5);
  if ( !v6 )
    return result;
  printf("<tr class='menu'><td>");
  printf("<table cellpadding=0px cellspacing=0px width=100%%>\n");
  v2 = get_ux_text_common(854, v1);
  printf("<td><b>%s</b></td>", v2);
  if ( v6 < 0 )
  {
    v4 = get_ux_text_common(838, v3);
    printf(
      "<td align=right><span style='cursor:pointer; margin-right: 20px;' onclick='ClearLinkStat();'><img src='/images2/mi"
      "nus_icon.gif' style='padding: 1px;'>%s</span><td>",
      v4);
  }
  printf("</table>");
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<iframe name=\"trafficconf_linksetup_linkstat\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_linksetup_linkstat\" frameborder=no style='width:100%%; height:220px; border-bottom: 1px solid #CCC; '></iframe>");
  printf("<iframe name=\"trafficconf_linksetup_linkstat_clear\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_linksetup_linkstat_clear\" frameborder=no style='display: none;'></iframe>");
  result = printf("</td></tr>");
  return result;
}
// 104B4: using guessed type int __fastcall get_si(_DWORD, _DWORD);

//----- (000473B8) --------------------------------------------------------
int print_iframe_trafficconf_linksetup_linkstat()
{
  printf("<style>");
  printf("body { margin: 0; }");
  printf(".title { background-color: #EEE; height:20px; }");
  printf(".title >td { border-bottom: 1px solid #CCC; }");
  printf("</style>");
  printf("<table id='trafficconf_linksetup_linkstat_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  printf("</table>");
  return printf("<iframe name=\"trafficconf_linksetup_linkstat_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_linksetup_linkstat_status\" frameborder=no style='display: none;'></iframe>");
}

//----- (00047420) --------------------------------------------------------
int print_iframe_trafficconf_linksetup_linkstat_status()
{
  signed int v0; // r5@1
  int v1; // r1@1
  int v2; // r1@2
  const char *v3; // r0@2
  signed int v4; // r4@4
  signed int v5; // r3@5
  signed int v6; // r4@7
  signed int v7; // r2@8
  void *v8; // r4@10
  void *v9; // r7@10
  signed int v10; // r6@10
  int v11; // r0@11
  void *v12; // r1@11
  signed int v13; // r6@13
  signed int v14; // r0@14
  int v15; // r1@14
  int v16; // r6@16
  int v17; // r6@16
  int v18; // r6@16
  int v19; // r6@16
  int v20; // r6@16
  int v21; // r6@16
  int v22; // r6@16
  int v23; // r6@16
  int v24; // r6@16
  int v25; // r6@16
  int v26; // r6@16
  int v27; // r6@16
  int v28; // r6@16
  int v29; // r6@16
  int v30; // r6@16
  const char *v31; // r0@17
  char v33; // [sp+4h] [bp-3E4h]@1
  int v34; // [sp+CCh] [bp-31Ch]@16
  int v35; // [sp+278h] [bp-170h]@1
  int v36; // [sp+27Ch] [bp-16Ch]@1
  char s; // [sp+3B0h] [bp-38h]@5

  get_si("hw", &v33);
  v0 = v36 + v35;
  puts("<form method=post action=timepro.cgi name=linkstat_fm>");
  puts("<input type=hidden name=tmenu value=trafficconf>");
  puts("<input type=hidden name=smenu value=linksetup>");
  puts("<input type=hidden name=act value=>");
  printf("<table id='trafficconf_linksetup_linkstat_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  printf("<tr class='title' style='background-color: #EEE;'>");
  if ( v0 <= 6 )
  {
    v2 = get_ux_text_common(992, v1);
    v3 = "<td><span style='padding-left: 5px;'>%s</span></td>";
  }
  else
  {
    v2 = get_ux_text_common(992, v1);
    v3 = "<td style='padding: 0 3px;'><span style='padding-left: 5px;'>%s</span></td>";
  }
  printf(v3, v2);
  v4 = 1;
  while ( v4 <= v36 )
  {
    v5 = v4++;
    snprintf(&s, 0x20u, "WAN%d", v5);
    printf("<td><span>%s</span></td>", &s);
  }
  v6 = 1;
  while ( v6 <= v35 )
  {
    v7 = v6++;
    sprintf(&s, "%d", v7);
    printf("<td><span>%s</span></td>", &s);
  }
  printf("<td></td>");
  printf("</tr>");
  v8 = malloc(120 * v0);
  v9 = v8;
  memset(v8, 0, 120 * v0);
  v10 = 1;
  while ( v10 <= v36 )
  {
    v11 = v10 + 0x10000;
    v12 = v9;
    ++v10;
    v9 = (char *)v9 + 120;
    get_eport_stat(v11, v12);
  }
  v13 = 1;
  while ( v13 <= v35 )
  {
    v14 = v13;
    v15 = v36 - 1 + v13++;
    get_eport_stat(v14, (char *)v8 + 120 * v15);
  }
  v16 = sub_470AC(v34, 1, (int)v8, v0);
  v17 = sub_470AC(v34, 2, (int)v8, v0) + v16;
  v18 = v17 + sub_470AC(v34, 4, (int)v8, v0);
  v19 = v18 + sub_470AC(v34, 8, (int)v8, v0);
  v20 = v19 + sub_470AC(v34, 16, (int)v8, v0);
  v21 = v20 + sub_470AC(v34, 32, (int)v8, v0);
  v22 = v21 + sub_470AC(v34, 64, (int)v8, v0);
  v23 = v22 + sub_470AC(v34, 128, (int)v8, v0);
  v24 = v23 + sub_470AC(v34, 256, (int)v8, v0);
  v25 = v24 + sub_470AC(v34, 512, (int)v8, v0);
  v26 = v25 + sub_470AC(v34, 1024, (int)v8, v0);
  v27 = v26 + sub_470AC(v34, 2048, (int)v8, v0);
  v28 = v27 + sub_470AC(v34, 4096, (int)v8, v0);
  v29 = v28 + sub_470AC(v34, 0x2000, (int)v8, v0);
  v30 = v29 + sub_470AC(v34, 0x4000, (int)v8, v0);
  while ( v30 <= 9 )
  {
    v31 = (const char *)v30++;
    sub_46684(v31, v0, 20);
  }
  free(v8);
  printf("</table>");
  printf("</form>");
  printf("<script>");
  printf("parent.document.getElementById('trafficconf_linksetup_linkstat_table').outerHTML = document.getElementById('trafficconf_linksetup_linkstat_table').outerHTML;");
  printf("setTimeout(function() { location.reload(); }, 3000);");
  return printf("</script>");
}
// 104B4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// 10904: using guessed type int __fastcall get_eport_stat(_DWORD, _DWORD);

//----- (000477BC) --------------------------------------------------------
int __fastcall print_iframe_trafficconf_linksetup_linkstat_clear(int a1, int a2)
{
  signed int v2; // r4@2
  int v4; // [sp+0h] [bp-28h]@1

  if ( get_value_post(a2, "act", &v4, 32) )
  {
    if ( !strcmp((const char *)&v4, "clear") )
      clear_port_statistics();
    v2 = 1;
  }
  else
  {
    v2 = 0;
  }
  print_js_file((int)"trafficconf", (int)"linksetup");
  puts("<form method=post action=timepro.cgi name=linkstat_fm>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=trafficconf_linksetup_linkstat_clear>");
  puts("<input type=hidden name=act value=>");
  printf("</form>");
  printf("<script>");
  if ( v2 != 1 )
    return printf("</script>");
  printf("refreshLinkStat(parent.document);");
  printf("setTimeout(function() {UnMaskIt(parent.document, 'apply_mask');}, 500);");
  return printf("</script>");
}
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 112C4: using guessed type int clear_port_statistics(void);

//----- (00047898) --------------------------------------------------------
int print_iframe_trafficconf_linksetup_linkstatus()
{
  printf("<style>");
  printf("body { margin: 0; }");
  printf(".title { background-color: #EEE; height:20px; }");
  printf(".title >td { border-bottom: 1px solid #CCC; }");
  printf("tr { height: 20px; }");
  printf("</style>");
  printf("<table id='trafficconf_linksetup_linkstatus_table' cellpadding=0px cellspacing=0px width=100%% style='padding-left; 5px;'>\n");
  printf("</table>");
  return printf("<iframe name=\"trafficconf_linksetup_linkstatus_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_linksetup_linkstatus_status\" frameborder=no style='display: none;'></iframe>");
}

//----- (0004790C) --------------------------------------------------------
int print_iframe_trafficconf_linksetup_linkstatus_status()
{
  signed int v0; // r5@1
  char *v1; // r4@1
  char *v2; // r6@1
  char *v3; // r7@1
  signed int v4; // r0@2
  char *v5; // r1@2
  signed int v6; // r5@4
  int v7; // r0@5
  int v8; // r1@5
  signed int v9; // r5@7
  int v10; // r1@7
  int v11; // r0@7
  signed int v12; // r3@8
  signed int v13; // r5@10
  signed int v14; // r2@11
  signed int v15; // r5@13
  int v16; // r1@13
  int v17; // r0@13
  int v18; // r1@14
  char *v19; // r7@16
  signed int v20; // r5@16
  char *v21; // r1@17
  signed int v22; // r5@19
  int v23; // r1@19
  int v24; // r0@19
  int v25; // r1@20
  char *v26; // r7@22
  signed int v27; // r5@22
  int v28; // r1@23
  signed int v29; // r5@25
  int v30; // r1@25
  int v31; // r0@25
  int v32; // r1@26
  signed int v33; // r5@28
  int v34; // r1@29
  char v36; // [sp+4h] [bp-3E4h]@1
  int v37; // [sp+278h] [bp-170h]@1
  int v38; // [sp+27Ch] [bp-16Ch]@1
  char s; // [sp+3B0h] [bp-38h]@8

  v0 = 1;
  get_si("hw", &v36);
  v1 = (char *)malloc(30 * (v38 + v37));
  v2 = v1;
  v3 = v1;
  while ( v0 <= v37 )
  {
    v4 = v0;
    v5 = v3;
    ++v0;
    v3 += 30;
    get_link_status(v4, v5);
  }
  v6 = 1;
  while ( v6 <= v38 )
  {
    v7 = v6 + 0x10000;
    v8 = v37 - 1 + v6++;
    get_link_status(v7, &v1[30 * v8]);
  }
  v9 = 1;
  printf("<table id='trafficconf_linksetup_linkstatus_table' cellpadding=0px cellspacing=0px width=100%%'>\n");
  printf("<tr class='title'>");
  v11 = get_ux_text_common(992, v10);
  printf("<td style='width:120px;'><span style='padding-left: 5px;'>%s</span></td>", v11);
  while ( v9 <= v38 )
  {
    v12 = v9++;
    snprintf(&s, 0x20u, "WAN%d", v12);
    printf("<td style='width:95px;'><span>%s</span></td>", &s);
  }
  v13 = 1;
  while ( v13 <= v37 )
  {
    v14 = v13++;
    sprintf(&s, "%d", v14);
    printf("<td style='width:95px;'><span>%s</span></td>", &s);
  }
  v15 = 1;
  printf("<td style='width:25px;'></td>");
  printf("</tr>");
  printf("<tr style='background-color: #FFF;'>");
  v17 = get_ux_text_common(841, v16);
  printf("<td style='width:120px;'><span style='padding-left: 5px;'>%s</span></td>", v17);
  while ( v15 <= v38 )
  {
    v18 = v37 - 1 + v15++;
    printf("<td style='width:95px;'><span>%s</span></td>", &v1[30 * v18]);
  }
  v19 = v1;
  v20 = 1;
  while ( v20 <= v37 )
  {
    v21 = v19;
    ++v20;
    v19 += 30;
    printf("<td style='width:95px;'><span>%s</span></td>", v21);
  }
  v22 = 1;
  printf("<td style='width:25px;'></td>");
  printf("</tr>");
  printf("<tr style='background-color: #F7F7F7;'>");
  v24 = get_ux_text_common(853, v23);
  printf("<td style='width:120px;'><span style='padding-left: 5px;'>%s</span></td>", v24);
  while ( v22 <= v38 )
  {
    v25 = v37 - 1 + v22++;
    printf("<td style='width:95px;'><span>%s</span></td>", &v1[30 * v25 + 10]);
  }
  v26 = v1;
  v27 = 1;
  while ( v27 <= v37 )
  {
    v28 = (int)(v26 + 10);
    ++v27;
    v26 += 30;
    printf("<td style='width:95px;'><span>%s</span></td>", v28);
  }
  v29 = 1;
  printf("<td style='width:25px;'></td>");
  printf("</tr>");
  printf("<tr style='background-color: #FFF;'>");
  v31 = get_ux_text_common(839, v30);
  printf("<td style='width:120px;'><span style='padding-left: 5px;'>%s</span></td>", v31);
  while ( v29 <= v38 )
  {
    v32 = v37 - 1 + v29++;
    printf("<td style='width:95px;'><span>%s</span></td>", &v1[30 * v32 + 20]);
  }
  v33 = 1;
  while ( v33 <= v37 )
  {
    v34 = (int)(v2 + 20);
    ++v33;
    v2 += 30;
    printf("<td style='width:95px;'><span>%s</span></td>", v34);
  }
  printf("<td style='width:25px;'></td>");
  printf("</tr>");
  printf("</table>");
  free(v1);
  printf("<script>");
  printf("parent.document.getElementById('trafficconf_linksetup_linkstatus_table').outerHTML = document.getElementById('trafficconf_linksetup_linkstatus_table').outerHTML;");
  printf("setTimeout(function() { location.reload(); }, 3000);");
  return printf("</script>");
}
// 10418: using guessed type int __fastcall get_link_status(_DWORD, _DWORD);
// 104B4: using guessed type int __fastcall get_si(_DWORD, _DWORD);

//----- (00047C68) --------------------------------------------------------
int trafficconf_linksetup()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r5@1
  void *v4; // r0@1

  print_js_file((int)"trafficconf", (int)"linksetup");
  printf("<style>");
  printf(".menu { background-color: #E3E3E3; height: 24px; }");
  printf(".menu >td { border-width: 1px 0; border-color: #CCC; border-style: solid; }");
  printf(".menu b { padding-left: 5px; }");
  printf(".title { background-color: #EEE; height:20px; }");
  printf(".title >td { border-bottom: 1px solid #CCC; }");
  printf("</style>");
  printf("<table cellpadding=0px cellspacing=0px width=100%%>\n");
  printf("<tr class='menu'><td>");
  v1 = get_ux_text_common(840, v0);
  printf("<b>%s</b>", v1);
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<iframe name=\"trafficconf_linksetup_linkstatus\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_linksetup_linkstatus\" frameborder=no style='width:100%%; height:80px;'></iframe>");
  printf("</td></tr>");
  sub_46A24();
  sub_472F4();
  printf("</table>");
  v3 = get_ux_text_common(34, v2);
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v4 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v4);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:"
    "middle; display:block; text-align:center;\">%s\n",
    v3);
  printf("</SPAN></td>");
  return printf((const char *)&unk_7D215);
}

//----- (00047DFC) --------------------------------------------------------
int __fastcall firewallconf_netdetect(int a1)
{
  int v1; // r4@1
  int result; // r0@1
  int v3; // r0@2
  int v4; // r8@6
  int v5; // r0@8
  int v6; // r10@11
  int v7; // r0@13
  const char *v8; // r1@13
  int v9; // r9@18
  int v10; // r5@24
  int v11; // r6@26
  int v12; // r4@31
  int v13; // r0@38
  int v14; // r9@39
  int v15; // r7@39
  char *v16; // r5@39
  int v17; // r10@39
  int v18; // r11@39
  int v19; // r0@39
  int v20; // r1@39
  int v21; // r0@39
  int v22; // r0@39
  int v23; // r0@39
  int v24; // r1@39
  int v25; // r0@39
  int v26; // r0@39
  int v27; // r1@39
  char *v28; // r8@40
  int v29; // r0@42
  int v30; // r0@42
  int v31; // r1@42
  char *v32; // r8@43
  int v33; // r0@45
  int v34; // r0@45
  int v35; // r0@45
  int v36; // r1@45
  int v37; // r0@45
  int v38; // r1@45
  char *v39; // r8@46
  int v40; // r0@48
  int v41; // r1@48
  char *v42; // r8@49
  int v43; // r0@51
  int v44; // r0@51
  int v45; // r0@51
  char *v46; // r8@51
  int v47; // r1@51
  int v48; // r0@51
  char *v49; // r1@52
  char *v50; // r1@55
  char *v51; // ST0C_4@57
  int v52; // r0@57
  char *v53; // r1@58
  char *v54; // ST0C_4@60
  int v55; // r0@60
  char *v56; // r1@61
  char *v57; // ST0C_4@63
  int v58; // r0@63
  char *v59; // r1@64
  int v60; // r1@67
  int v61; // ST0C_4@69
  int v62; // r0@69
  int v63; // r0@69
  int v64; // r0@69
  int v65; // r1@69
  int v66; // r0@69
  char *v67; // r1@70
  char *v68; // ST0C_4@72
  int v69; // r0@72
  int v70; // r1@72
  int v71; // r0@74
  int v72; // r1@74
  char *v73; // r11@75
  int v74; // r0@77
  int v75; // r0@77
  int v76; // r0@77
  int v77; // r1@77
  int v78; // r0@77
  int v79; // r1@77
  const char *v80; // r0@79
  int v81; // r8@80
  int v82; // r0@80
  int v83; // r0@80
  int v84; // r1@80
  int v85; // r0@80
  int v86; // r0@80
  int v87; // r0@80
  int v88; // r1@80
  int v89; // r0@80
  int v90; // r0@80
  int v91; // r1@80
  int v92; // r0@80
  int v93; // r1@80
  int v94; // r0@80
  int v95; // r0@80
  int v96; // r0@80
  int v97; // r0@80
  int v98; // r1@80
  int v99; // r0@80
  int v100; // r1@80
  int v101; // r0@80
  int v102; // r1@80
  int v103; // r0@80
  int v104; // r1@80
  int v105; // r0@80
  int v106; // r1@80
  int v107; // r0@80
  int v108; // r0@80
  int v109; // r0@80
  int v110; // r0@80
  int v111; // r11@80
  int v112; // r6@81
  char *v113; // r0@82
  const char *v114; // r0@82
  const char *v115; // r0@83
  int v116; // r3@85
  char *v117; // r3@86
  const char *v118; // r1@89
  char *v119; // r7@94
  int v120; // r0@96
  int v121; // r0@96
  int v122; // r0@99
  char *v123; // r1@101
  int v124; // r1@103
  int v125; // r0@103
  int v126; // r1@103
  int v127; // r0@103
  int v128; // r1@103
  char *v129; // r4@104
  int v130; // r0@106
  int v131; // r1@106
  int v132; // r0@108
  char v133; // [sp+14h] [bp-334h]@82
  char v134; // [sp+114h] [bp-234h]@20
  char v135; // [sp+194h] [bp-1B4h]@21
  char nptr; // [sp+214h] [bp-134h]@4
  char v137; // [sp+294h] [bp-B4h]@2
  int v138; // [sp+314h] [bp-34h]@39
  int v139; // [sp+318h] [bp-30h]@39
  int v140; // [sp+31Ch] [bp-2Ch]@39

  v1 = a1;
  result = print_natoff_warning();
  if ( result )
    return result;
  v3 = get_value(v1, "act", &v137, 128);
  if ( v3 )
  {
    if ( strcmp(&v137, "conf") )
    {
      if ( !strcmp(&v137, "clear") )
      {
        v5 = netdetect_clear_all_history();
      }
      else
      {
        v5 = strcmp(&v137, "sendemail");
        if ( !v5 )
          v5 = write_file("/var/run/nd_send_immediately", "1");
      }
      goto LABEL_38;
    }
    if ( !get_value(v1, "op_radio", &nptr, 128) || strcmp(&nptr, "on") )
    {
      v5 = netdetect_set_on_off(0);
LABEL_38:
      v13 = signal_update(v5);
      v3 = signal_save(v13);
      goto LABEL_39;
    }
    netdetect_set_on_off(1);
    v4 = get_value(v1, "sel_port", &nptr, 128);
    if ( v4 )
      v4 = atoi(&nptr);
    if ( !get_value(v1, "sel_level", &nptr, 128) )
    {
      v6 = 1;
LABEL_18:
      v9 = get_value(v1, "burst_drop", &nptr, 128);
      if ( v9 )
        v9 = atoi(&nptr);
      if ( get_admin_email(&v134) && get_smtp_server(&v135) )
      {
        if ( get_value(v1, "rp_mail", &nptr, 128) && get_value(v1, "rp_time", &nptr, 128) )
          v10 = atoi(&nptr);
        else
          v10 = 255;
        v11 = get_value(v1, "rp_first", &nptr, 128);
        if ( v11 )
          v11 = strcmp(&nptr, "on") == 0;
        if ( get_value(v1, "rp_clear", &nptr, 128) )
          strcmp(&nptr, "on");
        netdetect_set_email_policy(v10, v11);
      }
      v12 = get_value(v1, &unk_AA1E4, &nptr, 128);
      if ( v12 )
        v12 = strcmp(&nptr, "on") == 0;
      netdetect_set_portrange_and_monitorlevel(v4, v6);
      v5 = netdetect_set_burst_drop(v9, v12);
      goto LABEL_38;
    }
    if ( !strcmp(&nptr, "pre_defined") )
    {
      v7 = v1;
      v8 = "level_type";
    }
    else
    {
      if ( strcmp(&nptr, "user_defined") )
      {
LABEL_17:
        v6 = atoi(&nptr);
        goto LABEL_18;
      }
      v8 = "user_level";
      v7 = v1;
    }
    get_value(v7, v8, &nptr, 128);
    goto LABEL_17;
  }
LABEL_39:
  v14 = netdetect_get_detect_port_range(v3);
  v15 = netdetect_get_monitor_level();
  v16 = "";
  v17 = netdetect_get_burst_drop();
  v18 = netdetect_get_virus_drop();
  v19 = netdetect_get_email_policy(&v140, &v139, &v138);
  print_start_main_table(v19);
  printf("<form method=get action=timepro.cgi name=netdetect_fm>");
  printf("<input type=hidden name=tmenu value=firewallconf>");
  printf("<input type=hidden name=smenu value=netdetect>");
  printf("<input type=hidden name=act value=>");
  printf("<input type=hidden name=netdetect_op value=>");
  v21 = get_ux_text_common(895, v20);
  v22 = print_sub_title(v21, 1);
  v23 = print_start_content_table(v22);
  str(v23);
  v25 = get_ux_text_common(938, v24);
  print_item_desc(v25, 0, 0, 0);
  v26 = puts("<td class=item_td>");
  if ( netdetect_get_on_off(v26) )
    v28 = "checked";
  else
    v28 = "";
  v29 = get_ux_text_common(1104, v27);
  printf("<input type=radio name=op_radio value=on %s> %s", v28, v29);
  v30 = print_nbsp(5);
  if ( netdetect_get_on_off(v30) )
    v32 = "";
  else
    v32 = "checked";
  v33 = get_ux_text_common(1111, v31);
  printf("<input type=radio name=op_radio value=off %s> %s", v32, v33);
  print_nbsp(10);
  v34 = get_ifconfig((int)"br0", (int)&nptr, (int)&v137);
  v35 = etr(v34);
  str(v35);
  v37 = get_ux_text_common(888, v36);
  print_item_desc(v37, 0, 0, 0);
  printf("<td class=item_td>");
  if ( v14 )
    v39 = "";
  else
    v39 = "checked";
  v40 = get_ux_text_common(889, v38);
  printf("<input type=radio name=sel_port value=0 onclick=\"disable_sel_port('virus')\" %s> %s", v39, v40);
  print_nbsp(5);
  if ( v14 )
    v42 = "checked";
  else
    v42 = "";
  v43 = get_ux_text_common(887, v41);
  printf("<input type=radio name=sel_port value=1 onclick=\"disable_sel_port('all')\" %s>%s", v42, v43);
  v44 = puts("</td>");
  v45 = etr(v44);
  str(v45);
  v46 = "selected";
  v48 = get_ux_text_common(878, v47);
  print_item_desc(v48, 0, 0, 0);
  printf("<td class=item_td>");
  if ( v15 <= 2 )
    v49 = "checked";
  else
    v49 = "";
  printf("<input type=radio name=sel_level value=pre_defined onclick=\"disable_sel_level('predefine')\" %s> ", v49);
  printf("<select name=\"level_type\">");
  if ( v15 )
    v50 = "";
  else
    v50 = "selected";
  v51 = v50;
  v52 = get_ux_text_common(880, (int)v50);
  printf("<option value=\"0\" %s>%s", v51, v52);
  if ( v15 == 1 )
    v53 = "selected";
  else
    v53 = "";
  v54 = v53;
  v55 = get_ux_text_common(881, (int)v53);
  printf("<option value=\"1\" %s>%s", v54, v55);
  if ( v15 == 2 )
    v56 = "selected";
  else
    v56 = "";
  v57 = v56;
  v58 = get_ux_text_common(879, (int)v56);
  printf("<option value=\"2\" %s>%s", v57, v58);
  puts("</select>");
  print_nbsp(5);
  if ( v15 <= 2 )
    v59 = "";
  else
    v59 = "checked";
  printf("<input type=radio name=sel_level value=user_defined onclick=\"disable_sel_level('userdefine')\" %s> ", v59);
  if ( v15 <= 2 )
    v60 = 0;
  else
    v60 = v15;
  v61 = v60;
  v62 = get_ux_text_common(882, v60);
  printf("<input type=text name=user_level value=%d size=4 maxlength=4> %s", v61, v62);
  v63 = puts("</td>");
  v64 = etr(v63);
  str(v64);
  v66 = get_ux_text_common(862, v65);
  print_item_desc(v66, 0, 0, 0);
  printf("<td class=item_td>");
  printf("<select name=burst_drop onclick=\"disable_sel_port('all')\">");
  if ( v17 )
    v67 = "";
  else
    v67 = "selected";
  v68 = v67;
  v69 = get_ux_text_common(863, (int)v67);
  printf("<option value=0 %s>%s", v68, v69);
  if ( !v17 )
    v46 = "";
  v71 = get_ux_text_common(865, v70);
  printf("<option value=1 %s>%s", v46, v71);
  puts("</select>");
  print_nbsp(5);
  if ( v18 )
    v73 = "checked";
  else
    v73 = "";
  v74 = get_ux_text_common(864, v72);
  printf("<input type=checkbox name=virus_drop %s> %s", v73, v74);
  v75 = puts("</td>");
  v76 = etr(v75);
  str(v76);
  v78 = get_ux_text_common(870, v77);
  print_item_desc(v78, 0, 0, 0);
  printf("<td class=item_td>");
  if ( get_admin_email(&v135) && get_smtp_server(&v134) )
  {
    if ( v140 == 255 )
      v123 = "";
    else
      v123 = "checked";
    printf("<input type=checkbox name=rp_mail onclick=\"checkEmailOption()\" %s>", v123);
    v125 = get_ux_text_common(873, v124);
    printf(" %s ", v125);
    printf("<input type=text name=rp_time value=%d size=2 maxlength=2>");
    v127 = get_ux_text_common(874, v126);
    printf(" %s", v127);
    print_nbsp(3);
    if ( v138 )
      v129 = "checked";
    else
      v129 = "";
    v130 = get_ux_text_common(871, v128);
    printf("<input type=checkbox name=rp_clear %s> %s", v129, v130);
    if ( v139 )
      v16 = "checked";
    v132 = get_ux_text_common(872, v131);
    printf("<br><input type=checkbox name=rp_first %s> %s", v16, v132);
  }
  else
  {
    v80 = (const char *)get_ux_text_common(1204, v79);
    printf(v80, "JavaScript:MovePagetoMain('sysconf','login');");
  }
  v81 = 0;
  v82 = puts("</td>");
  v83 = etr(v82);
  str(v83);
  printf("<td align=right colspan=2 class=item_td>");
  v85 = get_ux_text_common(35, v84);
  v86 = printf("<input type=button name=netdetect_conf value=\"%s\" onclick=\"ConfNetDetect()\"></td>", v85);
  v87 = etr(v86);
  print_end_content_table(v87);
  v89 = get_ux_text_common(883, v88);
  print_sub_title(v89, 0);
  v90 = printf("<tr><td><table border='0' cellpadding='0' cellspacing='0' width=100%%>\n");
  str(v90);
  puts("<td align=left>");
  v92 = get_ux_text_common(885, v91);
  printf("<input type=button name=send_email value=\"%s\" onclick=\"SendEmail()\" %s>", v92);
  puts("</td>");
  puts("<td align=right>");
  v94 = get_ux_text_common(866, v93);
  printf("<input type=button name=clear_history value=\"%s\" onclick=\"ClearHistory()\">", v94);
  v95 = puts("</td>");
  etr(v95);
  v96 = printf("</table></td></tr>");
  v97 = print_start_content_table(v96);
  str(v97);
  v99 = get_ux_text_common(877, v98);
  print_item_desc(v99, 140, 0, 0);
  v101 = get_ux_text_common(442, v100);
  print_item_desc(v101, 80, 0, 0);
  v103 = get_ux_text_common(1007, v102);
  print_item_desc(v103, 60, 0, 0);
  v105 = get_ux_text_common(869, v104);
  print_item_desc(v105, 70, 0, 0);
  v107 = get_ux_text_common(868, v106);
  v108 = print_item_desc(v107, 250, 0, 0);
  v109 = etr(v108);
  v110 = netdetect_read_current_history(v109);
  v111 = v110;
  while ( v81 < v111 )
  {
    v110 = netdetect_get_history_by_index(v81);
    v112 = v110;
    if ( *(_DWORD *)(v110 + 4) )
    {
      str(v110);
      conv_time(*(_DWORD *)(v112 + 20), &v133, 1);
      print_item(&v133, 0);
      v113 = inet_ntoa(*(struct in_addr *)(v112 + 4));
      snprintf(&v133, 0x100u, "%s", v113, 0);
      v114 = (const char *)get_twinip_wan_virtual_ip((int)"wan1");
      if ( !strcmp(&v133, v114) || (v115 = (const char *)get_twinip_wan_virtual_ip((int)"wan2"), !strcmp(&v133, v115)) )
        strcpy(&v133, "Twin IP");
      print_item(&v133, 0);
      v116 = *(_DWORD *)(v112 + 8);
      if ( v116 == 6 )
      {
        v117 = "TCP";
      }
      else if ( v116 == 17 )
      {
        v117 = "UDP";
      }
      else
      {
        v118 = "Multi Port";
        if ( v116 == 1 )
          v118 = "ICMP";
        v117 = (char *)v118;
      }
      snprintf(&v133, 0x100u, "%s", v117, 0);
      if ( *(_DWORD *)(v112 + 8) > 1u )
        snprintf(&v133, 0x100u, "%s/%d", &v133, *(_DWORD *)(v112 + 12));
      print_item(&v133, 0);
      snprintf(&v133, 0x100u, "%d", *(_DWORD *)(v112 + 16), 0);
      print_item(&v133, 0);
      v119 = "red";
      if ( *(_DWORD *)(v112 + 24) & 0x8000 )
        v119 = "black";
      v120 = netdetect_comment_for_specified_port(*(_DWORD *)(v112 + 8), *(_DWORD *)(v112 + 12));
      snprintf(&v133, 0x100u, "<font color=%s>%s</font>", v119, v120);
      v121 = print_item(&v133, 0);
      v110 = etr(v121);
    }
    ++v81;
  }
  print_end_content_table(v110);
  v122 = puts("</form>");
  print_end_main_table(v122);
  puts("<script language=JavaScript>");
  printf("disable_sel_level('%s');\n");
  printf("disable_sel_port('%s');\n");
  puts("checkEmailOption();");
  printf("document.body.style.backgroundColor = '';");
  return puts("</script>");
}
// 10574: using guessed type int __fastcall netdetect_set_portrange_and_monitorlevel(_DWORD, _DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10898: using guessed type int __fastcall netdetect_set_on_off(_DWORD);
// 1097C: using guessed type int netdetect_get_virus_drop(void);
// 10B80: using guessed type int __fastcall netdetect_set_burst_drop(_DWORD, _DWORD);
// 10D6C: using guessed type int __fastcall print_item(_DWORD, _DWORD);
// 10DE4: using guessed type int __fastcall conv_time(_DWORD, _DWORD, _DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 11198: using guessed type int __fastcall netdetect_get_on_off(_DWORD);
// 1121C: using guessed type int __fastcall print_start_main_table(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 112DC: using guessed type int __fastcall print_sub_title(_DWORD, _DWORD);
// 1130C: using guessed type int netdetect_clear_all_history(void);
// 11330: using guessed type int __fastcall netdetect_set_email_policy(_DWORD, _DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 115DC: using guessed type int __fastcall print_end_main_table(_DWORD);
// 11660: using guessed type int __fastcall netdetect_comment_for_specified_port(_DWORD, _DWORD);
// 116FC: using guessed type int __fastcall netdetect_get_history_by_index(_DWORD);
// 117BC: using guessed type int __fastcall print_item_desc(_DWORD, _DWORD, _DWORD, _DWORD);
// 11954: using guessed type int __fastcall print_start_content_table(_DWORD);
// 119C0: using guessed type int __fastcall netdetect_get_email_policy(_DWORD, _DWORD, _DWORD);
// 11AE0: using guessed type int __fastcall netdetect_get_detect_port_range(_DWORD);
// 11C90: using guessed type int __fastcall get_smtp_server(_DWORD);
// 11CCC: using guessed type int netdetect_get_burst_drop(void);
// 11D8C: using guessed type int __fastcall netdetect_read_current_history(_DWORD);
// 11D98: using guessed type int __fastcall print_end_content_table(_DWORD);
// 11DE0: using guessed type int netdetect_get_monitor_level(void);
// 11ED0: using guessed type int __fastcall get_admin_email(_DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);
// 11F84: using guessed type int __fastcall write_file(_DWORD, _DWORD);

//----- (00048A48) --------------------------------------------------------
int __fastcall virustotalJavascript(int a1)
{
  int v1; // r4@1
  const char *v2; // r0@1
  const char *v3; // r4@1
  signed int v4; // r4@4
  int v5; // r0@8
  int v6; // r1@8
  int v7; // r0@8
  int v8; // r0@8
  int v9; // r0@8
  int v10; // r0@8
  const char *v11; // r0@9
  int v12; // r6@12
  int v13; // r0@13
  char *v15; // r0@14
  char v16; // [sp+8h] [bp-130h]@12
  char v17; // [sp+108h] [bp-30h]@12
  char v18; // [sp+118h] [bp-20h]@14

  v1 = a1;
  puts("<script language=JavaScript>");
  puts("<!--");
  puts("function SelectMenu(menu)");
  puts("{");
  puts("\tvar F = document.menu_fm;");
  printf("\tif(menu == 'report')");
  puts("\t\tF.act.value = \"report\"");
  printf("\telse if(menu == 'scan')");
  puts("\t\tF.act.value = \"scan\"");
  printf("\telse if(menu == 'remedy')");
  puts("\t\tF.act.value = \"remedy\"");
  puts("\tF.flag.value = \"nd-warning\"");
  puts("\tF.submit();");
  puts("}");
  puts("-->");
  puts("</script>");
  v2 = (const char *)get_parameter_value(v1, "act");
  v3 = v2;
  if ( !v2 || !strcmp(v2, "report") )
    goto LABEL_7;
  if ( strcmp(v3, "scan") )
  {
    if ( !strcmp(v3, "remedy") )
    {
      v4 = 3;
      goto LABEL_14;
    }
LABEL_7:
    v4 = 1;
    goto LABEL_8;
  }
  v4 = 2;
LABEL_14:
  v15 = getenv("REMOTE_ADDR");
  sf_strncpy(&v18, v15, 16);
  netdetect_set_option_rule(68, &v18);
LABEL_8:
  puts("<BODY BOTTOMMARGIN=0 RIGHTMARGIN=0 LEFTMARGIN=0 TOPMARGIN=0 MARGINWIDTH=0 MARGINHEIGHT=0 >");
  printf("<form method=get action=\"netdetect.cgi\" name=\"menu_fm\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  printf("<input type=hidden name=\"flag\" value=\"\">");
  puts("<table>");
  v5 = print_blank_line(2, 10);
  str(v5);
  printf("<td></td>");
  printf("<td align=right valign=middle>");
  v7 = get_ux_text_common(867, v6);
  printf("<input type=button name=\"ndwarning\" value=\"%s\" onclick=\"javascrip:parent.close()\">", v7);
  v8 = printf("</td>");
  v9 = etr(v8);
  str(v9);
  v10 = puts("<td colspan=2 valign=middle>");
  if ( v4 == 2 )
  {
    v11 = "<iframe width=\"600\" height=\"430\" name=\"subwin\" src=\"http://efm.livecall.co.kr/virusrepair/s_scan.html\"></iframe>";
  }
  else if ( v4 == 3 )
  {
    v11 = "<iframe width=\"600\" height=\"430\" name=\"subwin\" src=\"http://efm.livecall.co.kr/virusrepair/s_remedy.html\"></iframe>";
  }
  else
  {
    v12 = get_router_mgmt_port(v10);
    get_iptime_service_network(&v17);
    snprintf(
      &v16,
      0x100u,
      "<iframe width=\"600\" height=\"430\" name=\"subwin\" src=\"http://%s.1:%d/nd-bin/netdetect.cgi?flag=nd-report\">",
      &v17,
      v12);
    printf("%s", &v16);
    v11 = "</iframe>";
  }
  printf(v11);
  v13 = printf("</td>");
  etr(v13);
  printf("</table>");
  printf("</form>");
  return printf("</body>");
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 10EB0: using guessed type int __fastcall netdetect_set_option_rule(_DWORD, _DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 1157C: using guessed type int __fastcall get_router_mgmt_port(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// 11DD4: using guessed type int __fastcall get_iptime_service_network(_DWORD);

//----- (00048CF0) --------------------------------------------------------
int __fastcall portCheck(int a1)
{
  int v1; // r5@1
  char *v2; // r0@1
  const char *v3; // r0@1
  char *v4; // r0@4
  unsigned __int16 v5; // r0@5
  unsigned __int16 v6; // r0@9
  int v7; // r4@10
  int v8; // r0@11
  int v9; // r7@11
  int v10; // r6@11
  int v11; // r1@12
  unsigned int v12; // r1@13
  int v13; // r0@13
  int v14; // r7@16
  signed int v15; // r5@16
  int v16; // r1@16
  const char *v17; // r0@16
  int v18; // r1@16
  const char *v19; // r0@16
  int v20; // r1@16
  const char *v21; // r0@16
  int v22; // r1@16
  int v23; // r0@16
  int v24; // r1@16
  int v25; // r0@16
  int v26; // r1@16
  int v27; // r0@16
  int v28; // r1@16
  int v29; // r0@16
  int v30; // r0@16
  int v31; // r0@17
  _DWORD *v32; // r4@17
  struct in_addr v33; // r0@17
  char *v34; // r0@18
  const char *v35; // r0@20
  int v36; // r3@22
  char *v37; // r3@23
  const char *v38; // r1@26
  int v39; // r0@31
  char *v40; // r1@32
  char *v41; // r2@35
  int v42; // r1@40
  int v43; // r0@40
  int v44; // r1@41
  int v45; // r0@41
  char v47; // [sp+10h] [bp-150h]@3
  char v48; // [sp+90h] [bp-D0h]@22
  char v49; // [sp+108h] [bp-58h]@16
  char v50; // [sp+118h] [bp-48h]@16
  char v51; // [sp+128h] [bp-38h]@1

  v1 = a1;
  puts("<script language=JavaScript>");
  puts("<!--");
  puts("function Confirm()");
  puts("{");
  puts("\tvar F = document.ndwarning_fm;");
  puts("\tvar chk_ignore = false;");
  puts("\tvar chk_warn = false;");
  puts("\tfor (i=0; i < F.elements.length; i++)");
  puts("\t{");
  puts("\t\tif (F.elements[i].type == 'checkbox')");
  puts("\t\t{");
  puts("\t\t\tif (F.elements[i].checked)");
  puts("\t\t\t{");
  puts("\t\t\t\tif (chk_ignore == false)");
  puts("\t\t\t\t\tF.ignore.value = F.elements[i].value;");
  puts("\t\t\t\telse");
  puts("\t\t\t\t\tF.ignore.value += \" \" + F.elements[i].value;");
  puts("\t\t\t\tchk_ignore = true;");
  puts("\t\t\t}");
  puts("\t\t\telse");
  puts("\t\t\t{");
  puts("\t\t\t\tif (chk_warn == false)");
  puts("\t\t\t\t\tF.warn.value = F.elements[i].value;");
  puts("\t\t\t\telse");
  puts("\t\t\t\t\tF.warn.value += \" \" + F.elements[i].value;");
  puts("\t\t\t\tchk_warn = true;");
  puts("\t\t\t}");
  puts("\t\t}");
  puts("\t}");
  puts("\tF.flag.value = \"nd-report\"");
  puts("\tF.act.value = \"confirm\"");
  puts("\tF.submit();");
  puts("}");
  puts("-->");
  puts("</script>");
  v2 = getenv("REMOTE_ADDR");
  sf_strncpy(&v51, v2, 16);
  v3 = (const char *)get_parameter_value(v1, "act");
  if ( v3 && !strcmp(v3, "confirm") )
  {
    if ( get_value(v1, "ignore", &v47, 128) )
    {
      v4 = strtok(&v47, " ");
      do
      {
        v5 = atoi(v4);
        netdetect_write_option(v5, 0);
        v4 = strtok(0, " ");
      }
      while ( v4 );
    }
    else
    {
      v4 = (char *)get_value(v1, "warn", &v47, 128);
      if ( v4 )
      {
        v4 = strtok(&v47, " ");
        do
        {
          v6 = atoi(v4);
          netdetect_write_option(v6, 0x8000);
          v4 = strtok(0, " ");
        }
        while ( v4 );
      }
    }
    v7 = 0;
    netdetect_read_current_history(v4);
    do
    {
      v8 = netdetect_get_history_by_index(v7);
      v9 = *(_DWORD *)(v8 + 4);
      v10 = v8;
      if ( v9 == inet_addr(&v51) )
      {
        v11 = *(_DWORD *)(v10 + 24);
        if ( v11 & 1 )
        {
          v12 = v11 & 0xFFFFFFFE;
          v13 = *(_WORD *)v10;
          *(_DWORD *)(v10 + 24) = v12;
          netdetect_write_option(v13, v12);
        }
      }
      ++v7;
    }
    while ( v7 != 1000 );
    netdetect_set_option_rule(68, &v51);
  }
  printf("<form method=get action=\"netdetect.cgi\" name=\"ndwarning_fm\">");
  v14 = 0;
  printf("<input type=hidden name=\"act\" value=\"\">");
  v15 = 1;
  printf("<input type=hidden name=\"ignore\" value=\"\">");
  printf("<input type=hidden name=\"warn\" value=\"\">");
  printf("<input type=hidden name=\"flag\" value=\"\">");
  printf("<table style=\"border-collapse:collapse;\" border=0>");
  puts("<tr><td></td><td colspan=4><span class=\"item_string\">");
  puts("<font color=\"crimson\" size=2pt>");
  v17 = (const char *)get_ux_text_common(896, v16);
  printf(v17);
  printf("</font>");
  printf("</span></tr></td>");
  print_blank_line(5, 10);
  get_ifconfig((int)"br0", (int)&v50, (int)&v49);
  puts("<tr><td></td><td colspan=4><span class=\"item_string\">");
  puts("<font color=\"blue\" size=2>");
  v19 = (const char *)get_ux_text_common(876, v18);
  printf(v19);
  printf("<br><br>");
  v21 = (const char *)get_ux_text_common(884, v20);
  printf(v21, &v50);
  printf("</font>");
  printf("</span></tr></td>");
  print_blank_line(5, 15);
  puts("<tr>");
  printf("<td></td>");
  v23 = get_ux_text_common(877, v22);
  print_item_desc(v23, 140, 0, 0);
  v25 = get_ux_text_common(1007, v24);
  print_item_desc(v25, 90, 0, 0);
  v27 = get_ux_text_common(246, v26);
  print_item_desc(v27, 240, 0, 0);
  v29 = get_ux_text_common(892, v28);
  print_item_desc(v29, 60, 0, 0);
  v30 = puts("</tr>");
  netdetect_read_current_history(v30);
  do
  {
    v31 = netdetect_get_history_by_index(v14);
    v32 = (_DWORD *)v31;
    v33.s_addr = *(_DWORD *)(v31 + 4);
    if ( !v33.s_addr )
      break;
    v34 = inet_ntoa(v33);
    if ( !strcmp(&v51, v34) )
    {
      puts("<tr>");
      if ( v32[6] & 1 )
        v35 = "<td><font color=\"limegreen\" size=2pt><sup> NEW </sup></font></td>";
      else
        v35 = "<td></td>";
      printf(v35);
      conv_time(v32[5], &v48, 1);
      print_item(&v48, 140);
      v36 = v32[2];
      if ( v36 == 6 )
      {
        v37 = "TCP";
      }
      else if ( v36 == 17 )
      {
        v37 = "UDP";
      }
      else
      {
        v38 = "Multi Port";
        if ( v36 == 1 )
          v38 = "ICMP";
        v37 = (char *)v38;
      }
      snprintf(&v48, 0x78u, "%s", v37, 0);
      if ( v32[2] > 1u )
        snprintf(&v48, 0x78u, "%s/%d", &v48, v32[3]);
      v15 = 0;
      print_item(&v48, 90);
      v39 = netdetect_comment_for_specified_port(v32[2], v32[3]);
      print_item(v39, 240);
      if ( v32[6] & 0x8000 )
        v40 = "";
      else
        v40 = "checked";
      if ( v32[2] )
        v41 = "";
      else
        v41 = "disabled";
      snprintf(&v48, 0x78u, "<input type=checkbox name=\"w%d\" value=\"%d\" %s %s>", *v32, *v32, v40, v41);
      print_item(&v48, 60);
      puts("</tr>");
    }
    ++v14;
  }
  while ( v14 != 1000 );
  if ( v15 )
  {
    puts("<tr>");
    printf("<td></td>");
    v43 = get_ux_text_common(930, v42);
    print_item(v43, 140);
    print_item("-", 90);
    print_item("-", 240);
    print_item("-", 50);
    puts("</tr>");
  }
  print_blank_line(5, 10);
  printf("<tr><td colspan=5 align=center>");
  v45 = get_ux_text_common(897, v44);
  printf("<input type=button name=\"ndwarning\" value=\"%s\" onclick=\"Confirm()\">", v45);
  printf("</td></tr>");
  printf("</form>");
  print_blank_line(4, 20);
  return printf("</table>");
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10C70: using guessed type int __fastcall netdetect_write_option(_DWORD, _DWORD);
// 10D6C: using guessed type int __fastcall print_item(_DWORD, _DWORD);
// 10DE4: using guessed type int __fastcall conv_time(_DWORD, _DWORD, _DWORD);
// 10EB0: using guessed type int __fastcall netdetect_set_option_rule(_DWORD, _DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 11660: using guessed type int __fastcall netdetect_comment_for_specified_port(_DWORD, _DWORD);
// 116FC: using guessed type int __fastcall netdetect_get_history_by_index(_DWORD);
// 117BC: using guessed type int __fastcall print_item_desc(_DWORD, _DWORD, _DWORD, _DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// 11D8C: using guessed type int __fastcall netdetect_read_current_history(_DWORD);

//----- (00049440) --------------------------------------------------------
int sub_49440()
{
  puts("<style type=\"text/css\">");
  puts(".wol_main_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".wol_main_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".wol_main_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".wol_main_p {");
  puts("\tpadding:0 0 0 5px; display:inline-block;");
  puts("\tvertical-align:middle; margin:0;");
  puts("}");
  puts(".wol_main_span {");
  puts("\tdisplay:inline-block; vertical-align:middle;");
  puts("}");
  puts(".wol_main_button {");
  puts("\tpadding:0 1px 0 1px; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".wol_main_td input[type=checkbox], .wol_main_td input[type=radio] {");
  puts("display:inline-block; vertical-align:middle;");
  puts("}");
  puts("#wol_div_msg p {");
  puts("margin:5 0 5 15px; text-align:left;");
  puts("}");
  puts(".wol_ellipsis {");
  puts("text-overflow:ellipsis; overflow:hidden; white-space:nowrap; text-align:left;");
  puts("}");
  printf("input[type=\"text\"] {border:1px #CCC solid;}");
  printf("input[type=\"password\"] {border:1px #CCC solid;}");
  printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td {cursor:default;}");
  return printf("</style>");
}

//----- (000495DC) --------------------------------------------------------
int __fastcall print_iframe_expertconfmacsearch(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r9@3
  int v4; // r6@3
  void *v5; // r8@3
  void *v6; // r4@3
  int v7; // r10@5
  int v8; // r1@6
  int v9; // r0@6
  int v10; // r1@6
  int v11; // r0@6
  char *v12; // r3@8
  int v13; // r1@19
  int v14; // r0@19
  int v16; // [sp+0h] [bp-C0h]@3
  char v17; // [sp+Ch] [bp-B4h]@5
  char v18; // [sp+38h] [bp-88h]@9
  char v19; // [sp+78h] [bp-48h]@2
  char v20; // [sp+88h] [bp-38h]@1

  v2 = a2;
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_macsearchiframe\">");
  printf("<input type=\"hidden\" name=\"tmenu\" value=\"iframe\">");
  printf("<input type=\"hidden\" name=\"smenu\" value=\"expertconfmacsearch\">");
  printf("<input type=\"hidden\" name=\"inputprefix\" value=\"\">");
  printf("<input type=\"hidden\" name=\"act\" value=\"\">");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  if ( !get_value_post(v2, "act", &v20, 16) || !get_value_post(v2, "inputprefix", &v19, 16) )
    return printf("</script>");
  v3 = 0;
  puts("function MakeMacAddrTable()");
  v4 = 0;
  puts("{");
  puts("var obj = parent.document.getElementById('searchmaclist');");
  puts("var HTMLStr = '<div style=\\\"display:block; width:340px; height:24px;\\\">                        <table class=\\\"wol_main_table\\\" style=\\\"width:340px; height:24px;\\\">';");
  v5 = malloc(0xBC00u);
  v6 = v5;
  memset(v5, 0, 0xBC00u);
  v16 = get_hostinfo_from_arp("br0", 256, v5);
  while ( v4 < v16 )
  {
    if ( strcmp((const char *)v6 + 148, "00:00:00:00:00:00") )
    {
      convert_mac((char *)v6 + 148);
      v7 = dhcpd_get_dynamic_lease((char *)v6 + 128, &v17) != 0;
      if ( !v3 )
      {
        printf("HTMLStr += '<tr class=\\\"wol_main_tr\\\" height=\\\"24\\\">';");
        v9 = get_ux_text_common(985, v8);
        printf(
          "HTMLStr += '<td class=\\\"wol_main_td\\\"                                         style=\\\"width:169px; backg"
          "round-color:#EEEEEE; border:1px #ccc solid;\\\">                                        <span class=\\\"wol_ma"
          "in_span\\\" style=\\\"text-align:center; width:100%%;\\\">%s</span></td>';",
          v9);
        v11 = get_ux_text_common(984, v10);
        printf(
          "HTMLStr += '<td class=\\\"wol_main_td\\\"                                         style=\\\"width:169px; backg"
          "round-color:#EEEEEE; border:1px #ccc solid;\\\">                                        <span class=\\\"wol_ma"
          "in_span\\\" style=\\\"text-align:center; width:100%%;\\\">%s</span></td>';",
          v11);
        printf("HTMLStr += '</tr>';");
        printf("HTMLStr += '</table></div><div                         style=\\\"display:block; width:340px; max-height:186px; height:186px; overflow:auto; overflow-x:hidden; -ms-overflow-x:hidden;\\\">                                        <table class=\\\"wol_main_table\\\" style=\\\"width:340px;\\\">';");
      }
      if ( v7 )
      {
        v12 = "";
        if ( v18 )
          v12 = &v18;
      }
      else
      {
        v12 = "";
      }
      printf(
        "HTMLStr += '<tr class=\\\"wol_main_tr\\\" height=\\\"24\\\" style=\"cursor:pointer;\"                           "
        "     onclick=\\\"SelectMacFromPopup(\\'%s\\', \\'%s\\', \\'%s\\');\\\" \t\t\t\tonmouseover=\\\"ChangeToOverColor"
        "(this);\\\" onmouseout=\\\"ChangeToOutColor(this);\\\">';",
        &v19,
        (char *)v6 + 148,
        v12,
        v16);
      printf(
        "HTMLStr += '<td class=\\\"wol_main_td\\\" style=\\\"border:1px #ccc solid;\\\">                                <"
        "span class=\\\"wol_main_span\\\" style=\\\"margin-left:5px; min-width:163px;\\\">%s</a></td>';",
        (char *)v6 + 148);
      if ( v7 && v18 )
        printf(
          "HTMLStr += '<td class=\\\"wol_main_td\\\" style=\\\"border:1px #ccc solid;\\\">                        \t     "
          "   <span class=\\\"wol_main_span\\\" style=\\\"margin-left:5px; min-width:163px;\\\">%s(%s)</span></td>';",
          (char *)v6 + 128,
          &v18);
      else
        printf(
          "HTMLStr += '<td class=\\\"wol_main_td\\\" style=\\\"border:1px #ccc solid;\\\">                        \t     "
          "   <span class=\\\"wol_main_span\\\" style=\\\"margin-left:5px; min-width:163px;\\\">%s</span></td>';",
          (char *)v6 + 128);
      printf("HTMLStr += '</tr>';");
      ++v3;
    }
    ++v4;
    v6 = (char *)v6 + 188;
  }
  if ( !v3 )
  {
    printf("HTMLStr += '<tr class=\\\"wol_main_tr\\\" height=\\\"24\\\">';");
    v14 = get_ux_text_common(986, v13);
    printf(
      "HTMLStr += '<td class=\\\"wol_main_td\\\" colspan=\\\"2\\\" style=\\\"background-color:#EEEEEE;\\\">              "
      "                  <span class=\\\"wol_main_span\\\">%s</span></td>';",
      v14);
    printf("HTMLStr += '</tr>';");
  }
  free(v5);
  puts("HTMLStr += '</table></div>';");
  puts("obj.innerHTML = HTMLStr;");
  puts("}");
  printf("MakeMacAddrTable();");
  return printf("</script>");
}
// 107B4: using guessed type int __fastcall get_hostinfo_from_arp(_DWORD, _DWORD, _DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 112D0: using guessed type int __fastcall dhcpd_get_dynamic_lease(_DWORD, _DWORD);

//----- (000498C8) --------------------------------------------------------
int __fastcall print_iframe_expertconfwollist(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r0@6
  int v4; // r6@8
  int v5; // r6@14
  int v6; // r0@18
  int v7; // r1@18
  int v8; // r1@18
  int v9; // r0@18
  int v10; // r1@18
  int v11; // r0@18
  void *v12; // r4@18
  int v13; // r1@18
  int v14; // r0@18
  void *v15; // r4@18
  int v16; // r1@18
  int v17; // r0@18
  void *v18; // r1@18
  signed int v19; // r4@18
  char *v20; // r1@21
  const char *v21; // r1@26
  char s; // [sp+8h] [bp-238h]@1
  char v24; // [sp+88h] [bp-1B8h]@6
  _BYTE v25[3]; // [sp+B1h] [bp-18Fh]@6
  char v26; // [sp+C4h] [bp-17Ch]@19
  int v27; // [sp+144h] [bp-FCh]@20
  char v28; // [sp+180h] [bp-C0h]@20
  char v29; // [sp+200h] [bp-40h]@1

  v2 = a2;
  memset(&s, 0, 0xB9u);
  if ( get_value_post(v2, "act", &v29, 32) && !strcmp(&v29, "add") )
  {
    if ( get_remotepc_num(0) <= 99 )
    {
      get_value_post(v2, "pcname", &s, 128);
      if ( check_unpermitted_chars(&s) )
        strcpy(&s, "");
      get_hw_value_post(v2, "hw", &v24);
      get_value_post(v2, "service", v25, 20);
      v3 = add_remotepc_config(&s);
      goto LABEL_12;
    }
  }
  else
  {
    if ( get_value_post(v2, "act", &v29, 32) )
    {
      v4 = strcmp(&v29, "del");
      if ( !v4 )
      {
        while ( 1 )
        {
          v3 = get_value_array_post(v2, "delchk");
          if ( !v3 )
            break;
          ++v4;
          remove_remotepc_config(&v29);
        }
LABEL_12:
        signal_save(v3);
        goto LABEL_18;
      }
    }
    if ( get_value_post(v2, "act", &v29, 32) )
    {
      v5 = strcmp(&v29, "wake");
      if ( !v5 )
      {
        while ( get_value_array_post(v2, "wakeupchk") )
        {
          ++v5;
          send_wol_packet(&v29);
        }
      }
    }
  }
LABEL_18:
  sub_49440();
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"remotepc_wollist\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  v6 = printf("<input type=hidden name=smenu value=expertconfwollist>");
  v7 = get_remotepc_num(v6) > 99;
  printf("<input type=\"hidden\" name=\"nomore\" value=\"%d\">", v7);
  printf("<table class=\"v3_table wol_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"30\"><COL width=\"180\"><COL width=\"290\"><COL width=\"67\"><COL width=\"45\"><COL width=\"30\">");
  printf("<tr height=\"24\" class=\"wol_main_tr\" style=\"background-color:#DBDBDB;\"><td class=\"wol_main_td\">");
  printf("</td><td class=\"wol_main_td\">");
  v9 = get_ux_text_common(591, v8);
  printf("<span class=\"wol_main_span\">%s</span>", v9);
  printf("</td><td class=\"wol_main_td\">");
  v11 = get_ux_text_common(244, v10);
  printf("<span class=\"wol_main_span\">%s</span>", v11);
  printf("</td><td class=\"wol_main_td\">");
  v12 = get_image_dir();
  v14 = get_ux_text_common(245, v13);
  printf(
    "<span class=\"wol_main_span\" style=\"cursor:pointer;\" onclick=\"parent.window.WakeUp();\">\t\t<img src=\"/%s/apsca"
    "n.gif\" class=\"wol_main_span\" style=\"width:10px; height:10px;\">\t\t<span class=\"wol_main_span\">%s</span></span>",
    v12,
    v14);
  printf("</td><td class=\"wol_main_td\">");
  v15 = get_image_dir();
  v17 = get_ux_text_common(143, v16);
  v18 = v15;
  v19 = 0;
  printf(
    "<span class=\"wol_main_span\" style=\"cursor:pointer;\" onclick=\"parent.window.DeleteRemotePC();\">\t\t<img src=\"/"
    "%s/minus_icon.gif\" class=\"wol_main_span\" style=\"width:10px; height:10px;\">\t\t<span class=\"wol_main_span\">%s</span></span>",
    v18,
    v17);
  printf("</td><td class=\"wol_main_td\">");
  printf("</td></tr>");
  do
  {
    if ( !get_remotepc_config(v19, &v26) )
      break;
    sf_strncpy(&v28, &v27, 128);
    convert_mac(&v28);
    v20 = v19++ & 1 ? "F7F7F7" : "FFFFFF";
    printf("<tr height=\"24\" class=\"wol_main_tr\" style=\"background-color:#%s;\"><td class=\"wol_main_td\">", v20);
    printf("<p class=\"wol_main_p\">%d</p>", v19);
    printf("</td><td class=\"wol_main_td\">");
    printf("<span class=\"wol_main_span\">%s</span>", &v28);
    printf("</td><td class=\"wol_main_td\">");
    printf("<span class=\"wol_main_span\">%s</span>", &v26);
    printf("</td><td class=\"wol_main_td\">");
    printf("<span class=\"wol_main_span\">\t\t\t<input type=\"checkbox\" name=\"wakeupchk\" value=\"%s\"></span>", &v27);
    printf("</td><td class=\"wol_main_td\">");
    printf("<span class=\"wol_main_span\">\t\t\t<input type=\"checkbox\" name=\"delchk\" value=\"%s\"></span>", &v27);
    printf("</td><td class=\"wol_main_td\">");
    printf("</td></tr>");
  }
  while ( v19 != 100 );
  while ( v19 <= 14 )
  {
    if ( v19 & 1 )
      v21 = "F7F7F7";
    else
      v21 = "FFFFFF";
    ++v19;
    printf(
      "<tr height=\"24\" class=\"wol_main_tr\" style=\"background-color:#%s;\"><td class=\"wol_main_td\" colspan=\"7\">",
      v21);
    printf("</td></tr>");
  }
  printf("</table>");
  printf("</form>");
  printf("</BODY>");
  return printf("<script>setTimeout(function(){UnMaskIt(parent.document,'apply_mask');}, 1000);</script>");
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);
// 10E44: using guessed type int __fastcall add_remotepc_config(_DWORD);
// 11000: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11654: using guessed type int __fastcall send_wol_packet(_DWORD);
// 11858: using guessed type int __fastcall get_hw_value_post(_DWORD, _DWORD, _DWORD);
// 11A50: using guessed type int __fastcall remove_remotepc_config(_DWORD);
// 11A8C: using guessed type int __fastcall get_value_array_post(_DWORD, _DWORD);
// 11B58: using guessed type int __fastcall get_remotepc_config(_DWORD, _DWORD);
// 12044: using guessed type int __fastcall get_remotepc_num(_DWORD);

//----- (00049D08) --------------------------------------------------------
int sub_49D08()
{
  int v0; // r1@1
  int v1; // r0@1
  char *v2; // r0@1
  void *v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  void *v8; // r4@1
  int v9; // r1@1
  int v10; // r0@1
  int v11; // r1@1
  const char *v12; // r0@1
  int v13; // r0@1
  int v14; // r0@2
  int v15; // r0@4
  int v16; // r0@5
  char v18; // [sp+4h] [bp-1Ch]@1

  printf("<table class=\"v3_table wol_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<form method=post action=timepro.cgi name=remotepc_fm style=\"margin:0; padding:0;\">");
  printf("<input type=hidden name=tmenu value=expertconf>");
  printf("<input type=hidden name=smenu value=remotepc>");
  printf("<input type=hidden name=act value=>");
  printf("<input type=hidden name=ocolor value=>");
  printf("<COL width=\"100\"><COL width=\"250\"><COL width=\"262\"><COL width=\"30\">");
  printf("<tr class=\"wol_main_tr\" height=\"5\"><td class=\"wol_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  printf("<tr class=\"wol_main_tr\" height=\"24\"><td class=\"wol_main_td\">");
  v1 = get_ux_text_common(591, v0);
  printf("<p class=\"wol_main_p\">%s</p>", v1);
  printf("</td><td class=\"wol_main_td\">");
  v2 = getenv("REMOTE_ADDR");
  get_internal_pc_hardware_address(v2, &v18);
  print_hwadress_inputbox((int)"hw", 0, 0);
  v3 = get_image_dir();
  printf(
    "<button type=\"button\" class=\"wol_main_button\" name=\"hw_search\" style=\"margin-left:5px;\" onclick=\"onclick_ma"
    "csearchbtn('hw')\">                <img src=\"/%s/fw_search.gif\" style=\"width:16px; height:16px; padding:0; margin:0;\"></button>",
    v3);
  printf("</td><td class=\"wol_main_td\">");
  printf(
    "<input type=checkbox class=navi_chk id=curpcmacchk onclick=\"SetHWOnCheckNoDisable(this,'hw','%s');\"> ",
    &v18);
  v5 = get_ux_text_common(383, v4);
  printf("<label for=\"curpcmacchk\">%s</label>", v5);
  printf("</td><td class=\"wol_main_td\">");
  printf("</td></tr>");
  printf("<tr class=\"wol_main_tr\" height=\"24\"><td class=\"wol_main_td\">");
  v7 = get_ux_text_common(244, v6);
  printf("<p class=\"wol_main_p\">%s</p>", v7);
  printf("</td><td class=\"wol_main_td\">");
  printf("<input type=text name=\"pcname\" maxlength=24 size=24 style=\"width:165px;\" value=>");
  printf("</td><td class=\"wol_main_td\" colspan=\"2\">");
  printf("</td></tr>");
  printf("<tr class=\"wol_main_tr\" height=\"5\"><td class=\"wol_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  printf("<tr class=\"wol_main_tr\" height=\"5\" style=\"border-top:1px #CCC solid;\"><td class=\"wol_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  printf("<tr class=\"wol_main_tr\" height=\"24\"><td class=\"wol_main_td\">");
  v8 = get_image_dir();
  v10 = get_ux_text_common(6, v9);
  printf(
    "<button type=\"button\" class=\"wol_main_button\" style=\"width:55px; margin-left:5px;\" onclick=\"AddPC(); return C"
    "lickEventPropagater(event);\">\t\t<span class=\"wol_main_span\"><img src=\"/%s/plus_icon.gif\" style=\"padding-right"
    ":4px;\">%s</span></button>",
    v8,
    v10);
  printf("</td><td class=\"wol_main_td\">");
  printf("</td><td class=\"wol_main_td\" align=\"right\">");
  printf("<span class=\"wol_main_span\"><font color=\"gray\">");
  v12 = (const char *)get_ux_text_common(603, v11);
  printf(v12, 100);
  printf("</font></span>");
  printf("</td><td class=\"wol_main_td\">");
  printf("</td></tr>");
  printf("<tr class=\"wol_main_tr\" height=\"5\" style=\"border-bottom:1px #CCC solid;\"><td class=\"wol_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  v13 = printf("<tr class=\"wol_main_tr\" style=\"border-bottom:1px #CCC solid;\"><td class=\"wol_main_td\" colspan=\"4\">");
  if ( is_mobile_agent(v13) )
  {
    print_div_m_str((int)"384", (int)"100%%", (int)"display:inline-block; *display:inline; zoom:1;");
    v14 = printf("<iframe name=\"wollist_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=expertconfwollist\"                         frameborder=no width=100%% height=384 align=center scrolling=yes></iframe>");
    print_div_m_etr(v14);
  }
  else
  {
    printf("<iframe name=\"wollist_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=expertconfwollist\"                         frameborder=no width=100%% height=384 align=center scrolling=yes></iframe>");
  }
  v15 = printf("</td></tr>");
  if ( is_mobile_agent(v15) )
  {
    print_div_m_str((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v16 = printf("<iframe name=\"hiddenmacsearch_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=expertconfmacsearch\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    print_div_m_etr(v16);
  }
  else
  {
    printf("<iframe name=\"hiddenmacsearch_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=expertconfmacsearch\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  puts("</form>");
  printf("</table>");
  printf("<script>");
  printf("init_wolmain();");
  return printf("</script>");
}
// 108F8: using guessed type int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD);
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (00049FF8) --------------------------------------------------------
int experconf_remotepc()
{
  void *v0; // r0@1

  print_js_file((int)"expertconf", (int)"remotepc");
  sub_49440();
  sub_49D08();
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v0 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v0);
  printf("</SPAN></td>");
  printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"wol_div_msg\">\n");
  printf("</SPAN></td>");
  printf((const char *)&unk_7D215);
  printf("<DIV id=\"%s\" style=\"display:none;\">", "macsearch_mask");
  printf(
    "<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff; "
    "                opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\" "
    "                onclick=\"UnMaskIt(document,'%s');\">\n",
    "macsearch_mask");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:151px; top:128px; width:340px; height:210px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888; overflow:hidden;\" id=\"searchmaclist\">");
  return printf((const char *)&unk_7D222);
}

//----- (0004A108) --------------------------------------------------------
void *__fastcall sub_4A108(const char *a1, int a2)
{
  const char *v2; // r4@1
  int v3; // r0@3
  int v4; // r0@37

  v2 = a1;
  if ( !*a1 )
    goto LABEL_36;
  if ( strcmp(a1, "SUCCESS") )
  {
    if ( !strcmp(v2, "CONN_FAIL") )
    {
      v3 = 185;
      goto LABEL_37;
    }
    if ( !strcmp(v2, "BLOCKED") )
    {
      v3 = 184;
      goto LABEL_37;
    }
    if ( !strcmp(v2, "BAD_AUTH") )
    {
      v3 = 183;
      goto LABEL_37;
    }
    if ( !strcmp(v2, "PARAMETER_INVALID") )
    {
      v3 = 193;
      goto LABEL_37;
    }
    if ( !strcmp(v2, "DOMAIN_NOT_SUPPORTED") )
    {
      v3 = 188;
      goto LABEL_37;
    }
    if ( !strcmp(v2, "HOSTNAME_NOT_EXIST") )
    {
      v3 = 190;
      goto LABEL_37;
    }
    if ( !strcmp(v2, "USER_IS_NOT_A_DONATOR") )
    {
      v3 = 199;
      goto LABEL_37;
    }
    if ( !strcmp(v2, "NOT_YOURS") )
    {
      v3 = 191;
      goto LABEL_37;
    }
    if ( !strcmp(v2, "CUSTOM_DNS_NOT_ACT") )
    {
      v3 = 186;
      goto LABEL_37;
    }
    if ( !strcmp(v2, "HOSTNAME_IS_BLOCKED_BY_ABUSE") )
    {
      v3 = 189;
      goto LABEL_37;
    }
    if ( !strcmp(v2, "TOO_MANY_OR_FEW") )
    {
      v3 = 196;
      goto LABEL_37;
    }
    if ( !strcmp(v2, "DDNS_ERROR") )
    {
      v3 = 187;
      goto LABEL_37;
    }
    if ( !strcmp(v2, "SERVER_SHUTDOWN") )
    {
      v3 = 194;
      goto LABEL_37;
    }
    if ( !strcmp(v2, "ONLY_ONE_DOMAIN") )
    {
      v3 = 192;
      goto LABEL_37;
    }
    if ( !strcmp(v2, (const char *)&unk_AC7D8) )
    {
      v3 = 198;
      goto LABEL_37;
    }
    if ( !strcmp(v2, "FORGET_MYINFO") )
    {
      v3 = 202;
      goto LABEL_37;
    }
LABEL_36:
    v3 = 197;
    goto LABEL_37;
  }
  v3 = 195;
LABEL_37:
  v4 = get_ux_text_common(v3, a2);
  sf_strncpy(&unk_CA61C, v4, 64);
  return &unk_CA61C;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);

//----- (0004A318) --------------------------------------------------------
int __fastcall sub_4A318(int a1, int a2, int a3)
{
  int v3; // r4@1
  int v4; // r5@1
  int v5; // r6@1
  int v6; // r0@2
  char *v7; // r1@2
  time_t v8; // r0@3

  v3 = a2;
  v4 = a1;
  v5 = a3;
  if ( !strcmp((const char *)(a1 + 28), "SUCCESS") )
  {
    v8 = *(_DWORD *)(v4 + 20);
    if ( v5 )
      v8 += 1440000;
    v7 = (char *)getNowDayMonth(v8, 2);
    v6 = v3;
  }
  else
  {
    v6 = v3;
    v7 = "-";
  }
  return sf_strncpy(v6, v7, 128);
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);

//----- (0004A37C) --------------------------------------------------------
int sub_4A37C()
{
  int v0; // r4@1
  int v1; // r0@4
  char *v2; // r1@5
  int v3; // r1@9
  int v4; // r0@9
  int v5; // r1@9
  int v6; // r0@9
  int v7; // r1@9
  int v8; // r0@9
  int v9; // r0@9
  int v10; // r1@9
  const char *v11; // r0@10
  int v12; // r0@11
  int v13; // r1@11
  int v14; // r0@11
  int v15; // r1@11
  int v16; // r0@11
  int v17; // r0@12
  int v18; // r1@13
  int v19; // r0@13
  void *v20; // r5@14
  int v21; // r1@14
  int v22; // r0@14
  int v23; // r1@14
  int v24; // r5@14
  int v25; // r1@14
  int v26; // r0@14
  int v27; // r1@14
  int v28; // r0@14
  int v29; // r1@14
  int v30; // r0@14
  char *v31; // r1@15
  int v32; // r1@19
  char *v33; // r1@20
  int v34; // r1@22
  int v35; // r0@22
  char *v36; // r1@23
  int v37; // r1@27
  int v38; // r0@27
  char *v39; // r1@28
  int v40; // r1@32
  int v41; // r0@32
  char *v42; // r1@33
  int v43; // r1@35
  int v44; // r0@35
  char *v45; // r1@36
  char *v46; // r6@39
  void *v47; // r5@42
  int v48; // r1@42
  int v49; // r0@42
  void *v50; // r5@42
  int v51; // r1@42
  int v52; // r0@42
  int v53; // r0@42
  int v54; // r0@43
  int v55; // r0@43
  int v56; // r0@46
  void *v57; // r0@48
  int v59; // [sp+4h] [bp-64Ch]@1
  char v60; // [sp+10h] [bp-640h]@5
  int v61; // [sp+28h] [bp-628h]@2
  char v62; // [sp+420h] [bp-230h]@23
  int v63; // [sp+504h] [bp-14Ch]@34
  char v64; // [sp+580h] [bp-D0h]@28
  int v65; // [sp+584h] [bp-CCh]@1
  char s1; // [sp+5A0h] [bp-B0h]@3
  char v67; // [sp+5E0h] [bp-70h]@13
  char v68; // [sp+620h] [bp-30h]@13

  memset(&v65, 0, 0x5Cu);
  memset(&v59, 0, 0x500u);
  v0 = ddnsapi_read_config_by_service_type(0, "iptime", &v59);
  if ( v0 )
  {
    ddnsapi_get_status(&v61, &v65);
    if ( ddnsapi_get_refresh_flag(&v61) )
      sf_strncpy(&s1, "", 64);
  }
  printf("<table class=\"v3_table ddns_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<tr class=\"ddns_main_tr\"><td class=\"ddns_main_td\">");
  puts("<form method=post action=timepro.cgi name=dyndns_conf style=\"margin:0; padding:0;\">");
  puts("<input type=hidden name=tmenu value=expertconf>");
  puts("<input type=hidden name=smenu value=ddns>");
  puts("<input type=hidden name=act value=>");
  v1 = ddnsapi_get_host_count("iptime");
  printf("<input type=hidden name=iptimecnt value=%d>\n", v1);
  if ( v0 )
    v2 = &v60;
  else
    v2 = "";
  if ( v0 )
    v2 += 24;
  printf("<input type=\"hidden\" name=\"refhostname\" value=\"%s\">", v2);
  printf("<table class=\"v3_table ddns_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"321\"><COL width=\"321\">");
  printf("<tr class=\"ddns_main_tr\" height=\"96\"><td class=\"ddns_main_td\">");
  printf("<table class=\"v3_table ddns_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"100\"><COL width=\"145\"><COL width=\"76\">");
  printf("<tr class=\"ddns_main_tr\" height=\"24\"><td class=\"ddns_main_td\">");
  printf("<p class=\"ddns_main_p\">");
  v4 = get_ux_text_common(212, v3);
  printf("%s", v4);
  printf("</p>");
  printf("</td>");
  printf("<td class=\"ddns_main_td\">");
  printf("<input type=\"hidden\" name=\"select_ddns\" value=\"iptime_null\">");
  printf("<input type=\"text\" value=\"ipTIME DDNS\" style=\"width:140px;\" disabled>");
  printf("</td>");
  printf("<td class=\"ddns_main_td\">");
  printf("</td>");
  printf("</tr>");
  printf("<tr class=\"ddns_main_tr\" height=\"24\"><td class=\"ddns_main_td\">");
  printf("<p class=\"ddns_main_p\">");
  v6 = get_ux_text_common(204, v5);
  printf("%s", v6);
  printf("</p>");
  printf("</td>");
  printf("<td class=\"ddns_main_td\">");
  printf("<input type=\"text\" name=\"hostname\" size=\"32\" maxlength=\"50\" style=\"width:140px; ime-mode:disabled;\">");
  printf("</td>");
  printf("<td class=\"ddns_main_td\">");
  printf("<span class=\"ddns_main_span\">.iptime.org</span>");
  printf("</td>");
  printf("</tr>");
  printf("<tr class=\"ddns_main_tr\" height=\"24\"><td class=\"ddns_main_td\">");
  printf("<p class=\"ddns_main_p\">");
  v8 = get_ux_text_common(139, v7);
  printf("%s", v8);
  printf("</p>");
  printf("</td>");
  printf("<td class=\"ddns_main_td\">");
  printf("<input type=\"text\" name=\"userid\" size=\"20\" maxlength=\"32\" style=\"width:140px; ime-mode:disabled;\">");
  printf("</td>");
  printf("<td class=\"ddns_main_td\">");
  printf("</td>");
  v9 = printf("</tr>");
  if ( check_valid_account(v9) )
  {
    v11 = "<tr class=\"ddns_main_tr\" height=\"24\"><td class=\"ddns_main_td\" colspan=\"2\"></td></tr>";
  }
  else
  {
    v12 = get_ux_text_common(207, v10);
    printf("<input type=hidden name=default_captcha_desc value='%s'>\n", v12);
    puts("<input type=hidden name=captcha_file value=>");
    v14 = get_ux_text_common(237, v13);
    printf(
      "<tr class=\"ddns_main_tr\" height=\"24\"><td class=\"ddns_main_td\"><p class=\"ddns_main_p\">%s</p></td>",
      v14);
    printf("<td class=\"ddns_main_td\" colspan=\"2\">");
    v16 = get_ux_text_common(207, v15);
    printf(
      "<input type=text name=captcha_code maxlength=\"5\" STYLE=\"width:205px; height:21px; color:#888888;\" value=\"%s\""
      "                         onfocus=\"FocusCaptcha(document.dyndns_conf);\" onblur=\"BlurCaptcha(document.dyndns_conf);\">",
      v16);
    v11 = "</td></tr>";
  }
  printf(v11);
  printf("</table>");
  v17 = printf("</td><td class=\"ddns_main_td\">");
  if ( !check_valid_account(v17) )
  {
    get_http_auth_method(&v67);
    get_ux_lang((int)&v68);
    puts("<table class=\"v3_table ddns_main_table\" width=\"321\" height=\"96\">");
    printf("<COL width=\"291\"><COL width=\"30\">");
    printf("<tr class=\"ddns_main_tr\"><td class=\"ddns_main_td\">");
    puts("<table class=\"v3_table ddns_main_table\" width=\"254\" height=\"96\">");
    printf("<COL width=\"90\"><COL width=\"201\">");
    printf((const char *)&unk_ACDA3);
    v19 = get_ux_text_common(237, v18);
    printf("<p class=\"ddns_main_p\">%s</p>", v19);
    printf("</td></tr>");
    printf(
      "<tr class=\"ddns_main_tr\"                         style=\"font: normal normal normal 12px arial; color:#000000; b"
      "order:#C6C9CC 1px solid; background-color:#FFFFFF;\" height=\"72\">                        <td class=\"ddns_main_t"
      "d\" style=\"cursor:pointer; background-color:#FAFAFA; border:0;\"                         onclick=\"iframe_captcha"
      ".location.reload();\">                        <img src=\"/images2/captcha_noborder.%s.gif\" style=\"border:0; marg"
      "in-left:18px;\"></td>\n",
      &v68);
    strcmp(&v67, "session");
    printf("<td class=\"ddns_main_td\" style=\"border-left:1px #CCC solid;\">                        <iframe name=iframe_captcha id=iframe_captcha src=\"/%s/captcha.cgi\" width=\"200\" height=\"72\"                         frameborder=no scrolling=no></iframe>                        </td></tr>\n");
    printf("</table>");
    printf("</td><td class=\"ddns_main_td\"></td></tr></table>");
  }
  printf("</td>");
  printf("</tr>");
  printf("<tr class=\"ddns_main_tr\" height=\"10\" style=\"border-bottom:1px #ccc solid;\"><td class=\"ddns_main_td\" colspan=\"2\"></td></tr>");
  printf("<tr class=\"ddns_main_tr\"><td class=\"ddns_main_td\" colspan=\"2\">");
  printf("<table class=\"v3_table ddns_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"100\"><COL width=\"512\"><COL width=\"30\">");
  printf("<tr class=\"ddns_main_tr\" height=\"48\"><td class=\"ddns_main_td\">");
  v20 = get_image_dir();
  v22 = get_ux_text_common(236, v21);
  printf((const char *)&unk_AD262, v20, v22);
  printf("</td><td class=\"ddns_main_td\" align=\"right\">");
  v24 = get_ux_text_common(220, v23);
  v26 = get_ux_text_common(221, v25);
  printf(
    "<p style=\"display:block; padding:0; margin:0;\"><font color=\"gray\">%s</font></p>\t\t<p style=\"display:block; pad"
    "ding:0; margin:0;\"><font color=\"gray\">%s</font></p>",
    v24,
    v26);
  printf("</td><td class=\"ddns_main_td\"></td></tr>");
  printf("</table");
  printf("</td></tr>");
  printf("<tr class=\"ddns_main_tr\"><td class=\"ddns_main_td\" colspan=\"2\">");
  printf("<table class=\"v3_table ddns_main_table\" id=\"STATTABLE\" style=\"%s\">");
  printf("<COL width=\"190\"><COL width=\"272\"><COL width=\"180\">");
  printf("<tr height=\"24\" class=\"ddns_main_tr\"><td class=\"ddns_main_td\">");
  v28 = get_ux_text_common(204, v27);
  printf("<p class=\"ddns_main_p\">%s</p>", v28);
  printf("</td><td class=\"ddns_main_td\" colspan=\"2\">");
  v30 = get_ux_text_common(200, v29);
  printf("<span class=\"ddns_main_span\">%s</span>", v30);
  printf("</td></tr>");
  printf("<tr height=\"24\" class=\"ddns_main_tr\" style=\"background-color:#FFFFFF;\"><td class=\"ddns_main_td\">");
  if ( v0 )
    v31 = &v60;
  else
    v31 = "";
  if ( v0 )
    v31 += 24;
  printf("<p class=\"ddns_main_p\" id=\"HOSTNAMEVAL\">%s</p>", v31);
  printf("</td><td class=\"ddns_main_td\" colspan=\"2\">");
  if ( v0 )
    v33 = (char *)sub_4A108(&s1, v32);
  else
    v33 = "";
  printf("<span class=\"ddns_main_span\" id=\"CONNSTATUSVAL\">%s</span>", v33);
  printf("</td></tr>");
  printf("<tr height=\"24\" class=\"ddns_main_tr\" style=\"border-top:1px #ccc solid;\"><td class=\"ddns_main_td\">");
  v35 = get_ux_text_common(139, v34);
  printf("<p class=\"ddns_main_p\">%s</p>", v35);
  printf("</td><td class=\"ddns_main_td\" colspan=\"2\">");
  if ( v0 )
    v36 = &v62;
  else
    v36 = "";
  if ( v0 )
    v36 += 8;
  printf("<span class=\"ddns_main_span\" id=\"IDVAL\">%s</span>", v36);
  printf("</td></tr>");
  printf("<tr height=\"24\" class=\"ddns_main_tr\"><td class=\"ddns_main_td\">");
  v38 = get_ux_text_common(241, v37);
  printf("<p class=\"ddns_main_p\">%s</p>", v38);
  printf("</td><td class=\"ddns_main_td\" colspan=\"2\">");
  if ( v0 )
    v39 = &v64;
  else
    v39 = "";
  if ( v0 )
    v39 += 8;
  printf("<span class=\"ddns_main_span\" id=\"IPADDRVAL\">%s</span>", v39);
  printf("</td></tr>");
  printf("<tr height=\"24\" class=\"ddns_main_tr\"><td class=\"ddns_main_td\">");
  v41 = get_ux_text_common(242, v40);
  printf("<p class=\"ddns_main_p\">%s</p>", v41);
  printf("</td><td class=\"ddns_main_td\" colspan=\"2\">");
  if ( v0 )
  {
    sub_4A318((int)&v65, (int)&v63, 0);
    v42 = (char *)&v63;
  }
  else
  {
    v42 = "";
  }
  printf("<span class=\"ddns_main_span\" id=\"LASTVAL\">%s</span>", v42);
  printf("</td></tr>");
  printf("<tr height=\"24\" class=\"ddns_main_tr\" style=\"border-bottom:1px #ccc solid;\"><td class=\"ddns_main_td\">");
  v44 = get_ux_text_common(243, v43);
  printf("<p class=\"ddns_main_p\">%s</p>", v44);
  printf("</td><td class=\"ddns_main_td\">");
  if ( v0 )
  {
    sub_4A318((int)&v65, (int)&v63, 1);
    v45 = (char *)&v63;
  }
  else
  {
    v45 = "";
  }
  printf("<span class=\"ddns_main_span\" id=\"NEXTVAL\">%s</span>", v45);
  printf("</td><td class=\"ddns_main_td\" align=\"right\">");
  if ( v0 )
  {
    v46 = "";
    if ( strcmp(&s1, "SUCCESS") )
      v46 = "display:none;";
  }
  else
  {
    v46 = "display:none;";
  }
  v47 = get_image_dir();
  v49 = get_ux_text_common(1359, v48);
  printf(
    "<button class=\"ddns_main_button\" style=\"margin-right:10px; width:60px; %s\" id=\"ref_bt\" onclick=\"RefreshHost()"
    "; return ClickEventPropagater(event);\">\t\t<img src=\"/%s/apscan.gif\" style=\"width:8px; height:8px;\" class=\"ddn"
    "s_main_span\">\t\t<span class=\"ddns_main_span\">%s</span></button>",
    v46,
    v47,
    v49);
  v50 = get_image_dir();
  v52 = get_ux_text_common(143, v51);
  printf(
    "<button class=\"ddns_main_button\" style=\"margin-right:30px; width:60px;\" id=\"del_bt\" onclick=\"DelHost(); retur"
    "n ClickEventPropagater(event);\">\t\t<img src=\"/%s/minus_icon.gif\" style=\"width:8px; height:8px;\" class=\"ddns_m"
    "ain_span\">\t\t<span class=\"ddns_main_span\">%s</span></button>",
    v50,
    v52);
  printf("</td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("</table>");
  printf("</form>");
  printf("</td></tr>");
  v53 = printf("</table>");
  if ( is_mobile_agent(v53) )
  {
    print_div_m_str((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v54 = printf("<iframe name=\"hiddenddnsstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenddnsstatus\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    v55 = print_div_m_etr(v54);
  }
  else
  {
    v55 = printf("<iframe name=\"hiddenddnsstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenddnsstatus\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  if ( is_mobile_agent(v55) )
  {
    print_div_m_str((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v56 = printf("<iframe name=\"hiddenddnssetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenddnssetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    print_div_m_etr(v56);
  }
  else
  {
    printf("<iframe name=\"hiddenddnssetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenddnssetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  printf("<script> InitDDNS();</script>");
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v57 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v57);
  printf("</SPAN></td>");
  printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"ddns_div_msg\">\n");
  printf("</SPAN></td>");
  printf((const char *)&unk_7D215);
  printf("<DIV id=\"setup_mask\" style=\"%s\">");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:154px; z-index:1; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  return printf((const char *)&unk_7D222);
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10730: using guessed type int __fastcall ddnsapi_get_refresh_flag(_DWORD);
// 1076C: using guessed type int __fastcall get_http_auth_method(_DWORD);
// 10DCC: using guessed type int __fastcall check_valid_account(_DWORD);
// 11588: using guessed type int __fastcall ddnsapi_get_host_count(_DWORD);
// 11714: using guessed type int __fastcall ddnsapi_read_config_by_service_type(_DWORD, _DWORD, _DWORD);
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);
// 11B28: using guessed type int __fastcall ddnsapi_get_status(_DWORD, _DWORD);

//----- (0004ACA4) --------------------------------------------------------
_BOOL4 __fastcall check_ddns_burst(int a1)
{
  char v2; // [sp+4h] [bp-64h]@1
  int v3; // [sp+18h] [bp-50h]@1

  ddnsapi_get_status(a1, &v2);
  return time(0) - v3 <= 2;
}
// 11B28: using guessed type int __fastcall ddnsapi_get_status(_DWORD, _DWORD);

//----- (0004ACD8) --------------------------------------------------------
signed int __fastcall sub_4ACD8(int a1)
{
  int v1; // r4@1
  int v2; // r7@2
  void *v3; // r0@4
  int v4; // r0@7
  char *v5; // r1@10
  char *v6; // r0@12
  char *v7; // r5@12
  int v8; // r0@21
  int v9; // r1@24
  int v10; // r0@30
  int v11; // r4@32
  signed int v12; // r4@33
  int v13; // r5@37
  int *v14; // r7@40
  char *i; // r5@40
  int v16; // r3@41
  int v17; // r1@41
  int v18; // r2@42
  unsigned int v19; // r2@48
  unsigned int v20; // r3@48
  unsigned int v21; // r12@48
  int v22; // r6@54
  char *v23; // r5@55
  int v24; // r4@55
  char *v25; // r0@56
  int v26; // t1@56
  int v27; // r0@60
  int v28; // r6@61
  int v30; // [sp+4h] [bp-1594h]@0
  char s; // [sp+8h] [bp-1590h]@24
  char v32; // [sp+2Ch] [bp-156Ch]@24
  int v33; // [sp+42Ch] [bp-116Ch]@40
  int v34; // [sp+508h] [bp-1090h]@4
  int v35; // [sp+50Ch] [bp-108Ch]@11
  int v36; // [sp+52Ch] [bp-106Ch]@6
  int v37; // [sp+92Ch] [bp-C6Ch]@6
  int v38; // [sp+96Ch] [bp-C2Ch]@19
  int v39; // [sp+9ACh] [bp-BECh]@14
  int v40; // [sp+9ECh] [bp-BACh]@10
  char v41; // [sp+A07h] [bp-B91h]@55
  int v42; // [sp+A08h] [bp-B90h]@10
  int v43; // [sp+E08h] [bp-790h]@56
  int v44; // [sp+1208h] [bp-390h]@40
  int v45; // [sp+1408h] [bp-190h]@40
  int v46; // [sp+1488h] [bp-110h]@23
  int v47; // [sp+1508h] [bp-90h]@40
  int v48; // [sp+1528h] [bp-70h]@1
  int v49; // [sp+1548h] [bp-50h]@32
  unsigned __int8 v50; // [sp+155Ch] [bp-3Ch]@32
  unsigned __int8 v51; // [sp+1570h] [bp-28h]@26

  v1 = a1;
  if ( !get_value_post(a1, "act", &v48, 32) )
    return -1;
  if ( strcmp((const char *)&v48, "addhost") )
  {
    if ( strcmp((const char *)&v48, "delhost") )
    {
      v4 = strcmp((const char *)&v48, "refreshhost");
      v28 = v4;
      if ( !v4 )
      {
        v2 = get_value_post(v1, &unk_ADD97, &v46, 128);
        if ( !v2 )
          return v2;
        if ( check_ddns_burst((int)&v46) )
          return v28;
        v4 = ddnsapi_set_refresh_flag(&v46, 1);
      }
      goto LABEL_66;
    }
    v2 = get_value_post(v1, &unk_ADD97, &v46, 128);
    if ( !v2 )
      return v2;
    memset(&s, 0, 0x500u);
    ddnsapi_read_config_by_service_type(0, "iptime", &s);
    if ( strcmp((const char *)&v46, &v32) || !check_ddns_hostname(&v32) )
    {
LABEL_60:
      v27 = get_ux_text_common(201, v9);
      printf("alert('%s');\n", v27);
      goto LABEL_67;
    }
    get_wan_hw_ifname("wan1", &v42);
    get_wan_type("wan1", &v51);
    if ( !strcmp((const char *)&v51, "pppoe") || !strcmp((const char *)&v51, "pptp") )
    {
      if ( get_idle_timeout(&v42) || !get_wansetup_status("wan1") || (v10 = get_pppoe_status("wan1")) == 0 )
      {
        v12 = 1;
LABEL_37:
        v13 = get_wan_link("wan1");
        if ( (get_usb_tethering_status(v13) || v13) && !v12 )
        {
          get_random_str(&v47, 32);
          v14 = &v44;
          snprintf((char *)&v44, 0x200u, (const char *)&unk_ADDA3, &v33);
          for ( i = (char *)&v45; ; i += 4 )
          {
            v22 = *(_BYTE *)v14;
            if ( !*(_BYTE *)v14 )
              break;
            v16 = 0;
            v17 = 0;
            do
            {
              v18 = *(_BYTE *)v14;
              if ( *(_BYTE *)v14 )
              {
                *(&v51 + v16) = v18;
                ++v17;
              }
              else
              {
                *(&v51 + v16) = v18;
              }
              ++v16;
              if ( v18 )
                v14 = (int *)((char *)v14 + 1);
            }
            while ( v16 != 3 );
            v19 = (unsigned int)v51 >> 2;
            v20 = ((unsigned int)*(&v51 + 1) >> 4) | 16 * (v51 & 3);
            v21 = ((unsigned int)*(&v51 + 2) >> 6) | 4 * (*(&v51 + 1) & 0xF);
            if ( v17 == 1 )
            {
              sprintf(i, "%c%c==", (unsigned __int8)aAbcdefghijklmn[v19], (unsigned __int8)aAbcdefghijklmn[v20]);
            }
            else if ( v17 == 2 )
            {
              sprintf(
                i,
                "%c%c%c=",
                (unsigned __int8)aAbcdefghijklmn[v19],
                (unsigned __int8)aAbcdefghijklmn[v20],
                (unsigned __int8)aAbcdefghijklmn[v21],
                v30);
            }
            else
            {
              sprintf(
                i,
                "%c%c%c%c",
                (unsigned __int8)aAbcdefghijklmn[v19],
                (unsigned __int8)aAbcdefghijklmn[v20],
                (unsigned __int8)aAbcdefghijklmn[v21],
                (unsigned __int8)aAbcdefghijklmn[*(&v51 + 2) & 0x3F]);
            }
          }
          *i = v22;
          v23 = &v41;
          snprintf((char *)&v44, 0x200u, "rv=%s&domain=%s&userinfo=%s", &v47, &v32, &v45);
          memset(&v42, v22, 0x400u);
          strlen((const char *)&v44);
          v24 = 2 * encode_crypt(&v44, &v42, 10, v22);
          while ( v22 < v24 )
          {
            v25 = (char *)&v43 + v22;
            v22 += 2;
            v26 = (unsigned __int8)(v23++)[1];
            sprintf(v25, "%02x", v26);
          }
          snprintf(
            (char *)&v34,
            0x400u,
            "/usr/bin/wget 'http://members.iptime.org/ipcloud/iptimeddns_unregister.php?action=delete&content=%s' -q -O %s",
            &v43,
            &unk_ADE54);
          system((const char *)&v34);
          v8 = ddnsapi_remove_host(&v32);
          goto LABEL_59;
        }
        goto LABEL_60;
      }
      if ( v10 != 4 )
      {
        v12 = v10 == 6;
        goto LABEL_37;
      }
      get_ifconfig((int)"ppp1", (int)&v50, (int)&v49);
      v11 = v50;
    }
    else
    {
      get_ifconfig((int)&v42, (int)&v50, (int)&v49);
      v11 = v50;
    }
    v12 = v11 == 0;
    goto LABEL_37;
  }
  v3 = memset(&v34, 0, 0x500u);
  if ( !check_valid_account(v3) )
  {
    v2 = check_captcha_post(v1);
    if ( !v2 )
    {
      get_value_post(v1, "hostname", &v36, 1024);
      get_value_post(v1, "userid", &v37, 64);
      printf("if(parent.window.resetInputForm)parent.window.resetInputForm('%s','%s');\n", &v36, &v37);
      return v2;
    }
  }
  v4 = get_value_post(v1, "hostname", &v36, 1024);
  if ( !v4 )
    goto LABEL_66;
  v2 = check_ddns_hostname((const char *)&v36);
  if ( !v2 )
    return v2;
  if ( check_ddns_burst((int)&v36) )
    goto LABEL_67;
  get_value_post(v1, &unk_ADD83, &v42, 128);
  strcpy((char *)&v40, "wan1");
  v5 = strtok((char *)&v42, "_");
  if ( v5 )
    sf_strncpy(&v35, v5, 32);
  v6 = strtok(0, "");
  v7 = v6;
  if ( v6 && strcmp(v6, "null") )
    sf_strncpy(&v39, v7, 64);
  v2 = strcmp((const char *)&v35, "iptime");
  if ( !v2 && get_iptimeddns_service_config(0) )
    return v2;
  get_value_post(v1, "userid", &v37, 64);
  if ( !check_unpermitted_chars(&v37) )
  {
    if ( !strcmp((const char *)&v35, "iptime") )
      strcpy((char *)&v38, "iptime");
    else
      get_value_post(v1, "passwd", &v38, 64);
    v8 = ddnsapi_add_config(&v34);
LABEL_59:
    v4 = signal_save(v8);
LABEL_66:
    signal_update(v4);
    sleep(3u);
  }
LABEL_67:
  v2 = 0;
  return v2;
}
// 1055C: using guessed type int __fastcall get_wansetup_status(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 106DC: using guessed type int __fastcall get_wan_type(_DWORD, _DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 108D4: using guessed type int __fastcall ddnsapi_remove_host(_DWORD);
// 10D00: using guessed type int __fastcall get_idle_timeout(_DWORD);
// 10DCC: using guessed type int __fastcall check_valid_account(_DWORD);
// 10E8C: using guessed type int __fastcall get_wan_link(_DWORD);
// 10F10: using guessed type int __fastcall ddnsapi_add_config(_DWORD);
// 10FD0: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// 11000: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 115AC: using guessed type int __fastcall get_random_str(_DWORD, _DWORD);
// 11714: using guessed type int __fastcall ddnsapi_read_config_by_service_type(_DWORD, _DWORD, _DWORD);
// 11E10: using guessed type int __fastcall get_usb_tethering_status(_DWORD);
// 11EC4: using guessed type int __fastcall ddnsapi_set_refresh_flag(_DWORD, _DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);
// 11F78: using guessed type int __fastcall encode_crypt(_DWORD, _DWORD, _DWORD, _DWORD);
// 1205C: using guessed type int __fastcall get_pppoe_status(_DWORD);

//----- (0004B4B0) --------------------------------------------------------
int __fastcall print_iframe_hiddenddnssetup(int a1, int a2)
{
  int v2; // r4@1

  v2 = a2;
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_hiddenddnssetup\">");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  sub_4ACD8(v2);
  printf("UnMaskIt(parent.document, 'apply_mask');");
  return printf("</script>");
}

//----- (0004B518) --------------------------------------------------------
int print_iframe_hiddenddnsstatus()
{
  int v0; // r6@1
  int v1; // r1@5
  void *v2; // r0@5
  const char *v3; // r2@6
  int v4; // r0@7
  int v6; // [sp+4h] [bp-5ECh]@1
  int v7; // [sp+28h] [bp-5C8h]@2
  int v8; // [sp+428h] [bp-1C8h]@9
  int v9; // [sp+504h] [bp-ECh]@5
  int v10; // [sp+584h] [bp-6Ch]@1
  int v11; // [sp+588h] [bp-68h]@5
  int v12; // [sp+5A0h] [bp-50h]@3

  memset(&v10, 0, 0x5Cu);
  memset(&v6, 0, 0x500u);
  v0 = ddnsapi_read_config_by_service_type(0, "iptime", &v6);
  if ( v0 )
  {
    ddnsapi_get_status(&v7, &v10);
    if ( ddnsapi_get_refresh_flag(&v7) )
      sf_strncpy(&v12, "", 64);
  }
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_hiddenddnsstatus\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=hiddenddnsstatus>");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  if ( v0 )
  {
    printf("parent.window.update_status_ddns(true, '%s',", &v7);
    v2 = sub_4A108((const char *)&v12, v1);
    printf("'%s', ", v2);
    strcmp((const char *)&v11, "0.0.0.0");
    printf("'%s', ");
    sub_4A318((int)&v10, (int)&v9, 0);
    printf("'%s', ", &v9);
    sub_4A318((int)&v10, (int)&v9, 1);
    printf("'%s', ", &v9);
    if ( !strcmp((const char *)&v12, "SUCCESS") )
    {
      v3 = "true";
    }
    else
    {
      v4 = strcmp((const char *)&v12, "CONN_FAIL");
      v3 = "false";
      if ( !v4 )
        v3 = "true";
    }
    printf("'%s', %s);", &v8, v3);
  }
  else
  {
    printf("parent.window.update_status_ddns(false);");
  }
  printf("setTimeout(function(){document.expertconf_hiddenddnsstatus.submit();}, 3000);");
  return printf("</script>");
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10730: using guessed type int __fastcall ddnsapi_get_refresh_flag(_DWORD);
// 11714: using guessed type int __fastcall ddnsapi_read_config_by_service_type(_DWORD, _DWORD, _DWORD);
// 11B28: using guessed type int __fastcall ddnsapi_get_status(_DWORD, _DWORD);

//----- (0004B728) --------------------------------------------------------
int expertconf_ddns()
{
  print_js_file((int)"expertconf", (int)"ddns");
  puts("<style type=\"text/css\">");
  puts(".ddns_main_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".ddns_main_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".ddns_main_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".ddns_main_p {");
  puts("\tpadding-left:5px; display:inline-block;");
  puts("\tvertical-align:middle; margin:0;");
  puts("}");
  puts(".ddns_main_span {");
  puts("\tdisplay:inline-block; vertical-align:middle;");
  puts("}");
  puts(".ddns_main_button {");
  puts("\tpadding:0 1 0 1; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".ddns_main_td input[type=checkbox], .ddns_main_td input[type=radio] {");
  puts("display:inline-block; vertical-align:middle;");
  puts("}");
  puts("#ddns_div_msg p {");
  puts("margin:5 0 5 15px; text-align:left;");
  puts("}");
  puts(".ddns_ellipsis {");
  puts("text-overflow:ellipsis; overflow:hidden; white-space:nowrap; text-align:left;");
  puts("}");
  printf("input[type=\"text\"] {border:1px #CCC solid;}");
  printf("input[type=\"password\"] {border:1px #CCC solid;}");
  printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td {cursor:default;}");
  printf("</style>");
  return sub_4A37C();
}

//----- (0004B8DC) --------------------------------------------------------
int sub_4B8DC()
{
  puts("<style type=\"text/css\">");
  puts(".pptpvpn_main_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".pptpvpn_main_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".pptpvpn_main_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pptpvpn_main_p {");
  puts("\tpadding-left:5px; display:inline-block;");
  puts("\tvertical-align:middle; margin:0;");
  puts("}");
  puts(".pptpvpn_main_span {");
  puts("\tdisplay:inline-block; vertical-align:middle;");
  puts("}");
  puts(".pptpvpn_main_button {");
  puts("\tpadding:0 1px 0 1px; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pptpvpn_main_td input[type=checkbox], .pptpvpn_main_td input[type=radio] {");
  puts("display:inline-block; vertical-align:middle;");
  puts("}");
  puts("#pptpvpn_div_msg p {");
  puts("margin:5px 0 5px 15px; text-align:left;");
  puts("}");
  puts(".pptpvpn_ellipsis {");
  puts("text-overflow:ellipsis; overflow:hidden; white-space:nowrap; text-align:left;");
  puts("}");
  printf("input[type=\"text\"] {border:1px #CCC solid;}");
  printf("input[type=\"password\"] {border:1px #CCC solid;}");
  printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td {cursor:default;}");
  return printf("</style>");
}

//----- (0004BA78) --------------------------------------------------------
int __fastcall sub_4BA78(int a1)
{
  int v1; // r5@1
  int v2; // r6@2
  int v3; // r7@3
  int v4; // r0@3
  unsigned int v5; // r0@6
  int v6; // r0@6
  int v8; // [sp+0h] [bp-A0h]@4
  char v9; // [sp+68h] [bp-38h]@1

  v1 = a1;
  if ( !get_value_post(a1, "act", &v9, 32) )
    return 0;
  v2 = strcmp(&v9, "apply");
  if ( v2 )
    return 0;
  get_value_post(v1, "operation", &v9, 32);
  v3 = atoi(&v9);
  get_value_post(v1, "mppe", &v9, 32);
  v4 = atoi(&v9);
  pptpserver_set_config(v3, v4);
  do
  {
    memset(&v8, 0, 0x68u);
    if ( !pptpserver_get_index_pptpinfo(v2, &v8) )
      break;
    ++v2;
    pptpserver_disconnect_user(&v8);
  }
  while ( v2 != 5 );
  v5 = sleep(5u);
  v6 = signal_update(v5);
  signal_save(v6);
  signal_start("vpn");
  return 0;
}
// 10478: using guessed type int __fastcall pptpserver_set_config(_DWORD, _DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10C64: using guessed type int __fastcall signal_start(_DWORD);
// 110F0: using guessed type int __fastcall pptpserver_get_index_pptpinfo(_DWORD, _DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11D80: using guessed type int __fastcall pptpserver_disconnect_user(_DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);

//----- (0004BB70) --------------------------------------------------------
int __fastcall print_iframe_hiddenpptpvpnsetup(int a1, int a2)
{
  sub_4BA78(a2);
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_hiddenvpnsetup\">");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  printf("UnMaskIt(parent.document, 'apply_mask');");
  return printf("</script>");
}

//----- (0004BBD4) --------------------------------------------------------
int print_iframe_hiddenpptpvpnstatus()
{
  int v0; // r4@1
  int v1; // r1@2
  int v2; // r0@4
  int v3; // r2@6
  int v4; // r1@6
  char *v5; // r3@7
  char *v6; // ST00_4@9
  int v7; // r3@9
  char v9; // [sp+8h] [bp-80h]@2
  int v10; // [sp+6Ch] [bp-1Ch]@3

  v0 = 0;
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_hiddenvpnstatus\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=hiddenpptpvpnstatus>");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  do
  {
    memset(&v9, 0, 0x68u);
    if ( !pptpserver_get_index_pptpinfo(v0, &v9) )
      break;
    v2 = v10 ? 227 : 228;
    v3 = get_ux_text_common(v2, v1);
    v4 = v0;
    v5 = v10 ? "false" : "true";
    v6 = v5;
    v7 = v0++;
    printf("parent.window.update_pptpvpn_status('connstat_%d', '%s', 'dischk_%d', %s);", v4, v3, v7, v6);
  }
  while ( v0 != 5 );
  printf("setTimeout(function(){document.expertconf_hiddenvpnstatus.submit();}, 3000);");
  return printf("</script>");
}
// 110F0: using guessed type int __fastcall pptpserver_get_index_pptpinfo(_DWORD, _DWORD);

//----- (0004BCD8) --------------------------------------------------------
int __fastcall print_iframe_pptpvpn_accout(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r5@5
  int v4; // r1@6
  int v5; // r0@8
  int v6; // r7@9
  int v7; // r1@14
  int v8; // r0@15
  int v9; // r0@16
  int v10; // r6@17
  int v11; // r6@22
  int v12; // r1@28
  int v13; // r0@28
  int v14; // r1@28
  int v15; // r0@28
  int v16; // r1@28
  int v17; // r0@28
  void *v18; // r4@28
  int v19; // r1@28
  int v20; // r0@28
  void *v21; // r4@28
  int v22; // r1@28
  int v23; // r0@28
  void *v24; // r1@28
  signed int v25; // r4@28
  char *v26; // r1@31
  int v27; // r1@33
  int v28; // r0@34
  int v29; // r0@36
  signed int v30; // r1@36
  char *v31; // r3@37
  const char *v32; // r1@42
  int v34; // r0@48
  signed int v35; // [sp+0h] [bp-1A0h]@0
  char s; // [sp+8h] [bp-198h]@6
  char v37; // [sp+48h] [bp-158h]@12
  char v38; // [sp+70h] [bp-130h]@9
  int v39; // [sp+90h] [bp-110h]@10
  int v40; // [sp+B0h] [bp-F0h]@10
  char v41; // [sp+D8h] [bp-C8h]@29
  int v42; // [sp+118h] [bp-88h]@33
  int v43; // [sp+13Ch] [bp-64h]@33
  char v44; // [sp+140h] [bp-60h]@1

  v2 = a2;
  if ( !get_value_post(a2, "act", &v44, 64) )
    goto LABEL_28;
  if ( !strcmp(&v44, "add") )
  {
    if ( !check_valid_account(0) && !check_captcha_post(v2) )
      goto LABEL_28;
    v3 = 0;
    while ( 1 )
    {
      memset(&s, 0, 0x68u);
      v4 = pptpserver_get_index_pptpinfo(v3, &s);
      if ( !v4 )
        break;
      if ( ++v3 == 5 )
      {
        v5 = 224;
LABEL_48:
        v34 = get_ux_text_common(v5, v4);
        print_alert(v34);
        goto LABEL_28;
      }
    }
    memset(&v38, 0, 0x68u);
    get_value_post(v2, "account", &v38, 32);
    v6 = check_unpermitted_chars(&v38);
    if ( v6 )
      goto LABEL_28;
    get_value_post(v2, "password", &v39, 32);
    get_ip_value_post(v2, "ip", &v40);
    do
    {
      memset(&s, 0, 0x68u);
      if ( !pptpserver_get_index_pptpinfo(v6, &s) )
        break;
      if ( !strcmp(&v37, (const char *)&v40) )
      {
        v5 = 223;
        goto LABEL_48;
      }
      ++v6;
    }
    while ( v6 != 5 );
    if ( check_pptp_account(&v38) )
    {
      v8 = pptpserver_add_user(&v38);
    }
    else
    {
      v9 = get_ux_text_common(1003, v7);
      v8 = print_alert(v9);
    }
    goto LABEL_27;
  }
  v10 = strcmp(&v44, "del");
  if ( !v10 )
  {
    do
    {
      v35 = 64;
      v8 = get_value_array_post(v2, "delchk");
      if ( v8 )
        v8 = pptpserver_remove_user(&v44);
      ++v10;
    }
    while ( v10 != 5 );
LABEL_27:
    signal_save(v8);
    goto LABEL_28;
  }
  v11 = strcmp(&v44, "disconnect");
  if ( !v11 )
  {
    do
    {
      v35 = 64;
      if ( get_value_array_post(v2, "dischk") )
        pptpserver_disconnect_user(&v44);
      ++v11;
    }
    while ( v11 != 5 );
    v8 = sleep(5u);
    goto LABEL_27;
  }
LABEL_28:
  sub_4B8DC();
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"pptpvpn_account_fm\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=pptpvpn_account>");
  printf("<input type=hidden name=act value=>");
  printf("<table class=\"v3_table pptpvpn_main_table\" width=\"100%%\" height=\"144\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"200\"><COL width=\"140\"><COL width=\"140\"><COL width=\"100\"><COL width=\"%%%%\">");
  printf("<tr class=\"pptpvpn_main_tr\" height=\"24\">");
  printf("<td class=\"pptpvpn_main_td\">");
  v13 = get_ux_text_common(234, v12);
  printf("<p class=\"pptpvpn_main_p\">%s</p>", v13);
  printf("</td>");
  printf("<td class=\"pptpvpn_main_td\">");
  v15 = get_ux_text_common(46, v14);
  printf("<span class=\"pptpvpn_main_span\">%s</span>", v15);
  printf("</td>");
  printf("<td class=\"pptpvpn_main_td\">");
  v17 = get_ux_text_common(226, v16);
  printf("<span class=\"pptpvpn_main_span\">%s</span>", v17);
  printf("</td>");
  printf("<td class=\"pptpvpn_main_td\">");
  v18 = get_image_dir();
  v20 = get_ux_text_common(229, v19);
  printf(
    "<span class=\"pptpvpn_main_span\" style=\"cursor:pointer;\" onclick=\"parent.window.DisconnectPPTPUser(document.pptp"
    "vpn_account_fm);\">\t\t<img src=\"/%s/minus_icon.gif\">%s</span>\t\t<input type=\"checkbox\" onclick=\"parent.window"
    ".onclick_alldischk(this);\">",
    v18,
    v20);
  printf("</td>");
  printf("<td class=\"pptpvpn_main_td\" align=\"right\">");
  v21 = get_image_dir();
  v23 = get_ux_text_common(143, v22);
  v24 = v21;
  v25 = 0;
  printf(
    "<span class=\"pptpvpn_main_span\" style=\"cursor:pointer;\" onclick=\"parent.window.RemovePPTPUser(document.pptpvpn_"
    "account_fm);\">\t\t<img src=\"/%s/minus_icon.gif\">%s</span>\t\t<input type=\"checkbox\" onclick=\"parent.window.onc"
    "lick_alldelchk(this);\" style=\"margin-right:5px;\">",
    v24,
    v23);
  printf("</td>");
  printf("</tr>");
  do
  {
    memset(&v41, 0, 0x68u);
    if ( !pptpserver_get_index_pptpinfo(v25, &v41) )
      break;
    v26 = v25 & 1 ? "F7F7F7" : "FFFFFF";
    printf("<tr class=\"pptpvpn_main_tr\" height=\"24\" style=\"background-color:#%s;\">", v26);
    printf("<td class=\"pptpvpn_main_td\">");
    printf("<span class=\"pptpvpn_main_span\" id=\"acc_%s\" style=\"margin-left:5px;\">%s</span>", &v41, &v41);
    printf("</td>");
    printf("<td class=\"pptpvpn_main_td\">");
    printf("<span class=\"pptpvpn_main_span\" id=\"ipa_%s\">%s</span>", &v42, &v42);
    printf("</td>");
    printf("<td class=\"pptpvpn_main_td\">");
    v28 = v43 ? 227 : 228;
    v29 = get_ux_text_common(v28, v27);
    printf("<span class=\"pptpvpn_main_span\" id=\"connstat_%d\">%s</span>", v25, v29);
    printf("</td>");
    printf("<td class=\"pptpvpn_main_td\">");
    v30 = v25++;
    v31 = v43 ? "" : "disabled";
    printf(
      "<input type=checkbox name=dischk id=\"dischk_%d\" value=\"%s\" style=\"margin-left:60px;\" %s>",
      v30,
      &v41,
      v31,
      v35);
    printf("</td>");
    printf("<td class=\"pptpvpn_main_td\" align=\"right\">");
    printf("<input type=checkbox name=delchk value=\"%s\" style=\"margin-right:5px;\">", &v41);
    printf("</td>");
    printf("</tr>");
  }
  while ( v25 != 5 );
  while ( v25 <= 4 )
  {
    if ( v25 & 1 )
      v32 = "F7F7F7";
    else
      v32 = "FFFFFF";
    ++v25;
    printf("<tr class=\"pptpvpn_main_tr\" height=\"24\" style=\"background-color:#%s;\">", v32);
    printf("<td class=\"pptpvpn_main_td\" colspan=\"5\"></td>");
    printf("</tr>");
  }
  printf("</table>");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  printf("UnMaskIt(parent.document, 'apply_mask');");
  return printf("</script>");
}
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10DCC: using guessed type int __fastcall check_valid_account(_DWORD);
// 11000: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// 110F0: using guessed type int __fastcall pptpserver_get_index_pptpinfo(_DWORD, _DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11A8C: using guessed type int __fastcall get_value_array_post(_DWORD, _DWORD);
// 11CC0: using guessed type int __fastcall pptpserver_add_user(_DWORD);
// 11CF0: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// 11D80: using guessed type int __fastcall pptpserver_disconnect_user(_DWORD);
// 12110: using guessed type int __fastcall pptpserver_remove_user(_DWORD);

//----- (0004C260) --------------------------------------------------------
int expertconf_pptpvpn()
{
  char *v0; // r4@1
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r1@1
  char *v4; // r6@2
  int v5; // r0@4
  int v6; // r1@4
  char *v7; // r6@5
  int v8; // r0@7
  int v9; // r1@7
  int v10; // r0@7
  int v11; // r1@7
  char *v12; // r6@8
  int v13; // r0@10
  int v14; // r1@10
  int v15; // r0@12
  int v16; // r1@12
  int v17; // r0@12
  int v18; // r1@12
  int v19; // r0@12
  int v20; // r0@12
  int v21; // r0@13
  int v22; // r1@15
  int v23; // r0@15
  int v24; // r1@15
  int v25; // r0@15
  int v26; // r1@15
  int v27; // r0@15
  int v28; // r1@15
  int v29; // r0@15
  int v30; // r1@15
  int v31; // r0@15
  int v32; // r0@15
  int v33; // r1@15
  const char *v34; // r0@16
  int v35; // r0@17
  int v36; // r1@17
  int v37; // r0@17
  int v38; // r1@17
  int v39; // r0@17
  int v40; // r0@18
  int v41; // r1@19
  int v42; // r0@19
  void *v43; // r4@20
  int v44; // r1@20
  int v45; // r0@20
  int v46; // r1@20
  const char *v47; // r0@20
  int v48; // r0@20
  int v49; // r0@21
  int v50; // r0@21
  int v51; // r0@24
  void *v52; // r0@26
  int v54; // [sp+0h] [bp-B8h]@19
  char v55; // [sp+40h] [bp-78h]@19
  char v56; // [sp+60h] [bp-58h]@15
  char v57; // [sp+80h] [bp-38h]@15
  int v58; // [sp+A0h] [bp-18h]@1
  int v59; // [sp+A4h] [bp-14h]@1

  sub_4B8DC();
  print_js_file((int)"expertconf", (int)"pptpvpn");
  pptpserver_get_config(&v59, &v58);
  printf("<form method=post action=\"timepro.cgi\" name=\"pptpvpn_conf_fm\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"expertconf\">");
  printf("<input type=hidden name=\"smenu\" value=\"pptpvpn\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  printf("<table class=\"v3_table pptpvpn_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<tr class=\"pptpvpn_main_tr\" height=\"48\"><td class=\"pptpvpn_main_td\" width=\"100%%\">");
  printf("<table class=\"v3_table pptpvpn_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"100\"><COL width=\"300\"><COL width=\"%%%%\">");
  printf("<tr class=\"pptpvpn_main_tr\" height=\"24\"><td class=\"pptpvpn_main_td\">");
  v0 = "";
  v2 = get_ux_text_common(1421, v1);
  printf("<p class=\"pptpvpn_main_p\">%s</p>", v2);
  printf("</td><td class=\"pptpvpn_main_td\">");
  printf("<div class=\"pptpvpn_main_span\" style=\"width:140px; *display:inline; zoom:1;\">");
  if ( v59 )
    v4 = "checked";
  else
    v4 = "";
  v5 = get_ux_text_common(1104, v3);
  printf("<input type=radio name=operation id=operationtrue value=1 %s><label for=\"operationtrue\">%s</label>", v4, v5);
  printf("</div>");
  printf("<div class=\"pptpvpn_main_span\" style=\"width:140px; *display:inline; zoom:1;\">");
  if ( v59 )
    v7 = "";
  else
    v7 = "checked";
  v8 = get_ux_text_common(1111, v6);
  printf(
    "<input type=radio name=operation id=operationfalse value=0 %s><label for=\"operationfalse\">%s</label>",
    v7,
    v8);
  printf("</div>");
  printf("</td><td class=\"pptpvpn_main_td\"></td></tr>");
  printf("<tr class=\"pptpvpn_main_tr\" height=\"24\"><td class=\"pptpvpn_main_td\">");
  v10 = get_ux_text_common(231, v9);
  printf("<p class=\"pptpvpn_main_p\">%s</p>", v10);
  printf("</td><td class=\"pptpvpn_main_td\">");
  printf("<div class=\"pptpvpn_main_span\" style=\"width:140px; *display:inline; zoom:1;\">");
  if ( v58 )
    v12 = "checked";
  else
    v12 = "";
  v13 = get_ux_text_common(230, v11);
  printf("<input type=radio name=mppe value=1 id=mppetrue %s><label for=\"mppetrue\">%s</label>", v12, v13);
  printf("</div>");
  printf("<div class=\"pptpvpn_main_span\" style=\"width:140px; *display:inline; zoom:1;\">");
  if ( !v58 )
    v0 = "checked";
  v15 = get_ux_text_common(232, v14);
  printf("<input type=radio name=mppe value=0 id=mppefalse %s><label for=\"mppefalse\">%s</label>", v0, v15);
  printf("</div>");
  printf((const char *)&unk_AECE5);
  v17 = get_ux_text_common(35, v16);
  printf("<input type=button name=pptp_submit value=\"%s\" onclick=\"ApplyPPTP();\">\n", v17);
  printf("</td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("<tr class=\"pptpvpn_main_tr\" height=\"24\" style=\"background-color:#DBDBDB;\">\t\t<td class=\"pptpvpn_main_td\" style=\"border-top:1px #ccc solid; border-bottom:1px #ccc solid;\">");
  v19 = get_ux_text_common(238, v18);
  printf("<p class=\"pptpvpn_main_p\"><b>%s</b></p>", v19);
  printf("</td></tr>");
  v20 = printf("<tr class=\"pptpvpn_main_tr\"><td class=\"pptpvpn_main_td\">");
  if ( is_mobile_agent(v20) )
  {
    print_div_m_str((int)"144", (int)"100%%", (int)"display:inline-block; *display:inline; zoom:1;");
    v21 = printf("<iframe name=\"pptpvpn_account\" src=\"timepro.cgi?tmenu=iframe&smenu=pptpvpn_account\"                         frameborder=no width=100%% height=144 align=center scrolling=yes></iframe>");
    print_div_m_etr(v21);
  }
  else
  {
    printf("<iframe name=\"pptpvpn_account\" src=\"timepro.cgi?tmenu=iframe&smenu=pptpvpn_account\"                         frameborder=no width=100%% height=144 align=center scrolling=yes></iframe>");
  }
  printf("</td></tr>");
  printf("<tr class=\"pptpvpn_main_tr\" height=\"24\" style=\"background-color:#DBDBDB;\">\t\t<td class=\"pptpvpn_main_td\" style=\"border-top:1px #ccc solid; border-bottom:1px #ccc solid;\">");
  v23 = get_ux_text_common(239, v22);
  printf("<p class=\"pptpvpn_main_p\"><b>%s</b></p>", v23);
  printf("</td></tr>");
  printf("<tr class=\"pptpvpn_main_tr\"><td class=\"pptpvpn_main_td\" width=\"100%%\">");
  printf("<table class=\"v3_table pptpvpn_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"321\"><COL width=\"321\">");
  printf("<tr class=\"pptpvpn_main_tr\" height=\"96\"><td class=\"pptpvpn_main_td\">");
  printf("<table class=\"v3_table pptpvpn_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"100\"><COL width=\"155\"><COL width=\"%%%%\">");
  v25 = get_ux_text_common(234, v24);
  printf(
    "<tr class=\"pptpvpn_main_tr\" height=\"24\"><td class=\"pptpvpn_main_td\"><p class=\"pptpvpn_main_p\">%s</p></td>",
    v25);
  printf((const char *)&unk_AF04A);
  v27 = get_ux_text_common(235, v26);
  printf(
    "<tr class=\"pptpvpn_main_tr\" height=\"24\"><td class=\"pptpvpn_main_td\"><p class=\"pptpvpn_main_p\">%s</p></td>",
    v27);
  v29 = get_ux_text_common(233, v28);
  printf(
    "<td class=\"pptpvpn_main_td\">\t\t<input type=password name=password size=30 maxlength=30 style=\"ime-mode:disabled;"
    " width:150px;\">\t\t<input type=text name=password_text size=30 maxlength=30 style=\"ime-mode:disabled; width:150px;"
    " display:none;\">\t\t</td><td class=\"pptpvpn_main_td\">\t\t<input type=checkbox id=\"passview\" onclick=\"onclick_p"
    "assview(this.checked);\">\t\t<label for=\"passview\"><span class=\"pptpvpn_main_span\">%s</span></label>\t\t</td></tr>",
    v29);
  v31 = get_ux_text_common(46, v30);
  printf(
    "<tr class=\"pptpvpn_main_tr\" height=\"24\"><td class=\"pptpvpn_main_td\"><p class=\"pptpvpn_main_p\">%s</p></td>",
    v31);
  printf("<td class=\"pptpvpn_main_td\" colspan=\"2\">");
  get_ifconfig((int)"br0", (int)&v57, (int)&v56);
  print_html_ip_address((int)"ip", &v57, 3);
  v32 = printf("</td></tr>");
  if ( check_valid_account(v32) )
  {
    v34 = "<tr class=\"pptpvpn_main_tr\" height=\"24\"><td class=\"pptpvpn_main_td\" colspan=\"2\"></td></tr>";
  }
  else
  {
    v35 = get_ux_text_common(225, v33);
    printf("<input type=hidden name=default_captcha_desc value='%s'>\n", v35);
    puts("<input type=hidden name=captcha_file value=>");
    v37 = get_ux_text_common(240, v36);
    printf(
      "<tr class=\"pptpvpn_main_tr\" height=\"24\"><td class=\"pptpvpn_main_td\"><p class=\"pptpvpn_main_p\">%s</p></td>",
      v37);
    printf("<td class=\"pptpvpn_main_td\" colspan=\"2\">");
    v39 = get_ux_text_common(225, v38);
    printf(
      "<input type=text name=captcha_code maxlength=\"5\" STYLE=\"width:205px; height:21px; color:#888888;\" value=\"%s\""
      " \t\t\tonfocus=\"FocusCaptcha(document.pptpvpn_conf_fm);\" onblur=\"BlurCaptcha(document.pptpvpn_conf_fm);\">",
      v39);
    v34 = "</td></tr>";
  }
  printf(v34);
  printf("</table>");
  printf("</td>");
  v40 = printf("<td class=\"pptpvpn_main_td\">");
  if ( !check_valid_account(v40) )
  {
    get_http_auth_method(&v54);
    get_ux_lang((int)&v55);
    puts("<table class=\"v3_table pptpvpn_main_table\" width=\"321\" height=\"96\">");
    printf("<COL width=\"291\"><COL width=\"30\">");
    printf("<tr class=\"pptpvpn_main_tr\"><td class=\"pptpvpn_main_td\">");
    puts("<table class=\"v3_table pptpvpn_main_table\" width=\"254\" height=\"96\">");
    printf("<COL width=\"90\"><COL width=\"201\">");
    printf((const char *)&unk_AF449);
    v42 = get_ux_text_common(240, v41);
    printf("<p class=\"pptpvpn_main_p\">%s</p>", v42);
    printf("</td></tr>");
    printf(
      "<tr class=\"pptpvpn_main_tr\" \t\t\tstyle=\"font: normal normal normal 12px arial; color:#000000; border:#C6C9CC 1"
      "px solid; background-color:#FFFFFF;\" height=\"72\">\t\t\t<td class=\"pptpvpn_main_td\" style=\"cursor:pointer; ba"
      "ckground-color:#FAFAFA; border:0;\" \t\t\tonclick=\"iframe_captcha.location.reload();\">\t\t\t<img src=\"/images2/"
      "captcha_noborder.%s.gif\" style=\"border:0; margin-left:18px;\"></td>\n",
      &v55);
    strcmp((const char *)&v54, "session");
    printf("<td class=\"pptpvpn_main_td\" style=\"border-left:1px #CCC solid;\">\t\t\t<iframe name=iframe_captcha id=iframe_captcha src=\"/%s/captcha.cgi\" width=\"200\" height=\"72\" \t\t\tframeborder=no scrolling=no></iframe>\t\t\t</td></tr>\n");
    printf("</table>");
    printf("</td><td class=\"pptpvpn_main_td\"></td></tr></table>");
  }
  printf("</td></tr>");
  printf("<tr class=\"pptpvpn_main_tr\" height=\"10\"><td class=\"pptpvpn_main_td\" colspan=\"2\"></td></tr>");
  printf((const char *)&unk_AF783);
  v43 = get_image_dir();
  v45 = get_ux_text_common(6, v44);
  printf(
    "<button class=\"pptpvpn_main_button\" style=\"margin-left:5px; width:55px;\" id=\"btnadd\" \t\tonclick=\"AddPPTPServ"
    "erUser(); return ClickEventPropagater(event);\">\t\t<span class=\"pptpvpn_main_span\" style=\"\"><img src=\"/%s/plus"
    "_icon.gif\" style=\"padding-right:4px;\">%s</span></button>",
    v43,
    v45);
  printf((const char *)&unk_AECE5);
  printf("<span class=\"pptpvpn_main_span\" style=\"padding-right:30px;\"><font color=\"gray\">");
  v47 = (const char *)get_ux_text_common(1420, v46);
  printf(v47, 5);
  printf("</font></span>");
  printf("</td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("</table>");
  v48 = printf("</form>");
  if ( is_mobile_agent(v48) )
  {
    print_div_m_str((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v49 = printf("<iframe name=\"hiddenpptpvpnstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenpptpvpnstatus\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    v50 = print_div_m_etr(v49);
  }
  else
  {
    v50 = printf("<iframe name=\"hiddenpptpvpnstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenpptpvpnstatus\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  if ( is_mobile_agent(v50) )
  {
    print_div_m_str((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v51 = printf("<iframe name=\"hiddenpptpvpnsetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenpptpvpnsetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    print_div_m_etr(v51);
  }
  else
  {
    printf("<iframe name=\"hiddenpptpvpnsetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenpptpvpnsetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  printf("<script>init_pptpvpn();</script>");
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v52 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v52);
  printf("</SPAN></td>");
  printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"pptpvpn_div_msg\">\n");
  printf("</SPAN></td>");
  return printf((const char *)&unk_7D215);
}
// 1076C: using guessed type int __fastcall get_http_auth_method(_DWORD);
// 10DCC: using guessed type int __fastcall check_valid_account(_DWORD);
// 11138: using guessed type int __fastcall pptpserver_get_config(_DWORD, _DWORD);
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (0004C94C) --------------------------------------------------------
int __fastcall sub_4C94C(int a1, int a2)
{
  int v2; // r7@1
  int v3; // r0@1
  int v4; // r0@1
  int v5; // r0@1
  int v6; // r5@1
  int v7; // r1@1
  int v8; // r0@5
  const char *v9; // r0@6
  int v10; // r1@6
  int v11; // r0@6
  int v12; // r1@6
  const char *v13; // r0@6
  int v14; // r0@6
  int v15; // r0@6
  int v16; // r0@6
  int v17; // r0@6
  int v18; // r0@6
  int v19; // r0@6
  int v20; // r0@6
  int v22; // [sp+0h] [bp-438h]@3
  char v23; // [sp+10h] [bp-428h]@3
  char v24; // [sp+24h] [bp-414h]@3
  char v25; // [sp+38h] [bp-400h]@3
  char v26; // [sp+4Ch] [bp-3ECh]@3
  char v27; // [sp+60h] [bp-3D8h]@3
  char v28; // [sp+3B8h] [bp-80h]@1
  char v29; // [sp+3D8h] [bp-60h]@2
  char v30; // [sp+3F8h] [bp-40h]@3
  int v31; // [sp+40Ch] [bp-2Ch]@3

  v2 = a1;
  v3 = get_ux_text_common(1643, a2);
  v4 = print_wizard_top(v3, 0);
  str(v4);
  v5 = puts("<td height=190 class=\"wizardbody_td\">");
  v6 = hwinfo_get_reboot_duration(v5) + 30;
  if ( get_ip_value(v2, "sm", &v28) && get_ip_value(v2, "ip", &v29) )
  {
    dhcpd_read_config(&v22);
    set_use_local_gateway(0);
    set_lan_ipconfig(&v29, &v28, 0);
    sf_strncpy(&v25, &v29, 20);
    sf_strncpy(&v26, &v28, 20);
    get_subnet_range(&v29, &v28, &v23, &v24);
    get_ifconfig((int)"br0", (int)&v31, (int)&v30);
    if ( !strcmp(&v27, (const char *)&v31) )
      sf_strncpy(&v27, &v29, 20);
    v8 = dhcpd_commit_config(&v22);
    dhcpd_flush_dynamic_lease(v8);
  }
  v9 = (const char *)get_ux_text_common(1640, v7);
  printf(v9);
  v11 = get_ux_text_common(1641, v10);
  printf("%s<br>", v11);
  v13 = (const char *)get_ux_text_common(1642, v12);
  printf(v13);
  printf("<script>RunTimer('reboot_duration',%d,'self.close();');</script>", v6);
  v14 = printf("</td>");
  etr(v14);
  v15 = print_blank_line(1, 2);
  str(v15);
  printf("<td class=wizardbottom_td align=right>");
  print_html_progress_bar(v6, 545, 30);
  v16 = printf("</td>");
  etr(v16);
  v17 = syslog_msg(1, "@{42}");
  v18 = syslog_save(v17);
  v19 = saveconf(v18);
  v20 = signal_update(v19);
  signal_save(v20);
  return signal_reboot(3);
}
// 10430: using guessed type int __fastcall syslog_save(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10754: using guessed type int __fastcall get_ip_value(_DWORD, _DWORD, _DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10934: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// 10E50: using guessed type int __fastcall dhcpd_flush_dynamic_lease(_DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 10FF4: using guessed type int __fastcall saveconf(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 113CC: using guessed type int syslog_msg(_DWORD, const char *, ...);
// 114E0: using guessed type int __fastcall print_html_progress_bar(_DWORD, _DWORD, _DWORD);
// 11600: using guessed type int __fastcall dhcpd_read_config(_DWORD);
// 11678: using guessed type int __fastcall signal_reboot(_DWORD);
// 117C8: using guessed type int __fastcall dhcpd_commit_config(_DWORD);
// 1190C: using guessed type int __fastcall set_use_local_gateway(_DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// 11C60: using guessed type int __fastcall get_subnet_range(_DWORD, _DWORD, _DWORD, _DWORD);
// 11CA8: using guessed type int __fastcall set_lan_ipconfig(_DWORD, _DWORD, _DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);

//----- (0004CB28) --------------------------------------------------------
int __fastcall sub_4CB28(int a1, int a2, int a3)
{
  int v3; // r1@1
  int v4; // r5@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r0@1
  int v8; // r1@1
  int v9; // r0@1
  int v10; // r1@1
  int v11; // r1@2
  int v12; // r0@2
  int v13; // r1@3
  int v14; // r0@3
  int v15; // r1@3
  int v16; // r0@3
  int v17; // r1@3
  int v18; // r0@3
  int v19; // r0@3
  int v20; // r1@3
  int v21; // r0@3
  int v22; // r0@3
  int v24; // [sp+0h] [bp-18h]@1
  int v25; // [sp+4h] [bp-14h]@1
  int v26; // [sp+8h] [bp-10h]@1

  v25 = a2;
  v26 = a3;
  strcpy((char *)&v24, "eth0");
  wizard_api_set_status(&v24, "initial");
  puts("<form method=get action=timepro.cgi name=wizard>");
  puts("<input type=hidden name=tmenu value=wizard>");
  puts("<input type=hidden name=step>");
  puts("<input type=hidden name=start_flag>");
  printf("<input type=hidden name=ifname value=%s>\n", &v24);
  v4 = get_ux_text_common(1691, v3);
  v6 = get_ux_text_common(1692, v5);
  v7 = print_wizard_top(v4, v6);
  str(v7);
  printf("<td height=190 class=\"wizardbody_td\">");
  puts("<input type=radio name=config value=auto checked>");
  v9 = get_ux_text_common(1693, v8);
  printf("%s<br>\n", v9);
  puts("</span>");
  if ( *(_BYTE *)get_ux_text_common(1694, v10) )
  {
    print_nbsp(10);
    v12 = get_ux_text_common(1694, v11);
    printf("%s<br>\n", v12);
  }
  print_nbsp(10);
  v14 = get_ux_text_common(1695, v13);
  printf("%s<br><br>\n", v14);
  puts("<input type=radio name=config value=manual>");
  v16 = get_ux_text_common(1696, v15);
  printf("%s<br>\n", v16);
  print_nbsp(10);
  v18 = get_ux_text_common(1697, v17);
  printf("%s<br>\n", v18);
  puts("</td></tr>");
  v19 = print_blank_line(1, 2);
  str(v19);
  printf("<td class=wizardbottom_td align=right>");
  v21 = get_ux_text_common(1645, v20);
  printf("<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage(1);\">", v21);
  v22 = printf("</td>");
  etr(v22);
  return puts("</form>");
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// 11B88: using guessed type int __fastcall wizard_api_set_status(_DWORD, _DWORD);

//----- (0004CCE0) --------------------------------------------------------
int __fastcall sub_4CCE0(int a1)
{
  int v1; // r4@1
  int result; // r0@3
  int v3; // r0@6
  int v4; // r1@6
  int v5; // r2@6
  int v6; // r1@11
  int v7; // r0@12
  int v8; // r1@12
  int v9; // r0@14
  int v10; // r1@14
  int v11; // r0@15
  int v12; // r1@16
  const char *v13; // r0@16
  int v14; // r0@17
  int v15; // r0@17
  int v16; // r1@17
  int v17; // r0@17
  int v18; // r1@17
  int v19; // r4@17
  int v20; // r1@19
  int v21; // r0@19
  int v22; // r0@19
  int v23; // r4@20
  int v24; // r0@21
  int v25; // r1@22
  int v26; // r0@22
  int v27; // r1@22
  int v28; // r0@22
  int v29; // r1@22
  int v30; // r0@22
  int v31; // r0@22
  int v32; // r0@22
  int v33; // r1@22
  int v34; // r0@22
  int v35; // r1@22
  int v36; // r0@22
  int v37; // r0@22
  const char *v38; // r0@23
  char *v39; // r1@28
  int v40; // r0@31
  int *v41; // r2@31
  char *v42; // r1@32
  const char *v43; // r0@34
  int v44; // r1@38
  int v45; // r1@39
  int v46; // r5@39
  int v47; // r0@39
  int v48; // r0@41
  int v49; // r1@41
  int v50; // r0@42
  int v51; // r0@44
  int v52; // r1@44
  int v53; // r0@44
  int v54; // r1@44
  int v55; // r0@44
  int v56; // r1@44
  int v57; // r0@44
  int v58; // r1@44
  int v59; // r0@44
  int v60; // r1@44
  int v61; // r0@44
  int v62; // r1@44
  int v63; // r0@44
  int v64; // r1@44
  int v65; // r1@44
  const char *v66; // r0@44
  const char *v67; // r0@47
  int v68; // r8@49
  int v69; // r0@53
  int v70; // r1@54
  int v71; // r0@54
  int v72; // r0@54
  int v73; // r1@54
  int v74; // r0@54
  int v75; // r1@54
  int v76; // r0@54
  int v77; // r1@54
  int v78; // r0@54
  int v79; // r0@54
  int v80; // r1@54
  int v81; // r0@54
  int v82; // r1@54
  int v83; // r0@54
  int v84; // r0@54
  int v85; // r0@54
  int v86; // r1@67
  int v87; // r5@67
  int v88; // r1@67
  int v89; // r0@68
  int v90; // r0@70
  int v91; // r1@70
  int v92; // r0@71
  const char *v93; // r0@73
  int v94; // r0@73
  int v95; // r1@73
  const char *v96; // r0@73
  int v97; // r0@73
  int v98; // r0@73
  int v99; // r1@73
  int v100; // r0@73
  int v101; // r1@73
  int v102; // r0@73
  int v103; // r1@73
  int v104; // r0@73
  int v105; // r1@73
  int v106; // r0@73
  int v107; // r1@73
  int v108; // r0@73
  int v109; // r0@73
  int v110; // r1@73
  const char *v111; // r0@73
  int v112; // r0@73
  int v113; // r1@73
  int v114; // r0@73
  int v115; // r1@73
  int v116; // r1@73
  const char *v117; // r0@73
  int v118; // r1@75
  int v119; // r1@76
  int v120; // r4@76
  int v121; // r0@76
  int v122; // r0@78
  int v123; // r0@78
  int v124; // r1@78
  const char *v125; // r0@79
  int v126; // r0@79
  int v127; // r1@79
  int v128; // r0@79
  const char *v129; // r0@80
  int v130; // r0@80
  const char *v131; // r0@81
  int v132; // r0@81
  int v133; // r0@81
  int v134; // r0@81
  int v135; // r1@81
  int v136; // r0@81
  int v137; // r1@81
  int v138; // r1@81
  const char *v139; // r0@81
  unsigned int v140; // r0@83
  char *v141; // r0@83
  int v142; // r1@83
  int v143; // r0@83
  int v144; // r0@83
  int v145; // r1@83
  const char *v146; // r0@83
  int v147; // r1@83
  const char *v148; // r0@83
  int v149; // r0@83
  int v150; // r1@83
  const char *v151; // r0@83
  int v152; // r0@83
  int v153; // r1@83
  int v154; // r0@83
  int v155; // r0@83
  int v156; // r0@83
  int v157; // r1@83
  int v158; // r0@83
  int v159; // r0@83
  int v160; // r0@83
  int v161; // r0@83
  int v162; // r1@83
  int v163; // r0@83
  int v164; // r1@83
  int v165; // r0@84
  int v166; // r1@85
  int v167; // r1@93
  int v168; // r0@93
  int v169; // r0@93
  char *v170; // r1@94
  int v171; // r1@96
  int v172; // r0@96
  int v173; // r1@96
  int v174; // r0@96
  int v175; // r1@96
  int v176; // r0@96
  char *v177; // r1@97
  int v178; // r1@99
  int v179; // r0@99
  int v180; // r1@99
  int v181; // r0@99
  int v182; // r1@99
  int v183; // r0@99
  int v184; // r1@99
  int v185; // r0@99
  char *v186; // r1@100
  int v187; // r1@102
  int v188; // r0@102
  int v189; // r1@102
  int v190; // r0@102
  int v191; // r1@102
  int v192; // r0@102
  int v193; // r0@102
  int v194; // r0@102
  int v195; // r1@102
  int v196; // r0@102
  int v197; // r1@102
  int v198; // r0@102
  int v199; // r0@103
  char *v200; // r6@111
  int v201; // r1@111
  int v202; // r4@111
  int v203; // r1@111
  int v204; // r0@111
  int v205; // r0@111
  int v206; // r1@111
  int v207; // r0@111
  int v208; // r1@111
  char *v209; // r8@112
  int v210; // r0@114
  int v211; // r1@114
  char *v212; // r8@115
  int v213; // r0@117
  int v214; // r0@117
  int v215; // r1@117
  int v216; // r0@117
  int v217; // r1@117
  char *v218; // r5@118
  int v219; // r0@120
  int v220; // r0@120
  int v221; // r1@120
  int v222; // r0@122
  int v223; // r0@122
  int v224; // r1@126
  int v225; // r4@129
  int v226; // r1@129
  int v227; // r0@129
  int v228; // r1@129
  int v229; // r0@129
  int v230; // r1@129
  int v231; // r0@129
  int v232; // r1@129
  int v233; // r0@129
  int v234; // r1@129
  const char *v235; // r0@129
  const char *v236; // r0@129
  int v237; // r1@131
  int v238; // r4@138
  int v239; // r1@138
  int v240; // r0@138
  int v241; // r0@138
  int v242; // r1@138
  int v243; // r0@138
  int v244; // r0@138
  int v245; // r0@138
  int v246; // r1@138
  int v247; // r0@138
  int v248; // r0@138
  int v249; // r0@138
  int v250; // r1@138
  int v251; // r0@138
  int v252; // r0@138
  int v253; // r0@138
  int v254; // r1@138
  int v255; // r0@138
  int v256; // r0@138
  int v257; // r0@138
  int v258; // r1@138
  int v259; // r0@138
  int v260; // r0@138
  int v261; // r0@140
  int v262; // r1@140
  int v263; // r0@140
  int v264; // r1@140
  int v265; // r6@143
  int v266; // r1@144
  int v267; // r0@144
  int v268; // r0@144
  int v269; // r1@144
  int v270; // r0@144
  char *v271; // r0@147
  const char *v272; // r0@150
  char *v273; // r1@150
  int v274; // r1@155
  int v275; // r4@157
  int v276; // r1@157
  int v277; // r0@157
  int v278; // r0@159
  int v279; // r1@159
  int v280; // r0@159
  int v281; // r1@159
  int v282; // r0@160
  char *v283; // r2@160
  int v284; // r1@160
  const char *v285; // r0@160
  int v286; // r1@161
  int v287; // r0@163
  int v288; // r1@164
  int v289; // r0@165
  int v290; // r0@166
  int v291; // r1@166
  int v292; // r4@166
  int v293; // r1@166
  int v294; // r0@167
  int v295; // r0@169
  int v296; // r0@169
  int v297; // r7@170
  int v298; // r1@171
  int v299; // r4@171
  int v300; // r1@171
  int v301; // r0@171
  int v302; // r1@171
  int v303; // r0@171
  signed int v304; // r5@171
  int v305; // r1@171
  int v306; // r0@174
  char *v307; // r2@174
  int v308; // r1@174
  const char *v309; // r0@174
  int v310; // r1@184
  int v311; // r4@186
  int v312; // r1@186
  int v313; // r0@186
  int v314; // r1@186
  int v315; // r0@186
  int v316; // r1@186
  int v317; // r0@186
  int v318; // r1@186
  int v319; // r0@186
  int v320; // r1@186
  int v321; // r0@186
  int v322; // r1@186
  int v323; // r0@188
  int v324; // r1@188
  int v325; // r0@188
  int v326; // r0@188
  int v327; // r1@188
  int v328; // r0@188
  int v329; // r1@188
  char v330; // [sp+0h] [bp-468h]@46
  char v331; // [sp+80h] [bp-3E8h]@128
  char v332; // [sp+13Ch] [bp-32Ch]@53
  char v333; // [sp+1BCh] [bp-2ACh]@53
  char v334; // [sp+278h] [bp-1F0h]@22
  char dest; // [sp+2B8h] [bp-1B0h]@19
  char v336; // [sp+2F8h] [bp-170h]@11
  char v337; // [sp+338h] [bp-130h]@105
  char v338; // [sp+378h] [bp-F0h]@8
  char v339; // [sp+3B8h] [bp-B0h]@25
  char s1; // [sp+3D8h] [bp-90h]@11
  char v341; // [sp+3F8h] [bp-70h]@6
  int v342; // [sp+418h] [bp-50h]@1
  int v343; // [sp+438h] [bp-30h]@11

  v1 = a1;
  if ( get_value(a1, "step", &v342, 32) )
  {
    if ( !strcmp((const char *)&v342, "save") )
      return common_wizard_save(v1);
    if ( !strcmp((const char *)&v342, "finish") )
      return common_wizard_finish(v1);
  }
  v3 = get_value(v1, "config", &v341, 32);
  if ( !v3 )
    return sub_4CB28(v3, v4, v5);
  if ( strcmp(&v341, "auto") )
  {
    result = strcmp(&v341, "manual");
    if ( result )
      return result;
    result = get_value(v1, "step", &v338, 64);
    if ( !result )
      return result;
    v3 = strcmp(&v338, "0");
    if ( !v3 )
      return sub_4CB28(v3, v4, v5);
    if ( !strcmp(&v338, "1") )
    {
      get_value(v1, "ifname", &v339, 16);
      eth2wan(&v339, &v336);
      set_wansetup_status(&v336, 1);
      if ( !get_value(v1, "wan_type", &v343, 16) )
        strcpy((char *)&v343, "dynamic");
      puts("<form method=get action=timepro.cgi name=wizard>");
      puts("<input type=hidden name=tmenu value=wizard>");
      puts("<input type=hidden name=config value=manual>");
      puts("<input type=hidden name=step>");
      printf("<input type=hidden name=ifname value=%s>\n", &v339);
      v168 = get_ux_text_common(1655, v167);
      v169 = print_wizard_top(v168, 0);
      str(v169);
      puts("<td height=190 class=wizardbody_td>");
      if ( !strcmp((const char *)&v343, "dynamic") )
        v170 = "checked";
      else
        v170 = "";
      printf("<input type=radio name=wan_type value=dynamic %s>\n", v170);
      v172 = get_ux_text_common(1656, v171);
      printf("<b>%s</b><br>\n", v172);
      print_nbsp(10);
      v174 = get_ux_text_common(1658, v173);
      printf("%s<br>\n", v174);
      print_nbsp(10);
      v176 = get_ux_text_common(1659, v175);
      printf("%s<br>\n", v176);
      if ( !strcmp((const char *)&v343, "pppoe") )
        v177 = "checked";
      else
        v177 = "";
      printf("<input type=radio name=wan_type value=pppoe %s>\n", v177);
      v179 = get_ux_text_common(1660, v178);
      printf("<b>%s</b><br>\n", v179);
      puts("</span>");
      print_nbsp(10);
      v181 = get_ux_text_common(1661, v180);
      printf("%s<br>\n", v181);
      print_nbsp(10);
      v183 = get_ux_text_common(1662, v182);
      printf("%s<br>\n", v183);
      print_nbsp(10);
      v185 = get_ux_text_common(1663, v184);
      printf("%s<br>\n", v185);
      if ( !strcmp((const char *)&v343, "static") )
        v186 = "checked";
      else
        v186 = "";
      printf("<input type=radio name=wan_type value=static %s>\n", v186);
      v188 = get_ux_text_common(1664, v187);
      printf("<b>%s</b><br>\n", v188);
      print_nbsp(10);
      v190 = get_ux_text_common(1665, v189);
      printf("%s<br>\n", v190);
      print_nbsp(10);
      v192 = get_ux_text_common(1657, v191);
      printf("%s", v192);
      v193 = printf("</td>");
      etr(v193);
      v194 = print_blank_line(1, 2);
      str(v194);
      puts("<td class=wizardbottom_td align=right>");
      v196 = get_ux_text_common(1646, v195);
      printf("<input type=button class=navi_bt name=prev value='%s' onclick=\"WizardGotoPage(0);\">", v196);
      v198 = get_ux_text_common(1645, v197);
      printf("<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage(2);\">", v198);
      goto LABEL_103;
    }
    if ( !strcmp(&v338, "2") )
    {
      get_value(v1, "ifname", &v339, 16);
      puts("<form method=get action=timepro.cgi name=wizard>");
      puts("<input type=hidden name=tmenu value=wizard>");
      puts("<input type=hidden name=config value=manual>");
      puts("<input type=hidden name=step>");
      printf("<input type=hidden name=ifname value=%s>\n", &v339);
      if ( get_value(v1, "wan_type", &v337, 64) )
      {
        printf("<input type=hidden name=wan_type value=%s>\n", &v337);
        if ( !strcmp(&v337, "dynamic") )
        {
          get_value(v1, "ifname", &v336, 8);
          strcpy(&v334, "");
          strcpy(&dest, "");
          get_value(v1, "hw_conf", &v334, 20);
          if ( !get_value(v1, "private", &s1, 20) )
            strcpy(&s1, "on");
          if ( !v334 )
            strcpy(&v334, "auto");
          v200 = "checked";
          get_value(v1, "hw_addr", &dest, 20);
          v202 = get_ux_text_common(1666, v201);
          v204 = get_ux_text_common(1667, v203);
          v205 = print_wizard_top(v202, v204);
          str(v205);
          puts("<td height=190 class=wizardbody_td>");
          v207 = get_ux_text_common(1672, v206);
          printf("%s<br><br>", v207);
          if ( !strcmp(&v334, "auto") )
            v209 = "checked";
          else
            v209 = "";
          v210 = get_ux_text_common(1673, v208);
          printf("<input type=radio name=hw_conf value=auto onclick=\"DisableHW('hw');\" %s> %s<br>", v209, v210);
          if ( !strcmp(&v334, "manual") )
            v212 = "checked";
          else
            v212 = "";
          v213 = get_ux_text_common(1674, v211);
          printf((const char *)&unk_B0956, v212, v213);
          print_nbsp(8);
          v214 = print_hwadress_inputbox((int)"hw", &dest, 0);
          br(v214);
          print_nbsp(10);
          v216 = get_ux_text_common(1675, v215);
          printf("%s<br>\n", v216);
          if ( !strcmp(&v334, "noclone") )
            v218 = "checked";
          else
            v218 = "";
          v219 = get_ux_text_common(1676, v217);
          v220 = printf((const char *)&unk_B09AF, v218, v219);
          br(v220);
          if ( strcmp(&s1, "on") )
            v200 = "";
          v222 = get_ux_text_common(1680, v221);
          printf("<input type=checkbox name=private value=on %s> %s", v200, v222);
          v223 = printf("</td>");
          etr(v223);
          printf("<script>");
          if ( strcmp(&v334, "manual") )
            printf("DisableHW('hw');");
          printf("</script>");
          goto LABEL_140;
        }
        if ( !strcmp(&v337, "pppoe") )
        {
          get_value(v1, "ifname", &dest, 64);
          eth2wan(&dest, &v336);
          strcpy(&v332, "");
          strcpy(&v334, "");
          get_value(v1, "userid", &v332, 128);
          get_value(v1, "passwd", &v334, 64);
          if ( !v332 && !v334 )
          {
            read_pppoe_option(&v336, &v330);
            sf_strncpy(&v332, &v330, 128);
            sf_strncpy(&v334, &v331, 64);
          }
          v225 = get_ux_text_common(1677, v224);
          v227 = get_ux_text_common(1678, v226);
          print_wizard_top(v225, v227);
          puts((const char *)&unk_B00DD);
          v229 = get_ux_text_common(1679, v228);
          printf((const char *)&unk_B09FB, v229);
          printf("<table class=navicontent_table>");
          printf("<tr><td width=100>");
          v231 = get_ux_text_common(424, v230);
          printf("%s", v231);
          printf("</td><td>");
          printf("<input type=text name=userid style=\"width:150;\" maxlength=63 value='%s'>", &v332);
          printf("</td></tr>");
          printf("<tr><td width=100>");
          v233 = get_ux_text_common(941, v232);
          printf("%s", v233);
          printf("</td><td>");
          printf("<input type=password name=\"passwd\" style=\"width:150;\" maxlength=32 value='%s'>", &v334);
          printf("</td></tr>");
          printf("</table>");
          v235 = (const char *)get_ux_text_common(1615, v234);
          printf(v235);
          v236 = "</td></tr>";
LABEL_139:
          puts(v236);
          goto LABEL_140;
        }
        if ( !strcmp(&v337, "static") )
        {
          get_value(v1, "ifname", &v343, 8);
          eth2wan(&v343, &v336);
          strcpy(&s1, "");
          strcpy(&dest, "");
          strcpy(&dest, "");
          strcpy(&v334, "");
          strcpy(&v332, "");
          strcpy(&v330, "");
          get_value(v1, "ip", &s1, 20);
          get_value(v1, "sm", &dest, 20);
          get_value(v1, "gw", &v334, 20);
          get_value(v1, "fdns", &v332, 20);
          get_value(v1, "sdns", &v330, 20);
          if ( !s1 && !dest && !v334 )
            get_wan_ipinfo(&v336, &s1, &dest, &v334);
          if ( !v332 && !v330 )
            get_domain_name_server(&v332, &v330);
          v238 = get_ux_text_common(1668, v237);
          v240 = get_ux_text_common(1669, v239);
          print_wizard_top(v238, v240);
          puts((const char *)&unk_B00DD);
          v241 = puts("<table>");
          str(v241);
          v243 = get_ux_text_common(247, v242);
          printf("<td>%s</td>", v243);
          puts("<td>");
          print_html_ip_address((int)"ip", &s1, 1);
          v244 = printf("</td>");
          v245 = etr(v244);
          str(v245);
          v247 = get_ux_text_common(1118, v246);
          printf("<td>%s</td>", v247);
          puts("<td>");
          print_html_ip_address((int)"sm", &dest, 1);
          v248 = puts("</td>");
          v249 = etr(v248);
          str(v249);
          v251 = get_ux_text_common(381, v250);
          printf("<td>%s</td>", v251);
          puts("<td>");
          print_html_ip_address((int)"gw", &v334, 1);
          v252 = puts("</td>");
          v253 = etr(v252);
          str(v253);
          v255 = get_ux_text_common(1670, v254);
          printf("<td>%s</td>", v255);
          puts("<td>");
          print_html_ip_address((int)"fdns", &v332, 1);
          v256 = puts("</td>");
          v257 = etr(v256);
          str(v257);
          v259 = get_ux_text_common(1671, v258);
          printf("<td>%s</td>", v259);
          puts("<td>");
          print_html_ip_address((int)"sdns", &v330, 1);
          v260 = puts("</td>");
          etr(v260);
          v236 = "</table></td></tr>";
          goto LABEL_139;
        }
      }
LABEL_140:
      v261 = print_blank_line(1, 2);
      str(v261);
      puts("<td class=wizardbottom_td align=right>");
      v263 = get_ux_text_common(1646, v262);
      printf("<input type=button class=navi_bt name=prev value='%s' onclick=\"WizardGotoPage(1);\">", v263);
      v116 = get_ux_text_common(1645, v264);
      v117 = "<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage(3);\">";
LABEL_141:
      printf(v117, v116);
      v199 = puts("</td>");
      goto LABEL_142;
    }
    result = strcmp(&v338, "3");
    v265 = result;
    if ( result )
      return result;
    puts("<form method=get action=timepro.cgi name=wizard>");
    puts("<input type=hidden name=tmenu value=wizard>");
    puts("<input type=hidden name=config value=manual>");
    puts("<input type=hidden name=step>");
    puts("<input type=hidden name=commit>");
    puts("<input type=hidden name=nextstep>");
    get_value(v1, "ifname", &v339, 16);
    printf("<input type=hidden name=ifname value=%s>\n", &v339);
    v267 = get_ux_text_common(1681, v266);
    v268 = print_wizard_top(v267, v265);
    str(v268);
    puts("<td height=190 class=wizardbody_td>");
    v270 = get_ux_text_common(1682, v269);
    printf("%s<br><br>\n", v270);
    if ( get_value(v1, "wan_type", &v336, 32) )
      printf("<input type=hidden name=wan_type value=%s>\n", &v336);
    printf("<table class=wizard_content_table>");
    if ( !strcmp(&v336, "dynamic") )
    {
      strcpy(&v332, "");
      strcpy(&v334, "");
      strcpy(&dest, "");
      v271 = getenv("REMOTE_ADDR");
      get_internal_pc_hardware_address(v271, &v334);
      if ( get_value(v1, "hw_conf", &v330, 20) )
        printf("<input type=hidden name=hw_conf value=%s>\n", &v330);
      if ( get_hw_value(v1, "hw", &v332) )
      {
        v272 = "<input type=hidden name=hw_addr value=\"%s\">\n";
        v273 = &v332;
      }
      else
      {
        if ( strcmp(&v330, "auto") )
          goto LABEL_154;
        v272 = "<input type=hidden name=hw_addr value=\"%s\">\n";
        v273 = &v334;
      }
      printf(v272, v273);
LABEL_154:
      if ( get_value(v1, "private", &dest, 20) )
        printf("<input type=hidden name=private value=%s>\n", &dest);
      else
        puts("<input type=hidden name=private value=off>");
      v275 = get_ux_text_common(1699, v274);
      v277 = get_ux_text_common(1700, v276);
      printf("<tr><td width=150px >%s</td><td><b>%s</b></td></tr>", v275, v277);
      if ( v332 )
        convert_mac(&v332);
      v278 = convert_mac(&v334);
      str(v278);
      v280 = get_ux_text_common(1654, v279);
      printf("<td>%s</td>", v280);
      if ( !strcmp(&v330, "auto") )
      {
        v282 = get_ux_text_common(1653, v281);
        v283 = &v334;
        v284 = v282;
        v285 = (const char *)&unk_B0C26;
      }
      else
      {
        if ( strcmp(&v330, "manual") )
        {
          v287 = strcmp(&v330, "noclone");
          if ( !v287 )
          {
            v289 = get_ux_text_common(1652, v288);
            v287 = printf("<td>%s</td>", v289);
          }
          goto LABEL_166;
        }
        v284 = get_ux_text_common(1651, v286);
        v285 = (const char *)&unk_B0C26;
        v283 = &v332;
      }
      v287 = printf(v285, v284, v283);
LABEL_166:
      v290 = etr(v287);
      str(v290);
      v292 = get_ux_text_common(1688, v291);
      if ( !strcmp(&dest, "on") )
        v294 = 1689;
      else
        v294 = 1690;
      v295 = get_ux_text_common(v294, v293);
      v296 = printf((const char *)&unk_940A7, v292, v295);
      etr(v296);
      goto LABEL_188;
    }
    v297 = strcmp(&v336, "pppoe");
    if ( v297 )
    {
      if ( strcmp(&v336, "static") )
      {
LABEL_188:
        v323 = printf("</table>");
        br(v323);
        v325 = get_ux_text_common(1649, v324);
        printf("%s<br>\n", v325);
        v326 = print_blank_line(1, 2);
        str(v326);
        puts("<td class=wizardbottom_td align=right>");
        v328 = get_ux_text_common(1646, v327);
        printf("<input type=button class=navi_bt name=prev value='%s' onclick=\"WizardGotoPage(2);\">", v328);
        v65 = get_ux_text_common(1647, v329);
        v66 = "<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage('save');\">";
LABEL_189:
        printf(v66, v65);
        puts("</td></tr>");
        goto LABEL_190;
      }
      if ( get_ip_value(v1, "ip", &dest) )
        printf("<input type=hidden name=ip value=\"%s\">\n", &dest);
      if ( get_ip_value(v1, "sm", &v334) )
        printf("<input type=hidden name=sm value=\"%s\">\n", &v334);
      if ( get_ip_value(v1, "gw", &v332) )
        printf("<input type=hidden name=gw value=\"%s\">\n", &v332);
      if ( get_ip_value(v1, "fdns", &v330) )
        printf("<input type=hidden name=fdns value=\"%s\">\n", &v330);
      if ( get_ip_value(v1, "sdns", &s1) )
        printf("<input type=hidden name=sdns value=\"%s\">\n", &s1);
      v311 = get_ux_text_common(1699, v310);
      v313 = get_ux_text_common(1702, v312);
      printf("<tr><td width=150px >%s</td><td><b>%s</b></td></tr>", v311, v313);
      v315 = get_ux_text_common(247, v314);
      printf("<tr><td width=150px >%s</td><td><b>%s</b></td></tr>", v315, &dest);
      v317 = get_ux_text_common(1118, v316);
      printf("<tr><td width=150px >%s</td><td><b>%s</b></td></tr>", v317, &v334);
      v319 = get_ux_text_common(381, v318);
      printf("<tr><td width=150px >%s</td><td><b>%s</b></td></tr>", v319, &v332);
      v321 = get_ux_text_common(258, v320);
      printf("<tr><td width=150px >%s</td><td><b>%s</b></td></tr>", v321, &v330);
      v308 = get_ux_text_common(1079, v322);
      v309 = "<tr><td width=150px >%s</td><td><b>%s</b></td></tr>";
      v307 = &s1;
    }
    else
    {
      get_value(v1, "userid", &v332, 128);
      printf("<input type=hidden name=userid value=\"%s\">\n", &v332);
      get_value(v1, "passwd", &dest, 64);
      printf("<input type=hidden name=passwd value=\"%s\">\n", &dest);
      v299 = get_ux_text_common(1699, v298);
      v301 = get_ux_text_common(1701, v300);
      printf("<tr><td width=150px >%s</td><td><b>%s</b></td></tr>", v299, v301);
      v303 = get_ux_text_common(424, v302);
      printf("<tr><td width=150px >%s</td><td><b>%s</b></td></tr>", v303, &v332);
      v304 = strlen(&dest);
      strcpy(&v334, "");
      while ( v297 < v304 )
      {
        ++v297;
        strcat(&v334, "*");
      }
      v306 = get_ux_text_common(941, v305);
      v307 = &v334;
      v308 = v306;
      v309 = "<tr><td width=150px >%s</td><td><b>%s</b></td></tr>";
    }
    printf(v309, v308, v307);
    goto LABEL_188;
  }
  result = get_value(v1, "step", &v338, 64);
  if ( !result )
    return result;
  v3 = strcmp(&v338, "0");
  if ( !v3 )
    return sub_4CB28(v3, v4, v5);
  if ( !strcmp(&v338, "1") )
  {
    get_value(v1, "ifname", &v336, 8);
    eth2wan(&v336, &v343);
    set_wansetup_status(&v343, 1);
    puts("<form method=get action=timepro.cgi name=wizard>");
    puts("<input type=hidden name=tmenu value=wizard>");
    puts("<input type=hidden name=config value=auto>");
    puts("<input type=hidden name=step>");
    printf("<input type=hidden name=ifname value=%s>\n", &v336);
    get_link_status(65537, &s1);
    if ( !strcmp(&s1, "On") )
    {
      v7 = get_ux_text_common(1605, v6);
      v8 = 0;
    }
    else
    {
      v7 = get_ux_text_common(1604, v6);
      v8 = 0;
    }
    v9 = print_wizard_top(v7, v8);
    str(v9);
    puts("<td height=190 class=wizardbody_td>");
    if ( !strcmp(&s1, "On") )
    {
      puts("<input type=hidden name=start_flag value=1>");
      v13 = (const char *)get_ux_text_common(1603, v12);
      printf(v13);
    }
    else
    {
      v11 = get_ux_text_common(1602, v10);
      printf("%s", v11);
      printf(
        "<meta http-equiv=refresh content=\"3; URL=timepro.cgi?tmenu=wizard&config=auto&step=1&ifname=%s\">",
        &v336);
    }
    v14 = printf("</td>");
    etr(v14);
    v15 = print_blank_line(1, 2);
    str(v15);
    puts("<td class=wizardbottom_td align=right>");
    v17 = get_ux_text_common(1646, v16);
    printf("<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage(0);\">", v17);
    v19 = get_ux_text_common(1645, v18);
    strcmp(&s1, "On");
    printf("<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage(2);\" %s>", v19);
LABEL_103:
    v199 = printf("</td>");
LABEL_142:
    etr(v199);
LABEL_190:
    v67 = "</form>";
    return puts(v67);
  }
  if ( !strcmp(&v338, "2") )
  {
    get_value(v1, "ifname", &v343, 8);
    eth2wan(&v343, &v336);
    puts("<form method=get action=timepro.cgi name=wizard>");
    puts("<input type=hidden name=tmenu value=wizard>");
    puts("<input type=hidden name=config value=auto>");
    puts("<input type=hidden name=step>");
    printf("<input type=hidden name=ifname value=%s>\n", &v343);
    v21 = get_ux_text_common(1609, v20);
    print_wizard_top(v21, 0);
    v22 = get_value(v1, "start_flag", &dest, 64);
    if ( v22 )
    {
      v22 = strcmp(&dest, "1");
      v23 = v22;
      if ( !v22 )
      {
        wizard_api_set_mode(1);
        set_dhclient_block_private_ip(&v343);
        wizard_api_set_status(&v343, "detecting");
        set_default_gateway("br0", v23);
        set_default_gateway(&v343, v23);
        set_ifconfig(&v343);
        set_wan_type(&v336, "pppoe");
        set_pppoe_status(&v336, v23);
        pppoe_stop(&v336);
        v24 = dhclient_stop(&v336);
        v22 = signal_update(v24);
      }
    }
    etr(v22);
    puts("<td height=190 class=wizardbody_td>");
    v26 = get_ux_text_common(1606, v25);
    printf("%s<br>", v26);
    v28 = get_ux_text_common(1607, v27);
    printf("%s<br>", v28);
    v30 = get_ux_text_common(1608, v29);
    printf("%s<br><br>", v30);
    v31 = puts("</td>");
    etr(v31);
    v32 = print_blank_line(1, 2);
    str(v32);
    puts("<td class=wizardbottom_td align=right>");
    v34 = get_ux_text_common(1646, v33);
    printf("<input type=button class=navi_bt name=prev value='%s' onclick=\"WizardGotoPage(1);\">", v34);
    v36 = get_ux_text_common(1645, v35);
    printf("<input type=button class=navi_bt name=next value='%s' disabled>", v36);
    v37 = puts("</td>");
    etr(v37);
    puts("</form>");
    wizard_api_get_status(&v343, &v334);
    if ( !strcmp(&v334, "detecting") )
    {
      v38 = "<meta http-equiv=refresh content=\"5; URL=timepro.cgi?tmenu=wizard&config=auto&step=2&ifname=%s\">";
LABEL_28:
      v39 = (char *)&v343;
      return printf(v38, v39);
    }
    if ( !strcmp(&v334, "detected") )
    {
      get_wan_type(&v336, &v339);
      if ( !strcmp(&v339, "pppoe") )
        v38 = "<meta http-equiv=refresh content=\"3; URL=timepro.cgi?tmenu=wizard&config=auto&step=3&ifname=%s\">";
      else
        v38 = "<meta http-equiv=refresh content=\"3; URL=timepro.cgi?tmenu=wizard&config=auto&step=5&ifname=%s\">";
      goto LABEL_28;
    }
    result = strcmp(&v334, "timeout");
    if ( result )
      return result;
    v40 = istatus_get_intvalue_direct((int)"lanwan_samenetwork");
    v41 = &v343;
    if ( v40 == 1 )
      v42 = (char *)7;
    else
      v42 = (char *)6;
    v43 = "<meta http-equiv=refresh content=\"3; URL=timepro.cgi?tmenu=wizard&config=auto&step=%d&ifname=%s\">";
    return printf(v43, v42, v41);
  }
  if ( !strcmp(&v338, "3") )
  {
    get_value(v1, "ifname", &v339, 16);
    if ( !get_value(v1, "auth", &v343, 16) )
      strcpy((char *)&v343, "success");
    puts("<form method=get action=timepro.cgi name=wizard>");
    puts("<input type=hidden name=tmenu value=wizard>");
    puts("<input type=hidden name=config value=auto>");
    puts("<input type=hidden name=step>");
    printf("<input type=hidden name=ifname value=%s>\n", &v339);
    puts("<input type=hidden name=pppoe_start value=1>");
    if ( !strcmp((const char *)&v343, "fail") )
    {
      v46 = get_ux_text_common(1616, v44);
      v47 = 1618;
    }
    else
    {
      v46 = get_ux_text_common(1617, v44);
      v47 = 1614;
    }
    v48 = get_ux_text_common(v47, v45);
    print_wizard_top(v46, v48);
    puts((const char *)&unk_B00DD);
    if ( !strcmp((const char *)&v343, "fail") )
      v50 = 1610;
    else
      v50 = 1611;
    v51 = get_ux_text_common(v50, v49);
    printf("%s<br>", v51);
    v53 = get_ux_text_common(1612, v52);
    printf("%s<br>", v53);
    v55 = get_ux_text_common(1613, v54);
    printf("%s<br><br>", v55);
    printf("<table class=navicontent_table >");
    printf("<tr><td width=100>");
    v57 = get_ux_text_common(424, v56);
    printf("%s", v57);
    printf("</td><td>");
    printf("<input type=text name=\"userid\" style=\"width:150\" maxlength=63>");
    printf("</td></tr>");
    printf("<tr><td width=100>");
    v59 = get_ux_text_common(941, v58);
    printf("%s", v59);
    printf("</td><td>");
    printf("<input type=password name=\"passwd\" style=\"width:150\" maxlength=32>");
    printf("</td></tr>");
    printf("</table>");
    v61 = get_ux_text_common(1615, v60);
    printf("<span class=gray_text>%s</span>", v61);
    print_blank_line(1, 2);
    puts((const char *)&unk_B01AA);
    v63 = get_ux_text_common(1646, v62);
    printf("<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage(1);\">", v63);
    v65 = get_ux_text_common(1645, v64);
    v66 = "<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage(4);\">";
    goto LABEL_189;
  }
  if ( !strcmp(&v338, "4") )
  {
    if ( !get_value(v1, "ifname", &v330, 32) )
    {
      v67 = "Debug:auto_step4: No ifname..";
      return puts(v67);
    }
    eth2wan(&v330, &v343);
    if ( get_value(v1, "count", &s1, 32) )
      v68 = atoi(&s1);
    else
      v68 = 0;
    if ( get_value(v1, "pppoe_start", &s1, 32) && !strcmp(&s1, "1") )
    {
      read_pppoe_option(&v343, &v332);
      get_value(v1, "userid", &v332, 128);
      get_value(v1, "passwd", &v333, 128);
      set_default_gateway("br0", 0);
      set_default_gateway(&v330, 0);
      set_ifconfig(&v330);
      save_pppoe_option(&v343, &v332);
      v69 = pppoe_stop(&v343);
      signal_update(v69);
    }
    puts("<form method=get action=timepro.cgi name=wizard>");
    puts("<input type=hidden name=tmenu value=wizard>");
    puts("<input type=hidden name=config value=auto>");
    puts("<input type=hidden name=step>");
    printf("<input type=hidden name=ifname value=%s>\n", &v330);
    v71 = get_ux_text_common(1622, v70);
    v72 = print_wizard_top(v71, 0);
    str(v72);
    puts("<td height=190 class=\"wizardbody_td\">");
    v74 = get_ux_text_common(1619, v73);
    printf("%s<br>\n", v74);
    v76 = get_ux_text_common(1620, v75);
    printf("%s<br>\n", v76);
    v78 = get_ux_text_common(1621, v77);
    printf("%s<br>\n", v78);
    v79 = print_blank_line(1, 2);
    str(v79);
    puts("<td class=wizardbottom_td align=right>");
    v81 = get_ux_text_common(1646, v80);
    printf("<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage(3);\">", v81);
    v83 = get_ux_text_common(1645, v82);
    printf("<input type=button class=navi_bt name=next value='%s' disabled>", v83);
    v84 = puts("</td>");
    etr(v84);
    puts("</form>");
    v85 = get_pppoe_status(&v343);
    if ( v85 == 4 )
    {
      if ( check_wan_connected(&v343) )
      {
        v38 = "<meta http-equiv=refresh content=\"3; URL=timepro.cgi?tmenu=wizard&config=auto&step=5&ifname=%s\">";
LABEL_63:
        v39 = &v330;
        return printf(v38, v39);
      }
    }
    else
    {
      if ( v85 == 6 )
      {
        v38 = "<meta http-equiv=refresh content=\"3; URL=timepro.cgi?tmenu=wizard&config=auto&step=3&ifname=%s&auth=fail\">";
        goto LABEL_63;
      }
      if ( v85 == 7 )
      {
LABEL_62:
        v38 = "<meta http-equiv=refresh content=\"3; URL=timepro.cgi?tmenu=wizard&config=auto&step=6&ifname=%s&timeout=pppoe\">";
        goto LABEL_63;
      }
    }
    v41 = (int *)(v68 + 1);
    if ( 3 * (v68 + 1) <= 30 )
    {
      v43 = "<meta http-equiv=refresh content=\"3; URL=timepro.cgi?tmenu=wizard&config=auto&step=4&ifname=%s&count=%d\">";
      v42 = &v330;
      return printf(v43, v42, v41);
    }
    goto LABEL_62;
  }
  if ( !strcmp(&v338, "5") )
  {
    wizard_api_set_mode(0);
    get_value(v1, "ifname", &v330, 32);
    eth2wan(&v330, &v339);
    get_wan_type(&v339, &v343);
    puts("<form method=get action=timepro.cgi name=wizard>");
    puts("<input type=hidden name=tmenu value=wizard>");
    puts("<input type=hidden name=config value=auto>");
    puts("<input type=hidden name=step>");
    puts("<input type=hidden name=nextstep value=finish>");
    v87 = get_ux_text_common(1625, v86);
    if ( !strcmp((const char *)&v343, "pppoe") )
      v89 = 1627;
    else
      v89 = 1623;
    v90 = get_ux_text_common(v89, v88);
    print_wizard_top(v87, v90);
    puts((const char *)&unk_B041A);
    if ( !strcmp((const char *)&v343, "pppoe") )
      v92 = 1628;
    else
      v92 = 1624;
    v93 = (const char *)get_ux_text_common(v92, v91);
    v94 = printf(v93);
    br(v94);
    v96 = (const char *)get_ux_text_common(1626, v95);
    v97 = printf(v96);
    v98 = br(v97);
    br(v98);
    get_wan_ipinfo(&v339, &v336, &v332, &s1);
    get_domain_name_server(&dest, &v334);
    printf("<table class=wizard_content_table>");
    v100 = get_ux_text_common(247, v99);
    printf("<tr><td width=100px >%s</td><td>%s</td></tr>", v100, &v336);
    v102 = get_ux_text_common(1118, v101);
    printf("<tr><td>%s</td><td>%s</td></tr>", v102, &v332);
    v104 = get_ux_text_common(381, v103);
    printf("<tr><td>%s</td><td>%s</td></tr>", v104, &s1);
    v106 = get_ux_text_common(258, v105);
    printf("<tr><td>%s</td><td>%s</td></tr>", v106, &dest);
    v108 = get_ux_text_common(1079, v107);
    printf("<tr><td>%s</td><td>%s</td></tr>", v108, &v334);
    v109 = printf("</table>");
    br(v109);
    v111 = (const char *)get_ux_text_common(1649, v110);
    printf(v111);
    v112 = print_blank_line(1, 2);
    str(v112);
    puts("<td class=\"wizardbottom_td\" align=right>");
    v114 = get_ux_text_common(1648, v113);
    printf("<input type=button name=retry value='%s' onclick='WizardGotoPage(0);'>\n", v114);
    v116 = get_ux_text_common(1647, v115);
    v117 = "<input type=button name=next value='%s' onclick=\"WizardGotoPage('save');\">\n";
    goto LABEL_141;
  }
  if ( !strcmp(&v338, "6") )
  {
    wizard_api_set_mode(0);
    puts("<form method=get action=timepro.cgi name=wizard>");
    puts("<input type=hidden name=tmenu value=wizard>");
    puts("<input type=hidden name=config value=auto>");
    puts("<input type=hidden name=step>");
    get_value(v1, "ifname", &v336, 8);
    printf("<input type=hidden name=ifname value=%s>\n", &v336);
    strcpy(&v330, "");
    get_value(v1, "timeout", &v330, 32);
    if ( !strcmp(&v330, "pppoe") )
    {
      v120 = get_ux_text_common(1629, v118);
      v121 = 1632;
    }
    else
    {
      v120 = get_ux_text_common(1633, v118);
      v121 = 1634;
    }
    v122 = get_ux_text_common(v121, v119);
    v123 = print_wizard_top(v120, v122);
    str(v123);
    puts("<td height=190 class=\"wizardbody_td\">");
    if ( !strcmp(&v330, "pppoe") )
    {
      v125 = (const char *)get_ux_text_common(1630, v124);
      v126 = printf(v125);
      br(v126);
      v128 = 1631;
    }
    else
    {
      v129 = (const char *)get_ux_text_common(1635, v124);
      v130 = printf(v129);
      br(v130);
      v128 = 1636;
    }
    v131 = (const char *)get_ux_text_common(v128, v127);
    v132 = printf(v131);
    br(v132);
    v133 = printf("</td>");
    etr(v133);
    v134 = print_blank_line(1, 2);
    str(v134);
    puts("<td height=190 class=wizardbottom_td align=right>");
    v136 = get_ux_text_common(1648, v135);
    printf("<input type=button name=retry value='%s' onclick='WizardGotoPage(0)'>\n", v136);
    v138 = get_ux_text_common(1644, v137);
    v139 = "<input type=button name=exit value='%s' onclick='self.close();'>\n";
    goto LABEL_84;
  }
  if ( !strcmp(&v338, "7") )
  {
    get_localbroadaddr("br0", &v334);
    v140 = inet_addr(&v334);
    v141 = inet_ntoa((struct in_addr)__rev(__rev(v140) + 2));
    strcpy(&dest, v141);
    wizard_api_set_mode(0);
    puts("<form method=get action=timepro.cgi name=wizard>");
    puts("<input type=hidden name=tmenu value=wizard>");
    puts("<input type=hidden name=smenu value=>");
    puts("<input type=hidden name=commit value=>");
    puts("<input type=hidden name=wizard value=1>");
    puts("<input type=hidden name=config value=auto>");
    puts("<input type=hidden name=step>");
    get_value(v1, "ifname", &v336, 8);
    printf("<input type=hidden name=ifname value=%s>\n", &v336);
    get_netaddr("br0", &v339);
    printf("<input type=hidden name=\"wan1subnet\" value=\"%s\">\n", &v339);
    strcpy(&v330, "");
    get_value(v1, "timeout", &v330, 32);
    v143 = get_ux_text_common(1639, v142);
    print_wizard_top(v143, 0);
    v144 = get_ifconfig((int)"br0", (int)&s1, (int)&v332);
    str(v144);
    puts("<td height=190 class=\"wizardbody_td\">");
    v146 = (const char *)get_ux_text_common(1637, v145);
    printf(v146);
    v148 = (const char *)get_ux_text_common(1638, v147);
    v149 = printf(v148);
    br(v149);
    printf(
      "<input type=checkbox onclick=\"if(this.checked == true) SetIP('ip','%s'); else SetIP('ip','%s');\">",
      &dest,
      &s1);
    v151 = (const char *)get_ux_text_common(500, v150);
    printf(v151);
    v152 = puts("<table>");
    str(v152);
    v154 = get_ux_text_common(428, v153);
    printf("<td>%s</td>", v154);
    puts("<td>");
    print_html_ip_address((int)"ip", &s1, 1);
    v155 = printf("</td>");
    v156 = etr(v155);
    str(v156);
    v158 = get_ux_text_common(1118, v157);
    printf("<td>%s</td>", v158);
    puts("<td>");
    print_html_ip_address((int)"sm", &v332, 1);
    v159 = puts("</td>");
    etr(v159);
    printf("</table>");
    v160 = printf("</td>");
    etr(v160);
    v161 = print_blank_line(1, 2);
    str(v161);
    printf("<td class=wizardbottom_td align=right>");
    v163 = get_ux_text_common(1646, v162);
    printf("<input type=button class=navi_bt name=prev value='%s' onclick=\"WizardGotoPage('2');\">", v163);
    v138 = get_ux_text_common(1645, v164);
    v139 = "<input type=button class=navi_bt name=next value='%s' onclick=\"document.wizard.step.value=8; CheckLanIPChang"
           "e(document.wizard);\">";
LABEL_84:
    printf(v139, v138);
    v165 = printf("</td>");
    return etr(v165);
  }
  result = strcmp(&v338, "8");
  if ( !result )
    result = sub_4C94C(v1, v166);
  return result;
}
// 1040C: using guessed type int __fastcall get_hw_value(_DWORD, _DWORD, _DWORD);
// 10418: using guessed type int __fastcall get_link_status(_DWORD, _DWORD);
// 104E4: using guessed type int __fastcall set_dhclient_block_private_ip(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 106DC: using guessed type int __fastcall get_wan_type(_DWORD, _DWORD);
// 10754: using guessed type int __fastcall get_ip_value(_DWORD, _DWORD, _DWORD);
// 108F8: using guessed type int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD);
// 10958: using guessed type int __fastcall wizard_api_set_mode(_DWORD);
// 10C10: using guessed type int __fastcall pppoe_stop(_DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);
// 10D18: using guessed type int __fastcall get_netaddr(_DWORD, _DWORD);
// 10DA8: using guessed type int __fastcall dhclient_stop(_DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 10FE8: using guessed type int __fastcall get_wan_ipinfo(_DWORD, _DWORD, _DWORD, _DWORD);
// 11180: using guessed type int __fastcall set_wan_type(_DWORD, _DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 112AC: using guessed type int __fastcall set_pppoe_status(_DWORD, _DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 116C0: using guessed type int __fastcall get_localbroadaddr(_DWORD, _DWORD);
// 11738: using guessed type int __fastcall read_pppoe_option(_DWORD, _DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 119A8: using guessed type int __fastcall check_wan_connected(_DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// 11A44: using guessed type int __fastcall get_domain_name_server(_DWORD, _DWORD);
// 11B10: using guessed type int __fastcall set_wansetup_status(_DWORD, _DWORD);
// 11B1C: using guessed type int __fastcall eth2wan(_DWORD, _DWORD);
// 11B88: using guessed type int __fastcall wizard_api_set_status(_DWORD, _DWORD);
// 11C3C: using guessed type int __fastcall wizard_api_get_status(_DWORD, _DWORD);
// 11EA0: using guessed type int __fastcall set_ifconfig(_DWORD);
// 11F00: using guessed type int __fastcall set_default_gateway(_DWORD, _DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);
// 11FF0: using guessed type int __fastcall save_pppoe_option(_DWORD, _DWORD);
// 1205C: using guessed type int __fastcall get_pppoe_status(_DWORD);

//----- (0004EEC0) --------------------------------------------------------
int __fastcall setDNSSettings(int a1)
{
  int v1; // r5@1
  int result; // r0@1
  char *v3; // r0@8
  char *v4; // r1@8
  int v5; // r0@26
  char cp; // [sp+4h] [bp-1ECh]@15
  char v7; // [sp+84h] [bp-16Ch]@15
  char v8; // [sp+140h] [bp-B0h]@3
  char v9; // [sp+180h] [bp-70h]@1
  char dest; // [sp+1A0h] [bp-50h]@13
  char v11; // [sp+1B4h] [bp-3Ch]@6
  char v12; // [sp+1C8h] [bp-28h]@6
  char v13; // [sp+1DCh] [bp-14h]@10
  char v14; // [sp+1F0h] [bp+0h]@1
  char v15; // [sp+200h] [bp+10h]@1

  v1 = a1;
  get_value(a1, "ifname", &v15, 16);
  eth2wan(&v15, &v14);
  result = get_value(v1, "wan_type", &v9, 32);
  if ( !result )
    return result;
  if ( strcmp(&v9, "dynamic") )
  {
    if ( !strcmp(&v9, "pppoe") )
    {
      read_pppoe_option(&v14, &cp);
      get_value(v1, "userid", &cp, 128);
      get_value(v1, "passwd", &v7, 128);
      save_pppoe_option(&v14, &cp);
    }
    else if ( !strcmp(&v9, "static") )
    {
      get_value(v1, "ip", &v13, 20);
      get_value(v1, "sm", &v12, 20);
      get_value(v1, "gw", &v11, 20);
      get_value(v1, "fdns", &dest, 20);
      get_value(v1, "sdns", &cp, 20);
      set_wan_ipconfig(&v15, &v13, &v12, &v11);
      set_ifconfig(&v15);
      if ( check_default_gateway(&v11, &v13, &v12) )
      {
        set_default_gateway("br0", 0);
        set_default_gateway(&v15, 0);
      }
      else
      {
        set_default_gateway("br0", 0);
        if ( set_default_gateway(&v15, &v11) )
          set_default_gateway2(&v15, &v13, &v12, &v11);
      }
      if ( inet_addr(&dest) == -1 )
        strcpy(&dest, "");
      if ( inet_addr(&cp) == -1 )
        strcpy(&cp, "");
      dhcpd_set_dns(&dest, &cp);
      set_domain_name_server(&dest, &cp, "eth0");
      set_dns_shadow(&v15, &v9, &dest, &cp);
    }
    goto LABEL_26;
  }
  if ( !get_value(v1, "hw_conf", &v8, 64) )
  {
LABEL_26:
    set_wan_type(&v14, &v9);
    pppoe_stop(&v14);
    v5 = dhclient_stop(&v14);
    return signal_update(v5);
  }
  if ( !strcmp(&v8, "auto") || !strcmp(&v8, "manual") )
  {
    get_hwaddr_kernel(&v15, &v12);
    get_value(v1, "hw_addr", &v11, 20);
    if ( !strcmp(&v11, &v12) || check_invalid_hwaddr(&v11) )
      goto LABEL_13;
    set_hwaddr_kernel(&v15, &v11, 1);
    v3 = &v15;
    v4 = &v11;
  }
  else
  {
    if ( strcmp(&v8, "noclone") )
      goto LABEL_13;
    get_hwaddr_org(&v15, &v13);
    get_hwaddr_kernel(&v15, &v12);
    if ( !strcmp(&v13, &v12) )
      goto LABEL_13;
    set_hwaddr_kernel(&v15, &v13, 1);
    v3 = &v15;
    v4 = &v13;
  }
  set_hwaddr_cloned(v3, v4);
LABEL_13:
  strcpy(&dest, "");
  get_value(v1, "private", &dest, 8);
  strcmp(&dest, "on");
  set_dhclient_block_private_ip(&v15);
  goto LABEL_26;
}
// 104E4: using guessed type int __fastcall set_dhclient_block_private_ip(_DWORD);
// 104FC: using guessed type int __fastcall dhcpd_set_dns(_DWORD, _DWORD);
// 107C0: using guessed type int __fastcall get_hwaddr_kernel(_DWORD, _DWORD);
// 107F0: using guessed type int __fastcall get_hwaddr_org(_DWORD, _DWORD);
// 1085C: using guessed type int __fastcall set_dns_shadow(_DWORD, _DWORD, _DWORD, _DWORD);
// 109DC: using guessed type int __fastcall set_hwaddr_cloned(_DWORD, _DWORD);
// 10C10: using guessed type int __fastcall pppoe_stop(_DWORD);
// 10DA8: using guessed type int __fastcall dhclient_stop(_DWORD);
// 10EE0: using guessed type int __fastcall check_invalid_hwaddr(_DWORD);
// 10F70: using guessed type int __fastcall set_default_gateway2(_DWORD, _DWORD, _DWORD, _DWORD);
// 11180: using guessed type int __fastcall set_wan_type(_DWORD, _DWORD);
// 114A4: using guessed type int __fastcall set_hwaddr_kernel(_DWORD, _DWORD, _DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 11738: using guessed type int __fastcall read_pppoe_option(_DWORD, _DWORD);
// 11AC8: using guessed type int __fastcall set_wan_ipconfig(_DWORD, _DWORD, _DWORD, _DWORD);
// 11B1C: using guessed type int __fastcall eth2wan(_DWORD, _DWORD);
// 11EA0: using guessed type int __fastcall set_ifconfig(_DWORD);
// 11F00: using guessed type int __fastcall set_default_gateway(_DWORD, _DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);
// 11FD8: using guessed type int __fastcall check_default_gateway(_DWORD, _DWORD, _DWORD);
// 11FF0: using guessed type int __fastcall save_pppoe_option(_DWORD, _DWORD);
// 1202C: using guessed type int __fastcall set_domain_name_server(_DWORD, _DWORD, _DWORD);

//----- (0004F2E4) --------------------------------------------------------
int __fastcall print_wizard(int a1)
{
  int v1; // r4@1

  v1 = a1;
  puts("<body bgcolor=#dedede style=\"margin-left:0; margin-right:0; margin-top:0px; margin-bottom:0;\" >");
  puts("<table width=550 height=290 class=wizardtable_td bgcolor=#ffffff >");
  sub_4CCE0(v1);
  printf("</table>");
  return puts("</body>");
}

//----- (0004F32C) --------------------------------------------------------
int sub_4F32C()
{
  puts("<style type=\"text/css\">");
  puts(".advertise_main_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".advertise_main_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".advertise_main_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".advertise_main_p {");
  puts("\tpadding:0 0 0 5px; display:inline-block;");
  puts("\tvertical-align:middle; margin:0;");
  puts("}");
  puts(".advertise_main_span {");
  puts("\tdisplay:inline-block; vertical-align:middle;");
  puts("}");
  puts(".advertise_main_button {");
  puts("\tpadding:0 1px 0 1px; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".advertise_main_td input[type=checkbox], .advertise_main_td input[type=radio] {");
  puts("display:inline-block; vertical-align:middle;");
  puts("}");
  puts("#advertise_div_msg p {");
  puts("margin:5px 0 5px 15px; text-align:left;");
  puts("}");
  puts(".advertise_ellipsis {");
  puts("text-overflow:ellipsis; overflow:hidden; white-space:nowrap; text-align:left;");
  puts("}");
  printf("input[type=\"text\"] {border:1px #CCC solid;}");
  printf("input[type=\"password\"] {border:1px #CCC solid;}");
  printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td {cursor:default;}");
  return printf("</style>");
}

//----- (0004F4C8) --------------------------------------------------------
signed int __fastcall sub_4F4C8(const char *a1)
{
  const char *v1; // r6@1
  size_t v2; // r4@1
  size_t v3; // r5@1

  v1 = a1;
  v2 = 0;
  v3 = strlen(a1);
  while ( 1 )
  {
    if ( v2 >= v3 )
      return 0;
    if ( strchr("&;|`\\><\"'`", v1[v2]) )
      break;
    ++v2;
  }
  return 1;
}

//----- (0004F514) --------------------------------------------------------
char *__fastcall sub_4F514(int a1)
{
  int v1; // r5@1
  char *result; // r0@1
  int v3; // r6@4
  int v4; // r0@8
  int v5; // r0@9
  char *v6; // r0@13
  char *v7; // r0@19
  char *v8; // r0@25
  char *v9; // r0@31
  int v10; // r0@35
  int v11; // r0@35
  int v12; // r0@37
  int v13; // [sp+0h] [bp-418h]@1
  char v14; // [sp+200h] [bp-218h]@6
  char v15; // [sp+300h] [bp-118h]@6

  v1 = a1;
  result = (char *)get_value_post(a1, "act", &v13, 32);
  if ( !result )
    return result;
  result = (char *)strcmp((const char *)&v13, "url_redir");
  if ( result )
    return result;
  result = (char *)get_value_post(v1, "url_redir", &v13, 512);
  if ( !result )
    return result;
  v3 = atoi((const char *)&v13);
  result = (char *)get_value_post(v1, "url_redir_url", &v13, 512);
  if ( !result )
    return result;
  result = (char *)sub_4F4C8((const char *)&v13);
  if ( result )
    return result;
  sf_strncpy(&v15, &v13, 63);
  sf_strncpy(&v14, &v15, 63);
  strtoupper(&v14);
  result = strstr(&v14, "<SCRIPT>");
  if ( result )
    return result;
  set_url_redirect_option(v3, &v15);
  result = (char *)get_value_post(v1, &unk_B0FD1, &v13, 512);
  if ( !result )
    return result;
  v4 = atoi((const char *)&v13);
  set_url_redirect_autoconfirm(v4);
  if ( get_value_post(v1, "cycle", &v13, 512) )
    v5 = atoi((const char *)&v13);
  else
    v5 = -1;
  set_url_redirect_cycle(v5);
  if ( !get_value_post(v1, "whitelist", &v13, 512) || sub_4F4C8((const char *)&v13) )
  {
    v6 = &v15;
LABEL_16:
    strcpy(v6, "");
    goto LABEL_17;
  }
  sf_strncpy(&v15, &v13, 128);
  sf_strncpy(&v14, &v15, 128);
  strtoupper(&v14);
  if ( strstr(&v14, "<SCRIPT>") )
  {
    v6 = &v15;
    goto LABEL_16;
  }
LABEL_17:
  set_url_redirect_whitelist(&v15);
  if ( !get_value_post(v1, "btnmsg", &v13, 512) || check_unpermitted_chars(&v13) )
  {
    v7 = &v15;
LABEL_22:
    strcpy(v7, "");
    goto LABEL_23;
  }
  sf_strncpy(&v15, &v13, 255);
  sf_strncpy(&v14, &v15, 255);
  strtoupper(&v14);
  if ( strstr(&v14, "<SCRIPT>") )
  {
    v7 = &v15;
    goto LABEL_22;
  }
LABEL_23:
  set_url_redirect_btnmsg(&v15);
  if ( !get_value_post(v1, "usermsg", &v13, 512) || check_unpermitted_chars(&v13) )
  {
    v8 = &v15;
LABEL_28:
    strcpy(v8, "");
    goto LABEL_29;
  }
  sf_strncpy(&v15, &v13, 255);
  sf_strncpy(&v14, &v15, 255);
  strtoupper(&v14);
  if ( strstr(&v14, "<SCRIPT>") )
  {
    v8 = &v15;
    goto LABEL_28;
  }
LABEL_29:
  set_url_redirect_usermsg(&v15);
  if ( !get_value_post(v1, "usermsg2", &v13, 512) || check_unpermitted_chars(&v13) )
  {
    v9 = &v15;
LABEL_34:
    strcpy(v9, "");
    goto LABEL_35;
  }
  sf_strncpy(&v15, &v13, 255);
  sf_strncpy(&v14, &v15, 255);
  strtoupper(&v14);
  if ( strstr(&v14, "<SCRIPT>") )
  {
    v9 = &v15;
    goto LABEL_34;
  }
LABEL_35:
  v10 = set_url_redirect_usermsg2(&v15);
  v11 = clear_url_redirection(v10);
  if ( v3 )
    v11 = init_url_redirection(0);
  v12 = signal_save(v11);
  return (char *)signal_update(v12);
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10AFC: using guessed type int __fastcall clear_url_redirection(_DWORD);
// 10B44: using guessed type int __fastcall set_url_redirect_cycle(_DWORD);
// 10B8C: using guessed type int __fastcall set_url_redirect_autoconfirm(_DWORD);
// 10D9C: using guessed type int __fastcall init_url_redirection(_DWORD);
// 11000: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11300: using guessed type int __fastcall strtoupper(_DWORD);
// 11498: using guessed type int __fastcall set_url_redirect_btnmsg(_DWORD);
// 1166C: using guessed type int __fastcall set_url_redirect_usermsg(_DWORD);
// 11B70: using guessed type int __fastcall set_url_redirect_usermsg2(_DWORD);
// 11CFC: using guessed type int __fastcall set_url_redirect_option(_DWORD, _DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);
// 12014: using guessed type int __fastcall set_url_redirect_whitelist(_DWORD);

//----- (0004F8CC) --------------------------------------------------------
int __fastcall sub_4F8CC(int a1)
{
  int v1; // r4@1
  int result; // r0@1
  char *v3; // r1@8
  int v4; // r0@10
  int v5; // r6@11
  int v6; // r0@16
  char v7; // [sp+8h] [bp-118h]@1
  char s; // [sp+88h] [bp-98h]@6
  char v9; // [sp+C8h] [bp-58h]@4
  char v10; // [sp+E8h] [bp-38h]@3

  v1 = a1;
  result = get_value_post(a1, "act", &v7, 32);
  if ( !result )
    return result;
  if ( !strcmp(&v7, "add") )
  {
    result = get_ip_value_post(v1, "free_sip", &v10);
    if ( result )
    {
      if ( !get_ip_value_post(v1, "free_eip", &v9) )
        strcpy(&v9, &v10);
      snprintf(&s, 0x40u, "%s-%s", &v10, &v9);
      memset(&v7, 0, 0x80u);
      get_value_post(v1, &unk_B1017, &v7, 128);
      result = check_unpermitted_chars(&v7);
      if ( !result )
      {
        if ( v7 )
          v3 = &v7;
        else
          v3 = "";
        v4 = add_url_redir_freedevice(&s, v3);
LABEL_16:
        v6 = signal_save(v4);
        return signal_update(v6);
      }
    }
  }
  else
  {
    result = strcmp(&v7, "del");
    v5 = result;
    if ( !result )
    {
      while ( 1 )
      {
        v4 = get_value_array_post(v1, "delchk");
        if ( !v4 )
          break;
        if ( !check_unpermitted_chars(&v10) )
        {
          ++v5;
          remove_url_redir_freedevice(&v10);
        }
      }
      goto LABEL_16;
    }
  }
  return result;
}
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 11000: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 1163C: using guessed type int __fastcall remove_url_redir_freedevice(_DWORD);
// 11708: using guessed type int __fastcall add_url_redir_freedevice(_DWORD, _DWORD);
// 11A8C: using guessed type int __fastcall get_value_array_post(_DWORD, _DWORD);
// 11CF0: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);

//----- (0004FA54) --------------------------------------------------------
int __fastcall print_iframe_advertiseexlist(int a1, int a2)
{
  int v2; // r4@1
  signed int v3; // r4@1
  char *v4; // r1@3
  char *v5; // r1@5
  char *v6; // r1@8
  char *v7; // r1@11
  const char *v8; // r1@16
  int v9; // r0@20
  int v11; // [sp+0h] [bp-1E8h]@2
  char v12; // [sp+100h] [bp-E8h]@3
  char v13; // [sp+140h] [bp-A8h]@2
  char v14; // [sp+180h] [bp-68h]@6
  char v15; // [sp+1A0h] [bp-48h]@4

  v2 = a2;
  sub_4F32C();
  sub_4F8CC(v2);
  v3 = 0;
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0;\">");
  printf("<table class=\"v3_table advertise_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"advertisefreedevice_fm\">");
  printf("<COL width=\"30\"><COL width=\"250\"><COL width=\"300\"><COL width=\"30\"><COL width=\"%%%%\">");
  do
  {
    if ( get_url_redir_freedevice(v3, &v13, &v11) < 0 )
      break;
    sf_strncpy(&v12, &v13, 64);
    v4 = strtok(&v13, "-");
    if ( v4 )
      sf_strncpy(&v15, v4, 32);
    v5 = strtok(0, "-");
    if ( v5 )
      sf_strncpy(&v14, v5, 32);
    sf_strncpy(&v13, &v12, 64);
    v6 = v3++ & 1 ? "F7F7F7" : "FFFFFF";
    printf(
      "<tr class=\"advertise_main_tr\" height=\"24\" style=\"background-color:#%s;\">\t\t\t<td class=\"advertise_main_td\">",
      v6);
    printf("<p class=\"advertise_main_p\">%d</p>", v3);
    printf("</td><td class=\"advertise_main_td\">");
    v7 = !strcmp(&v14, "0.0.0.0") ? &v15 : &v13;
    printf("<span class=\"advertise_main_span\">%s</span>", v7);
    printf("</td><td class=\"advertise_main_td\">");
    printf("<span class=\"advertise_main_span\">%s</span>", &v11);
    printf("</td><td class=\"advertise_main_td\" align=\"right\">");
    printf("<div>");
    printf("<input type=checkbox name=delchk value=\"%s\">", &v13);
    printf("</div>");
    printf("</td><td class=\"advertise_main_td\"></td></tr>");
  }
  while ( v3 != 10 );
  while ( v3 <= 3 )
  {
    if ( v3 & 1 )
      v8 = "F7F7F7";
    else
      v8 = "FFFFFF";
    ++v3;
    printf(
      "<tr class=\"advertise_main_tr\" height=\"24\" style=\"background-color:#%s;\">\t\t\t<td class=\"advertise_main_td\" colspan=\"5\">",
      v8);
    printf("</td></tr>");
  }
  printf("</form>");
  printf("</table>");
  printf("</BODY>");
  printf("<script>");
  v9 = puts("UnMaskIt(parent.document, 'apply_mask');");
  get_url_redir_freedevice_num(v9);
  printf("if(parent.window.setAddBtnDisable)parent.window.setAddBtnDisable(%s)");
  return printf("</script>");
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 11354: using guessed type int __fastcall get_url_redir_freedevice_num(_DWORD);
// 11BAC: using guessed type int __fastcall get_url_redir_freedevice(_DWORD, _DWORD, _DWORD);

//----- (0004FCB4) --------------------------------------------------------
int __fastcall print_iframe_hiddenadvertisesetup(int a1, int a2)
{
  sub_4F514(a2);
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_hiddenadvertisesetup\">");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  printf("UnMaskIt(parent.document, 'apply_mask');");
  return printf("</script>");
}

//----- (0004FD18) --------------------------------------------------------
int expertconf_advertise()
{
  char *v0; // r4@1
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r7@1
  int v4; // r1@1
  int v5; // r0@1
  char *v6; // r1@2
  int v7; // r1@4
  int v8; // r0@4
  char *v9; // r1@5
  int v10; // r1@7
  int v11; // r0@7
  int v12; // r1@7
  int v13; // r0@7
  int v14; // r1@7
  int v15; // r0@7
  int v16; // r0@7
  int v17; // r7@7
  int v18; // r1@7
  int v19; // r0@7
  int v20; // r1@7
  char *v21; // r5@8
  int v22; // r0@10
  int v23; // r1@10
  int v24; // r0@12
  int v25; // r0@12
  int v26; // r4@12
  int v27; // r1@12
  int v28; // r0@12
  int v29; // r1@13
  char *v30; // r5@15
  int v31; // r4@15
  int v32; // r1@15
  int v33; // r0@15
  int v34; // r1@17
  int v35; // r0@17
  int v36; // r1@17
  int v37; // r0@17
  int v38; // r1@17
  int v39; // r0@17
  int v40; // r1@17
  int v41; // r0@17
  int v42; // r1@17
  int v43; // r0@17
  int v44; // r1@17
  int v45; // r0@17
  int v46; // r1@17
  int v47; // r0@17
  int v48; // r1@17
  int v49; // r0@17
  int v50; // r1@17
  int v51; // r0@17
  void *v52; // r4@17
  int v53; // r1@17
  int v54; // r0@17
  int v55; // r1@17
  int v56; // r0@17
  int v57; // r1@17
  int v58; // r4@17
  int v59; // r1@17
  int v60; // r0@17
  int v61; // r1@17
  int v62; // r0@17
  int v63; // r1@17
  int v64; // r0@17
  int v65; // r1@17
  int v66; // r0@17
  int v67; // r1@17
  int v68; // r0@17
  int v69; // r1@17
  int v70; // r0@17
  void *v71; // r4@17
  int v72; // r1@17
  int v73; // r0@17
  int v74; // r0@17
  int v75; // r0@18
  int v76; // r0@20
  int v77; // r0@21
  void *v78; // r0@23
  void *v79; // r0@23
  int v80; // r1@23
  int v81; // r0@23
  int v82; // r1@23
  int v83; // r0@23
  void *v84; // r0@23
  int v85; // r1@23
  int v86; // r0@23
  void *v87; // r0@23
  int v88; // r1@23
  int v89; // r0@23
  void *v90; // r0@23
  int v91; // r1@23
  int v92; // r0@23
  int v94; // [sp+0h] [bp-340h]@15
  char v95; // [sp+100h] [bp-240h]@1
  char v96; // [sp+200h] [bp-140h]@1
  char v97; // [sp+300h] [bp-40h]@17
  char v98; // [sp+314h] [bp-2Ch]@17

  print_js_file((int)"expertconf", (int)"advertise");
  sub_4F32C();
  printf("<table class=\"v3_table advertise_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  puts("<form method=get action=timepro.cgi name=advertise_fm>");
  puts("<input type=hidden name=tmenu value=expertconf>");
  puts("<input type=hidden name=smenu value=advertise>");
  puts("<input type=hidden name=act value=>");
  printf("<COL width=\"105\"><COL width=\"100\"><COL width=\"100\"><COL width=\"337\">");
  printf("<tr class=\"advertise_main_tr\" height=\"24\" style=\"background-color:#E3E3E3; border-bottom:1px #CCC solid;\">\t\t<td class=\"advertise_main_td\" colspan=\"4\">");
  v0 = "checked";
  v2 = get_ux_text_common(169, v1);
  printf("<p class=\"advertise_main_p\">%s</p>", v2);
  printf("</td></tr>");
  v3 = get_url_redirect_option(&v96);
  get_url_redirect_whitelist(&v95);
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\">");
  v5 = get_ux_text_common(938, v4);
  printf("<p class=\"advertise_main_p\">%s</p>", v5);
  printf("</td><td class=\"advertise_main_td\">");
  if ( v3 )
    v6 = "checked";
  else
    v6 = "";
  printf("<input type=radio name=url_redir id=\"opertrue\" value=1 %s>", v6);
  v8 = get_ux_text_common(1104, v7);
  printf("<label for=\"opertrue\">%s</label>", v8);
  printf("</td><td class=\"advertise_main_td\">");
  if ( v3 )
    v9 = "";
  else
    v9 = "checked";
  printf("<input type=radio name=url_redir id=\"operfalse\"value=0 %s>", v9);
  v11 = get_ux_text_common(1111, v10);
  printf("<label for=\"operfalse\">%s</label>", v11);
  printf("</td><td class=\"advertise_main_td\">");
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\">");
  v13 = get_ux_text_common(12, v12);
  printf("<p class=\"advertise_main_p\">%s</p>", v13);
  printf("</td><td class=\"advertise_main_td\" colspan=\"3\">");
  v15 = get_ux_text_common(178, v14);
  printf(
    "<input type=text name=url_redir_url value=\"%s\" size=54 maxlength=128 placeholder=\"%s\" style=\"width:520px;\">\n",
    &v96,
    v15);
  v16 = printf("</td></tr>");
  v17 = get_url_redirect_autoconfirm(v16);
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\">");
  v19 = get_ux_text_common(173, v18);
  printf("<p class=\"advertise_main_p\">%s</p>", v19);
  printf("</td><td class=\"advertise_main_td\">");
  if ( v17 )
    v21 = "checked";
  else
    v21 = "";
  v22 = get_ux_text_common(1412, v20);
  printf(
    "<input type=radio id=\"autotrue\" name=url_redir_autoconfirm value=1 onclick='AutoConfirmAdvertise(1);' %s>\t\t<labe"
    "l for=\"autotrue\">%s</label>",
    v21,
    v22);
  printf("</td><td class=\"advertise_main_td\">");
  if ( v17 )
    v0 = "";
  v24 = get_ux_text_common(926, v23);
  printf(
    "<input type=radio id=\"autofalse\" name=url_redir_autoconfirm value=0 onclick='AutoConfirmAdvertise(0);'%s>\t\t<labe"
    "l for=\"autofalse\">%s</label>",
    v0,
    v24);
  printf("</td><td class=\"advertise_main_td\">");
  v25 = printf("</td></tr>");
  v26 = get_url_redirect_cycle(v25);
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\">");
  v28 = get_ux_text_common(176, v27);
  printf("<p class=\"advertise_main_p\">%s</p>", v28);
  printf("</td><td class=\"advertise_main_td\" colspan=\"3\">");
  printf("<span class=\"advertise_main_span\"><input type=text name=cycle size=3 maxlength=3");
  if ( v26 )
    printf(" value=%d>", v26);
  else
    putchar(62);
  v30 = "";
  v31 = get_ux_text_common(632, v29);
  v33 = get_ux_text_common(177, v32);
  printf((const char *)&unk_B1801, v31, v33);
  printf("</td></tr>");
  get_url_redirect_btnmsg(&v94);
  if ( v17 )
    v30 = "none";
  printf(
    "<tr id=\"confirm_btn\" class=\"advertise_main_tr\" height=\"24\" style=\"display:%s;\"><td class=\"advertise_main_td\">",
    v30);
  v35 = get_ux_text_common(174, v34);
  printf("<p class=\"advertise_main_p\">%s</p>", v35);
  printf("</td><td class=\"advertise_main_td\" colspan=\"3\">");
  v37 = get_ux_text_common(175, v36);
  printf(
    "<input type=text name=btnmsg value=\"%s\" size=54 maxlength=255 placeholder=\"%s\" style=\"width:520px;\">",
    &v94,
    v37);
  printf("</td></tr>");
  get_url_redirect_usermsg(&v94);
  printf(
    "<tr id=\"confirm_msg\" class=\"advertise_main_tr\" height=\"24\" style=\"display:%s;\"><td class=\"advertise_main_td\">",
    v30);
  v39 = get_ux_text_common(181, v38);
  printf("<p class=\"advertise_main_p\">%s</p>", v39);
  printf("</td><td class=\"advertise_main_td\" colspan=\"3\">");
  v41 = get_ux_text_common(182, v40);
  printf(
    "<input type=text name=usermsg value=\"%s\" size=54 maxlength=255 placeholder=\"%s\" style=\"width:520px;\">",
    &v94,
    v41);
  printf("</td></tr>");
  get_url_redirect_usermsg2(&v94);
  printf(
    "<tr id=\"allow_msg\" class=\"advertise_main_tr\" height=\"24\" style=\"display:%s;\"><td class=\"advertise_main_td\">",
    v30);
  v43 = get_ux_text_common(171, v42);
  printf("<p class=\"advertise_main_p\">%s</p>", v43);
  printf("</td><td class=\"advertise_main_td\" colspan=\"3\">");
  v45 = get_ux_text_common(172, v44);
  printf(
    "<input type=text name=usermsg2 value=\"%s\" size=54 maxlength=255 placeholder=\"%s\" style=\"width:520px;\">",
    &v94,
    v45);
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\">");
  printf("<p class=\"advertise_main_p\">White List</p>");
  printf("</td><td class=\"advertise_main_td\" colspan=\"3\">");
  v47 = get_ux_text_common(19, v46);
  printf(
    "<input type=text name=whitelist value=\"%s\" size=54 maxlength=128 placeholder=\"%s\" style=\"width:520px;\">",
    &v95,
    v47);
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"5\"><td class=\"advertise_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\">");
  v49 = get_ux_text_common(18, v48);
  printf(
    "<p class=\"advertise_main_p\" style=\"cursor:pointer;\" onclick=\"MaskIt(document, 'desc_mask');\"><font color=\"blu"
    "e\">%s</font></p>",
    v49);
  printf("</td><td class=\"advertise_main_td\" colspan=\"3\" align=\"right\" style=\"padding-right:22px;\">");
  printf("<button class=\"advertise_main_button\" style=\"width:45px;\" onclick=\"ApplyAdvertise('url_redir'); return ClickEventPropagater(event);\">");
  v51 = get_ux_text_common(35, v50);
  printf("<span class=\"advertise_main_span\">%s</span>", v51);
  printf("</button>");
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"5\"><td class=\"advertise_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  printf(
    "<tr id=\"confirm_desc\" class=\"advertise_main_tr\" height=\"48\" style=\"border-top:1px #CCC solid; display:%s;\">\t"
    "\t<td class=\"advertise_main_td\" colspan=\"4\">",
    v30);
  v52 = get_image_dir();
  v54 = get_ux_text_common(8, v53);
  printf(
    "<div style=\"height:20px; padding-left:5px;\"><img class=\"advertise_main_span\" src=\"/%s/warning.gif\" style=\"wid"
    "th:14px; height:14px;\">\t\t<span class=\"advertise_main_span\"><font color=\"gray\">%s</font></span></div>",
    v52,
    v54);
  v56 = get_ux_text_common(9, v55);
  printf(
    "<div style=\"height:20px; padding-left:19px;\"><span class=\"advertise_main_span\"><font color=\"gray\">%s</font></span></div>",
    v56);
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"24\" style=\"background-color:#E3E3E3; border-bottom:1px #CCC solid; border-top:1px #CCC solid;\">\t\t<td class=\"advertise_main_td\" colspan=\"4\">");
  v58 = get_ux_text_common(179, v57);
  v60 = get_ux_text_common(10, v59);
  printf("<span class=\"advertise_main_p\">%s <font color=\"gray\">%s</font></span>", v58, v60);
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"5\"><td class=\"advertise_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\" colspan=\"4\">");
  printf("<table class=\"v3_table advertise_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\" width=\"80\">");
  v62 = get_ux_text_common(428, v61);
  printf("<p class=\"advertise_main_p\">%s</p>", v62);
  printf("</td><td class=\"advertise_main_td\" width=\"305\">");
  get_ifconfig((int)"br0", (int)&v98, (int)&v97);
  print_html_ip_address((int)"free_sip", &v98, 3);
  printf(" ~ ");
  print_html_ip_address((int)"free_eip", &v98, 3);
  printf("</td><td class=\"advertise_main_td\" width=\"185\">");
  v64 = get_ux_text_common(11, v63);
  printf("<input type=text name=\"dev_desc\" maxlength=24 size=24 style=\"width:175px;\" placeholder=\"%s\">", v64);
  printf("</td><td class=\"advertise_main_td\" width=\"72\" align=\"right\">");
  printf("<button class=\"advertise_main_button\" style=\"width:45px; margin-right:22px;\" id=\"addbtn\" \t\tonclick=\"AddAdvertiseFreeDevice(); return ClickEventPropagater(event);\">");
  v66 = get_ux_text_common(6, v65);
  printf("<span class=\"advertise_main_span\">%s</span>", v66);
  printf("</button>");
  printf("</td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"5\" style=\"border-bottom:1px #CCC solid;\"><td class=\"advertise_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"24\" style=\"border-bottom:1px #CCC solid;\"><td class=\"advertise_main_td\" colspan=\"4\">");
  printf("<table class=\"v3_table advertise_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\" width=\"30\">");
  printf("</td><td class=\"advertise_main_td\" width=\"250\">");
  v68 = get_ux_text_common(442, v67);
  printf("<span class=\"advertise_main_span\">%s</span>", v68);
  printf("</td><td class=\"advertise_main_td\" width=\"300\">");
  v70 = get_ux_text_common(246, v69);
  printf("<span class=\"advertise_main_span\">%s</span>", v70);
  printf("</td><td class=\"advertise_main_td\" align=\"right\">");
  v71 = get_image_dir();
  v73 = get_ux_text_common(143, v72);
  printf(
    "<span class=\"advertise_main_span\" style=\"width:40px; cursor:pointer; margin-right:22px;\" onclick=\"DeleteAdverti"
    "seFreeDevice();\">\t\t<img src=\"/%s/minus_icon.gif\">%s</span>",
    v71,
    v73);
  printf("</td></tr></table>");
  printf("</td></tr>");
  v74 = printf("<tr class=\"advertise_main_tr\" height=\"96\" style=\"border-bottom:1px #CCC solid;\"><td class=\"advertise_main_td\" colspan=\"4\">");
  if ( is_mobile_agent(v74) )
  {
    print_div_m_str((int)"96", (int)"100%%", (int)"display:inline-block; *display:inline; zoom:1;");
    v75 = printf("<iframe name=\"advertiseexlist_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=advertiseexlist\"                         frameborder=no width=100%% height=96 align=center scrolling=auto></iframe>");
    print_div_m_etr(v75);
  }
  else
  {
    printf("<iframe name=\"advertiseexlist_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=advertiseexlist\"                         frameborder=no width=100%% height=96 align=center scrolling=auto></iframe>");
  }
  printf("</td></tr>");
  v76 = printf("</form></table>");
  if ( is_mobile_agent(v76) )
  {
    print_div_m_str((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v77 = printf("<iframe name=\"hiddenadvertisesetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenadvertisesetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    print_div_m_etr(v77);
  }
  else
  {
    printf("<iframe name=\"hiddenadvertisesetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenadvertisesetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v78 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v78);
  printf("</SPAN></td>");
  printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"advertise_div_msg\">\n");
  printf("</SPAN></td>");
  printf((const char *)&unk_7D215);
  printf("<DIV id=\"%s\" style=\"display:none;\" onclick=\"UnMaskIt(document, '%s');\">");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:91px; top:178px; width:460px; height:125px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"460\" height=\"125\">");
  puts("<tr height=\"22\"><td width=\"10\" align=\"center\" valign=\"middle\">");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v79 = get_image_dir();
  printf(
    "<img src=\"/%s/pf_square_icon.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v79);
  printf("</SPAN></td>");
  puts("<td width=\"450\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:left;\">");
  v81 = get_ux_text_common(13, v80);
  printf("<font color=\"gray\">%s</font>", v81);
  printf("</SPAN></td></tr>");
  puts("<tr height=\"22\"><td width=\"10\" align=\"center\" valign=\"middle\">");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  printf("</SPAN></td>");
  puts("<td width=\"450\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:left;\">");
  v83 = get_ux_text_common(14, v82);
  printf("<font color=\"gray\">%s</font>", v83);
  printf("</SPAN></td></tr>");
  puts("<tr height=\"22\"><td width=\"10\" align=\"center\" valign=\"middle\">");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v84 = get_image_dir();
  printf(
    "<img src=\"/%s/pf_square_icon.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v84);
  printf("</SPAN></td>");
  puts("<td width=\"450\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:left;\">");
  v86 = get_ux_text_common(15, v85);
  printf("<font color=\"gray\">%s</font>", v86);
  printf("</SPAN></td></tr>");
  puts("<tr height=\"22\"><td width=\"10\" align=\"center\" valign=\"middle\">");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v87 = get_image_dir();
  printf(
    "<img src=\"/%s/pf_square_icon.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v87);
  printf("</SPAN></td>");
  puts("<td width=\"450\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:left;\">");
  v89 = get_ux_text_common(16, v88);
  printf("<font color=\"gray\">%s</font>", v89);
  printf("</SPAN></td></tr>");
  puts("<tr height=\"22\"><td width=\"10\" align=\"center\" valign=\"middle\">");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v90 = get_image_dir();
  printf(
    "<img src=\"/%s/pf_square_icon.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v90);
  printf("</SPAN></td>");
  puts("<td width=\"450\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:left;\">");
  v92 = get_ux_text_common(17, v91);
  printf("<font color=\"gray\">%s</font>", v92);
  printf("</SPAN></td></tr>");
  return printf((const char *)&unk_7D21A);
}
// 10820: using guessed type int __fastcall get_url_redirect_option(_DWORD);
// 1088C: using guessed type int __fastcall get_url_redirect_usermsg(_DWORD);
// 11408: using guessed type int __fastcall get_url_redirect_whitelist(_DWORD);
// 1145C: using guessed type int __fastcall get_url_redirect_btnmsg(_DWORD);
// 1178C: using guessed type int __fastcall is_mobile_agent(_DWORD);
// 11864: using guessed type int __fastcall get_url_redirect_autoconfirm(_DWORD);
// 1199C: using guessed type int __fastcall get_url_redirect_usermsg2(_DWORD);
// 11C0C: using guessed type int __fastcall get_url_redirect_cycle(_DWORD);

//----- (00050730) --------------------------------------------------------
int __fastcall redirectForMobile(int a1)
{
  int v1; // r4@1
  const char *v2; // r0@1
  int v3; // r1@3
  int v4; // r0@4
  int v5; // r0@5
  int remoteAddr; // r0@5
  const char *wanType; // r0@6
  int twinIP; // r0@9
  const char *v9; // r0@12
  int v10; // r1@14
  const char *v11; // r0@15
  int v12; // r1@16
  const char *v13; // r0@17
  int v14; // r0@18
  const char *v15; // r0@20
  int v16; // r0@21
  const char *v17; // r0@22
  char *v18; // r0@24
  char *v19; // r4@24
  int v20; // r0@26
  char format; // [sp+8h] [bp-240h]@3
  char s; // [sp+108h] [bp-140h]@11
  char v24; // [sp+208h] [bp-40h]@5
  char hwaddr; // [sp+21Ch] [bp-2Ch]@10

  v1 = a1;
  puts("<html>");
  puts("<script type=\"text/javascript\">");
  puts("<!--");
  puts("function detectmob()");
  puts("{");
  puts("\tif(navigator.userAgent.match(/Android/i) || navigator.userAgent.match(/webOS/i) || navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/iPod/i) || navigator.userAgent.match(/BlackBerry/i) || navigator.userAgent.match(/Windows Phone/i))");
  puts("\t\treturn true;");
  puts("\telse");
  puts("\t\treturn false;");
  puts("}");
  puts("//-->");
  puts("</script>");
  v2 = (const char *)get_parameter_value(v1, "subpage");
  if ( v2 && !strcmp(v2, "allow") )
  {
    printf((const char *)&unk_B2B8F);
    printf("<span ID='str' style='color:#1e3269; font:normal normal bold 12px arial;'>");
    get_url_redirect_usermsg2(&format);
    if ( !format )
    {
      v4 = get_ux_text_common(170, v3);
      sf_strncpy(&format, v4, 256);
    }
    printf(&format);
    printf("</span>");
    printf("</td></tr></table>");
    puts("<script type=\"text/javascript\">");
    puts("<!--");
    puts("if(detectmob())");
    puts("{");
    puts("\tdocument.getElementById('str').style.fontSize='26px';");
    puts("}");
    puts("//-->");
    v5 = puts("</script>");
    remoteAddr = get_remote_addr(v5);
    sf_strncpy(&v24, remoteAddr, 20);
    if ( !strcmp(&v24, "Twin IP (WAN2)") )
    {
      wanType = "wan2";
    }
    else
    {
      if ( strncmp(&v24, "Twin IP", 7u) )
        goto LABEL_10;
      wanType = "wan1";
    }
    twinIP = get_twinip_wan_virtual_ip((int)wanType);
    sf_strncpy(&v24, twinIP, 20);
LABEL_10:
    if ( !get_hwaddr_by_ip((int)&v24, (int)&hwaddr) )
      return puts("</html>");
    snprintf(&s, 0x100u, "/sbin/iptables -t nat -D url_redir -m mac --mac-source %s -j RETURN", &hwaddr);
    system(&s);
    snprintf(&s, 0x100u, "/sbin/iptables -t nat -I url_redir -m mac --mac-source %s -j RETURN", &hwaddr);
    system(&s);
    snprintf(&s, 0x100u, (const char *)&unk_B2CE1, &hwaddr);
    system(&s);
    return puts("</html>");
  }
  v9 = (const char *)get_parameter_value(v1, "subpage");
  if ( v9 && !strcmp(v9, "frame2") )
  {
    puts("<form method=get action=urlredir.cgi name=misc_fm>");
    puts("<input type=hidden name=page value=url_redirect>");
    puts("<input type=hidden name=subpage value=allow>");
    printf((const char *)&unk_B2B8F);
    printf("<span ID='str' style='color:#1e3269; font:normal normal bold 12px arial;'>");
    get_url_redirect_usermsg(&format);
    if ( !format )
    {
      v11 = (const char *)get_ux_text_common(180, v10);
      strcpy(&format, v11);
    }
    printf(&format);
    get_url_redirect_btnmsg(&format);
    if ( !format )
    {
      v13 = (const char *)get_ux_text_common(78, v12);
      strcpy(&format, v13);
    }
    printf("</span><br>");
    printf("<input ID='bt' type=submit value='%s'>\n", &format);
    printf("</td></tr></table>");
    puts("</form>");
    puts("<script type=\"text/javascript\">");
    puts("<!--");
    puts("if(detectmob())");
    puts("{");
    puts("\tdocument.getElementById('str').style.fontSize='26px';");
    puts("\tdocument.getElementById('bt').style.fontSize='30px';");
    v14 = puts("}");
    if ( get_url_redirect_autoconfirm(v14) )
      printf("document.misc_fm.submit()");
    puts("//-->");
    v15 = "</script>";
  }
  else
  {
    get_url_redirect_option(&s);
    puts("<head>");
    v16 = puts("</head>");
    if ( get_url_redirect_autoconfirm(v16) )
      v17 = "<frameset rows='100%%,0%%' frameborder=0>\n";
    else
      v17 = "<frameset rows='90%%,10%%' frameborder=0>\n";
    printf(v17);
    v18 = strrchr(&s, 63);
    v19 = v18;
    if ( v18 && !strcmp(v18 + 1, "tx2useri2firstpage") )
    {
      *v19 = 0;
      v20 = get_remote_addr(0);
      sf_strncpy(&hwaddr, v20, 20);
      get_hwaddr_by_ip((int)&hwaddr, (int)&v24);
      get_hwaddr_kernel("br0", &format);
      printf("<frame src='%s?umac=%s&uip=%s&apmac=%s'>\n", &s, &v24, &hwaddr, &format);
    }
    else
    {
      printf("<frame src='%s'>\n", &s);
    }
    puts("<frame src='urlredir.cgi?page=url_redirect&subpage=frame2'>");
    v15 = "</frameset>";
  }
  puts(v15);
  return puts("</html>");
}
// 104CC: using guessed type int __fastcall get_remote_addr(_DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 107C0: using guessed type int __fastcall get_hwaddr_kernel(_DWORD, _DWORD);
// 10820: using guessed type int __fastcall get_url_redirect_option(_DWORD);
// 1088C: using guessed type int __fastcall get_url_redirect_usermsg(_DWORD);
// 1145C: using guessed type int __fastcall get_url_redirect_btnmsg(_DWORD);
// 11864: using guessed type int __fastcall get_url_redirect_autoconfirm(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 1199C: using guessed type int __fastcall get_url_redirect_usermsg2(_DWORD);

//----- (00050BF0) --------------------------------------------------------
int __fastcall sub_50BF0(int a1)
{
  int v1; // r5@1
  char *v2; // r1@2
  int v3; // r1@4
  int v4; // r0@4
  int v5; // r1@4
  int v6; // r0@4
  int v7; // r1@4
  int v8; // r7@4
  int v9; // r7@4
  int v10; // r1@4
  int v11; // r0@4
  int v12; // r1@4
  const char *v13; // r0@4
  int v14; // r1@4
  int v15; // r0@4
  int v16; // r4@4
  int v17; // r0@4
  char v19; // [sp+4h] [bp-3C4h]@4
  int v20; // [sp+280h] [bp-148h]@4

  v1 = get_iptv_config(a1);
  print_js_file((int)"expertconf", (int)"iptv");
  puts("<form method=post action=\"timepro.cgi\" name=\"iptv_fm\">");
  puts("<input type=hidden name=\"tmenu\" value='expertconf'>");
  puts("<input type=hidden name=\"smenu\" value='iptv'>");
  puts("<input type=hidden name=\"act\" value=\"iptv\">");
  printf("<input type=hidden name=\"cur_op\" value=\"%d\">\n", v1);
  puts("<input type=hidden name=commit>");
  puts("<tr><td>");
  printf("<table cellspacing=0px cellpadding=0px style='width:100%%; margin-top: 10px; padding: 0 0 10px 5px; border-bottom: 1px solid #CCC;'>\n");
  printf("<tr>");
  puts("<td colspan=2 style='padding: 4px 0;'>");
  if ( v1 )
    v2 = "";
  else
    v2 = "checked";
  printf("<input type=radio id='mc_run_nouse' name=\"mc_run\" value=0 style='vertical-align: bottom;' %s>", v2);
  v4 = get_ux_text_common(439, v3);
  printf("<label for='mc_run_nouse'>%s</label>", v4);
  printf("</td>");
  printf("</tr>");
  printf("<tr>");
  printf("<td>");
  printf("<input type=radio id='mc_run_private' name=\"mc_run\" value=%d style='vertical-align: bottom;' %s>");
  v6 = get_ux_text_common(440, v5);
  printf("<label for='mc_run_private'>%s</label>", v6);
  printf("</td>");
  printf("<td style='padding: 1px 0;'>");
  v8 = get_ux_text_common(707, v7);
  get_igmp_proxy();
  printf(
    "<input type=button name='mcgroup_bt' value='%s' style='float: right; margin-right: 10px;' \tonclick=\"showGroupList();\" %s>",
    v8);
  printf("</td>");
  printf("</tr>");
  printf("<tr>");
  printf("<td colspan=2 style='padding: 4px 0;'>");
  get_si("hw", &v19);
  v9 = v20;
  printf("<input type=radio id='mc_run_public' name=\"mc_run\" value=%d style='vertical-align: bottom;' %s>");
  v11 = get_ux_text_common(441, v10);
  printf("<label for='mc_run_public'>%s", v11);
  v13 = (const char *)get_ux_text_common(438, v12);
  printf(v13, v9);
  printf("</label>");
  printf("</td>");
  printf("</tr>");
  puts("</table></td></tr>");
  printf("<tr>");
  puts("<td align=right width=43>");
  v15 = get_ux_text_common(35, v14);
  v16 = v15;
  v17 = hwinfo_get_reboot_duration(v15);
  printf(
    "<input type=button name=\"mc_apply\" value=\"%s\" style='margin:10px;' onclick=\"setIPTV(%d, false);\">\n",
    v16,
    v17);
  printf("<iframe name=\"expertconf_iptv_setup_status\" src=\"timepro.cgi?tmenu=iframe&smenu=expertconf_iptv_setup_status\" frameborder=no style='display:none;'></iframe>");
  printf("</td>");
  printf("</tr>");
  printf("</form>");
  return printf("<script> CheckIPTVForm(); </script>");
}
// 104B4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// 10658: using guessed type int __fastcall get_iptv_config(_DWORD);
// 10934: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// 11624: using guessed type int get_igmp_proxy(void);

//----- (00050E88) --------------------------------------------------------
int __fastcall sub_50E88(const char *a1, int a2)
{
  int v2; // r5@1
  const char *v3; // r4@1
  void *v4; // r0@3

  v2 = a2;
  v3 = a1;
  if ( !strcmp(a1, "reboot_mask") )
  {
    printf("<style>");
    printf("#%s p { margin: 5px 0 5px 15px; text-align: left; }", v3);
    printf("</style>");
  }
  printf("<DIV id=\"%s\" style=\"display:none;\">", v3);
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v4 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v4);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:"
    "middle; display:block; text-align:center;\">%s\n",
    v2);
  printf("</SPAN></td>");
  return printf((const char *)&unk_7D215);
}

//----- (00050F70) --------------------------------------------------------
int print_iframe_experconf_iptv_macgroup()
{
  int v0; // r4@1
  char *v1; // r1@3

  v0 = 0;
  printf("<style>");
  printf((const char *)&unk_B3414);
  printf("</style>");
  printf("<table id='list_table' cellspacing=0px cellpadding=0px style='width: 100%%;'>\n");
  do
  {
    if ( ++v0 & 1 )
      v1 = "";
    else
      v1 = "background-color: #F7F7F7;";
    printf("<tr style='height: 24px; %s'><td colspan=4></td></tr>", v1);
  }
  while ( v0 != 4 );
  printf("</table>");
  return printf("<iframe name=\"experconf_iptv_macgroup_status\" src=\"timepro.cgi?tmenu=iframe&smenu=experconf_iptv_macgroup_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (00050FF8) --------------------------------------------------------
int __fastcall print_iframe_experconf_iptv_macgroup_status(int a1)
{
  int result; // r0@1
  signed int v2; // r4@2
  char v3; // r5@5
  char *v4; // r0@6
  const char *v5; // r10@7
  int v6; // r0@7
  char v7; // r11@7
  char *v8; // r0@8
  int v9; // r9@9
  char *v10; // r0@9
  char *v11; // r1@11
  char *v12; // r0@14
  const char *v13; // r9@15
  char *v14; // r0@15
  int v15; // r11@16
  char *v16; // r0@16
  char *v17; // r1@18
  int v18; // r0@20
  int v19; // r1@20
  const char *v20; // r1@21
  int v21; // r0@25
  bool v22; // zf@29
  char *v23; // r1@30
  FILE *stream; // [sp+4h] [bp-CCh]@3
  char s; // [sp+8h] [bp-C8h]@6
  char v26; // [sp+88h] [bp-48h]@1

  result = get_value(a1, "act", &v26, 32);
  if ( !result )
    return result;
  result = strcmp(&v26, "print");
  v2 = result;
  if ( result )
    return result;
  printf("<table id='list_table' cellspacing=0px cellpadding=0px style='width: 100%%;'>\n");
  printf("<colgroup><col width=180px><col width=145px><col width=70px></colgroup>");
  stream = fopen("/var/run/mcgroup", "r");
  if ( stream )
  {
    v3 = v2;
    while ( 1 )
    {
      while ( 1 )
      {
        do
        {
          if ( !fgets(&s, 128, stream) )
            goto LABEL_33;
          v4 = strchr(&s, 32);
        }
        while ( !v4 );
        *v4 = v3;
        v5 = v4 + 1;
        v6 = strcmp(&s, "G");
        v7 = v6;
        if ( v6 )
          break;
        v8 = strchr(v5, 32);
        if ( v8 )
        {
          *v8 = v7;
          v9 = (int)(v8 + 1);
          v10 = strchr(v8 + 1, 32);
          if ( v10 )
          {
            *v10 = v7;
            if ( v2 & 1 )
              v11 = "background-color: #F7F7F7;";
            else
              v11 = "";
            printf("<tr style='height: 24px; %s'>", v11);
            printf("<td colspan=4 style='padding-left: 5px;'> %s (%s)</td>\n", v5, v9);
            printf("</tr>");
            goto LABEL_26;
          }
        }
      }
      v12 = strchr(v5, 32);
      if ( v12 )
      {
        *v12 = v3;
        v13 = v12 + 1;
        v14 = strchr(v12 + 1, 32);
        if ( v14 )
        {
          *v14 = v3;
          v15 = (int)(v14 + 1);
          v16 = strchr(v14 + 1, 10);
          if ( v16 )
          {
            *v16 = v3;
            if ( v2 & 1 )
              v17 = "background-color: #F7F7F7;";
            else
              v17 = "";
            printf("<tr style='height: 24px; %s'>", v17);
            puts("<td></td>");
            printf("<td>%s</td>\n", v5);
            v18 = atoi(v13);
            if ( v18 >= 0 )
            {
              if ( v18 > 31 )
                v20 = (const char *)get_ux_text_common(1491, v19);
              else
                v20 = v13;
            }
            else
            {
              v20 = "N.A.";
            }
            printf("<td>%s</td>\n", v20);
            v21 = printf("<td>%s</td>\n", v15);
            etr(v21);
LABEL_26:
            ++v2;
          }
        }
      }
    }
  }
  v2 = 0;
LABEL_33:
  while ( v2 <= 7 )
  {
    v22 = (v2++ & 1) == 0;
    if ( v22 )
      v23 = "";
    else
      v23 = "background-color: #F7F7F7;";
    printf("<tr style='height: 24px; %s'><td colspan=4></td></tr>", v23);
  }
  printf("</table>");
  printf("<script>");
  printf("parent.document.getElementById('list_table').outerHTML = document.getElementById('list_table').outerHTML;");
  printf("setTimeout(function() { location.reload(); }, 3000);");
  return printf("</script>");
}
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 11558: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00051284) --------------------------------------------------------
int __fastcall print_iframe_expertconf_iptv_setup_status(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r6@1
  int v4; // r0@1
  signed int v5; // r4@3
  int v6; // r0@5
  bool v7; // zf@5
  signed int v8; // r6@8
  int v9; // r0@10
  int v10; // r0@11
  int result; // r0@15
  int v12; // [sp+0h] [bp-30h]@1

  v2 = a2;
  v3 = get_iptv_config(a1);
  v4 = get_value_post(v2, "act", &v12, 32);
  if ( !v4 )
    goto LABEL_19;
  if ( strcmp((const char *)&v12, "mc") )
  {
    v5 = 0;
    goto LABEL_15;
  }
  v4 = get_value_post(v2, "mc_run", &v12, 32);
  if ( v4 )
  {
    v6 = atoi((const char *)&v12);
    v7 = v6 == 1;
    if ( v6 != 1 )
      v7 = v3 == 1;
    v8 = !v7;
    v9 = set_iptv_config();
    if ( v8 ^ 1 )
    {
      saveconf(v9);
      signal_reboot(3);
    }
    else
    {
      v10 = signal_update(v9);
      signal_save(v10);
    }
    v5 = 1;
  }
  else
  {
LABEL_19:
    v5 = v4;
  }
LABEL_15:
  print_js_file((int)"expertconf", (int)"iptv");
  puts("<form method=post action=\"timepro.cgi\" name=\"iptv_fm\">");
  puts("<input type=hidden name=\"tmenu\" value='iframe'>");
  puts("<input type=hidden name=\"smenu\" value='expertconf_iptv_setup_status'>");
  puts("<input type=hidden name=\"act\" value=\"iptv\">");
  puts("<input type=hidden name=mc_run value=''>");
  result = printf("</form>");
  if ( !v5 )
    return result;
  printf("<script>");
  printf((const char *)&unk_86F34);
  result = printf("</script>");
  return result;
}
// 10658: using guessed type int __fastcall get_iptv_config(_DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10880: using guessed type int set_iptv_config(void);
// 10FF4: using guessed type int __fastcall saveconf(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 11678: using guessed type int __fastcall signal_reboot(_DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);

//----- (000513D4) --------------------------------------------------------
int expertconf_iptv()
{
  int v0; // r0@1
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r1@1
  int v8; // r0@1
  int v9; // r1@1
  int v10; // r0@1
  int v11; // r1@1
  int v12; // r0@1
  int v13; // r1@1
  int v14; // r0@1

  v0 = puts("<table cellpadding=0px cellspacing=0px style='width: 641px; background-color: #EEE;'>");
  sub_50BF0(v0);
  printf("</table>");
  v2 = get_ux_text_common(222, v1);
  sub_50E88("reboot_mask", v2);
  v4 = get_ux_text_common(34, v3);
  sub_50E88("apply_mask", v4);
  printf("<style>");
  printf(".title td { border-bottom: 1px solid #CCC; }");
  printf("</style>");
  printf("<DIV id='macgroup_list' style=\"display:none;\">");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\" onclick=\"hideGroupList();\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:75px; top:130px; width:480px; height:242px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  printf("<table cellspacing=0px cellpadding=0px style='width: 100%%;'>\n");
  printf("<colgroup><col width=180px><col width=145px><col width=70px></colgroup>");
  printf("<tr style='background-color: #DBDBDB; height: 24px;'><td colspan=4 style='border-bottom: 1px solid #CCC;'>");
  v6 = get_ux_text_common(707, v5);
  printf("<b style='margin-left: 5px;'>%s</b>", v6);
  printf("</td></tr>");
  printf("<tr class=title style='height: 24px; background-color: #E7E7E7; border-bottom: 1px solid #CCC;'>");
  v8 = get_ux_text_common(706, v7);
  printf("<td style='width: 180px;'><span style='margin-left: 5px;'>%s</span></td>", v8);
  v10 = get_ux_text_common(708, v9);
  printf("<td>%s</td>", v10);
  v12 = get_ux_text_common(709, v11);
  printf("<td>%s</td>", v12);
  v14 = get_ux_text_common(710, v13);
  printf("<td>%s</td>", v14);
  printf("</tr>");
  printf("</table>");
  printf("<iframe name=\"experconf_iptv_macgroup\" src=\"timepro.cgi?tmenu=iframe&smenu=experconf_iptv_macgroup\" frameborder=no style='width:100%%; height:192px;'></iframe>");
  printf("</DIV>");
  return printf("</DIV>");
}

//----- (00051564) --------------------------------------------------------
unsigned int __fastcall sub_51564(const char *a1, int a2)
{
  const char *v2; // r8@1
  int v3; // r6@1
  __int64 v4; // r2@1
  unsigned int result; // r0@2
  int v6; // r4@5
  int v7; // r12@5
  int v8; // r9@5
  int v9; // [sp+0h] [bp-60h]@1
  int v10; // [sp+4h] [bp-5Ch]@5
  unsigned int v11; // [sp+8h] [bp-58h]@3
  int v12; // [sp+Ch] [bp-54h]@5

  v2 = a1;
  v3 = a2;
  memset(&v9, 0, 0x40u);
  HIDWORD(v4) = statfs(v2, (struct statfs *)&v9);
  if ( HIDWORD(v4) )
  {
    result = 0;
  }
  else
  {
    LODWORD(v4) = v11;
    if ( v11 )
    {
      v6 = v10;
      v7 = v12;
      v8 = v10 >> 31;
      *(_QWORD *)v3 = v11 * (signed __int64)v10;
      *(_QWORD *)(v3 + 8) = (unsigned int)(v4 - v7) * __PAIR__(v8, v6);
      *(_QWORD *)(v3 + 16) = (unsigned int)v7 * __PAIR__(v8, v6);
      *(_DWORD *)(v3 + 24) = sub_5C530(100LL * (unsigned int)(v4 - v7), v4);
      result = 1;
    }
    else
    {
      result = v11;
    }
  }
  return result;
}

//----- (00051604) --------------------------------------------------------
int __fastcall sub_51604(int *a1, _DWORD *a2)
{
  int *v2; // r4@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r1@1
  int i; // r5@1
  int v7; // r1@5
  int v8; // r0@6
  const char *v9; // r0@9
  int v10; // r0@13
  int v11; // r5@15
  int v12; // r1@15
  int v13; // r0@16
  int v14; // r0@20
  int v15; // r1@20
  int v16; // r1@21
  const char *v17; // r0@21
  const char *v18; // r0@23
  int v19; // r0@25
  unsigned int v20; // r4@27
  int v21; // r1@27
  int v22; // r0@28
  int v23; // r0@30
  int v24; // r1@30
  int v25; // r0@30
  int v26; // r1@30
  int v27; // r4@31
  int v28; // r0@31
  int v29; // r1@32
  const char *v30; // r0@32
  int v31; // r1@33
  int v32; // r0@35
  int v33; // r0@46
  char v35; // [sp+4h] [bp-424h]@27
  int v36; // [sp+3E4h] [bp-44h]@30
  char v37; // [sp+3E8h] [bp-40h]@27
  int v38; // [sp+400h] [bp-28h]@31
  int v39; // [sp+40Ch] [bp-1Ch]@15

  v2 = a1;
  ++*a2;
  printf("<tr style='background-color:%s;'>");
  printf("<td style='width:128px;'>");
  v4 = get_ux_text_common(1373, v3);
  printf("<span style=\"padding-left: 5px; font: normal normal normal 9pt arial; color:#000000\">%s%d</span>", v4, 1);
  printf("</td>");
  for ( i = *v2; i; i = *(_DWORD *)i )
  {
    if ( strcmp((const char *)(i + 368), "09") && *(_DWORD *)(i + 4) == 1 )
    {
      printf("<td align=left style='width:123px;'>");
      if ( !strcmp((const char *)(i + 368), "08") )
      {
        v8 = 1381;
        goto LABEL_9;
      }
      if ( !strcmp((const char *)(i + 368), "02") )
      {
LABEL_8:
        v8 = 1382;
        goto LABEL_9;
      }
      if ( !strcmp((const char *)(i + 368), "07") )
      {
        v8 = 1378;
LABEL_9:
        v9 = (const char *)get_ux_text_common(v8, v7);
        printf(v9);
      }
      else
      {
        if ( get_ifexist("usb0") )
          goto LABEL_8;
        v10 = get_ux_text_common(1375, v7);
        printf("%s-%s", v10, i + 24);
      }
      printf("</td>");
      if ( !strcmp((const char *)(i + 368), "08") )
      {
        v11 = i + 372;
        printf("<td align=left style='width:246px;'><span name='port_status'>");
        get_mount_list(&v39, v11);
        if ( v39 )
        {
          v13 = 1372;
        }
        else if ( is_usb_removed(v11) )
        {
          v13 = 1385;
        }
        else
        {
          v13 = 1400;
        }
        v14 = get_ux_text_common(v13, v12);
        printf("%s", v14);
        printf("</span></td>");
        printf("<td align=left style='width:144px'>");
        if ( v39 )
        {
          v16 = get_ux_text_common(1386, v15);
          v17 = "<input type=button name=remove_bt value=\"%s\" style='margin-right: 20px;' onclick=\"RemoveUSB('%s');\">";
        }
        else
        {
          v16 = get_ux_text_common(1384, v15);
          v17 = "<input type=button name=mount_bt value=\"%s\" style='margin-right: 20px;' onclick=\"MountUSB('%s');\">";
        }
        printf(v17, v16, v11);
        free_mount_list(&v39);
        v18 = "</td>";
        goto LABEL_44;
      }
      if ( !strcmp((const char *)(i + 368), "02") )
      {
        v19 = printf("<td colspan=2 align=left style='width:246px;'><span name='port_status'>");
        goto LABEL_34;
      }
      if ( !strcmp((const char *)(i + 368), "07") )
      {
        get_si("sw", &v35);
        v20 = sub_51564("/tmp/var/spool/cups", (int)&v37);
        printf("<td align=left><span name='port_status'>");
        if ( get_cupsd_printer_status(0) )
          v22 = 1400;
        else
          v22 = 1372;
        v23 = get_ux_text_common(v22, v21);
        printf("%s", v23);
        printf("</span></td>");
        printf("<td align=left><span>");
        v25 = get_ux_text_common(128, v24);
        printf("%s: %dMB", v25, v36);
        if ( v20 )
        {
          v27 = v38;
          v28 = get_ux_text_common(1401, v26);
          printf("(%d%% %s)", v27, v28);
LABEL_43:
          v18 = "</span></td>";
LABEL_44:
          printf(v18);
          return printf("</tr>");
        }
        v29 = get_ux_text_common(434, v26);
        v30 = "(%s)";
LABEL_42:
        printf(v30, v29);
        goto LABEL_43;
      }
      printf("<td colspan=2 align=left style='width:246px;'><span name='port_status'>");
      v19 = get_ifexist("usb0");
      if ( v19 )
      {
LABEL_34:
        if ( tethering_is_running(v19) )
        {
          v32 = 1390;
LABEL_41:
          v29 = get_ux_text_common(v32, v31);
          v30 = "%s";
          goto LABEL_42;
        }
        if ( get_usb_tethering_op() && get_ifexist("usb0") && get_wan_link("wan1") )
        {
          v32 = 1397;
          goto LABEL_41;
        }
      }
      v32 = 1400;
      goto LABEL_41;
    }
  }
  v33 = get_ux_text_common(1377, v5);
  printf("<td colspan=3 style='width:513px;'>%s</td>", v33);
  return printf("</tr>");
}
// 104B4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// 1064C: using guessed type int __fastcall free_mount_list(_DWORD);
// 10E8C: using guessed type int __fastcall get_wan_link(_DWORD);
// 110B4: using guessed type int __fastcall get_cupsd_printer_status(_DWORD);
// 11150: using guessed type int __fastcall is_usb_removed(_DWORD);
// 11978: using guessed type int __fastcall get_ifexist(_DWORD);
// 119FC: using guessed type int __fastcall get_mount_list(_DWORD, _DWORD);
// 11BDC: using guessed type int get_usb_tethering_op(void);
// 11C78: using guessed type int __fastcall tethering_is_running(_DWORD);

//----- (000519E0) --------------------------------------------------------
int print_iframe_nasconf_basic_device()
{
  printf("<style>");
  printf("body { margin: 0; }");
  printf("tr { height: 24px; }");
  printf("</style>");
  print_js_file((int)"nasconf", (int)"basic");
  printf("<table id='device_info_table' width=100%% cellspacing=0px cellpadding=0px>\n");
  printf("</table>");
  return printf("<iframe name=\"nasconf_basic_device_status\" src=\"timepro.cgi?tmenu=iframe&smenu=nasconf_basic_device_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (00051A50) --------------------------------------------------------
void __fastcall print_iframe_nasconf_basic_device_status(int a1, int a2, int a3)
{
  int v3; // r5@1
  int v4; // r1@1
  int v5; // r0@1
  int v6[3]; // [sp+0h] [bp-20h]@1
  int v7; // [sp+Ch] [bp-14h]@1

  v6[0] = a1;
  v6[1] = a2;
  v6[2] = a3;
  v7 = 0;
  v3 = lock_file("nasconf_basic_usb_info_lock_file");
  get_usbdev_list(v6, 0);
  print_js_file((int)"nasconf", (int)"basic");
  puts("<tr><td>");
  printf("<table id='device_info_table' width=100%% cellspacing=0px cellpadding=0px>\n");
  sub_51604(&v6[1], &v7);
  free_usbdev_list(v6);
  printf("</table>");
  printf("</td></tr>");
  printf("<script>");
  v5 = get_ux_text_common(1400, v4);
  printf("unmaskLoadingImage('%s');", v5);
  printf("parent.document.getElementById('device_info_table').outerHTML = document.getElementById('device_info_table').outerHTML;");
  printf("setTimeout(function() { location.reload(); }, 3000);");
  printf("</script>");
  unlock_file(v3);
}
// 10400: using guessed type int __fastcall get_usbdev_list(_DWORD, _DWORD);
// 10460: using guessed type int __fastcall free_usbdev_list(_DWORD);
// 1211C: using guessed type int __fastcall lock_file(_DWORD);

//----- (00051B28) --------------------------------------------------------
int __fastcall print_iframe_nasconf_basic_device_submit(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r6@4
  int v4; // r6@12
  int v6; // [sp+0h] [bp-B0h]@5
  char v7; // [sp+80h] [bp-30h]@1

  v2 = a2;
  if ( get_value_post(a2, "act", &v7, 32) )
  {
    if ( !strcmp(&v7, "remove") )
    {
      if ( get_value_post(v2, "devname", &v7, 32) )
      {
        v3 = check_unpermitted_chars(&v7);
        if ( !v3 )
        {
          set_device_removed(&v7, 1);
          snprintf((char *)&v6, 0x80u, "umount:%s", &v7);
          signal_nas(&v6);
          while ( get_num_of_mountdev(&v7) && v3 != 30 )
          {
            ++v3;
            sleep(1u);
          }
        }
      }
    }
    else if ( !strcmp(&v7, "mount") )
    {
      if ( get_value_post(v2, "devname", &v7, 32) )
      {
        v4 = check_unpermitted_chars(&v7);
        if ( !v4 )
        {
          snprintf((char *)&v6, 0x80u, "mount:%s", &v7);
          signal_nas(&v6);
          while ( !get_num_of_mountdev(&v7) && v4 != 30 )
          {
            ++v4;
            sleep(1u);
          }
        }
      }
    }
  }
  puts("<form method=post action=timepro.cgi name=usbmgmt_fm>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=nasconf_basic_device_submit>");
  puts("<input type=hidden name=act value=>");
  puts("<input type=hidden name=devname value=>");
  return printf("</form>");
}
// 10844: using guessed type int __fastcall signal_nas(_DWORD);
// 11000: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// 1118C: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// 113A8: using guessed type int __fastcall set_device_removed(_DWORD, _DWORD);
// 11804: using guessed type int __fastcall get_num_of_mountdev(_DWORD);

//----- (00051CDC) --------------------------------------------------------
char *__fastcall sub_51CDC(int a1, const char *a2)
{
  int v2; // r5@1
  const char *v3; // r4@1
  int v4; // r1@2
  const char *v5; // r0@3

  v2 = a1;
  v3 = a2;
  if ( !strcmp(a2, "fuseblk") )
  {
    if ( !get_fuse_fsname(v2, byte_CA6DC) )
    {
      v5 = (const char *)get_ux_text_common(642, v4);
      strcpy(byte_CA6DC, v5);
    }
  }
  else
  {
    sf_strncpy(byte_CA6DC, v3, 128);
    if ( !strcmp(byte_CA6DC, "tntfs") )
      strcpy(byte_CA6DC, "ntfs");
    strtoupper(byte_CA6DC);
  }
  return byte_CA6DC;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 11054: using guessed type int __fastcall get_fuse_fsname(_DWORD, _DWORD);
// 11300: using guessed type int __fastcall strtoupper(_DWORD);

//----- (00051D78) --------------------------------------------------------
int __fastcall sub_51D78(int a1, _DWORD *a2)
{
  _DWORD *v2; // r8@1
  int v3; // r5@1
  int *v4; // r0@5
  int v5; // r7@6
  int v6; // r6@6
  int i; // r4@7
  int v8; // r0@9
  int v9; // r0@9
  int v10; // r1@9
  int v11; // r0@9
  char *v12; // r0@9
  char s; // [sp+4h] [bp-174h]@7
  char v15; // [sp+104h] [bp-74h]@9
  char v16; // [sp+124h] [bp-54h]@9
  int v17; // [sp+144h] [bp-34h]@1
  int v18; // [sp+148h] [bp-30h]@7

  v2 = a2;
  v3 = a1;
  v17 = 0;
  while ( v3 )
  {
    if ( *(_DWORD *)(v3 + 4) == 1 )
    {
      get_mount_list(&v17, v3 + 372);
      if ( v17 )
      {
        v5 = 0;
        v6 = 0;
        do
        {
          sprintf(&s, "HDD%d", ++v6);
          for ( i = v18; i; i = *(_DWORD *)i )
          {
            if ( !strcmp((const char *)(i + 100), &s) )
            {
              ++v5;
              v8 = get_readable_sizestr(*(_QWORD *)(i + 216), *(_QWORD *)(i + 216) >> 32);
              sf_strncpy(&v16, v8, 32);
              v9 = get_readable_sizestr(*(_QWORD *)(i + 232), *(_QWORD *)(i + 232) >> 32);
              sf_strncpy(&v15, v9, 32);
              ++*v2;
              printf("<tr style='background-color:%s;'>");
              printf("<td align=left style='padding-left: 5px;'>");
              v11 = get_ux_text_common(1373, v10);
              printf(
                "<span style=\"font: normal normal normal 9pt arial; color:#000000\">%s%d</span>",
                v11,
                *(_DWORD *)(v3 + 4));
              printf("</td>");
              printf("<td align=left>/%s</td>", i + 100);
              v12 = sub_51CDC(i + 20, (const char *)(i + 164));
              printf("<td align=left>%s</td>", v12);
              printf("<td align=left>%s</td>", &v16);
              printf("<td align=left>%s</td>", &v15);
              printf("</tr>");
            }
          }
        }
        while ( v5 != v17 && v6 != 128 );
        v4 = &v17;
      }
      else
      {
        v4 = &v17;
      }
      free_mount_list(v4);
      return v17;
    }
    v3 = *(_DWORD *)v3;
  }
  return v17;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 1064C: using guessed type int __fastcall free_mount_list(_DWORD);
// 1151C: using guessed type int __fastcall get_readable_sizestr(_DWORD, _DWORD);
// 119FC: using guessed type int __fastcall get_mount_list(_DWORD, _DWORD);

//----- (00051F38) --------------------------------------------------------
int print_iframe_nasconf_basic_storage()
{
  printf("<style>");
  printf("body { margin: 0px; }");
  printf("tr { height: 24px; }");
  printf("</style>");
  printf("<table id='storage_info_table' width=100%% cellspacing=0px cellpadding=0px style='border-bottom: 1px solid #CCC;'>\n");
  printf("</table>");
  return printf("<iframe name=\"nasconf_basic_storage_status\" src=\"timepro.cgi?tmenu=iframe&smenu=nasconf_basic_storage_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (00051F94) --------------------------------------------------------
void __fastcall print_iframe_nasconf_basic_storage_status(int a1, int a2, int a3)
{
  int v3; // r4@1
  const char *v4; // r1@3
  bool v5; // zf@6
  bool v6; // nf@6
  unsigned __int8 v7; // vf@6
  int v8; // r3@6
  const char *v9; // r0@8
  int v10[3]; // [sp+0h] [bp-20h]@1
  int v11; // [sp+Ch] [bp-14h]@1

  v10[0] = a1;
  v10[1] = a2;
  v10[2] = a3;
  v11 = 0;
  v3 = lock_file("nasconf_basic_usb_info_lock_file");
  get_usbdev_list(v10, "08");
  printf("<table id='storage_info_table' width=100%% cellspacing=0px cellpadding=0px style='border-bottom: 1px solid #CCC;'>\n");
  sub_51D78(v10[1], &v11);
  while ( 1 )
  {
    v7 = __OFSUB__(v11, 2);
    v5 = v11 == 2;
    v6 = v11 - 2 < 0;
    v8 = v11++ + 1;
    if ( !((unsigned __int8)(v6 ^ v7) | v5) )
      break;
    if ( v8 & 1 )
      v4 = "#FFF";
    else
      v4 = (const char *)&unk_86952;
    printf("<tr style='background-color:%s;'><td colspan=5></td></tr>", v4);
  }
  if ( v8 <= 6 )
    v9 = "<colgroup><col width=125px><col width=120px><col width=120px><col width=120px><col width=140px></colgroup>";
  else
    v9 = "<colgroup><col width=125px><col width=120px><col width=120px><col width=120px><col width=122px></colgroup>";
  printf(v9);
  printf("</table>");
  free_usbdev_list(v10);
  printf("<script>");
  printf("parent.document.getElementById('storage_info_table').outerHTML = document.getElementById('storage_info_table').outerHTML;");
  printf("setTimeout(function() { location.reload(); }, 3000);");
  printf("</script>");
  unlock_file(v3);
}
// 10400: using guessed type int __fastcall get_usbdev_list(_DWORD, _DWORD);
// 10460: using guessed type int __fastcall free_usbdev_list(_DWORD);
// 1211C: using guessed type int __fastcall lock_file(_DWORD);

//----- (00052080) --------------------------------------------------------
int nasconf_basic()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r1@1
  int v9; // r0@1
  int v10; // r1@1
  int v11; // r0@1
  int v12; // r1@1
  int v13; // r0@1
  int v14; // r1@1
  int v15; // r0@1
  int v16; // r1@1
  int v17; // r0@1
  int v18; // r1@1
  int v19; // r0@1
  int v20; // r1@1
  int v21; // r5@1
  void *v22; // r0@1

  printf("<style>");
  printf(".title { height: 24px; background-color: #E7E7E7; }");
  printf(".title b { padding-left: 5px; }");
  printf(".header { height: 24px; background-color: #F7F7F7; }");
  printf(".header >td { border-width: 1px 0; border-color: #CCC; border-style: solid; }");
  printf("</style>");
  printf("<table width=641px cellspacing=0px cellpadding=0px>");
  printf("<tr class='title'><td>");
  v1 = get_ux_text_common(1380, v0);
  printf("<b>%s</b>", v1);
  printf("</td></tr>");
  puts("<tr class='header'><td>");
  printf("<table width=100%% cellspacing=0px cellpadding=0px>\n");
  printf("<tr>");
  v3 = get_ux_text_common(1376, v2);
  printf("<td width=120px align=left style='padding-left: 5px;'>%s</td>", v3);
  v5 = get_ux_text_common(1374, v4);
  printf("<td width=120px align=left>%s</td>", v5);
  v7 = get_ux_text_common(1379, v6);
  printf("<td width=240px align=left>%s</td>", v7);
  printf("<td width=140px align=right></td>");
  printf("</tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<iframe name=\"nasconf_basic_device\" src=\"timepro.cgi?tmenu=iframe&smenu=nasconf_basic_device\" frameborder=no style='width:100%%; height:24px; background-color: #EEE; border-bottom: 1px solid #CCC;'></iframe>");
  printf("<iframe name=\"nasconf_basic_device_submit\" src=\"timepro.cgi?tmenu=iframe&smenu=nasconf_basic_device_submit\" frameborder=no style='display:none;'></iframe>");
  printf("</td></tr>");
  printf("<tr class='title'><td>");
  v9 = get_ux_text_common(1387, v8);
  printf("<b>%s</b>", v9);
  printf("</td></tr>");
  printf("<tr class='header'><td>");
  printf("<table width=100%% cellspacing=0px cellpadding=0px>");
  printf("<tr>");
  v11 = get_ux_text_common(1376, v10);
  printf("<td width=120px align=left style='padding-left: 5px;'>%s</td>", v11);
  v13 = get_ux_text_common(940, v12);
  printf("<td width=120px align=left>%s</td>", v13);
  v15 = get_ux_text_common(260, v14);
  printf("<td width=120px align=left>%s</td>", v15);
  v17 = get_ux_text_common(1332, v16);
  printf("<td width=120px align=left>%s</td>", v17);
  v19 = get_ux_text_common(373, v18);
  printf("<td width=140px align=left>%s</td>", v19);
  printf("</tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<iframe name=\"nasconf_basic_storage\" src=\"timepro.cgi?tmenu=iframe&smenu=nasconf_basic_storage\" frameborder=no style='width:100%%; height:288px; background-color: #EEE;'></iframe>");
  printf("</td></tr>");
  printf("</table>");
  v21 = get_ux_text_common(34, v20);
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v22 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v22);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:"
    "middle; display:block; text-align:center;\">%s\n",
    v21);
  printf("</SPAN></td>");
  return printf((const char *)&unk_7D215);
}

//----- (000523A0) --------------------------------------------------------
int __fastcall sub_523A0(int a1, int a2, int a3)
{
  int v3; // r5@1
  int v4; // r4@1
  int v5; // r6@1

  v3 = a3;
  v4 = a1;
  v5 = a2;
  printf("<TR height=20 ID=%s STYLE=\"cursor:pointer; background-Color:#%s\" ONCLICK=\"ClickNasService(this);\">", a1);
  return printf("<TD></TD><TD>%s</TD><TD CLASS=text_gray ID=%s_value>%s</TD><TD>%s</TD></TR>", v5, v4, v3);
}

//----- (00052400) --------------------------------------------------------
int __fastcall getStatusScript(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r5@1

  v2 = a1;
  v3 = a2;
  puts("<script>");
  printf("if(parent.document.getElementById('%s'))", v2);
  printf("parent.document.getElementById('%s').innerHTML = '%s';", v2, v3);
  printf("if(parent.parent.document.getElementById('%s'))", v2);
  printf((const char *)&unk_B49EC, v2, v3);
  return puts("</script>");
}

//----- (00052470) --------------------------------------------------------
int __fastcall dir_filter(int a1)
{
  int v1; // r3@1
  bool v2; // zf@1
  int result; // r0@4

  v1 = *(_BYTE *)(a1 + 10);
  v2 = v1 == 4;
  if ( v1 != 4 )
    v2 = v1 == 0;
  if ( v2 )
  {
    if ( v1 == 10 )
    {
      result = 0;
    }
    else if ( *(_BYTE *)(a1 + 11) == 46 )
    {
      result = 0;
    }
    else
    {
      result = strcmp((const char *)(a1 + 11), "lost+found") != 0;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (000524CC) --------------------------------------------------------
signed int __fastcall getStatus(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r5@1
  int v4; // r6@1
  int v5; // r1@1
  signed int v6; // r4@3
  int v7; // r0@3
  void *v8; // r0@4
  int v9; // r6@4
  int v10; // r1@4
  int v11; // r3@4
  const char *v12; // r2@4
  char *v13; // r0@4
  void *v14; // r0@6
  int v15; // r6@6
  int v16; // r1@6
  int v17; // r0@6
  int v18; // r0@8
  int v20; // [sp+0h] [bp-290h]@3
  char s; // [sp+200h] [bp-90h]@9

  v2 = a1;
  v3 = a2;
  v4 = get_service_enable(a2);
  if ( !check_nas_service(v2, v3) )
  {
    if ( !v4 )
    {
      v6 = 0;
      v18 = get_ux_text_common(1109, v5);
      snprintf((char *)&v20, 0x80u, "%s", v18);
      goto LABEL_9;
    }
    v14 = get_image_dir();
    v15 = snprintf((char *)&v20, 0x80u, (const char *)&unk_B4A35, v14);
    v17 = get_ux_text_common(1103, v16);
    v12 = "%s";
    v11 = v17;
    v13 = (char *)&v20 + v15;
    goto LABEL_7;
  }
  if ( !v4 )
  {
    v8 = get_image_dir();
    v9 = snprintf((char *)&v20, 0x80u, "<img width=10 height=10 src=\"/%s/apply_ani.gif\">", v8);
    v11 = get_ux_text_common(1110, v10);
    v12 = " %s";
    v13 = (char *)&v20 + v9;
LABEL_7:
    snprintf(v13, 0x80u, v12, v11);
    v6 = 1;
    goto LABEL_9;
  }
  v6 = 0;
  v7 = get_ux_text_common(1102, v5);
  snprintf((char *)&v20, 0x80u, "%s", v7);
LABEL_9:
  snprintf(&s, 0x80u, "%s_status", v3);
  getStatusScript((int)&s, (int)&v20);
  return v6;
}
// 10EBC: using guessed type int __fastcall check_nas_service(_DWORD, _DWORD);
// 1100C: using guessed type int __fastcall get_service_enable(_DWORD);

//----- (0005260C) --------------------------------------------------------
int getThetheringStatus()
{
  int v0; // r1@1
  int v1; // r4@1
  int v2; // r1@3
  int v3; // r0@4
  int v4; // r0@8
  int v5; // r0@10
  int v7; // [sp+0h] [bp-208h]@8

  v1 = get_usb_tethering_op();
  if ( v1 )
  {
    if ( !get_ifexist("usb0") || get_wan_link("wan1") )
    {
      if ( get_ifexist("usb0") && get_wan_link("wan1") )
        v3 = 1388;
      else
        v3 = 1389;
    }
    else
    {
      v3 = 1390;
    }
    v4 = get_ux_text_common(v3, v2);
    snprintf((char *)&v7, 0x80u, "%s", v4);
    v1 = 1;
  }
  else
  {
    v5 = get_ux_text_common(1109, v0);
    snprintf((char *)&v7, 0x80u, "%s", v5);
  }
  getStatusScript((int)"tethering_status", (int)&v7);
  return v1;
}
// 10E8C: using guessed type int __fastcall get_wan_link(_DWORD);
// 11978: using guessed type int __fastcall get_ifexist(_DWORD);
// 11BDC: using guessed type int get_usb_tethering_op(void);

//----- (000526D4) --------------------------------------------------------
signed int getCupsdStatus()
{
  int v0; // r1@2
  int v1; // r0@3
  int v2; // r0@8
  int v4; // [sp+0h] [bp-210h]@8
  int v5; // [sp+200h] [bp-10h]@5

  if ( !get_cupsd_status() )
  {
    get_cupsd_config(&v5);
    if ( !v5 )
    {
      v1 = 1109;
      goto LABEL_8;
    }
LABEL_7:
    v1 = 934;
    goto LABEL_8;
  }
  if ( get_cupsd_printer_status(0) )
    goto LABEL_7;
  v1 = 1102;
LABEL_8:
  v2 = get_ux_text_common(v1, v0);
  snprintf((char *)&v4, 0x80u, "%s", v2);
  getStatusScript((int)"cupsd_status", (int)&v4);
  return 1;
}
// 10D60: using guessed type int get_cupsd_status(void);
// 10FA0: using guessed type int __fastcall get_cupsd_config(_DWORD);
// 110B4: using guessed type int __fastcall get_cupsd_printer_status(_DWORD);

//----- (0005275C) --------------------------------------------------------
int __fastcall sub_5275C(int a1, int a2)
{
  int v2; // r4@1
  char *v3; // r5@1
  char *v4; // r4@1
  int v5; // r6@1

  v2 = a2;
  v3 = strdup((const char *)(*(_DWORD *)a1 + 11));
  v4 = strdup((const char *)(*(_DWORD *)v2 + 11));
  strtoupper(v3);
  strtoupper(v4);
  v5 = strcoll(v3, v4);
  free(v3);
  free(v4);
  return v5;
}
// 11300: using guessed type int __fastcall strtoupper(_DWORD);

//----- (000527BC) --------------------------------------------------------
int __fastcall sub_527BC(int result, char *a2, int a3, _DWORD *a4)
{
  _DWORD *v4; // r5@1
  int v5; // r4@1
  int i; // r10@2
  const char *v7; // r1@7
  int v8; // r0@13
  const char *s2; // [sp+0h] [bp-B0h]@1
  int v10; // [sp+4h] [bp-ACh]@1
  char v11; // [sp+8h] [bp-A8h]@2

  s2 = a2;
  v4 = a4;
  v5 = result;
  v10 = a3;
  while ( v5 )
  {
    result = conv_time(*(_DWORD *)(v5 + 176), &v11, 1);
    for ( i = *(_DWORD *)(v5 + 216); i; i = *(_DWORD *)i )
    {
      result = strcmp((const char *)(v5 + 12), s2);
      if ( !result )
      {
        result = strcmp((const char *)(i + 20), "0.0.0.0");
        if ( result )
        {
          result = strcmp((const char *)(i + 20), "127.0.0.1");
          if ( result )
          {
            if ( *v4 & 1 )
              v7 = (const char *)&unk_86952;
            else
              v7 = "#FFF";
            printf("<tr style='background-color: %s'>", v7);
            printf("<td style='padding-left: 10px;'> %s </td>", v10);
            printf("<td> ");
            if ( !strcmp((const char *)(v5 + 44), "root") || !strcmp((const char *)(v5 + 44), "nobody") )
              putchar(45);
            else
              printf("%s", v5 + 44);
            printf("</td>");
            printf("<td> %s </td>", i + 20);
            v8 = printf("<td> %s </td>", &v11);
            result = etr(v8);
            ++*v4;
            break;
          }
        }
      }
    }
    v5 = *(_DWORD *)v5;
  }
  return result;
}
// 10DE4: using guessed type int __fastcall conv_time(_DWORD, _DWORD, _DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);

//----- (00052934) --------------------------------------------------------
int __fastcall sub_52934(int result, char *a2, int a3, _DWORD *a4)
{
  _DWORD *v4; // r5@1
  int v5; // r4@1
  int i; // r10@3
  const char *v7; // r1@7
  int v8; // r0@13
  const char *s2; // [sp+0h] [bp-B0h]@1
  int v10; // [sp+4h] [bp-ACh]@1
  char v11; // [sp+8h] [bp-A8h]@3

  s2 = a2;
  v4 = a4;
  v5 = result;
  v10 = a3;
  while ( v5 )
  {
    result = strcmp((const char *)(v5 + 12), s2);
    if ( !result )
    {
      result = conv_time(*(_DWORD *)(v5 + 176), &v11, 1);
      for ( i = *(_DWORD *)(v5 + 216); i; i = *(_DWORD *)i )
      {
        result = strcmp((const char *)(i + 20), "0.0.0.0");
        if ( result )
        {
          result = strcmp((const char *)(i + 20), "127.0.0.1");
          if ( result )
          {
            if ( *v4 & 1 )
              v7 = (const char *)&unk_86952;
            else
              v7 = "#FFF";
            printf("<tr style='background-color: %s'>", v7);
            printf("<td style='padding-left: 10px;'> %s </td>", v10);
            printf("<td> ");
            if ( !strcmp((const char *)(v5 + 44), "root") || !strcmp((const char *)(v5 + 44), "nobody") )
              putchar(45);
            else
              printf("%s", v5 + 44);
            printf("</td>");
            printf("<td> %s </td>", i + 20);
            v8 = printf("<td> %s </td>", &v11);
            result = etr(v8);
            ++*v4;
          }
        }
      }
      if ( *v4 > 0 )
        break;
    }
    v5 = *(_DWORD *)v5;
  }
  return result;
}
// 10DE4: using guessed type int __fastcall conv_time(_DWORD, _DWORD, _DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);

//----- (00052AB0) --------------------------------------------------------
int getIPDiskStatus()
{
  int v0; // r1@1
  int is_success; // r4@1
  int v2; // r1@2
  const char *v3; // r0@3
  int v4; // r1@4
  int v5; // r0@5
  int v6; // r0@8
  int v7; // r1@19
  int v8; // r0@20
  int v9; // r0@42
  const char *v10; // r0@43
  char *v11; // r0@44
  char v12; // r3@44
  char *v13; // r5@48
  void *v14; // r0@49
  int v16; // [sp+4h] [bp-86Ch]@1
  int v17; // [sp+28h] [bp-848h]@2
  int v18; // [sp+504h] [bp-36Ch]@48
  unsigned __int8 v19; // [sp+704h] [bp-16Ch]@3
  int v20; // [sp+804h] [bp-6Ch]@1
  char v21; // [sp+820h] [bp-50h]@2

  memset(&v20, 0, 0x5Cu);
  memset(&v16, 0, 0x500u);
  is_success = ddnsapi_read_config_by_service_type(0, &unk_B4B05, &v16);
  if ( is_success )
  {
    ddnsapi_get_status(&v17, &v20);
    if ( !v21 )
    {
      is_success = 1;
      v3 = (const char *)get_ux_text_common(697, v2);
      strcpy((char *)&v19, v3);
      goto LABEL_44;
    }
    strcpy((char *)&v19, &v21);
    is_success = v19;
    if ( !v19 )
    {
      v5 = 697;
LABEL_8:
      v6 = get_ux_text_common(v5, v4);
      sf_strncpy(&v19, v6, 256);
      goto LABEL_44;
    }
    is_success = strcmp((const char *)&v19, "SUCCESS");
    if ( !is_success )
    {
      v5 = 195;
      goto LABEL_8;
    }
    is_success = strcmp((const char *)&v19, "CONN_FAIL");
    if ( !is_success )
    {
      v5 = 185;
      goto LABEL_8;
    }
    is_success = strcmp((const char *)&v19, "BLOCKED");
    if ( !is_success )
    {
      v5 = 184;
      goto LABEL_8;
    }
    is_success = strcmp((const char *)&v19, "BAD_AUTH");
    if ( !is_success )
    {
      v5 = 183;
      goto LABEL_8;
    }
    is_success = strcmp((const char *)&v19, "PARAMETER_INVALID");
    if ( !is_success )
    {
      v5 = 193;
      goto LABEL_8;
    }
    is_success = strcmp((const char *)&v19, "DOMAIN_NOT_SUPPORTED");
    if ( !is_success )
    {
      v5 = 188;
      goto LABEL_8;
    }
    if ( !strcmp((const char *)&v19, "HOSTNAME_NOT_EXIST") )
    {
      v8 = 190;
    }
    else
    {
      is_success = strcmp((const char *)&v19, "USER_IS_NOT_A_DONATOR");
      if ( !is_success )
      {
        v5 = 199;
        goto LABEL_8;
      }
      is_success = strcmp((const char *)&v19, "NOT_YOURS");
      if ( !is_success )
      {
        v5 = 191;
        goto LABEL_8;
      }
      is_success = strcmp((const char *)&v19, "CUSTOM_DNS_NOT_ACT");
      if ( !is_success )
      {
        v5 = 186;
        goto LABEL_8;
      }
      is_success = strcmp((const char *)&v19, "HOSTNAME_IS_BLOCKED_BY_ABUSE");
      if ( !is_success )
      {
        v5 = 189;
        goto LABEL_8;
      }
      is_success = strcmp((const char *)&v19, "TOO_MANY_OR_FEW");
      if ( !is_success )
      {
        v5 = 196;
        goto LABEL_8;
      }
      is_success = strcmp((const char *)&v19, "DDNS_ERROR");
      if ( !is_success )
      {
        v5 = 187;
        goto LABEL_8;
      }
      is_success = strcmp((const char *)&v19, "SERVER_SHUTDOWN");
      if ( !is_success )
      {
        v5 = 194;
        goto LABEL_8;
      }
      is_success = strcmp((const char *)&v19, "ONLY_ONE_DOMAIN");
      if ( !is_success )
      {
        v5 = 192;
        goto LABEL_8;
      }
      is_success = strcmp((const char *)&v19, (const char *)&unk_AC7D8);
      if ( !is_success )
      {
        v5 = 198;
        goto LABEL_8;
      }
      if ( !strcmp((const char *)&v19, "FORGET_MYINFO") )
        v8 = 202;
      else
        v8 = 697;
    }
    v9 = get_ux_text_common(v8, v7);
    is_success = 0;
    sf_strncpy(&v19, v9, 256);
  }
  else
  {
    v10 = (const char *)get_ux_text_common(681, v0);
    strcpy((char *)&v19, v10);
  }
LABEL_44:
  v11 = strchr((const char *)&v19, 59);
  if ( v11 )
    v12 = 0;
  if ( v11 )
    *v11 = v12;
  v13 = (char *)&v18
      + snprintf(
          (char *)&v18,
          0x80u,
          "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap; width:140px; text-overflow:ellipsis;\">",
          &v21);
  if ( is_success )
  {
    v14 = get_image_dir();
    v13 += snprintf(v13, 0x80u, "<img width=10 height=10 src=\"/%s/apply_ani.gif\"> ", v14);
  }
  snprintf(v13, 0x80u, "%s</span>", &v19);
  puts("<script>");
  printf("if(parent.document.getElementById('ipdisk_status'))");
  printf("parent.document.getElementById('ipdisk_status').innerHTML = '%s';", &v18);
  puts("</script>");
  return is_success;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 11714: using guessed type int __fastcall ddnsapi_read_config_by_service_type(_DWORD, _DWORD, _DWORD);
// 11B28: using guessed type int __fastcall ddnsapi_get_status(_DWORD, _DWORD);

//----- (00052E4C) --------------------------------------------------------
char *__fastcall getFile(const char *a1)
{
  const char *v1; // r5@1
  char *v2; // r4@1
  int v3; // r0@2
  int v5; // r6@4
  FILE *v6; // r5@4

  v1 = a1;
  v2 = (char *)file_exists(a1);
  if ( !v2 )
    return v2;
  v3 = get_filesize(v1);
  if ( !v3 )
    return strdup("");
  v5 = v3 + 4;
  v2 = (char *)malloc(v3 + 4);
  strcpy(v2, "");
  v6 = fopen(v1, "r");
  if ( v6 )
  {
    fgets(v2, v5, v6);
    fclose(v6);
  }
  else
  {
    v2 = 0;
  }
  return v2;
}
// 11084: using guessed type int __fastcall get_filesize(_DWORD);
// 11A2C: using guessed type int __fastcall file_exists(_DWORD);

//----- (00052ED4) --------------------------------------------------------
signed int getMediaStatus()
{
  char *v0; // r0@1
  const char *v1; // r6@1
  size_t v2; // r0@2
  char *v3; // r5@2
  size_t v4; // r4@3
  size_t v5; // r0@3
  size_t v6; // r0@4
  char *v7; // r4@4
  size_t v8; // r7@4
  int v9; // r1@4
  const char *v10; // r0@4
  int v11; // r1@4
  int v12; // r0@4
  char *v13; // r0@6
  char *v14; // r7@6
  int v15; // r0@6
  int v16; // r0@6
  int v17; // r1@6
  const char *v18; // r0@7
  void *v19; // r0@9
  int v20; // r1@9
  const char *v21; // r0@11
  signed int v22; // r5@12
  const char *v23; // r2@15
  char *v24; // r0@15
  char v26; // [sp+Ch] [bp-804h]@6
  int v27; // [sp+80Ch] [bp-4h]@1
  char v28; // [sp+890h] [bp+80h]@3
  int v29; // [sp+8A0h] [bp+90h]@3
  char s; // [sp+AA0h] [bp+290h]@3
  int v31; // [sp+AA4h] [bp+294h]@17
  char v32; // [sp+CA0h] [bp+490h]@9
  char v33; // [sp+DA0h] [bp+590h]@6
  time_t v34; // [sp+DE0h] [bp+5D0h]@9

  get_media_config(&v27);
  v0 = getFile("/tmp/.dlna-av_scan");
  v1 = v0;
  if ( v0 )
  {
    v2 = strlen(v0);
    v3 = (char *)malloc(3 * v2 + 16);
    strcpy(v3, "");
    if ( *v1 )
    {
      snprintf(&s, 0x200u, "/tmp/mnt/%s/%s", &v28, &v29);
      v4 = strlen(&s) + 1;
      v5 = strlen(v1);
      iconv_to_local(&v1[v4], v3, 3 * v5);
    }
    v6 = strlen(v3);
    v7 = (char *)malloc(v6 + 128);
    v8 = strlen(v3);
    v10 = (const char *)get_ux_text_common(617, v9);
    snprintf(v7, v8 + 128, v10);
    v12 = get_ux_text_common(617, v11);
    getStatusScript((int)"media_status", v12);
    getStatusScript((int)"media_db_update_file", (int)v3);
    free((void *)v1);
    if ( v3 )
      free(v3);
    v22 = 1;
  }
  else
  {
    v13 = (char *)malloc(0x200u);
    v7 = v13;
    v14 = v13;
    v15 = get_media_db_filename(&v27);
    iconv_to_utf8(v15, &v26, 2048);
    v16 = stat(&v26, (struct stat *)&v33);
    if ( v16 == -1 )
    {
      v18 = (const char *)get_ux_text_common(614, v17);
      snprintf(v7, 0x200u, v18);
    }
    else
    {
      if ( get_timed_status(v16) )
      {
        v19 = getNowDayMonth(v34, (int)v1);
        sf_strncpy(&v32, v19, 256);
      }
      else
      {
        snprintf(&v32, 0x100u, "--");
      }
      v21 = (const char *)get_ux_text_common(616, v20);
      snprintf(v14, 0x200u, v21, &v32);
    }
    v22 = 0;
    getStatusScript((int)"media_db_update_file", (int)"");
  }
  getStatusScript((int)"media_db_status", (int)v7);
  if ( v28 )
  {
    v23 = (const char *)get_media_db_folder(&v27);
    v24 = &s;
  }
  else
  {
    v23 = "/mnt--";
    v24 = &s;
  }
  snprintf(v24, 0x200u, v23);
  getStatusScript((int)"media_db_folder", (int)&v31);
  if ( v7 )
    free(v7);
  return v22;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 109AC: using guessed type int __fastcall get_media_config(_DWORD);
// 10B14: using guessed type int __fastcall iconv_to_utf8(_DWORD, _DWORD, _DWORD);
// 10BB0: using guessed type int __fastcall get_media_db_folder(_DWORD);
// 11120: using guessed type int __fastcall get_media_db_filename(_DWORD);
// 11270: using guessed type int __fastcall iconv_to_local(_DWORD, _DWORD, _DWORD);
// 120EC: using guessed type int __cdecl get_timed_status(_DWORD);

//----- (00053150) --------------------------------------------------------
signed int getiTunesStatus()
{
  char *v0; // r0@1
  const char *v1; // r6@1
  size_t v2; // r0@2
  char *v3; // r5@2
  size_t v4; // r4@3
  size_t v5; // r0@3
  size_t v6; // r0@4
  char *v7; // r4@4
  size_t v8; // r7@4
  int v9; // r1@4
  const char *v10; // r0@4
  int v11; // r1@4
  int v12; // r0@4
  char *v13; // r0@6
  char *v14; // r8@6
  int v15; // r0@6
  int v16; // r0@6
  int v17; // r1@6
  const char *v18; // r0@7
  void *v19; // r0@9
  int v20; // r1@9
  const char *v21; // r0@11
  signed int v22; // r5@12
  const char *v23; // r2@15
  char *v24; // r0@15
  char v26; // [sp+8h] [bp-7F8h]@6
  int v27; // [sp+808h] [bp+8h]@1
  char v28; // [sp+890h] [bp+90h]@3
  int v29; // [sp+8A0h] [bp+A0h]@3
  char s; // [sp+AA0h] [bp+2A0h]@3
  int v31; // [sp+AA4h] [bp+2A4h]@17
  char v32; // [sp+CA0h] [bp+4A0h]@9
  char v33; // [sp+DA0h] [bp+5A0h]@6
  time_t v34; // [sp+DE0h] [bp+5E0h]@9

  get_itunes_config(&v27);
  v0 = getFile((const char *)&unk_B4C58);
  v1 = v0;
  if ( v0 )
  {
    v2 = strlen(v0);
    v3 = (char *)malloc(3 * v2 + 16);
    strcpy(v3, "");
    if ( *v1 )
    {
      snprintf(&s, 0x200u, "/tmp/mnt/%s/%s", &v28, &v29);
      v4 = strlen(&s) + 1;
      v5 = strlen(v1);
      iconv_to_local(&v1[v4], v3, 3 * v5);
    }
    v6 = strlen(v3);
    v7 = (char *)malloc(v6 + 128);
    v8 = strlen(v3);
    v10 = (const char *)get_ux_text_common(617, v9);
    snprintf(v7, v8 + 128, v10);
    v12 = get_ux_text_common(617, v11);
    getStatusScript((int)"media_status", v12);
    getStatusScript((int)"media_db_update_file", (int)v3);
    free((void *)v1);
    if ( v3 )
      free(v3);
    v22 = 1;
  }
  else
  {
    v13 = (char *)malloc(0x200u);
    v7 = v13;
    v14 = v13;
    v15 = get_itunes_db_filename(&v27);
    iconv_to_utf8(v15, &v26, 2048);
    v16 = stat(&v26, (struct stat *)&v33);
    if ( v16 == -1 )
    {
      v18 = (const char *)get_ux_text_common(443, v17);
      snprintf(v7, 0x200u, v18);
    }
    else
    {
      if ( get_timed_status(v16) )
      {
        v19 = getNowDayMonth(v34, (int)v1);
        sf_strncpy(&v32, v19, 256);
      }
      else
      {
        snprintf(&v32, 0x100u, "--");
      }
      v21 = (const char *)get_ux_text_common(445, v20);
      snprintf(v14, 0x200u, v21, &v32);
    }
    v22 = 0;
    getStatusScript((int)"itunes_db_update_file", (int)"");
  }
  getStatusScript((int)"itunes_db_status", (int)v7);
  if ( v28 )
  {
    v23 = (const char *)get_itunes_db_folder(&v27);
    v24 = &s;
  }
  else
  {
    v23 = "/mnt--";
    v24 = &s;
  }
  snprintf(v24, 0x200u, v23);
  getStatusScript((int)"itunes_db_folder", (int)&v31);
  if ( v7 )
    free(v7);
  return v22;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 109E8: using guessed type int __fastcall get_itunes_db_folder(_DWORD);
// 10B14: using guessed type int __fastcall iconv_to_utf8(_DWORD, _DWORD, _DWORD);
// 10C04: using guessed type int __fastcall get_itunes_db_filename(_DWORD);
// 11270: using guessed type int __fastcall iconv_to_local(_DWORD, _DWORD, _DWORD);
// 115B8: using guessed type int __fastcall get_itunes_config(_DWORD);
// 120EC: using guessed type int __cdecl get_timed_status(_DWORD);

//----- (000533CC) --------------------------------------------------------
void *sub_533CC()
{
  void *v0; // r0@3
  char *v1; // r1@3
  int v3; // [sp+0h] [bp-530h]@2
  char v4; // [sp+24h] [bp-50Ch]@3
  char v5; // [sp+500h] [bp-30h]@1

  if ( !get_wan_ip("wan1", &v5) )
  {
    get_ifconfig((int)"br0", (int)&v5, 0);
LABEL_6:
    v0 = &unk_CA75C;
    v1 = &v5;
    goto LABEL_7;
  }
  if ( !ddnsapi_read_config_by_service_type(0, &unk_B4B05, &v3) )
    goto LABEL_6;
  v0 = &unk_CA75C;
  v1 = &v4;
LABEL_7:
  sf_strncpy(v0, v1, 128);
  return &unk_CA75C;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 11714: using guessed type int __fastcall ddnsapi_read_config_by_service_type(_DWORD, _DWORD, _DWORD);
// 119B4: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);

//----- (00053454) --------------------------------------------------------
void *__fastcall sub_53454(const char *a1)
{
  const char *v1; // r4@1
  char *v2; // r0@2
  const char *v3; // r1@2
  void *v4; // r0@9
  char v6; // [sp+Ch] [bp-22Ch]@9
  int v7; // [sp+1Ch] [bp-21Ch]@9

  v1 = a1;
  strcpy((char *)&unk_CA7DC, "");
  if ( !strcmp(v1, "ftp") )
  {
    v2 = (char *)&unk_CA7DC;
    v3 = "http://download.iptime.co.kr/online_upgrade/iptimenas_setup.exe";
LABEL_5:
    strcpy(v2, v3);
    return &unk_CA7DC;
  }
  if ( !strcmp(v1, "rsync") )
  {
    v2 = (char *)&unk_CA7DC;
    v3 = "http://download.iptime.co.kr/online_upgrade/iptime_cloudbackup_setup.exe";
    goto LABEL_5;
  }
  if ( !strcmp(v1, "torrent") )
  {
    v2 = (char *)&unk_CA7DC;
    v3 = "http://download.iptime.co.kr/transmission_ui.html";
    goto LABEL_5;
  }
  if ( !strcmp(v1, "torrent_web") )
  {
    get_torrent_config(&v6);
    v4 = sub_533CC();
    snprintf((char *)&unk_CA7DC, 0x100u, (const char *)&unk_B4D75, v4, v7);
  }
  else if ( !strcmp(v1, "cupsd") )
  {
    snprintf((char *)&unk_CA7DC, 0x100u, "http://download.iptime.co.kr/online_upgrade/iptime_network_printer_setup.exe");
  }
  return &unk_CA7DC;
}
// 11984: using guessed type int __fastcall get_torrent_config(_DWORD);

//----- (00053568) --------------------------------------------------------
int ipcloudUnregister()
{
  char v1; // [sp+8h] [bp-D30h]@2
  int v2; // [sp+408h] [bp-930h]@2
  int v3; // [sp+808h] [bp-530h]@2
  int v4; // [sp+C08h] [bp-130h]@2
  int v5; // [sp+D08h] [bp-30h]@2

  if ( make_auth() == -1 )
    return 0;
  get_ipcloud_rand_str(&v5);
  snprintf((char *)&v3, 0x400u, "rv=%s&auth=%s&", &v5, &v4);
  encode_ipcloud_crypt(&v3, &v2);
  unlink("/tmp/ipdisk_ddns_response");
  snprintf(
    &v1,
    0x400u,
    "/usr/bin/wget 'http://members.ipcloud.co.kr:%d/ipcloud/ipdisk_unregister.php?value=%s' -q -O %s",
    33798,
    &v2,
    "/tmp/ipdisk_ddns_response");
  system(&v1);
  return 0;
}
// 10CAC: using guessed type int make_auth(void);
// 110C0: using guessed type int __fastcall encode_ipcloud_crypt(_DWORD, _DWORD);
// 11540: using guessed type int __fastcall get_ipcloud_rand_str(_DWORD);

//----- (0005361C) --------------------------------------------------------
signed int __fastcall sub_5361C(int a1)
{
  signed int result; // r0@3
  char v2; // [sp+8h] [bp-2410h]@1
  int v3; // [sp+1008h] [bp-1410h]@1
  int v4; // [sp+2008h] [bp-410h]@1

  snprintf((char *)&v4, 0x400u, "/mnt/%s/%s", a1 + 8, a1 + 24);
  iconv_to_utf8(&v4, &v3, 4096);
  quote_r(&v3, 4096);
  snprintf(&v2, 0x1000u, "%s/%s", &v3, "index.html");
  if ( file_exists(&v2) || (snprintf(&v2, 0x1000u, "%s/%s", &v3, "index.phtml"), file_exists(&v2)) )
  {
    result = 1;
  }
  else
  {
    snprintf(&v2, 0x1000u, "%s/%s", &v3, "index.php");
    result = file_exists(&v2) != 0;
  }
  return result;
}
// 10700: using guessed type int __fastcall quote_r(_DWORD, _DWORD);
// 10B14: using guessed type int __fastcall iconv_to_utf8(_DWORD, _DWORD, _DWORD);
// 11A2C: using guessed type int __fastcall file_exists(_DWORD);

//----- (00053724) --------------------------------------------------------
FILE *__fastcall sub_53724(int a1)
{
  int v1; // r6@1
  FILE *result; // r0@1
  FILE *v3; // r6@1
  char v4; // [sp+8h] [bp-2650h]@1
  int v5; // [sp+1008h] [bp-1650h]@1
  int v6; // [sp+2008h] [bp-650h]@1
  int v7; // [sp+2408h] [bp-250h]@1
  int v8; // [sp+25C8h] [bp-90h]@1

  v1 = a1;
  get_si("pi", &v7);
  snprintf((char *)&v8, 0x80u, (const char *)&v7);
  snprintf((char *)&v6, 0x400u, "/mnt/%s/%s", v1 + 8, v1 + 24);
  iconv_to_utf8(&v6, &v5, 4096);
  quote_r(&v5, 4096);
  snprintf(&v4, 0x1000u, "%s/%s", &v5, "index.html");
  result = fopen(&v4, "w+");
  v3 = result;
  if ( !result )
    return result;
  fputs("<html>\n", result);
  fputs("<style>\n", v3);
  fputs("body { font: normal normal normal 12px arial; }\n", v3);
  fputs("</style>\n", v3);
  fputs(
    "- This page will be shown unless there is index.html,index.php,index.phtml in document root of httpd.conf<br>",
    v3);
  fprintf(v3, "<H1>Apache Web server(%s)</H1>\n", &v8);
  fputs("<LI>Server version: Apache/2.4.3 (Unix)</LI>\n", v3);
  fputs("<LI>PHP information :5.4.8</LI>", v3);
  fputs("</html>\n", v3);
  fclose(v3);
  chmod(&v4, 0x1B6u);
  result = (FILE *)1;
  return result;
}
// 104B4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// 10700: using guessed type int __fastcall quote_r(_DWORD, _DWORD);
// 10B14: using guessed type int __fastcall iconv_to_utf8(_DWORD, _DWORD, _DWORD);

//----- (000538AC) --------------------------------------------------------
const char *__fastcall sub_538AC(int a1)
{
  int v1; // r4@1
  int v2; // r0@1
  const char *v3; // r6@1
  const char *v4; // r0@3
  int v5; // r9@4
  int v6; // r10@6
  int v7; // r7@6
  bool v8; // zf@6
  int v9; // r0@10
  int v10; // r0@12
  int v11; // r0@14
  const char *v12; // r0@16
  int v13; // r5@18
  const char *v14; // r0@18
  const char *v15; // r0@21
  const char *v16; // r0@23
  char *v17; // r2@25
  const char *v18; // r0@26
  int v19; // r0@29
  const char *v20; // r1@29
  const char *v21; // r0@31
  const char *v22; // r0@33
  int v23; // r0@36
  char *v24; // r1@36
  int v25; // r0@40
  char *v26; // r1@40
  const char *v27; // r0@44
  int v28; // r0@48
  const char *v29; // r0@50
  const char *v30; // r0@52
  const char *v31; // r0@54
  int v32; // r0@58
  const char *v33; // r0@60
  const char *v34; // r0@63
  int v35; // r0@65
  int v36; // r11@66
  int v37; // r0@67
  const char *v38; // r10@68
  int v39; // r0@75
  const char *v40; // r0@77
  const char *v41; // r0@80
  const char *v42; // r0@82
  const char *v43; // r0@84
  const char *v44; // r0@86
  int v45; // r0@88
  const char *v46; // r9@89
  int v47; // r0@90
  const char *v48; // r0@98
  const char *v49; // r0@101
  int v50; // r1@104
  int v51; // r0@106
  const char *v52; // r8@107
  int v53; // r0@108
  const char *v54; // r0@119
  const char *v55; // r0@122
  int v56; // r0@124
  int v57; // r0@126
  int v58; // r0@131
  int v59; // r0@133
  const char *v60; // r0@143
  const char *v61; // r0@146
  int v62; // r1@148
  const char *v63; // r0@150
  const char *v64; // r0@152
  const char *v65; // r0@154
  int v66; // r0@156
  int v67; // r0@158
  const char *v68; // r0@166
  const char *v69; // r0@169
  int v70; // r1@172
  int v71; // r0@174
  const char *v72; // r0@176
  int v73; // r0@178
  const char *v74; // r0@189
  int v75; // r0@190
  int v76; // r0@191
  const char *v77; // r0@193
  const char *v78; // r0@195
  const char *v79; // r0@199
  int v80; // r0@201
  char *v81; // r1@201
  int v82; // r5@207
  const char *v83; // r11@208
  int v84; // r1@215
  int v85; // r1@217
  int v86; // r1@219
  char file; // [sp+14h] [bp-281Ch]@6
  int v89; // [sp+18h] [bp-2818h]@9
  int v90; // [sp+38h] [bp-27F8h]@9
  int v91; // [sp+438h] [bp-23F8h]@9
  int v92; // [sp+478h] [bp-23B8h]@9
  int v93; // [sp+4F8h] [bp-2338h]@9
  int v94; // [sp+C14h] [bp-1C1Ch]@119
  int v95; // [sp+C18h] [bp-1C18h]@123
  int v96; // [sp+C1Ch] [bp-1C14h]@126
  int v97; // [sp+C2Ch] [bp-1C04h]@129
  int v98; // [sp+E2Ch] [bp-1A04h]@133
  int v99; // [sp+E3Ch] [bp-19F4h]@137
  int v100; // [sp+103Ch] [bp-17F4h]@70
  char v101; // [sp+1040h] [bp-17F0h]@216
  unsigned __int8 v102; // [sp+10C0h] [bp-1770h]@218
  int v103; // [sp+1240h] [bp-15F0h]@220
  signed int v104; // [sp+1344h] [bp-14ECh]@210
  int v105; // [sp+143Ch] [bp-13F4h]@169
  int v106; // [sp+14C4h] [bp-136Ch]@182
  int v107; // [sp+14D4h] [bp-135Ch]@181
  int v108; // [sp+16D4h] [bp-115Ch]@169
  int v109; // [sp+16D8h] [bp-1158h]@177
  int v110; // [sp+16DCh] [bp-1154h]@173
  int v111; // [sp+175Ch] [bp-10D4h]@176
  int v112; // [sp+176Ch] [bp-10C4h]@181
  int v113; // [sp+196Ch] [bp-EC4h]@101
  int v114; // [sp+19F0h] [bp-E40h]@112
  int v115; // [sp+1A00h] [bp-E30h]@111
  char v116; // [sp+1C00h] [bp-C30h]@101
  int v117; // [sp+1C04h] [bp-C2Ch]@105
  int v118; // [sp+1C84h] [bp-BACh]@108
  int v119; // [sp+1C94h] [bp-B9Ch]@111
  int v120; // [sp+1E94h] [bp-99Ch]@143
  int v121; // [sp+1E98h] [bp-998h]@147
  int v122; // [sp+1E9Ch] [bp-994h]@149
  int v123; // [sp+1EBCh] [bp-974h]@151
  int v124; // [sp+1EC0h] [bp-970h]@153
  int v125; // [sp+1EC4h] [bp-96Ch]@155
  int v126; // [sp+1EC8h] [bp-968h]@158
  int v127; // [sp+1ED8h] [bp-958h]@161
  char v128; // [sp+2000h] [bp-830h]@25
  int v129; // [sp+20D8h] [bp-758h]@75
  int v130; // [sp+20DCh] [bp-754h]@85
  int v131; // [sp+20E0h] [bp-750h]@87
  int v132; // [sp+20E4h] [bp-74Ch]@83
  int v133; // [sp+20E8h] [bp-748h]@76
  int v134; // [sp+20ECh] [bp-744h]@90
  int v135; // [sp+20FCh] [bp-734h]@93
  int v136; // [sp+22FCh] [bp-534h]@58
  int v137; // [sp+2300h] [bp-530h]@59
  int v138; // [sp+2304h] [bp-52Ch]@67
  int v139; // [sp+2314h] [bp-51Ch]@70
  int v140; // [sp+2514h] [bp-31Ch]@33
  int v141; // [sp+2518h] [bp-318h]@38
  int v142; // [sp+2598h] [bp-298h]@42
  int v143; // [sp+2618h] [bp-218h]@45
  int v144; // [sp+2620h] [bp-210h]@199
  int v145; // [sp+2628h] [bp-208h]@203
  int v146; // [sp+26BCh] [bp-174h]@14
  int v147; // [sp+26E0h] [bp-150h]@15
  int v148; // [sp+26E4h] [bp-14Ch]@15
  int v149; // [sp+26ECh] [bp-144h]@31
  char s; // [sp+2740h] [bp-F0h]@9
  int v151; // [sp+2744h] [bp-ECh]@49
  int v152; // [sp+2748h] [bp-E8h]@55
  char s1; // [sp+27C0h] [bp-70h]@2
  int v154; // [sp+2800h] [bp-30h]@194
  int v155; // [sp+2804h] [bp-2Ch]@196

  v1 = a1;
  v2 = get_parameter_value(a1, "service");
  v3 = (const char *)v2;
  if ( !v2 )
    return v3;
  sf_strncpy(&s1, v2, 64);
  if ( !strcmp(&s1, "ipdisk") )
  {
    v4 = (const char *)get_parameter_value(v1, "run");
    if ( v4 )
      v5 = atoi(v4);
    else
      v5 = 1;
    v6 = get_parameter_value(v1, "hostname");
    v7 = get_parameter_value(v1, "email");
    memset(&file, 0, 0x500u);
    v8 = v7 == 0;
    if ( v7 )
      v8 = v6 == 0;
    if ( !v8 )
    {
      sf_strncpy(&v90, v6, 1024);
      strcat((char *)&v90, ".ipdisk.co.kr");
      sf_strncpy(&v91, v7, 64);
      sf_strncpy(&v92, v7, 64);
      strcpy((char *)&v93, "wan1");
      strcpy((char *)&v89, (const char *)&unk_B4B05);
      snprintf(&s, 0x80u, "ddns+%s", &v90);
      system("/usr/bin/killall -9 ddns_client");
      ddnsapi_remove_by_service_type(&unk_B4B05);
      if ( v5 )
        v9 = ddnsapi_add_config(&file);
      else
        v9 = ipcloudUnregister();
      v10 = signal_save(v9);
      signal_wan(v10);
    }
    goto LABEL_207;
  }
  if ( !strcmp(&s1, "ftp") )
  {
    v11 = get_ftpd_config(&v146);
    if ( local_gateway_is_default_gateway(v11) )
    {
      system2("/sbin/upnpc -d %d tcp", v147);
      system2("/sbin/upnpc -d %d tcp", v148);
    }
    v12 = (const char *)get_parameter_value(v1, "run");
    if ( v12 )
      v146 = atoi(v12);
    v13 = v146;
    v14 = (const char *)get_parameter_value(v1, "port_method");
    if ( v14 && !strcmp(v14, "default") )
    {
      v147 = 21;
    }
    else
    {
      v15 = (const char *)get_parameter_value(v1, "ftp_port");
      if ( v15 )
        v147 = atoi(v15);
    }
    v16 = (const char *)get_parameter_value(v1, &unk_B4FEE);
    if ( v16 && !strcmp(v16, "default") )
    {
      v17 = &v128;
      v148 = 9000;
    }
    else
    {
      v18 = (const char *)get_parameter_value(v1, "ipdisk_port");
      if ( v18 )
        v148 = atoi(v18);
      v17 = &v128;
    }
    *((_DWORD *)v17 + 442) = 1;
    v19 = get_parameter_value(v1, "ftp_encoding");
    v20 = "AUTO";
    if ( v19 )
      v20 = (const char *)v19;
    sf_strncpy(&v149, v20, 64);
    set_ftpd_config(&v146);
    system("/usr/bin/killall -9 ddns_client");
    v21 = (const char *)ddnsapi_clear_status_by_service_type(&unk_B4B05);
    goto LABEL_206;
  }
  if ( !strcmp(&s1, "samba") )
  {
    get_samba_config(&v140);
    v22 = (const char *)get_parameter_value(v1, "run");
    if ( v22 )
      v140 = atoi(v22);
    v13 = v140;
    if ( v140 )
    {
      v23 = get_parameter_value(v1, "samba_name");
      v24 = "";
      if ( v23 )
        v24 = (char *)v23;
      sf_strncpy(&v141, v24, 128);
      if ( !(_BYTE)v141 )
        strcpy((char *)&v141, "iptimenas");
      v25 = get_parameter_value(v1, "samba_group");
      v26 = "";
      if ( v25 )
        v26 = (char *)v25;
      sf_strncpy(&v142, v26, 128);
      if ( !(_BYTE)v142 )
        strcpy((char *)&v142, "WORKGROUP");
      v27 = (const char *)get_parameter_value(v1, &unk_B504B);
      if ( v27 )
        v143 = atoi(v27);
    }
    v21 = (const char *)set_samba_config(&v140);
    goto LABEL_206;
  }
  if ( !strcmp(&s1, "url") )
  {
    v28 = get_urlsvc_config(&s);
    if ( local_gateway_is_default_gateway(v28) )
      system2("/sbin/upnpc -d %d tcp", v151);
    v29 = (const char *)get_parameter_value(v1, "run");
    if ( v29 )
      *(_DWORD *)&s = atoi(v29);
    v13 = *(_DWORD *)&s;
    v30 = (const char *)get_parameter_value(v1, "url_port");
    if ( v30 )
      v151 = atoi(v30);
    v31 = (const char *)get_parameter_value(v1, "url_login");
    if ( v31 )
      v152 = atoi(v31);
    v21 = (const char *)set_urlsvc_config(&s);
    goto LABEL_206;
  }
  if ( strcmp(&s1, "rsync") )
  {
    if ( !strcmp(&s1, "torrent") )
    {
      v39 = get_torrent_config(&v129);
      if ( local_gateway_is_default_gateway(v39) )
        system2("/sbin/upnpc -d %d tcp", v133);
      v40 = (const char *)get_parameter_value(v1, "run");
      if ( v40 )
        v129 = atoi(v40);
      v13 = v129;
      if ( !v129 )
        goto LABEL_96;
      v41 = (const char *)get_parameter_value(v1, "tr_remote_port");
      if ( v41 )
        v133 = atoi(v41);
      v42 = (const char *)get_parameter_value(v1, "keep_seeding");
      if ( v42 )
        v132 = atoi(v42);
      v43 = (const char *)get_parameter_value(v1, "max_down_rate");
      if ( v43 )
        v130 = atoi(v43);
      v44 = (const char *)get_parameter_value(v1, "max_up_rate");
      if ( v44 )
        v131 = atoi(v44);
      v45 = get_parameter_value(v1, "torrent_hddname");
      v3 = (const char *)v45;
      if ( !v45 )
        return v3;
      v46 = (const char *)check_unpermitted_chars(v45);
      if ( v46 )
        return 0;
      sf_strncpy(&v134, v3, 16);
      v47 = get_parameter_value(v1, "torrent_folder");
      v3 = (const char *)v47;
      if ( !v47 )
        return v3;
      v38 = (const char *)check_unpermitted_chars(v47);
      if ( v38 )
        return v46;
      if ( strstr(v3, "..") )
        return v38;
      sf_strncpy(&v135, v3, 512);
      snprintf((char *)&v100, 0x3FFu, "/mnt/%s/%s", &v134, &v135);
      iconv_to_utf8(&v100, &file, 3072);
      quote_r(&file, 3072);
      if ( !file_exists(&file) && system2("mkdir -p '%s'", &file) )
        return (const char *)-1;
      chmod(&file, 0x1FFu);
LABEL_96:
      v21 = (const char *)set_torrent_config(&v129);
      goto LABEL_206;
    }
    if ( !strcmp(&s1, "media") )
    {
      v48 = (const char *)get_parameter_value(v1, "update_media_db");
      if ( v48 && !strcmp(v48, "update") )
        istatus_set_intvalue_direct("update_media_db", 1);
      get_media_config(&v116);
      get_media_config(&v113);
      v49 = (const char *)get_parameter_value(v1, "run");
      if ( v49 )
        *(_DWORD *)&v116 = atoi(v49);
      v13 = *(_DWORD *)&v116;
      if ( !*(_DWORD *)&v116 )
        goto LABEL_117;
      v50 = get_parameter_value(v1, "media_name");
      if ( v50 )
        sf_strncpy(&v117, v50, 128);
      v51 = get_parameter_value(v1, "media_hddname");
      v38 = (const char *)v51;
      if ( !v51 )
        return v38;
      v52 = (const char *)check_unpermitted_chars(v51);
      if ( v52 )
        return 0;
      sf_strncpy(&v118, v38, 16);
      v53 = get_parameter_value(v1, "media_folder");
      v38 = (const char *)v53;
      if ( !v53 )
        return v38;
      v46 = (const char *)check_unpermitted_chars(v53);
      if ( v46 )
        return v52;
      if ( strstr(v38, "..") )
        return v46;
      sf_strncpy(&v119, v38, 512);
      if ( strcmp((const char *)&v119, (const char *)&v115) || strcmp((const char *)&v118, (const char *)&v114) )
        istatus_set_intvalue_direct("update_media_db", 1);
      snprintf((char *)&v100, 0x3FFu, "/mnt/%s/%s", &v118, &v119);
      iconv_to_utf8(&v100, &file, 3072);
      quote_r(&file, 3072);
      if ( !file_exists(&file) && system2("mkdir -p '%s'", &file) )
        return (const char *)-1;
      chmod(&file, 0x1FFu);
LABEL_117:
      v21 = (const char *)set_media_config(&v116);
      goto LABEL_206;
    }
    if ( !strcmp(&s1, "apache") )
    {
      get_apache_config(&v94);
      v54 = (const char *)get_parameter_value(v1, "run");
      if ( v54 )
        v94 = atoi(v54);
      v13 = v94;
      if ( v94 )
      {
        v55 = (const char *)get_parameter_value(v1, "apache_port");
        if ( v55 )
          v95 = atoi(v55);
        v56 = get_parameter_value(v1, "apache_doc_hddname");
        v3 = (const char *)v56;
        if ( !v56 )
          return v3;
        v38 = (const char *)check_unpermitted_chars(v56);
        if ( v38 )
          return 0;
        sf_strncpy(&v96, v3, 16);
        v57 = get_parameter_value(v1, "apache_doc_folder");
        v3 = (const char *)v57;
        if ( !v57 )
          return v3;
        v46 = (const char *)check_unpermitted_chars(v57);
        if ( v46 )
          return v38;
        if ( strstr(v3, "..") )
          return v46;
        sf_strncpy(&v97, v3, 512);
        snprintf((char *)&v100, 0x3FFu, "/mnt/%s/%s", &v96, &v97);
        iconv_to_utf8(&v100, &file, 3072);
        quote_r(&file, 3072);
        if ( !file_exists(&file) && system2("mkdir -p '%s'", &file) )
          return (const char *)-1;
        chmod(&file, 0x1FFu);
        v58 = get_parameter_value(v1, "apache_server_hddname");
        v46 = (const char *)v58;
        if ( !v58 )
          return v46;
        if ( check_unpermitted_chars(v58) )
          return 0;
        sf_strncpy(&v98, v46, 16);
        v59 = get_parameter_value(v1, "apache_server_folder");
        v46 = (const char *)v59;
        if ( !v59 )
          return v46;
        v36 = check_unpermitted_chars(v59);
        if ( v36 )
          return 0;
        if ( strstr(v46, "..") )
          goto LABEL_235;
        sf_strncpy(&v99, v46, 512);
        snprintf((char *)&v100, 0x3FFu, "/mnt/%s/%s", &v98, &v99);
        iconv_to_utf8(&v100, &file, 3072);
        quote_r(&file, 3072);
        if ( !file_exists(&file) && system2("mkdir -p '%s'", &file) )
          return (const char *)-1;
        chmod(&file, 0x1FFu);
        if ( !sub_5361C((int)&v94) )
          sub_53724((int)&v94);
      }
      v21 = (const char *)set_apache_config(&v94);
      goto LABEL_206;
    }
    if ( !strcmp(&s1, "mysql") )
    {
      get_mysql_config(&v120);
      v60 = (const char *)get_parameter_value(v1, "run");
      if ( v60 )
        v120 = atoi(v60);
      v13 = v120;
      if ( v120 )
      {
        v61 = (const char *)get_parameter_value(v1, "mysql_port");
        if ( v61 )
          v121 = atoi(v61);
        v62 = get_parameter_value(v1, "mysql_charset");
        if ( v62 )
          sf_strncpy(&v122, v62, 32);
        v63 = (const char *)get_parameter_value(v1, "mysql_use_client_charset");
        if ( v63 )
          v123 = atoi(v63);
        v64 = (const char *)get_parameter_value(v1, "mysql_use_case");
        if ( v64 )
          v124 = atoi(v64);
        v65 = (const char *)get_parameter_value(v1, "mysql_max_allow_packet");
        if ( v65 )
          v125 = atoi(v65);
        v66 = get_parameter_value(v1, "mysql_hddname");
        v38 = (const char *)v66;
        if ( !v66 )
          return v38;
        v3 = (const char *)check_unpermitted_chars(v66);
        if ( v3 )
          return 0;
        sf_strncpy(&v126, v38, 16);
        v67 = get_parameter_value(v1, "mysql_folder");
        v38 = (const char *)v67;
        if ( !v67 )
          return v38;
        v52 = (const char *)check_unpermitted_chars(v67);
        if ( v52 )
          return v3;
        if ( strstr(v38, "..") )
          return v52;
        sf_strncpy(&v127, v38, 512);
        snprintf((char *)&v100, 0x3FFu, "/mnt/%s/%s", &v126, &v127);
        iconv_to_utf8(&v100, &file, 3072);
        quote_r(&file, 3072);
        if ( !file_exists(&file) && system2("mkdir -p '%s'", &file) )
          return (const char *)-1;
        chmod(&file, 0x1FFu);
      }
      v21 = (const char *)set_mysql_config(&v120);
      goto LABEL_206;
    }
    if ( strcmp(&s1, "itunes") )
    {
      if ( !strcmp(&s1, "tethering") )
      {
        v74 = (const char *)get_parameter_value(v1, "run");
        if ( v74 )
        {
          v75 = atoi(v74);
          v74 = (const char *)set_usb_tethering_op(v75);
        }
        v76 = signal_update(v74);
        signal_save(v76);
        return (const char *)1;
      }
      if ( !strcmp(&s1, "cupsd") )
      {
        v77 = (const char *)get_parameter_value(v1, "run");
        if ( v77 )
          v154 = atoi(v77);
        v78 = (const char *)get_parameter_value(v1, "cupsd_remote");
        if ( v78 )
          v155 = atoi(v78);
        set_cupsd_config(&v154);
        goto LABEL_207;
      }
      if ( strcmp(&s1, "afp") )
        return 0;
      get_afp_config(&v144);
      v79 = (const char *)get_parameter_value(v1, "run");
      if ( v79 )
        v144 = atoi(v79);
      v13 = v144;
      v80 = get_parameter_value(v1, "afp_name");
      v81 = "";
      if ( v80 )
        v81 = (char *)v80;
      sf_strncpy(&v145, v81, 128);
      if ( !(_BYTE)v145 )
        strcpy((char *)&v145, "iptimenas");
      v21 = (const char *)set_afp_config(&v144);
      goto LABEL_206;
    }
    v68 = (const char *)get_parameter_value(v1, "update_itunes_db");
    if ( v68 && !strcmp(v68, "update") )
      istatus_set_intvalue_direct("update_itunes_db", 1);
    get_itunes_config(&v108);
    get_itunes_config(&v105);
    v69 = (const char *)get_parameter_value(v1, "run");
    if ( v69 )
      v108 = atoi(v69);
    v13 = v108;
    if ( v108 )
    {
      v70 = get_parameter_value(v1, "itunes_name");
      if ( v70 )
        sf_strncpy(&v110, v70, 128);
      v71 = get_parameter_value(v1, "itunes_hddname");
      v3 = (const char *)v71;
      if ( !v71 )
        return v3;
      if ( check_unpermitted_chars(v71) )
        return 0;
      sf_strncpy(&v111, v3, 16);
      v72 = (const char *)get_parameter_value(v1, "itunes_scan_period");
      if ( v72 )
        v109 = 60 * atoi(v72);
      v73 = get_parameter_value(v1, "itunes_folder");
      v52 = (const char *)v73;
      if ( !v73 )
        return v52;
      v3 = (const char *)check_unpermitted_chars(v73);
      if ( v3 )
        return 0;
      if ( strstr(v52, "..") )
        return v3;
      sf_strncpy(&v112, v52, 512);
      if ( strcmp((const char *)&v112, (const char *)&v107) || strcmp((const char *)&v111, (const char *)&v106) )
        istatus_set_intvalue_direct("update_itunes_db", 1);
      snprintf((char *)&v100, 0x3FFu, "/mnt/%s/%s", &v111, &v112);
      iconv_to_utf8(&v100, &file, 3072);
      quote_r(&file, 3072);
      if ( !file_exists(&file) && system2("mkdir -p '%s'", &file) )
        return (const char *)-1;
      chmod(&file, 0x1FFu);
    }
    v21 = (const char *)set_itunes_config(&v108);
    goto LABEL_206;
  }
  v32 = get_rsync_config((int)&v136);
  if ( local_gateway_is_default_gateway(v32) )
    system2("/sbin/upnpc -d %d tcp", v137);
  v33 = (const char *)get_parameter_value(v1, "run");
  if ( v33 )
    v136 = atoi(v33);
  v13 = v136;
  if ( !v136 )
    goto LABEL_73;
  v34 = (const char *)get_parameter_value(v1, "rsync_port");
  if ( v34 )
    v137 = atoi(v34);
  v35 = get_parameter_value(v1, "rsync_hddname");
  v3 = (const char *)v35;
  if ( !v35 )
    return v3;
  v36 = check_unpermitted_chars(v35);
  if ( v36 )
    return 0;
  sf_strncpy(&v138, v3, 16);
  v37 = get_parameter_value(v1, "rsync_folder");
  v3 = (const char *)v37;
  if ( !v37 )
    return v3;
  v38 = (const char *)check_unpermitted_chars(v37);
  if ( !v38 )
  {
    if ( strstr(v3, "..") )
      return v38;
    sf_strncpy(&v139, v3, 512);
    snprintf((char *)&v100, 0x3FFu, "/mnt/%s/%s", &v138, &v139);
    iconv_to_utf8(&v100, &file, 3072);
    quote_r(&file, 3072);
    if ( !file_exists(&file) && system2("mkdir -p '%s'", &file) )
      return (const char *)-1;
    chmod(&file, 0x1FFu);
LABEL_73:
    v21 = (const char *)set_rsync_config(&v136);
LABEL_206:
    if ( v13 )
    {
LABEL_207:
      v82 = 0;
      do
      {
        memset(&v100, 0, 0x30Cu);
        v21 = (const char *)get_pvalue_array(v1, "property", v82);
        v83 = v21;
        if ( v21 )
        {
          if ( !strcmp(v21, "off") )
          {
            v104 = 0;
          }
          else if ( !strcmp(v83, "readwrite") )
          {
            v104 = 1;
          }
          else if ( !strcmp(v83, "readonly") )
          {
            v104 = 2;
          }
          v84 = get_pvalue_array(v1, "user_id", v82);
          if ( v84 )
            sf_strncpy(&v101, v84, 64);
          v85 = get_pvalue_array(v1, "passwd", v82);
          if ( v85 )
            sf_strncpy(&v102, v85, 128);
          v86 = get_pvalue_array(v1, "folder", v82);
          if ( v86 )
            sf_strncpy(&v103, v86, 256);
          else
            memset(&v103, 0, 0x100u);
          v21 = (const char *)check_unpermitted_chars(&v101);
          if ( v21 )
            break;
          v21 = (const char *)check_unpermitted_password_chars(&v102);
          if ( v21 )
            break;
          remove_user_system(&s1, v82);
          if ( v104 || v101 || v102 )
          {
            set_nas_user(&s1, v82, &v100);
            v21 = (const char *)set_nas_user_system(&s1, &v100);
          }
          else
          {
            v21 = (const char *)set_nas_user(&s1, v82, v102);
          }
        }
        ++v82;
      }
      while ( v82 != 5 );
    }
    signal_save(v21);
    if ( !strcmp(&s1, "ftp") )
      strcpy(&s1, (const char *)&unk_B529E);
    signal_nas(&s1);
    sleep(3u);
    return (const char *)1;
  }
LABEL_235:
  v3 = (const char *)v36;
  return v3;
}
// 103E8: using guessed type int __fastcall set_samba_config(_DWORD);
// 10514: using guessed type int __fastcall istatus_set_intvalue_direct(_DWORD, _DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10634: using guessed type int __fastcall get_mysql_config(_DWORD);
// 10700: using guessed type int __fastcall quote_r(_DWORD, _DWORD);
// 10718: using guessed type int __fastcall get_apache_config(_DWORD);
// 107A8: using guessed type int __fastcall remove_user_system(_DWORD, _DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 10814: using guessed type int __fastcall local_gateway_is_default_gateway(_DWORD);
// 10844: using guessed type int __fastcall signal_nas(_DWORD);
// 10850: using guessed type int __fastcall set_torrent_config(_DWORD);
// 10868: using guessed type int __fastcall set_apache_config(_DWORD);
// 1091C: using guessed type int __fastcall get_ftpd_config(_DWORD);
// 1094C: using guessed type int __fastcall get_urlsvc_config(_DWORD);
// 109AC: using guessed type int __fastcall get_media_config(_DWORD);
// 10B14: using guessed type int __fastcall iconv_to_utf8(_DWORD, _DWORD, _DWORD);
// 10D78: using guessed type int __fastcall set_media_config(_DWORD);
// 10DB4: using guessed type int __fastcall set_cupsd_config(_DWORD);
// 10DFC: using guessed type int __fastcall set_usb_tethering_op(_DWORD);
// 10E38: using guessed type int __fastcall set_itunes_config(_DWORD);
// 10F10: using guessed type int __fastcall ddnsapi_add_config(_DWORD);
// 10F1C: using guessed type int __fastcall set_urlsvc_config(_DWORD);
// 11000: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// 11114: using guessed type int __fastcall set_rsync_config(_DWORD);
// 1112C: using guessed type int __fastcall get_samba_config(_DWORD);
// 11144: using guessed type int __fastcall signal_wan(_DWORD);
// 11360: using guessed type int system2(const char *, ...);
// 113D8: using guessed type int __fastcall get_afp_config(_DWORD);
// 115B8: using guessed type int __fastcall get_itunes_config(_DWORD);
// 115C4: using guessed type int __fastcall set_ftpd_config(_DWORD);
// 11774: using guessed type int __fastcall set_nas_user_system(_DWORD, _DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 11984: using guessed type int __fastcall get_torrent_config(_DWORD);
// 11A2C: using guessed type int __fastcall file_exists(_DWORD);
// 11A98: using guessed type int __fastcall get_pvalue_array(_DWORD, _DWORD, _DWORD);
// 11B94: using guessed type int __fastcall set_mysql_config(_DWORD);
// 11CE4: using guessed type int __fastcall check_unpermitted_password_chars(_DWORD);
// 11D68: using guessed type int __fastcall ddnsapi_clear_status_by_service_type(_DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);
// 11FCC: using guessed type int __fastcall set_afp_config(_DWORD);
// 12008: using guessed type int __fastcall ddnsapi_remove_by_service_type(_DWORD);
// 120A4: using guessed type int __fastcall set_nas_user(_DWORD, _DWORD, _DWORD);

//----- (00054E24) --------------------------------------------------------
void __fastcall print_iframe_natrouteconf_router_setup(int a1)
{
  int v1; // r6@1
  int v2; // r5@1
  void *v3; // r4@1
  const char *v4; // r8@1
  int v5; // r1@1
  signed int v6; // r6@4
  int v7; // r1@7
  int v8; // r1@8
  int v9; // r0@8
  int v10; // r0@9
  int v11; // r1@10
  void *v12; // r0@11
  int v13; // r0@11
  int v14; // r0@13
  int v15; // r7@13
  int v16; // r0@13
  const char *v17; // r0@15
  int v18; // r0@16
  int v19; // r1@17
  const char *v20; // r0@20
  int v21; // r0@21
  void *v22; // r0@22
  int v23; // r0@22
  int v24; // r7@22
  int v25; // r0@22
  int v26; // r1@22
  const char *v27; // r0@25
  int v28; // r0@26
  int v29; // r1@26
  int v30; // r0@27
  int v31; // r1@27
  const char *v32; // r0@30
  int v33; // r0@31
  int v34; // r1@32
  void *v35; // r0@33
  int v36; // r0@33
  int v37; // r7@33
  int v38; // r0@33
  const char *v39; // r0@35
  int v40; // r0@36
  int v41; // r1@37
  const char *v42; // r0@40
  int v43; // r0@41
  int v44; // r1@42
  void *v45; // r0@43
  int v46; // r0@43
  int v47; // r7@43
  int v48; // r0@43
  const char *v49; // r0@45
  int v50; // r0@46
  int v51; // r1@47
  void *v52; // r0@48
  int v53; // r0@48
  int v54; // r7@48
  int v55; // r0@48
  const char *v56; // r0@50
  int v57; // r0@51
  int v58; // r1@52
  const char *v59; // r0@55
  int v60; // r0@56
  int v61; // r1@57
  const char *v62; // r0@60
  int v63; // r0@61
  int v64; // r1@62
  int v65; // r0@64
  int v66; // r1@64
  int v67; // r0@64
  int v68; // r1@64
  int v69; // r0@64
  int v70; // r1@64
  int v71; // r0@65
  char v72; // [sp+8h] [bp-1B40h]@6
  int v73; // [sp+508h] [bp-1640h]@21
  int v74; // [sp+50Ch] [bp-163Ch]@22
  char s; // [sp+930h] [bp-1218h]@43
  int v76; // [sp+938h] [bp-1210h]@52
  int v77; // [sp+9B8h] [bp-1190h]@52
  int v78; // [sp+9C8h] [bp-1180h]@52
  int v79; // [sp+D30h] [bp-E18h]@36
  int v80; // [sp+D34h] [bp-E14h]@37
  int v81; // [sp+DB4h] [bp-D94h]@37
  int v82; // [sp+DC4h] [bp-D84h]@37
  int v83; // [sp+FC4h] [bp-B84h]@26
  int v84; // [sp+FC8h] [bp-B80h]@27
  int v85; // [sp+1208h] [bp-940h]@31
  int v86; // [sp+1218h] [bp-930h]@33
  int v87; // [sp+142Ch] [bp-71Ch]@41
  int v88; // [sp+1430h] [bp-718h]@43
  int v89; // [sp+1444h] [bp-704h]@43
  int v90; // [sp+1644h] [bp-504h]@16
  int v91; // [sp+1648h] [bp-500h]@18
  int v92; // [sp+1844h] [bp-304h]@11
  int v93; // [sp+184Ch] [bp-2FCh]@57
  int v94; // [sp+1944h] [bp-204h]@7
  int v95; // [sp+1A44h] [bp-104h]@9
  int v96; // [sp+1A68h] [bp-E0h]@11
  int v97; // [sp+1AC8h] [bp-80h]@2
  int v98; // [sp+1B08h] [bp-40h]@46
  int v99; // [sp+1B0Ch] [bp-3Ch]@48
  int v100; // [sp+1B28h] [bp-20h]@61

  v1 = a1;
  v2 = get_num_of_mountdev(0);
  v3 = malloc(0x800u);
  memset(v3, 0, 0x800u);
  v4 = sub_538AC(v1);
  v5 = get_parameter_value(v1, "service");
  if ( v5 )
    sf_strncpy(&v97, v5, 64);
  else
    strcpy((char *)&v97, "ipdisk");
  v6 = 5;
  print_js_file((int)"basicapp", (int)"service");
  printf("<BODY style=\"padding:0px 0px; margin:0px 0px;\">");
  printf("<form method=get action=\"timepro.cgi\" name=\"main_form\" style='margin: 0;'>");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=\"smenu\" value=\"nas_service\">");
  printf("<input type=hidden name=\"click_id\" value=>");
  printf("<input type=hidden name=\"click_bg\" value=>");
  printf("<input type=hidden name=service value=>");
  printf("<input type=hidden name=run value=>");
  printf("<input type=hidden name=port_method value=>");
  printf("<input type=hidden name=ipdisk_port_method value=>");
  printf("<input type=hidden name=hostname value=>");
  printf("<input type=hidden name=email value=>");
  printf("<input type=hidden name=ftp_port value=>");
  printf("<input type=hidden name=ipdisk_port value=>");
  printf("<input type=hidden name=ftp_encoding value=>");
  printf("<input type=hidden name=rsync_port value=>");
  printf("<input type=hidden name=rsync_hddname value=>");
  printf("<input type=hidden name=rsync_folder value=>");
  printf("<input type=hidden name=tr_remote_port value=>");
  printf("<input type=hidden name=torrent_hddname value=>");
  printf("<input type=hidden name=torrent_folder value=>");
  printf("<input type=hidden name=media_name value=>");
  printf("<input type=hidden name=media_hddname value=>");
  printf("<input type=hidden name=media_folder value=>");
  printf("<input type=hidden name=update_media_db value=>");
  printf("<input type=hidden name=itunes_name value=>");
  printf("<input type=hidden name=itunes_hddname value=>");
  printf("<input type=hidden name=itunes_folder value=>");
  printf("<input type=hidden name=update_itunes_db value=>");
  printf("<input type=hidden name=itunes_scan_period value=>");
  printf("<input type=hidden name=afp_port value=>");
  printf("<input type=hidden name=afp_name value=>");
  printf("<input type=hidden name=afp_login_restrict value=>");
  printf("<input type=hidden name=afp_sleep_timeout value=>");
  printf("<input type=hidden name=afp_login_attempt value=>");
  printf("<input type=hidden name=afp_login_timeout value=>");
  printf("<input type=hidden name=apache_port value=>");
  printf("<input type=hidden name=apache_doc_hddname value=>");
  printf("<input type=hidden name=apache_doc_folder value=>");
  printf("<input type=hidden name=apache_server_hddname value=>");
  printf("<input type=hidden name=apache_server_folder value=>");
  printf("<input type=hidden name=mysql_port value=>");
  printf("<input type=hidden name=mysql_charset value=>");
  printf("<input type=hidden name=mysql_use_client_charset value=>");
  printf("<input type=hidden name=mysql_use_case value=>");
  printf("<input type=hidden name=mysql_max_allow_packet value=>");
  printf("<input type=hidden name=mysql_hddname value=>");
  printf("<input type=hidden name=mysql_folder value=>");
  printf("<input type=hidden name=cupsd_remote value=>");
  printf("<input type=hidden name=samba_name value=>");
  printf("<input type=hidden name=samba_group value=>");
  printf("<input type=hidden name=url_login value=>");
  printf("<input type=hidden name=url_port value=>");
  do
  {
    printf("<input type=hidden name=user_id value=>");
    printf("<input type=hidden name=passwd value=>");
    printf("<input type=hidden name=property value=>");
    printf("<input type=hidden name=folder value=>");
    --v6;
  }
  while ( v6 );
  printf("<table style=\"border-collapse:collapse; border-style:none none none none; width:100%%;\" cellspacing=0px cellpadding=0px>\n");
  printf("<COL WIDTH=9><COL WIDTH=200><COL WIDTH=150><COL>");
  memset(&v72, 0, 0x500u);
  if ( ddnsapi_read_config_by_service_type(0, &unk_B4B05, &v72) )
  {
    snprintf((char *)&v94, 0x100u, "<span id=ipdisk_status></span>");
    snprintf(
      (char *)v3,
      0x200u,
      "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap; width:300px; text-overflow:ellipsis;\">%s</span>");
  }
  else
  {
    snprintf((char *)&v94, 0x100u, "<span id=ipdisk_status></span>");
    v9 = get_ux_text_common(680, v8);
    snprintf((char *)&v94, 0x100u, "%s", v9);
    strcpy((char *)v3, "");
  }
  v10 = get_ux_text_common(676, v7);
  sub_523A0((int)"ipdisk", v10, (int)&v94);
  get_ftpd_config(&v95);
  strcpy((char *)&v94, "<span id=ftp_status>--</span>");
  if ( v95 )
  {
    v12 = sub_533CC();
    v13 = snprintf((char *)&v92, 0x80u, "ftp://%s", v12, 0);
    if ( v96 != 21 )
      snprintf((char *)&v92 + v13, 0x80u, ":%d");
    v14 = snprintf(
            (char *)v3,
            0x200u,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap; width:300px; text-overflow:ellipsis;\">",
            &v92);
    v15 = (int)v3 + v14;
    v16 = snprintf((char *)v3 + v14, 0x200u, "<a target=_blank href='%s'>%s</a>", &v92, &v92);
    snprintf((char *)(v15 + v16), 0x200u, "</span>");
  }
  else
  {
    strcpy((char *)v3, "");
  }
  if ( !v2 )
  {
    v17 = (const char *)get_ux_text_common(931, v11);
    strcpy((char *)&v94, v17);
  }
  v18 = get_ux_text_common(671, v11);
  sub_523A0((int)"ftp", v18, (int)&v94);
  get_samba_config(&v90);
  strcpy((char *)&v94, "<span id=samba_status>--</span>");
  if ( v90 )
    snprintf((char *)v3, 0x200u, "\\\\%s</a>", &v91, 1);
  else
    strcpy((char *)v3, "");
  if ( !v2 )
  {
    v20 = (const char *)get_ux_text_common(931, v19);
    strcpy((char *)&v94, v20);
  }
  v21 = get_ux_text_common(687, v19);
  sub_523A0((int)"samba", v21, (int)&v94);
  get_apache_config(&v73);
  snprintf((char *)&v94, 0x100u, "<span id=apache_status> -- </span>");
  if ( v73 )
  {
    v22 = sub_533CC();
    snprintf((char *)&v90, 0x200u, (const char *)&unk_B4D75, v22, v74);
    v23 = snprintf(
            (char *)v3,
            0x200u,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap; width:300px; text-overflow:ellipsis;\">",
            &v90);
    v24 = (int)v3 + v23;
    v25 = snprintf((char *)v3 + v23, 0x200u, "<a target=_blank href='%s'>%s</a>", &v90, &v90);
    snprintf((char *)(v24 + v25), 0x200u, "</span>");
  }
  else
  {
    strcpy((char *)v3, "");
  }
  if ( !v2 )
  {
    v27 = (const char *)get_ux_text_common(931, v26);
    strcpy((char *)&v94, v27);
  }
  v28 = get_ux_text_common(663, v26);
  sub_523A0((int)"apache", v28, (int)&v94);
  get_mysql_config(&v83);
  snprintf((char *)&v94, 0x100u, "<span id=mysql_status> -- </span>");
  if ( v83 )
  {
    v30 = get_ux_text_common(654, v29);
    snprintf((char *)v3, 0x200u, "%s:%d", v30, v84);
  }
  else
  {
    strcpy((char *)v3, "");
  }
  if ( !v2 )
  {
    v32 = (const char *)get_ux_text_common(931, v31);
    strcpy((char *)&v94, v32);
  }
  v33 = get_ux_text_common(679, v31);
  sub_523A0((int)"mysql", v33, (int)&v94);
  get_torrent_config(&v85);
  strcpy((char *)&v94, "");
  strcpy((char *)v3, "");
  snprintf((char *)&v94, 0x100u, "<span id=torrent_status> -- </span>");
  if ( v85 )
  {
    v35 = sub_533CC();
    snprintf((char *)&v90, 0x200u, (const char *)&unk_B4D75, v35, v86);
    v36 = snprintf(
            (char *)v3,
            0x200u,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap; width:300px; text-overflow:ellipsis;\">",
            &v90);
    v37 = (int)v3 + v36;
    v38 = snprintf((char *)v3 + v36, 0x200u, "<a target=_blank href='%s'>%s</a>", &v90, &v90);
    snprintf((char *)(v37 + v38), 0x200u, "</span>");
  }
  else
  {
    strcpy((char *)v3, "");
  }
  if ( !v2 )
  {
    v39 = (const char *)get_ux_text_common(931, v34);
    strcpy((char *)&v94, v39);
  }
  v40 = get_ux_text_common(696, v34);
  sub_523A0((int)"torrent", v40, (int)&v94);
  get_media_config(&v79);
  snprintf((char *)&v94, 0x100u, "<span id=media_status> -- </span>");
  if ( v79 )
    snprintf((char *)v3, 0x200u, (const char *)&unk_B5E68, &v80, &v81, &v82);
  else
    strcpy((char *)v3, "");
  if ( !v2 )
  {
    v42 = (const char *)get_ux_text_common(931, v41);
    strcpy((char *)&v94, v42);
  }
  v43 = get_ux_text_common(678, v41);
  sub_523A0((int)"media", v43, (int)&v94);
  get_rsync_config((int)&v87);
  strcpy((char *)&v94, "<span id=rsync_status>--</span>");
  if ( v87 )
  {
    v45 = sub_533CC();
    snprintf(&s, 0x400u, "%s:%d/%s", v45, v88, &v89);
    v46 = snprintf(
            (char *)v3,
            0x200u,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap; width:300px; text-overflow:ellipsis;\">",
            &s);
    v47 = (int)v3 + v46;
    v48 = snprintf((char *)v3 + v46, 0x200u, "%s", &s);
    snprintf((char *)(v47 + v48), 0x200u, "</span>");
  }
  else
  {
    strcpy((char *)v3, "");
  }
  if ( !v2 )
  {
    v49 = (const char *)get_ux_text_common(931, v44);
    strcpy((char *)&v94, v49);
  }
  v50 = get_ux_text_common(664, v44);
  sub_523A0((int)"rsync", v50, (int)&v94);
  get_urlsvc_config(&v98);
  snprintf((char *)&v94, 0x100u, "<span id=url_status>--</span>");
  if ( v98 )
  {
    v52 = sub_533CC();
    snprintf((char *)&v90, 0x200u, "http://%s:%d/list", v52, v99);
    v53 = snprintf(
            (char *)v3,
            0x200u,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap; width:300px; text-overflow:ellipsis;\">",
            &v90);
    v54 = (int)v3 + v53;
    v55 = snprintf((char *)v3 + v53, 0x200u, "<a target=_blank href='%s'>%s</a>", &v90, &v90);
    snprintf((char *)(v54 + v55), 0x200u, "</span>");
  }
  else
  {
    strcpy((char *)v3, "");
  }
  if ( !v2 )
  {
    v56 = (const char *)get_ux_text_common(931, v51);
    strcpy((char *)&v94, v56);
  }
  v57 = get_ux_text_common(702, v51);
  sub_523A0((int)"url", v57, (int)&v94);
  get_itunes_config(&s);
  snprintf((char *)&v94, 0x100u, "<span id=itunes_status> -- </span>");
  if ( *(_DWORD *)&s )
    snprintf((char *)v3, 0x200u, (const char *)&unk_B5E68, &v76, &v77, &v78);
  else
    strcpy((char *)v3, "");
  if ( !v2 )
  {
    v59 = (const char *)get_ux_text_common(931, v58);
    strcpy((char *)&v94, v59);
  }
  v60 = get_ux_text_common(677, v58);
  sub_523A0((int)"itunes", v60, (int)&v94);
  get_afp_config(&v92);
  snprintf((char *)&v94, 0x100u, "<span id=afp_status> -- </span>");
  if ( v92 )
    snprintf((char *)v3, 0x200u, "%s", &v93, 9);
  else
    strcpy((char *)v3, "");
  if ( !v2 )
  {
    v62 = (const char *)get_ux_text_common(931, v61);
    strcpy((char *)&v94, v62);
  }
  v63 = get_ux_text_common(662, v61);
  sub_523A0((int)"afp", v63, (int)&v94);
  get_cupsd_config(&v100);
  snprintf((char *)&v94, 0x100u, "<span id=cupsd_status> -- </span>");
  get_ifconfig((int)"br0", (int)&v98, 0);
  if ( v100 )
    snprintf((char *)v3, 0x200u, "http://%s:%d/printers/%s", &v98, 631, "ipTIME_Printer");
  else
    strcpy((char *)v3, "");
  v65 = get_ux_text_common(667, v64);
  sub_523A0((int)"cupsd", v65, (int)&v94);
  snprintf((char *)&v94, 0x100u, "<span id=tethering_status> -- </span>");
  strcpy((char *)v3, "");
  v67 = get_ux_text_common(1398, v66);
  sub_523A0((int)"tethering", v67, (int)&v94);
  strcpy((char *)&v94, "");
  strcpy((char *)v3, "");
  v69 = get_ux_text_common(753, v68);
  sub_523A0((int)"onusers", v69, (int)&v94);
  printf("</table>");
  printf("</BODY>");
  printf("<script> ClickNasService(document.getElementById('%s'));\n", &v97);
  puts("UnMaskIt(parent.document,'apply_mask');");
  printf("</script>");
  printf("<iframe src=\"timepro.cgi?tmenu=iframe_nas_status\" scrolling=no align=left valign=center height=0 frameborder=no name=\"iframe_status\"></iframe>");
  if ( v4 == (const char *)-1 )
  {
    v71 = get_ux_text_common(124, v70);
    printf((const char *)&unk_B6047, v71);
  }
  free(v3);
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10634: using guessed type int __fastcall get_mysql_config(_DWORD);
// 10718: using guessed type int __fastcall get_apache_config(_DWORD);
// 1091C: using guessed type int __fastcall get_ftpd_config(_DWORD);
// 1094C: using guessed type int __fastcall get_urlsvc_config(_DWORD);
// 109AC: using guessed type int __fastcall get_media_config(_DWORD);
// 10FA0: using guessed type int __fastcall get_cupsd_config(_DWORD);
// 1112C: using guessed type int __fastcall get_samba_config(_DWORD);
// 113D8: using guessed type int __fastcall get_afp_config(_DWORD);
// 115B8: using guessed type int __fastcall get_itunes_config(_DWORD);
// 11714: using guessed type int __fastcall ddnsapi_read_config_by_service_type(_DWORD, _DWORD, _DWORD);
// 11804: using guessed type int __fastcall get_num_of_mountdev(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 11984: using guessed type int __fastcall get_torrent_config(_DWORD);

//----- (00055CD4) --------------------------------------------------------
int sub_55CD4()
{
  char *v0; // r5@1
  int v1; // r7@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  char *v5; // r8@2
  int v6; // r0@4
  int v7; // r1@4
  int v8; // r0@6
  int v9; // r1@6
  int v10; // r0@6
  char *v11; // r0@6
  int v12; // r1@8
  int v13; // r0@8
  bool v14; // zf@8
  char *v15; // r1@9
  int v17; // [sp+0h] [bp-598h]@1
  char s1; // [sp+4h] [bp-594h]@8
  char v19; // [sp+24h] [bp-574h]@6
  char v20; // [sp+420h] [bp-178h]@9
  char v21; // [sp+500h] [bp-98h]@6

  memset(&v17, 0, 0x500u);
  v0 = "checked";
  v1 = ddnsapi_read_config_by_service_type(0, &unk_B4B05, &v17);
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  v3 = get_ux_text_common(675, v2);
  printf("<tr height=23px><td style=\"padding-left:5px;\">%s</td>", v3);
  printf("<td colspan=3>");
  if ( v1 )
    v5 = "checked";
  else
    v5 = "";
  v6 = get_ux_text_common(1104, v4);
  printf(
    "<input type=radio id=ipdisk_on name=ipdisk_run value=1 %s onclick=\"InitipDISK();\"><label for=ipdisk_on> %s</label>",
    v5,
    v6);
  print_nbsp(10);
  if ( v1 )
    v0 = "";
  v8 = get_ux_text_common(1111, v7);
  printf(
    "<input type=radio id=ipdisk_off name=ipdisk_run value=0 %s onclick=\"InitipDISK();\"><label for=ipdisk_off> %s</label>",
    v0,
    v8);
  printf("</td></tr>");
  v10 = get_ux_text_common(673, v9);
  printf("<tr height=20px><td style=\"padding-left:5px;\">%s</td>", v10);
  printf("<td colspan=3>");
  sf_strncpy(&v21, &v19, 128);
  v11 = strchr(&v21, 46);
  if ( v11 )
    *v11 = 0;
  printf("<input type=text name=hostname size=31 maxlength=31 value=%s>", &v21);
  printf((const char *)&unk_B61F8);
  printf("</td></tr>");
  v13 = get_ux_text_common(672, v12);
  printf("<tr><td style=\"padding-left:5px;\">%s</td>", v13);
  printf("<td colspan=2>");
  v14 = strcmp(&s1, (const char *)&unk_B4B05) == 0;
  if ( v14 )
    v15 = &v20;
  else
    v15 = "";
  if ( v14 )
    v15 += 4;
  printf("<input type=text name=email size=31 maxlength=31 value=%s>", v15);
  printf("</td>");
  printf("</TABLE>");
  puts("<script>");
  puts("InitipDISK();");
  return puts("</script>");
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 11714: using guessed type int __fastcall ddnsapi_read_config_by_service_type(_DWORD, _DWORD, _DWORD);

//----- (00055EA8) --------------------------------------------------------
int sub_55EA8()
{
  char *v0; // r4@1
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r1@1
  char *v4; // r7@2
  int v5; // r0@4
  int v6; // r1@4
  char *v7; // r7@5
  int v8; // r0@7
  int v9; // r1@7
  int v10; // r0@7
  int v11; // r1@7
  char *v12; // r7@8
  int v13; // r0@10
  int v14; // r1@10
  char *v15; // r7@11
  int v16; // r0@13
  int v17; // r1@13
  int v18; // r0@13
  int v19; // r1@13
  int v20; // r0@13
  int v21; // r1@13
  int v22; // r0@13
  int v23; // r1@13
  int v24; // r0@13
  int v25; // r1@13
  int v26; // r0@15
  int v28; // [sp+0h] [bp-330h]@13
  char v29; // [sp+4h] [bp-32Ch]@13
  char v30; // [sp+84h] [bp-2ACh]@13
  int v31; // [sp+30Ch] [bp-24h]@1
  int v32; // [sp+310h] [bp-20h]@13
  int v33; // [sp+314h] [bp-1Ch]@7

  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  v0 = "checked";
  get_urlsvc_config(&v31);
  v2 = get_ux_text_common(700, v1);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v2);
  if ( v31 )
    v4 = "checked";
  else
    v4 = "";
  v5 = get_ux_text_common(1104, v3);
  printf(
    "<td colspan=3><input type=radio id=url_on name=url_run value=1 %s onclick=\"InitURL();\"><label for=url_on> %s</label>",
    v4,
    v5);
  print_nbsp(14);
  if ( v31 )
    v7 = "";
  else
    v7 = "checked";
  v8 = get_ux_text_common(1111, v6);
  printf(
    "<input type=radio id=url_off name=url_run value=0 %s onclick=\"InitURL();\"><label for=url_off> %s</label>",
    v7,
    v8);
  printf("</td>");
  printf("</tr>");
  v10 = get_ux_text_common(698, v9);
  printf("<tr height=23px><td style=\"padding-left:5px;\">%s</td>", v10);
  printf("<td colspan=3>");
  if ( v33 )
    v12 = "checked";
  else
    v12 = "";
  v13 = get_ux_text_common(1412, v11);
  printf(
    "<input type=radio id=url_login_on name=url_login value=1 %s onclick=\"InitURL();\"><label for=url_login_on> %s</label>",
    v12,
    v13);
  print_nbsp(10);
  if ( v33 )
    v15 = "";
  else
    v15 = "checked";
  v16 = get_ux_text_common(926, v14);
  printf(
    "<input type=radio id=url_login_off name=url_login value=0 %s onclick=\"InitURL();\"><label for=url_login_off> %s</label>",
    v15,
    v16);
  get_urlsvc_config(&v31);
  get_urlsvc_config(&v31);
  printf("</td></tr>");
  get_nas_user("url", 0, &v28);
  v18 = get_ux_text_common(703, v17);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v18);
  printf("<td><input type=text name=url_userid size=20 maxlength=32 value=%s></td>", &v29);
  v20 = get_ux_text_common(704, v19);
  printf("<td style=\"padding-left:5px;\">%s</td>", v20);
  printf(
    "<td><input type=password style=\"width:94px;height:20px;\" name=url_passwd size=12 maxlength=32 value='%s'>",
    &v30);
  printf(
    "<input type=text name=url_passwd_text style=\"width:94px;height:20px;display:none;ime-mode:disabled;\"  size=15 maxl"
    "ength=32 value='%s'>",
    &v30);
  v22 = get_ux_text_common(1415, v21);
  printf(
    "<INPUT TYPE=checkbox id=url_password_view NAME=url_password_view value=1 onclick=\"PasswordView(url_passwd,url_passw"
    "d_text,url_password_view);\" ><label for=url_password_view> %s</label>",
    v22);
  printf("</td></tr>");
  v24 = get_ux_text_common(699, v23);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v24);
  puts("<td colspan=3>");
  printf("<input type=text name=url_port style=\"width:60px;\" size=5 maxlength=5 value=%d>", v32);
  if ( v32 != 8000 )
    v0 = "";
  v26 = get_ux_text_common(141, v25);
  printf(
    "<input type=checkbox id=url_port_method name=url_port_method value=default onclick=\"ClickURLPortMethod();\" %s><lab"
    "el for=url_port_method> %s</label></td>",
    v0,
    v26);
  printf("</td></tr>");
  printf("</TABLE>");
  puts("<script>");
  puts("InitURL();");
  return puts("</script>");
}
// 1094C: using guessed type int __fastcall get_urlsvc_config(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 11CD8: using guessed type int __fastcall get_nas_user(_DWORD, _DWORD, _DWORD);

//----- (00056130) --------------------------------------------------------
int __fastcall sub_56130(int a1, int a2, int a3, char a4, int a5)
{
  char v5; // r6@1
  _DWORD *i; // r4@2
  int v7; // r1@4
  const char *v8; // r0@4
  _DWORD *v9; // r5@6
  signed int v10; // r4@6
  int v11; // r9@7
  int v12; // r4@8
  int v13; // r6@8
  int v14; // ST0C_4@10
  size_t v15; // r0@10
  size_t v16; // r2@10
  int v17; // r3@10
  unsigned int v18; // t1@11
  char *v19; // r0@20
  int v21; // [sp+14h] [bp-CBCh]@6
  char v22; // [sp+18h] [bp-CB8h]@14
  int v23; // [sp+418h] [bp-8B8h]@1
  int v24; // [sp+818h] [bp-4B8h]@14
  int v25; // [sp+C18h] [bp-B8h]@7
  int v26; // [sp+C98h] [bp-38h]@1
  _DWORD *v27; // [sp+C9Ch] [bp-34h]@2
  void *ptr; // [sp+CA4h] [bp-2Ch]@1

  v5 = a4;
  ptr = 0;
  snprintf((char *)&v23, 0x200u, "%s:%s", a1, a2);
  get_mount_list(&v26, 0);
  if ( !a5 )
  {
    for ( i = v27; i; i = (_DWORD *)*i )
    {
      printf("<option value=\"%s_create_DxLoE2LK\">", i + 25);
      v8 = (const char *)get_ux_text_common(1089, v7);
      printf(v8, i + 25);
    }
  }
  v9 = v27;
  v10 = -1;
  v21 = v5 & 1;
  while ( v9 )
  {
    snprintf((char *)&v25, 0x80u, "%s/%s");
    v11 = scandir(
            (const char *)&v25,
            (struct dirent ***)&ptr,
            (int (*)(const struct dirent *))dir_filter,
            (int (*)(const void *, const void *))sub_5275C);
    if ( v11 <= 0 )
      break;
    v12 = 0;
    v13 = 0;
    do
    {
      if ( v21 )
      {
        v14 = *(_DWORD *)((char *)ptr + v12);
        v15 = strlen((const char *)(*(_DWORD *)((char *)ptr + v12) + 11));
        v16 = 0;
        v17 = v14 + 10;
        while ( v16 < v15 )
        {
          v18 = *(_BYTE *)(v17++ + 1);
          if ( v18 > 0x7E )
            goto LABEL_15;
          ++v16;
        }
      }
      iconv_to_local(*(_DWORD *)((char *)ptr + v12) + 11, &v22, 1024);
      snprintf((char *)&v24, 0x400u, "%s:%s", v9 + 25, &v22);
      strcmp((const char *)&v24, (const char *)&v23);
      printf("<option value=\"%s\" %s>", &v24);
      printf("/%s/%s\n", v9 + 25, &v22);
      free(*(void **)((char *)ptr + v12));
LABEL_15:
      ++v13;
      v12 += 4;
    }
    while ( v13 < v11 );
    v9 = (_DWORD *)*v9;
    v10 = v11;
  }
  if ( v10 == -1 && strlen((const char *)&v23) > 1 )
  {
    v19 = strchr((const char *)&v23, 58);
    printf("<option value=\"%s\" selected>/HDD1/%s", &v23, v19 + 1);
  }
  if ( ptr )
    free(ptr);
  return free_mount_list(&v26);
}
// 1064C: using guessed type int __fastcall free_mount_list(_DWORD);
// 11270: using guessed type int __fastcall iconv_to_local(_DWORD, _DWORD, _DWORD);
// 119FC: using guessed type int __fastcall get_mount_list(_DWORD, _DWORD);

//----- (00056394) --------------------------------------------------------
int sub_56394()
{
  char *v0; // r6@1
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r1@1
  char *v4; // r7@2
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6
  int v8; // r1@6
  int v9; // r0@6
  int v10; // r1@6
  int v11; // r0@6
  int v12; // r1@6
  int v13; // r7@6
  int v14; // r1@6
  int v15; // r6@6
  int v16; // r1@6
  int v17; // r4@6
  int v18; // r1@6
  int v19; // r0@6
  int v20; // r3@6
  int v21; // r4@6
  int v22; // r1@7
  char *v23; // r11@8
  int v24; // r0@10
  int v25; // r1@10
  char *v26; // r11@11
  int v27; // r0@13
  int v28; // r1@13
  char *v29; // r11@14
  int v30; // r0@16
  int v31; // r1@16
  int v32; // r0@16
  int v33; // r1@16
  int v34; // r0@16
  char *v35; // r1@16
  char *v36; // r11@17
  char v38; // [sp+10h] [bp-440h]@7
  int v39; // [sp+14h] [bp-43Ch]@16
  char v40; // [sp+94h] [bp-3BCh]@16
  char s; // [sp+214h] [bp-23Ch]@16
  int v42; // [sp+318h] [bp-138h]@7
  int v43; // [sp+31Ch] [bp-134h]@1
  char v44; // [sp+320h] [bp-130h]@6
  int v45; // [sp+3A0h] [bp-B0h]@6

  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr id=samba_setup_table><td style='width:100%%'>");
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  v0 = "checked";
  get_samba_config(&v43);
  printf("<tr height=23>");
  v2 = get_ux_text_common(685, v1);
  printf("<td style=\"padding-left:5px; width:125px;\">%s</td>", v2);
  printf("<td colspan=3>");
  if ( v43 )
    v4 = "checked";
  else
    v4 = "";
  v5 = get_ux_text_common(1104, v3);
  printf(
    "<input type=radio id=samba_on name=samba_run value=1 %s onclick=\"InitSamba();\"><label for=samba_on> %s</label>",
    v4,
    v5);
  print_nbsp(10);
  if ( v43 )
    v0 = "";
  v7 = get_ux_text_common(1111, v6);
  printf(
    "<input type=radio id=samba_off name=samba_run value=0 %s onclick=\"InitSamba();\"><label for=samba_off> %s</label>",
    v0,
    v7);
  printf("</td></tr>");
  v9 = get_ux_text_common(684, v8);
  printf((const char *)&unk_B68EF, v9);
  printf("<td><input type=text name=samba_name value=\"%s\" size=20 maxlength=32></td>", &v44);
  v11 = get_ux_text_common(683, v10);
  printf("<td style=\"padding-left:5px;\">%s</td>", v11);
  printf("<td><input type=text name=samba_group value=\"%s\" size=25 maxlength=32></td></tr>", &v45);
  printf("<tr height=10px><td colspan=4></td></tr>");
  printf("<tr height=23px><td colspan=4>");
  printf("<table>");
  v13 = get_ux_text_common(1403, v12);
  v15 = get_ux_text_common(703, v14);
  v17 = get_ux_text_common(704, v16);
  v19 = get_ux_text_common(658, v18);
  v20 = v17;
  v21 = 0;
  printf(
    "<tr><td style=\"padding-left:5px;\">%s</td><td>%s</td><td>%s</td><td style=\"padding-left:5px;\">%s</td></tr>",
    v13,
    v15,
    v20,
    v19);
  do
  {
    get_nas_user("samba", v21, &v38);
    printf("<tr>");
    printf("<td style=\"padding:0;\"><select name=samba_property onchange=\"ChangeUserProperty('samba','%d');\" >", v21);
    if ( v42 )
      v23 = "";
    else
      v23 = "selected";
    v24 = get_ux_text_common(421, v22);
    printf("<option value=off %s> %s", v23, v24);
    if ( v42 == 1 )
      v26 = "selected";
    else
      v26 = "";
    v27 = get_ux_text_common(423, v25);
    printf("<option value=readwrite %s> %s", v26, v27);
    if ( v42 == 2 )
      v29 = "selected";
    else
      v29 = "";
    v30 = get_ux_text_common(422, v28);
    printf("<option value=readonly %s>%s ", v29, v30);
    printf("</select>");
    printf("</td>");
    printf(
      "<td style=\"padding:0;\"><input type=text name=samba_userid size=21 maxlength=32 style=\"height:20px;\" value=%s></td>",
      &v39);
    printf(
      "<td style=\"padding:0;\"><input type=password style=\"width:130px;height:20px;\" name=samba_passwd size=21 maxleng"
      "th=32 value='%s'>",
      &v40);
    printf(
      "<input type=text name=samba_passwd_text style=\"height:20px;display:none;ime-mode:disabled;width:130px;\"  size=21"
      " maxlength=32 value='%s'>",
      &v40);
    v32 = get_ux_text_common(1415, v31);
    printf(
      "<INPUT TYPE=checkbox id=samba_password_view%d NAME=samba_password_view value=1 onclick=\"PasswordView(samba_passwd"
      "[%d],samba_passwd_text[%d],samba_password_view[%d]);\" ><label for=samba_password_view%d> %s</label>",
      v21,
      v21,
      v21,
      v21,
      v21,
      v32);
    printf("</td><td style=\"padding-left:5px;\">");
    printf("<select style=\"width:180px;\" name=samba_folder>");
    v34 = get_ux_text_common(657, v33);
    printf("<option value=\"\">%s", v34);
    v35 = strchr(&s, 58);
    if ( !v35 || (v36 = strtok(&s, ":"), v35 = strtok(0, ":"), !v36) )
      v36 = "";
    if ( !v35 )
      v35 = "";
    ++v21;
    sub_56130((int)v36, (int)v35, (int)"/mnt", 0, 1);
    printf("</select>");
    puts("</td></tr>");
  }
  while ( v21 != 5 );
  printf("</table>");
  printf("</td></tr>");
  printf("</TABLE>");
  printf("</td></tr>");
  printf("</TABLE>");
  puts("<script>");
  puts("InitSamba();");
  return puts("</script>");
}
// 1112C: using guessed type int __fastcall get_samba_config(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 11CD8: using guessed type int __fastcall get_nas_user(_DWORD, _DWORD, _DWORD);

//----- (00056788) --------------------------------------------------------
int sub_56788()
{
  char *v0; // r7@1
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r1@1
  char *v4; // r6@2
  int v5; // r0@4
  int v6; // r1@4
  char *v7; // r6@5
  int v8; // r0@7
  int v9; // r1@7
  int v10; // r0@7
  int v11; // r1@7
  char *v12; // r8@8
  int v13; // r0@10
  char *v14; // r1@11
  char *v15; // r1@14
  char *v16; // r1@17
  char *v17; // r1@20
  int v18; // r1@22
  int v19; // r0@22
  int v20; // r1@22
  char *v21; // r4@23
  int v22; // r0@25
  int v23; // r1@25
  int v24; // r0@25
  int v25; // r1@25
  int v26; // r0@27
  int v27; // r1@27
  int v28; // r8@27
  int v29; // r1@27
  int v30; // r7@27
  int v31; // r1@27
  int v32; // r4@27
  int v33; // r1@27
  int v34; // r0@27
  int v35; // r3@27
  int v36; // r4@27
  int v37; // r1@28
  char *v38; // r11@29
  int v39; // r0@31
  int v40; // r1@31
  char *v41; // r11@32
  int v42; // r0@34
  int v43; // r1@34
  char *v44; // r11@35
  int v45; // r0@37
  int v46; // r1@37
  int v47; // r0@37
  int v48; // r1@37
  int v49; // r0@37
  char *v50; // r1@37
  char *v51; // r11@38
  int v52; // r1@42
  int v53; // r0@43
  char v55; // [sp+10h] [bp-3B8h]@28
  char v56; // [sp+14h] [bp-3B4h]@37
  char v57; // [sp+94h] [bp-334h]@37
  char v58; // [sp+214h] [bp-1B4h]@37
  int v59; // [sp+318h] [bp-B0h]@28
  int v60; // [sp+31Ch] [bp-ACh]@1
  int v61; // [sp+340h] [bp-88h]@22
  int v62; // [sp+344h] [bp-84h]@25
  int v63; // [sp+34Ch] [bp-7Ch]@7

  get_ftpd_config(&v60);
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  v0 = "checked";
  v2 = get_ux_text_common(669, v1);
  printf("<tr height=23px><td style=\"padding-left:5px; width:125px;\">%s</td>", v2);
  printf("<td colspan=3>");
  if ( v60 )
    v4 = "checked";
  else
    v4 = "";
  v5 = get_ux_text_common(1104, v3);
  printf(
    "<input type=radio id=ftp_on name=ftp_run value=1 %s onclick=\"InitFTP();\"><label for=ftp_on> %s</label>",
    v4,
    v5);
  print_nbsp(10);
  if ( v60 )
    v7 = "";
  else
    v7 = "checked";
  v8 = get_ux_text_common(1111, v6);
  printf(
    "<input type=radio id=ftp_off name=ftp_run value=0 %s onclick=\"InitFTP();\"><label for=ftp_off> %s</label>",
    v7,
    v8);
  printf("</td></tr>");
  printf("<tr height=23px>");
  v10 = get_ux_text_common(668, v9);
  printf("<td style=\"padding-left:5px; width:125px;\">%s</td>", v10);
  printf("<td colspan=3>");
  printf("<select style=\"width:137px;\" name=ftp_encoding>");
  if ( !strcmp((const char *)&v63, "EUC-KR") )
    v12 = "selected";
  else
    v12 = "";
  v13 = get_ux_text_common(377, v11);
  printf("<option value=AUTO %s> %s </option>", v12, v13);
  if ( !strcmp((const char *)&v63, "EUC-KR") )
    v14 = "selected";
  else
    v14 = "";
  printf("<option value=EUC-KR %s> EUC-KR </option>", v14);
  if ( !strcmp((const char *)&v63, "UTF-8") )
    v15 = "selected";
  else
    v15 = "";
  printf("<option value=UTF-8 %s> UTF-8 </option>", v15);
  if ( !strcmp((const char *)&v63, "GB2312") )
    v16 = "selected";
  else
    v16 = "";
  printf("<option value=GB2312 %s> GB2312</option>", v16);
  if ( !strcmp((const char *)&v63, "BIG-5") )
    v17 = "selected";
  else
    v17 = "";
  printf("<option value=BIG-5 %s> BIG-5</option>", v17);
  printf("</select>");
  printf("</td></tr>");
  v19 = get_ux_text_common(674, v18);
  printf("<tr height=23px><td style=\"padding-left:5px; width:125px;\">%s</td>", v19);
  printf("<td colspan=3><input type=text name=ftp_port size=5 maxlength=5 value=%d>", v61);
  if ( v61 == 21 )
    v21 = "checked";
  else
    v21 = "";
  v22 = get_ux_text_common(141, v20);
  printf(
    "<input type=checkbox id=ftp_port_method name=ftp_port_method value=default onclick=\"ClickFTPPortMethod();\" %s><lab"
    "el for=ftp_port_method> %s</label></td>",
    v21,
    v22);
  printf("</td></tr>");
  printf("<tr height=23px>");
  v24 = get_ux_text_common(437, v23);
  printf("<td style=\"padding-left:5px; width:125px;\">%s</td>", v24);
  printf("<td colspan=3><input type=text name=ipdisk_port maxlength=5 size=5 value=%d>", v62);
  if ( v62 != 9000 )
    v0 = "";
  v26 = get_ux_text_common(141, v25);
  printf(
    "<input type=checkbox id=ipdisk_port_method name=ipdisk_port_method value=default %s  onclick=\"ClickServicePortMetho"
    "d()\"><label for=ipdisk_port_method> %s</label></td>",
    v0,
    v26);
  printf("</tr>");
  printf("<tr height=3px><td colspan=4></td></tr>");
  printf("<tr height=23px><td colspan=4>");
  printf("<table cellspacing=0 cellpadding=0>");
  v28 = get_ux_text_common(1403, v27);
  v30 = get_ux_text_common(703, v29);
  v32 = get_ux_text_common(704, v31);
  v34 = get_ux_text_common(658, v33);
  v35 = v32;
  v36 = 0;
  printf(
    "<tr><td style=\"padding-left:5px;\">%s</td><td>%s</td><td>%s</td><td style=\"padding-left:5px;\">%s</td></tr>",
    v28,
    v30,
    v35,
    v34);
  do
  {
    get_nas_user("ftp", v36, &v55);
    printf("<tr style=\"height:23px;\">");
    printf(
      "<td style=\"padding:0 0 0 2px;\"><select name=ftp_property onchange=\"ChangeUserProperty('ftp','%d');\" >",
      v36);
    if ( v59 )
      v38 = "";
    else
      v38 = "selected";
    v39 = get_ux_text_common(421, v37);
    printf("<option value=off %s> %s", v38, v39);
    if ( v59 == 1 )
      v41 = "selected";
    else
      v41 = "";
    v42 = get_ux_text_common(423, v40);
    printf("<option value=readwrite %s> %s", v41, v42);
    if ( v59 == 2 )
      v44 = "selected";
    else
      v44 = "";
    v45 = get_ux_text_common(422, v43);
    printf("<option value=readonly %s>%s ", v44, v45);
    printf("</select>");
    printf("</td>");
    printf(
      "<td style=\"padding:0 0 0 2px;\"><input type=text name=ftp_userid size=21 maxlength=32 style=\"height:20px;\" value=%s></td>",
      &v56);
    printf(
      "<td style=\"padding:0 0 0 2px;\"><input type=password style=\"width:130px;height:20px;\" name=ftp_passwd size=21 m"
      "axlength=32 value='%s'>",
      &v57);
    printf(
      "<input type=text name=ftp_passwd_text style=\"height:20px;display:none;ime-mode:disabled;width:130px;\"  size=21 m"
      "axlength=32 value='%s'>",
      &v57);
    v47 = get_ux_text_common(1415, v46);
    printf(
      "<INPUT TYPE=checkbox id=ftp_password_view%d NAME=ftp_password_view value=1 onclick=\"PasswordView(ftp_passwd[%d],f"
      "tp_passwd_text[%d],ftp_password_view[%d]);\" ><label for=ftp_password_view%d> %s</label>",
      v36,
      v36,
      v36,
      v36,
      v36,
      v47);
    printf("</td><td style=\"padding-left:5px;\">");
    printf("<select style=\"width:180px;\" name=ftp_folder>");
    v49 = get_ux_text_common(657, v48);
    printf("<option value=\"\">%s", v49);
    v50 = strchr(&v58, 58);
    if ( !v50 || (v51 = strtok(&v58, ":"), v50 = strtok(0, ":"), !v51) )
      v51 = "";
    if ( !v50 )
      v50 = "";
    ++v36;
    sub_56130((int)v51, (int)v50, (int)"/mnt", 0, 1);
    printf("</select>");
    puts("</td></tr>");
  }
  while ( v36 != 5 );
  v53 = get_ux_text_common(659, v52);
  printf("<tr><td colspan=4 style=\"padding-left:5px;\"><span class=gray_text>%s</span></td></tr>", v53);
  printf("</table>");
  printf("</td></tr>");
  printf("</TABLE>");
  puts("<script>");
  puts("ClickFTPPortMethod();");
  puts("ClickServicePortMethod();");
  puts("InitFTP();");
  return puts("</script>");
}
// 1091C: using guessed type int __fastcall get_ftpd_config(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 11CD8: using guessed type int __fastcall get_nas_user(_DWORD, _DWORD, _DWORD);

//----- (00056D04) --------------------------------------------------------
int sub_56D04()
{
  char *v0; // r4@1
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r1@1
  char *v4; // r6@2
  int v5; // r0@4
  int v6; // r1@4
  char *v7; // r6@5
  int v8; // r0@7
  int v9; // r1@7
  int v10; // r0@7
  int v11; // r1@7
  int v12; // r0@9
  int v13; // r1@9
  int v14; // r0@9
  int v15; // r1@9
  int v16; // r0@9
  int v17; // r1@9
  int v18; // r0@9
  int v19; // r1@9
  int v20; // r0@9
  int v21; // r1@9
  int v22; // r0@9
  int v23; // r1@9
  int v24; // r0@9
  int v25; // r1@9
  int v26; // r0@9
  int v28; // [sp+Ch] [bp-534h]@9
  char v29; // [sp+10h] [bp-530h]@9
  char v30; // [sp+90h] [bp-4B0h]@9
  int v31; // [sp+318h] [bp-228h]@1
  int v32; // [sp+31Ch] [bp-224h]@7
  char v33; // [sp+320h] [bp-220h]@9
  char v34; // [sp+330h] [bp-210h]@9

  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<COL WIDTH=80><COL WIDTH=200><COL WIDTH=80><COL WIDTH=200>");
  v0 = "checked";
  get_rsync_config((int)&v31);
  v2 = get_ux_text_common(700, v1);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v2);
  if ( v31 )
    v4 = "checked";
  else
    v4 = "";
  v5 = get_ux_text_common(1104, v3);
  printf(
    "<td colspan=3><input type=radio id=rsync_on name=rsync_run value=1 %s onclick=\"InitRsync();\"><label for=rsync_on> %s</label>",
    v4,
    v5);
  print_nbsp(14);
  if ( v31 )
    v7 = "";
  else
    v7 = "checked";
  v8 = get_ux_text_common(1111, v6);
  printf(
    "<input type=radio id=rsync_off name=rsync_run value=0 %s onclick=\"InitRsync();\"><label for=rsync_off> %s</label>",
    v7,
    v8);
  printf("</td>");
  printf("</tr>");
  v10 = get_ux_text_common(699, v9);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v10);
  puts("<td colspan=3>");
  printf("<input type=text name=rsync_port style=\"width:60px;\" size=5 maxlength=5 value=%d>", v32);
  if ( v32 != 1873 )
    v0 = "";
  v12 = get_ux_text_common(141, v11);
  printf(
    "<input type=checkbox id=rsync_port_method name=rsync_port_method value=default onclick=\"ClickRsyncPortMethod();\" %"
    "s><label for=rsync_port_method> %s</label></td>",
    v0,
    v12);
  printf("</td></tr>");
  get_nas_user("rsync", 0, &v28);
  v14 = get_ux_text_common(703, v13);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v14);
  printf("<td><input type=text name=rsync_userid size=23 maxlength=32 value=%s></td>", &v29);
  v16 = get_ux_text_common(704, v15);
  printf("<td style=\"padding-left:5px;\">%s</td>", v16);
  printf(
    "<td><input type=password style=\"width:94px;height:20px;\" name=rsync_passwd size=12 maxlength=32 value='%s'>",
    &v30);
  printf(
    "<input type=text name=rsync_passwd_text style=\"width:94px;height:20px;display:none;ime-mode:disabled;\"  size=15 ma"
    "xlength=32 value='%s'>",
    &v30);
  v18 = get_ux_text_common(1415, v17);
  printf(
    "<INPUT TYPE=checkbox id=rsync_password_view NAME=rsync_password_view value=1 onclick=\"PasswordView(rsync_passwd,rsy"
    "nc_passwd_text,rsync_password_view);\" ><label for=rsync_password_view> %s</label>",
    v18);
  printf("</td></tr>");
  printf("<input type=hidden name=rsync_folder>");
  printf("<input type=hidden name=rsync_hddname>");
  v20 = get_ux_text_common(60, v19);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v20);
  puts("<td colspan=2>");
  printf("<select style=\"width:290;\" name=rsync_path onchange=\"ChangeBackupFolder();\">");
  v22 = get_ux_text_common(1087, v21);
  printf("<option value='select_backup_folder'>%s", v22);
  sub_56130((int)&v33, (int)&v34, (int)"/mnt", 0, 0);
  printf("</select>");
  printf("</td><td>");
  v24 = get_ux_text_common(262, v23);
  printf(
    "<input type=text name=new_folder size=30 maxlength=256 value=\"%s\" style=\"color:#888888; display:none;\" onfocus=\""
    "FocusNewFolder(new_folder,default_folder);\">",
    v24);
  v26 = get_ux_text_common(262, v25);
  printf("<input type=hidden name=\"default_folder\" value=\"%s\">", v26);
  printf("</td></tr>");
  printf("</TABLE>");
  puts("<script>");
  puts("InitRsync();");
  return puts("</script>");
}
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 11CD8: using guessed type int __fastcall get_nas_user(_DWORD, _DWORD, _DWORD);

//----- (00056FCC) --------------------------------------------------------
int sub_56FCC()
{
  char *v0; // r4@1
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r1@1
  char *v4; // r7@2
  int v5; // r0@4
  int v6; // r1@4
  char *v7; // r7@5
  int v8; // r0@7
  int v9; // r1@7
  int v10; // r0@7
  int v11; // r1@7
  int v12; // r0@7
  int v13; // r1@7
  int v14; // r0@7
  int v15; // r1@7
  int v16; // r0@7
  int v17; // r1@7
  int v18; // r0@9
  int v19; // r1@9
  int v20; // r0@9
  int v21; // r1@9
  int v22; // r0@9
  int v23; // r1@9
  int v24; // r0@9
  int v25; // r1@9
  int v26; // r0@9
  int v27; // r1@9
  const char *v28; // r0@10
  int v29; // r1@12
  int v30; // r0@13
  int v31; // r1@13
  int v32; // r0@13
  char v34; // [sp+8h] [bp-568h]@1
  int v35; // [sp+Ch] [bp-564h]@7
  int v36; // [sp+8Ch] [bp-4E4h]@7
  int v37; // [sp+314h] [bp-25Ch]@1
  int v38; // [sp+324h] [bp-24Ch]@7
  char v39; // [sp+328h] [bp-248h]@9
  char v40; // [sp+338h] [bp-238h]@9
  int v41; // [sp+538h] [bp-38h]@11

  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr id=torrent_setup_table><td>");
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<COL WIDTH=80><COL WIDTH=200><COL WIDTH=80><COL WIDTH=200>");
  v0 = "checked";
  get_torrent_config(&v37);
  get_nas_user("torrent", 0, &v34);
  v2 = get_ux_text_common(1096, v1);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v2);
  if ( v37 )
    v4 = "checked";
  else
    v4 = "";
  v5 = get_ux_text_common(1104, v3);
  printf(
    "<td colspan=3><input type=radio id=torrent_on name=torrent_run value=1 %s onclick=\"InitTorrent();\"><label for=torr"
    "ent_on> %s</label>",
    v4,
    v5);
  print_nbsp(14);
  if ( v37 )
    v7 = "";
  else
    v7 = "checked";
  v8 = get_ux_text_common(1111, v6);
  printf(
    "<input type=radio id=torrent_off name=torrent_run value=0 %s onclick=\"InitTorrent();\"><label for=torrent_off> %s</label>",
    v7,
    v8);
  printf("</td>");
  printf("</tr>");
  v10 = get_ux_text_common(693, v9);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v10);
  printf("<td><input type=text name=torrent_userid size=23 maxlength=32 value=%s></td>", &v35);
  v12 = get_ux_text_common(694, v11);
  printf("<td style=\"padding-left:5px;\">%s</td>", v12);
  printf(
    "<td><input type=password style=\"width:94px;height:20px;\" name=torrent_passwd size=12 maxlength=32 value='%s'>",
    &v36);
  printf(
    "<input type=text name=torrent_passwd_text style=\"width:94px;height:20px;display:none;ime-mode:disabled;\"  size=15 "
    "maxlength=32 value='%s'>",
    &v36);
  v14 = get_ux_text_common(1415, v13);
  printf(
    "<INPUT TYPE=checkbox id=torrent_password_view NAME=torrent_password_view value=1 onclick=\"PasswordView(torrent_pass"
    "wd,torrent_passwd_text,torrent_password_view);\" ><label for=torrent_password_view> %s</label>",
    v14);
  printf("</td></tr>");
  v16 = get_ux_text_common(695, v15);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v16);
  puts("<td colspan=3>");
  printf("<input type=text name=tr_remote_port style=\"width:60px;\" size=5 maxlength=5 value=%d>", v38);
  if ( v38 != 9091 )
    v0 = "";
  v18 = get_ux_text_common(141, v17);
  printf(
    "<input type=checkbox id=tr_remote_port_method name=tr_remote_port_method value=default onclick=\"ClickTorrentPortMet"
    "hod();\" %s><label for=tr_remote_port_method> %s</label></td>",
    v0,
    v18);
  printf("</td></tr>");
  printf("<input type=hidden name=torrent_folder>");
  printf("<input type=hidden name=torrent_hddname>");
  v20 = get_ux_text_common(1320, v19);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v20);
  puts("<td colspan=1>");
  printf("<select style=\"width:250;\" name=torrent_path onchange=\"ChangeTorrentFolder();\">");
  v22 = get_ux_text_common(1093, v21);
  printf("<option value='select_torrent_folder'>%s", v22);
  sub_56130((int)&v39, (int)&v40, (int)"/mnt", 0, 0);
  printf("</select>");
  printf("</td><td colspan=2 style=\"padding-left:5px;\">");
  v24 = get_ux_text_common(262, v23);
  printf("<input type=hidden name=\"torrent_default_folder\" value=\"%s\">", v24);
  v26 = get_ux_text_common(262, v25);
  printf(
    "<input type=text name=torrent_new_folder size=30 maxlength=256 value=\"%s\" style=\"color:#888888; display:none;\" o"
    "nfocus=\"FocusNewFolder(torrent_new_folder, torrent_default_folder);\">",
    v26);
  printf("</td></tr>");
  printf("</TABLE>");
  printf("</td></tr>");
  printf("<tr id=torrent_install_table><td>");
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf((const char *)&unk_B81F2);
  if ( get_mount_devpath("/tmp/mnt/HDD1", 0) )
  {
    if ( !get_wan_ip("wan1", &v41) && !get_default_gateway("br0", &v41) )
    {
      v30 = get_ux_text_common(1328, v29);
      printf("%s<br><br>", v30);
      v32 = get_ux_text_common(1329, v31);
      printf("<span class=gray_text>%s</span><br>", v32);
    }
  }
  else
  {
    v28 = (const char *)get_ux_text_common(1321, v27);
    printf(v28);
  }
  printf("</td></tr>");
  printf("</TABLE>");
  printf("</td></tr>");
  printf("</TABLE>");
  puts("<script>");
  puts("InitTorrent();");
  puts("</script>");
  puts("<script>");
  printf("ShowIt('torrent_setup_table');");
  printf("HideIt('torrent_install_table');");
  return puts("</script>");
}
// 10B38: using guessed type int __fastcall get_default_gateway(_DWORD, _DWORD);
// 11258: using guessed type int __fastcall get_mount_devpath(_DWORD, _DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 11984: using guessed type int __fastcall get_torrent_config(_DWORD);
// 119B4: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);
// 11CD8: using guessed type int __fastcall get_nas_user(_DWORD, _DWORD, _DWORD);

//----- (000573B4) --------------------------------------------------------
int sub_573B4()
{
  char *v0; // r6@1
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r1@1
  char *v4; // r8@2
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6
  int v8; // r1@6
  int v9; // r0@6
  int v10; // r1@6
  int v11; // r0@6
  int v12; // r1@6
  int v13; // r0@6
  int v14; // r1@6
  int v15; // r0@6
  int v16; // r1@6
  int v17; // r0@6
  int v18; // r1@6
  int v19; // r0@6
  const char *v20; // r2@7
  char *v21; // r0@7
  int v22; // r1@9
  int v23; // r2@9
  int v24; // r1@9
  const char *v25; // r0@10
  int v26; // r1@12
  int v27; // r0@13
  int v28; // r1@13
  int v29; // r0@13
  int v31; // [sp+Ch] [bp-4CCh]@1
  char v32; // [sp+10h] [bp-4C8h]@6
  char v33; // [sp+90h] [bp-448h]@6
  char v34; // [sp+A0h] [bp-438h]@6
  char v35; // [sp+2A0h] [bp-238h]@7
  char v36; // [sp+2A4h] [bp-234h]@9
  char v37; // [sp+4A0h] [bp-38h]@11

  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr id=media_setup_table><td>");
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<COL WIDTH=100><COL WIDTH=220><COL WIDTH=80><COL WIDTH=160>");
  v0 = "checked";
  get_media_config(&v31);
  v2 = get_ux_text_common(1096, v1);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v2);
  if ( v31 )
    v4 = "checked";
  else
    v4 = "";
  v5 = get_ux_text_common(1104, v3);
  printf(
    "<td colspan=3><input type=radio id=media_on name=media_run value=1 %s onclick=\"InitMedia();\"><label for=media_on> %s</label>",
    v4,
    v5);
  print_nbsp(14);
  if ( v31 )
    v0 = "";
  v7 = get_ux_text_common(1111, v6);
  printf(
    "<input type=radio id=media_off name=media_run value=0 %s onclick=\"InitMedia();\"><label for=media_off> %s</label>",
    v0,
    v7);
  printf("</td>");
  printf("</tr>");
  v9 = get_ux_text_common(629, v8);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v9);
  printf(
    "<td colspan=3><input type=text style=\"width:220;\" name=media_name value=\"%s\"  maxlength=64></td></tr>",
    &v32);
  printf("</td>");
  printf("</tr>");
  printf("<input type=hidden name=media_folder>");
  printf("<input type=hidden name=media_hddname>");
  v11 = get_ux_text_common(627, v10);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v11);
  puts("<td colspan=1>");
  printf("<select style=\"width:220;\" name=media_path onchange=\"ChangeMediaFolder();\">");
  v13 = get_ux_text_common(1090, v12);
  printf("<option value='select_media_folder'>%s", v13);
  sub_56130((int)&v33, (int)&v34, (int)"/mnt", 0, 0);
  printf("</select>");
  printf("</td><td colspan=2 style=\"padding-left:5px;\">");
  v15 = get_ux_text_common(262, v14);
  printf("<input type=hidden name=\"media_default_folder\" value=\"%s\">", v15);
  v17 = get_ux_text_common(262, v16);
  printf(
    "<input type=text name=media_new_folder size=30 maxlength=256 value=\"%s\" style=\"color:#888888; display:none;\" onf"
    "ocus=\"FocusNewFolder(media_new_folder, media_default_folder);\">",
    v17);
  printf("</td></tr>");
  v19 = get_ux_text_common(613, v18);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v19);
  if ( v33 )
  {
    v20 = (const char *)get_media_db_folder(&v31);
    v21 = &v35;
  }
  else
  {
    v20 = "/mnt--";
    v21 = &v35;
  }
  snprintf(v21, 0x200u, v20);
  v23 = get_ux_text_common(615, v22);
  printf(
    "<td><span id=media_db_folder>%s</span></td><td align=left  style=\"padding-left:5px;\" colspan=2><input type=button "
    "name=update_db value=\"%s\" onclick=\"UpdateMediaDB();\" %s></td></tr>",
    &v36,
    v23);
  printf("<tr><td style=\"padding-left:5px;\"></td>");
  printf((const char *)&unk_B86D7);
  printf("<tr><td style=\"padding-left:5px;\"></td>");
  printf("<td colspan=3><span id=media_db_update_file style=\"color:#888888; overflow:hidden; display:inline-block; white-space:nowrap; width:500px; text-overflow:ellipsis;\"></span></td></tr>");
  printf("</TABLE>");
  printf("</td></tr>");
  printf("<tr id=media_install_table><td>");
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf((const char *)&unk_B81F2);
  if ( get_mount_devpath("/tmp/mnt/HDD1", 0) )
  {
    if ( !get_wan_ip("wan1", &v37) && !get_default_gateway("br0", &v37) )
    {
      v27 = get_ux_text_common(625, v26);
      printf("%s<br><br>", v27);
      v29 = get_ux_text_common(626, v28);
      printf("<span class=gray_text>%s</span><br>", v29);
    }
  }
  else
  {
    v25 = (const char *)get_ux_text_common(618, v24);
    printf(v25);
  }
  printf("</td></tr>");
  printf("</TABLE>");
  printf("</td></tr>");
  printf("</TABLE>");
  puts("<script>");
  puts("InitMedia();");
  puts("</script>");
  puts("<script>");
  printf("ShowIt('media_setup_table');");
  printf("HideIt('media_install_table');");
  return puts("</script>");
}
// 109AC: using guessed type int __fastcall get_media_config(_DWORD);
// 10B38: using guessed type int __fastcall get_default_gateway(_DWORD, _DWORD);
// 10BB0: using guessed type int __fastcall get_media_db_folder(_DWORD);
// 11258: using guessed type int __fastcall get_mount_devpath(_DWORD, _DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 119B4: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);

//----- (00057778) --------------------------------------------------------
int sub_57778()
{
  char *v0; // r4@1
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r1@1
  char *v4; // r7@2
  int v5; // r0@4
  int v6; // r1@4
  char *v7; // r7@5
  int v8; // r0@7
  int v9; // r1@7
  int v10; // r0@7
  int v11; // r1@7
  int v12; // r0@9
  int v13; // r1@9
  int v14; // r0@9
  int v15; // r1@9
  int v16; // r0@9
  int v17; // r1@9
  int v18; // r0@9
  int v19; // r1@9
  int v20; // r0@9
  int v21; // r1@9
  int v22; // r0@9
  int v23; // r1@9
  int v24; // r0@9
  int v25; // r1@9
  int v26; // r0@9
  int v27; // r1@9
  int v28; // r0@9
  int v30; // [sp+8h] [bp-440h]@1
  int v31; // [sp+Ch] [bp-43Ch]@7
  char v32; // [sp+10h] [bp-438h]@9
  char v33; // [sp+20h] [bp-428h]@9
  char v34; // [sp+220h] [bp-228h]@9
  char v35; // [sp+230h] [bp-218h]@9

  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr id=apache_setup_table><td>");
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<COL WIDTH=100><COL WIDTH=250><COL WIDTH=80><COL WIDTH=160>");
  v0 = "checked";
  get_apache_config(&v30);
  v2 = get_ux_text_common(1096, v1);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v2);
  if ( v30 )
    v4 = "checked";
  else
    v4 = "";
  v5 = get_ux_text_common(1104, v3);
  printf(
    "<td colspan=3><input type=radio id=apache_on name=apache_run value=1 %s onclick=\"InitApache();\"><label for=apache_on> %s</label>",
    v4,
    v5);
  print_nbsp(14);
  if ( v30 )
    v7 = "";
  else
    v7 = "checked";
  v8 = get_ux_text_common(1111, v6);
  printf(
    "<input type=radio id=apache_off name=apache_run value=0 %s onclick=\"InitApache();\"><label for=apache_off> %s</label>",
    v7,
    v8);
  printf("</td>");
  printf("</tr>");
  v10 = get_ux_text_common(24, v9);
  printf("<tr height=23px><td style=\"padding-left:5px;\">%s</td>", v10);
  printf("<td colspan=3><input type=text name=apache_port size=5 maxlength=5 value=%d>", v31);
  if ( v31 != 8080 )
    v0 = "";
  v12 = get_ux_text_common(141, v11);
  printf(
    "<input type=checkbox id=apache_port_method name=apache_port_method value=default onclick=\"ClickApachePortMethod();\""
    " %s><label for=apache_port_method> %s</label></td>",
    v0,
    v12);
  printf("</td></tr>");
  v14 = get_ux_text_common(25, v13);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v14);
  printf("<input type=hidden name=apache_doc_folder>");
  printf("<input type=hidden name=apache_doc_hddname>");
  puts("<td colspan=1>");
  printf("<select style=\"width:250;\" name=apache_doc_path onchange=\"ChangeApacheDocFolder();\">");
  v16 = get_ux_text_common(1086, v15);
  printf("<option value='select_apache_doc_folder'>%s", v16);
  sub_56130((int)&v32, (int)&v33, (int)"/mnt", 1, 0);
  printf("</select>");
  printf("</td><td colspan=2 style=\"padding-left:5px;\">");
  v18 = get_ux_text_common(262, v17);
  printf("<input type=hidden name=\"apache_doc_default_folder\" value=\"%s\">", v18);
  v20 = get_ux_text_common(262, v19);
  printf(
    "<input type=text name=apache_doc_new_folder size=30 maxlength=256 value=\"%s\" style=\"color:#888888; display:none;\""
    " onfocus=\"FocusNewFolder(apache_doc_new_folder, apache_doc_default_folder);\">",
    v20);
  printf("</td></tr>");
  v22 = get_ux_text_common(26, v21);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v22);
  printf("<input type=hidden name=apache_server_folder>");
  printf("<input type=hidden name=apache_server_hddname>");
  puts("<td colspan=1>");
  printf("<select style=\"width:250;\" name=apache_server_path onchange=\"ChangeApacheServerFolder();\">");
  v24 = get_ux_text_common(1092, v23);
  printf("<option value='select_apache_server_folder'>%s", v24);
  sub_56130((int)&v34, (int)&v35, (int)"/mnt", 1, 0);
  printf("</select>");
  printf("</td><td colspan=2 style=\"padding-left:5px;\">");
  v26 = get_ux_text_common(262, v25);
  printf("<input type=hidden name=\"apache_server_default_folder\" value=\"%s\">", v26);
  v28 = get_ux_text_common(262, v27);
  printf(
    "<input type=text name=apache_server_new_folder size=30 maxlength=256 value=\"%s\" style=\"color:#888888; display:non"
    "e;\" onfocus=\"FocusNewFolder(apache_server_new_folder, apache_server_default_folder);\">",
    v28);
  printf("</td></tr>");
  printf("</TABLE>");
  printf("</td></tr>");
  printf("</TABLE>");
  puts("<script>");
  puts("InitApache();");
  return puts("</script>");
}
// 10718: using guessed type int __fastcall get_apache_config(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);

//----- (00057A8C) --------------------------------------------------------
int sub_57A8C()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  char *v3; // r6@2
  int v4; // r0@4
  int v5; // r1@4
  char *v6; // r6@5
  int v7; // r0@7
  int v8; // r1@7
  int v9; // r0@7
  int v10; // r1@7
  char *v11; // r6@8
  int v12; // r0@10
  int v13; // r1@10
  int v14; // r0@10
  int v15; // r1@10
  int v16; // r0@10
  int v17; // r1@10
  int v18; // r0@10
  int v19; // r1@10
  int v20; // r0@10
  int v21; // r1@10
  int v22; // r0@10
  int v23; // r1@10
  int v24; // r0@10
  char *v25; // r1@11
  int v26; // r1@13
  int v27; // r0@13
  char *v28; // r1@14
  int v29; // r1@16
  int v30; // r0@16
  int v31; // r1@16
  int v32; // r0@16
  int v34; // [sp+Ch] [bp-254h]@1
  int v35; // [sp+10h] [bp-250h]@7
  char v36; // [sp+14h] [bp-24Ch]@10
  int v37; // [sp+34h] [bp-22Ch]@10
  int v38; // [sp+38h] [bp-228h]@13
  int v39; // [sp+3Ch] [bp-224h]@16
  char v40; // [sp+40h] [bp-220h]@10
  char v41; // [sp+50h] [bp-210h]@10

  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr id=mysql_setup_table><td>");
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<COL WIDTH=250><COL WIDTH=200><COL WIDTH=80><COL WIDTH=100>");
  get_mysql_config(&v34);
  v1 = get_ux_text_common(1096, v0);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v1);
  if ( v34 )
    v3 = "checked";
  else
    v3 = "";
  v4 = get_ux_text_common(1104, v2);
  printf(
    "<td colspan=3><input type=radio id=mysql_on name=mysql_run value=1 %s onclick=\"InitMySQL();\"><label for=mysql_on> %s</label>",
    v3,
    v4);
  print_nbsp(14);
  if ( v34 )
    v6 = "";
  else
    v6 = "checked";
  v7 = get_ux_text_common(1111, v5);
  printf(
    "<input type=radio id=mysql_off name=mysql_run value=0 %s onclick=\"InitMySQL();\"><label for=mysql_off> %s</label>",
    v6,
    v7);
  printf("</td>");
  printf("</tr>");
  v9 = get_ux_text_common(654, v8);
  printf("<tr height=23px><td style=\"padding-left:5px;\">%s</td>", v9);
  printf("<td colspan=3><input type=text name=mysql_port size=5 maxlength=5 value=%d>", v35);
  if ( v35 == 3306 )
    v11 = "checked";
  else
    v11 = "";
  v12 = get_ux_text_common(141, v10);
  printf(
    "<input type=checkbox id=mysql_port_method name=mysql_port_method value=default onclick=\"ClickMySQLPortMethod();\" %"
    "s><label for=mysql_port_method> %s</label></td>",
    v11,
    v12);
  printf("</td></tr>");
  v14 = get_ux_text_common(651, v13);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v14);
  printf("<input type=hidden name=mysql_folder>");
  printf("<input type=hidden name=mysql_hddname>");
  puts("<td colspan=1>");
  printf("<select style=\"width:220;\" name=mysql_path onchange=\"ChangeMySQLFolder();\">");
  v16 = get_ux_text_common(1091, v15);
  printf("<option value='select_mysql_folder'>%s", v16);
  sub_56130((int)&v40, (int)&v41, (int)"/mnt", 1, 0);
  printf("</select>");
  printf("</td><td colspan=2 style=\"padding-left:5px;\">");
  v18 = get_ux_text_common(262, v17);
  printf("<input type=hidden name=\"mysql_default_folder\" value=\"%s\">", v18);
  v20 = get_ux_text_common(262, v19);
  printf(
    "<input type=text name=mysql_new_folder size=30 maxlength=256 value=\"%s\" style=\"color:#888888; display:none;\" onf"
    "ocus=\"FocusNewFolder(mysql_new_folder, mysql_default_folder);\">",
    v20);
  printf("</td></tr>");
  v22 = get_ux_text_common(655, v21);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v22);
  puts("<td colspan=3>");
  printf("<select style=\"width:220;\" name=mysql_charset>");
  puts("<OPTION VALUE=\"utf8\">utf8\n\t\t<OPTION VALUE=\"euckr\">euckr\n\t\t<OPTION VALUE=\"armscii8\">armscii8\n\t\t<OPTION VALUE=\"ascii\">ascii\n\t\t<OPTION VALUE=\"big5\">big5\n\t\t<OPTION VALUE=\"binary\">binary\n\t\t<OPTION VALUE=\"cp850\">cp850\n\t\t<OPTION VALUE=\"cp852\">cp852\n\t\t<OPTION VALUE=\"cp866\">cp866\n\t\t<OPTION VALUE=\"cp932\">cp932\n\t\t<OPTION VALUE=\"cp1250\">cp1250\n\t\t<OPTION VALUE=\"cp1251\">cp1251\n\t\t<OPTION VALUE=\"cp1256\">cp1256\n\t\t<OPTION VALUE=\"cp1257\">cp1257\n\t\t<OPTION VALUE=\"dec8\">dec8\n\t\t<OPTION VALUE=\"eucjpms\">eucjpms\n\t\t<OPTION VALUE=\"gb2312\">gb2312\n\t\t<OPTION VALUE=\"gbk\">gbk\n\t\t<OPTION VALUE=\"geostd8\">geostd8\n\t\t<OPTION VALUE=\"greek\">greek\n\t\t<OPTION VALUE=\"hebrew\">hebrew\n\t\t<OPTION VALUE=\"hp8\">hp8\n\t\t<OPTION VALUE=\"keybcs2\">keybcs2\n\t\t<OPTION VALUE=\"koi8r\">koi8r\n\t\t<OPTION VALUE=\"koi8u\">koi8u\n\t\t<OPTION VALUE=\"latin1\">latin1\n\t\t<OPTION VALUE=\"latin2\">latin2\n\t\t<OPTION VALUE=\"latin5\">latin5\n\t\t<OPTION VALUE=\"latin7\">latin7\n\t\t<OPTION VALUE=\"macce\">macce\n\t\t<OPTION VALUE=\"macroman\">macroman\n\t\t<OPTION VALUE=\"sjis\">sjis\n\t\t<OPTION VALUE=\"swe7\">swe7\n\t\t<OPTION VALUE=\"tis620\">tis620\n\t\t<OPTION VALUE=\"ucs2\">ucs2\n\t\t<OPTION VALUE=\"ujis\">ujis\n\t\t<OPTION VALUE=\"utf16\">utf16\n\t\t<OPTION VALUE=\"utf32\">utf32\n\t\t<OPTION VALUE=\"utf8mb4\">utf8mb4");
  printf("</select>");
  printf("<script> document.nasmisc_fm.mysql_charset.value='%s';</script>", &v36);
  printf("</td></tr>");
  v24 = get_ux_text_common(650, v23);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v24);
  puts("<td colspan=3>");
  if ( v37 )
    v25 = "checked";
  else
    v25 = "";
  printf("<input type=checkbox id='mysql_use_client_charset' name='mysql_use_client_charset' %s>", v25);
  printf("</td></tr>");
  v27 = get_ux_text_common(649, v26);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v27);
  puts("<td colspan=3>");
  if ( v38 )
    v28 = "checked";
  else
    v28 = "";
  printf("<input type=checkbox id='mysql_use_case' name='mysql_use_case' %s>", v28);
  printf("</td></tr>");
  v30 = get_ux_text_common(653, v29);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v30);
  puts("<td colspan=3>");
  printf("<input type=text name='mysql_max_allow_packet' size=3 maxlength=3 value=%d>MB", v39);
  printf("</td></tr>");
  v32 = get_ux_text_common(652, v31);
  printf(
    "<tr valign=bottom height=40><td colspan=4 style=\"padding-left:5px;\"><span class=gray_text>%s</span></td></tr>",
    v32);
  printf("</TABLE>");
  printf("</td></tr>");
  printf("</TABLE>");
  puts("<script>");
  puts("InitMySQL();");
  return puts("</script>");
}
// 10634: using guessed type int __fastcall get_mysql_config(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);

//----- (00057E04) --------------------------------------------------------
int sub_57E04()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  char *v3; // r7@2
  int v4; // r0@4
  int v5; // r1@4
  char *v6; // r7@5
  int v7; // r0@7
  int v8; // r1@7
  int v9; // r0@7
  signed int v10; // r6@7
  int v11; // r1@7
  int v12; // r0@7
  int v13; // r1@7
  int v14; // r0@7
  int v15; // r1@7
  int v16; // r0@7
  int v17; // r1@7
  int v18; // r0@7
  int v19; // r1@7
  int v20; // r0@7
  char *v21; // r1@8
  signed int v22; // r4@10
  signed int v23; // r1@11
  signed int v24; // r3@11
  bool v25; // zf@11
  char *v26; // r2@12
  int v27; // r1@14
  int v28; // r0@15
  const char *v29; // r2@16
  char *v30; // r0@16
  int v31; // r1@18
  int v32; // r2@18
  int v33; // r1@18
  const char *v34; // r0@19
  int v36; // [sp+8h] [bp-4B0h]@1
  int v37; // [sp+Ch] [bp-4ACh]@7
  char v38; // [sp+10h] [bp-4A8h]@7
  char v39; // [sp+90h] [bp-428h]@7
  char v40; // [sp+A0h] [bp-418h]@7
  char v41; // [sp+2A0h] [bp-218h]@16
  char v42; // [sp+2A4h] [bp-214h]@18

  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr id=itunes_setup_table><td>");
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<COL WIDTH=100><COL WIDTH=250><COL WIDTH=80><COL WIDTH=160>");
  get_itunes_config(&v36);
  v1 = get_ux_text_common(1096, v0);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v1);
  if ( v36 )
    v3 = "checked";
  else
    v3 = "";
  v4 = get_ux_text_common(1104, v2);
  printf(
    "<td colspan=3><input type=radio id=itunes_on name=itunes_run value=1 %s onclick=\"InitiTunes();\"><label for=itunes_on> %s</label>",
    v3,
    v4);
  print_nbsp(14);
  if ( v36 )
    v6 = "";
  else
    v6 = "checked";
  v7 = get_ux_text_common(1111, v5);
  printf(
    "<input type=radio id=itunes_off name=itunes_run value=0 %s onclick=\"InitiTunes();\"><label for=itunes_off> %s</label>",
    v6,
    v7);
  printf("</td>");
  printf("</tr>");
  v9 = get_ux_text_common(457, v8);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v9);
  printf(
    "<td colspan=3><input type=text style=\"width:250;\" name=itunes_name value=\"%s\"  maxlength=64></td></tr>",
    &v38);
  v10 = 180;
  printf("<input type=hidden name=itunes_folder>");
  printf("<input type=hidden name=itunes_hddname>");
  v12 = get_ux_text_common(453, v11);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v12);
  puts("<td colspan=1>");
  printf("<select style=\"width:250;\" name=itunes_path onchange=\"ChangeiTunesFolder();\">");
  v14 = get_ux_text_common(1088, v13);
  printf("<option value='select_itunes_folder'>%s", v14);
  sub_56130((int)&v39, (int)&v40, (int)"/mnt", 0, 0);
  printf("</select>");
  printf("</td><td colspan=2 style=\"padding-left:5px;\">");
  v16 = get_ux_text_common(262, v15);
  printf("<input type=hidden name=\"itunes_default_folder\" value=\"%s\">", v16);
  v18 = get_ux_text_common(262, v17);
  printf(
    "<input type=text name=itunes_new_folder size=30 maxlength=256 value=\"%s\" style=\"color:#888888; display:none;\" on"
    "focus=\"FocusNewFolder(itunes_new_folder, itunes_default_folder);\">",
    v18);
  printf("</td></tr>");
  v20 = get_ux_text_common(456, v19);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v20);
  printf("<td colspan=3>");
  if ( v37 )
    v21 = "checked";
  else
    v21 = "";
  v22 = 3;
  printf("<input type=checkbox id=itunes_scan_chk name=itunes_scan_chk %s onchange=\"InitiTunes();\">", v21);
  printf("<select name=itunes_scan_period>");
  do
  {
    v23 = v22;
    v24 = v22;
    v22 += 3;
    v25 = v37 == v10;
    v10 += 180;
    if ( v25 )
      v26 = "selected";
    else
      v26 = "";
    printf("<option value=%d %s> %d", v23, v26, v24);
  }
  while ( v22 != 33 );
  v28 = get_ux_text_common(455, v27);
  printf("</select> %s", v28);
  printf("</td>");
  printf("</tr>");
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", "MediaDB");
  if ( v39 )
  {
    v29 = (const char *)get_itunes_db_folder(&v36);
    v30 = &v41;
  }
  else
  {
    v29 = "/mnt--";
    v30 = &v41;
  }
  snprintf(v30, 0x200u, v29);
  v32 = get_ux_text_common(444, v31);
  printf(
    "<td><span id=itunes_db_folder>%s</span></td><td align=left  style=\"padding-left:5px;\" colspan=2><input type=button"
    " name=update_itunes_db_bt value=\"%s\" onclick=\"UpdateiTunesDB();\" %s></td></tr>",
    &v42,
    v32);
  printf("<tr><td style=\"padding-left:5px;\"></td>");
  printf("<td colspan=3><span id=itunes_db_status>-</span></td></tr>");
  printf("<tr><td style=\"padding-left:5px;\"></td>");
  printf("<td colspan=3><span id=itunes_db_update_file style=\"color:#888888; overflow:hidden; display:inline-block; white-space:nowrap; width:500px; text-overflow:ellipsis;\"></span></td></tr>");
  printf("</TABLE>");
  printf("</td></tr>");
  printf("<tr id=itunes_install_table><td>");
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf((const char *)&unk_B81F2);
  if ( !get_mount_devpath("/tmp/mnt/HDD1", 0) )
  {
    v34 = (const char *)get_ux_text_common(446, v33);
    printf(v34);
  }
  printf("</td></tr>");
  printf("</TABLE>");
  printf("</td></tr>");
  printf("</TABLE>");
  puts("<script>");
  puts("InitiTunes();");
  puts("</script>");
  puts("<script>");
  printf("ShowIt('itunes_setup_table');");
  printf("HideIt('itunes_install_table');");
  return puts("</script>");
}
// 109E8: using guessed type int __fastcall get_itunes_db_folder(_DWORD);
// 11258: using guessed type int __fastcall get_mount_devpath(_DWORD, _DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 115B8: using guessed type int __fastcall get_itunes_config(_DWORD);

//----- (00058208) --------------------------------------------------------
int sub_58208()
{
  char *v0; // r6@1
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r1@1
  char *v4; // r7@2
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6
  int v8; // r1@6
  int v9; // r0@6
  int v10; // r1@6
  int v11; // r7@6
  int v12; // r1@6
  int v13; // r6@6
  int v14; // r1@6
  int v15; // r4@6
  int v16; // r1@6
  int v17; // r0@6
  int v18; // r3@6
  int v19; // r4@6
  int v20; // r1@7
  char *v21; // r11@8
  int v22; // r0@10
  int v23; // r1@10
  char *v24; // r11@11
  int v25; // r0@13
  int v26; // r1@13
  char *v27; // r11@14
  int v28; // r0@16
  int v29; // r1@16
  int v30; // r0@16
  int v31; // r1@16
  int v32; // r0@16
  char *v33; // r1@16
  char *v34; // r11@17
  int v35; // r1@21
  int v36; // r0@22
  char v38; // [sp+10h] [bp-3D0h]@7
  char v39; // [sp+14h] [bp-3CCh]@16
  char v40; // [sp+94h] [bp-34Ch]@16
  char v41; // [sp+214h] [bp-1CCh]@16
  int v42; // [sp+318h] [bp-C8h]@7
  int v43; // [sp+31Ch] [bp-C4h]@1
  int v44; // [sp+324h] [bp-BCh]@6

  v0 = "checked";
  get_afp_config(&v43);
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  v2 = get_ux_text_common(661, v1);
  printf("<tr height=23px><td style=\"padding-left:5px; width:125px;\">%s</td>", v2);
  printf("<td colspan=3>");
  if ( v43 )
    v4 = "checked";
  else
    v4 = "";
  v5 = get_ux_text_common(1104, v3);
  printf(
    "<input type=radio id=afp_on name=afp_run value=1 %s onclick=\"InitAFP();\"><label for=afp_on> %s</label>",
    v4,
    v5);
  print_nbsp(10);
  if ( v43 )
    v0 = "";
  v7 = get_ux_text_common(1111, v6);
  printf(
    "<input type=radio id=afp_off name=afp_run value=0 %s onclick=\"InitAFP();\"><label for=afp_off> %s</label>",
    v0,
    v7);
  printf("</td></tr>");
  v9 = get_ux_text_common(660, v8);
  printf((const char *)&unk_B68EF, v9);
  printf("<td colspan=3><input type=text name=afp_name value=\"%s\" size=20 maxlength=32></td>", &v44);
  printf("</tr>");
  printf("<tr height=3px><td colspan=4></td></tr>");
  printf("<tr height=23px><td colspan=4>");
  printf("<table>");
  v11 = get_ux_text_common(1403, v10);
  v13 = get_ux_text_common(703, v12);
  v15 = get_ux_text_common(704, v14);
  v17 = get_ux_text_common(658, v16);
  v18 = v15;
  v19 = 0;
  printf(
    "<tr><td style=\"padding-left:5px;\">%s</td><td>%s</td><td>%s</td><td style=\"padding-left:5px;\">%s</td></tr>",
    v11,
    v13,
    v18,
    v17);
  do
  {
    get_nas_user("afp", v19, &v38);
    printf("<tr>");
    printf("<td style=\"padding:0;\"><select name=afp_property onchange=\"ChangeUserProperty('afp','%d');\" >", v19);
    if ( v42 )
      v21 = "";
    else
      v21 = "selected";
    v22 = get_ux_text_common(421, v20);
    printf("<option value=off %s> %s", v21, v22);
    if ( v42 == 1 )
      v24 = "selected";
    else
      v24 = "";
    v25 = get_ux_text_common(423, v23);
    printf("<option value=readwrite %s> %s", v24, v25);
    if ( v42 == 2 )
      v27 = "selected";
    else
      v27 = "";
    v28 = get_ux_text_common(422, v26);
    printf("<option value=readonly %s>%s ", v27, v28);
    printf("</select>");
    printf("</td>");
    printf(
      "<td style=\"padding:0;\"><input type=text name=afp_userid size=21 maxlength=32 style=\"height:20px;\" value=%s></td>",
      &v39);
    printf(
      "<td style=\"padding:0;\"><input type=password style=\"width:130px;height:20px;\" name=afp_passwd size=21 maxlength=32 value='%s'>",
      &v40);
    printf(
      "<input type=text name=afp_passwd_text style=\"height:20px;display:none;ime-mode:disabled;width:130px;\"  size=21 m"
      "axlength=32 value='%s'>",
      &v40);
    v30 = get_ux_text_common(1415, v29);
    printf(
      "<INPUT TYPE=checkbox id=afp_password_view%d NAME=afp_password_view value=1 onclick=\"PasswordView(afp_passwd[%d],a"
      "fp_passwd_text[%d],afp_password_view[%d]);\" ><label for=afp_password_view%d> %s</label>",
      v19,
      v19,
      v19,
      v19,
      v19,
      v30);
    printf("</td><td style=\"padding:0 0 0 5px;\">");
    printf("<select style=\"width:180px;\" name=afp_folder>");
    v32 = get_ux_text_common(657, v31);
    printf("<option value=\"\">%s", v32);
    v33 = strchr(&v41, 58);
    if ( !v33 || (v34 = strtok(&v41, ":"), v33 = strtok(0, ":"), !v34) )
      v34 = "";
    if ( !v33 )
      v33 = "";
    ++v19;
    sub_56130((int)v34, (int)v33, (int)"/mnt", 0, 1);
    printf("</select>");
    puts("</td></tr>");
  }
  while ( v19 != 5 );
  v36 = get_ux_text_common(659, v35);
  printf("<tr><td colspan=4 style=\"padding-left:5px;\"><span class=gray_text>%s</span></td></tr>", v36);
  printf("</table>");
  printf("</td></tr>");
  printf("</TABLE>");
  puts("<script>");
  puts("InitAFP();");
  return puts("</script>");
}
// 113D8: using guessed type int __fastcall get_afp_config(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 11CD8: using guessed type int __fastcall get_nas_user(_DWORD, _DWORD, _DWORD);

//----- (000585C0) --------------------------------------------------------
int sub_585C0()
{
  int v0; // r6@1
  char *v1; // r4@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  char *v5; // r7@2
  int v6; // r0@4
  int v7; // r1@4
  int v8; // r0@6
  int v9; // r0@6
  int v10; // r0@6
  int v11; // r1@6
  int v12; // r0@6
  int v13; // r0@6
  int v14; // r1@6
  const char *v15; // r0@6
  int v16; // r0@6
  int v17; // r1@6
  const char *v18; // r0@6
  int v19; // r0@6
  int v20; // r1@6
  const char *v21; // r0@6
  int v22; // r0@6
  int v23; // r1@6
  const char *v24; // r0@6
  int v25; // r0@6
  int v26; // r1@6
  const char *v27; // r0@6
  int v28; // r0@6

  v0 = get_usb_tethering_op();
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr id=tethering_setup_table><td>");
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<COL WIDTH=100><COL WIDTH=220><COL WIDTH=80><COL WIDTH=160>");
  v1 = "checked";
  v3 = get_ux_text_common(1096, v2);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v3);
  if ( v0 )
    v5 = "checked";
  else
    v5 = "";
  v6 = get_ux_text_common(1104, v4);
  printf(
    "<td colspan=3><input type=radio id=tethering_on name=tethering_run value=1 %s><label for=tethering_on> %s</label>",
    v5,
    v6);
  print_nbsp(14);
  if ( v0 )
    v1 = "";
  v8 = get_ux_text_common(1111, v7);
  printf(
    "<input type=radio id=tethering_off name=tethering_run value=0 %s><label for=tethering_off> %s</label>",
    v1,
    v8);
  printf("</td>");
  printf("</tr>");
  v9 = printf("<tr height=%d valign=bottom><td colspan=2 style=\"padding-left:5px;\">", 225);
  v10 = br(v9);
  br(v10);
  printf("<span class=gray_text>");
  v12 = get_ux_text_common(1391, v11);
  v13 = printf("<b>%s</b>", v12);
  br(v13);
  v15 = (const char *)get_ux_text_common(1392, v14);
  v16 = printf(v15);
  br(v16);
  v18 = (const char *)get_ux_text_common(1393, v17);
  v19 = printf(v18);
  br(v19);
  v21 = (const char *)get_ux_text_common(1394, v20);
  v22 = printf(v21);
  br(v22);
  v24 = (const char *)get_ux_text_common(1395, v23);
  v25 = printf(v24);
  br(v25);
  v27 = (const char *)get_ux_text_common(1396, v26);
  v28 = printf(v27);
  br(v28);
  printf("</span>");
  printf("</td></tr>");
  printf("</TABLE>");
  return printf("</td></tr></TABLE>");
}
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);
// 11BDC: using guessed type int get_usb_tethering_op(void);

//----- (00058750) --------------------------------------------------------
int sub_58750()
{
  char *v0; // r4@1
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r1@1
  char *v4; // r6@2
  int v5; // r0@4
  int v6; // r1@4
  char *v7; // r6@5
  int v8; // r0@7
  int v9; // r1@7
  int v10; // r0@7
  int v11; // r1@7
  char *v12; // r6@8
  int v13; // r0@10
  int v14; // r1@10
  int v15; // r0@12
  int v16; // r0@12
  int v17; // r0@12
  int v18; // r1@12
  int v19; // r0@12
  int v20; // r0@12
  int v21; // r1@12
  const char *v22; // r0@12
  int v23; // r0@12
  int v24; // r1@12
  const char *v25; // r0@12
  int v26; // r0@12
  char v28; // [sp+4h] [bp-3FCh]@1
  int v29; // [sp+3E4h] [bp-1Ch]@12
  int v30; // [sp+3E8h] [bp-18h]@1
  int v31; // [sp+3ECh] [bp-14h]@7

  get_si("sw", &v28);
  v0 = "checked";
  get_cupsd_config(&v30);
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr id=cupsd_setup_table><td>");
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<COL WIDTH=100><COL WIDTH=220><COL WIDTH=80><COL WIDTH=160>");
  v2 = get_ux_text_common(1096, v1);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v2);
  if ( v30 )
    v4 = "checked";
  else
    v4 = "";
  v5 = get_ux_text_common(1104, v3);
  printf(
    "<td colspan=3><input type=radio id=cupsd_on name=cupsd_run value=1 %s onclick=\"InitCUPS();\"><label for=cupsd_on> %s</label>",
    v4,
    v5);
  print_nbsp(14);
  if ( v30 )
    v7 = "";
  else
    v7 = "checked";
  v8 = get_ux_text_common(1111, v6);
  printf(
    "<input type=radio id=cupsd_off name=cupsd_run value=0 %s onclick=\"InitCUPS();\"><label for=cupsd_off> %s</label>",
    v7,
    v8);
  printf("</td>");
  printf("</tr>");
  v10 = get_ux_text_common(126, v9);
  printf("<tr height=23><td style=\"padding-left:5px;\">%s</td>", v10);
  if ( v31 )
    v12 = "checked";
  else
    v12 = "";
  v13 = get_ux_text_common(125, v11);
  printf(
    "<td colspan=3><input type=radio id=cupsd_remote_on name=cupsd_remote value=1 %s onclick=\"InitCUPS();\"><label for=c"
    "upsd_remote_on> %s</label>",
    v12,
    v13);
  print_nbsp(14);
  if ( v31 )
    v0 = "";
  v15 = get_ux_text_common(127, v14);
  printf(
    "<input type=radio id=cupsd_remote_off name=cupsd_remote value=0 %s onclick=\"InitCUPS();\"><label for=cupsd_remote_off> %s</label>",
    v0,
    v15);
  printf("</td>");
  printf("</tr>");
  v16 = printf("<tr height=%d valign=bottom><td colspan=2 style=\"padding-left:5px;\">", 202);
  v17 = br(v16);
  br(v17);
  printf("<span class=gray_text>");
  v19 = get_ux_text_common(912, v18);
  v20 = printf("<b>%s</b>", v19);
  br(v20);
  v22 = (const char *)get_ux_text_common(913, v21);
  v23 = printf(v22);
  br(v23);
  v25 = (const char *)get_ux_text_common(914, v24);
  v26 = printf(v25, v29);
  br(v26);
  printf("</span>");
  printf("</td></tr>");
  printf("</TABLE>");
  printf("</td></tr>");
  printf("</TABLE>");
  puts("<script>");
  puts("InitCUPS();");
  return puts("</script>");
}
// 104B4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// 10FA0: using guessed type int __fastcall get_cupsd_config(_DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 117D4: using guessed type int __fastcall br(_DWORD);

//----- (00058980) --------------------------------------------------------
int print_iframe_basicapp_service_onusers()
{
  print_js_file((int)"basicapp", (int)"service");
  printf("<style>");
  printf((const char *)&unk_B3414);
  printf("tr { height: 20px; width: 100%%; }");
  printf("</style>");
  printf("<table id='onusers_table' cellspacing=0px cellpadding=0px style='height: 200px; width: 100%%;'>");
  printf("</table>");
  return printf("<iframe name='basicapp_service_onusers_status' src=\"timepro.cgi?tmenu=iframe&smenu=basicapp_service_onusers_status\" frameborder=no style='display: none;'></iframe>");
}

//----- (000589F0) --------------------------------------------------------
int print_iframe_basicapp_service_onusers_status()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r1@1
  int v9; // r0@1
  int v10; // r1@1
  int v11; // r0@1
  int v12; // r1@1
  int v13; // r0@1
  int v14; // r4@1
  int v15; // r1@1
  int v16; // r0@1
  const char *v17; // r0@2
  const char *v18; // r1@5
  int v20; // [sp+0h] [bp-20h]@1
  int v21; // [sp+4h] [bp-1Ch]@1
  int v22; // [sp+Ch] [bp-14h]@1

  v22 = 0;
  print_js_file((int)"basicapp", (int)"service");
  printf("<table id='onusers_table' cellspacing=0px cellpadding=0px style='height: 200px; width: 100%%;'>");
  get_process_list(0, &v20, 1);
  v1 = get_ux_text_common(691, v0);
  sub_527BC(v21, "smbd", v1, &v22);
  v3 = get_ux_text_common(690, v2);
  sub_527BC(v21, "proftpd", v3, &v22);
  v5 = get_ux_text_common(689, v4);
  sub_527BC(v21, "rsync", v5, &v22);
  v7 = get_ux_text_common(662, v6);
  sub_527BC(v21, "afpd", v7, &v22);
  v9 = get_ux_text_common(702, v8);
  sub_52934(v21, (char *)&unk_BA770, v9, &v22);
  v11 = get_ux_text_common(677, v10);
  sub_52934(v21, "mt-daapd", v11, &v22);
  v13 = get_ux_text_common(678, v12);
  sub_52934(v21, "minidlna", v13, &v22);
  free_process_list(&v20);
  printf("<script>");
  printf("if(parent.parent.document.getElementsByName('nas_service_iframe')[0].contentWindow.document.getElementById('onusers_value'))");
  v14 = v22;
  v16 = get_ux_text_common(943, v15);
  printf(
    "parent.parent.document.getElementsByName('nas_service_iframe')[0].contentWindow.document.getElementById('onusers_val"
    "ue').outerHTML = '<TD CLASS=text_gray ID=onusers_value>%d%s</TD>';",
    v14,
    v16);
  printf("</script>");
  if ( v22 <= 10 )
  {
    while ( v22 <= 9 )
    {
      if ( v22 & 1 )
        v18 = (const char *)&unk_86952;
      else
        v18 = "#FFF";
      ++v22;
      printf("<tr style='background-color: %s'><td colspan=4></td></tr>", v18);
    }
    v17 = "<colgroup><col width=160px><col width=160px><col width=160px><col width=160px></colgroup>";
  }
  else
  {
    v17 = "<colgroup><col width=160px><col width=160px><col width=160px><col width=146.4px></colgroup>";
  }
  printf(v17);
  printf("</table>");
  printf("<script>");
  printf("parent.document.getElementById('onusers_table').outerHTML = document.getElementById('onusers_table').outerHTML;");
  printf("setTimeout(function() { location.reload(); }, 3000);");
  return printf("</script>");
}
// 10EF8: using guessed type int __fastcall get_process_list(_DWORD, _DWORD, _DWORD);
// 111D4: using guessed type int __fastcall free_process_list(_DWORD);

//----- (00058C04) --------------------------------------------------------
int __fastcall sub_58C04(const char *a1)
{
  const char *v1; // r4@1
  int result; // r0@27
  int v3; // r0@28
  int v4; // r1@28
  int v5; // r0@28
  int v6; // r1@28
  int v7; // r0@28
  int v8; // r1@28
  int v9; // r0@28
  int v10; // r1@28
  int v11; // r0@28
  int v12; // r0@28

  v1 = a1;
  if ( !strcmp(a1, "ipdisk") )
    sub_55CD4();
  if ( !strcmp(v1, "ftp") )
    sub_56788();
  if ( !strcmp(v1, "samba") )
    sub_56394();
  if ( !strcmp(v1, "url") )
    sub_55EA8();
  if ( !strcmp(v1, "rsync") )
    sub_56D04();
  if ( !strcmp(v1, "torrent") )
    sub_56FCC();
  if ( !strcmp(v1, "media") )
    sub_573B4();
  if ( !strcmp(v1, "itunes") )
    sub_57E04();
  if ( !strcmp(v1, "afp") )
    sub_58208();
  if ( !strcmp(v1, "tethering") )
    sub_585C0();
  if ( !strcmp(v1, "apache") )
    sub_57778();
  if ( !strcmp(v1, "mysql") )
    sub_57A8C();
  if ( !strcmp(v1, "cupsd") )
    sub_58750();
  result = strcmp(v1, "onusers");
  if ( result )
    return result;
  v3 = puts("<table cellspacing=0px cellpadding=0px style='width: 640px; height: 220px; border-bottom: 1px solid #CCC;'>");
  str(v3);
  v5 = get_ux_text_common(688, v4);
  printf("<td style='width: 150px; padding-left: 10px;'>%s</td>", v5);
  v7 = get_ux_text_common(703, v6);
  printf("<td style='width: 160px;'>%s</td>", v7);
  v9 = get_ux_text_common(665, v8);
  printf("<td style='width: 160px;'>%s</td>", v9);
  v11 = get_ux_text_common(666, v10);
  v12 = printf("<td style='width: 160px;'>%s</td>", v11);
  etr(v12);
  printf("<tr><td colspan=4>");
  printf("<iframe name='basicapp_service_onusers' src=\"timepro.cgi?tmenu=iframe&smenu=basicapp_service_onusers\" frameborder=no style='width:100%%; height:200px; border-top: 1px solid #CCC;'></iframe>");
  printf("</td></tr>");
  result = printf("</table>");
  return result;
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);

//----- (00058E98) --------------------------------------------------------
int __fastcall sub_58E98(const char *a1, int a2)
{
  const char *v2; // r4@1
  int v3; // r5@1
  const char *v4; // r0@2

  v2 = a1;
  v3 = a2;
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%% ID=%s_table STYLE=\"display:none;\">", a1);
  printf(
    "<tr><td width=200 height=20 valign=center style=\"padding:3px;\">&nbsp; <b>%s</b></td><td width=440px align=right>%s</td></tr>",
    v3);
  printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=2></td></tr>");
  if ( !strcmp(v2, "onusers") )
    v4 = "<tr><td  colspan=2 valign=top>";
  else
    v4 = "<tr><td  colspan=2 valign=top style=\"padding:5px\" >";
  printf(v4);
  sub_58C04(v2);
  return puts((const char *)&unk_7FF8C);
}

//----- (00058F28) --------------------------------------------------------
int __fastcall sub_58F28(int a1)
{
  int v1; // r5@1
  int v2; // r0@1
  int v3; // r0@1
  _DWORD *i; // r4@1
  int v5; // r0@4
  int v6; // r6@4
  int v7; // r3@4
  int v8; // r1@6
  int v9; // r0@6
  void *v10; // r5@6
  int v11; // r1@6
  int v12; // r0@6
  int v13; // r1@6
  int v14; // r0@6
  int v15; // r1@6
  int v16; // r0@6
  void *v17; // r5@6
  int v18; // r1@6
  int v19; // r0@6
  int v20; // r1@6
  int v21; // r0@6
  int v22; // r1@6
  int v23; // r0@6
  void *v24; // r5@6
  int v25; // r1@6
  int v26; // r0@6
  int v27; // r6@6
  void *v28; // r5@6
  int v29; // r1@6
  int v30; // r0@6
  int v31; // r1@6
  int v32; // r0@6
  int v33; // r1@6
  int v34; // r0@6
  int v35; // r1@6
  int v36; // r0@6
  int v37; // r1@6
  int v38; // r0@6
  int v39; // r1@6
  int v40; // r0@6
  int v41; // r1@6
  int v42; // r0@6
  int v43; // r1@6
  int v44; // r0@6
  void *v45; // r5@6
  int v46; // r1@6
  int v47; // r0@6
  int v48; // r1@6
  int v49; // r0@6
  int v50; // r1@6
  int v51; // r0@6
  int v52; // r1@6
  int v53; // r0@6
  char dest[512]; // [sp+Ch] [bp-31Ch]@1
  char v56[256]; // [sp+20Ch] [bp-11Ch]@4
  char v57; // [sp+30Ch] [bp-1Ch]@1
  _DWORD *v58; // [sp+310h] [bp-18h]@1

  v1 = a1;
  strcpy(dest, "");
  puts("<table style=\"border-collapse:collapse; border-style:none solid solid solid; border-width:0px 1px 1px 1px; border-color:#eeeeee; width:642;\" cellspacing=0px cellpadding=0px>");
  printf("<form method=get action=\"timepro.cgi\" name=\"nasmisc_fm\">");
  v2 = printf("<input type=hidden name=tmenu value=nasconf>");
  v3 = get_router_mgmt_port(v2);
  printf("<input type=hidden name=\"mgmt_port\" value=\"%d\">", v3);
  printf("<input type=hidden name=\"smenu\" value=\"service\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  get_mount_list(&v57, 0);
  for ( i = v58; i; i = (_DWORD *)*i )
    printf("<input type=hidden ID=%s_fs value=%s>", i + 25, i + 41);
  v5 = free_mount_list(&v57);
  str(v5);
  printf("<td width=100%% height=%d>", 220);
  v6 = snprintf(v56, 0x40u, (const char *)&unk_BAE06);
  v7 = get_parameter_value(v1, "act");
  if ( v7 )
    snprintf(&v56[v6], 0x80u, "&act=%s", v7);
  printf(
    "<iframe name=\"nas_service_iframe\" src=\"%s\" frameborder=no width=100%% height=100%% align=left scrolling=yes styl"
    "e='border-bottom; 1px solid #DDD;'></iframe>",
    v56);
  printf("</td></tr>");
  printf("<tr height=%d style=\"background-Color:#eeeeee\"><td valign=top>\n", 285);
  v9 = get_ux_text_common(676, v8);
  sub_58E98("ipdisk", v9);
  v10 = sub_53454("ftp");
  v12 = get_ux_text_common(436, v11);
  snprintf(dest, 0x100u, "<a target=_blank href=\"%s\">%s</a>", v10, v12);
  v14 = get_ux_text_common(671, v13);
  sub_58E98("ftp", v14);
  v16 = get_ux_text_common(687, v15);
  sub_58E98("samba", v16);
  v17 = sub_53454("rsync");
  v19 = get_ux_text_common(76, v18);
  snprintf(dest, 0x100u, "<a target=_blank href=\"%s\">%s</a>", v17, v19);
  v21 = get_ux_text_common(664, v20);
  sub_58E98("rsync", v21);
  strcpy(dest, "");
  v23 = get_ux_text_common(702, v22);
  sub_58E98("url", v23);
  v24 = sub_53454("torrent_web");
  v26 = get_ux_text_common(1319, v25);
  v27 = snprintf(dest, 0x100u, "<a target=_blank href=\"%s\">[%s]</a>", v24, v26);
  v28 = sub_53454("torrent");
  v30 = get_ux_text_common(1331, v29);
  snprintf(&dest[v27], 0x100u, (const char *)&unk_BAF38, v28, v30);
  v32 = get_ux_text_common(696, v31);
  sub_58E98("torrent", v32);
  v34 = get_ux_text_common(678, v33);
  sub_58E98("media", v34);
  v36 = get_ux_text_common(677, v35);
  sub_58E98("itunes", v36);
  v38 = get_ux_text_common(662, v37);
  sub_58E98("afp", v38);
  v40 = get_ux_text_common(1398, v39);
  sub_58E98("tethering", v40);
  v42 = get_ux_text_common(663, v41);
  sub_58E98("apache", v42);
  v44 = get_ux_text_common(679, v43);
  sub_58E98("mysql", v44);
  v45 = sub_53454("cupsd");
  v47 = get_ux_text_common(129, v46);
  snprintf(dest, 0x100u, "<a target=_blank href=\"%s\">[%s]</a>", v45, v47);
  v49 = get_ux_text_common(667, v48);
  sub_58E98("cupsd", v49);
  v51 = get_ux_text_common(753, v50);
  sub_58E98("onusers", v51);
  printf("</td></tr>");
  printf("<tr height=1px style=\"background-Color:#dddddd\"><td></td></tr>");
  printf("<tr align=right valign=middle height=28 style=\"background-Color:#eeeeee\"><td>");
  v53 = get_ux_text_common(35, v52);
  printf("<input type=button id=apply_bt name=params_bt value=\"%s\" onclick=\"ApplyNas();\">", v53);
  printf("</td></tr>");
  printf("</form>");
  return printf("</table>");
}
// 1064C: using guessed type int __fastcall free_mount_list(_DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 1157C: using guessed type int __fastcall get_router_mgmt_port(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 119FC: using guessed type int __fastcall get_mount_list(_DWORD, _DWORD);
// 58F28: using guessed type char dest[512];
// 58F28: using guessed type char var_11C[256];

//----- (00059340) --------------------------------------------------------
int __fastcall getNASStatus(int a1, int a2, int a3, int a4)
{
  int v4; // r4@1
  const char *v5; // r5@1
  int v6; // r4@3
  signed int v7; // r6@8
  signed int v8; // r6@10
  const char *v9; // r0@30
  int v11; // [sp+0h] [bp-20h]@1
  int v12; // [sp+4h] [bp-1Ch]@1
  int v13; // [sp+8h] [bp-18h]@1
  int v14; // [sp+Ch] [bp-14h]@1

  v11 = a1;
  v12 = a2;
  v13 = a3;
  v14 = a4;
  v4 = a1;
  get_process_list(0, &v12, 0);
  v5 = (const char *)get_parameter_value(v4, "service");
  printf("<html>");
  print_file("/home/httpd/js/common.js");
  if ( !v5 || !strcmp(v5, "ipdisk") )
  {
    v6 = getIPDiskStatus();
    if ( !v5 )
      goto LABEL_6;
  }
  else
  {
    v6 = 0;
  }
  if ( !strcmp(v5, "torrent") )
  {
LABEL_6:
    v6 |= getStatus((int)&v12, (int)"torrent");
    if ( !v5 )
      goto LABEL_8;
  }
  if ( strcmp(v5, "media") )
    goto LABEL_9;
LABEL_8:
  v7 = getStatus((int)&v12, (int)"media");
  v6 |= getMediaStatus() | v7;
  if ( v5 )
  {
LABEL_9:
    if ( strcmp(v5, "itunes") )
      goto LABEL_11;
  }
  v8 = getStatus((int)&v12, (int)"itunes");
  v6 |= getiTunesStatus() | v8;
  if ( !v5 )
    goto LABEL_12;
LABEL_11:
  if ( !strcmp(v5, "afp") )
  {
LABEL_12:
    v6 |= getStatus((int)&v12, (int)"afp");
    if ( !v5 )
      goto LABEL_14;
  }
  if ( strcmp(v5, "samba") )
    goto LABEL_15;
LABEL_14:
  v6 |= getStatus((int)&v12, (int)"samba");
  if ( v5 )
  {
LABEL_15:
    if ( strcmp(v5, "rsync") )
      goto LABEL_17;
  }
  v6 |= getStatus((int)&v12, (int)"rsync");
  if ( !v5 )
    goto LABEL_18;
LABEL_17:
  if ( !strcmp(v5, "ftp") )
  {
LABEL_18:
    v6 |= getStatus((int)&v12, (int)"ftp");
    if ( !v5 )
      goto LABEL_20;
  }
  if ( strcmp(v5, "url") )
    goto LABEL_21;
LABEL_20:
  v6 |= getStatus((int)&v12, (int)"url");
  if ( v5 )
  {
LABEL_21:
    if ( strcmp(v5, "apache") )
      goto LABEL_23;
  }
  v6 |= getStatus((int)&v12, (int)"apache");
  if ( !v5 )
    goto LABEL_24;
LABEL_23:
  if ( !strcmp(v5, "mysql") )
  {
LABEL_24:
    v6 |= getStatus((int)&v12, (int)"mysql");
    if ( !v5 )
      goto LABEL_26;
  }
  if ( strcmp(v5, "tethering") )
    goto LABEL_27;
LABEL_26:
  v6 |= getThetheringStatus();
  if ( v5 )
  {
LABEL_27:
    if ( strcmp(v5, "cupsd") )
      goto LABEL_29;
  }
  v6 |= getCupsdStatus();
LABEL_29:
  if ( v6 )
    v9 = "<meta http-equiv=refresh content=\"3; URL=timepro.cgi?tmenu=iframe_nas_status\">";
  else
    v9 = "<meta http-equiv=refresh content=\"10; URL=timepro.cgi?tmenu=iframe_nas_status\">";
  printf(v9);
  printf("</html>");
  free_process_list(&v12);
  return v11;
}
// 10EF8: using guessed type int __fastcall get_process_list(_DWORD, _DWORD, _DWORD);
// 111D4: using guessed type int __fastcall free_process_list(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 12068: using guessed type int __fastcall print_file(_DWORD);

//----- (00059628) --------------------------------------------------------
int __fastcall nasconf_service(int a1)
{
  int v1; // r4@1
  int v2; // r1@1
  int v3; // r5@1
  void *v4; // r0@1

  v1 = a1;
  printf("<style>");
  printf("input[type='text'] { border: 1px solid #CCC; height: 19px; }");
  printf("select { height: 20px; }");
  printf("</style>");
  print_js_file((int)"basicapp", (int)"service");
  sub_58F28(v1);
  v3 = get_ux_text_common(34, v2);
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v4 = get_image_dir();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v4);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:"
    "middle; display:block; text-align:center;\">%s\n",
    v3);
  printf("</SPAN></td>");
  return printf((const char *)&unk_7D215);
}

//----- (00059730) --------------------------------------------------------
int __fastcall sub_59730(int a1)
{
  int v1; // r5@1
  int v2; // r0@1
  int v3; // r6@1
  int v4; // r3@1
  int v6; // [sp+0h] [bp-210h]@1
  char v7; // [sp+100h] [bp-110h]@1

  v1 = a1;
  strcpy((char *)&v6, "");
  puts("<table style=\"border-collapse:collapse; border-style:none solid solid solid; border-width:0px 1px 1px 1px; border-color:#eeeeee; width:642;\" cellspacing=0px cellpadding=0px>");
  printf("<form method=get action=\"timepro.cgi\" name=\"nasmisc_fm\">");
  printf("<input type=hidden name=tmenu value=plugin>");
  v2 = printf("<input type=hidden name=\"smenu\" value=\"setup\">");
  str(v2);
  printf("<td width=100%% height=535px>");
  v3 = snprintf(&v7, 0x40u, (const char *)&unk_BB1D8);
  v4 = get_parameter_value(v1, "package");
  if ( v4 )
    snprintf(&v7 + v3, 0x80u, "&package=%s", v4);
  printf(
    "<iframe name=\"plugin_setup_iframe\" src=\"%s\" frameborder=no width=100%% height=100%% align=left scrolling=yes></iframe>",
    &v7);
  printf("</td></tr>");
  printf("</form>");
  return printf("</table>");
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);

//----- (00059810) --------------------------------------------------------
int __fastcall print_iframe_plugin_setup(int a1)
{
  int v1; // r6@1
  int v2; // r11@4
  int v3; // r4@4
  int v4; // r10@4
  int v5; // r0@6
  bool v6; // zf@6
  int v7; // r7@10
  int v8; // r9@10
  int v9; // r2@10
  int v10; // r1@10
  int v11; // r10@10
  int v12; // r1@10
  void *v13; // r0@10
  void *v14; // r0@11
  int v15; // r10@11
  int v16; // r1@11
  int v17; // r0@11
  int v18; // r3@12
  const char *v19; // r0@13
  const char *v20; // r1@13
  int v21; // r1@19
  int v22; // r1@19
  int v23; // r9@22
  const char *v24; // r1@24
  int v25; // r8@28
  char *v26; // r1@31
  char v28; // [sp+Ch] [bp-A04h]@11
  int v29; // [sp+10h] [bp-A00h]@11
  int v30; // [sp+434h] [bp-5DCh]@1
  int v31; // [sp+85Ch] [bp-1B4h]@10
  int v32; // [sp+95Ch] [bp-B4h]@4
  int v33; // [sp+9DCh] [bp-34h]@4
  int v34; // [sp+9E0h] [bp-30h]@4

  v1 = get_parameter_value(a1, "package");
  get_num_of_mountdev(0);
  print_file("/home/httpd/js/plugin.js");
  printf("<BODY style=\"padding:0px 0px; margin:0px 0px;\">");
  printf("<form method=get action=\"timepro.cgi\" name=\"main_form\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=\"smenu\" value=\"plugin_setup\">");
  printf("<input type=hidden name=\"click_package\" value=>");
  printf("<input type=hidden name=\"click_id\" value=>");
  printf("<input type=hidden name=\"click_bg\" value=>");
  printf("<input type=hidden name=\"prev_package\" value=>");
  printf("<input type=hidden name=\"prohibit_click\" value=>");
  if ( get_apache_config(&v30) )
    printf("<input type=hidden name=\"apache_run\" value=%d>", v30);
  else
    printf("<input type=hidden name=\"apache_run\" value=0>");
  printf("<table style=\"border-collapse:collapse; border-style:none none none none; width:100%%;\" cellspacing=0px cellpadding=0px>\n");
  printf("<COL WIDTH=50><COL WIDTH=480><COL width=40><COL>");
  sub_5A48C();
  sub_5A62C((int)&v33, 0);
  v2 = get_plugin_status_package(&v32);
  v3 = v34;
  v4 = 0;
  while ( v3 )
  {
    if ( check_plugin_installed(*(_DWORD *)(v3 + 4008), 0) )
      goto LABEL_39;
    v5 = strcmp(*(const char **)(v3 + 4008), (const char *)&v32);
    v6 = v5 == 0;
    if ( !v5 )
      v6 = v2 == 4;
    if ( v6 )
    {
LABEL_39:
      v7 = get_plugin_status(*(_DWORD *)(v3 + 4008), 0);
      v8 = v4 + 1;
      sub_5A460(*(_DWORD *)(v3 + 4008), (char *)&v31, v9);
      v10 = *(_DWORD *)(v3 + 4008);
      printf("<TR ID=%s_setup_line STYLE=\"cursor:pointer; background-Color:#%s\" height=50 onclick=\"ClickPluginSetup('%s');\">");
      printf("<TD align=center><img src=\"%s\"></TD>\n", &v31);
      printf((const char *)&unk_BB4C9, *(_DWORD *)(v3 + 4016), *(_DWORD *)(v3 + 4024));
      v11 = *(_DWORD *)(v3 + 4008);
      v13 = sub_5AB54(v7, v12);
      printf("<br><span style=\"padding-top:0px; padding-left:0px;\" ID=%s_status>%s</span>", v11, v13);
      printf("</TD>");
      printf("<TD>");
      if ( *(_DWORD *)(v3 + 4040) == 2 )
      {
        get_apache_config(&v28);
        v14 = sub_533CC();
        snprintf((char *)&v31, 0x100u, "http://%s:%d/apps/%s", v14, v29, *(_DWORD *)(v3 + 4008));
        v15 = *(_DWORD *)(v3 + 4008);
        v17 = get_ux_text_common(970, v16);
        printf(
          "<input type=button style=\"display:none;\" title=\"%s\" ID=package_connect_bt_%s name=package_connect_bt value"
          "=\"%s\" onclick=\"ConnectApacheApps('%s');\">",
          &v31,
          v15,
          v17,
          &v31);
      }
      printf((const char *)&unk_BB601);
      v18 = *(_DWORD *)(v3 + 4040);
      if ( v18 == 1 )
      {
        v19 = "<input type=hidden name=package_type value=\"%s\">";
        v20 = "java";
        goto LABEL_18;
      }
      if ( v18 == 2 )
      {
        v19 = "<input type=hidden name=package_type value=\"%s\">";
        v20 = "apache";
        goto LABEL_18;
      }
      if ( v18 == 3 )
      {
        v19 = "<input type=hidden name=package_type value=\"%s\">";
        v20 = "system";
LABEL_18:
        printf(v19, v20);
      }
      v4 = v8;
      printf("<input type=hidden name=package_name value=\"%s\">", *(_DWORD *)(v3 + 4008));
      printf(
        "<input type=hidden name=package_bt_status ID='package_bt_status_%s' value=\"%d\">",
        *(_DWORD *)(v3 + 4008),
        v7);
      get_ux_text_common(143, v21);
      v22 = *(_DWORD *)(v3 + 4008);
      printf("<input type=button ID=package_bt_%s name='package_bt' value=\"%s\" style=\"display:none\" onclick=\"PluginRemove('%s');\">");
      printf("</TD>");
      printf("</TR>");
    }
    v3 = *(_DWORD *)v3;
  }
  v23 = v4;
  sub_5AA9C((int)&v33);
  while ( v3 < 10 - v4 )
  {
    if ( v23 & 1 )
      v24 = "f7f7f7";
    else
      v24 = "ffffff";
    ++v3;
    ++v23;
    printf("<TR name=blank_line height=50 STYLE=\"cursor:pointer; background-Color:#%s\">", v24);
    printf("<TD></TD><TD></TD><TD></TD><TD CLASS=text_gray></TD></TR>");
  }
  v25 = v23 + 20;
  while ( 1 )
  {
    v26 = v23 & 1 ? "f7f7f7" : "ffffff";
    printf("<TR name=blank_line height=50 STYLE=\"display:none;cursor:pointer; background-Color:#%s\">", v26);
    printf("<TD></TD><TD></TD><TD></TD><TD CLASS=text_gray></TD></TR>");
    if ( v23 + 1 == v25 )
      break;
    ++v23;
  }
  printf("</table>");
  printf("</BODY>");
  puts("<script>");
  puts("UnMaskIt(parent.document,'apply_mask');");
  if ( v1 )
    printf("ClickPluginSetup('%s');\n", v1);
  puts("PluginButtonControlSetup();");
  printf("</script>");
  return printf("<iframe src=\"timepro.cgi?tmenu=iframe_plugin_action\" scrolling=no align=left valign=center height=0 frameborder=no name=\"iframe_plugin_action\"></iframe>");
}
// 10718: using guessed type int __fastcall get_apache_config(_DWORD);
// 10ACC: using guessed type int __fastcall get_plugin_status_package(_DWORD);
// 10E74: using guessed type int __fastcall check_plugin_installed(_DWORD, _DWORD);
// 11474: using guessed type int __fastcall get_plugin_status(_DWORD, _DWORD);
// 11804: using guessed type int __fastcall get_num_of_mountdev(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 12068: using guessed type int __fastcall print_file(_DWORD);

//----- (00059C48) --------------------------------------------------------
int __fastcall plugin_setup(int a1)
{
  sub_59730(a1);
  print_mask((int)"apply_mask", 0, 0, 625, 500);
  puts("<script>");
  puts("MaskIt(document,'apply_mask');");
  return printf("</script>");
}

//----- (00059C9C) --------------------------------------------------------
int __fastcall sub_59C9C(int a1, int a2)
{
  int v2; // r5@1
  int v4; // [sp+0h] [bp-110h]@1

  v2 = a2;
  snprintf((char *)&v4, 0x100u, "%s_status", a1);
  puts("<script>");
  printf("if(parent.document.getElementById('%s'))", &v4);
  printf("parent.document.getElementById('%s').innerHTML = '%s';", &v4, v2);
  return puts("</script>");
}

//----- (00059D08) --------------------------------------------------------
int __fastcall sub_59D08(int a1)
{
  int v1; // r5@1
  int v2; // r0@1
  int v3; // r6@1
  int v4; // r3@1
  int v6; // [sp+0h] [bp-210h]@1
  char v7; // [sp+100h] [bp-110h]@1

  v1 = a1;
  strcpy((char *)&v6, "");
  puts("<table style=\"border-collapse:collapse; border-style:none solid solid solid; border-width:0px 1px 1px 1px; border-color:#eeeeee; width:642;\" cellspacing=0px cellpadding=0px>");
  printf("<form method=get action=\"timepro.cgi\" name=\"nasmisc_fm\">");
  printf("<input type=hidden name=tmenu value=plugin>");
  printf("<input type=hidden name=\"smenu\" value=\"install\">");
  v2 = printf("<input type=hidden name=\"act\" value=\"\">");
  str(v2);
  printf("<td width=100%% height=535px>");
  v3 = snprintf(&v7, 0x40u, (const char *)&unk_BB91B);
  v4 = get_parameter_value(v1, "act");
  if ( v4 )
    snprintf(&v7 + v3, 0x40u, "&act=%s", v4);
  printf(
    "<iframe name=\"plugin_install_iframe\" src=\"%s\" frameborder=no width=100%% height=100%% align=left scrolling=yes></iframe>",
    &v7);
  printf("</td></tr>");
  printf("</form>");
  return printf("</table>");
}
// 10E68: using guessed type int __fastcall str(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);

//----- (00059DF4) --------------------------------------------------------
int __fastcall sub_59DF4(int a1, int a2, int a3)
{
  int v3; // r4@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r8@1
  int v7; // r6@1
  int v8; // r7@1
  int v9; // r10@1
  int v10; // r1@1
  void *v11; // r0@1
  int v12; // r1@1
  char v14; // [sp+8h] [bp-120h]@1

  v3 = a1;
  sub_5A460(*(_DWORD *)(a1 + 4008), &v14, a3);
  v4 = *(_DWORD *)(v3 + 4008);
  printf("<TR ID=%s_install_line STYLE=\"cursor:pointer; background-Color:#%s\" height=50 onclick=\"ClickPluginInstall('%s');\">");
  v5 = get_plugin_status(*(_DWORD *)(v3 + 4008), 0);
  v6 = *(_DWORD *)(v3 + 4016);
  v7 = v5;
  v8 = *(_DWORD *)(v3 + 4024);
  v9 = *(_DWORD *)(v3 + 4008);
  v11 = sub_5AB54(v5, v10);
  printf(
    "<TD align=center><img src=\"%s\"></TD><TD valign=top style=\"padding-top:10px; padding-left:5px;\">%s (%s)<br><span "
    "style=\"padding-top:0px; padding-left:0px;\" ID=%s_status>%s</span></TD>",
    &v14,
    v6,
    v8,
    v9,
    v11);
  printf("<TD style=\"padding-right:5px;\">");
  printf("<input type=hidden name=package_name value=\"%s\">", *(_DWORD *)(v3 + 4008));
  printf(
    "<input type=hidden name=package_bt_status ID='package_bt_status_%s' value=\"%d\">",
    *(_DWORD *)(v3 + 4008),
    v7);
  v12 = *(_DWORD *)(v3 + 4008);
  printf("<input type=button name=package_bt ID='package_bt_%s' value=\"\" onclick=\"PluginInstall('%s');\" style=\"display:none\">");
  printf("</TD>");
  printf("</TR>");
  return printf("</TR>");
}
// 11474: using guessed type int __fastcall get_plugin_status(_DWORD, _DWORD);

//----- (00059EEC) --------------------------------------------------------
int __fastcall print_iframe_plugin_install(int a1, int a2, int a3, int a4)
{
  int v4; // r4@1
  int v5; // r5@1
  int v6; // r2@1
  int i; // r4@1
  int v8; // r1@3
  const char *v9; // r1@8
  int v11; // [sp+0h] [bp-28h]@1
  int v12; // [sp+4h] [bp-24h]@1
  int v13; // [sp+8h] [bp-20h]@1
  int v14; // [sp+Ch] [bp-1Ch]@1

  v11 = a1;
  v12 = a2;
  v13 = a3;
  v14 = a4;
  v4 = get_num_of_mountdev(0);
  v5 = 0;
  print_file("/home/httpd/js/plugin.js");
  printf("<BODY style=\"padding:0px 0px; margin:0px 0px;\">");
  printf("<form method=get action=\"timepro.cgi\" name=\"main_form\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=\"smenu\" value=\"plugin_install\">");
  printf("<input type=hidden name=\"click_package\" value=>");
  printf("<input type=hidden name=\"click_id\" value=>");
  printf("<input type=hidden name=\"click_bg\" value=>");
  printf("<input type=hidden name=\"prev_package\" value=>");
  printf("<input type=hidden name=\"prohibit_click\" value=0>");
  printf("<input type=hidden name=\"numofmount\" value=%d>", v4);
  printf("<table style=\"border-collapse:collapse; border-style:none none none none; width:100%%;\" cellspacing=0px cellpadding=0px>\n");
  printf("<COL WIDTH=50><COL WIDTH=540><COL>");
  sub_5A48C();
  sub_5A62C((int)&v12, 0);
  for ( i = v13; i; i = *(_DWORD *)i )
  {
    if ( *(_DWORD *)(i + 4040) == 2 )
    {
      v8 = v5++;
      sub_59DF4(i, v8, v6);
    }
  }
  sub_5AA9C((int)&v12);
  while ( i < 10 - v5 )
  {
    if ( ((_BYTE)i + (_BYTE)v5) & 1 )
      v9 = "f7f7f7";
    else
      v9 = "ffffff";
    ++i;
    printf("<TR height=50 STYLE=\"cursor:pointer; background-Color:#%s\">", v9);
    printf("<TD></TD><TD></TD><TD CLASS=text_gray></TD></TR>");
  }
  printf("</table>");
  printf("</BODY>");
  puts("<script>");
  puts("UnMaskIt(parent.document,'apply_mask');");
  puts("PluginButtonControlInstall();");
  printf("</script>");
  printf("<iframe src=\"timepro.cgi?tmenu=iframe_plugin_action\" scrolling=no align=left valign=center height=0 frameborder=no name=\"iframe_plugin_action\"></iframe>");
  return v11;
}
// 11804: using guessed type int __fastcall get_num_of_mountdev(_DWORD);
// 12068: using guessed type int __fastcall print_file(_DWORD);

//----- (0005A090) --------------------------------------------------------
int __fastcall getPluginAction(int a1)
{
  int v1; // r5@1
  const char *v2; // r0@1
  const char *v3; // r4@1
  int v4; // r6@3
  char *v5; // r4@4
  int v6; // r0@4
  signed int v7; // r1@4
  int v8; // r6@6
  int v9; // r0@11
  unsigned int v10; // r4@11
  int v11; // r1@11
  void *v12; // r0@11
  int v13; // r4@12
  int v14; // r0@12
  signed int v15; // r3@12
  int v16; // r5@15
  int result; // r0@20
  int v18; // r5@21
  int v19; // [sp+0h] [bp-410h]@11
  char s; // [sp+200h] [bp-210h]@4
  char v21; // [sp+300h] [bp-110h]@11

  v1 = a1;
  v2 = (const char *)get_parameter_value(a1, "act");
  v3 = v2;
  if ( v2 )
  {
    if ( !strcmp(v2, "install") )
    {
      v4 = get_parameter_value(v1, "package");
      if ( !v4 )
        goto LABEL_11;
      v5 = &s;
      snprintf(&s, 0x100u, "plugin_install_%s", v4);
      v6 = v4;
      v7 = 1;
LABEL_8:
      set_plugin_status(v6, v7);
      signal_nas(v5);
      goto LABEL_11;
    }
    if ( !strcmp(v3, "remove") )
    {
      v8 = get_parameter_value(v1, "package");
      if ( !v8 )
        goto LABEL_11;
      v5 = &s;
      snprintf(&s, 0x100u, "plugin_remove_%s", v8);
      v6 = v8;
      v7 = 6;
      goto LABEL_8;
    }
    if ( !strcmp(v3, "cancel") )
      system("killall opkg-cl");
  }
LABEL_11:
  printf("<html>");
  print_file("/home/httpd/js/string.js");
  print_file("/home/httpd/js/plugin.js");
  printf("<form method=get action=\"timepro.cgi\" name=\"plugin_action_fm\">");
  printf("<input type=hidden name=tmenu value=iframe_plugin_action>");
  printf("<input type=hidden name=act>");
  printf("<input type=hidden name=package>");
  printf("</form>");
  strcpy(&v21, "");
  v9 = get_plugin_status_package(&v21);
  v10 = v9;
  v12 = sub_5AB54(v9, v11);
  snprintf((char *)&v19, 0x200u, "%s", v12);
  if ( sub_5A434(v10) )
  {
    v13 = 0;
    v14 = istatus_get_intvalue_direct((int)"plugin_process");
    v15 = v14 == -1;
    if ( v14 > 64 )
      v15 = 1;
    if ( v15 )
      v16 = 1;
    else
      v16 = v14 + 1;
    istatus_set_intvalue_direct("plugin_process", v16);
    while ( v13 < v16 )
    {
      ++v13;
      strcat((char *)&v19, ".");
    }
    sub_59C9C((int)&v21, (int)&v19);
    printf("<meta http-equiv=refresh content=\"1; URL=timepro.cgi?tmenu=iframe_plugin_action&package=%s\">", &v21);
    printf("<script>");
    puts("if(parent.main_form.smenu.value == 'plugin_install')");
    printf("parent.ClickPluginInstall('%s');\n", &v21);
    puts("if(parent.main_form.smenu.value == 'plugin_setup')");
    puts("{");
    printf((const char *)&unk_BBE72, &v21);
    puts("}");
    printf("parent.main_form.prohibit_click.value='%s'", &v21);
    printf("</script>");
    result = printf("</html>");
  }
  else
  {
    v18 = get_parameter_value(v1, "package");
    istatus_set_intvalue_direct("plugin_process", 0);
    if ( v18 )
    {
      puts("<script>");
      printf("UpdatePluginButtonStatus('%s',%d);\n", v18, v10);
      if ( v10 == 7 )
      {
        puts("if(parent.main_form.smenu.value == 'plugin_install')");
        printf("PluginFinishInstall('%s');\n", v18);
      }
      puts("</script>");
      sub_59C9C(v18, (int)&v19);
    }
    printf("<script>");
    printf("parent.main_form.prohibit_click.value=''");
    printf("</script>");
    printf("</html>");
    result = sub_5A48C();
  }
  return result;
}
// 10514: using guessed type int __fastcall istatus_set_intvalue_direct(_DWORD, _DWORD);
// 10844: using guessed type int __fastcall signal_nas(_DWORD);
// 10ACC: using guessed type int __fastcall get_plugin_status_package(_DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 11FC0: using guessed type int __fastcall set_plugin_status(_DWORD, _DWORD);
// 12068: using guessed type int __fastcall print_file(_DWORD);

//----- (0005A3E0) --------------------------------------------------------
int __fastcall plugin_install(int a1)
{
  sub_59D08(a1);
  print_mask((int)"apply_mask", 0, 0, 625, 500);
  puts("<script>");
  puts("MaskIt(document,'apply_mask');");
  return printf("</script>");
}

//----- (0005A434) --------------------------------------------------------
signed int __fastcall sub_5A434(unsigned int a1)
{
  unsigned int v1; // r3@1
  bool v2; // cf@1
  bool v3; // zf@1
  bool v4; // zf@5
  signed int result; // r0@4

  v1 = a1 - 4;
  v2 = a1 >= 1;
  v3 = a1 == 1;
  if ( a1 != 1 )
  {
    v2 = v1 >= 2;
    v3 = v1 == 2;
  }
  if ( !v3 && v2 )
  {
    v4 = a1 == 2;
    if ( a1 != 2 )
      v4 = a1 == 3;
    result = v4 != 0;
  }
  else
  {
    result = 1;
  }
  return result;
}

//----- (0005A460) --------------------------------------------------------
signed int __fastcall sub_5A460(int a1, char *a2, int a3)
{
  snprintf(a2, 0x100u, "%s/%s.png", "http://download.iptime.co.kr/plugin/nas_icon", a1, a2, a3);
  return 1;
}

//----- (0005A48C) --------------------------------------------------------
int sub_5A48C()
{
  int result; // r0@2
  char v1; // [sp+4h] [bp-114h]@3
  int v2; // [sp+104h] [bp-14h]@1

  get_process_list("opkg-cl", &v2, 0);
  free_process_list(&v2);
  if ( v2 )
  {
    result = 0;
  }
  else
  {
    system("mkdir -p  /tmp/hdd/plugin/opkg");
    snprintf(&v1, 0x100u, "%s update > /dev/null 2>&1", "/sbin/opkg-cl");
    system(&v1);
    system("/sbin/opkg-cl list-installed > /var/run/opkg-list-installed");
    system("/sbin/opkg-cl list-upgradable > /var/run/opkg-list-upgradable");
    result = file_exists("/tmp/hdd/plugin/opkg/ipTIME");
  }
  return result;
}
// 10EF8: using guessed type int __fastcall get_process_list(_DWORD, _DWORD, _DWORD);
// 111D4: using guessed type int __fastcall free_process_list(_DWORD);
// 11A2C: using guessed type int __fastcall file_exists(_DWORD);

//----- (0005A56C) --------------------------------------------------------
const char *__fastcall sub_5A56C(const char *a1)
{
  const char *v1; // r5@1
  FILE *v2; // r4@2
  char *v3; // r1@4
  char *v4; // r0@7
  char *v5; // r0@8
  int v7; // [sp+0h] [bp-218h]@4

  v1 = a1;
  if ( !a1 )
    return v1;
  v2 = fopen("/var/run/opkg-list-upgradable", "r");
  if ( v2 )
  {
    while ( 1 )
    {
      v5 = fgets((char *)&v7, 512, v2);
      if ( !v5 )
        break;
      v3 = strtok((char *)&v7, " ");
      if ( v3 )
      {
        if ( !strcmp(v1, v3) )
        {
          if ( strtok(0, " ") )
          {
            v4 = strtok(0, " ");
            if ( v4 )
            {
              v5 = strdup(v4);
              break;
            }
          }
        }
      }
    }
    v1 = v5;
    fclose(v2);
  }
  else
  {
    v1 = 0;
  }
  return v1;
}

//----- (0005A62C) --------------------------------------------------------
FILE *__fastcall sub_5A62C(int a1, int a2)
{
  int v2; // r6@1
  int v3; // r4@1
  int v4; // r7@1
  FILE *v5; // r8@2
  void *v6; // r4@4
  char *v7; // r0@6
  char *v8; // r0@8
  char *v9; // r0@16
  signed int v10; // r3@20
  const char *v11; // r0@28
  signed int v12; // r3@28
  const char *v13; // r11@28
  char *v14; // r0@32
  char *i; // r0@46
  int v16; // r11@48
  char *v17; // r0@48
  char *v18; // r0@49
  char *v19; // r0@52
  _DWORD *v20; // r3@52
  bool v21; // zf@52
  int v22; // r3@57
  char v24; // [sp+10h] [bp-428h]@6
  char s1; // [sp+14h] [bp-424h]@38
  char v26; // [sp+18h] [bp-420h]@42
  _BYTE v27[3]; // [sp+19h] [bp-41Fh]@11
  char v28; // [sp+1Ch] [bp-41Ch]@34
  _BYTE v29[3]; // [sp+1Dh] [bp-41Bh]@52
  __int16 v30; // [sp+1Eh] [bp-41Ah]@36

  v2 = a1;
  v3 = a2;
  v4 = lock_file("plugin");
  *(_DWORD *)(v2 + 8) = 0;
  *(_DWORD *)(v2 + 4) = 0;
  *(_DWORD *)v2 = 0;
  if ( !v3 || (v5 = (FILE *)sub_5A48C()) != 0 )
  {
    v5 = fopen("/tmp/hdd/plugin/opkg/ipTIME", "r");
    if ( v5 )
    {
      v6 = 0;
      while ( 1 )
      {
        while ( 1 )
        {
          while ( 1 )
          {
            while ( 1 )
            {
              do
              {
                while ( 1 )
                {
                  if ( !fgets(&v24, 1024, v5) )
                  {
                    fclose(v5);
                    unlock_file(v4);
                    return *(FILE **)v2;
                  }
                  v7 = strrchr(&v24, 13);
                  if ( v7 )
                    *v7 = 0;
                  v8 = strrchr(&v24, 10);
                  if ( v8 )
                    *v8 = 0;
                  if ( strncmp(&v24, "Package", 7u) )
                    break;
                  v6 = malloc(0xFE4u);
                  memset(v6, 0, 0xFE4u);
                  *((_DWORD *)v6 + 1002) = strdup(v27);
                }
              }
              while ( !v6 );
              if ( strncmp(&v24, "Priority", 8u) )
                break;
              *((_DWORD *)v6 + 1003) = strdup(&v27[1]);
            }
            if ( strncmp(&v24, "Maintainer", 0xAu) )
              break;
            v9 = strrchr(&v24, 45);
            if ( v9 )
              *((_DWORD *)v6 + 1004) = strdup(v9 + 2);
          }
          if ( !strncmp(&v24, "Section", 7u) )
            break;
          if ( !strncmp(&v24, "Version", 7u) )
          {
            *((_DWORD *)v6 + 1005) = strdup(v27);
            v11 = sub_5A56C(*((const char **)v6 + 1002));
            v13 = v11;
            if ( v11 )
              v12 = 1;
            *((_DWORD *)v6 + 1006) = v11;
            if ( v11 )
            {
              *((_DWORD *)v6 + 1012) = v12;
            }
            else
            {
              v14 = strdup(*((const char **)v6 + 1005));
              *((_DWORD *)v6 + 1012) = v13;
              *((_DWORD *)v6 + 1006) = v14;
            }
          }
          else if ( !strncmp(&v24, "NasVersion", 0xAu) )
          {
            *((_DWORD *)v6 + 1007) = strdup(&v28);
          }
          else if ( !strncmp(&v24, "Architecture", 0xCu) )
          {
            *((_DWORD *)v6 + 1008) = strdup((const char *)&v30);
          }
          else if ( !strncmp(&v24, "UI", 2u) )
          {
            *((_DWORD *)v6 + 1013) = strcmp(&s1, "yes") == 0;
          }
          else if ( !strncmp(&v24, "Config", 6u) )
          {
            if ( !strncmp(&v24, "ConfigFile", 0xAu) )
              *((_DWORD *)v6 + 1015) = strdup(&v28);
            else
              *((_DWORD *)v6 + 1014) = strcmp(&v26, "yes") == 0;
          }
          else if ( !strncmp(&v24, "Runnable", 8u) )
          {
            *((_DWORD *)v6 + 1016) = strcmp(&v27[1], "yes") == 0;
          }
          else if ( !strncmp(&v24, "Depends", 7u) )
          {
            for ( i = v27; ; i = 0 )
            {
              v18 = strtok(i, " \r\n");
              if ( !v18 )
                break;
              v16 = *((_DWORD *)v6 + 1001);
              v17 = strdup(v18);
              *((_DWORD *)v6 + 1001) = v16 + 1;
              *((_DWORD *)v6 + v16 + 1) = v17;
            }
          }
          else if ( !strncmp(&v24, "Description", 0xBu) )
          {
            v19 = strdup(v29);
            v20 = *(_DWORD **)(v2 + 4);
            *((_DWORD *)v6 + 1009) = v19;
            v21 = v20 == 0;
            if ( v20 )
            {
              v20 = *(_DWORD **)(v2 + 8);
            }
            else
            {
              *(_DWORD *)(v2 + 8) = v6;
              *(_DWORD *)(v2 + 4) = v6;
            }
            if ( !v21 )
              *v20 = v6;
            v22 = *(_DWORD *)v2;
            if ( !v21 )
              *(_DWORD *)(v2 + 8) = v6;
            v6 = 0;
            *(_DWORD *)v2 = v22 + 1;
          }
        }
        if ( !strcmp(v27, "java") )
        {
          v10 = 1;
          goto LABEL_23;
        }
        if ( !strcmp(v27, "apache") )
          break;
        if ( !strcmp(v27, "system") )
        {
          v10 = 3;
LABEL_23:
          *((_DWORD *)v6 + 1010) = v10;
        }
      }
      v10 = 2;
      goto LABEL_23;
    }
  }
  unlock_file(v4);
  return v5;
}
// 1211C: using guessed type int __fastcall lock_file(_DWORD);

//----- (0005AA9C) --------------------------------------------------------
int __fastcall sub_5AA9C(int a1)
{
  int v1; // r4@1
  void *v2; // r0@2
  int v3; // r7@2
  void *v4; // r0@4
  void *v5; // r0@6
  void *v6; // r0@8
  void *v7; // r0@10
  void *v8; // r0@12
  int v9; // r6@14
  int i; // r5@14
  void *v11; // r0@15
  void *v12; // t1@15
  void *v13; // r0@19

  v1 = *(_DWORD *)(a1 + 4);
  while ( v1 )
  {
    v2 = *(void **)(v1 + 4008);
    v3 = *(_DWORD *)v1;
    if ( v2 )
      free(v2);
    v4 = *(void **)(v1 + 4016);
    if ( v4 )
      free(v4);
    v5 = *(void **)(v1 + 4020);
    if ( v5 )
      free(v5);
    v6 = *(void **)(v1 + 4024);
    if ( v6 )
      free(v6);
    v7 = *(void **)(v1 + 4032);
    if ( v7 )
      free(v7);
    v8 = *(void **)(v1 + 4036);
    if ( v8 )
      free(v8);
    v9 = v1;
    for ( i = 0; i < *(_DWORD *)(v1 + 4004); ++i )
    {
      v12 = *(void **)(v9 + 4);
      v9 += 4;
      v11 = v12;
      if ( v12 )
        free(v11);
    }
    v13 = (void *)v1;
    v1 = v3;
    free(v13);
  }
  return 0;
}

//----- (0005AB54) --------------------------------------------------------
void *__fastcall sub_5AB54(int a1, int a2)
{
  int v2; // r0@2
  const char *v3; // r1@14
  char *v4; // r0@14

  switch ( a1 )
  {
    case 1:
      v2 = 978;
      break;
    case 2:
      v2 = 980;
      break;
    case 3:
      v2 = 979;
      break;
    case 4:
      v2 = 973;
      break;
    case 5:
      v2 = 982;
      break;
    case 6:
      v2 = 977;
      break;
    case 7:
      v2 = 971;
      break;
    case 8:
    case 20:
      v2 = 975;
      break;
    default:
      v4 = (char *)&unk_CA8DC;
      v3 = "";
      goto LABEL_16;
    case 10:
      v2 = 972;
      break;
    case 11:
      v2 = 976;
      break;
    case 12:
      v2 = 981;
      break;
    case 21:
      v2 = 974;
      break;
  }
  v3 = (const char *)get_ux_text_common(v2, a2);
  v4 = (char *)&unk_CA8DC;
LABEL_16:
  strcpy(v4, v3);
  return &unk_CA8DC;
}

//----- (0005AC44) --------------------------------------------------------
int __fastcall sub_5AC44(int a1)
{
  int v1; // r5@1
  const char *v2; // r0@1
  const char *v3; // r4@1
  const char *v4; // r0@3
  int v5; // r4@3
  int v6; // r0@9
  int v7; // r0@9
  const char *v8; // r4@11
  size_t v9; // r0@13
  size_t v10; // r0@14
  const char *v11; // r1@16
  int v12; // r7@19
  char s; // [sp+Ch] [bp-10B4h]@15
  int v15; // [sp+100Ch] [bp-B4h]@13
  int v16; // [sp+108Ch] [bp-34h]@4

  v1 = a1;
  v2 = (const char *)get_parameter_value(a1, "act");
  v3 = v2;
  if ( !v2 )
    return 0;
  if ( !strcmp(v2, "apply") )
  {
    v4 = (const char *)get_parameter_value(v1, "op");
    v5 = atoi(v4);
    if ( v5 != get_plantynet_service(v5) )
    {
      plantynet_service_request("TCP", 85, 0, 0);
      get_plantynet_status(&v16);
      if ( !strcmp((const char *)&v16, "free") || !strcmp((const char *)&v16, "paid") )
      {
        if ( v5 )
          plantynet_service_event(3, 0);
        else
          v5 = 2;
      }
      v6 = set_plantynet_service(v5);
      v7 = signal_update(v6);
LABEL_28:
      signal_save(v7);
      return 0;
    }
  }
  else
  {
    if ( !strcmp(v3, "add") )
    {
      memset(&v16, 0, 0x14u);
      get_hw_value(v1, "hw", &v16);
      strtolower(&v16);
      v8 = (const char *)get_parameter_value(v1, &unk_B1017);
      if ( check_unpermitted_chars(v8) || !v8 )
      {
        v10 = strlen((const char *)&v16);
        v8 = 0;
        Base64encode(&v15, &v16, v10);
      }
      else
      {
        v9 = strlen(v8);
        Base64encode(&v15, v8, v9);
      }
      snprintf(&s, 0xFEu, "%s,%s", &v16, &v15);
      plantynet_service_event(256, &s);
      if ( v8 )
        v11 = v8;
      else
        v11 = (const char *)&v16;
      v7 = add_plantynet_freedevice(&v16, v11);
      goto LABEL_28;
    }
    v12 = strcmp(v3, "del");
    if ( !v12 )
    {
      memset(&s, 0, 0x1000u);
      while ( 1 )
      {
        v7 = get_value_array(v1, "delchk", v12, &v16);
        if ( !v7 )
          break;
        if ( s )
          snprintf(&s, 0xFFFu, "%s|%s", &s, &v16);
        else
          sf_strncpy(&s, &v16, 4096);
        ++v12;
        remove_plantynet_freedevice(&v16);
      }
      if ( s )
        v7 = plantynet_service_event(512, &s);
      goto LABEL_28;
    }
  }
  return 0;
}
// 1040C: using guessed type int __fastcall get_hw_value(_DWORD, _DWORD, _DWORD);
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 106B8: using guessed type int __fastcall get_plantynet_status(_DWORD);
// 107E4: using guessed type int __fastcall signal_save(_DWORD);
// 107FC: using guessed type int __fastcall get_plantynet_service(_DWORD);
// 10A30: using guessed type int __fastcall set_plantynet_service(_DWORD);
// 10CC4: using guessed type int __fastcall get_value_array(_DWORD, _DWORD, _DWORD, _DWORD);
// 11000: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// 11030: using guessed type int __fastcall plantynet_service_event(_DWORD, _DWORD);
// 115D0: using guessed type int __fastcall Base64encode(_DWORD, _DWORD, _DWORD);
// 117E0: using guessed type int __fastcall add_plantynet_freedevice(_DWORD, _DWORD);
// 11924: using guessed type int __fastcall get_parameter_value(_DWORD, _DWORD);
// 11BB8: using guessed type int __fastcall plantynet_service_request(_DWORD, _DWORD, _DWORD, _DWORD);
// 11BC4: using guessed type int __fastcall remove_plantynet_freedevice(_DWORD);
// 11F18: using guessed type int __fastcall signal_update(_DWORD);
// 11FFC: using guessed type int __fastcall strtolower(_DWORD);

//----- (0005AF1C) --------------------------------------------------------
int sub_5AF1C()
{
  int v0; // r0@1
  int v1; // r0@2
  int v2; // r1@2
  int v3; // r4@2
  int v4; // r1@2
  int v5; // r0@2
  int v6; // r0@2
  int v7; // r0@2
  int result; // r0@2
  int v9; // r0@3
  int v10; // r1@3
  const char *v11; // r0@3
  int v12; // r0@3
  int v13; // r0@3
  int v14; // r0@3
  int v15; // r6@3
  int v16; // r1@3
  signed int v17; // r5@4
  int v18; // r0@6
  int v19; // r0@6
  int v20; // r0@6
  int v21; // r1@6
  int v22; // r0@6
  int v23; // r1@6
  char *v24; // r10@7
  int v25; // r0@9
  int v26; // r1@9
  char *v27; // r6@10
  int v28; // r0@12
  int v29; // r1@12
  int v30; // r0@12
  int v31; // r0@12
  int v32; // r0@12
  int v33; // r0@12
  int v34; // r0@12
  int v35; // r0@12
  int v36; // r0@12
  int v37; // r0@12
  int v38; // r1@12
  int v39; // r0@12
  int v40; // r0@12
  int v41; // r0@12
  int v42; // r1@12
  int v43; // r0@12
  char *v44; // r0@12
  char *v45; // r7@13
  int v46; // r1@15
  const char *v47; // r0@15
  int v48; // r1@15
  int v49; // r5@15
  int v50; // r0@15
  int v51; // r0@15
  int v52; // r1@15
  int v53; // r0@15
  int v54; // r0@15
  int v55; // r0@15
  int v56; // r9@15
  int v57; // r1@15
  const char *v58; // r0@15
  int v59; // r1@15
  int v60; // r1@15
  const char *v61; // r2@16
  int v62; // r0@18
  int v63; // r0@18
  int v64; // r0@18
  int v65; // r0@18
  int v66; // r1@18
  int v67; // r0@18
  int v68; // r1@18
  int v69; // r0@18
  int v70; // r1@18
  int v71; // r1@18
  int v72; // r0@18
  int i; // r0@18
  int v74; // r0@20
  int v75; // r0@22
  int v76; // r0@22
  char v77; // [sp+Ch] [bp-35Ch]@1
  char v78; // [sp+20Ch] [bp-15Ch]@19
  char v79; // [sp+30Ch] [bp-5Ch]@19
  char v80; // [sp+320h] [bp-48h]@3
  char v81; // [sp+334h] [bp-34h]@12

  v0 = get_wan_ip("wan1", &v77);
  if ( v0 )
  {
    v9 = print_start_content_table(v0);
    str(v9);
    v11 = (const char *)get_ux_text_common(962, v10);
    snprintf(&v77, 0x200u, v11, "http://iptime.iansim.net/service/serviceIntroduce.jsp");
    v12 = print_item(&v77, 0);
    v13 = etr(v12);
    print_end_content_table(v13);
    print_blank_line(1, 15);
    printf("<form method=get action=timepro.cgi name=plantynet_fm>");
    printf("<input type=hidden name=tmenu value=firewallconf>");
    printf("<input type=hidden name=smenu value=plantynet>");
    v14 = printf("<input type=hidden name=act value=>");
    v15 = get_plantynet_service(v14);
    plantynet_service_request("TCP", 85, 0, 0);
    get_plantynet_status(&v80);
    if ( !strcmp(&v80, "free") )
      v17 = 1;
    else
      v17 = strcmp(&v80, "paid") == 0;
    v18 = get_ux_text_common(965, v16);
    v19 = print_sub_title(v18, 1);
    v20 = print_start_content_table(v19);
    str(v20);
    v22 = get_ux_text_common(938, v21);
    print_item_desc(v22, 0, 0, 0);
    puts("<td class=item_td>");
    if ( v15 == 1 )
      v24 = "checked";
    else
      v24 = "";
    v25 = get_ux_text_common(1104, v23);
    printf("<input type=radio name=op value=1 %s> %s", v24, v25);
    print_nbsp(5);
    if ( v15 == 1 )
      v27 = "";
    else
      v27 = "checked";
    v28 = get_ux_text_common(1111, v26);
    printf("<input type=radio name=op value=0 %s> %s", v27, v28);
    puts("</td>");
    puts("<td class=item_td>");
    v30 = get_ux_text_common(35, v29);
    printf("<input type=button name=op_button value=\"%s\" onclick=\"ApplyPlantynet()\">", v30);
    v31 = puts("</td>");
    v32 = etr(v31);
    str(v32);
    v33 = puts("<td colspan=3 class=item_td></td>");
    v34 = etr(v33);
    str(v34);
    printf("<td colspan=3 height=310 valign=top align=center style=\"padding: 0px; background-color:#f2f2fc; border:1px solid #cccccc; border-style:none solid solid solid;\" >");
    printf("<iframe name=\"ifr_plantynet\" scrolling=no style=\"border:1px solid #cccccc;\" frameborder=no width=600 height=310 src=\about:blank\"></iframe>");
    v35 = printf("</td>");
    v36 = etr(v35);
    print_end_content_table(v36);
    printf("</form>");
    get_hwaddr_kernel("br0", &v81);
    printf(
      "<form name=\"ifr_form\" target=\"ifr_plantynet\" method=\"POST\" action=\"%s\">",
      "http://iptime.iansim.net/service/serviceInfo.jsp");
    v37 = strtolower(&v81);
    printf("<input type=hidden name=MAC value=%s>", v37);
    printf("</form>");
    puts("<script language=\"JavaScript\">");
    puts("document.ifr_form.target=\"ifr_plantynet\";");
    puts("document.ifr_form.submit();");
    puts("</script>");
    print_blank_line(1, 15);
    printf("<form method=get action=timepro.cgi name=freedevice_fm>");
    printf("<input type=hidden name=tmenu value=firewallconf>");
    printf("<input type=hidden name=smenu value=plantynet>");
    printf("<input type=hidden name=act value=>");
    printf("<input type=hidden name=del value=>");
    v39 = get_ux_text_common(960, v38);
    v40 = print_sub_title(v39, 1);
    v41 = print_start_content_table(v40);
    str(v41);
    v43 = get_ux_text_common(591, v42);
    print_item_desc(v43, 0, 0, 0);
    puts("<td class=item_td align=left>");
    v44 = getenv("REMOTE_ADDR");
    get_internal_pc_hardware_address(v44, &v81);
    if ( v17 )
      v45 = "";
    else
      v45 = "disabled";
    printf(
      "<input type=checkbox class=navi_chk name=delchk onclick=\"SetHWOnCheckNoDisable(this,'hw','%s');\" %s> ",
      &v81,
      v45);
    v47 = (const char *)get_ux_text_common(383, v46);
    printf(v47);
    printf("<br>");
    print_hwadress_inputbox((int)"hw", 0, v17 ^ 1);
    print_nbsp(5);
    get_ux_text_common(983, v48);
    v49 = 0;
    print_popup_button(
      "timepro.cgi?tmenu=popup&smenu=selectmac&formname=freedevice_fm&macprefix=hw",
      "searchmac",
      "width=400px,height=250px,scrollbars=yes,menubar=no,toolbar=no,resizable=yes",
      "macbutton");
    v50 = printf("</td>");
    v51 = etr(v50);
    str(v51);
    v53 = get_ux_text_common(246, v52);
    print_item_desc(v53, 0, 0, 0);
    puts("<td colspan=2 class=item_td>");
    v54 = printf("<input type=text name=\"dev_desc\" maxlength=24 size=24 value='' %s></td>\n", v45);
    v55 = etr(v54);
    v56 = get_plantynet_freedevice_num(v55);
    str(v56);
    puts("<td class=item_td colspan=2>");
    printf("<table class=nomargin_table width=100%%><tr><td align=left><font color='gray'>\n");
    v58 = (const char *)get_ux_text_common(961, v57);
    printf(v58, 10);
    printf("</td><td align=right>");
    v60 = get_ux_text_common(6, v59);
    if ( v56 > 9 )
      v61 = "disabled";
    else
      v61 = v45;
    printf("<input type=button name=freedev_submit value=\"%s\" onclick=\"AddPlantynetFreeDevice();\" %s>", v60, v61);
    printf("</td></tr></table>");
    v62 = printf("</td>");
    v63 = etr(v62);
    print_end_content_table(v63);
    v64 = print_blank_line(1, 20);
    v65 = print_start_content_table(v64);
    str(v65);
    print_item_desc("", 30, 0, 0);
    v67 = get_ux_text_common(591, v66);
    print_item_desc(v67, 200, 0, 0);
    v69 = get_ux_text_common(246, v68);
    print_item_desc(v69, 250, 0, 0);
    printf("<td class=itemdesc_td align=left width=38>");
    v71 = get_ux_text_common(143, v70);
    printf("<input class=navi_bt type=button name=del_bt value=\"%s\" onclick=\"DeletePlantynetFreeDevice()\" %s>", v71);
    v72 = printf("</td>");
    for ( i = etr(v72); v49 < v56; i = etr(v74) )
    {
      i = get_plantynet_freedevice(v49, &v79, &v78);
      if ( !i )
        break;
      ++v49;
      str(i);
      printf("<td class=item_td width=70>%d</td>\n", v49);
      sf_strncpy(&v77, &v79, 512);
      convert_mac(&v77);
      print_item(&v77, 200);
      print_item(&v78, 300);
      v74 = printf("<td class=item_td align=center ><input type=checkbox name=delchk value=\"%s\"></td>", &v79);
    }
    str(i);
    v75 = puts("<td class=item_td colspan=4> </td>");
    v76 = etr(v75);
    print_end_content_table(v76);
    result = puts("</form>");
  }
  else
  {
    v1 = print_start_content_table(0);
    str(v1);
    v3 = get_ux_text_common(963, v2);
    v5 = get_ux_text_common(966, v4);
    snprintf(&v77, 0x200u, "%s<br>%s", v3, v5);
    v6 = printf("<td style='padding: 5px;'>%s</td>", &v77);
    v7 = etr(v6);
    result = print_end_content_table(v7);
  }
  return result;
}
// 105E0: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 10604: using guessed type int __fastcall get_plantynet_freedevice_num(_DWORD);
// 106B8: using guessed type int __fastcall get_plantynet_status(_DWORD);
// 107C0: using guessed type int __fastcall get_hwaddr_kernel(_DWORD, _DWORD);
// 107FC: using guessed type int __fastcall get_plantynet_service(_DWORD);
// 108F8: using guessed type int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD);
// 10BEC: using guessed type int __fastcall print_popup_button(_DWORD, _DWORD, _DWORD, _DWORD);
// 10C58: using guessed type int __fastcall convert_mac(_DWORD);
// 10D6C: using guessed type int __fastcall print_item(_DWORD, _DWORD);
// 10E68: using guessed type int __fastcall str(_DWORD);
// 112A0: using guessed type int __fastcall etr(_DWORD);
// 112DC: using guessed type int __fastcall print_sub_title(_DWORD, _DWORD);
// 11570: using guessed type int __fastcall print_nbsp(_DWORD);
// 117BC: using guessed type int __fastcall print_item_desc(_DWORD, _DWORD, _DWORD, _DWORD);
// 11954: using guessed type int __fastcall print_start_content_table(_DWORD);
// 119B4: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);
// 11A20: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// 11BB8: using guessed type int __fastcall plantynet_service_request(_DWORD, _DWORD, _DWORD, _DWORD);
// 11D98: using guessed type int __fastcall print_end_content_table(_DWORD);
// 11DF8: using guessed type int __fastcall get_plantynet_freedevice(_DWORD, _DWORD, _DWORD);
// 11FFC: using guessed type int __fastcall strtolower(_DWORD);

//----- (0005B588) --------------------------------------------------------
int __fastcall firewallconf_plantynet(int a1)
{
  int v1; // r0@1
  int v2; // r0@1

  v1 = sub_5AC44(a1);
  print_start_main_table(v1);
  v2 = sub_5AF1C();
  return print_end_main_table(v2);
}
// 1121C: using guessed type int __fastcall print_start_main_table(_DWORD);
// 115DC: using guessed type int __fastcall print_end_main_table(_DWORD);

//----- (0005B5A0) --------------------------------------------------------
unsigned int __fastcall sub_5B5A0(unsigned int result, unsigned int a2)
{
  char v2; // r2@5
  unsigned int v3; // r1@5
  unsigned int v4; // r3@5
  unsigned int v5; // r2@5
  bool v6; // zf@14

  if ( a2 == 1 )
    return result;
  if ( a2 < 1 )
    JUMPOUT(&loc_5C56C);
  if ( result <= a2 )
  {
    result = result == a2;
  }
  else if ( a2 & (a2 - 1) )
  {
    v2 = __clz(a2) - __clz(result);
    v3 = a2 << v2;
    v4 = 1 << v2;
    v5 = 0;
    while ( 1 )
    {
      if ( result >= v3 )
      {
        result -= v3;
        v5 |= v4;
      }
      if ( result >= v3 >> 1 )
      {
        result -= v3 >> 1;
        v5 |= v4 >> 1;
      }
      if ( result >= v3 >> 2 )
      {
        result -= v3 >> 2;
        v5 |= v4 >> 2;
      }
      if ( result >= v3 >> 3 )
      {
        result -= v3 >> 3;
        v5 |= v4 >> 3;
      }
      v6 = result == 0;
      if ( result )
      {
        v4 >>= 4;
        v6 = v4 == 0;
      }
      if ( v6 )
        break;
      v3 >>= 4;
    }
    result = v5;
  }
  else
  {
    result >>= 31 - __clz(a2);
  }
  return result;
}

//----- (0005B648) --------------------------------------------------------
unsigned int __fastcall sub_5B648(unsigned int a1, unsigned int a2)
{
  if ( !a2 )
    JUMPOUT(&loc_5B63C);
  return sub_5B5A0(a1, a2);
}

//----- (0005B668) --------------------------------------------------------
int __fastcall calc_mask(int a1, int a2)
{
  if ( !a2 )
    JUMPOUT(&loc_5C56C);
  return sub_5B670(a1, a2);
}

//----- (0005B670) --------------------------------------------------------
int __fastcall sub_5B670(int result, unsigned int a2)
{
  char v2; // nf@0
  signed int v3; // r12@1
  unsigned int v4; // r3@4
  char v5; // r0@8
  unsigned int v6; // r1@8
  unsigned int v7; // r2@8
  bool v8; // zf@17

  v3 = result ^ a2;
  if ( v2 )
    a2 = -a2;
  if ( a2 == 1 )
  {
    if ( (v3 ^ result) < 0 )
      result = -result;
  }
  else
  {
    v4 = result;
    if ( result < 0 )
      v4 = -result;
    if ( v4 <= a2 )
    {
      if ( v4 < a2 )
        result = 0;
      if ( v4 == a2 )
        result = (v3 >> 31) | 1;
    }
    else if ( a2 & (a2 - 1) )
    {
      v5 = __clz(a2) - __clz(v4);
      v6 = a2 << v5;
      v7 = 1 << v5;
      result = 0;
      while ( 1 )
      {
        if ( v4 >= v6 )
        {
          v4 -= v6;
          result |= v7;
        }
        if ( v4 >= v6 >> 1 )
        {
          v4 -= v6 >> 1;
          result |= v7 >> 1;
        }
        if ( v4 >= v6 >> 2 )
        {
          v4 -= v6 >> 2;
          result |= v7 >> 2;
        }
        if ( v4 >= v6 >> 3 )
        {
          v4 -= v6 >> 3;
          result |= v7 >> 3;
        }
        v8 = v4 == 0;
        if ( v4 )
        {
          v7 >>= 4;
          v8 = v7 == 0;
        }
        if ( v8 )
          break;
        v6 >>= 4;
      }
      if ( v3 < 0 )
        result = -result;
    }
    else
    {
      result = v4 >> (31 - __clz(a2));
      if ( v3 < 0 )
        result = -result;
    }
  }
  return result;
}

//----- (0005B744) --------------------------------------------------------
int __fastcall sub_5B744(int a1, unsigned int a2)
{
  if ( !a2 )
    JUMPOUT(&loc_5B734);
  return sub_5B670(a1, a2);
}

//----- (0005BA1C) --------------------------------------------------------
unsigned int __fastcall sub_5BA1C(unsigned int result, int a2, int a3, int a4, int a5, int a6, int (__fastcall *a7)(_DWORD, unsigned int))
{
  unsigned int v7; // r3@2

  if ( !result )
    return result;
  v7 = __clz(result) + 21;
  result = a7(0, (result << (v7 - 32)) + ((1074 - v7) << 20));
  return result;
}

//----- (0005BA40) --------------------------------------------------------
int __fastcall sub_5BA40(int result)
{
  if ( result )
    JUMPOUT(&loc_5B8B8);
  return result;
}

//----- (0005BB1C) --------------------------------------------------------
unsigned int __fastcall sub_5BB1C(unsigned int result, unsigned int a2, unsigned int a3, unsigned int a4)
{
  unsigned int v4; // r5@0
  bool v5; // zf@1
  unsigned int v6; // r4@1
  int v7; // r4@7
  unsigned int v8; // r6@7
  unsigned int v9; // r1@7
  unsigned int v10; // r3@7
  bool v11; // zf@7
  int v12; // r1@9
  int v13; // r3@9
  unsigned int v14; // r12@10
  unsigned int v15; // r5@10
  unsigned int v16; // lr@10
  unsigned int v17; // r2@10
  unsigned int v18; // r5@10
  unsigned int v19; // lr@10
  unsigned __int64 v20; // kr18_8@10
  unsigned int v21; // r5@10
  unsigned int v22; // r6@10
  unsigned int v23; // r4@12
  int v24; // off@13
  unsigned int v25; // r1@14
  unsigned int v26; // lr@14
  unsigned __int8 v27; // cf@14
  bool v28; // zf@14
  bool v29; // nf@14
  unsigned __int8 v30; // vf@14
  unsigned int v31; // r12@14
  unsigned __int8 v32; // cf@17
  unsigned int v33; // r1@20
  bool v34; // zf@20
  bool v35; // nf@20
  unsigned __int8 v36; // vf@20
  int v37; // r4@20
  int v38; // r4@29
  int v39; // r4@29
  int v40; // r4@31
  char v41; // r4@33
  unsigned int v42; // r3@33
  char v43; // r4@36
  unsigned int v44; // r3@36
  unsigned int v45; // lr@39
  unsigned int v46; // r3@39
  unsigned int v47; // r5@47
  bool v48; // zf@49
  bool v49; // zf@52
  bool v50; // zf@57

  v6 = (a2 >> 20) & 0x7FF;
  v5 = v6 == 0;
  if ( v6 )
  {
    v4 = (a4 >> 20) & 0x7FF;
    v5 = v4 == 0;
  }
  if ( !v5 )
  {
    v5 = v6 == 2047;
    if ( v6 != 2047 )
      v5 = v4 == 2047;
  }
  if ( v5 )
  {
    v48 = v6 == 2047;
    v47 = (a4 >> 20) & 0x7FF;
    if ( v6 != 2047 )
      v48 = v47 == 2047;
    if ( v48 )
    {
      v50 = (result | 2 * a2) == 0;
      if ( result | 2 * a2 )
      {
        v50 = (a3 | 2 * a4) == 0;
      }
      else
      {
        result = a3;
        a2 = a4;
      }
      if ( !v50 && (v6 != 2047 || !(result | (a2 << 12))) )
      {
        if ( v47 == 2047 && a3 | (a4 << 12) )
          return a3;
        return 0;
      }
    }
    else
    {
      v49 = (result | 2 * a2) == 0;
      if ( result | 2 * a2 )
        v49 = (a3 | 2 * a4) == 0;
      if ( v49 )
      {
        result = 0;
      }
      else
      {
        if ( v6 )
          goto LABEL_69;
        while ( 1 )
        {
          v27 = __CFSHL__(result, 1);
          result *= 2;
          a2 += v27 + a2;
          if ( a2 & 0x100000 )
            break;
          --v6;
        }
        if ( !v47 )
        {
LABEL_69:
          while ( 1 )
          {
            v27 = __CFSHL__(a3, 1);
            a3 *= 2;
            a4 += v27 + a4;
            if ( a4 & 0x100000 )
              break;
            --v47;
          }
        }
      }
    }
  }
  else
  {
    v7 = v6 + v4;
    v8 = a2 ^ a4;
    v9 = a2 & 0x1FFFFF;
    v10 = a4 & 0x1FFFFF;
    v11 = (result | (v9 << 12)) == 0;
    if ( result | (v9 << 12) )
      v11 = (a3 | (v10 << 12)) == 0;
    v12 = v9 | 0x100000;
    v13 = v10 | 0x100000;
    if ( v11 )
    {
      result |= a3;
      v33 = (v8 & 0x80000000 | v12) ^ v13;
      v36 = __OFSUB__(v7, 1023);
      v37 = v7 - 1023;
      v34 = v37 == 0;
      v35 = v37 < 0;
      if ( !((unsigned __int8)((v37 < 0) ^ v36) | (v37 == 0)) )
      {
        v36 = __OFSUB__(2047, v37);
        v34 = 2047 == v37;
        v35 = 2047 - v37 < 0;
      }
      if ( !((unsigned __int8)(v35 ^ v36) | v34) )
        return result;
      v25 = v33 | 0x100000;
      v26 = 0;
      v30 = __OFSUB__(v37, 1);
      v23 = v37 - 1;
      v28 = v23 == 0;
      v29 = (v23 & 0x80000000) != 0;
    }
    else
    {
      v14 = result * a3;
      v15 = ((unsigned int)v12 * (unsigned __int64)a3 + (result * (unsigned __int64)a3 >> 32)) >> 32;
      v16 = v12 * a3 + (result * (unsigned __int64)a3 >> 32);
      v17 = v8 & 0x80000000;
      v20 = result * (unsigned __int64)(unsigned int)v13 + __PAIR__(v15, v16);
      v18 = v20 >> 32;
      v19 = v20;
      v22 = ((unsigned int)v12 * (unsigned __int64)(unsigned int)v13 + v18) >> 32;
      v21 = v12 * v13 + v18;
      if ( v14 )
        v19 = v20 | 1;
      v23 = (__PAIR__((unsigned int)(v7 - 255), v22) - 3298534883840LL) >> 32;
      if ( v22 < 0x200 )
      {
        v27 = __CFSHL__(v19, 1);
        v19 *= 2;
        v24 = v27 + v21;
        v27 = __CFADD__(v27, v21) | __CFADD__(v21, v24);
        v21 += v24;
        v22 += v27 + v22;
      }
      v25 = v17 | (v22 << 11) | (v21 >> 21);
      result = (v21 << 11) | (v19 >> 21);
      v26 = v19 << 11;
      v30 = __OFSUB__(v23, 253);
      v27 = v23 >= 0xFD;
      v31 = v23 - 253;
      v28 = v23 == 253;
      v29 = ((v23 - 253) & 0x80000000) != 0;
      if ( v23 > 0xFD )
      {
        v30 = __OFSUB__(v31, 1792);
        v27 = v31 >= 0x700;
        v28 = v31 == 1792;
        v29 = ((v23 - 2045) & 0x80000000) != 0;
      }
      if ( !(!v28 & v27) )
      {
        v32 = v26 >= 0x80000000;
        if ( v26 == 0x80000000 )
          v32 = result & 1;
        result += v32;
        return result;
      }
    }
    if ( !((unsigned __int8)(v29 ^ v30) | v28) )
      return 0;
    if ( (unsigned __int8)((((v23 + 54) & 0x80000000) != 0) ^ __OFADD__(v23, 54)) | (v23 == -54) )
    {
      result = 0;
    }
    else
    {
      v38 = -v23;
      v30 = __OFSUB__(v38, 32);
      v39 = v38 - 32;
      if ( (v39 < 0) ^ v30 )
      {
        v30 = __OFADD__(v39, 12);
        v40 = v39 + 12;
        if ( (unsigned __int8)((v40 < 0) ^ v30) | (v40 == 0) )
        {
          v41 = v40 + 20;
          v42 = result << (32 - v41);
          result = ((result >> v41) | (v25 << (32 - v41))) + (v42 >> 31);
          if ( !(v26 | 2 * v42) )
            result &= ~(v42 >> 31);
        }
        else
        {
          v43 = 12 - v40;
          v44 = result << v43;
          result = ((result >> (32 - v43)) | (v25 << v43)) + (result << v43 >> 31);
          if ( !(v26 | 2 * v44) )
            result &= ~(v44 >> 31);
        }
      }
      else
      {
        v45 = v26 | (result << (32 - v39));
        v46 = (result >> v39) | (v25 << (32 - v39));
        result = ((v25 >> v39) & ~((v25 & 0x80000000) >> v39)) + (v46 >> 31);
        if ( !(v45 | 2 * v46) )
          result &= ~(v46 >> 31);
      }
    }
  }
  return result;
}

//----- (0005BF1C) --------------------------------------------------------
void __fastcall sub_5BF1C(int a1, int a2, int a3, unsigned int a4)
{
  int v4; // r4@0
  int v5; // r12@0
  unsigned int v6; // r5@1
  bool v7; // zf@1
  bool v8; // zf@15

  v6 = v5 & (a4 >> 20);
  v7 = v4 == v5;
  if ( v4 == v5 )
    v7 = v6 == v5;
  if ( v7 )
    JUMPOUT(&loc_5BD7C);
  if ( v4 == v5 )
  {
    if ( a1 | (a2 << 12) )
      JUMPOUT(&loc_5BD7C);
    if ( v6 != v5 )
      JUMPOUT(&loc_5BD64);
    JUMPOUT(&loc_5BD7C);
  }
  if ( v6 == v5 )
  {
    if ( !(a3 | (a4 << 12)) )
      JUMPOUT(&loc_5BD18);
    JUMPOUT(&loc_5BD7C);
  }
  v8 = (a1 | 2 * a2) == 0;
  if ( a1 | 2 * a2 )
    v8 = (a3 | 2 * a4) == 0;
  if ( !v8 )
    JUMPOUT(&loc_5BCB0);
  if ( a1 | 2 * a2 )
    JUMPOUT(&loc_5BD64);
  if ( a3 | 2 * a4 )
    JUMPOUT(&loc_5BD18);
  JUMPOUT(&loc_5BD7C);
}

//----- (0005BF98) --------------------------------------------------------
int __fastcall sub_5BF98(int result, int a2, int a3, unsigned int a4)
{
  bool v4; // zf@1
  int v5; // r2@1
  signed int v6; // r2@8
  unsigned __int8 v7; // vf@8
  signed int v8; // r3@8
  int v9; // r1@9
  int v10; // r0@13
  int v11; // r1@15
  unsigned int v12; // r2@18
  unsigned int v13; // r0@18
  unsigned int v14; // r1@18
  unsigned int v15; // r3@18
  unsigned __int8 v16; // cf@19
  unsigned int v17; // off@22
  int v18; // r0@23
  unsigned int v19; // r12@27
  bool v20; // nf@27
  unsigned __int8 v21; // vf@27
  int v22; // r2@27
  unsigned int v23; // r0@27
  signed int v24; // r3@38
  bool v25; // zf@38
  bool v26; // zf@55
  int v27; // r2@55
  bool v28; // zf@60

  v5 = 2 * result;
  v4 = 2 * result == 0;
  if ( 2 * result )
  {
    a4 = 2 * a2;
    v4 = 2 * a2 == 0;
  }
  if ( !v4 )
  {
    v4 = v5 == a4;
    if ( v5 != a4 )
    {
      v4 = ~(v5 >> 24) == 0;
      if ( ~(v5 >> 24) )
        v4 = ~((signed int)a4 >> 24) == 0;
    }
  }
  if ( v4 )
  {
    v24 = 2 * a2;
    v25 = ~(v5 >> 24) == 0;
    if ( ~(v5 >> 24) )
      v25 = ~(v24 >> 24) == 0;
    if ( v25 )
    {
      v27 = ~(v5 >> 24);
      v26 = v27 == 0;
      if ( v27 )
        result = a2;
      else
        v26 = ~(v24 >> 24) == 0;
      if ( !v26 )
        a2 = result;
      v28 = result << 9 == 0;
      if ( !(result << 9) )
        v28 = a2 << 9 == 0;
      if ( v28 )
        v28 = result == a2;
      if ( !v28 )
        result |= 0x400000u;
    }
    else if ( v5 == v24 )
    {
      if ( result != a2 )
        return 0;
      if ( v5 & 0xFF000000 )
      {
        if ( (unsigned int)v5 < 0xFE000000 )
        {
          result += 0x800000;
          return result;
        }
        v15 = result & 0x80000000;
        return v15 | 0x7F800000;
      }
      v16 = __CFSHL__(result, 1);
      result *= 2;
      if ( v16 )
        result |= 0x80000000;
    }
    else if ( !v5 )
    {
      result = a2;
    }
  }
  else
  {
    v6 = (unsigned int)v5 >> 24;
    v7 = __OFSUB__(a4 >> 24, v6);
    v8 = (a4 >> 24) - v6;
    if ( !((unsigned __int8)((v8 < 0) ^ v7) | (v8 == 0)) )
    {
      v6 += v8;
      v9 = result ^ a2;
      result ^= v9;
      a2 = result ^ v9;
    }
    if ( (v8 < 0) ^ v7 )
      v8 = -v8;
    if ( (unsigned int)v8 <= 0x19 )
    {
      v4 = (result & 0x80000000) == 0;
      v10 = (result | 0x800000) & 0xFFFFFF;
      if ( !v4 )
        v10 = -v10;
      v4 = (a2 & 0x80000000) == 0;
      v11 = (a2 | 0x800000) & 0xFFFFFF;
      if ( !v4 )
        v11 = -v11;
      if ( v6 == v8 )
      {
        v11 ^= 0x800000u;
        if ( v6 )
        {
          LOBYTE(v8) = v8 - 1;
        }
        else
        {
          v10 ^= 0x800000u;
          v6 = 1;
        }
      }
      v12 = v6 - 1;
      v13 = v10 + (v11 >> v8);
      v14 = v11 << (32 - v8);
      v15 = v13 & 0x80000000;
      if ( (v13 & 0x80000000) != 0 )
      {
        v16 = v14 <= 0;
        v14 = -v14;
        v13 = -(v13 + !v16);
      }
      if ( v13 >= 0x800000 )
      {
        if ( v13 >= 0x1000000 && (v13 >>= 1, v17 = __RCR__(v14, 1), v14 = v17, ++v12, v12 >= 0xFE) )
          return v15 | 0x7F800000;
LABEL_23:
        v18 = (v12 << 23) + (v14 >= 0x80000000) + v13;
        if ( v14 == 0x80000000 )
          v18 &= 0xFFFFFFFE;
        return v18 | v15;
      }
      v16 = __CFSHL__(v14, 1);
      v14 *= 2;
      v13 += v16 + v13;
      --v12;
      if ( v13 & 0x800000 )
        goto LABEL_23;
      v19 = __clz(v13) - 8;
      v21 = __OFSUB__(v12, v19);
      v22 = v12 - v19;
      v20 = v22 < 0;
      v23 = v13 << v19;
      if ( (v22 < 0) ^ v21 )
        v22 = -v22;
      else
        v23 += v22 << 23;
      if ( v20 ^ v21 )
        result = v15 | (v23 >> v22);
      else
        result = v23 | v15;
    }
  }
  return result;
}

//----- (0005C130) --------------------------------------------------------
unsigned int __fastcall sub_5C130(unsigned int result)
{
  unsigned int v1; // r3@1
  unsigned int v2; // r1@4
  unsigned int v3; // r2@4
  unsigned __int8 v4; // vf@4
  int v5; // r2@4
  int v6; // r3@4
  char v7; // r2@6

  v1 = result & 0x80000000;
  if ( (result & 0x80000000 & 0x80000000) != 0 )
    result = -result;
  if ( !result )
    return result;
  v2 = result;
  v3 = __clz(result);
  v4 = __OFSUB__(v3, 8);
  v5 = v3 - 8;
  v6 = (v1 | 0x4B000000) - 0x800000 - (v5 << 23);
  if ( (v5 < 0) ^ v4 )
  {
    v7 = v5 + 32;
    result = (result >> (32 - v7)) + __CFSHL__(result << v7, 1) + v6;
    if ( !(2 * (v2 << v7)) )
      result &= ~(v2 << v7 >> 31);
  }
  else
  {
    result = v6 + (result << v5);
  }
  return result;
}

//----- (0005C1DC) --------------------------------------------------------
unsigned int __fastcall sub_5C1DC(unsigned int a1, unsigned int a2, int a3, int a4)
{
  bool v4; // zf@1
  unsigned int v5; // r2@1
  int v6; // r2@7
  unsigned int v7; // r12@7
  bool v8; // zf@7
  unsigned int v9; // r0@7
  unsigned int v10; // r1@10
  unsigned int v11; // r3@10
  unsigned int v12; // kr00_4@10
  bool v13; // cf@10
  unsigned int v14; // r0@12
  int v15; // r2@12
  bool v16; // zf@12
  bool v17; // nf@12
  unsigned __int8 v18; // vf@12
  unsigned int result; // r0@13
  unsigned int v20; // r12@16
  unsigned int v21; // r0@18
  bool v22; // zf@18
  bool v23; // nf@18
  unsigned __int8 v24; // vf@18
  int v25; // r2@18
  int v26; // r2@27
  unsigned int v27; // r12@27
  int v28; // off@27
  unsigned int v29; // r12@44
  bool v30; // zf@31
  bool v31; // zf@33
  unsigned int v32; // r12@33
  bool v33; // zf@38
  bool v34; // zf@41
  bool v35; // zf@46

  v5 = (a1 >> 23) & 0xFF;
  v4 = v5 == 0;
  if ( v5 )
  {
    a4 = (a2 >> 23) & 0xFF;
    v4 = a4 == 0;
  }
  if ( !v4 )
  {
    v4 = v5 == 255;
    if ( v5 != 255 )
      v4 = a4 == 255;
  }
  if ( v4 )
  {
    a4 = (a2 >> 23) & 0xFF;
    v33 = v5 == 255;
    if ( v5 != 255 )
      v33 = a4 == 255;
    if ( v33 )
    {
      v35 = a1 == 0;
      if ( a1 )
        v35 = a1 == 2147483648;
      if ( v35 )
        a1 = a2;
      else
        v35 = a2 == 0;
      if ( !v35 )
        v35 = a2 == 2147483648;
      if ( v35 || v5 == 255 && a1 << 9 )
        return a1 | 0x7FC00000;
      if ( a4 != 255 || !(a2 << 9) )
      {
        v14 = a1 ^ a2;
        return v14 & 0x80000000 | 0x7F800000;
      }
      a1 = a2;
      return a1 | 0x7FC00000;
    }
    v34 = (a1 & 0x7FFFFFFF) == 0;
    if ( a1 & 0x7FFFFFFF )
      v34 = (a2 & 0x7FFFFFFF) == 0;
    if ( v34 )
      return (a1 ^ a2) & 0x80000000;
    v30 = v5 == 0;
    v29 = a1 & 0x80000000;
    while ( v30 )
    {
      a1 *= 2;
      v30 = (a1 & 0x800000) == 0;
      if ( a1 & 0x800000 )
        break;
      --v5;
    }
    a1 |= v29;
    v31 = a4 == 0;
    v32 = a2 & 0x80000000;
    while ( v31 )
    {
      a2 *= 2;
      v31 = (a2 & 0x800000) == 0;
      if ( a2 & 0x800000 )
        break;
      --a4;
    }
    a2 |= v32;
  }
  v6 = v5 + a4;
  v7 = a1 ^ a2;
  v9 = a1 << 9;
  v8 = v9 == 0;
  if ( v9 )
  {
    a2 <<= 9;
    v8 = a2 == 0;
  }
  if ( v8 )
  {
    v20 = v7 & 0x80000000;
    if ( !v9 )
      a2 <<= 9;
    v21 = v20 | (v9 >> 9) | (a2 >> 9);
    v24 = __OFSUB__(v6, 127);
    v25 = v6 - 127;
    v22 = v25 == 0;
    v23 = v25 < 0;
    if ( !((unsigned __int8)((v25 < 0) ^ v24) | (v25 == 0)) )
    {
      v24 = __OFSUB__(255, v25);
      v22 = 255 == v25;
      v23 = 255 - v25 < 0;
    }
    if ( !((unsigned __int8)(v23 ^ v24) | v22) )
      return v21 | (v25 << 23);
    v14 = v21 | 0x800000;
    v11 = 0;
    v18 = __OFSUB__(v25, 1);
    v15 = v25 - 1;
    v16 = v15 == 0;
    v17 = v15 < 0;
  }
  else
  {
    v12 = ((v9 >> 5) | 0x8000000) * ((a2 >> 5) | 0x8000000);
    v10 = ((v9 >> 5) | 0x8000000) * (unsigned __int64)((a2 >> 5) | 0x8000000) >> 32;
    v11 = v12;
    v13 = v10 >= 0x800000;
    if ( v10 < 0x800000 )
    {
      v10 = 2 * v10 | (v12 >> 31);
      v11 = 2 * v12;
    }
    v14 = v7 & 0x80000000 | v10;
    v15 = v6 - (!v13 + 127);
    v18 = __OFSUB__(v15, 253);
    v16 = v15 == 253;
    v17 = v15 - 253 < 0;
    if ( (unsigned int)v15 <= 0xFD )
    {
      result = (v15 << 23) + (v11 >= 0x80000000) + v14;
      if ( v11 == 0x80000000 )
        result &= 0xFFFFFFFE;
      return result;
    }
  }
  if ( !((unsigned __int8)(v17 ^ v18) | v16) )
    return v14 & 0x80000000 | 0x7F800000;
  if ( (unsigned __int8)((v15 + 25 < 0) ^ __OFADD__(v15, 25)) | (v15 == -25) )
  {
    result = v14 & 0x80000000;
  }
  else
  {
    v26 = -v15;
    v27 = v14 << (32 - v26);
    v28 = __RCR__(2 * v14 >> v26, 1);
    result = ((2 * v14 >> v26) & 1) + v28;
    if ( !(v11 | 2 * v27) )
      result &= ~(v27 >> 31);
  }
  return result;
}

//----- (0005C374) --------------------------------------------------------
unsigned int __fastcall sub_5C374(unsigned int a1, unsigned int a2, int a3, int a4)
{
  bool v4; // zf@1
  unsigned int v5; // r2@1
  int v6; // r2@7
  unsigned int v7; // r12@7
  unsigned int v8; // r1@7
  unsigned int v9; // r0@7
  unsigned int v10; // r1@8
  unsigned int v11; // r3@8
  unsigned int v12; // r0@8
  bool v13; // cf@8
  unsigned int v14; // r2@10
  unsigned int v15; // r12@10
  bool v16; // zf@19
  unsigned int result; // r0@25
  unsigned int v18; // r0@28
  bool v19; // zf@28
  bool v20; // nf@28
  unsigned __int8 v21; // vf@28
  int v22; // r2@28
  unsigned int v23; // r12@54
  bool v24; // zf@34
  bool v25; // zf@36
  unsigned int v26; // r12@36
  bool v27; // zf@51

  v5 = (a1 >> 23) & 0xFF;
  v4 = v5 == 0;
  if ( v5 )
  {
    a4 = (a2 >> 23) & 0xFF;
    v4 = a4 == 0;
  }
  if ( !v4 )
  {
    v4 = v5 == 255;
    if ( v5 != 255 )
      v4 = a4 == 255;
  }
  if ( v4 )
  {
    a4 = (a2 >> 23) & 0xFF;
    if ( v5 == 255 )
    {
      if ( a1 << 9 )
        JUMPOUT(&loc_5C368);
      if ( a4 != 255 )
        JUMPOUT(&loc_5C354);
      JUMPOUT(&loc_5C368);
    }
    if ( a4 == 255 )
    {
      if ( !(a2 << 9) )
        JUMPOUT(&loc_5C30C);
      JUMPOUT(&loc_5C368);
    }
    v27 = (a1 & 0x7FFFFFFF) == 0;
    if ( a1 & 0x7FFFFFFF )
      v27 = (a2 & 0x7FFFFFFF) == 0;
    if ( v27 )
    {
      if ( a1 & 0x7FFFFFFF )
        JUMPOUT(&loc_5C354);
      if ( a2 & 0x7FFFFFFF )
        JUMPOUT(&loc_5C30C);
      JUMPOUT(&loc_5C368);
    }
    v24 = v5 == 0;
    v23 = a1 & 0x80000000;
    while ( v24 )
    {
      a1 *= 2;
      v24 = (a1 & 0x800000) == 0;
      if ( a1 & 0x800000 )
        break;
      --v5;
    }
    a1 |= v23;
    v25 = a4 == 0;
    v26 = a2 & 0x80000000;
    while ( v25 )
    {
      a2 *= 2;
      v25 = (a2 & 0x800000) == 0;
      if ( a2 & 0x800000 )
        break;
      --a4;
    }
    a2 |= v26;
  }
  v6 = v5 - a4;
  v7 = a1 ^ a2;
  v8 = a2 << 9;
  v9 = a1 << 9;
  if ( v8 )
  {
    v10 = (v8 >> 4) | 0x10000000;
    v11 = (v9 >> 4) | 0x10000000;
    v12 = v7 & 0x80000000;
    v13 = v11 >= v10;
    if ( v11 < v10 )
      v11 *= 2;
    v14 = v13 + v6 + 125;
    v15 = 0x800000;
    do
    {
      if ( v11 >= v10 )
      {
        v11 -= v10;
        v12 |= v15;
      }
      if ( v11 >= v10 >> 1 )
      {
        v11 -= v10 >> 1;
        v12 |= v15 >> 1;
      }
      if ( v11 >= v10 >> 2 )
      {
        v11 -= v10 >> 2;
        v12 |= v15 >> 2;
      }
      if ( v11 >= v10 >> 3 )
      {
        v11 -= v10 >> 3;
        v12 |= v15 >> 3;
      }
      v11 *= 16;
      v16 = v11 == 0;
      if ( v11 )
      {
        v15 >>= 4;
        v16 = v15 == 0;
      }
    }
    while ( !v16 );
    if ( v14 > 0xFD )
      JUMPOUT(&loc_5C27C);
    result = (v14 << 23) + (v11 >= v10) + v12;
    if ( v11 == v10 )
      result &= 0xFFFFFFFE;
  }
  else
  {
    v18 = v7 & 0x80000000 | (v9 >> 9);
    v21 = __OFADD__(v6, 127);
    v22 = v6 + 127;
    v19 = v22 == 0;
    v20 = v22 < 0;
    if ( !((unsigned __int8)((v22 < 0) ^ v21) | (v22 == 0)) )
    {
      v21 = __OFSUB__(255, v22);
      v19 = 255 == v22;
      v20 = 255 - v22 < 0;
    }
    if ( (unsigned __int8)(v20 ^ v21) | v19 )
      JUMPOUT(&loc_5C27C);
    result = v18 | (v22 << 23);
  }
  return result;
}

//----- (0005C4D4) --------------------------------------------------------
unsigned int __fastcall sub_5C4D4(int a1)
{
  unsigned int v1; // r2@1
  bool v2; // cf@2
  int v3; // r2@2
  bool v4; // zf@4
  unsigned int result; // r0@4

  v1 = 2 * a1;
  if ( (unsigned int)(2 * a1) < 0x7F000000 )
  {
    result = 0;
  }
  else
  {
    v2 = v1 >> 24 <= 0x9E;
    v3 = 158 - (v1 >> 24);
    if ( v3 != 0 && v2 )
    {
      v4 = (a1 & 0x80000000) == 0;
      result = ((a1 << 8) | 0x80000000) >> v3;
      if ( !v4 )
        result = -result;
    }
    else if ( v3 == -97 && a1 << 9 )
    {
      result = 0;
    }
    else
    {
      result = a1 & 0x80000000;
      if ( !result )
        result = 0x7FFFFFFF;
    }
  }
  return result;
}

//----- (0005C530) --------------------------------------------------------
int __fastcall sub_5C530(__int64 a1, __int64 a2)
{
  int v2; // lr@0
  int v4; // [sp+4h] [bp-8h]@2
  int v5; // [sp+8h] [bp-4h]@5

  if ( a2 )
    return sub_5C5B8(a1, a2, &v4);
  if ( a1 )
    HIDWORD(a1) = -1;
  v4 = HIDWORD(a1);
  v5 = v2;
  raise(8);
  JUMPOUT(__CS__, v5);
  return sub_5C5B8(a1, a2, &v4);
}

//----- (0005C5B8) --------------------------------------------------------
int __fastcall sub_5C5B8(__int64 a1, __int64 a2, _QWORD *a3)
{
  __int64 v3; // r6@1
  __int64 v4; // r4@1
  __int64 v5; // r0@1

  v3 = a2;
  v4 = a1;
  LODWORD(v5) = sub_5CA58(a1, HIDWORD(a1), a2, HIDWORD(a2));
  *a3 = v4 - v3 * v5;
  return v5;
}

//----- (0005C5F4) --------------------------------------------------------
unsigned __int64 __fastcall sub_5C5F4(unsigned int a1, signed int a2, unsigned int a3, signed int a4)
{
  unsigned int v4; // r8@1
  unsigned int v5; // r4@1
  unsigned int v6; // r7@1
  unsigned int v7; // r12@1
  signed int v8; // r1@2
  unsigned int v9; // r9@6
  unsigned int v10; // r11@6
  unsigned int v11; // r5@6
  unsigned int v12; // r3@8
  int v13; // r1@12
  int v14; // r7@12
  unsigned int v15; // r0@12
  unsigned int v16; // r5@12
  int v17; // r4@12
  unsigned int v18; // r7@12
  unsigned int v19; // r5@16
  int v20; // r1@16
  unsigned int v21; // r10@16
  unsigned int v22; // r0@16
  unsigned int v23; // r8@16
  unsigned int v24; // r10@17
  unsigned int v25; // r7@20
  unsigned int v26; // r3@23
  unsigned int v27; // r8@24
  int v28; // r6@24
  unsigned int v29; // r6@25
  unsigned int v30; // r10@25
  int v31; // r1@25
  int v32; // r4@25
  unsigned int v33; // r0@25
  unsigned int v34; // r3@25
  int v35; // r7@25
  unsigned int v36; // r4@25
  unsigned int v37; // r4@29
  int v38; // r1@29
  unsigned int v39; // r10@29
  unsigned int v40; // r0@29
  unsigned int v41; // r8@29
  int v42; // r1@34
  int v43; // r10@34
  unsigned int v44; // r0@34
  unsigned int v45; // r8@34
  int v46; // r4@34
  unsigned int v47; // r10@34
  unsigned int v48; // r8@38
  int v49; // r1@38
  unsigned int v50; // r10@38
  unsigned int v51; // r0@38
  unsigned int v52; // r5@38
  unsigned int v53; // r10@39
  unsigned __int8 v54; // cf@46
  unsigned int v55; // r5@51
  unsigned int v56; // r7@51
  int v57; // r1@51
  unsigned int v58; // r0@51
  unsigned int v59; // r3@51
  int v60; // r7@51
  signed __int64 v61; // r10@51
  int v62; // r1@55
  unsigned int v63; // r0@55
  unsigned int v64; // r9@55
  unsigned int v65; // r3@55
  int v66; // r3@59
  int v67; // r5@59
  int v68; // r12@59
  int v69; // r2@59
  int v70; // r12@59
  int v71; // r5@59
  int v72; // r1@59
  unsigned int v73; // r5@59
  bool v74; // r3@62
  unsigned __int64 v75; // r2@69
  int v77; // [sp+4h] [bp-34h]@55
  unsigned int v78; // [sp+8h] [bp-30h]@51
  int v79; // [sp+Ch] [bp-2Ch]@4

  v4 = a2;
  v5 = a1;
  v6 = a3;
  v7 = a4;
  if ( a2 < 0 )
  {
    v4 = -(a2 + (a1 > 0));
    v5 = -a1;
    v8 = -1;
  }
  else
  {
    v8 = 0;
  }
  v79 = v8;
  if ( a4 < 0 )
  {
    v54 = a3 <= 0;
    a3 = -a3;
    v6 = a3;
    v7 = -(a4 + !v54);
    v79 = ~v8;
  }
  v9 = v6;
  v10 = v5;
  v11 = v4;
  if ( !v7 )
  {
    if ( v6 > v4 )
    {
      v12 = __clz(v6);
      if ( v12 )
      {
        v9 = v6 << v12;
        a3 = v5 >> (32 - v12);
        v10 = v5 << v12;
      }
      if ( v12 )
        v11 = a3 | (v4 << v12);
      sub_5B648(v11, v9 >> 16);
      v14 = v13;
      v15 = sub_5B5A0(v11, v9 >> 16);
      v16 = (unsigned __int16)v9 * v15;
      v17 = v15;
      v18 = (v10 >> 16) | (v14 << 16);
      if ( v18 < v16 )
      {
        v54 = __CFADD__(v18, v9);
        v18 += v9;
        v17 = v15 - 1;
        if ( !v54 && v18 < v16 )
        {
          v17 = v15 - 2;
          v18 += v9;
        }
      }
      v19 = v18 - v16;
      sub_5B648(v19, v9 >> 16);
      v21 = (unsigned __int16)v10 | (v20 << 16);
      v22 = sub_5B5A0(v19, v9 >> 16);
      v23 = (unsigned __int16)v9 * v22;
      if ( v21 < v23 )
      {
        v54 = __CFADD__(v21, v9);
        v24 = v21 + v9;
        --v22;
        if ( !v54 && v24 < v23 )
          --v22;
      }
      v25 = v22 | (v17 << 16);
      goto LABEL_67;
    }
    if ( !v6 )
      v9 = sub_5B5A0(1u, 0);
    v26 = __clz(v9);
    if ( v26 )
    {
      v9 <<= v26;
      v29 = v4 >> (32 - v26);
      v10 = v5 << v26;
      v30 = (v5 >> (32 - v26)) | (v4 << v26);
      sub_5B648(v29, v9 >> 16);
      v32 = v31;
      v33 = sub_5B5A0(v29, v9 >> 16);
      v34 = (unsigned __int16)v9 * v33;
      v35 = v33;
      v36 = (v30 >> 16) | (v32 << 16);
      if ( v36 < v34 )
      {
        v54 = __CFADD__(v36, v9);
        v36 += v9;
        v35 = v33 - 1;
        if ( !v54 && v36 < v34 )
        {
          v35 = v33 - 2;
          v36 += v9;
        }
      }
      v37 = v36 - v34;
      sub_5B648(v37, v9 >> 16);
      v39 = (unsigned __int16)v30 | (v38 << 16);
      v40 = sub_5B5A0(v37, v9 >> 16);
      v41 = (unsigned __int16)v9 * v40;
      if ( v39 < v41 )
      {
        v54 = __CFADD__(v39, v9);
        v39 += v9;
        --v40;
        if ( !v54 && v39 < v41 )
        {
          --v40;
          v39 += v9;
        }
      }
      v28 = v40 | (v35 << 16);
      v27 = v39 - v41;
    }
    else
    {
      v27 = v4 - v9;
      v28 = 1;
    }
    sub_5B648(v27, v9 >> 16);
    v43 = v42;
    v44 = sub_5B5A0(v27, v9 >> 16);
    v45 = (unsigned __int16)v9 * v44;
    v46 = v44;
    v47 = (v10 >> 16) | (v43 << 16);
    if ( v47 < v45 )
    {
      v54 = __CFADD__(v47, v9);
      v47 += v9;
      v46 = v44 - 1;
      if ( !v54 && v47 < v45 )
      {
        v46 = v44 - 2;
        v47 += v9;
      }
    }
    v48 = v47 - v45;
    sub_5B648(v48, v9 >> 16);
    v50 = (unsigned __int16)v10 | (v49 << 16);
    v51 = sub_5B5A0(v48, v9 >> 16);
    v52 = (unsigned __int16)v9 * v51;
    if ( v50 < v52 )
    {
      v54 = __CFADD__(v50, v9);
      v53 = v50 + v9;
      --v51;
      if ( !v54 && v53 < v52 )
        --v51;
    }
    v25 = v51 | (v46 << 16);
    goto LABEL_69;
  }
  if ( v7 > v4 )
  {
    v28 = 0;
LABEL_68:
    v25 = 0;
    goto LABEL_69;
  }
  v28 = __clz(v7);
  if ( !v28 )
  {
    v54 = v4 >= v7;
    if ( v4 <= v7 )
      v54 = v5 >= v6;
    if ( v54 )
    {
      v25 = 1;
      goto LABEL_69;
    }
    v28 = 0;
    goto LABEL_68;
  }
  v55 = (v6 >> (32 - v28)) | (v7 << v28);
  v78 = v6 << v28;
  v56 = v4 >> (32 - v28);
  LODWORD(v61) = (v5 >> (32 - v28)) | (v4 << v28);
  sub_5B648(v56, v55 >> 16);
  HIDWORD(v61) = v57;
  v58 = sub_5B5A0(v56, v55 >> 16);
  v59 = (unsigned __int16)v55 * v58;
  v60 = v58;
  HIDWORD(v61) = v61 >> 16;
  if ( HIDWORD(v61) < v59 )
  {
    v54 = __CFADD__(HIDWORD(v61), v55);
    HIDWORD(v61) += v55;
    v60 = v58 - 1;
    if ( !v54 && HIDWORD(v61) < v59 )
    {
      v60 = v58 - 2;
      HIDWORD(v61) += v55;
    }
  }
  HIDWORD(v61) -= v59;
  sub_5B648(HIDWORD(v61), v55 >> 16);
  v77 = v62;
  v63 = sub_5B5A0(HIDWORD(v61), v55 >> 16);
  v64 = (unsigned __int16)v55 * v63;
  v65 = (unsigned __int16)v61 | (v77 << 16);
  if ( v65 < v64 )
  {
    v65 = ((unsigned __int16)v61 | (v77 << 16)) + v55;
    --v63;
    if ( !__CFADD__((unsigned __int16)v61 | (v77 << 16), v55) && v65 < v64 )
    {
      --v63;
      v65 += v55;
    }
  }
  v66 = v65 - v64;
  v25 = v63 | (v60 << 16);
  v67 = v25 & ~(v25 >> 16 << 16);
  v68 = v78 & ~(v78 >> 16 << 16);
  v69 = v67 * v68;
  v70 = (v25 >> 16) * v68;
  v71 = (v78 >> 16) * v67;
  v72 = (v25 >> 16) * (v78 >> 16);
  v54 = __CFADD__(v70, v71);
  v73 = v70 + v71;
  if ( v54 )
    v72 += 0x10000;
  if ( (__PAIR__(v72, v69) + __PAIR__(v73 >> 16, v73 << 16)) >> 32 > (unsigned int)v66
    || ((v74 = (__PAIR__(v72, v69) + __PAIR__(v73 >> 16, v73 << 16)) >> 32 == v66, v69 + (v73 << 16) > v5 << v28) ? (v28 = v74) : (v28 = 0),
        v28) )
  {
    --v25;
LABEL_67:
    v28 = 0;
  }
LABEL_69:
  v75 = __PAIR__(v28, v25);
  if ( !v79 )
    return v75;
  LODWORD(v75) = -v25;
  HIDWORD(v75) = -(v28 + (v25 > 0));
  return v75;
}

//----- (0005CA58) --------------------------------------------------------
signed int __fastcall sub_5CA58(unsigned int a1, unsigned int a2, unsigned int a3, unsigned int a4)
{
  unsigned int v4; // r5@1
  unsigned int v5; // r4@1
  unsigned int v6; // r8@1
  signed __int64 v7; // r10@1
  unsigned int v8; // r9@1
  unsigned int v9; // r3@3
  int v10; // r1@7
  unsigned int v11; // r0@7
  unsigned int v12; // r7@7
  int v13; // r4@7
  unsigned int v14; // r7@11
  int v15; // r1@11
  unsigned int v16; // r11@11
  unsigned int v17; // r0@11
  unsigned int v18; // r6@11
  unsigned int v19; // r11@12
  unsigned int v20; // r4@15
  unsigned int v21; // r3@18
  unsigned int v22; // r4@19
  unsigned int v23; // r7@20
  unsigned int v24; // r9@20
  int v25; // r1@20
  int v26; // r4@20
  unsigned int v27; // r7@20
  unsigned int v28; // r4@20
  unsigned int v29; // r7@24
  int v30; // r1@24
  unsigned int v31; // r4@24
  unsigned int v32; // r11@24
  int v33; // r1@29
  unsigned int v34; // r0@29
  unsigned int v35; // r9@29
  int v36; // r4@29
  unsigned int v37; // r9@33
  int v38; // r1@33
  unsigned int v39; // r11@33
  unsigned int v40; // r0@33
  unsigned int v41; // r6@33
  unsigned int v42; // r11@34
  unsigned int v43; // r7@39
  unsigned __int8 v44; // cf@40
  unsigned int v45; // r9@45
  unsigned int v46; // r6@45
  unsigned int v47; // r4@45
  int v48; // r1@45
  int v49; // r11@45
  unsigned int v50; // r0@45
  unsigned int v51; // r3@45
  int v52; // r9@45
  unsigned int v53; // r11@45
  unsigned int v54; // r11@49
  int v55; // r1@49
  unsigned int v56; // r0@49
  unsigned int v57; // r10@49
  unsigned int v58; // r3@49
  int v59; // r3@53
  int v60; // r12@53
  int v61; // r6@53
  int v62; // r2@53
  int v63; // r6@53
  int v64; // r12@53
  int v65; // r1@53
  unsigned int v66; // r12@53
  bool v67; // r3@56
  int v68; // r7@57
  int v70; // [sp+0h] [bp-30h]@49
  unsigned int v71; // [sp+4h] [bp-2Ch]@45

  v4 = a1;
  v5 = a2;
  v6 = a3;
  LODWORD(v7) = a1;
  v8 = a2;
  if ( !a4 )
  {
    if ( a3 <= a2 )
    {
      if ( !a3 )
        v6 = sub_5B5A0(1u, 0);
      v21 = __clz(v6);
      if ( v21 )
      {
        v6 <<= v21;
        v23 = v5 >> (32 - v21);
        v24 = (v4 >> (32 - v21)) | (v5 << v21);
        LODWORD(v7) = v4 << v21;
        sub_5B648(v5 >> (32 - v21), v6 >> 16);
        v26 = v25;
        v27 = (unsigned __int16)v6 * sub_5B5A0(v23, v6 >> 16);
        v28 = (v24 >> 16) | (v26 << 16);
        if ( v28 < v27 )
        {
          v44 = __CFADD__(v28, v6);
          v28 += v6;
          if ( !v44 && v28 < v27 )
            v28 += v6;
        }
        v29 = v28 - v27;
        sub_5B648(v29, v6 >> 16);
        v31 = (unsigned __int16)v24 | (v30 << 16);
        v32 = (unsigned __int16)v6 * sub_5B5A0(v29, v6 >> 16);
        if ( v31 < v32 )
        {
          v44 = __CFADD__(v31, v6);
          v31 += v6;
          if ( !v44 && v31 < v32 )
            v31 += v6;
        }
        v22 = v31 - v32;
      }
      else
      {
        v22 = v5 - v6;
      }
      sub_5B648(v22, v6 >> 16);
      HIDWORD(v7) = v33;
      v34 = sub_5B5A0(v22, v6 >> 16);
      v35 = (unsigned __int16)v6 * v34;
      v36 = v34;
      HIDWORD(v7) = v7 >> 16;
      if ( HIDWORD(v7) < v35 )
      {
        v44 = __CFADD__(HIDWORD(v7), v6);
        HIDWORD(v7) += v6;
        v36 = v34 - 1;
        if ( !v44 && HIDWORD(v7) < v35 )
        {
          v36 = v34 - 2;
          HIDWORD(v7) += v6;
        }
      }
      v37 = HIDWORD(v7) - v35;
      sub_5B648(v37, v6 >> 16);
      v39 = (unsigned __int16)v7 | (v38 << 16);
      v40 = sub_5B5A0(v37, v6 >> 16);
      v41 = (unsigned __int16)v6 * v40;
      if ( v39 < v41 )
      {
        v44 = __CFADD__(v39, v6);
        v42 = v39 + v6;
        --v40;
        if ( !v44 && v42 < v41 )
          --v40;
      }
      v20 = v40 | (v36 << 16);
    }
    else
    {
      v9 = __clz(a3);
      if ( v9 )
      {
        v6 = a3 << v9;
        a3 = a1 >> (32 - v9);
        LODWORD(v7) = a1 << v9;
      }
      if ( v9 )
        v8 = a3 | (a2 << v9);
      sub_5B648(v8, v6 >> 16);
      HIDWORD(v7) = v10;
      v11 = sub_5B5A0(v8, v6 >> 16);
      v12 = (unsigned __int16)v6 * v11;
      v13 = v11;
      HIDWORD(v7) = v7 >> 16;
      if ( HIDWORD(v7) < v12 )
      {
        v44 = __CFADD__(HIDWORD(v7), v6);
        HIDWORD(v7) += v6;
        v13 = v11 - 1;
        if ( !v44 && HIDWORD(v7) < v12 )
        {
          v13 = v11 - 2;
          HIDWORD(v7) += v6;
        }
      }
      v14 = HIDWORD(v7) - v12;
      sub_5B648(v14, v6 >> 16);
      v16 = (unsigned __int16)v7 | (v15 << 16);
      v17 = sub_5B5A0(v14, v6 >> 16);
      v18 = (unsigned __int16)v6 * v17;
      if ( v16 < v18 )
      {
        v44 = __CFADD__(v16, v6);
        v19 = v16 + v6;
        --v17;
        if ( !v44 && v19 < v18 )
          --v17;
      }
      v20 = v17 | (v13 << 16);
    }
    return v20;
  }
  if ( a4 > a2 )
    return 0;
  v43 = __clz(a4);
  if ( !v43 )
  {
    v44 = a2 >= a4;
    if ( a2 <= a4 )
      v44 = a1 >= a3;
    if ( v44 )
      return 1;
    return 0;
  }
  v45 = a2 >> (32 - v43);
  v46 = (a3 >> (32 - v43)) | (a4 << v43);
  v47 = (a1 >> (32 - v43)) | (a2 << v43);
  v71 = a3 << v43;
  sub_5B648(a2 >> (32 - v43), v46 >> 16);
  v49 = v48;
  v50 = sub_5B5A0(v45, v46 >> 16);
  v51 = (unsigned __int16)v46 * v50;
  v52 = v50;
  v53 = (v47 >> 16) | (v49 << 16);
  if ( v53 < v51 )
  {
    v44 = __CFADD__(v53, v46);
    v53 += v46;
    v52 = v50 - 1;
    if ( !v44 && v53 < v51 )
    {
      v52 = v50 - 2;
      v53 += v46;
    }
  }
  v54 = v53 - v51;
  sub_5B648(v54, v46 >> 16);
  v70 = v55;
  v56 = sub_5B5A0(v54, v46 >> 16);
  v57 = (unsigned __int16)v46 * v56;
  v58 = (unsigned __int16)v47 | (v70 << 16);
  if ( v58 < v57 )
  {
    v58 = ((unsigned __int16)v47 | (v70 << 16)) + v46;
    --v56;
    if ( !__CFADD__((unsigned __int16)v47 | (v70 << 16), v46) && v58 < v57 )
    {
      --v56;
      v58 += v46;
    }
  }
  v59 = v58 - v57;
  v20 = v56 | (v52 << 16);
  v60 = v20 & ~(v20 >> 16 << 16);
  v61 = v71 & ~(v71 >> 16 << 16);
  v62 = v60 * v61;
  v63 = (v20 >> 16) * v61;
  v64 = (v71 >> 16) * v60;
  v65 = (v20 >> 16) * (v71 >> 16);
  v44 = __CFADD__(v63, v64);
  v66 = v63 + v64;
  if ( v44 )
    v65 += 0x10000;
  if ( (__PAIR__(v65, v62) + __PAIR__(v66 >> 16, v66 << 16)) >> 32 > (unsigned int)v59
    || ((v67 = (__PAIR__(v65, v62) + __PAIR__(v66 >> 16, v66 << 16)) >> 32 == v59, v62 + (v66 << 16) > v4 << v43) ? (v68 = v67) : (v68 = 0),
        v68) )
  {
    v20 = (v56 | (v52 << 16)) - 1;
  }
  return v20;
}

//----- (0005CE54) --------------------------------------------------------
void term_proc()
{
  ;
}

#error "There were 1 decompilation failure(s) on 510 function(s)"
