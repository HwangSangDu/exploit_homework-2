/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2014 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int init_proc();
// int __fastcall insert_nf_to_rule(_DWORD, _DWORD); weak
// int __fastcall get_fakedns(_DWORD); weak
// int __fastcall read_rt_db(_DWORD); weak
// int __fastcall fw_add_db(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall get_hw_value(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_link_status(_DWORD, _DWORD); weak
// int __fastcall syslog_save(_DWORD); weak
// int __fastcall delete_rt_entry_list(_DWORD, _DWORD, _DWORD); weak
// int __fastcall dhcpd_start(_DWORD); weak
// void qsort(void *base, size_t nmemb, size_t size, __compar_fn_t compar);
// int __fastcall pptpserver_set_config(_DWORD, _DWORD); weak
// int __fastcall syslog_get_status(_DWORD); weak
// int __fastcall dmztwinip_write_config(_DWORD, _DWORD); weak
// int __fastcall get_si(_DWORD, _DWORD); weak
// int __fastcall set_smtp_password(_DWORD); weak
// int __fastcall get_remote_addr(_DWORD); weak
// int __fastcall set_dhclient_block_private_ip(_DWORD, _DWORD); weak
// int __fastcall dhcpd_set_dns(_DWORD, _DWORD); weak
// int get_pppoe_relay_enabled();
// int __fastcall istatus_set_intvalue_direct(_DWORD, _DWORD); weak
// int __fastcall set_nologin(_DWORD); weak
// int __fastcall set_autodns(_DWORD); weak
// int __fastcall print_http_header(_DWORD); weak
// int __fastcall get_wansetup_status(_DWORD); weak
// int __fastcall set_client_login_trial_count_without_captchar(_DWORD); weak
// int __fastcall netdetect_set_portrange_and_monitorlevel(_DWORD, _DWORD); weak
// int __fastcall tc_count_file_read(_DWORD); weak
// int __fastcall set_csrf_op(_DWORD); weak
// int __fastcall syslog_get_email_status(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_intvalue_post(_DWORD, _DWORD, _DWORD); weak
// int __fastcall dmztwinip_apply_dmz(_DWORD, _DWORD, _DWORD); weak
// int __fastcall make_virtual_host_page(_DWORD); weak
// int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_plantynet_freedevice_num(_DWORD); weak
// int __fastcall iconfig_set_value_direct(_DWORD, _DWORD); weak
// int __fastcall set_dhcp_access_policy(_DWORD); weak
// int __fastcall get_iptv_config(_DWORD); weak
// int __fastcall get_wbm_popup_flag(_DWORD); weak
// int __fastcall get_ipmac_bind(_DWORD); weak
// int __fastcall vlan_remove_config(_DWORD, _DWORD); weak
// int __fastcall get_wan_ifname(_DWORD, _DWORD); weak
// char *inet_ntoa(struct in_addr in);
// int __fastcall get_ip_by_hwaddr(_DWORD, _DWORD); weak
// int __fastcall get_plantynet_status(_DWORD); weak
// int __fastcall get_system_running_time(_DWORD); weak
// int __fastcall get_wan_type(_DWORD, _DWORD); weak
// int __fastcall set_csrf_whites(_DWORD); weak
// int __fastcall get_hwaddr_cloned(_DWORD, _DWORD); weak
// int __fastcall quote_r(_DWORD, _DWORD); weak
// int __fastcall clear_hostscan_log(_DWORD); weak
// int __fastcall ddnsapi_get_refresh_flag(_DWORD); weak
// int __fastcall iconfig_get_intvalue_direct(_DWORD); weak
// int __fastcall tc_mode_get(_DWORD); weak
// int __fastcall get_ip_value(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_hwaddr_by_ip(_DWORD, _DWORD); weak
// int __fastcall get_http_auth_method(_DWORD); weak
// int _gmon_start__(void); weak
// int __fastcall get_hostinfo_from_bridge(_DWORD, _DWORD, _DWORD); weak
// int __fastcall init_fw_rule(_DWORD); weak
// int __fastcall dmztwinip_read_config(_DWORD, _DWORD); weak
// int __fastcall get_hostinfo_from_arp(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_hwaddr_kernel(_DWORD, _DWORD); weak
// int __fastcall delete_fw_rule(_DWORD, _DWORD); weak
// int __fastcall signal_save(_DWORD); weak
// int __fastcall get_hwaddr_org(_DWORD, _DWORD); weak
// int __fastcall get_plantynet_service(_DWORD); weak
// int __fastcall accesslist_get_ip(_DWORD, _DWORD, _DWORD, _DWORD); weak
// in_addr_t inet_addr(const char *cp);
// int __fastcall get_url_redirect_option(_DWORD); weak
// int __fastcall get_timeserver_conf(_DWORD); weak
// char *strncpy(char *dest, const char *src, size_t n);
// int fclose(FILE *stream);
// int __fastcall set_dns_shadow(_DWORD, _DWORD, _DWORD, _DWORD); weak
// char *fgets(char *s, int n, FILE *stream);
// int __fastcall set_iptv_config(_DWORD, _DWORD); weak
// char *getenv(const char *name);
// int __fastcall get_url_redirect_usermsg(_DWORD); weak
// int __fastcall netdetect_set_on_off(_DWORD); weak
// int system(const char *command);
// char *strchr(const char *s, int c);
// int __fastcall stp_get_bridge_priority(_DWORD, _DWORD); weak
// int putchar(int c);
// int strcasecmp(const char *s1, const char *s2);
// int dhcpd_get_all_dynamic_lease(void); weak
// int __fastcall ddnsapi_remove_host(_DWORD); weak
// int __fastcall accesslist_iptables_cmd(_DWORD); weak
// int __fastcall read_dos_config(_DWORD); weak
// int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD); weak
// int __fastcall get_eport_stat(_DWORD, _DWORD); weak
// int __fastcall set_upnp(_DWORD); weak
// int __fastcall stp_get_operation(_DWORD, _DWORD); weak
// int __fastcall set_http_auth_method(_DWORD); weak
// int __fastcall hwinfo_get_reboot_duration(_DWORD); weak
// int __fastcall malloc_syslog_msg_structure(_DWORD, _DWORD, _DWORD); weak
// int __fastcall wizard_api_set_mode(_DWORD); weak
// int __fastcall free_fw_list(_DWORD); weak
// int __fastcall tc_mode_set(_DWORD); weak
// int netdetect_get_virus_drop(void); weak
// int __fastcall br_get_state_name(_DWORD); weak
// FILE *fopen(const char *filename, const char *modes);
// int __fastcall set_mirrored_port(_DWORD, _DWORD); weak
// int __fastcall istatus_get_value_direct(_DWORD, _DWORD); weak
// int __fastcall decode_string(_DWORD); weak
// int __fastcall save_password(_DWORD, _DWORD); weak
// int __fastcall stp_get_bridge_max_message_age(_DWORD, _DWORD); weak
// int __fastcall set_hwaddr_cloned(_DWORD, _DWORD); weak
// void *memset(void *s, int c, size_t n);
// int __fastcall get_firmware_version2(_DWORD); weak
// int __fastcall syslog_convert_syslog_message(_DWORD, _DWORD); weak
// int __fastcall class_make_couple(_DWORD, _DWORD); weak
// int __fastcall set_plantynet_service(_DWORD); weak
// int get_remote_mgmt_port(void); weak
// int httpcon_check_session_url(void); weak
// int get_captcha(void); weak
// int __fastcall is_valid_pf_ipv4(_DWORD); weak
// int set_autosaving(void); weak
// int __fastcall trunk_add_config(_DWORD, _DWORD); weak
// int __fastcall fw_read_status(_DWORD, _DWORD); weak
// char *strrchr(const char *s, int c);
// int __fastcall read_sched_array(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_dhcp_auto_detect_status(_DWORD); weak
// int snprintf2(_DWORD, _DWORD, const char *, ...); weak
// int __fastcall clear_url_redirection(_DWORD); weak
// int __fastcall genconfig_read_file(_DWORD, _DWORD); weak
// int __fastcall set_port_config(_DWORD, _DWORD); weak
// int __fastcall set_dhcp_auto_detect(_DWORD); weak
// int __fastcall get_default_gateway(_DWORD, _DWORD); weak
// int __fastcall set_url_redirect_cycle(_DWORD); weak
// int __fastcall stop_hostscan(_DWORD); weak
// int __fastcall set_autoreboot_config(_DWORD); weak
// int __fastcall sysconf_nat_set(_DWORD, _DWORD); weak
// int __fastcall netdetect_set_burst_drop(_DWORD, _DWORD); weak
// int __fastcall set_url_redirect_autoconfirm(_DWORD); weak
// int __fastcall set_admin_email(_DWORD); weak
// int __fastcall get_smtp_auth(_DWORD); weak
// int __fastcall istatus_get_index_info_direct(_DWORD, _DWORD, _DWORD); weak
// int __fastcall print_popup_button(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall get_file_string(_DWORD, _DWORD, _DWORD); weak
// int __fastcall vlan_apply_system(_DWORD); weak
// int __fastcall pppoe_stop(_DWORD); weak
// int __fastcall get_firmup_status(_DWORD); weak
// int __fastcall dhcpd_remove_static_lease(_DWORD, _DWORD); weak
// int __fastcall get_csrf_whites(_DWORD); weak
// int __fastcall convert_mac(_DWORD); weak
// int __fastcall signal_start(_DWORD); weak
// int __fastcall netdetect_write_option(_DWORD, _DWORD); weak
// int __fastcall portforward_update_by_file(_DWORD, _DWORD); weak
// int __fastcall set_smtp_account(_DWORD); weak
// int sysget_config_size(void); weak
// int __fastcall delete_pf_rule(_DWORD, _DWORD); weak
// int __fastcall firewall_update_by_file(_DWORD, _DWORD, _DWORD); weak
// int __fastcall stp_set_bridge_forward_delay(_DWORD, _DWORD); weak
// int __fastcall get_value_array(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int hwinfo_get_max_firmware_size(void); weak
// int __fastcall accesslist_already_regist(_DWORD, _DWORD); weak
// int init_pf_netfilter(void); weak
// int __fastcall get_idle_timeout(_DWORD); weak
// int __fastcall get_smtp_password(_DWORD); weak
// int __fastcall get_netaddr(_DWORD, _DWORD); weak
// int __fastcall hwinfo_get_mtu(_DWORD); weak
// void free(void *ptr);
// int __fastcall set_firmupcheck_status(_DWORD); weak
// int __fastcall get_file_value(_DWORD, _DWORD); weak
// int __fastcall dhcpd_get_op(_DWORD); weak
// int __fastcall set_arp_protection(_DWORD, _DWORD, _DWORD); weak
// int __fastcall print_item(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall portforward_add_rule(_DWORD, _DWORD, _DWORD); weak
// int __cdecl add_rt_entry(_DWORD); weak
// int __fastcall init_url_redirection(_DWORD); weak
// int __fastcall dhclient_stop(_DWORD); weak
// int __fastcall ddnsapi_read_config(_DWORD, _DWORD); weak
// int __fastcall check_valid_account(_DWORD); weak
// int __fastcall set_wbm_popup_flag(_DWORD); weak
// int __fastcall conv_time(_DWORD, _DWORD, _DWORD); weak
// int __fastcall convert_mac2(_DWORD); weak
// int __fastcall stp_get_bridge_forward_delay(_DWORD, _DWORD); weak
// int __fastcall dhcpd_set_op(_DWORD); weak
// int __fastcall get_nologin(_DWORD); weak
// int init_pf_rule(void); weak
// int __fastcall add_remotepc_config(_DWORD); weak
// int __fastcall dhcpd_flush_dynamic_lease(_DWORD); weak
// int __fastcall get_system_lang(_DWORD); weak
// int __fastcall str(_DWORD); weak
// int __fastcall stp_set_bridge_hello_time(_DWORD, _DWORD); weak
// int __fastcall syslog_set_status(_DWORD); weak
// int __fastcall get_wan_link(_DWORD); weak
// int __fastcall httpcon_set_session_timeout(_DWORD); weak
// int __fastcall netdetect_set_option_rule(_DWORD, _DWORD); weak
// int __fastcall print_html_apply_wait(_DWORD, _DWORD, _DWORD); weak
// int __fastcall validate_mac_addr(_DWORD); weak
// int fflush(FILE *stream);
// int __fastcall check_invalid_hwaddr(_DWORD); weak
// int smart_qos_mode_set(void); weak
// int __fastcall ddnsapi_add_config(_DWORD); weak
// int inet_aton(const char *cp, struct in_addr *inp);
// int __fastcall get_dhcp_access_policy(_DWORD); weak
// int syslog_clear(void); weak
// int __fastcall free_fw_status_list(_DWORD, _DWORD); weak
// int __fastcall syslog_decode_text(_DWORD, _DWORD); weak
// int __fastcall set_default_gateway2(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall set_pppoe_relay_enabled(_DWORD); weak
// int __fastcall get_autosaving(_DWORD); weak
// int syslog_get_count(void); weak
// int __fastcall trunk_check_tname_available(_DWORD); weak
// int __fastcall istatus_get_intvalue_direct(_DWORD); weak
// int __fastcall get_wan_hw_ifname(_DWORD, _DWORD); weak
// int __fastcall get_wan_ipinfo(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall saveconf(_DWORD); weak
// int __fastcall check_unpermitted_chars(_DWORD); weak
// int __fastcall get_value_post_multipart_file(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall plantynet_service_event(_DWORD, _DWORD); weak
// int __fastcall max_bandwidth_set(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall smart_qos_mode_get(_DWORD); weak
// size_t strlen(const char *s);
// int __fastcall trunk_remove_config(_DWORD, _DWORD); weak
// int sscanf(const char *s, const char *format, ...);
// int __fastcall get_filesize(_DWORD); weak
// int __fastcall get_dhcp_auto_detect(_DWORD); weak
// int __fastcall validate_ipv4_addr(_DWORD); weak
// int get_captcha_usage_type(void); weak
// int unlink(const char *name);
// int __fastcall get_manual_dns_flag(_DWORD, _DWORD); weak
// int __fastcall iconfig_get_value_direct(_DWORD, _DWORD); weak
// int __fastcall pptpserver_get_index_pptpinfo(_DWORD, _DWORD); weak
// int __fastcall get_pppoe_ifname(_DWORD, _DWORD); weak
// int __fastcall pptpserver_get_config(_DWORD, _DWORD); weak
// int __fastcall signal_wan(_DWORD); weak
// void *memcpy(void *dest, const void *src, size_t n);
// int __fastcall set_wan_type(_DWORD, _DWORD); weak
// int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall netdetect_get_on_off(_DWORD); weak
// int __fastcall hwinfo_get_firmup_duration(_DWORD); weak
// int __fastcall get_value_post_multipart(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall free_syslog_msg_structure(_DWORD, _DWORD); weak
// int post_process(void); weak
// int __fastcall write_snmp_conf(_DWORD); weak
// int __fastcall convert_url_to_new(_DWORD, _DWORD); weak
// int __fastcall get_apcplan_flag(_DWORD); weak
// int __fastcall get_arp_protection(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_autoreboot_config(_DWORD); weak
// int __fastcall print_start_main_table(_DWORD); weak
// int __fastcall stp_set_bridge_priority(_DWORD, _DWORD); weak
// int __fastcall set_mtu_value(_DWORD, _DWORD); weak
// int feof(FILE *stream);
// int __fastcall set_smtp_server(_DWORD); weak
// int __fastcall class_create(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall get_mirroring_op(_DWORD); weak
// int __fastcall set_upnp_relay(_DWORD); weak
// int read_real_ipclone_leasetime(void); weak
// int __fastcall set_timeserver_conf(_DWORD); weak
// int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD); weak
// int __fastcall etr(_DWORD); weak
// int __fastcall set_pppoe_status(_DWORD, _DWORD); weak
// int get_firmupcheck_status(void); weak
// char *strcpy(char *dest, const char *src);
// int clear_port_statistics(void); weak
// int __fastcall dhcpd_get_dynamic_lease(_DWORD, _DWORD); weak
// int __fastcall print_sub_title(_DWORD, _DWORD); weak
// int __fastcall read_ftp_private_port(_DWORD, _DWORD); weak
// int __fastcall free_syslog_string(_DWORD); weak
// int set_mirroring_port(void); weak
// char *strncat(char *dest, const char *src, size_t n);
// int __fastcall strtoupper(_DWORD); weak
// int netdetect_clear_all_history(void); weak
// int __fastcall set_hostname(_DWORD); weak
// int __fastcall stop_wan(_DWORD); weak
// int __fastcall netdetect_set_email_policy(_DWORD, _DWORD, _DWORD); weak
// int class_find(void); weak
// int __fastcall discover_upper_upnp_igd(_DWORD); weak
// int printf(const char *format, ...);
// char *ctime(const time_t *timer);
// int __fastcall get_url_redir_freedevice_num(_DWORD); weak
// int system2(const char *, ...); weak
// int raise(int sig);
// int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_csrf_op(_DWORD); weak
// int __fastcall get_upnp_relay(_DWORD); weak
// int atoi(const char *nptr);
// int syslog_msg(_DWORD, const char *, ...); weak
// int __fastcall init_fw_netfilter(_DWORD); weak
// int __fastcall get_url_redirect_whitelist(_DWORD); weak
// int __fastcall sysconf_nat_get(_DWORD); weak
// int __fastcall malloc_syslog_string(_DWORD); weak
// int httpcon_auth(void); weak
// int __fastcall convert_euckr_to_utf8(_DWORD, _DWORD); weak
// int __fastcall get_url_redirect_btnmsg(_DWORD); weak
// int __fastcall set_system_lang(_DWORD); weak
// int __fastcall stp_get_bridge_port_priority(_DWORD, _DWORD, _DWORD); weak
// int __fastcall read_portconfig(_DWORD, _DWORD); weak
// int __fastcall get_hostscan(_DWORD); weak
// int __fastcall set_url_redirect_btnmsg(_DWORD); weak
// int __fastcall set_hwaddr_kernel(_DWORD, _DWORD, _DWORD); weak
// int __fastcall set_remote_mgmt_flag(_DWORD); weak
// int __fastcall check_default_pass(_DWORD); weak
// int __fastcall get_dhclient_block_private_ip(_DWORD); weak
// int __cdecl filter_add_to_class(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall print_html_progress_bar(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_smtp_account(_DWORD); weak
// char *strstr(const char *haystack, const char *needle);
// int __fastcall apply_dos_config(_DWORD); weak
// int __fastcall dhcpd_get_all_static_lease(_DWORD, _DWORD); weak
// int __fastcall get_mirrored_port(_DWORD); weak
// int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall write_ftp_private_port(_DWORD, _DWORD); weak
// int __fastcall print_nbsp(_DWORD); weak
// size_t fwrite(const void *ptr, size_t size, size_t n, FILE *s);
// int __fastcall ddnsapi_get_host_count(_DWORD); weak
// int __fastcall set_apcplan_flag(_DWORD); weak
// int __fastcall get_random_str(_DWORD, _DWORD); weak
// int __fastcall Base64encode(_DWORD, _DWORD, _DWORD); weak
// int __fastcall print_end_main_table(_DWORD); weak
// int __fastcall fw_read_db(_DWORD, _DWORD); weak
// int __fastcall set_mirroring_op(_DWORD); weak
// int sysget_ui_version(void); weak
// int __fastcall dhcpd_read_config(_DWORD); weak
// int __fastcall set_system_dns(_DWORD); weak
// int __fastcall iconfig_remove_config_tag(_DWORD); weak
// int get_igmp_proxy(void); weak
// int __fastcall dmztwinip_apply_off(_DWORD, _DWORD); weak
// int __fastcall stp_set_bridge_max_message_age(_DWORD, _DWORD); weak
// int __fastcall remove_url_redir_freedevice(_DWORD); weak
// int __cdecl send_wol_packet(_DWORD); weak
// int __fastcall netdetect_comment_for_specified_port(_DWORD, _DWORD); weak
// time_t time(time_t *timer);
// int __fastcall genconfig_free_ll(_DWORD); weak
// int __fastcall set_url_redirect_usermsg(_DWORD); weak
// int __fastcall signal_reboot(_DWORD); weak
// const unsigned __int16 **_ctype_b_loc(void);
// int __fastcall pf_line_spchar_validate(_DWORD); weak
// int tc_reconfig(void); weak
// int __fastcall get_localbroadaddr(_DWORD, _DWORD); weak
// int __fastcall accesslist_add_ip(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall netdetect_get_history_by_index(_DWORD); weak
// int __fastcall add_url_redir_freedevice(_DWORD); weak
// int __fastcall ddnsapi_read_config_by_service_type(_DWORD, _DWORD, _DWORD); weak
// int __fastcall set_fakedns(_DWORD); weak
// int __fastcall read_pppoe_option(_DWORD, _DWORD); weak
// int __fastcall portforward_remove_rules(_DWORD, _DWORD, _DWORD); weak
// void *malloc(size_t size);
// int __fastcall is_mobile_agent(_DWORD); weak
// int __fastcall clear_timed_status(_DWORD); weak
// int __fastcall print_item_desc(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall dhcpd_commit_config(_DWORD); weak
// int __fastcall stp_set_bridge_port_cost(_DWORD, _DWORD, _DWORD); weak
// int __fastcall br(_DWORD); weak
// int __fastcall add_plantynet_freedevice(_DWORD, _DWORD); weak
// int syslog_max_count(void); weak
// int __cdecl accesslist_remove_ip(_DWORD); weak
// int __fastcall stp_get_bridge_hello_time(_DWORD, _DWORD); weak
// int __fastcall get_mtu_value(_DWORD, _DWORD); weak
// int __fastcall class_destroy(_DWORD); weak
// int __fastcall get_hw_value_post(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_url_redirect_autoconfirm(_DWORD); weak
// int __fastcall get_dhcp_auto_restart(_DWORD); weak
// int __fastcall dhcpd_add_static_lease(_DWORD, _DWORD); weak
// int __fastcall tc_count_file_write(_DWORD); weak
// int init_tr_netfilter(void); weak
// int __fastcall hwinfo_get_conntrack_default(_DWORD); weak
// int get_remote_mgmt_flag(void); weak
// char *strtok(char *s, const char *delim);
// int __fastcall write_portconfig(_DWORD, _DWORD); weak
// int __fastcall set_use_local_gateway(_DWORD); weak
// int __fastcall accesslist_set_write_config(_DWORD, _DWORD, _DWORD); weak
// char *strtok_r(char *s, const char *delim, char **save_ptr);
// int __fastcall get_pvalue(_DWORD, _DWORD); weak
// int __fastcall dhcpd_stop(_DWORD); weak
// int __fastcall get_upnp(_DWORD); weak
// int __fastcall start_hostscan(_DWORD); weak
// int __fastcall print_start_content_table(_DWORD); weak
// int __fastcall get_url_redirect_usermsg2(_DWORD); weak
// int __fastcall check_wan_connected(_DWORD); weak
// int __fastcall get_wan_ip(_DWORD, _DWORD); weak
// unsigned int sleep(unsigned int seconds);
// int __fastcall netdetect_get_email_policy(_DWORD, _DWORD, _DWORD); weak
// char *strcat(char *dest, const char *src);
// int __fastcall get_client_login_trial_count_without_captchar(_DWORD); weak
// int __fastcall set_firmup_status(_DWORD); weak
// int __fastcall get_dns_shadow(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall get_twinip_wan_virtual_ip(_DWORD); weak
// int __fastcall set_use_captcha_code(_DWORD); weak
// int __fastcall print_blank_line(_DWORD, _DWORD); weak
// int __fastcall file_exists(_DWORD); weak
// int __fastcall istatus_set_value_direct(_DWORD, _DWORD); weak
// int __fastcall get_domain_name_server(_DWORD, _DWORD); weak
// int __cdecl remove_remotepc_config(_DWORD); weak
// int __fastcall max_bandwidth_get(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int trunk_group_is_full(void); weak
// int __fastcall get_timeserver_list(_DWORD, _DWORD); weak
// int __fastcall portforward_modify_rule(_DWORD, _DWORD, _DWORD); weak
// int check_remote_connection(void); weak
// int puts(const char *s);
// int __fastcall get_value_array_post(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall get_use_local_gateway(_DWORD); weak
// int __fastcall class_priority_order_write(_DWORD, _DWORD, _DWORD); weak
// int __fastcall stp_set_operation(_DWORD); weak
// int __fastcall set_wan_ipconfig(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int netdetect_get_detect_port_range(void); weak
// int __fastcall httpcon_get_session_timeout(_DWORD); weak
// int __fastcall set_wansetup_status(_DWORD, _DWORD); weak
// int __fastcall eth2wan(_DWORD, _DWORD); weak
// int __fastcall ddnsapi_get_status(_DWORD, _DWORD); weak
// int __fastcall check_ippool_range(_DWORD, _DWORD); weak
// int defaultconf(void); weak
// int __fastcall get_remotepc_config(_DWORD, _DWORD); weak
// int __fastcall set_url_redirect_usermsg2(_DWORD); weak
// int __fastcall wizard_api_set_status(_DWORD, _DWORD); weak
// int __fastcall read_snmp_conf(_DWORD); weak
// int __fastcall set_smtp_auth(_DWORD); weak
// int __fastcall get_url_redir_freedevice(_DWORD, _DWORD, _DWORD); weak
// int __fastcall plantynet_service_request(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall remove_plantynet_freedevice(_DWORD); weak
// int __fastcall vlan_add_config(_DWORD, _DWORD); weak
// int __fastcall set_remote_mgmt_port(_DWORD); weak
// int __fastcall iconfig_set_intvalue_direct(_DWORD, _DWORD); weak
// int __fastcall get_url_redirect_cycle(_DWORD); weak
// int __fastcall add_gen_schedule(_DWORD, _DWORD); weak
// int __fastcall wizard_api_get_status(_DWORD, _DWORD); weak
// int __fastcall get_subnet_range(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall get_smtp_server(_DWORD); weak
// int __fastcall set_lan_ipconfig(_DWORD, _DWORD, _DWORD); weak
// int maccmp(void); weak
// int __fastcall pptpserver_add_user(_DWORD); weak
// int netdetect_get_burst_drop(void); weak
// int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD); weak
// int __fastcall set_url_redirect_option(_DWORD, _DWORD); weak
// int __fastcall fw_delete_rules(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall syslog_set_email_status(_DWORD, _DWORD, _DWORD); weak
// int __fastcall insert_tr_to_rule(_DWORD, _DWORD); weak
// int __fastcall accesslist_set_read_config(_DWORD); weak
// int __fastcall write_rt_db(_DWORD); weak
// int __fastcall pptpserver_disconnect_user(_DWORD); weak
// int __fastcall netdetect_read_current_history(_DWORD); weak
// int __fastcall print_end_content_table(_DWORD); weak
// int __fastcall portforward_read_db(_DWORD, _DWORD); weak
// int __fastcall get_iptime_service_network(_DWORD); weak
// int netdetect_get_monitor_level(void); weak
// int __fastcall restore_backup_config(_DWORD); weak
// int __cdecl get_plantynet_freedevice(_DWORD, _DWORD); weak
// int __fastcall get_ux_lang(_DWORD); weak
// int __fastcall check_same_network(_DWORD, _DWORD, _DWORD); weak
// int __fastcall dhcpd_search_static_lease(_DWORD, _DWORD); weak
// int __fastcall remove_all_gen_schedule(_DWORD); weak
// int set_ipmac_bind(void); weak
// int strncmp(const char *s1, const char *s2, size_t n);
// int __fastcall dmztwinip_apply_twinip(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall signal_toggle(_DWORD); weak
// int syslog_set_sendmail(void); weak
// int __fastcall get_internet_connected_time(_DWORD); weak
// int __fastcall check_bandwidth_limitation(_DWORD); weak
// int __fastcall stp_set_bridge_port_priority(_DWORD, _DWORD, _DWORD); weak
// int __fastcall free_portforward_list(_DWORD); weak
// int __fastcall set_ifconfig(_DWORD); weak
// int __fastcall get_id_password(_DWORD, _DWORD); weak
// int __fastcall ddnsapi_set_refresh_flag(_DWORD, _DWORD); weak
// int __fastcall get_admin_email(_DWORD); weak
// int __fastcall unlock_file(_DWORD); weak
// int __fastcall class_get(_DWORD); weak
// int __fastcall set_default_gateway(_DWORD, _DWORD); weak
// int __fastcall signal_update(_DWORD); weak
// int __fastcall tc_close(_DWORD); weak
// int __fastcall stp_get_bridge_info(_DWORD); weak
// int __fastcall dhcpd_remove_dynamic_lease(_DWORD, _DWORD); weak
// int __fastcall istatus_remove_tag_prefix(_DWORD); weak
// int __fastcall encode_crypt(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int sysget_max_config_size(void); weak
// int __fastcall write_file(_DWORD, _DWORD); weak
// int __fastcall fw_modify_db(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall set_dhcp_auto_restart(_DWORD, _DWORD); weak
// int __fastcall vlan_check_vname_available(_DWORD); weak
// int __fastcall get_hostname(_DWORD); weak
// int get_mirroring_port(void); weak
// int strcmp(const char *s1, const char *s2);
// int __fastcall check_default_gateway(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_firmupcheck_version(_DWORD); weak
// int __fastcall save_pppoe_option(_DWORD, _DWORD); weak
// int __fastcall strtolower(_DWORD); weak
// int __fastcall set_url_redirect_whitelist(_DWORD); weak
// int __fastcall get_dev_port(_DWORD, _DWORD); weak
// int __fastcall set_domain_name_server(_DWORD, _DWORD, _DWORD); weak
// int __fastcall get_send_email(_DWORD); weak
// int __fastcall get_remotepc_num(_DWORD); weak
// int __fastcall tc_open(_DWORD); weak
// int __fastcall get_pppoe_status(_DWORD); weak
// int __fastcall print_file(_DWORD); weak
// int __fastcall syslog_read_syslog_msg(_DWORD, _DWORD); weak
// int __fastcall write_file_intval(_DWORD, _DWORD); weak
// int __fastcall set_manual_dns_flag(_DWORD, _DWORD, _DWORD); weak
// int __fastcall portforward_upnp_relay_init(_DWORD); weak
// int __fastcall fw_spchar_validate(_DWORD); weak
// int __fastcall get_default_id_password(_DWORD, _DWORD); weak
// int __fastcall istatus_remove_status_tag(_DWORD); weak
// int sprintf(char *s, const char *format, ...);
// int __fastcall get_lan_ipconfig(_DWORD, _DWORD, _DWORD); weak
// int __cdecl get_timed_status(_DWORD); weak
// int __fastcall set_send_email(_DWORD); weak
// int __fastcall pptpserver_remove_user(_DWORD); weak
// int __fastcall lock_file(_DWORD); weak
// int __fastcall check_twinip_enable(_DWORD); weak
// int __fastcall remove_captcha(_DWORD); weak
int sub_FF04(void); // weak
void sub_FF30();
int *sub_FF4C();
int __fastcall sub_FF80(int a1);
void __fastcall sub_FFC4(int a1, int a2, const char *a3);
int __fastcall sub_10A4C(const char **a1, const char *a2);
int __fastcall sub_10ADC(int a1, int a2, int a3);
int __fastcall sub_10B30(int a1, int a2, int a3);
int __fastcall sub_10C8C(int a1);
int __fastcall sub_10DB0(int a1, int a2);
FILE *__fastcall sub_10FF4(int a1, int a2, const char *a3);
int __fastcall sub_11070(int a1, int a2);
int sub_115F0();
int __fastcall sub_115F8(int a1);
int __fastcall sub_11620(int a1);
size_t __fastcall sub_11658(const char *a1);
signed int __fastcall sub_11D7C(int a1, int a2, int a3);
signed int __fastcall sub_1205C(unsigned int a1, int a2, int a3);
int __fastcall sub_121A0(int a1, const char *a2, int a3);
int __fastcall sub_1236C(int a1, int a2);
signed int sub_12380();
int __fastcall sub_12418(int a1);
int __fastcall sub_124D8(int a1, int a2);
int __fastcall sub_1253C(int a1);
_UNKNOWN *sub_12678();
_UNKNOWN *sub_126C4();
signed int __fastcall sub_12700(int a1);
int __fastcall sub_12770(int a1);
int __fastcall sub_12790(int a1, int a2, int a3);
signed int __fastcall sub_127E8(const char *a1);
int __fastcall sub_12940(int a1, int a2);
int __fastcall sub_129A0(int a1, int a2);
int __fastcall sub_129D0(const char *a1);
int __fastcall sub_12AA0(const char *a1);
_UNKNOWN *__fastcall sub_12BF8(int a1, int a2);
signed int __fastcall sub_130BC(char *a1, time_t a2);
int __fastcall sub_1311C(const char *a1);
signed int __fastcall sub_13180(const char *a1);
signed int __fastcall sub_131E0(void *a1);
int __fastcall sub_1325C(int a1, const char *a2);
signed int __fastcall sub_13298(int a1);
int __fastcall sub_133E4(int a1, int a2);
int __fastcall sub_13494(int a1, int a2);
int __fastcall sub_134F4(int a1, int a2);
signed int __fastcall sub_14380(signed int result, int a2, int a3, int a4, int a5, int a6, int a7);
void __fastcall sub_143D4(int a1, int a2);
int __fastcall sub_14BD8(int a1, int a2);
int __fastcall sub_14C98(int a1, int a2);
signed int __fastcall sub_14D58(int a1, int a2, int a3);
signed int __fastcall sub_14F64(int a1, int a2, int a3);
int sub_1504C();
int __fastcall sub_150FC(int a1, int a2, int a3);
int __fastcall sub_15314(int a1);
int __fastcall sub_1556C(const char *a1, int a2);
int __fastcall sub_15600(int a1, int a2, int a3, int a4);
int __fastcall sub_15674(int a1);
int __fastcall sub_156A8(int a1, int a2, const char *a3, int a4, int a5, int a6, int a7);
int sub_1588C();
int __fastcall sub_1590C(int a1);
int sub_15964();
int sub_159C0();
int sub_15A10();
int sub_15A74();
int __fastcall sub_15B4C(int a1);
_UNKNOWN *__fastcall sub_15CB8(const char *a1);
int __fastcall sub_15D38(const char *a1);
int sub_161D4();
int __fastcall sub_16324(void **a1, int a2);
int sub_1644C();
unsigned int __fastcall sub_165E4(const char *a1, const char *a2);
int __fastcall sub_16638(int a1);
int sub_16D18();
int sub_176E0();
int sub_17704();
signed int __fastcall sub_177D0(int a1, int a2, const char *a3);
int __fastcall sub_1781C(int a1);
int __fastcall sub_17DA0(int a1, int a2);
void __fastcall sub_17E20(int a1, signed int a2);
int __fastcall sub_18844(int a1, signed int a2);
signed int __fastcall sub_18CFC(int a1);
int __fastcall sub_18FAC(int a1, int a2);
int sub_1922C();
int sub_195E4();
int sub_199C0();
int sub_19E0C();
int __fastcall sub_1A180(int a1, int a2, int a3);
int sub_1A1E0();
int __fastcall sub_1A218(int a1, int a2, int a3);
int __fastcall sub_1A294(int a1, int a2, int a3);
int sub_1A310();
int __fastcall sub_1A358(const char *a1, int a2);
_UNKNOWN *__fastcall sub_1A440(const char *a1);
char *__fastcall sub_1A4FC(char *result, const char *a2, const char *a3, char a4, int a5);
char *__fastcall sub_1A554(int a1, int a2);
int sub_1A9F4();
int sub_1AA50();
char *sub_1AACC();
int __fastcall sub_1AB1C(int a1);
int sub_1ABC8();
signed int __fastcall sub_1ADC0(int a1);
int __fastcall sub_1BA54(int a1, int a2);
int sub_1C7CC();
int sub_1C8E4();
int __fastcall sub_1CB88(int a1);
int __fastcall sub_1CCFC(int a1);
int __fastcall sub_1CDE4(int a1);
int __fastcall sub_1CE90(const char *a1);
int sub_1CF7C();
int __fastcall sub_1CFA8(int a1);
int __fastcall sub_1D078(int a1);
int sub_1D120();
int sub_1D440();
int sub_1D764();
int sub_1D914();
int __fastcall sub_1DA9C(const char *a1);
int __fastcall sub_1DCFC(const char *a1, int a2, int a3);
int __fastcall sub_1DD80(int a1);
int __fastcall sub_1E0A8(int a1, int a2);
FILE *__fastcall sub_1E274(int a1, int a2);
int __fastcall sub_1E3A8(int a1, int a2);
int __fastcall sub_1E5E8(int a1);
int sub_1ECA8();
int __fastcall sub_1ED74(int a1, int a2);
int __fastcall sub_1F610(int a1);
int __fastcall sub_1F698(int a1, int a2, int a3, int a4);
int __fastcall sub_1F87C(int a1, int a2, const char *a3, int a4);
int __fastcall sub_1F9DC(const char *a1, int a2, int a3);
int __fastcall sub_1FB50(int a1, int a2);
int __fastcall sub_20A4C(int a1);
int __fastcall sub_20EC4(int a1, int a2);
int __fastcall sub_21164(int a1);
int __fastcall sub_212C4(int a1, int a2);
int __fastcall sub_21820(int a1, const char *a2, int a3);
int __fastcall sub_21980(int a1, int a2, const char *a3);
int __fastcall sub_21B34(int a1);
int __fastcall sub_2218C(int a1, int a2);
int sub_22278();
int sub_22358();
int sub_223B8();
int sub_2244C();
int __fastcall sub_2254C(int a1, int a2);
int sub_225F8();
int sub_2264C();
int __fastcall sub_226A0(int a1);
int __fastcall sub_22810(int a1, int a2);
int __fastcall sub_22898(int a1);
int __fastcall sub_22AA4(int a1, int a2);
int __fastcall sub_22E8C(int a1);
int sub_22FC4();
int sub_2302C();
int __fastcall sub_23550(int a1, int a2);
int __fastcall sub_23AF4(int a1);
int __fastcall sub_23D68(int a1, int a2);
int __fastcall sub_24038(int a1, int a2);
int __fastcall sub_240B8(int result);
int sub_240E4();
int sub_2411C();
int sub_2413C();
int sub_241E0();
int __fastcall sub_244BC(int a1);
signed int __fastcall sub_25B30(int a1);
int __fastcall sub_25B50(int result, int a2);
int __fastcall sub_25EB0(int a1, int a2);
int __fastcall sub_26180(int a1, int a2, int a3);
FILE *__fastcall sub_26808(int a1, int a2);
int __fastcall sub_26880(int a1);
signed int __fastcall sub_269C4(const char *a1, const char *a2, int a3, signed int a4);
int __fastcall sub_26B04(int, char *s, int, int, int); // idb
signed int __fastcall sub_26C58(const char *a1);
int __fastcall sub_26D40(int a1, const char *a2);
void *__fastcall sub_27004(const char *a1);
int __fastcall sub_2778C(int result);
signed int __fastcall sub_277A0(const char *a1);
int __fastcall sub_279A0(int a1, const char *a2);
int __fastcall sub_28060(int a1, int a2);
int sub_281D4();
int sub_28268();
signed int __fastcall sub_283E0(const char *a1, int a2);
signed int __fastcall sub_28448(int a1);
int __fastcall sub_286A4(int a1, int a2);
int __fastcall sub_28A04(int a1, int a2);
int __fastcall sub_28DBC(int a1, int a2, int a3);
int __fastcall sub_28E1C(int a1, int a2, int a3);
int __fastcall sub_28E88(int a1);
int __fastcall sub_28F3C(const char *a1, int a2);
int sub_29024();
int sub_2907C();
int sub_2923C();
int sub_292DC();
int __fastcall sub_29898(int a1);
int __fastcall sub_29EBC(int a1);
int __fastcall sub_2A3B0(const char *a1);
int __fastcall sub_2A8C0(const char *a1, int a2);
int __fastcall sub_2A928(int a1, int a2);
int __fastcall sub_2ABA0(int a1);
int __fastcall sub_2AE7C(int a1, int a2);
int sub_2AECC();
int __fastcall sub_2AF04(unsigned int a1);
int sub_2AFDC();
int __fastcall sub_2B2B8(int a1, char *a2);
char *__fastcall sub_2B430(int a1);
int sub_2C4BC(); // weak
int sub_2C4C4(); // weak
FILE *__fastcall sub_2C4D0(int a1, int a2);
int __fastcall sub_2C548(int a1, int a2);
signed int __fastcall sub_2C6C4(int a1, const char *a2);
char *__fastcall sub_2C71C(int a1);
int sub_2C784();
const char *__fastcall sub_2C99C(char *src);
int __fastcall sub_2CA04(int result);
signed int __fastcall sub_2CA18(const char *a1, const char *a2, int a3, signed int a4);
void *__fastcall sub_2CB58(const char *a1);
signed int __fastcall sub_2D7EC(const char *a1);
int __fastcall sub_2DB08(int a1, int a2);
int __fastcall sub_2DB34(int a1, int a2, int a3);
int __fastcall sub_2E5C0(int a1, int a2);
int __fastcall sub_2EDB0(int a1);
signed int __fastcall sub_2EDC0(int a1);
int __fastcall sub_2EF70(const char *a1, int a2);
int __fastcall sub_2F470(int a1);
signed int sub_2F594();
int __fastcall sub_2FD3C(int a1);
int __fastcall sub_2FF68(int a1);
int __fastcall sub_30194(int a1, int a2);
int __fastcall sub_30D0C(int a1, int a2, int a3, int a4);
int __fastcall sub_30D94(int a1, int a2);
int sub_30DDC();
int sub_30E50();
int __fastcall sub_30EC4(int a1, int a2);
int __fastcall sub_30F70(int a1);
int __fastcall sub_312D8(const char *a1);
int __fastcall sub_31AE4(const char *a1, int a2);
int sub_31B48();
int __fastcall sub_31E9C(const char *a1);
int __fastcall sub_31EE4(int a1, int a2, int a3, int a4);
int __fastcall sub_32560(int a1, int a2, int a3);
int __fastcall sub_325DC(int a1, int a2);
int __fastcall sub_32C44(int a1);
int __fastcall sub_32D50(int a1);
int __fastcall sub_32DC0(int a1, int a2);
int __fastcall sub_33510(int a1, int a2);
int __fastcall sub_33A94(int a1);
int sub_33EE8();
int __fastcall sub_33F68(unsigned __int64 a1, char *a2);
FILE *__fastcall sub_34070(int a1);
int sub_345E0();
int __fastcall sub_345F0(int a1, int a2, int a3, int a4, int a5);
int sub_34A1C();
signed int sub_34C54();
int __fastcall sub_3503C(int a1, int a2);
int sub_3519C();
int sub_35598();
int sub_35644();
int sub_356C4();
int sub_35744();
int sub_35800();
signed int sub_35910();
int __fastcall sub_35A2C(int a1);
int __fastcall sub_35BBC(int a1);
int __fastcall sub_35D0C(int a1);
int __fastcall sub_35D9C(int a1);
int __fastcall sub_35E4C(int a1);
int __fastcall sub_35F4C(int a1, int a2);
int __fastcall sub_36480(int a1);
int __fastcall sub_364E0(int a1, int a2);
int __fastcall sub_367DC(signed int a1);
int __fastcall sub_36B3C(int a1);
int __fastcall sub_36F0C(int a1);
__int64 __fastcall sub_36F78(int a1, int a2);
int __fastcall sub_37058(int a1, int a2);
int sub_3714C();
int __fastcall sub_373A4(int a1);
int __fastcall sub_373F4(int a1);
int __fastcall sub_37450(int a1);
int sub_37784();
signed int __fastcall sub_3810C(int a1);
int __fastcall sub_38130(int a1);
int __fastcall sub_388A4(int a1);
int sub_38B48();
int sub_38CE4();
int sub_38FDC();
int __fastcall sub_390EC(int a1, int a2);
int __fastcall sub_3953C(int a1, int a2);
_UNKNOWN *__fastcall sub_39818(const char *a1, int a2);
int __fastcall sub_39A40(int a1, int a2, int a3);
int sub_39AA8();
int sub_3A3D0();
int sub_3A584();
BOOL __fastcall sub_3A8B8(int a1);
signed int __fastcall sub_3A8EC(int a1);
int __fastcall sub_3AFD4(int a1, int a2);
int sub_3B03C();
int sub_3B1D8();
int sub_3B8D0();
int __fastcall sub_3B9D0(int a1, int a2);
int __fastcall sub_3BF74(int a1);
int __fastcall sub_3C070(int a1, int a2);
int __fastcall sub_3C0D4(int a1);
int __fastcall sub_3C2B0(int a1);
int __fastcall sub_3C534(int a1);
int __fastcall sub_3C82C(int a1, int a2);
int __fastcall sub_3CA1C(int a1, int a2, int a3);
int __fastcall sub_3CBF4(int a1);
int __fastcall sub_3D490(int a1);
int __fastcall sub_3DEEC(int a1);
int __fastcall sub_3EAD8(int a1);
int __fastcall sub_3EB20(int a1);
int sub_3EF34();
int sub_3F0D0();
int __fastcall sub_3FB00(int a1);
int __fastcall sub_3FC88(int a1, int a2);
signed int __fastcall sub_3FED0(const char *a1);
int __fastcall sub_3FF24(int a1);
int __fastcall sub_402DC(int a1, int a2);
int __fastcall sub_40340(int a1);
int sub_40800();
int __fastcall sub_40884(const char *a1, int a2);
int sub_4096C();
int __fastcall sub_40D28(int a1, int a2);
int __fastcall sub_40E78(int a1);
int sub_4110C();
int sub_41390();
int __fastcall sub_415AC(int a1);
int __fastcall sub_4182C(int a1);
int __fastcall sub_41890(int a1, int a2, int a3);
int sub_418EC();
int sub_41C78();
int __fastcall sub_42208(int a1);
int __fastcall sub_423FC(int a1);
int sub_42480();
int __fastcall sub_42784(int a1);
int __fastcall sub_42884(int a1);
int sub_4291C();
int sub_42B80();
int __fastcall sub_42DC8(int a1);
int __fastcall sub_4304C(int a1);
int sub_4309C();
int __fastcall sub_43728(int a1);
int __fastcall sub_43A14(int a1);
unsigned int __fastcall sub_43A2C(unsigned int result, unsigned int a2);
unsigned int __fastcall sub_43AD4(unsigned int a1, unsigned int a2);
int __fastcall sub_43AF4(int a1, int a2);
int __fastcall sub_43AFC(int result, unsigned int a2);
int __fastcall sub_43BD0(int a1, unsigned int a2);
unsigned int __fastcall sub_43EA8(unsigned int result, int a2, int a3, int a4, int a5, int a6, int (__fastcall *a7)(_DWORD, _DWORD));
int __fastcall sub_43ECC(int result);
int __fastcall sub_43FA8(int result, unsigned int a2, int a3, unsigned int a4);
void __fastcall sub_443A8(int a1, int a2, int a3, unsigned int a4);
int __fastcall sub_44424(int result, int a2, int a3, int a4);
int __fastcall sub_445BC(int result);
int __fastcall sub_44668(unsigned int a1, unsigned int a2, int a3, int a4);
int __fastcall sub_44800(unsigned int a1, unsigned int a2, int a3, int a4);
unsigned int __fastcall sub_44960(int a1);
int __fastcall sub_449BC(__int64 a1, __int64 a2);
int __fastcall sub_44A08(__int64 a1, unsigned int a2, unsigned int a3, int a4);
unsigned __int64 __fastcall sub_44A88(unsigned int a1, int a2, unsigned int a3, unsigned int a4);
signed int __fastcall sub_44FA8(unsigned int a1, unsigned int a2, unsigned int a3, unsigned int a4);
int __fastcall sub_45470(int a1, int a2, int a3);
void term_proc();
// int get_pppoe_relay_enabled(void); weak

//-------------------------------------------------------------------------
// Data declarations

// extern _UNKNOWN loc_FD20; weak
_UNKNOWN loc_15180; // weak
void *off_2A300 = &unk_7128C; // weak
_UNKNOWN loc_3F480; // weak
_UNKNOWN loc_43AC8; // weak
_UNKNOWN loc_43BC0; // weak
_UNKNOWN loc_43D44; // weak
_UNKNOWN loc_4413C; // weak
_UNKNOWN loc_441A4; // weak
_UNKNOWN loc_441F0; // weak
_UNKNOWN loc_44208; // weak
_UNKNOWN loc_44708; // weak
_UNKNOWN loc_44798; // weak
_UNKNOWN loc_447E0; // weak
_UNKNOWN loc_447F4; // weak
_UNKNOWN loc_449F8; // weak
_UNKNOWN unk_4617C; // weak
_UNKNOWN unk_468B6; // weak
_UNKNOWN unk_5C787; // weak
_UNKNOWN unk_5C8A8; // weak
_UNKNOWN unk_5D17C; // weak
_UNKNOWN unk_5E9C1; // weak
_UNKNOWN unk_5F0D6; // weak
_UNKNOWN unk_5F0E6; // weak
_UNKNOWN unk_5F238; // weak
_UNKNOWN unk_60F0E; // weak
_UNKNOWN unk_60F13; // weak
_UNKNOWN unk_60F1B; // weak
_UNKNOWN unk_619C3; // weak
_UNKNOWN unk_61A66; // weak
_UNKNOWN unk_63526; // weak
_UNKNOWN unk_6450B; // weak
_UNKNOWN unk_646B1; // weak
_UNKNOWN unk_6496B; // weak
_UNKNOWN unk_64C49; // weak
_UNKNOWN unk_659D9; // weak
_UNKNOWN unk_669D1; // weak
_UNKNOWN unk_66ABF; // weak
_UNKNOWN unk_67565; // weak
_UNKNOWN unk_67572; // weak
_UNKNOWN unk_67821; // weak
_UNKNOWN unk_67A3B; // weak
_UNKNOWN unk_67D4E; // weak
_UNKNOWN unk_67DE2; // weak
_UNKNOWN unk_681C2; // weak
_UNKNOWN unk_6966E; // weak
_UNKNOWN unk_69E05; // weak
_UNKNOWN unk_69E61; // weak
_UNKNOWN unk_6A12D; // weak
_UNKNOWN unk_6B14C; // weak
_UNKNOWN unk_6BDC4; // weak
_UNKNOWN unk_6C3AA; // weak
_UNKNOWN unk_6CE8C; // weak
_UNKNOWN unk_6D2B5; // weak
_UNKNOWN unk_6D397; // weak
_UNKNOWN unk_6E69B; // weak
_UNKNOWN unk_6EF65; // weak
_UNKNOWN unk_6F03E; // weak
_UNKNOWN unk_6F04A; // weak
_UNKNOWN unk_6F053; // weak
_UNKNOWN unk_6F669; // weak
_UNKNOWN unk_6FFD7; // weak
_UNKNOWN unk_6FFDC; // weak
_UNKNOWN unk_7007E; // weak
_UNKNOWN unk_71870; // weak
_UNKNOWN unk_71C05; // weak
_UNKNOWN unk_72040; // weak
_UNKNOWN unk_721EF; // weak
_UNKNOWN unk_723E8; // weak
_UNKNOWN unk_729E3; // weak
_UNKNOWN unk_7340C; // weak
_UNKNOWN unk_7558B; // weak
_UNKNOWN unk_75C50; // weak
_UNKNOWN unk_75CD9; // weak
_UNKNOWN unk_767FB; // weak
_UNKNOWN unk_770C2; // weak
_UNKNOWN unk_77EDD; // weak
_UNKNOWN unk_79095; // weak
_UNKNOWN unk_7910E; // weak
_UNKNOWN unk_793C8; // weak
_UNKNOWN unk_7956E; // weak
_UNKNOWN unk_7993D; // weak
_UNKNOWN unk_79FE9; // weak
_UNKNOWN unk_7A127; // weak
_UNKNOWN unk_7A3E8; // weak
_UNKNOWN unk_7B6C4; // weak
_UNKNOWN unk_7B837; // weak
_UNKNOWN unk_7BDFA; // weak
_UNKNOWN unk_7BF30; // weak
_UNKNOWN unk_7C881; // weak
_UNKNOWN unk_7CC7E; // weak
_UNKNOWN unk_7CCC7; // weak
_UNKNOWN unk_7CCCA; // weak
_UNKNOWN unk_7CDF4; // weak
_UNKNOWN unk_7CDF7; // weak
_UNKNOWN unk_7CDFE; // weak
_UNKNOWN unk_7CE0A; // weak
_UNKNOWN unk_7D836; // weak
_UNKNOWN unk_7FDFA; // weak
char aAbcdefghijklmn[65] = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"; // weak
_UNKNOWN unk_825C6; // weak
_UNKNOWN unk_82B91; // weak
_UNKNOWN unk_83050; // weak
_UNKNOWN unk_833C1; // weak
_UNKNOWN unk_83D89; // weak
_UNKNOWN unk_83D9D; // weak
_UNKNOWN unk_83DA9; // weak
_UNKNOWN unk_84708; // weak
_UNKNOWN unk_84B07; // weak
_UNKNOWN unk_84E41; // weak
_UNKNOWN unk_85FBE; // weak
_UNKNOWN unk_86017; // weak
_UNKNOWN unk_86063; // weak
_UNKNOWN unk_860B2; // weak
_UNKNOWN unk_864CA; // weak
_UNKNOWN unk_864DB; // weak
_UNKNOWN unk_86AAC; // weak
_UNKNOWN unk_8732F; // weak
_UNKNOWN unk_885BA; // weak
_UNKNOWN unk_88821; // weak
_UNKNOWN unk_88B86; // weak
_UNKNOWN unk_88DA0; // weak
_UNKNOWN unk_89DA1; // weak
_UNKNOWN unk_8A0A8; // weak
_UNKNOWN unk_8A276; // weak
_UNKNOWN unk_8B2CE; // weak
_BYTE byte_8BA3E[256] =
{
  0,
  1,
  2,
  2,
  3,
  3,
  3,
  3,
  4,
  4,
  4,
  4,
  4,
  4,
  4,
  4,
  5,
  5,
  5,
  5,
  5,
  5,
  5,
  5,
  5,
  5,
  5,
  5,
  5,
  5,
  5,
  5,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  6,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8,
  8
}; // idb
int (*off_93EE4[2])() = { &sub_FF4C, &sub_FF30 }; // weak
int dword_93EEC = 0; // weak
char *off_947F8[2] = { "Apr", "Aug" }; // weak
char *off_94870[20] =
{
  "Apr",
  "Aug",
  "days",
  "Dec",
  "Feb",
  "Fri",
  "hours",
  "Jan",
  "Jul",
  "Jun",
  "Mar",
  "May",
  "minutes",
  "month",
  "Mon",
  "Trying to get system time from time server.",
  "Nov",
  "Oct",
  "Sat",
  "Sec"
}; // weak
char *off_948E8[3] =
{
  "설명을 입력하세요",
  "최대 %d개 추가 가능",
  "원격 관리 포트"
}; // weak
char *off_95EB8[11] =
{
  "Input a explain",
  "Max %d",
  "Management port",
  "Add",
  "Once a user access the internet, the user's browser will be redirected to the URL you listed",
  "Others on the exception list are excluded",
  "(Maximum 10 devices)",
  "Description",
  "Notice URL",
  "White list is the list defined connection to allow the IP address",
  "or domain is included in the notice page."
}; // weak
_UNKNOWN unk_97488; // weak
_UNKNOWN unk_9748C; // weak
_UNKNOWN unk_97490; // weak
_UNKNOWN unk_97494; // weak
_UNKNOWN unk_97498; // weak
_UNKNOWN unk_9749C; // weak
_UNKNOWN unk_974A0; // weak
_UNKNOWN unk_974A4; // weak
_UNKNOWN unk_974A8; // weak
int stdout; // weak
char byte_976C0; // weak
int dword_97804; // weak
_UNKNOWN unk_97808; // weak
_UNKNOWN unk_97908; // weak
int dword_97928; // weak
_UNKNOWN unk_9792C; // weak
int dword_979AC; // weak
int dword_979B0[]; // weak
_UNKNOWN unk_979BC; // weak
_UNKNOWN unk_984A0; // weak
_UNKNOWN unk_98520; // weak
_UNKNOWN unk_98560; // weak
char byte_985A0[]; // weak
_UNKNOWN unk_985A6; // weak
_UNKNOWN unk_985B5; // weak
_UNKNOWN unk_985BB; // weak
_UNKNOWN unk_985CA; // weak
_UNKNOWN unk_985D0; // weak
_UNKNOWN unk_985DF; // weak
_UNKNOWN unk_985E5; // weak
_UNKNOWN unk_985F4; // weak
_UNKNOWN unk_985FA; // weak
_UNKNOWN unk_98609; // weak
_UNKNOWN unk_9860F; // weak
_UNKNOWN unk_9861E; // weak
_UNKNOWN unk_98624; // weak
_UNKNOWN unk_98633; // weak
_UNKNOWN unk_98639; // weak
char byte_98648; // weak
_UNKNOWN unk_98658; // weak
_UNKNOWN unk_98668; // weak
_UNKNOWN unk_98678; // weak
_UNKNOWN unk_98688; // weak
_UNKNOWN unk_98698; // weak
_UNKNOWN unk_986A8; // weak
_UNKNOWN unk_986B8; // weak
int dword_986D8; // weak
_UNKNOWN unk_986DC; // weak
int dword_9879C; // weak
int (__fastcall *dword_987A0)(_DWORD); // weak
int (__fastcall *dword_987A4)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__fastcall *dword_987A8)(_DWORD); // weak
int (__fastcall *dword_987AC)(_DWORD); // weak
int (__fastcall *dword_987B0)(_DWORD); // weak
int (__fastcall *dword_987B4)(_DWORD); // weak
int (__fastcall *dword_987B8)(_DWORD); // weak
int (__fastcall *dword_987BC)(_DWORD); // weak
char byte_987C0[4032]; // idb
// extern _UNKNOWN __gmon_start__; weak


//----- (0000E718) --------------------------------------------------------
int init_proc()
{
  return sub_FF04();
}
// FF04: using guessed type int sub_FF04(void);

//----- (0000FECC) --------------------------------------------------------
#error "FED8: positive sp value has been found (funcsize=3)"

//----- (0000FF04) --------------------------------------------------------
int sub_FF04()
{
  int result; // r0@2

  if ( &__gmon_start__ )
    result = _gmon_start__();
  return result;
}
// E9F0: using guessed type int _gmon_start__(void);
// FF04: using guessed type int sub_FF04(void);

//----- (0000FF30) --------------------------------------------------------
void sub_FF30()
{
  if ( !byte_976C0 )
    ++byte_976C0;
}
// 976C0: using guessed type char byte_976C0;

//----- (0000FF4C) --------------------------------------------------------
int *sub_FF4C()
{
  return &dword_93EEC;
}
// 93EEC: using guessed type int dword_93EEC;

//----- (0000FF80) --------------------------------------------------------
int __fastcall sub_FF80(int a1)
{
  int result; // r0@1
  int v2; // r4@1

  result = get_pvalue(a1, "ip");
  v2 = result;
  if ( result )
  {
    puts("<script>");
    printf("RefreshOpener('%s');\n", v2);
    result = printf("</script>");
  }
  return result;
}
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);

//----- (0000FFC4) --------------------------------------------------------
void __fastcall sub_FFC4(int a1, int a2, const char *a3)
{
  int v3; // r5@1
  int v4; // r6@1
  const char *v5; // r4@1

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( !strcmp(a3, "sysconf_misc") )
  {
    sub_1BA54(v3, v4);
  }
  else if ( !strcmp(v5, "sysconf_misc_realtime_status") )
  {
    sub_1AA50();
  }
  else if ( !strcmp(v5, "sysconf_misc_configmgmt_submit") )
  {
    sub_1E3A8(v3, v4);
  }
  else if ( !strcmp(v5, "sysconf_misc_configmgmt_restore") )
  {
    sub_1E274(v3, v4);
  }
  else if ( !strcmp(v5, "upnp_sysconf_misc") )
  {
    sub_1ABC8();
  }
  else if ( !strcmp(v5, "natrouterconf_misc") )
  {
    sub_29024();
  }
  else if ( !strcmp(v5, "natrouterconf_misc_select") )
  {
    sub_2ABA0(v3);
  }
  else if ( !strcmp(v5, "natrouterconf_misc_status") )
  {
    sub_292DC();
  }
  else if ( !strcmp(v5, "natrouterconf_misc_submit") )
  {
    sub_2A928(v3, v4);
  }
  else if ( !strcmp(v5, "natrouterconf_router_list") )
  {
    sub_281D4();
  }
  else if ( !strcmp(v5, "natrouterconf_router_status") )
  {
    sub_28A04(v3, v4);
  }
  else if ( !strcmp(v5, "natrouterconf_router_setup") )
  {
    sub_286A4(v3, v4);
  }
  else if ( !strcmp(v5, "lan_pcinfo") )
  {
    sub_17E20(v3, v4);
  }
  else if ( !strcmp(v5, "static_lease") )
  {
    sub_18844(v3, v4);
  }
  else if ( !strcmp(v5, "user_portforward") )
  {
    sub_279A0(v3, (const char *)v4);
  }
  else if ( !strcmp(v5, "upnp_portforward") )
  {
    sub_26D40(v3, (const char *)v4);
  }
  else if ( !strcmp(v5, "trigger_portforward") )
  {
    sub_26880(v3);
  }
  else if ( !strcmp(v5, "restore_portforward") )
  {
    sub_28060(v3, v4);
  }
  else if ( !strcmp(v5, "firewall") )
  {
    sub_2E5C0(v3, v4);
  }
  else if ( !strcmp(v5, "macsearch_firewall") )
  {
    sub_2C784();
  }
  else if ( !strcmp(v5, (const char *)&unk_7558B) )
  {
    sub_2C548(v3, v4);
  }
  else if ( !strcmp(v5, "system_info_status") )
  {
    sub_161D4();
  }
  else if ( !strcmp(v5, "hiddenwansetup") )
  {
    sub_2218C(v3, v4);
  }
  else if ( !strcmp(v5, "hiddenwanstatus") )
  {
    sub_212C4(v3, v4);
  }
  else if ( !strcmp(v5, "netconfmacsearch") )
  {
    sub_20EC4(v3, v4);
  }
  else if ( !strcmp(v5, "hiddenlansetup") )
  {
    sub_17DA0(v3, v4);
  }
  else if ( !strcmp(v5, "hiddenlanstatus") )
  {
    sub_17704();
  }
  else if ( !strcmp(v5, "trafficconf_qos_menu") )
  {
    sub_30E50();
  }
  else if ( !strcmp(v5, "trafficconf_qos_menu_status") )
  {
    sub_33A94(v3);
  }
  else if ( !strcmp(v5, "trafficconf_qos_list") )
  {
    sub_30DDC();
  }
  else if ( !strcmp(v5, "trafficconf_qos_list_status") )
  {
    sub_33510(v3, v4);
  }
  else if ( !strcmp(v5, "trafficconf_qos_setup") )
  {
    sub_32DC0(v3, v4);
  }
  else if ( !strcmp(v5, "trafficconf_conninfo_total") )
  {
    sub_33EE8();
  }
  else if ( !strcmp(v5, "trafficconf_conninfo_total_status") )
  {
    sub_34A1C();
  }
  else if ( !strcmp(v5, "trafficconf_conninfo_info") )
  {
    sub_35598();
  }
  else if ( !strcmp(v5, "trafficconf_conninfo_info_status") )
  {
    sub_3519C();
  }
  else if ( !strcmp(v5, "trafficconf_conninfo_info_submit") )
  {
    sub_3503C(v3, v4);
  }
  else if ( !strcmp(v5, "trafficconf_connctrl_connctrl") )
  {
    sub_356C4();
  }
  else if ( !strcmp(v5, "trafficconf_connctrl_connctrl_status") )
  {
    sub_364E0(v3, v4);
  }
  else if ( !strcmp(v5, "trafficconf_connctrl_timeout") )
  {
    sub_35644();
  }
  else if ( !strcmp(v5, "trafficconf_connctrl_timeout_status") )
  {
    sub_35F4C(v3, v4);
  }
  else if ( !strcmp(v5, "sysconf_syslog_setup") )
  {
    sub_223B8();
  }
  else if ( !strcmp(v5, "sysconf_syslog_setup_status") )
  {
    sub_22AA4(v3, v4);
  }
  else if ( !strcmp(v5, "sysconf_syslog_log") )
  {
    sub_22278();
  }
  else if ( !strcmp(v5, "sysconf_syslog_log_status") )
  {
    sub_22898(v3);
  }
  else if ( !strcmp(v5, "sysconf_syslog_log_clear") )
  {
    sub_22810(v3, v4);
  }
  else if ( !strcmp(v5, "hiddenloginsetup") )
  {
    sub_18FAC(v3, v4);
  }
  else if ( !strcmp(v5, "sysconf_swupgrade_online_status") )
  {
    sub_1ED74(v3, v4);
  }
  else if ( !strcmp(v5, "sysconf_swupgrade_manual_status") )
  {
    sub_1ECA8();
  }
  else if ( !strcmp(v5, "experconf_iptv_macgroup") )
  {
    sub_40800();
  }
  else if ( !strcmp(v5, "experconf_iptv_macgroup_status") )
  {
    sub_40E78(v3);
  }
  else if ( !strcmp(v5, "expertconf_iptv_setup_status") )
  {
    sub_40D28(v3, v4);
  }
  else if ( !strcmp(v5, "hiddenpptpvpnsetup") )
  {
    sub_3C070(v3, v4);
  }
  else if ( !strcmp(v5, "hiddenpptpvpnstatus") )
  {
    sub_3B8D0();
  }
  else if ( !strcmp(v5, "pptpvpn_account") )
  {
    sub_3B9D0(v3, v4);
  }
  else if ( !strcmp(v5, "hiddenddnssetup") )
  {
    sub_3AFD4(v3, v4);
  }
  else if ( !strcmp(v5, "hiddenddnsstatus") )
  {
    sub_3A584();
  }
  else if ( !strcmp(v5, "expertconfmacsearch") )
  {
    sub_3953C(v3, v4);
  }
  else if ( !strcmp(v5, "expertconfwollist") )
  {
    sub_390EC(v3, v4);
  }
  else if ( !strcmp(v5, "hostscanstatus") )
  {
    sub_2302C();
  }
  else if ( !strcmp(v5, "hostscansubmit") )
  {
    sub_24038(v3, v4);
  }
  else if ( !strcmp(v5, "hostscanlist") )
  {
    sub_22FC4();
  }
  else if ( !strcmp(v5, "hiddenadvertisesetup") )
  {
    sub_402DC(v3, v4);
  }
  else if ( !strcmp(v5, "advertiseexlist") )
  {
    sub_3FC88(v3, v4);
  }
  else if ( !strcmp(v5, "hasetup") )
  {
    sub_30194(v3, v4);
  }
  else if ( !strcmp(v5, "haext") )
  {
    sub_2FF68(v3);
  }
  else if ( !strcmp(v5, "haint") )
  {
    sub_2FD3C(v3);
  }
}

//----- (00010A4C) --------------------------------------------------------
int __fastcall sub_10A4C(const char **a1, const char *a2)
{
  int v2; // r4@1
  const char *v3; // r5@1
  int result; // r0@1

  v2 = (int)a1;
  v3 = a2;
  result = strcmp(*a1, "/ndbin/netdetect.cgi");
  if ( !result )
  {
    result = check_remote_connection();
    if ( !result )
    {
      result = netdetect_get_on_off(0);
      if ( result )
      {
        if ( !strcmp(v3, "nd-warning") || strcmp(v3, "nd-report") )
          result = sub_388A4(v2);
        else
          result = sub_38130(v2);
      }
    }
  }
  return result;
}
// F230: using guessed type int __fastcall netdetect_get_on_off(_DWORD);
// F9A4: using guessed type int check_remote_connection(void);

//----- (00010ADC) --------------------------------------------------------
int __fastcall sub_10ADC(int a1, int a2, int a3)
{
  int v3; // r5@1
  int v4; // r4@1
  int v5; // r6@1
  int result; // r0@1
  char v7; // [sp+8h] [bp-90h]@1

  v3 = a3;
  v4 = a2;
  v5 = a1;
  snprintf2(&v7, 128, "%s_%s", a2, a3);
  result = sub_14BD8(v4, v3);
  if ( result )
    result = ((int (__fastcall *)(int))result)(v5);
  return result;
}
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);

//----- (00010B30) --------------------------------------------------------
int __fastcall sub_10B30(int a1, int a2, int a3)
{
  int v3; // r6@1
  int v4; // r4@1
  int v5; // r7@1
  const char *v6; // r0@1
  int v7; // r4@3
  int v8; // r0@3
  int v9; // r1@5
  int v10; // r0@5
  int v11; // r0@5
  int result; // r0@5
  int v13; // r5@6
  char v14[512]; // [sp+8h] [bp-2D8h]@3
  char v15; // [sp+208h] [bp-D8h]@6
  char v16; // [sp+288h] [bp-58h]@3
  char dest; // [sp+2A8h] [bp-38h]@3

  v3 = a2;
  v4 = a3;
  v5 = a1;
  v6 = (const char *)get_pvalue(a1, "saveconfig");
  if ( v6 && !strcmp(v6, "1") )
  {
    strcpy(&dest, "");
    strcpy(&v16, "");
    get_value(v5, "tmenu", &dest, 32);
    get_value(v5, "smenu", &v16, 32);
    v7 = snprintf2(v14, 512, "timepro.cgi?tmenu=%s&smenu=%s&savesave=1", &dest, &v16);
    v8 = strcmp((const char *)v3, "wirelessconf5g");
    if ( !v8 )
      v8 = snprintf2(&v14[v7], 512, "&wl_mode=1");
    print_start_main_table(v8);
    v10 = sub_134F4(873, v9);
    v11 = print_html_apply_wait(v10, 2, v14);
    result = print_end_main_table(v11);
  }
  else
  {
    snprintf2(&v15, 128, "%s_%s", v3, v4);
    v13 = sub_14C98(v3, v4);
    result = sub_115F0();
    if ( !result && v13 )
      result = ((int (__fastcall *)(int))v13)(v5);
  }
  return result;
}
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// F02C: using guessed type int __fastcall print_html_apply_wait(_DWORD, _DWORD, _DWORD);
// F2A8: using guessed type int __fastcall print_start_main_table(_DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// F5F0: using guessed type int __fastcall print_end_main_table(_DWORD);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);
// 10B30: using guessed type char var_2D8[512];

//----- (00010C8C) --------------------------------------------------------
int __fastcall sub_10C8C(int a1)
{
  int v1; // r4@1
  const char *v2; // r0@1
  int v3; // r1@2
  int v4; // r0@3
  const char *v5; // r0@4
  char *v6; // r1@7
  int v7; // r0@12
  int v9; // [sp+0h] [bp-2C8h]@11
  char v10; // [sp+80h] [bp-248h]@11
  char dest; // [sp+1C0h] [bp-108h]@9

  v1 = a1;
  v2 = (const char *)get_pvalue(a1, "helpmenu");
  if ( v2 && !strcmp(v2, "1") )
  {
    v4 = 526;
LABEL_7:
    v6 = (char *)sub_134F4(v4, v3);
    goto LABEL_8;
  }
  v5 = (const char *)get_pvalue(v1, "tmenu");
  if ( v5 && !strcmp(v5, "wizard") )
  {
    v4 = 1387;
    goto LABEL_7;
  }
  strcpy(&dest, "");
  get_hostname(&dest);
  if ( !dest )
  {
    get_si("pi", &v9);
    printf("<head><title>%s %s</title>\n", &v10, &v9);
    goto LABEL_12;
  }
  v6 = &dest;
LABEL_8:
  printf("<head><title>%s</title>\n", v6);
LABEL_12:
  printf("<meta name=\"format-detection\" content=\"telephone=no\">");
  v7 = printf("<style>");
  dword_987A0(v7);
  printf("</style>");
  return puts("</head>");
}
// E7D4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);
// FD64: using guessed type int __fastcall get_hostname(_DWORD);
// 987A0: using guessed type int (__fastcall *)(_DWORD);

//----- (00010DB0) --------------------------------------------------------
int __fastcall sub_10DB0(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r6@1
  int v4; // r1@3
  int result; // r0@6
  int *v6; // r0@9
  int v7; // r0@13
  int v8; // r0@19
  int v9; // [sp+0h] [bp-100h]@17
  char v10; // [sp+100h] [bp+0h]@1
  char dest; // [sp+180h] [bp+80h]@1
  char v12; // [sp+200h] [bp+100h]@15
  char v13; // [sp+220h] [bp+120h]@15

  v2 = a2;
  v3 = a1;
  strcpy(&dest, "");
  strcpy(&v10, "");
  if ( v2 )
  {
    get_value_post(v2, "tmenu", &dest, 127);
    get_value_post(v2, "smenu", &v10, 127);
  }
  else
  {
    v4 = get_pvalue(v3, "tmenu");
    if ( v4 )
      sf_strncpy(&dest, v4, 128);
    v8 = get_pvalue(v3, "smenu");
    if ( v8 )
      sf_strncpy(&v10, v8, 128);
  }
  result = strcmp(&dest, "menu_titlebar");
  if ( result )
  {
    result = strcmp(&dest, "navi_titlebar");
    if ( result )
    {
      if ( !strcmp(&dest, "titlebar") )
      {
        v6 = (int *)"/home/httpd/js/toptitle.js";
      }
      else if ( !strcmp(&dest, "navi_menu_basic") || !strcmp(&dest, "navi_menu_advance") )
      {
        v6 = (int *)"/home/httpd/js/navimenu.js";
      }
      else
      {
        print_file("/home/httpd/js/navimenu.js");
        sub_133E4((int)"string", 0);
        v7 = sub_133E4((int)"common", 0);
        if ( dword_987BC )
          dword_987BC(v7);
        get_netaddr("br0", &v13);
        get_localbroadaddr("br0", &v12);
        puts("<script>");
        printf(
          "function CheckIPNetworkObj(ifr,ip)\n\t\t{\n\t\t\tfor( i = 1 ; i <= 4 ; i++ )\t\t\t\tif( ifr.document.getElementsByName(ip+i)[0].value == '' )\t\t\t\t\treturn 0;\t\t\tip1=Number(ifr.document.getElementsByName(ip+1)[0].value);\t\t\tip2=Number(ifr.document.getElementsByName(ip+2)[0].value);\t\t\tip3=Number(ifr.document.getElementsByName(ip+3)[0].value);\t\t\tip4=Number(ifr.document.getElementsByName(ip+4)[0].value);\t\t\tipstr = ip1+'.'+ip2+'.'+ip3+'.'+ip4;\t\t\tif( ipstr == '%s')\t\t\t{\t\t\t\treturn ifr.document.getElementsByName(ip+4)[0];\t\t\t}\t\t\tif( ipstr == '%s')\t\t\t{\t\t\t\treturn ifr.document.getElementsByName(ip+4)[0];\t\t\t}\t\t\treturn 0;\t\t}\n\n",
          &v13,
          &v12);
        printf(
          "function CheckIPNetwork(ip)\n\t\t{\n\t\t\tfor( i = 1 ; i <= 4 ; i++ )\t\t\t\tif( document.getElementsByName(ip+i)[0].value == '' )\t\t\t\t\treturn 0;\t\t\tip1=Number(document.getElementsByName(ip+1)[0].value);\t\t\tip2=Number(document.getElementsByName(ip+2)[0].value);\t\t\tip3=Number(document.getElementsByName(ip+3)[0].value);\t\t\tip4=Number(document.getElementsByName(ip+4)[0].value);\t\t\tipstr = ip1+'.'+ip2+'.'+ip3+'.'+ip4;\t\t\tif( ipstr == '%s')\t\t\t{\t\t\t\treturn document.getElementsByName(ip+4)[0];\t\t\t}\t\t\tif( ipstr == '%s')\t\t\t{\t\t\t\treturn document.getElementsByName(ip+4)[0];\t\t\t}\t\t\treturn 0;\t\t}\n\n",
          &v13,
          &v12);
        puts("</script>");
        if ( !strcmp(&dest, "wizard") )
          print_file("/home/httpd/js/netconf.js");
        snprintf2(&v9, 255, "/home/httpd/js/%s.js", &dest);
        v6 = &v9;
      }
      result = print_file(v6);
    }
  }
  return result;
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EEC4: using guessed type int __fastcall get_netaddr(_DWORD, _DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F6E0: using guessed type int __fastcall get_localbroadaddr(_DWORD, _DWORD);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);
// FE0C: using guessed type int __fastcall print_file(_DWORD);
// 987BC: using guessed type int (__fastcall *dword_987BC)(_DWORD);

//----- (00010FF4) --------------------------------------------------------
FILE *__fastcall sub_10FF4(int a1, int a2, const char *a3)
{
  int v3; // r5@1
  int v4; // r6@1
  const char *v5; // r4@1
  FILE *result; // r0@5

  v3 = a1;
  v4 = a2;
  v5 = a3;
  if ( !strcmp(a3, "manual_config_wizard") )
    sub_3EB20(v3);
  if ( !strcmp(v5, "pf_restore") )
    sub_26808(v3, v4);
  result = (FILE *)strcmp(v5, "fw_restore");
  if ( !result )
    result = sub_2C4D0(v3, v4);
  return result;
}

//----- (00011070) --------------------------------------------------------
int __fastcall sub_11070(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r0@4
  const char *v4; // r5@4
  const char *v5; // r0@7
  int v6; // r0@11
  int v7; // r5@11
  char *v8; // r2@13
  int v9; // r0@13
  int v10; // r0@15
  int v11; // r0@18
  int v12; // r0@20
  const char *v13; // r0@21
  const char *v14; // r0@33
  int v15; // r6@34
  int v16; // r0@35
  int v17; // r0@44
  int *v18; // r12@44
  int v19; // r0@46
  char *v20; // r2@46
  int v21; // r1@46
  int *v22; // r3@46
  int v23; // r1@49
  int v24; // r2@49
  int v26; // [sp+0h] [bp-B0h]@26
  char s1; // [sp+40h] [bp-70h]@12
  char v28; // [sp+80h] [bp-30h]@37

  v2 = a2;
  if ( istatus_get_intvalue_direct("killhttpd") == 1 || !httpcon_check_session_url() || httpcon_auth() )
  {
    sub_12700((int)&dword_9879C);
    v3 = get_pvalue(v2, "flag");
    v4 = (const char *)v3;
    if ( v3 )
    {
      print_http_header(v3);
      puts("<html>");
      sub_10C8C(v2);
      sub_10A4C((const char **)v2, v4);
      printf("</html>");
      return 0;
    }
    if ( !strcmp(*(const char **)v2, "/ndbin/netdetect.cgi") )
      return 0;
    v5 = (const char *)get_pvalue(v2, "page");
    if ( v5 && !strcmp(v5, "url_redirect") )
    {
      print_http_header(0);
      sub_40340(v2);
      return 0;
    }
    if ( !strcmp(*(const char **)v2, "/cgibin/login-cgi/urlredir.cgi") )
      return 0;
    v6 = post_process();
    v7 = v6;
    if ( v6 )
    {
      if ( !get_value_post(v6, "commit", &s1, 64) )
        goto LABEL_18;
      v8 = &s1;
      v9 = 0;
    }
    else
    {
      v10 = get_pvalue(v2, "commit");
      if ( !v10 )
      {
LABEL_18:
        v11 = get_pvalue(v2, "savesave");
        if ( v11 )
        {
          v11 = strcmp((const char *)v11, "1");
          if ( !v11 )
          {
            v12 = syslog_msg(1, "@{85}");
            v11 = saveconf(v12);
          }
        }
        print_http_header(v11);
        v13 = (const char *)get_pvalue(v2, "factory_test_mode");
        if ( v13 && !strcmp(v13, "off") )
        {
          defaultconf();
          printf("OK");
        }
        puts("<html>");
        printf("<meta http-equiv='X-UA-Compatible' content='IE=edge'>");
        printf("<meta name='renderer' content='webkit'>");
        sub_10DB0(v2, v7);
        sub_10C8C(v2);
        if ( v7 )
        {
          if ( get_value_post(v7, "tmenu", &s1, 64) && get_value_post(v7, "smenu", &v26, 64) )
          {
            if ( !strcmp(&s1, "iframe") )
              sub_FFC4(0, v7, (const char *)&v26);
            else
              dword_987A4(0, v7, &s1, &v26);
          }
          free((void *)v7);
          goto LABEL_65;
        }
        if ( get_value(v2, "tmenu", &s1, 64) )
        {
          if ( get_value(v2, "smenu", &v26, 64) )
          {
            v14 = (const char *)get_pvalue(v2, &unk_4617C);
            if ( v14 )
            {
              v16 = strcmp(v14, "plantynet");
              v15 = 1 - v16;
              if ( (unsigned int)v16 > 1 )
                v15 = 0;
            }
            else
            {
              v15 = 0;
            }
            if ( !get_value(v2, "helpframe", &v28, 32) || strcmp(&v28, "1") )
            {
              if ( !strcmp(&s1, "iframe") )
              {
                sub_FFC4(v2, 0, (const char *)&v26);
LABEL_65:
                puts("</html>");
                fflush((FILE *)stdout);
                return 0;
              }
              if ( !strcmp(&s1, "main_frame") )
              {
                dword_987B8(v15);
                goto LABEL_65;
              }
              if ( !strcmp(&s1, "popup") )
                goto LABEL_65;
              v17 = strcmp(&s1, "menu_titlebar");
              v18 = &dword_9879C;
              if ( !v17 )
              {
                dword_987AC(v2);
                goto LABEL_65;
              }
              v19 = v2;
              v20 = &s1;
              v21 = 0;
              v22 = &v26;
LABEL_64:
              ((void (__fastcall *)(int, int, char *, int *))v18[2])(v19, v21, v20, v22);
              goto LABEL_65;
            }
          }
          else
          {
            if ( !strcmp(&s1, "navi_menu_basic") )
            {
              sub_15314(v2);
              goto LABEL_65;
            }
            if ( !strcmp(&s1, "navi_menu_advance") )
            {
              sub_150FC(v2, v23, v24);
              goto LABEL_65;
            }
            if ( !strcmp(&s1, "navi_saveinfo") )
            {
              sub_1504C();
              goto LABEL_65;
            }
            if ( !strcmp(&s1, "titlebar") )
            {
              dword_987B4(v2);
              goto LABEL_65;
            }
            if ( strcmp(&s1, "main_body") )
            {
              if ( !strcmp(&s1, "navi_titlebar") )
              {
                dword_987B0(v2);
              }
              else if ( !strcmp(&s1, "RefreshOpener") )
              {
                sub_FF80(v2);
              }
              else if ( !strcmp(&s1, "wizard") )
              {
                sub_3EAD8(v2);
              }
              goto LABEL_65;
            }
          }
          dword_987A8(v2);
          goto LABEL_65;
        }
        v20 = "main_frame";
        v18 = &dword_9879C;
        v19 = v2;
        v21 = 0;
        v22 = (int *)"main_frame";
        goto LABEL_64;
      }
      v8 = (char *)v10;
      v9 = v2;
    }
    sub_10FF4(v9, v7, v8);
    goto LABEL_18;
  }
  return 0;
}
// E84C: using guessed type int __fastcall print_http_header(_DWORD);
// EC9C: using guessed type int httpcon_check_session_url(void);
// F0EC: using guessed type int __fastcall istatus_get_intvalue_direct(_DWORD);
// F110: using guessed type int __fastcall saveconf(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F260: using guessed type int post_process(void);
// F470: using guessed type int syslog_msg(_DWORD, const char *, ...);
// F4AC: using guessed type int httpcon_auth(void);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);
// FA40: using guessed type int defaultconf(void);
// 976BC: using guessed type int stdout;
// 9879C: using guessed type int dword_9879C;
// 987A4: using guessed type int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD);
// 987A8: using guessed type int (__fastcall *)(_DWORD);
// 987AC: using guessed type int (__fastcall *)(_DWORD);
// 987B0: using guessed type int (__fastcall *)(_DWORD);
// 987B4: using guessed type int (__fastcall *)(_DWORD);
// 987B8: using guessed type int (__fastcall *)(_DWORD);

//----- (000115F0) --------------------------------------------------------
int sub_115F0()
{
  return 0;
}

//----- (000115F8) --------------------------------------------------------
int __fastcall sub_115F8(int a1)
{
  printf("<tr><td width=100%% height=200px valign=top style=\"padding-top:10px;\"> %s </td></tr>", a1);
  return 0;
}

//----- (00011620) --------------------------------------------------------
int __fastcall sub_11620(int a1)
{
  int v1; // r4@1

  v1 = a1;
  printf("<script>");
  printf("alert(\"%s\");\n", v1);
  printf("</script>");
  return 0;
}

//----- (00011658) --------------------------------------------------------
size_t __fastcall sub_11658(const char *a1)
{
  const char *v1; // r6@1
  size_t result; // r0@1
  signed int v3; // r4@1
  size_t v4; // r5@1
  int v5; // r0@2
  const char *v6; // r0@3

  v1 = a1;
  result = strlen(a1);
  v3 = 0;
  v4 = result;
  while ( v3 < (signed int)v4 )
  {
    v5 = v1[v3];
    if ( v5 == 60 )
    {
      v6 = "&#60;";
LABEL_6:
      result = printf(v6);
      goto LABEL_18;
    }
    if ( v5 == 62 )
    {
      v6 = "&#62;";
      goto LABEL_6;
    }
    if ( v5 == 38 )
    {
      v6 = "&#38;";
      goto LABEL_6;
    }
    if ( v5 == 34 )
    {
      v6 = "&#34;";
      goto LABEL_6;
    }
    if ( v5 == 32 )
    {
      v6 = "&#32;";
      goto LABEL_6;
    }
    if ( v5 == 39 )
    {
      v6 = "&#39;";
      goto LABEL_6;
    }
    if ( v5 == 35 )
    {
      v6 = "&#35;";
      goto LABEL_6;
    }
    result = putchar(v5);
LABEL_18:
    ++v3;
  }
  return result;
}

//----- (00011D7C) --------------------------------------------------------
signed int __fastcall sub_11D7C(int a1, int a2, int a3)
{
  int v3; // r7@1
  int v4; // r8@1
  int v5; // r1@3
  char *v6; // r1@6
  char *v7; // r0@7
  char *v8; // r1@9
  char *v9; // r0@10
  char *v10; // r1@12
  char *v11; // r0@13
  char *v12; // r1@15
  char *v13; // r0@16
  unsigned int v14; // r5@21
  unsigned int v15; // r0@21
  unsigned int v16; // r4@21
  char *v17; // r5@22
  signed int v18; // r4@22
  bool v19; // zf@23
  signed int result; // r0@27
  int v21; // r0@26
  char *v22; // r3@26
  char v23; // [sp+18h] [bp-68h]@21
  char v24; // [sp+2Ch] [bp-54h]@21
  char v25; // [sp+40h] [bp-40h]@7
  char v26; // [sp+45h] [bp-3Bh]@10
  char v27; // [sp+4Ah] [bp-36h]@13
  char v28; // [sp+4Fh] [bp-31h]@16
  char dest; // [sp+54h] [bp-2Ch]@3

  v3 = a1;
  v4 = a3;
  if ( a2 && *(_BYTE *)a2 )
    sf_strncpy(&dest, a2, 20);
  else
    strcpy(&dest, "");
  if ( dest )
  {
    v6 = strtok(&dest, ".");
    if ( v6 )
    {
      v7 = &v25;
    }
    else
    {
      v7 = &v25;
      v6 = "0";
    }
    strcpy(v7, v6);
    v8 = strtok(0, ".");
    if ( v8 )
    {
      v9 = &v26;
    }
    else
    {
      v9 = &v26;
      v8 = "0";
    }
    strcpy(v9, v8);
    v10 = strtok(0, ".");
    if ( v10 )
    {
      v11 = &v27;
    }
    else
    {
      v11 = &v27;
      v10 = "0";
    }
    strcpy(v11, v10);
    v12 = strtok(0, ".");
    if ( v12 )
    {
      v13 = &v28;
    }
    else
    {
      v13 = &v28;
      v12 = "0";
    }
    strcpy(v13, v12);
  }
  else
  {
    v25 = 0;
    v28 = 0;
    v27 = 0;
    v26 = 0;
  }
  if ( v4 == 3 )
  {
    get_ifconfig("br0", &v24, &v23);
    v14 = inet_addr(&v24);
    v15 = inet_addr(&v23);
    v16 = ((v15 >> 24) | (v15 << 24) | ((v15 & 0xFF0000) >> 8) | ((unsigned __int16)(v15 & 0xFF00) << 8)) & ((v14 >> 24) | (v14 << 24) | ((v14 & 0xFF0000) >> 8) | ((unsigned __int16)(v14 & 0xFF00) << 8));
    snprintf2(&v25, 5, "%d", v16 >> 24);
    snprintf2(&v26, 5, "%d", (unsigned __int8)(v16 >> 16));
    snprintf2(&v27, 5, "%d", (unsigned __int16)v16 >> 8);
    v28 = 0;
  }
  v17 = &v25;
  v18 = 1;
  while ( 1 )
  {
    v19 = v4 == 4;
    if ( v4 == 4 )
      v19 = v18 == 4;
    if ( v19 )
      break;
    v21 = sub_134F4(401, v5);
    v22 = v17;
    v17 += 5;
    printf(
      "<input type=text name=\"%s%d\" maxlength=3 size=3 style=\"width:25pt; padding-left: 0; padding-right: 0; ime-mode:disabled;\" value=\"%s\" onfocus=\"this.select();\"                    onkeyup=\"IPKeyUp('%s',%d);\" onkeypress=\"return IPKeyDown('%s', %d)\" title=\"%s%d\">",
      v3,
      v18,
      v22,
      v3,
      v18,
      v3,
      v18,
      v21,
      v18);
    v19 = v18 == 4;
    result = 46;
    ++v18;
    if ( !v19 )
      result = putchar(46);
    if ( v18 == 5 )
      return result;
  }
  return printf(
           "<input type=text name=\"%s%d\" maxlength=3 size=3 style=\"width:25pt; ime-mode:disabled; background-color:#eeeeee; padding-left: 0; padding-right: 0;\" value=\"%s\" readonly>",
           v3,
           4,
           &v28);
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);

//----- (0001205C) --------------------------------------------------------
signed int __fastcall sub_1205C(unsigned int a1, int a2, int a3)
{
  unsigned int v3; // r5@1
  int v4; // r8@1
  int v5; // r10@1
  char *v6; // r6@1
  int v7; // r4@2
  unsigned int v8; // r0@2
  int v9; // r1@3
  unsigned int v10; // r5@3
  int v11; // r4@3
  unsigned int v12; // r0@3
  int v13; // r4@3
  int v14; // r1@3
  unsigned int v15; // r7@3
  int v16; // r5@3
  unsigned int v17; // r0@3
  int v18; // r5@3
  int v19; // r1@3
  int v20; // r6@3
  int v21; // r1@3
  char v23; // [sp+8h] [bp-120h]@1

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = &v23;
  if ( a1 > 0x15180 )
  {
    v7 = sub_134F4(114, a2);
    v8 = sub_43A2C(v3, 0x15180u);
    v6 = &v23 + snprintf2(&v23, 64, "%d %s ", v8, v7);
  }
  sub_43AD4(v3, 0x15180u);
  v10 = v9;
  v11 = sub_134F4(381, v9);
  v12 = sub_43A2C(v10, 0xE10u);
  v13 = (int)&v6[snprintf2(v6, 64, "%d %s ", v12, v11)];
  sub_43AD4(v10, 0xE10u);
  v15 = v14;
  v16 = sub_134F4(530, v14);
  v17 = sub_43A2C(v15, 0x3Cu);
  v18 = snprintf2(v13, 64, "%d %s ", v17, v16);
  v20 = sub_134F4(878, v19);
  sub_43AD4(v15, 0x3Cu);
  snprintf2(v13 + v18, 64, "%d %s ", v21, v20);
  sf_strncpy(v4, &v23, v5);
  return 1;
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);

//----- (000121A0) --------------------------------------------------------
int __fastcall sub_121A0(int a1, const char *a2, int a3)
{
  const char *v3; // r6@1
  int v4; // r7@1
  int v5; // r8@1
  const char *v6; // r0@4
  int *v7; // r12@4
  const char *v8; // r1@4
  int v9; // r5@8
  int v10; // r4@9
  int v11; // r1@9
  int v12; // r0@12
  bool v13; // zf@12
  int result; // r0@12
  int *v15; // [sp+Ch] [bp-34h]@0
  char v16; // [sp+10h] [bp-30h]@11
  int v17; // [sp+24h] [bp-1Ch]@4

  v3 = a2;
  v4 = a1;
  v5 = a3;
  if ( !a2 || !*a2 )
    goto LABEL_8;
  if ( strchr(a2, 58) )
  {
    v6 = v3;
    v7 = &v17;
    v8 = "%02X:%02X:%02X:%02X:%02X:%02X";
LABEL_7:
    v15 = v7;
    sscanf(v6, v8);
    goto LABEL_8;
  }
  if ( strchr(v3, 45) )
  {
    v8 = "%02X-%02X-%02X-%02X-%02X-%02X";
    v6 = v3;
    v7 = &v17;
    goto LABEL_7;
  }
LABEL_8:
  v9 = 0;
  do
  {
    v10 = v9 + 1;
    printf(
      "<input type=text name='%s%d' size=2 maxlength=2 style=\"width:18pt; ime-mode: disabled;\" class=\"navi_text\" onfocus='this.select();' onkeypress=\"return HWKeyDown('%s',%d);\" onkeyup=\"HWKeyUp('%s',%d);\"",
      v4,
      v9 + 1,
      v4,
      v9 + 1,
      v4,
      v9 + 1,
      v15);
    if ( v3 && *v3 )
      printf("value='%02X' ", *((_DWORD *)&v16 + v9));
    v12 = sub_134F4(512, v11);
    printf("title=\"%s%d\"", v12, v9 + 1);
    putchar(62);
    v13 = v9 == 5;
    result = 45;
    ++v9;
    if ( !v13 )
      result = putchar(45);
  }
  while ( v10 != 6 );
  if ( v5 )
    result = printf((const char *)&unk_468B6, v4);
  return result;
}

//----- (0001236C) --------------------------------------------------------
int __fastcall sub_1236C(int a1, int a2)
{
  return get_file_string("/home/httpd/build_date", a1, a2);
}
// EDC8: using guessed type int __fastcall get_file_string(_DWORD, _DWORD, _DWORD);

//----- (00012380) --------------------------------------------------------
signed int sub_12380()
{
  signed int result; // r0@2
  int v1; // r1@3
  int v2; // r0@3
  int v3; // r0@3

  if ( sysconf_nat_get(1) )
  {
    result = 0;
  }
  else
  {
    print_start_main_table(0);
    v2 = sub_134F4(569, v1);
    v3 = sub_115F8(v2);
    print_end_main_table(v3);
    result = 1;
  }
  return result;
}
// F2A8: using guessed type int __fastcall print_start_main_table(_DWORD);
// F494: using guessed type int __fastcall sysconf_nat_get(_DWORD);
// F5F0: using guessed type int __fastcall print_end_main_table(_DWORD);

//----- (00012418) --------------------------------------------------------
int __fastcall sub_12418(int a1)
{
  int v1; // r0@1
  int v3; // [sp+0h] [bp-28h]@1

  v1 = get_value(a1, "wizardsave", &v3, 32);
  if ( v1 )
    saveconf(v1);
  printf("<script>");
  printf("self.close();");
  printf("parent.opener.focus();");
  return printf("</script>");
}
// F110: using guessed type int __fastcall saveconf(_DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (000124D8) --------------------------------------------------------
int __fastcall sub_124D8(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r4@1
  int v4; // r0@1
  int v5; // r0@2
  int v6; // r0@4

  v2 = a2;
  v3 = a1;
  str(a1);
  puts("<td height=40px class=wizardtop_td valign=top>");
  v4 = printf("<b>%s</b><br>", v3);
  if ( v2 )
    v5 = printf("%s<br>", v2);
  else
    v5 = br(v4);
  br(v5);
  v6 = printf("</td>");
  return etr(v6);
}
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F788: using guessed type int __fastcall br(_DWORD);

//----- (0001253C) --------------------------------------------------------
int __fastcall sub_1253C(int a1)
{
  int v1; // r4@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r4@1
  int v7; // r1@1
  int v8; // r0@1
  int v9; // r0@1
  char v11; // [sp+8h] [bp-340h]@1
  char v12; // [sp+108h] [bp-240h]@1
  char dest; // [sp+208h] [bp-140h]@1
  char v14; // [sp+288h] [bp-C0h]@1
  char v15; // [sp+2C8h] [bp-80h]@1
  char v16; // [sp+308h] [bp-40h]@1

  v1 = a1;
  strcpy(&dest, "");
  get_value(v1, "tmenu", &v15, 64);
  get_value(v1, "nextstep", &v14, 64);
  get_value(v1, "ifname", &v16, 32);
  v3 = sub_134F4(1290, v2);
  v4 = sub_124D8(v3, 0);
  str(v4);
  puts("<td height=260px class=wizardbody_td>");
  snprintf2(&v12, 256, "timepro.cgi?tmenu=%s&step=%s&savesave=1&ifname=%s", &v15, &v14, &v16);
  get_value(v1, "commit", &dest, 128);
  v6 = sub_134F4(1288, v5);
  v8 = sub_134F4(1289, v7);
  snprintf2(&v11, 256, "%s<br>%s", v6, v8);
  print_html_apply_wait(&v11, 3, &v12);
  v9 = printf("</td>");
  return etr(v9);
}
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F02C: using guessed type int __fastcall print_html_apply_wait(_DWORD, _DWORD, _DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00012678) --------------------------------------------------------
_UNKNOWN *sub_12678()
{
  snprintf2(&unk_97808, 256, "%s/%s");
  return &unk_97808;
}
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// 97804: using guessed type int dword_97804;

//----- (000126C4) --------------------------------------------------------
_UNKNOWN *sub_126C4()
{
  char *v0; // r0@2
  const char *v1; // r1@2

  if ( dword_97804 == 2 )
  {
    v0 = (char *)&unk_97908;
    v1 = "images2";
  }
  else
  {
    v0 = (char *)&unk_97908;
    v1 = "images";
  }
  strcpy(v0, v1);
  return &unk_97908;
}
// 97804: using guessed type int dword_97804;

//----- (00012700) --------------------------------------------------------
signed int __fastcall sub_12700(int a1)
{
  int v1; // r5@1
  int v2; // r1@2
  int v3; // r2@2
  int v4; // r3@2
  int v5; // r4@2
  int v6; // r1@2
  int v7; // r2@2
  int v8; // r3@2

  v1 = a1;
  dword_97804 = sysget_ui_version();
  if ( dword_97804 == 2 )
  {
    v2 = unk_9748C;
    v3 = unk_97490;
    v4 = unk_97494;
    *(_DWORD *)v1 = unk_97488;
    *(_DWORD *)(v1 + 4) = v2;
    *(_DWORD *)(v1 + 8) = v3;
    *(_DWORD *)(v1 + 12) = v4;
    v5 = v1 + 16;
    v6 = unk_9749C;
    v7 = unk_974A0;
    v8 = unk_974A4;
    *(_DWORD *)v5 = unk_97498;
    *(_DWORD *)(v5 + 4) = v6;
    *(_DWORD *)(v5 + 8) = v7;
    *(_DWORD *)(v5 + 12) = v8;
    *(_DWORD *)(v1 + 32) = unk_974A8;
  }
  else
  {
    puts("UI Not Specified..");
  }
  return 1;
}
// F614: using guessed type int sysget_ui_version(void);
// 97804: using guessed type int dword_97804;

//----- (00012770) --------------------------------------------------------
int __fastcall sub_12770(int a1)
{
  int result; // r0@1

  result = is_mobile_agent(a1);
  if ( result )
    result = printf("</div>");
  return result;
}
// F74C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (00012790) --------------------------------------------------------
int __fastcall sub_12790(int a1, int a2, int a3)
{
  int v3; // r4@1
  int v4; // r5@1
  int v5; // r6@1
  int v6; // r0@1
  int v7; // r1@2
  int v8; // r2@2
  int v9; // r3@2
  const char *v10; // r0@2
  int result; // r0@3

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = is_mobile_agent(a1);
  if ( v6 == 1 )
  {
    v7 = v3;
    v8 = v4;
    v9 = v5;
    v10 = "<div style=\"height:%s; width:%s; -webkit-overflow-scrolling: touch; overflow-y:scroll; overflow-x:hidden; %s\">";
  }
  else
  {
    result = is_mobile_agent(v6);
    if ( result != 2 )
      return result;
    v10 = "<div style=\"height:%s; width:%s; -webkit-overflow-scrolling: touch; overflow-y:hidden; overflow-x:hidden; %s\">";
    v7 = v3;
    v8 = v4;
    v9 = v5;
  }
  return printf(v10, v7, v8, v9);
}
// F74C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (000127E8) --------------------------------------------------------
signed int __fastcall sub_127E8(const char *a1)
{
  const char *v1; // r4@1
  signed int result; // r0@3

  v1 = a1;
  if ( !strcmp(a1, "Jan") )
    goto LABEL_27;
  if ( !strcmp(v1, "Feb") )
    return 2;
  if ( !strcmp(v1, "Mar") )
    return 3;
  if ( !strcmp(v1, "Apr") )
    return 4;
  if ( !strcmp(v1, "May") )
    return 5;
  if ( !strcmp(v1, "Jun") )
    return 6;
  if ( !strcmp(v1, "Jul") )
    return 7;
  if ( !strcmp(v1, "Aug") )
    return 8;
  if ( !strcmp(v1, "Sep") )
    return 9;
  if ( !strcmp(v1, "Oct") )
    return 10;
  if ( !strcmp(v1, "Nov") )
    return 11;
  if ( strcmp(v1, "Dec") )
LABEL_27:
    result = 1;
  else
    result = 12;
  return result;
}

//----- (00012940) --------------------------------------------------------
int __fastcall sub_12940(int a1, int a2)
{
  int result; // r0@1
  int v3; // r2@2
  int v4; // [sp+0h] [bp-10h]@1
  int v5; // [sp+4h] [bp-Ch]@1

  v4 = a1;
  v5 = a2;
  get_ux_lang((char *)&v4 + 3);
  result = strcmp((const char *)&v4 + 3, "kr");
  if ( result )
  {
    result = strcmp((const char *)&v4 + 3, "en");
    if ( result )
      return result;
    v3 = (int)off_94870;
  }
  else
  {
    v3 = (int)off_947F8;
  }
  dword_97928 = v3;
  return result;
}
// FBF0: using guessed type int __fastcall get_ux_lang(_DWORD);
// 947F8: using guessed type char *off_947F8[2];
// 94870: using guessed type char *off_94870[20];
// 97928: using guessed type int dword_97928;

//----- (000129A0) --------------------------------------------------------
int __fastcall sub_129A0(int a1, int a2)
{
  int v2; // r4@1

  v2 = a1;
  if ( !dword_97928 )
    sub_12940(a1, a2);
  return *(_DWORD *)(dword_97928 + 4 * v2);
}
// 97928: using guessed type int dword_97928;

//----- (000129D0) --------------------------------------------------------
int __fastcall sub_129D0(const char *a1)
{
  const char *v1; // r4@1
  int v2; // r1@1
  int v3; // r0@2

  v1 = a1;
  if ( !strcmp(a1, "Sun") )
  {
    v3 = 22;
  }
  else if ( !strcmp(v1, "Mon") )
  {
    v3 = 14;
  }
  else if ( !strcmp(v1, "Tue") )
  {
    v3 = 26;
  }
  else if ( !strcmp(v1, "Wed") )
  {
    v3 = 28;
  }
  else if ( !strcmp(v1, "Thu") )
  {
    v3 = 23;
  }
  else if ( !strcmp(v1, "Fri") )
  {
    v3 = 5;
  }
  else if ( !strcmp(v1, "Sat") )
  {
    v3 = 18;
  }
  else
  {
    v3 = 22;
  }
  return sub_129A0(v3, v2);
}

//----- (00012AA0) --------------------------------------------------------
int __fastcall sub_12AA0(const char *a1)
{
  const char *v1; // r4@1
  int v2; // r1@1
  signed int v3; // r0@2

  v1 = a1;
  if ( !strcmp(a1, "Jan") )
  {
    v3 = 7;
  }
  else if ( !strcmp(v1, "Feb") )
  {
    v3 = 4;
  }
  else if ( !strcmp(v1, "Mar") )
  {
    v3 = 10;
  }
  else
  {
    v3 = strcmp(v1, "Apr");
    if ( v3 )
    {
      if ( !strcmp(v1, "May") )
      {
        v3 = 11;
      }
      else if ( !strcmp(v1, "Jun") )
      {
        v3 = 9;
      }
      else if ( !strcmp(v1, "Jul") )
      {
        v3 = 8;
      }
      else if ( !strcmp(v1, "Aug") )
      {
        v3 = 1;
      }
      else if ( !strcmp(v1, "Sep") )
      {
        v3 = 21;
      }
      else if ( !strcmp(v1, "Oct") )
      {
        v3 = 17;
      }
      else if ( !strcmp(v1, "Nov") )
      {
        v3 = 16;
      }
      else if ( !strcmp(v1, "Dec") )
      {
        v3 = 3;
      }
      else
      {
        v3 = 7;
      }
    }
  }
  return sub_129A0(v3, v2);
}

//----- (00012BF8) --------------------------------------------------------
_UNKNOWN *__fastcall sub_12BF8(int a1, int a2)
{
  int v2; // r5@1
  char *v3; // r0@1
  int v4; // r1@1
  signed int v5; // r0@3
  const char *v6; // r2@3
  int v7; // r3@3
  int v8; // r12@3
  int v9; // r1@5
  int v10; // r0@5
  int v11; // r1@5
  int v12; // r11@5
  int v13; // r1@5
  int v14; // r1@5
  int v15; // r9@5
  int v16; // r0@6
  int v17; // r10@8
  int v18; // r1@8
  int v19; // r8@8
  int v20; // r0@8
  int v21; // r6@8
  int v22; // r7@8
  int v23; // r1@8
  int v24; // r0@8
  int v25; // r4@8
  int v26; // r5@8
  int v27; // r1@8
  int v28; // r0@8
  int v29; // r3@8
  const char *v30; // r2@8
  int v31; // ST50_4@9
  signed int v32; // ST54_4@9
  int v33; // r1@9
  int v34; // r0@9
  int v35; // ST60_4@9
  int v36; // ST58_4@9
  int v37; // r1@9
  int v38; // r11@9
  int v39; // r9@9
  int v40; // r1@9
  int v41; // r0@9
  int v42; // r8@9
  int v43; // r10@9
  int v44; // r1@9
  int v45; // r0@9
  int v46; // r6@9
  int v47; // r7@9
  int v48; // r1@9
  int v49; // r0@9
  int v50; // r4@9
  int v51; // r5@9
  int v52; // r1@9
  int v53; // r0@9
  int v54; // r1@15
  int v55; // r0@16
  int v56; // r8@16
  int v57; // r11@16
  int v58; // r0@16
  int v59; // r1@16
  int v60; // r4@16
  int v61; // r9@16
  int v62; // r10@16
  int v63; // r7@16
  int v64; // r0@17
  int v65; // r5@19
  int v66; // r1@19
  int v67; // r3@19
  const char *v68; // r2@19
  int v69; // r0@20
  int v70; // r8@20
  int v71; // r11@20
  int v72; // r0@20
  int v73; // r1@20
  int v74; // r4@20
  int v75; // r7@20
  int v76; // r0@21
  int v77; // r0@26
  int v78; // r5@26
  int v79; // r4@26
  int v80; // r0@26
  int v81; // r0@27
  int v82; // r4@27
  int v84; // [sp+0h] [bp-140h]@8
  signed int v85; // [sp+0h] [bp-140h]@13
  int v86; // [sp+0h] [bp-140h]@19
  signed int v87; // [sp+4h] [bp-13Ch]@8
  int v88; // [sp+4h] [bp-13Ch]@13
  int v89; // [sp+4h] [bp-13Ch]@19
  int v90; // [sp+8h] [bp-138h]@8
  int v91; // [sp+8h] [bp-138h]@13
  int v92; // [sp+8h] [bp-138h]@19
  int v93; // [sp+Ch] [bp-134h]@8
  int v94; // [sp+Ch] [bp-134h]@13
  int v95; // [sp+10h] [bp-130h]@8
  int v96; // [sp+10h] [bp-130h]@13
  int v97; // [sp+14h] [bp-12Ch]@0
  int v98; // [sp+14h] [bp-12Ch]@8
  int v99; // [sp+18h] [bp-128h]@8
  int v100; // [sp+1Ch] [bp-124h]@8
  int v101; // [sp+20h] [bp-120h]@8
  int v102; // [sp+24h] [bp-11Ch]@8
  int v103; // [sp+28h] [bp-118h]@8
  int v104; // [sp+2Ch] [bp-114h]@8
  int v105; // [sp+30h] [bp-110h]@8
  int v106; // [sp+34h] [bp-10Ch]@0
  int v107; // [sp+3Ch] [bp-104h]@4
  int v108; // [sp+40h] [bp-100h]@5
  signed int v109; // [sp+44h] [bp-FCh]@5
  int v110; // [sp+48h] [bp-F8h]@5
  int v111; // [sp+4Ch] [bp-F4h]@5
  int v112; // [sp+5Ch] [bp-E4h]@5
  int v113; // [sp+64h] [bp-DCh]@1
  char v114; // [sp+6Fh] [bp-D1h]@1
  char v115; // [sp+EFh] [bp-51h]@1
  char v116; // [sp+F7h] [bp-49h]@1
  char v117; // [sp+FFh] [bp-41h]@1
  int v118; // [sp+104h] [bp-3Ch]@1
  int v119; // [sp+108h] [bp-38h]@1
  int v120; // [sp+10Ch] [bp-34h]@1
  int v121; // [sp+110h] [bp-30h]@1
  int v122; // [sp+114h] [bp-2Ch]@1

  v113 = a1;
  v2 = a2;
  v3 = ctime((const time_t *)&v113);
  snprintf2(&v114, 128, "%s", v3);
  sscanf(&v114, "%s %s %d %d:%d:%d %d", &v116, &v115, &v121, &v120, &v119, &v118, &v122);
  get_ux_lang(&v117);
  if ( !strcmp(&v117, "kr") )
  {
    if ( v2 == 1 )
    {
      v5 = sub_127E8(&v115);
      v6 = "%4d-%02d-%02d %02d:%02d:%02d";
      v7 = v122;
      v8 = v121;
LABEL_13:
      v88 = v8;
      v91 = v120;
      v94 = v119;
      v96 = v118;
      v85 = v5;
LABEL_29:
      snprintf2(&unk_9792C, 128, v6, v7, v85, v88, v91, v94, v96, v97);
      return &unk_9792C;
    }
    v107 = v122;
    if ( v2 == 2 )
    {
      v108 = sub_129A0(29, v4);
      v109 = sub_127E8(&v115);
      v10 = sub_129A0(13, v9);
      v112 = v121;
      v110 = v10;
      v111 = sub_129A0(2, v11);
      v12 = sub_129D0(&v116);
      v15 = sub_129A0(27, v13);
      if ( v120 <= 11 )
        v16 = 24;
      else
        v16 = 25;
      v17 = sub_129A0(v16, v14);
      sub_43BD0(v120, 0xCu);
      v19 = v18;
      v20 = sub_129A0(6, v18);
      v21 = v119;
      v22 = v20;
      v24 = sub_129A0(12, v23);
      v25 = v118;
      v26 = v24;
      v28 = sub_129A0(19, v27);
      v84 = v108;
      v87 = v109;
      v90 = v110;
      v93 = v112;
      v29 = v107;
      v30 = "%d%s %d%s %d%s %s%s %s %d%s %d%s %d%s";
      v95 = v111;
      v98 = v12;
      v99 = v15;
      v100 = v17;
      v101 = v19;
      v102 = v22;
      v103 = v21;
      v104 = v26;
      v105 = v25;
      v106 = v28;
    }
    else
    {
      v31 = sub_129A0(29, v4);
      v32 = sub_127E8(&v115);
      v34 = sub_129A0(13, v33);
      v35 = v121;
      v36 = v34;
      v38 = sub_129A0(2, v37);
      v39 = sub_129D0(&v116);
      v41 = sub_129A0(27, v40);
      v42 = v120;
      v43 = v41;
      v45 = sub_129A0(6, v44);
      v46 = v119;
      v47 = v45;
      v49 = sub_129A0(12, v48);
      v50 = v118;
      v51 = v49;
      v53 = sub_129A0(20, v52);
      v84 = v31;
      v87 = v32;
      v29 = v107;
      v30 = "%d%s %d%s %d%s %s%s %d%s %d%s %d%s";
      v90 = v36;
      v93 = v35;
      v95 = v38;
      v98 = v39;
      v99 = v43;
      v100 = v42;
      v101 = v47;
      v102 = v46;
      v103 = v51;
      v104 = v50;
      v105 = v53;
    }
    snprintf2(&unk_9792C, 128, v30, v29, v84, v87, v90, v93, v95, v98, v99, v100, v101, v102, v103, v104, v105, v106);
  }
  else
  {
    if ( v2 == 1 )
    {
      v5 = sub_127E8(&v115);
      v6 = "%02d-%02d-%4d %02d:%02d:%02d";
      v7 = v121;
      v8 = v122;
      goto LABEL_13;
    }
    if ( v2 != 2 )
    {
      if ( !strcmp(&v117, "pt") )
      {
        v77 = sub_129D0(&v116);
        v78 = v121;
        v79 = v77;
        v80 = sub_12AA0(&v115);
        v7 = v79;
        v6 = "%s, %d %s de %4d, %02d:%02d:%02d";
      }
      else
      {
        v81 = sub_129D0(&v116);
        v78 = v121;
        v82 = v81;
        v80 = sub_12AA0(&v115);
        v6 = "%s, %d %s %4d, %02d:%02d:%02d";
        v7 = v82;
      }
      v91 = v122;
      v94 = v120;
      v96 = v119;
      v85 = v78;
      v97 = v118;
      v88 = v80;
      goto LABEL_29;
    }
    sub_43BD0(v120, 0xCu);
    v120 = v54;
    if ( !strcmp(&v117, "pt") )
    {
      v55 = sub_129D0(&v116);
      v56 = v121;
      v57 = v55;
      v58 = sub_12AA0(&v115);
      v60 = v120;
      v61 = v119;
      v62 = v118;
      v63 = v58;
      if ( v120 <= 11 )
        v64 = 24;
      else
        v64 = 25;
      v86 = v56;
      v89 = v63;
      v92 = v122;
      v65 = sub_129A0(v64, v59);
      sub_43BD0(v60, 0xCu);
      v67 = v57;
      v68 = "%s, %d %s de %4d, %02d:%02d:%02d %s";
    }
    else
    {
      v69 = sub_129D0(&v116);
      v70 = v121;
      v71 = v69;
      v72 = sub_12AA0(&v115);
      v74 = v120;
      v61 = v119;
      v62 = v118;
      v75 = v72;
      if ( v120 <= 11 )
        v76 = 24;
      else
        v76 = 25;
      v86 = v70;
      v89 = v75;
      v92 = v122;
      v65 = sub_129A0(v76, v73);
      sub_43BD0(v74, 0xCu);
      v68 = "%s, %d %s %4d, %02d:%02d:%02d %s";
      v67 = v71;
    }
    snprintf2(&unk_9792C, 128, v68, v67, v86, v89, v92, v66, v61, v62, v65);
  }
  return &unk_9792C;
}
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// FBF0: using guessed type int __fastcall get_ux_lang(_DWORD);

//----- (000130BC) --------------------------------------------------------
signed int __fastcall sub_130BC(char *a1, time_t a2)
{
  char *v2; // r5@1
  time_t v3; // r6@1
  int v4; // r1@1
  int v5; // r0@2
  signed int result; // r0@2
  _UNKNOWN *v7; // r0@3
  time_t timer; // [sp+4h] [bp-14h]@1

  timer = a2;
  v2 = a1;
  v3 = a2;
  if ( get_timed_status(a1) )
  {
    time(&timer);
    v7 = sub_12BF8(timer, 0);
    sf_strncpy(v2, v7, v3);
    result = 1;
  }
  else
  {
    v5 = sub_129A0(15, v4);
    strcpy(v2, (const char *)v5);
    result = 0;
  }
  return result;
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// FE84: using guessed type int __cdecl get_timed_status(_DWORD);

//----- (0001311C) --------------------------------------------------------
int __fastcall sub_1311C(const char *a1)
{
  const char *v1; // r6@1
  int v2; // r5@1
  int v3; // r0@2
  int result; // r0@3
  int v5; // [sp+0h] [bp-78h]@2

  v1 = a1;
  v2 = 0;
  do
  {
    memset(&v5, 0, 0x68u);
    v3 = pptpserver_get_index_pptpinfo(v2++, &v5);
    if ( !v3 )
      break;
    result = strcmp((const char *)&v5, v1);
    if ( !result )
      return result;
  }
  while ( v2 != 5 );
  return 1;
}
// F1D0: using guessed type int __fastcall pptpserver_get_index_pptpinfo(_DWORD, _DWORD);

//----- (00013180) --------------------------------------------------------
signed int __fastcall sub_13180(const char *a1)
{
  const char *v1; // r4@1
  size_t v2; // r0@1
  signed int v3; // r12@1
  unsigned int v4; // r1@2
  int v5; // r3@2
  bool v6; // cf@2
  bool v7; // zf@2
  int v8; // lr@4
  bool v9; // cf@6
  bool v10; // zf@6

  v1 = a1;
  v2 = strlen(a1);
  v3 = 0;
  while ( v3 < (signed int)v2 )
  {
    v4 = v1[v3++];
    v5 = v4 - 65;
    v6 = v4 - 97 >= 0x19;
    v7 = v4 == 122;
    if ( v4 - 97 > 0x19 )
    {
      v6 = (unsigned int)v5 >= 0x19;
      v7 = v5 == 25;
    }
    v8 = v4 - 48;
    if ( !v7 && v6 )
    {
      v9 = v4 >= 0x2E;
      v10 = v4 == 46;
      if ( v4 != 46 )
      {
        v9 = (unsigned int)v8 >= 9;
        v10 = v8 == 9;
      }
      if ( !v10 && v9 && v4 != 45 )
        return 0;
    }
  }
  return 1;
}

//----- (000131E0) --------------------------------------------------------
signed int __fastcall sub_131E0(void *a1)
{
  void *v1; // r6@1
  int v2; // r4@1
  int v3; // r0@2
  signed int result; // r0@5
  int v5; // [sp+0h] [bp-510h]@2
  char s2; // [sp+4h] [bp-50Ch]@3

  v1 = a1;
  v2 = 0;
  while ( 1 )
  {
    v3 = ddnsapi_read_config(v2++, &v5);
    if ( !v3 )
      return 0;
    if ( !strcmp("iptime", &s2) )
      break;
    if ( v2 == 6 )
      return 0;
  }
  if ( v1 )
  {
    memcpy(v1, &v5, 0x500u);
    result = 1;
  }
  else
  {
    result = 1;
  }
  return result;
}
// EF54: using guessed type int __fastcall ddnsapi_read_config(_DWORD, _DWORD);

//----- (0001325C) --------------------------------------------------------
int __fastcall sub_1325C(int a1, const char *a2)
{
  const char *v2; // r4@1
  int result; // r0@1
  int v4; // r0@2
  bool v5; // cf@2
  char v6; // [sp+4h] [bp-24h]@2

  v2 = a2;
  result = get_captcha();
  if ( result )
  {
    v4 = strcmp(&v6, v2);
    v5 = (unsigned int)v4 <= 1;
    result = 1 - v4;
    if ( !v5 )
      result = 0;
  }
  return result;
}
// ECA8: using guessed type int get_captcha(void);

//----- (00013298) --------------------------------------------------------
signed int __fastcall sub_13298(int a1)
{
  int v1; // r4@1
  int v2; // r4@3
  signed int result; // r0@6
  char v4; // [sp+0h] [bp-D0h]@1
  unsigned __int8 v5; // [sp+80h] [bp-50h]@1

  v1 = a1;
  strcpy(&v4, "");
  strcpy((char *)&v5, "");
  if ( get_value_post(v1, "captcha_file", &v4, 63) && v4 )
  {
    v2 = get_value_post(v1, "captcha_code", &v5, 64);
    if ( v2 && (v2 = v5) != 0 && (v2 = sub_1325C((int)&v4, (const char *)&v5)) != 0 )
    {
      remove_captcha(&v4);
      result = 1;
    }
    else
    {
      remove_captcha(&v4);
      result = v2;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// FEC0: using guessed type int __fastcall remove_captcha(_DWORD);

//----- (000133E4) --------------------------------------------------------
int __fastcall sub_133E4(int a1, int a2)
{
  int v2; // r6@1
  int v3; // r5@1
  int v4; // r2@2
  char v6; // [sp+8h] [bp-60h]@4
  char v7; // [sp+48h] [bp-20h]@1

  v2 = a2;
  v3 = a1;
  get_ux_lang(&v7);
  if ( v2 )
    v4 = (int)"/home/httpd/js/%s/%s_%s.lang.js";
  else
    v4 = (int)"/home/httpd/js/%s/%s.js";
  ((void (__fastcall *)(char *, signed int, int, char *))snprintf2)(&v6, 64, v4, &v7);
  print_file(&v6);
  if ( v2 )
    ((void (__fastcall *)(char *, signed int, _DWORD, int))snprintf2)(&v6, 64, "/home/httpd/js/%s_%s.js", v3);
  else
    snprintf2(&v6, 64, "/home/httpd/js/%s.js", v3);
  return print_file(&v6);
}
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// FBF0: using guessed type int __fastcall get_ux_lang(_DWORD);
// FE0C: using guessed type int __fastcall print_file(_DWORD);

//----- (00013494) --------------------------------------------------------
int __fastcall sub_13494(int a1, int a2)
{
  int result; // r0@1
  int v3; // r2@2
  int v4; // [sp+0h] [bp-10h]@1
  int v5; // [sp+4h] [bp-Ch]@1

  v4 = a1;
  v5 = a2;
  get_ux_lang((char *)&v4 + 3);
  result = strcmp((const char *)&v4 + 3, "kr");
  if ( result )
  {
    result = strcmp((const char *)&v4 + 3, "en");
    if ( result )
      return result;
    v3 = (int)off_95EB8;
  }
  else
  {
    v3 = (int)off_948E8;
  }
  dword_979AC = v3;
  return result;
}
// FBF0: using guessed type int __fastcall get_ux_lang(_DWORD);
// 948E8: using guessed type char *off_948E8[3];
// 95EB8: using guessed type char *off_95EB8[11];
// 979AC: using guessed type int dword_979AC;

//----- (000134F4) --------------------------------------------------------
int __fastcall sub_134F4(int a1, int a2)
{
  int v2; // r4@1

  v2 = a1;
  if ( !dword_979AC )
    sub_13494(a1, a2);
  return *(_DWORD *)(dword_979AC + 4 * v2);
}
// 979AC: using guessed type int dword_979AC;

//----- (00014380) --------------------------------------------------------
signed int __fastcall sub_14380(signed int result, int a2, int a3, int a4, int a5, int a6, int a7)
{
  int v7; // r4@1
  int *v8; // r2@2

  v7 = a3;
  if ( result <= 98 )
  {
    v8 = &dword_979B0[7 * result];
    *v8 = a2;
    v8[1] = v7;
    v8[2] = a4;
    v8[5] = a7;
    v8[3] = a5;
    v8[4] = a6;
  }
  return result;
}
// 979B0: using guessed type int dword_979B0[];

//----- (000143D4) --------------------------------------------------------
void __fastcall sub_143D4(int a1, int a2)
{
  signed int v2; // r5@1
  int v3; // r4@2
  int v4; // r1@2
  int v5; // r0@2
  int v6; // r1@2
  int v7; // r4@2
  int v8; // r1@2
  int v9; // r0@2
  int v10; // r1@2
  int v11; // r4@2
  int v12; // r1@2
  int v13; // r0@2
  int v14; // r1@2
  int v15; // r4@2
  int v16; // r1@2
  int v17; // r0@2
  int v18; // r1@2
  int v19; // r4@2
  int v20; // r1@2
  int v21; // r0@2
  int v22; // r1@2
  int v23; // r4@2
  int v24; // r1@2
  int v25; // r0@2
  int v26; // r1@2
  int v27; // r4@2
  int v28; // r1@2
  int v29; // r0@2
  int v30; // r1@2
  int v31; // r4@2
  int v32; // r1@2
  int v33; // r0@2
  int v34; // r1@2
  int v35; // r4@2
  int v36; // r1@2
  int v37; // r0@2
  int v38; // r1@2
  int v39; // r4@2
  int v40; // r1@2
  int v41; // r0@2
  int v42; // r1@2
  int v43; // r4@2
  int v44; // r1@2
  int v45; // r0@2
  int v46; // r1@2
  int v47; // r4@2
  int v48; // r1@2
  int v49; // r0@2
  int v50; // r1@2
  int v51; // r4@2
  int v52; // r1@2
  int v53; // r0@2
  int v54; // r1@2
  int v55; // r4@2
  int v56; // r1@2
  int v57; // r0@2
  int v58; // r1@2
  int v59; // r4@2
  int v60; // r1@2
  int v61; // r0@2
  int v62; // r1@2
  int v63; // r4@2
  int v64; // r1@2
  int v65; // r0@2
  int v66; // r1@2
  int v67; // r4@2
  int v68; // r1@2
  int v69; // r0@2
  int v70; // r1@2
  int v71; // r4@2
  int v72; // r1@2
  int v73; // r0@2
  int v74; // r1@2
  int v75; // r4@2
  int v76; // r1@2
  int v77; // r0@2
  int v78; // r1@2
  int v79; // r4@2
  int v80; // r1@2
  int v81; // r0@2
  int v82; // r1@2
  int v83; // r4@2
  int v84; // r1@2
  int v85; // r0@2
  int v86; // r1@2
  int v87; // r4@2
  int v88; // r1@2
  int v89; // r0@2
  int v90; // r1@2
  int v91; // r4@2
  int v92; // r1@2
  int v93; // r0@2
  int v94; // r1@2
  int v95; // r4@2
  int v96; // r1@2
  int v97; // r0@2
  int v98; // r1@2
  int v99; // r4@2
  int v100; // r1@2
  int v101; // r0@2
  int v102; // r1@2
  int v103; // r4@2
  int v104; // r1@2
  int v105; // r0@2
  int v106; // r1@2
  int v107; // r4@2
  int v108; // r1@2
  int v109; // r0@2
  int v110; // r1@2
  int v111; // r4@2
  int v112; // r1@2
  int v113; // r0@2
  int v114; // r1@2
  int v115; // r4@2
  int v116; // r1@2
  int v117; // r0@2

  v2 = dword_979B0[0];
  if ( !dword_979B0[0] )
  {
    v3 = sub_134F4(629, a2);
    v5 = sub_134F4(607, v4);
    sub_14380(v2, (int)"system", (int)"info", v3, v5, (int)sub_159C0, v2);
    v7 = sub_134F4(629, v6);
    v9 = sub_134F4(734, v8);
    sub_14380(1, (int)"netconf", (int)"wansetup", v7, v9, (int)sub_20A4C, v2);
    v11 = sub_134F4(629, v10);
    v13 = sub_134F4(593, v12);
    sub_14380(2, (int)"netconf", (int)"lansetup", v11, v13, (int)sub_176E0, v2);
    v15 = sub_134F4(628, v14);
    v17 = sub_134F4(589, v16);
    sub_14380(3, (int)"natrouterconf", (int)"portforward", v15, v17, (int)sub_25B30, v2);
    v19 = sub_134F4(628, v18);
    v21 = sub_134F4(588, v20);
    sub_14380(4, (int)"natrouterconf", (int)"misc", v19, v21, (int)sub_2923C, v2);
    v23 = sub_134F4(628, v22);
    v25 = sub_134F4(591, v24);
    sub_14380(5, (int)"natrouterconf", (int)"router", v23, v25, (int)sub_28268, v2);
    v27 = sub_134F4(627, v26);
    v29 = sub_134F4(584, v28);
    sub_14380(6, (int)"firewallconf", (int)"firewall", v27, v29, (int)sub_2C4BC, (int)sub_2C4C4);
    v31 = sub_134F4(627, v30);
    v33 = sub_134F4(586, v32);
    sub_14380(7, (int)"firewallconf", (int)"netdetect", v31, v33, (int)sub_3810C, v2);
    v35 = sub_134F4(627, v34);
    v37 = sub_134F4(599, v36);
    sub_14380(8, (int)"firewallconf", (int)"accesslist", v35, v37, (int)sub_2F594, v2);
    v39 = sub_134F4(627, v38);
    v41 = sub_134F4(587, v40);
    sub_14380(9, (int)"firewallconf", (int)"plantynet", v39, v41, (int)sub_43A14, v2);
    v43 = sub_134F4(626, v42);
    v45 = sub_134F4(581, v44);
    sub_14380(10, (int)"expertconf", (int)"pptpvpn", v43, v45, (int)sub_3B1D8, v2);
    v47 = sub_134F4(626, v46);
    v49 = sub_134F4(577, v48);
    sub_14380(11, (int)"expertconf", (int)"ddns", v47, v49, (int)sub_3A3D0, v2);
    v51 = sub_134F4(626, v50);
    v53 = sub_134F4(582, v52);
    sub_14380(12, (int)"expertconf", (int)"remotepc", v51, v53, (int)sub_38FDC, v2);
    v55 = sub_134F4(626, v54);
    v57 = sub_134F4(578, v56);
    sub_14380(13, (int)"expertconf", (int)"hostscan", v55, v57, (int)sub_23AF4, v2);
    v59 = sub_134F4(626, v58);
    v61 = sub_134F4(576, v60);
    sub_14380(14, (int)"expertconf", (int)"advertise", v59, v61, (int)sub_3F0D0, v2);
    v63 = sub_134F4(626, v62);
    v65 = sub_134F4(579, v64);
    sub_14380(15, (int)"expertconf", (int)"iptv", v63, v65, (int)sub_4096C, v2);
    v67 = sub_134F4(632, v66);
    v69 = sub_134F4(614, v68);
    sub_14380(16, (int)"trafficconf", (int)"qos", v67, v69, (int)sub_31B48, v2);
    v71 = sub_134F4(632, v70);
    v73 = sub_134F4(610, v72);
    sub_14380(17, (int)"trafficconf", (int)"conninfo", v71, v73, (int)sub_34C54, v2);
    v75 = sub_134F4(632, v74);
    v77 = sub_134F4(609, v76);
    sub_14380(18, (int)"trafficconf", (int)"connctrl", v75, v77, (int)sub_35910, v2);
    v79 = sub_134F4(632, v78);
    v81 = sub_134F4(611, v80);
    sub_14380(19, (int)"trafficconf", (int)"linksetup", v79, v81, (int)sub_36F0C, v2);
    v83 = sub_134F4(632, v82);
    v85 = sub_134F4(612, v84);
    sub_14380(20, (int)"trafficconf", (int)"linkstat", v83, v85, (int)sub_373F4, v2);
    v87 = sub_134F4(630, v86);
    v89 = sub_134F4(598, v88);
    sub_14380(21, (int)"switchconf", (int)"vlan", v87, v89, (int)sub_4182C, v2);
    v91 = sub_134F4(630, v90);
    v93 = sub_134F4(596, v92);
    sub_14380(22, (int)"switchconf", (int)"stp", v91, v93, (int)sub_423FC, v2);
    v95 = sub_134F4(630, v94);
    v97 = sub_134F4(595, v96);
    sub_14380(23, (int)"switchconf", (int)"mirroring", v95, v97, (int)sub_42884, v2);
    v99 = sub_134F4(630, v98);
    v101 = sub_134F4(597, v100);
    sub_14380(24, (int)"switchconf", (int)"trunk", v99, v101, (int)sub_4304C, v2);
    v103 = sub_134F4(631, v102);
    v105 = sub_134F4(606, v104);
    sub_14380(25, (int)"sysconf", (int)"syslog", v103, v105, (int)sub_2264C, (int)sub_225F8);
    v107 = sub_134F4(631, v106);
    v109 = sub_134F4(601, v108);
    sub_14380(26, (int)"sysconf", (int)"login", v107, v109, (int)sub_19E0C, v2);
    v111 = sub_134F4(631, v110);
    v113 = sub_134F4(605, v112);
    sub_14380(27, (int)"sysconf", (int)"swupgrade", v111, v113, (int)sub_1E5E8, v2);
    v115 = sub_134F4(631, v114);
    v117 = sub_134F4(602, v116);
    sub_14380(28, (int)"sysconf", (int)"misc", v115, v117, (int)sub_1E0A8, v2);
  }
}
// 2C4BC: using guessed type int sub_2C4BC();
// 2C4C4: using guessed type int sub_2C4C4();
// 979B0: using guessed type int dword_979B0[];

//----- (00014BD8) --------------------------------------------------------
int __fastcall sub_14BD8(int a1, int a2)
{
  int v2; // r5@1
  const char *v3; // r9@1
  const char *v4; // r10@1
  int v5; // r6@1
  int v6; // r4@3
  char *v7; // r1@4
  int v9; // [sp+0h] [bp-A0h]@4

  v2 = 0;
  v3 = (const char *)a1;
  v4 = (const char *)a2;
  v5 = 0;
  sub_143D4(a1, a2);
  while ( dword_979B0[v5] )
  {
    if ( !strcmp(v3, (const char *)dword_979B0[v5]) )
    {
      v6 = dword_979B0[v5 + 1];
      if ( !strcmp(v4, (const char *)dword_979B0[v5 + 1]) )
        return dword_979B0[7 * v2 + 5];
      sf_strncpy(&v9, v6, 128);
      v7 = strtok((char *)&v9, "&");
      if ( v7 )
      {
        if ( !strcmp(v4, v7) )
          return dword_979B0[7 * v2 + 5];
      }
    }
    ++v2;
    v5 += 7;
  }
  return dword_979B0[v5];
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 979B0: using guessed type int dword_979B0[];

//----- (00014C98) --------------------------------------------------------
int __fastcall sub_14C98(int a1, int a2)
{
  int v2; // r5@1
  const char *v3; // r9@1
  const char *v4; // r10@1
  int v5; // r6@1
  int v6; // r4@3
  char *v7; // r1@4
  int v9; // [sp+0h] [bp-A0h]@4

  v2 = 0;
  v3 = (const char *)a1;
  v4 = (const char *)a2;
  v5 = 0;
  sub_143D4(a1, a2);
  while ( dword_979B0[v5] )
  {
    if ( !strcmp(v3, (const char *)dword_979B0[v5]) )
    {
      v6 = dword_979B0[v5 + 1];
      if ( !strcmp(v4, (const char *)dword_979B0[v5 + 1]) )
        return dword_979B0[7 * v2 + 4];
      sf_strncpy(&v9, v6, 128);
      v7 = strtok((char *)&v9, "&");
      if ( v7 )
      {
        if ( !strcmp(v4, v7) )
          return dword_979B0[7 * v2 + 4];
      }
    }
    ++v2;
    v5 += 7;
  }
  return dword_979B0[v5];
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// 979B0: using guessed type int dword_979B0[];

//----- (00014D58) --------------------------------------------------------
signed int __fastcall sub_14D58(int a1, int a2, int a3)
{
  int v3; // r10@1
  const char *v4; // r8@1
  int v5; // r4@1
  const char *v6; // r3@4
  int v8; // r0@6
  int v9; // r0@6
  int v10; // r0@6
  int v11; // r0@6
  _UNKNOWN *v12; // r5@6
  signed int v13; // r4@9
  int v14; // r0@15
  int v15; // [sp+10h] [bp-130h]@1
  int v16; // [sp+14h] [bp-12Ch]@1
  char v17; // [sp+18h] [bp-128h]@6
  char v18; // [sp+58h] [bp-E8h]@6
  char v19; // [sp+98h] [bp-A8h]@6
  char v20; // [sp+D8h] [bp-68h]@6

  v3 = 0;
  v16 = a1;
  v4 = (const char *)a2;
  v15 = a3;
  v5 = 0;
  sub_143D4(a1, a2);
  while ( 1 )
  {
    v6 = (const char *)dword_979B0[v5];
    v5 += 7;
    if ( !v6 )
      return 0;
    if ( !strcmp(v4, v6) )
      break;
    ++v3;
  }
  str(0);
  puts("<td>");
  v8 = puts("<table class=\"navicontent_table\" CELLPADDING=0 CELLSPACING=0>");
  str(v8);
  sub_15674(1);
  snprintf2(&v19, 64, "%s_picon", v4);
  snprintf2(&v20, 64, "%s_setup", v4);
  snprintf2(&v17, 64, "navimenu_%s.gif", v4);
  snprintf2(&v18, 64, "%s_foldericon", v4);
  sub_15600((int)"middle_plus.gif", (int)&v19, (int)&v20, 1);
  sub_15600((int)&v17, (int)&v18, (int)"", 0);
  v9 = sub_1556C(&v20, dword_979B0[7 * v3 + 2]);
  etr(v9);
  puts("</table>");
  v10 = printf("</td>");
  v11 = etr(v10);
  str(v11);
  printf("<td id=\"%s\" style=\"display:none;\">\n", &v20);
  v12 = &unk_979BC;
  puts("<table class=\"navicontent_table\" CELLPADDING=0 CELLSPACING=0>");
  while ( *((_DWORD *)v12 - 3) )
  {
    if ( !strcmp(v4, *((const char **)v12 - 3)) )
    {
      if ( *((_DWORD *)v12 + 4) )
      {
        v13 = strcmp(v4, *((const char **)v12 + 4));
        if ( v13 )
          v13 = 1;
      }
      else
      {
        v13 = 1;
      }
      sub_156A8(v16, (int)"navimenu_detail_menu.gif", v4, *((_DWORD *)v12 - 2), *(_DWORD *)v12, v13, v15);
      if ( v13 )
        break;
    }
    v12 = (char *)v12 + 28;
  }
  puts("</table>");
  v14 = printf("</td>");
  etr(v14);
  return 1;
}
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// 979B0: using guessed type int dword_979B0[];

//----- (00014F64) --------------------------------------------------------
signed int __fastcall sub_14F64(int a1, int a2, int a3)
{
  int v3; // r4@1
  char *v4; // r9@1
  int v5; // r11@1
  int v6; // r6@1
  int v7; // r4@1
  char v9; // [sp+8h] [bp-1A8h]@2
  char v10; // [sp+88h] [bp-128h]@2
  char s1; // [sp+108h] [bp-A8h]@1

  v3 = a1;
  v4 = (char *)a2;
  v5 = a3;
  v6 = 0;
  sub_143D4(a1, a2);
  get_value(v3, "smenu", &s1, 128);
  v7 = 0;
  while ( dword_979B0[v7] )
  {
    sf_strncpy(&v9, dword_979B0[v7 + 1], 128);
    snprintf2(&v10, 128, "%s_%s", dword_979B0[v7], &v9);
    v7 += 7;
    if ( !strcmp(&s1, &v10) )
    {
      snprintf2(v4, v5, "%s", dword_979B0[7 * v6 + 3]);
      return 1;
    }
    ++v6;
  }
  strcpy(v4, "");
  return 0;
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// 979B0: using guessed type int dword_979B0[];

//----- (0001504C) --------------------------------------------------------
int sub_1504C()
{
  int v0; // r6@1
  int result; // r0@1
  int v2; // r7@1
  int v3; // r1@2
  int v4; // r5@2
  int v5; // r1@2
  int v6; // r4@2
  int v7; // r0@2

  v0 = sysget_max_config_size();
  result = sysget_config_size();
  v2 = result;
  if ( v0 )
  {
    puts("<BODY style=\"margin:0 0 0 0; background-color:transparent\">");
    printf("<TABLE CELLPADDING=0 CELLSPACING=0 border=0 width=100%% height=100%%>");
    puts("<TR><TD valign=middle align=center>");
    v4 = sub_134F4(871, v3);
    v6 = sub_134F4(870, v5);
    v7 = sub_43AF4(-100 * v2, v0);
    printf("<span style=\"color:gray;\">%s : <b>%d%%</b> %s</span>", v4, v7 + 100, v6);
    puts("</TD></TR>");
    puts("</TABLE>");
    result = puts("</BODY>");
  }
  return result;
}
// EE4C: using guessed type int sysget_config_size(void);
// FD28: using guessed type int sysget_max_config_size(void);

//----- (000150FC) --------------------------------------------------------
int __fastcall sub_150FC(int a1, int a2, int a3)
{
  int v3; // r0@1
  int v4; // r0@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r0@1
  int v9; // r0@1
  int v10; // r0@1
  int v11; // r0@1
  int v12; // r0@1
  int v14; // [sp+4h] [bp-1Ch]@1
  int v15; // [sp+8h] [bp-18h]@1

  v15 = a3;
  v14 = 0;
  get_intvalue(a1, "helpmenu", &v14);
  puts("<body bgcolor=#dedede topmargin=\"0\" leftmargin=\"0\" rightmargin=\"0\" bottommargin=\"0\" style=\"background-color:transparent\">");
  puts("<form name=navi_advance_form>");
  puts("<input type=hidden name=\"navi_advance_hidden\" value=\"none\">");
  v3 = printf("<table border=0 CELLPADDING=0 CELLSPACING=0>");
  str(v3);
  puts("<td valign=top>");
  v4 = printf("<table class=\"navicontent_table\" CELLPADDING=0 CELLSPACING=0 >\n ");
  str(v4);
  puts("<td valign=top>");
  v5 = printf("<table class=\"navicontent_table\" width=100%% CELLPADDING=0 CELLSPACING=0 >\n");
  str(v5);
  puts("<td>");
  puts("<table class=\"navicontent_table\" CELLPADDING=0 CELLSPACING=0>");
  sub_15600((int)"navimenu_plusnode.gif", (int)"advance_picon", (int)"advance_setup", 1);
  sub_15600((int)"navimenu_title_advance_setup.gif", (int)"advance_foldericon", (int)"", 0);
  v7 = sub_134F4(624, v6);
  v8 = sub_1556C("advance_setup", v7);
  etr(v8);
  puts("</table>");
  v9 = printf("</td>");
  v10 = etr(v9);
  str(v10);
  printf("<td id=\"%s\" style=\"display:none;\" >\n", "advance_setup");
  puts("<table class=\"navicontent_table\" CELLPADDING=0 CELLSPACING=0>");
  sub_14D58(3, (int)"netconf", v14);
  sub_14D58(3, (int)"natrouterconf", v14);
  sub_14D58(3, (int)"firewallconf", v14);
  sub_14D58(3, (int)"expertconf", v14);
  sub_14D58(3, (int)"trafficconf", v14);
  sub_14D58(3, (int)"switchconf", v14);
  sub_14D58(3, (int)"sysconf", v14);
  puts("</table>");
  v11 = printf("</td>");
  etr(v11);
  puts("</table>");
  v12 = printf("</td>");
  etr(v12);
  puts("</table>");
  puts("</form>");
  return puts("</body>");
}
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F440: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);

//----- (00015314) --------------------------------------------------------
int __fastcall sub_15314(int a1)
{
  _UNKNOWN *v1; // r0@1
  int v2; // r0@1
  int v3; // r0@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r0@1
  int v8; // r0@1
  int v9; // r0@1
  int v10; // r1@1
  int v11; // r0@1
  int v12; // r1@1
  int v13; // r0@1
  int v14; // r1@1
  int v15; // r0@1
  int v16; // r0@1
  int v17; // r0@1
  int v18; // r0@1
  int v20; // [sp+14h] [bp-1Ch]@1

  v20 = 0;
  get_intvalue(a1, "helpmenu", &v20);
  puts("<body bgcolor=#dedede topmargin=\"0\" leftmargin=\"0\" rightmargin=\"0\" bottommargin=\"0\" style=\"background-color:transparent\">");
  puts("<form name=navi_basic_form>");
  puts("<input type=hidden name=\"navi_basic_hidden\" value=\"none\">");
  v1 = sub_126C4();
  printf("<input type=hidden name=\"image_prefix\" value=\"/%s\">\n", v1);
  v2 = printf("<table class=\"navimaintable\" CELLPADDING=0 CELLSPACING=0 width=197 >\n ");
  str(v2);
  puts("<td valign=top>");
  v3 = printf("<table class=\"navicontent_table\" CELLPADDING=0 CELLSPACING=0 >\n ");
  str(v3);
  puts("<td>");
  printf("<table class=\"navicontent_table\" width=100%% CELLPADDING=0 CELLSPACING=0 >\n");
  v4 = print_blank_line(3, 5);
  str(v4);
  puts("<td>");
  sub_15674(1);
  sub_15600((int)"navimenu_title_basic_setup.gif", (int)"basic_foldericon", (int)"", 0);
  v6 = sub_134F4(625, v5);
  v7 = sub_1556C("basic_setup", v6);
  etr(v7);
  puts("</table>");
  v8 = printf("</td>");
  v9 = etr(v8);
  str(v9);
  printf("<td id=\"%s\">\n", "basic_setup");
  puts("<table class=\"navicontent_table\" CELLPADDING=0 CELLSPACING=0>");
  v11 = sub_134F4(607, v10);
  sub_156A8(2, (int)"system_info.gif", "system", (int)"info", v11, 0, v20);
  v13 = sub_134F4(734, v12);
  sub_156A8(2, (int)"netconf_wansetup.gif", "netconf", (int)"wansetup", v13, 0, v20);
  v15 = sub_134F4(605, v14);
  sub_156A8(2, (int)"sysconf_swupgrade.gif", "sysconf", (int)"swupgrade", v15, 1, v20);
  puts("</table>");
  v16 = printf("</td>");
  etr(v16);
  puts("</table>");
  v17 = printf("</td>");
  etr(v17);
  puts("</table>");
  v18 = printf("</td>");
  etr(v18);
  puts("</table>");
  printf("</form>");
  return printf("</body>");
}
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F440: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (0001556C) --------------------------------------------------------
int __fastcall sub_1556C(const char *a1, int a2)
{
  const char *v2; // r4@1
  int v3; // r6@1
  int v5; // [sp+0h] [bp-50h]@1

  v2 = a1;
  v3 = a2;
  snprintf2(&v5, 64, "%s_td", a1);
  printf("<td id=\"%s\">\n", &v5);
  if ( !strcmp(v2, "basic_setup") )
    printf("<span style=\"margin-left:4;\">%s</span>\n", v3);
  else
    printf(
      "<span style=\"cursor:pointer; margin-left:4;\" onclick=\"toggle('%s',%s);\" \t\t\t\tonmouseover=\"this.style.textDecoration='underline'\" \t\t\t\tonmouseout=\"this.style.textDecoration='none'\" \t\t\t\tOnFocus=this.blur(); >%s</span>\n",
      v2,
      &v5,
      v3);
  return printf("</td>");
}
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);

//----- (00015600) --------------------------------------------------------
int __fastcall sub_15600(int a1, int a2, int a3, int a4)
{
  int v4; // r5@1
  int v5; // r6@1
  _UNKNOWN *v6; // r0@2
  int result; // r0@2
  _UNKNOWN *v8; // r0@3

  v4 = a2;
  v5 = a3;
  if ( a4 )
  {
    puts("<td>");
    v6 = sub_12678();
    result = printf("<img class=navi_click_img id=\"%s\" src=\"%s\" onclick=\"toggle('%s','');\"></td>\n", v4, v6, v5);
  }
  else
  {
    puts("<td width=16>");
    v8 = sub_12678();
    result = printf("<img id=\"%s\" src=\"%s\"></td>\n", v4, v8);
  }
  return result;
}

//----- (00015674) --------------------------------------------------------
int __fastcall sub_15674(int a1)
{
  int v1; // r6@1
  int v2; // r4@1
  bool v3; // nf@3
  unsigned __int8 v4; // vf@3
  int result; // r0@3

  v1 = a1;
  v2 = 0;
  while ( 1 )
  {
    v4 = __OFSUB__(v2, v1);
    v3 = v2 - v1 < 0;
    result = (int)"<td width=%d ></td>\n";
    ++v2;
    if ( !(v3 ^ v4) )
      break;
    printf("<td width=%d ></td>\n");
  }
  return result;
}

//----- (000156A8) --------------------------------------------------------
int __fastcall sub_156A8(int a1, int a2, const char *a3, int a4, int a5, int a6, int a7)
{
  const char *v7; // r5@1
  int v8; // r4@1
  int v9; // r6@1
  int v10; // r0@1
  _UNKNOWN *v11; // r0@6
  _UNKNOWN *v12; // r0@7
  _UNKNOWN *v13; // r0@8
  const char *v14; // r0@9
  int v15; // r2@12
  const char *v16; // r0@12
  int v17; // r0@14
  char v19; // [sp+8h] [bp-120h]@1
  char v20; // [sp+88h] [bp-A0h]@1

  v7 = a3;
  v8 = a1;
  v9 = a4;
  snprintf2(&v20, 128, "%s_%s_%d_td", a3, a4, a1);
  v10 = snprintf2(&v19, 128, "%s_%s", v7, v9);
  str(v10);
  if ( v8 )
  {
    if ( v8 == 2 || !strcmp(v7, "sysconf") )
    {
      sub_15674(v8 - 1);
      puts("<td>");
    }
    else
    {
      sub_15674(v8 - 2);
      puts("<td>");
      v11 = sub_12678();
      printf("<img src=\"%s\"></td>\n", v11);
      puts("<td>");
    }
    v12 = sub_12678();
    printf("<img src=\"%s\"></td>\n", v12);
  }
  else
  {
    sub_15674(1);
  }
  puts("<td>");
  v13 = sub_12678();
  printf("<img src=\"%s\"></td>\n", v13);
  printf("<td id=\"%s\">\n", &v20);
  puts("<span style=\"margin-left:4px;\">");
  if ( a7 )
    v14 = "<a href=\"timepro.cgi?tmenu=%s&smenu=%s&helpmenu=1&mainscreen=1\"";
  else
    v14 = "<a href=\"timepro.cgi?tmenu=%s&smenu=%s\"";
  printf(v14, v7, v9);
  printf(" target=\"main\"  OnFocus=this.blur(); ");
  if ( a7 )
  {
    v15 = (int)"menu_titlebar";
    v16 = "onclick=\"toggle_detail_help('%s'); parent.menu_title.location.href='timepro.cgi?tmenu=%s&smenu=%s&helpmenu=1'\"; >\n";
  }
  else
  {
    v16 = "onclick=\"toggle_detail('%s'); parent.menu_title.location.href='timepro.cgi?tmenu=%s&smenu=%s'\"; >\n";
    v15 = (int)"menu_titlebar";
  }
  printf(v16, &v20, v15, &v19);
  printf("%s", a5);
  v17 = printf("</span></td>");
  return etr(v17);
}
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);

//----- (0001588C) --------------------------------------------------------
int sub_1588C()
{
  printf("<style>");
  printf("#sysinfo_iframe tr { height: 23px; }");
  printf("#sysinfo_iframe td.title { border:1px solid #CCC; border-left-width: 0px; }");
  printf(".td_desc { padding: 0 10px 0px 10px; }");
  printf(".td_item { padding: 0 10px 0 10px; }");
  printf("tr.odd { background-color: #FFF; }");
  printf("tr.even { background-color: #F7F7F7; }");
  printf(".border_right { border-right: 1px solid #CCC; }");
  printf(".border_left { border-left-color: #CCC; border-left-width: 0px; border-left-style:solid; width:150px;}");
  return printf("</style>");
}

//----- (0001590C) --------------------------------------------------------
int __fastcall sub_1590C(int a1)
{
  int v1; // r4@1

  v1 = a1;
  puts("<tr><td class='title' colspan=10>");
  printf("<table width=100%% border=0 cellspacing=0 cellpadding=0>\n");
  puts("<tr class=\"even\"><td>");
  printf("<span style=\"padding-left:10px;\" class=\"subtitle_string\">%s</span></td></tr>\n", v1);
  puts("</table>");
  return puts("</td></tr>");
}

//----- (00015964) --------------------------------------------------------
int sub_15964()
{
  sub_1588C();
  sub_133E4((int)"system", (int)"info");
  puts("<tr><td style=\"padding-left:0px; border-left: 1px solid #CCC;\">");
  puts("<table id=\"sysinfo_iframe\" class=menu_content_list_noline_table cellspacing=0px cellpadding=0px style=\"width:640px; border-bottom: 1px solid #CCC; overflow-y: hidden;\">");
  printf("</table>");
  puts("<iframe src=\"timepro.cgi?tmenu=iframe&smenu=system_info_status\" name=\"system_info_status\" style=\"display:none;\"></iframe>");
  return puts("</td></tr>");
}

//----- (000159C0) --------------------------------------------------------
int sub_159C0()
{
  puts("<table cellpadding=0px cellspacing=0px style=\"padding-left:0px;\">");
  sub_15964();
  printf("</table>");
  printf("<script>");
  printf("document.getElementsByTagName('body')[0].style.overflowX = 'hidden';");
  return printf("</script>");
}

//----- (00015A10) --------------------------------------------------------
int sub_15A10()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r0@1
  const char *v3; // r4@1

  printf("<tr class='odd'>");
  v1 = sub_134F4(983, v0);
  v2 = printf("<td class='td_desc border_left'>%s</td>\n", v1);
  v3 = (const char *)get_firmware_version2(v2);
  puts("<td class='td_item border_right' colspan=3>");
  puts(v3);
  printf("</td>");
  return printf("</tr>");
}
// EC60: using guessed type int __fastcall get_firmware_version2(_DWORD);

//----- (00015A74) --------------------------------------------------------
int sub_15A74()
{
  int v0; // r5@1
  int v1; // r4@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@2
  int v6; // r0@3
  int v7; // r1@4
  int v8; // r0@4

  v0 = get_remote_mgmt_port();
  v1 = get_remote_mgmt_flag();
  printf("<tr class='even'>");
  v3 = sub_134F4(858, v2);
  printf("<td class='td_desc border_left'>%s</td>\n", v3);
  puts("<td class='td_item border_right' colspan=3>");
  if ( v1 )
  {
    v5 = sub_134F4(859, v4);
    printf((const char *)v5, v0);
  }
  else
  {
    v6 = sub_134F4(860, v4);
    puts((const char *)v6);
  }
  printf("</td>");
  printf("</tr>");
  printf("<tr class='odd'>");
  puts("<td class='td_desc border_left'></td>");
  puts("<td class='td_item border_right' colspan=3>");
  v8 = sub_134F4(1081, v7);
  printf((const char *)v8, "JavaScript:MovePagetoMain('firewallconf','accesslist');");
  printf("</td>");
  return printf("</tr>");
}
// EC90: using guessed type int get_remote_mgmt_port(void);
// F830: using guessed type int get_remote_mgmt_flag(void);

//----- (00015B4C) --------------------------------------------------------
int __fastcall sub_15B4C(int a1)
{
  int v1; // r5@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@2
  int v8; // r0@6
  int v9; // r1@6
  int v10; // r0@6
  int v12; // [sp+0h] [bp-3F0h]@6
  char s; // [sp+10h] [bp-3E0h]@6
  char v14; // [sp+24h] [bp-3CCh]@6
  char v15; // [sp+3B8h] [bp-38h]@1
  char v16; // [sp+3CCh] [bp-24h]@1

  v1 = dhcpd_get_op(a1);
  printf("<tr class='%s'>", "odd");
  v3 = sub_134F4(389, v2);
  printf("<td class='td_desc border_left'>%s</td>\n", v3);
  puts("<td class='td_item border_right' colspan=3>");
  get_ifconfig("br0", &v16, &v15);
  puts(&v16);
  puts("</td>");
  printf("</tr>");
  printf("<tr class='%s'>", "even");
  v5 = sub_134F4(643, v4);
  printf("<td class='td_desc border_left'>%s</td>\n", v5);
  printf("<td class=\"td_item border_right\" colspan=3>");
  if ( v1 )
  {
    if ( get_dhcp_auto_detect_status("br0") )
      v7 = 646;
    else
      v7 = 641;
  }
  else
  {
    v7 = 644;
  }
  v8 = sub_134F4(v7, v6);
  printf((const char *)v8);
  puts("</td>");
  printf("</tr>");
  printf("<tr class='%s'>", "odd");
  v10 = sub_134F4(1037, v9);
  printf("<td class='td_desc border_left'>%s</td>\n", v10);
  puts("<td class=\"td_item border_right\" colspan=3 >");
  dhcpd_read_config(&v12);
  puts(&s);
  printf(" - ");
  print_nbsp(1);
  puts(&v14);
  puts("</td>");
  return printf("</tr>");
}
// ECFC: using guessed type int __fastcall get_dhcp_auto_detect_status(_DWORD);
// EF00: using guessed type int __fastcall dhcpd_get_op(_DWORD);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// F620: using guessed type int __fastcall dhcpd_read_config(_DWORD);

//----- (00015CB8) --------------------------------------------------------
_UNKNOWN *__fastcall sub_15CB8(const char *a1)
{
  const char *v1; // r4@1
  int v2; // r1@1
  int v3; // r0@2
  int v4; // r0@7

  v1 = a1;
  if ( !strcmp(a1, "static") )
  {
    v3 = 1055;
LABEL_7:
    v4 = sub_134F4(v3, v2);
    strcpy((char *)&unk_984A0, (const char *)v4);
    return &unk_984A0;
  }
  if ( !strcmp(v1, "dynamic") )
  {
    v3 = 1043;
    goto LABEL_7;
  }
  if ( !strcmp(v1, "pppoe") )
  {
    v3 = 1050;
    goto LABEL_7;
  }
  return &unk_984A0;
}

//----- (00015D38) --------------------------------------------------------
int __fastcall sub_15D38(const char *a1)
{
  const char *v1; // r7@1
  int v2; // r1@1
  int v3; // r8@1
  int v4; // r0@2
  int v5; // r0@7
  int v6; // r1@7
  int v7; // r0@8
  char *v8; // r4@10
  int v9; // r0@11
  int v10; // r1@13
  int v11; // r0@14
  int v12; // r1@15
  char *v13; // r0@15
  int v14; // r1@18
  char *v15; // r0@18
  int v16; // r1@23
  char *v17; // r5@28
  int v18; // r1@28
  int v19; // r0@28
  int v20; // r4@28
  int v21; // r1@28
  int v22; // r0@29
  int v23; // r1@34
  int v24; // r0@34
  int v25; // r4@34
  int v26; // r1@34
  int v27; // r0@34
  _UNKNOWN *v28; // r0@36
  int v29; // r1@36
  int v30; // r0@36
  char *v31; // r0@38
  int v32; // r0@39
  int v33; // r1@39
  int v34; // r1@42
  int v35; // r0@42
  int v36; // r0@42
  unsigned int v37; // r0@43
  int v38; // r4@44
  char v40[512]; // [sp+4h] [bp-2ECh]@1
  char v41; // [sp+204h] [bp-ECh]@13
  char v42; // [sp+224h] [bp-CCh]@13
  char v43; // [sp+244h] [bp-ACh]@42
  char v44; // [sp+264h] [bp-8Ch]@42
  char v45; // [sp+284h] [bp-6Ch]@41
  char v46; // [sp+298h] [bp-58h]@1
  char v47; // [sp+2A8h] [bp-48h]@1
  char v48; // [sp+2B8h] [bp-38h]@1
  char v49; // [sp+2C8h] [bp-28h]@1

  v1 = a1;
  get_wan_hw_ifname(a1, &v49);
  get_wan_type(v1, &v48);
  get_wan_hw_ifname(v1, &v47);
  get_wan_type(v1, &v46);
  strcpy(v40, "");
  v3 = get_wan_link(v1);
  if ( !v3 )
  {
    v4 = 120;
LABEL_32:
    v14 = sub_134F4(v4, v2);
    v15 = v40;
    goto LABEL_33;
  }
  if ( !strcmp(&v46, "pppoe") || !strcmp(&v46, "pptp") )
  {
    if ( get_idle_timeout(&v47) || !get_wansetup_status(v1) )
    {
      v8 = v40;
      if ( get_wansetup_status(v1) )
        v11 = 1049;
      else
        v11 = 393;
      goto LABEL_22;
    }
    v5 = get_pppoe_status(v1);
    if ( !v5 )
    {
      v7 = 390;
LABEL_18:
      v14 = sub_134F4(v7, v6);
      v15 = v40;
LABEL_33:
      strcat(v15, (const char *)v14);
      goto LABEL_34;
    }
    if ( v5 != 4 )
    {
      if ( v5 != 6 )
        goto LABEL_34;
      v7 = 1048;
      goto LABEL_18;
    }
    v8 = v40;
    if ( !strcmp(v1, "wan2") )
      v9 = (int)"ppp2";
    else
      v9 = (int)"ppp1";
    get_ifconfig(v9, &v42, &v41);
    if ( !v42 )
    {
      v11 = 1044;
LABEL_22:
      v14 = sub_134F4(v11, v10);
      v15 = v8;
      goto LABEL_33;
    }
    v12 = sub_134F4(1045, v10);
    v13 = v40;
LABEL_25:
    strcat(v13, (const char *)v12);
    v3 = 1;
    goto LABEL_34;
  }
  get_ifconfig(&v47, &v42, &v41);
  if ( v42 )
  {
    v12 = sub_134F4(1045, v16);
    v13 = v40;
    goto LABEL_25;
  }
  if ( !get_wansetup_status(v1) )
  {
    v4 = 393;
    goto LABEL_32;
  }
  v17 = &v40[strlen(v40)];
  v19 = sub_134F4(1049, v18);
  v20 = sprintf(v17, (const char *)v19);
  if ( istatus_get_intvalue_direct("lanwan_samenetwork") == 1 )
  {
    v22 = sub_134F4(1054, v21);
    sprintf(&v17[v20], (const char *)v22, "JavaScript:MovePagetoMain('netconf','lansetup');");
    goto LABEL_34;
  }
  if ( istatus_get_intvalue_direct("privateip") == 1 )
  {
    v4 = 1052;
    goto LABEL_32;
  }
LABEL_34:
  printf("<tr class='%s'>", "odd");
  v24 = sub_134F4(1077, v23);
  v25 = (int)"item_text";
  printf("<td class='td_desc border_left'>%s</td>\n", v24);
  puts("<td class='td_item border_right' colspan=3 >");
  printf("%s", v40);
  puts("</td>");
  printf("</tr>");
  printf("<tr class='%s'>", "even");
  v27 = sub_134F4(1078, v26);
  printf("<td class='td_desc border_left'>%s</td>\n", v27);
  puts("<td class=td_item>");
  if ( !v3 )
    v25 = (int)"gray_text";
  v28 = sub_15CB8(&v48);
  printf("<span class=%s>%s ", v25, v28);
  printf("</span>");
  puts("</td>");
  v30 = sub_134F4(216, v29);
  printf("<td class=td_desc>%s</td>\n", v30);
  puts("<td class=\"td_item border_right\" style=\"width:162px;\">");
  if ( !strcmp(&v48, "pppoe") || !strcmp(&v48, "pptp") )
  {
    v32 = strcmp(v1, "wan2");
    v33 = (int)"ppp2";
    if ( v32 )
      v33 = (int)"ppp1";
    sf_strncpy(&v45, v33, 20);
    v31 = &v45;
  }
  else
  {
    v31 = &v49;
  }
  get_ifconfig(v31, &v44, &v43);
  printf("<span class=%s style='font-weight: bold;'>%s</span>");
  puts("</td>");
  printf("</tr>");
  printf("<tr class='%s'>", "odd");
  v35 = sub_134F4(391, v34);
  printf("<td class='td_desc border_left'>%s</td>\n", v35);
  v36 = puts("<td class='td_item border_right' colspan=3 class=td_item>");
  if ( v3 )
  {
    v38 = get_system_running_time(v36);
    v37 = v38 - get_internet_connected_time(v1);
  }
  else
  {
    v37 = 0;
  }
  sub_1205C(v37, (int)v40, 512);
  printf("<span class=%s>%s</span>");
  puts("</td>");
  return printf("</tr>");
}
// E858: using guessed type int __fastcall get_wansetup_status(_DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E960: using guessed type int __fastcall get_system_running_time(_DWORD);
// E96C: using guessed type int __fastcall get_wan_type(_DWORD, _DWORD);
// EEAC: using guessed type int __fastcall get_idle_timeout(_DWORD);
// F008: using guessed type int __fastcall get_wan_link(_DWORD);
// F0EC: using guessed type int __fastcall istatus_get_intvalue_direct(_DWORD);
// F0F8: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// FC5C: using guessed type int __fastcall get_internet_connected_time(_DWORD);
// FE00: using guessed type int __fastcall get_pppoe_status(_DWORD);
// 15D38: using guessed type char var_2EC[512];

//----- (000161D4) --------------------------------------------------------
int sub_161D4()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r0@1
  unsigned int v9; // r0@1
  int v11; // [sp+0h] [bp-108h]@1

  sub_1588C();
  sub_133E4((int)"system", (int)"info");
  puts("<tr><td style=\"padding-left:0px; border-left: 1px solid #CCC;\">");
  puts("<table id=\"sysinfo_iframe\" class=menu_content_list_noline_table cellspacing=0px cellpadding=0px style=\"width: 640px; border-bottom: 1px solid #CCC; overflow-y: hidden;\">");
  v1 = sub_134F4(1085, v0);
  sub_1590C(v1);
  sub_15D38("wan1");
  v3 = sub_134F4(1084, v2);
  sub_1590C(v3);
  sub_15B4C(0);
  v5 = sub_134F4(1083, v4);
  sub_1590C(v5);
  sub_15A10();
  sub_15A74();
  printf("<tr class='even'>");
  v7 = sub_134F4(1096, v6);
  printf("<td class='td_desc border_left'>%s</td>\n", v7);
  v8 = puts("<td class='td_item border_right' colspan=3>");
  v9 = get_system_running_time(v8);
  sub_1205C(v9, (int)&v11, 256);
  printf("%s", &v11);
  printf("</td>");
  printf("</tr>");
  printf("</table>");
  printf("<script>");
  printf("parent.document.getElementById('sysinfo_iframe').outerHTML = document.getElementById('sysinfo_iframe').outerHTML;");
  printf("setTimeout(function() {");
  printf("location.reload();");
  printf("}, 3000);");
  return printf("</script>");
}
// E960: using guessed type int __fastcall get_system_running_time(_DWORD);

//----- (00016324) --------------------------------------------------------
int __fastcall sub_16324(void **a1, int a2)
{
  int result; // r0@14

  if ( a1 == (void **)60 )
    return a2 == 60;
  if ( a1 == (void **)600 )
    return a2 == 600;
  if ( a1 == (void **)1800 )
    goto LABEL_24;
  if ( a1 == (void **)3600 )
    return a2 == 3600;
  if ( a1 == (void **)7200 )
    goto LABEL_24;
  if ( a1 == (void **)14400 )
    return a2 == 14400;
  if ( a1 == (void **)21600 || a1 == (void **)43200 || a1 == (void **)&loc_FD20 )
    goto LABEL_24;
  if ( a1 == (void **)&loc_15180 )
    return a2 == 86400;
  if ( a1 == &off_2A300 || a1 == (void **)&loc_3F480 )
  {
LABEL_24:
    result = a2 == (_DWORD)a1;
  }
  else if ( a1 == (void **)604800 )
  {
    result = a2 == 604800;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 2A300: using guessed type void *off_2A300;

//----- (0001644C) --------------------------------------------------------
int sub_1644C()
{
  puts("<style type=\"text/css\">");
  puts(".lansetup_main_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".lansetup_main_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".lansetup_main_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".lansetup_main_p {");
  puts("\tpadding-left:5px; display:inline-block;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".lansetup_main_span {");
  puts("\tdisplay:inline-block; vertical-align:middle;");
  puts("}");
  puts(".lansetup_main_button {");
  puts("\tpadding:0 1 0 1; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".lansetup_main_td input[type=checkbox], .lansetup_main_td input[type=radio] {");
  puts("display:inline-block; vertical-align:middle;");
  puts("}");
  puts("#lansetup_div_msg p {");
  puts("margin:5 0 5 15px; text-align:left;");
  puts("}");
  puts(".lansetup_ellipsis {");
  puts("text-overflow:ellipsis; overflow:hidden; white-space:nowrap; text-align:left;");
  puts("}");
  printf("input[type=\"text\"] {border:1px #CCC solid;}");
  printf("input[type=\"password\"] {border:1px #CCC solid;}");
  printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td, img {cursor:default;}");
  return printf("</style>");
}

//----- (000165E4) --------------------------------------------------------
unsigned int __fastcall sub_165E4(const char *a1, const char *a2)
{
  const char *v2; // r5@1
  unsigned int v3; // r4@1
  unsigned int v4; // r0@1

  v2 = a2;
  v3 = inet_addr(a1);
  v4 = inet_addr(v2);
  return ((v3 >> 24) | (v3 << 24) | ((v3 & 0xFF0000) >> 8) | ((unsigned __int16)(v3 & 0xFF00) << 8))
       - ((v4 >> 24) | (v4 << 24) | ((v4 & 0xFF0000) >> 8) | ((unsigned __int16)(v4 & 0xFF00) << 8));
}

//----- (00016638) --------------------------------------------------------
int __fastcall sub_16638(int a1)
{
  int v1; // r5@1
  int v2; // r0@1
  int v3; // r7@1
  char *v4; // r6@1
  int v5; // r10@1
  int v6; // r1@1
  int v7; // r4@2
  int v8; // r0@4
  int v9; // r5@4
  char *v10; // r1@5
  int v11; // r1@7
  int v12; // r0@7
  char *v13; // r1@8
  int v14; // r1@10
  int v15; // r0@10
  int v16; // r4@10
  int v17; // r1@10
  int v18; // r0@10
  int v19; // r1@10
  int v20; // r4@11
  int v21; // r0@13
  int v22; // r5@13
  int v23; // r1@13
  int v24; // r0@15
  int v25; // r1@15
  int v26; // r0@17
  int v27; // r1@17
  int v28; // r7@17
  char *v29; // r1@30
  int v30; // r1@32
  char *v31; // r4@32
  char *v32; // r5@33
  int v33; // r0@35
  int v34; // r1@35
  char *v35; // r5@36
  int v36; // r0@38
  int v37; // r1@38
  char *v38; // r5@39
  int v39; // r0@41
  int v40; // r1@41
  char *v41; // r5@42
  int v42; // r0@44
  int v43; // r1@44
  char *v44; // r5@45
  int v45; // r0@47
  int v46; // r1@47
  char *v47; // r5@48
  int v48; // r0@50
  int v49; // r1@50
  char *v50; // r5@51
  int v51; // r0@53
  int v52; // r1@53
  char *v53; // r5@54
  int v54; // r0@56
  int v55; // r1@56
  char *v56; // r5@57
  int v57; // r0@59
  int v58; // r1@59
  char *v59; // r5@60
  int v60; // r0@62
  int v61; // r1@62
  char *v62; // r5@63
  int v63; // r0@65
  int v64; // r1@65
  char *v65; // r5@66
  int v66; // r0@68
  int v67; // r1@68
  int v68; // r0@70
  char *v69; // r1@70
  int v70; // r4@70
  int v71; // r1@70
  int v72; // r0@70
  int v73; // r1@70
  int v74; // r0@72
  int v75; // r1@72
  char *v76; // r4@72
  int v77; // r0@72
  int v78; // r1@72
  int v79; // r0@74
  int v80; // r1@74
  int v81; // r0@74
  int v83; // [sp+0h] [bp-3D8h]@1
  char v84; // [sp+10h] [bp-3C8h]@13
  char v85; // [sp+24h] [bp-3B4h]@13
  int v86; // [sp+8Ch] [bp-34Ch]@17
  char v87; // [sp+94h] [bp-344h]@70
  int v88; // [sp+3B4h] [bp-24h]@13

  v1 = a1;
  v2 = dhcpd_read_config(&v83);
  v3 = (int)"F7F7F7";
  v4 = "checked";
  v5 = dhcpd_get_op(v2);
  printf("<table class=\"v3_table lansetup_main_table\" width=\"100%%\">\n");
  printf("<COL width=\"110\"><COL width=\"160\"><COL width=\"240\"><COL width=\"%%%%\">");
  if ( v1 & 1 )
    v7 = (int)"F7F7F7";
  else
    v7 = (int)"FFFFFF";
  v8 = sub_134F4(640, v6);
  v9 = v1 + 1;
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s;\">\t\t<td class=\"lansetup_main_td\" style=\"padding-left:5px;\">%s</td>",
    v7,
    v8);
  printf("<td class=\"lansetup_main_td\">");
  if ( v5 )
    v10 = "checked";
  else
    v10 = "";
  printf(
    "<input type=radio class=\"navi_radio\" id=\"enable_on_id\" name=\"dhcp_enable\" value=on %s onclick=\"ChangeDHCPServerOp();\"> \n",
    v10);
  v12 = sub_134F4(894, v11);
  printf("<label for=\"enable_on_id\"><span class=\"netconf_lansetup_span\">%s</span></label>", v12);
  printf("<span class=\"lansetup_main_span\" style=\"width:25px;\"></span>");
  if ( v5 )
    v13 = "";
  else
    v13 = "checked";
  printf(
    "<input type=radio class=\"navi_radio\" id=\"enable_off_id\" name=\"dhcp_enable\" %s value=off onclick=\"ChangeDHCPServerOp();\"> \n",
    v13);
  v15 = sub_134F4(901, v14);
  printf("<label for=\"enable_off_id\"><span class=\"netconf_lansetup_span\">%s</span></label>", v15);
  printf("</td>");
  printf("<td class=\"lansetup_main_td\" colspan=\"2\">");
  printf("<span class=\"lansetup_main_span\">");
  v16 = dhcpd_get_all_dynamic_lease();
  v18 = sub_134F4(448, v17);
  printf("(%d %s)", v16, v18);
  printf("</span>");
  printf("</td></tr>");
  if ( v9 & 1 )
    v20 = (int)"F7F7F7";
  else
    v20 = (int)"FFFFFF";
  v21 = sub_134F4(638, v19);
  v22 = v9 + 1;
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s;\">\t\t<td class=\"lansetup_main_td\" style=\"padding-left:5px;\">%s</td>",
    v20,
    v21);
  printf("<td class=\"lansetup_main_td\" colspan=\"3\">");
  sub_11D7C((int)"spool_conf", (int)&v84, 2);
  printf(" ~ &nbsp;");
  sub_11D7C((int)"epool_conf", (int)&v85, 2);
  if ( !v88 )
    v4 = "";
  v24 = sub_134F4(468, v23);
  printf(
    "<span class=\"lansetup_main_span\" style=\"margin-left:5px;\">\t\t<input type=checkbox class=\"navi_chk\" name=\"miprange\" id=\"miprange_id\" onclick=\"SetIPViewByCheckbox(this.checked);\" %s>\t\t<label for=\"miprange_id\">%s</label></span>",
    v4,
    v24);
  puts("</td></tr>");
  if ( !(v22 & 1) )
    v3 = (int)"FFFFFF";
  v26 = sub_134F4(639, v25);
  v27 = v3;
  v28 = v22 + 1;
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s;\">\t\t<td class=\"lansetup_main_td\" style=\"padding-left:5px;\">%s</td>",
    v27,
    v26);
  printf("<td class=\"lansetup_main_td\">");
  printf("<select name=\"leasetime\">");
  if ( v86 == 60
    || v86 == 600
    || v86 == 1800
    || v86 == 3600
    || v86 == 7200
    || v86 == 14400
    || v86 == 21600
    || v86 == 43200
    || v86 == 64800
    || v86 == 86400
    || (void **)v86 == &off_2A300
    || v86 == 259200
    || v86 == 604800 )
    v29 = "";
  else
    v29 = "selected";
  printf("<option value=\"-\" %s>-</option>", v29);
  v31 = "selected";
  if ( sub_16324((void **)0x3C, v86) )
    v32 = "selected";
  else
    v32 = "";
  v33 = sub_134F4(459, v30);
  printf("<option value=\"60\" %s>%s</option>", v32, v33);
  if ( sub_16324((void **)0x258, v86) )
    v35 = "selected";
  else
    v35 = "";
  v36 = sub_134F4(457, v34);
  printf("<option value=\"600\" %s>%s</option>", v35, v36);
  if ( sub_16324((void **)0x708, v86) )
    v38 = "selected";
  else
    v38 = "";
  v39 = sub_134F4(452, v37);
  printf("<option value=\"1800\" %s>%s</option>", v38, v39);
  if ( sub_16324((void **)0xE10, v86) )
    v41 = "selected";
  else
    v41 = "";
  v42 = sub_134F4(455, v40);
  printf("<option value=\"3600\" %s>%s</option>", v41, v42);
  if ( sub_16324((void **)0x1C20, v86) )
    v44 = "selected";
  else
    v44 = "";
  v45 = sub_134F4(461, v43);
  printf("<option value=\"7200\" %s>%s</option>", v44, v45);
  if ( sub_16324((void **)0x3840, v86) )
    v47 = "selected";
  else
    v47 = "";
  v48 = sub_134F4(450, v46);
  printf("<option value=\"14400\" %s>%s</option>", v47, v48);
  if ( sub_16324((void **)0x5460, v86) )
    v50 = "selected";
  else
    v50 = "";
  v51 = sub_134F4(453, v49);
  printf("<option value=\"21600\" %s>%s</option>", v50, v51);
  if ( sub_16324((void **)0xA8C0, v86) )
    v53 = "selected";
  else
    v53 = "";
  v54 = sub_134F4(456, v52);
  printf("<option value=\"43200\" %s>%s</option>", v53, v54);
  if ( sub_16324((void **)&loc_FD20, v86) )
    v56 = "selected";
  else
    v56 = "";
  v57 = sub_134F4(460, v55);
  printf("<option value=\"64800\" %s>%s</option>", v56, v57);
  if ( sub_16324((void **)&loc_15180, v86) )
    v59 = "selected";
  else
    v59 = "";
  v60 = sub_134F4(462, v58);
  printf("<option value=\"86400\" %s>%s</option>", v59, v60);
  if ( sub_16324(&off_2A300, v86) )
    v62 = "selected";
  else
    v62 = "";
  v63 = sub_134F4(451, v61);
  printf("<option value=\"172800\" %s>%s</option>", v62, v63);
  if ( sub_16324((void **)&loc_3F480, v86) )
    v65 = "selected";
  else
    v65 = "";
  v66 = sub_134F4(454, v64);
  printf("<option value=\"259200\" %s>%s</option>", v65, v66);
  if ( !sub_16324((void **)0x93A80, v86) )
    v31 = "";
  v68 = sub_134F4(458, v67);
  v69 = v31;
  v70 = (int)"F7F7F7";
  printf("<option value=\"604800\" %s>%s</option>", v69, v68);
  printf("</select>");
  puts("</td>");
  printf("<td class=\"lansetup_main_td\" colspan=\"2\">");
  v72 = sub_134F4(647, v71);
  printf("<span class=\"lansetup_main_span\">%s</span>", v72);
  printf(
    "<span class=\"lansetup_main_p\"><input type=text name=domain size=10 maxlength=30 style=\"width:90px;\" value=\"%s\"></span>",
    &v87);
  printf("</td></tr>");
  if ( !(v28 & 1) )
    v70 = (int)"FFFFFF";
  v74 = sub_134F4(437, v73);
  v75 = v70;
  v76 = "checked";
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s;\">\t\t<td class=\"lansetup_main_td\" style=\"padding-left:5px;\">%s</td>",
    v75,
    v74);
  v77 = printf("<td class=\"lansetup_main_td\" colspan=\"2\"><span class=\"lansetup_main_span\" style=\"width:230px; margin-right:15px;\" id=\"dhcpstat\">\t\t</span>");
  if ( !get_dhcp_auto_detect(v77) )
    v76 = "";
  v79 = sub_134F4(446, v78);
  printf(
    "<input type=checkbox class=\"navi_chk\" name=\"dhcp_auto_detect\" id=\"detect_id\" %s>\t\t<label for=\"detect_id\">%s</label>",
    v76,
    v79);
  puts("</td>");
  puts("<td class=\"lansetup_main_td\" align=right>");
  v81 = sub_134F4(28, v80);
  printf(
    "<button type=\"button\" class=\"navi_bt\" name=\"int_save\" onclick=\"ApplyLanSetup();\" style=\"width:51px;\">\t\t<span class=\"lansetup_main_span\">%s</span></button>\n",
    v81);
  puts("</td></tr>");
  printf("</table>");
  return v28 + 1;
}
// EB40: using guessed type int dhcpd_get_all_dynamic_lease(void);
// EF00: using guessed type int __fastcall dhcpd_get_op(_DWORD);
// F188: using guessed type int __fastcall get_dhcp_auto_detect(_DWORD);
// F620: using guessed type int __fastcall dhcpd_read_config(_DWORD);
// 2A300: using guessed type void *off_2A300;

//----- (00016D18) --------------------------------------------------------
int sub_16D18()
{
  char *v0; // r0@1
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r4@2
  unsigned int v6; // r0@3
  unsigned int v7; // r0@3
  char *v8; // r0@3
  int v9; // r1@3
  int v10; // r0@3
  int v11; // r1@3
  int v12; // r0@3
  int v13; // r1@3
  int v14; // r0@3
  int v15; // r1@3
  int v16; // r0@3
  char v17; // r4@4
  int v18; // r1@4
  int v19; // r5@4
  int v20; // r1@4
  int v21; // r4@4
  int v22; // r1@4
  int v23; // r0@4
  int v24; // r1@4
  char *v25; // r5@4
  int v26; // r1@4
  int v27; // r0@4
  int v28; // r0@4
  int v29; // r1@4
  char *v30; // r4@5
  int v31; // r0@7
  int v32; // r0@7
  int v33; // r1@7
  int v34; // r0@9
  int v35; // r1@9
  int v36; // r0@9
  int v37; // r1@9
  int v38; // r0@9
  _UNKNOWN *v39; // r4@9
  int v40; // r1@9
  int v41; // r0@9
  int v42; // r0@9
  int v43; // r0@10
  int v44; // r1@12
  int v45; // r0@12
  _UNKNOWN *v46; // r4@12
  int v47; // r1@12
  int v48; // r0@12
  _UNKNOWN *v49; // r4@12
  int v50; // r1@12
  int v51; // r0@12
  int v52; // r0@12
  int v53; // r0@13
  int v54; // r1@15
  int v55; // r0@15
  int v56; // r4@15
  int v57; // r1@16
  int v58; // r0@16
  int v59; // r1@18
  int v60; // r0@18
  _UNKNOWN *v61; // r4@18
  int v62; // r1@18
  int v63; // r0@18
  int v64; // r0@18
  int v65; // r0@19
  int v66; // r0@19
  int v67; // r0@22
  _UNKNOWN *v68; // r0@24
  int v70; // [sp+10h] [bp-478h]@9
  int v71; // [sp+A0h] [bp-3E8h]@9
  char v72; // [sp+3C8h] [bp-C0h]@3
  char v73; // [sp+3E8h] [bp-A0h]@3
  int v74; // [sp+408h] [bp-80h]@1
  int v75; // [sp+428h] [bp-60h]@1
  int v76; // [sp+448h] [bp-40h]@1
  int v77; // [sp+45Ch] [bp-2Ch]@1
  struct in_addr inp; // [sp+470h] [bp-18h]@1
  struct in_addr v79; // [sp+474h] [bp-14h]@1

  puts("<form method=post action=\"timepro.cgi\" name=\"netconf_lansetup\" style=\"margin:0; padding:0;\">");
  puts("<input type=hidden name=\"tmenu\" value=\"netconf\">");
  puts("<input type=hidden name=\"smenu\" value=\"lansetup\">");
  puts("<input type=hidden name=\"act\" value=\"\">");
  puts("<input type=hidden name=\"reboot\" value=\"\">");
  printf("<table class=\"v3_table lansetup_main_table\" width=\"100%%; padding:0; margin:0;\">\n");
  printf("<COL width=\"125\"><COL width=\"75\"><COL width=\"442\">");
  printf("<tr class=\"lansetup_main_tr\"><td class=\"lansetup_main_td\" width=\"100%%\" colspan=\"3\">");
  printf("<table class=\"v3_table lansetup_main_table\" width=\"100%%\">\n");
  printf("<COL width=\"110\"><COL width=\"160\"><COL width=\"240\"><COL width=\"%%%%\">");
  get_wan_ifname("wan1", &v77);
  get_ifconfig(&v77, &v75, &v74);
  inet_aton((const char *)&v75, &v79);
  inet_aton((const char *)&v74, &inp);
  v79.s_addr &= inp.s_addr;
  v0 = inet_ntoa(v79);
  printf("<input type=hidden name=\"wan1subnet\" value=\"%s\">\n", v0);
  v2 = sub_134F4(389, v1);
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s;\">\t\t<td class=\"lansetup_main_td\" style=\"padding-left:5px;\">%s</td>",
    "FFFFFF",
    v2);
  get_ifconfig("br0", &v75, &v74);
  puts("<td class=\"lansetup_main_td\">");
  sub_11D7C((int)"ip", (int)&v75, 1);
  printf("</td><td colspan=\"2\" class=\"lansetup_main_td\">");
  get_hwaddr_kernel("br0", &v76);
  convert_mac(&v76);
  printf("<span class=\"lansetup_main_p\">(%s)</span>", &v76);
  puts("</td></tr>");
  v4 = sub_134F4(907, v3);
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s;\">\t\t<td class=\"lansetup_main_td\" style=\"padding-left:5px;\">%s</td>",
    "F7F7F7",
    v4);
  puts("<td class=\"lansetup_main_td\">");
  sub_11D7C((int)"sm", (int)&v74, 2);
  puts("</td><td colspan=\"2\" class=\"lansetup_main_td\"></td></tr>");
  if ( istatus_get_intvalue_direct("lanwan_samenetwork") == 1 )
  {
    get_localbroadaddr("br0", &v73);
    v6 = inet_addr(&v73);
    v7 = ((v6 >> 24) | (v6 << 24) | ((v6 & 0xFF0000) >> 8) | ((unsigned __int16)(v6 & 0xFF00) << 8)) + 2;
    v8 = inet_ntoa((struct in_addr)((v7 >> 24) | (v7 << 24) | ((v7 & 0xFF0000) >> 8) | ((unsigned __int16)(v7 & 0xFF00) << 8)));
    strcpy(&v72, v8);
    printf((const char *)&unk_5C787, "FFFFFF");
    v10 = sub_134F4(443, v9);
    printf("<p>%s</p>", v10);
    v12 = sub_134F4(444, v11);
    printf("<p>%s</p>", v12);
    printf(
      "<p><input type=checkbox onclick=\"if(this.checked == true) SetIP('ip','%s'); else SetIP('ip','%s');\">",
      &v72,
      &v75);
    v14 = sub_134F4(442, v13);
    v5 = 3;
    printf("%s</p>", v14);
    v16 = sub_134F4(445, v15);
    printf("<p>%s</p>", v16);
    puts("</span></td></tr>");
  }
  else
  {
    v5 = 2;
  }
  printf("</table>");
  printf("</td></tr>");
  printf("<tr class=\"lansetup_main_tr\"><td class=\"lansetup_main_td\" width=\"100%%\" colspan=\"3\">");
  v17 = sub_16638(v5);
  printf("</td></tr>");
  printf((const char *)&unk_5C8A8);
  v19 = sub_134F4(438, v18);
  v21 = sub_134F4(439, v20);
  v23 = sub_134F4(440, v22);
  v24 = v19;
  v25 = "checked";
  printf(
    "<span class=\"lansetup_main_p\">\t\t%s <a href=\"javascript:MovePagetoMainURL('sysconf', 'misc', 'service=hubapmode');\" style=\"color:#0000FF;\"><u>%s</u></a> %s\t\t</span>",
    v24,
    v21,
    v23);
  printf("</td></tr>");
  v27 = sub_134F4(642, v26);
  printf(
    "<tr height=\"26\" class=\"lansetup_main_tr\" style=\"background-color:#%s;\">\t\t<td class=\"lansetup_main_td\" style=\"padding-left:5px;\"><span class=\"lansetup_main_span\"><b>%s</b></span></td>",
    "DBDBDB",
    v27);
  printf("<td class=\"lansetup_main_td\" colspan=2 align=\"right\">");
  v28 = printf("<span class=\"lansetup_main_span\">");
  if ( get_ipmac_bind(v28) & 1 )
    v30 = "checked";
  else
    v30 = "";
  v31 = sub_134F4(513, v29);
  printf(
    "<input type=\"checkbox\" name=\"mac_restrict\" onclick=\"onclick_macristrict();\" id=\"mrestid\" %s>\t\t<label for=\"mrestid\">%s</label>",
    v30,
    v31);
  v32 = printf("</span><span class=\"lansetup_main_span\" style=\"padding-right:17px;\">");
  if ( !get_dhcp_access_policy(v32) )
    v25 = "";
  v34 = sub_134F4(648, v33);
  printf(
    "<input type=\"checkbox\" class=\"navi_chk\" id=\"dhcppol\" name=\"dhcp_access_policy\" onclick=\"ApplyPartSubmit('dhcp_access_policy');\" %s>\t\t<label for=\"dhcppol\">%s</label>",
    v25,
    v34);
  printf("</span>");
  printf("</td></tr>");
  v36 = sub_134F4(649, v35);
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s; border-bottom:1px #ccc solid; border-top:1px #ccc solid;\">\t\t<td class=\"lansetup_main_td\" colspan=2 style=\"padding-left:5px;\"><span class=\"lansetup_main_span\">%s",
    "EEEEEE",
    v36);
  dhcpd_read_config(&v70);
  v38 = sub_134F4(463, v37);
  printf((const char *)v38, v71);
  printf("</span></td>");
  printf("<td class=\"lansetup_main_td\" align=\"right\" style=\"padding-right:17px;\">");
  printf("<span class=\"lansetup_main_span\" style=\"margin-right:10px;\" onclick=\"RemoveStaticLease();\">");
  v39 = sub_126C4();
  v41 = sub_134F4(118, v40);
  printf(
    "<img src=\"/%s/minus_icon.gif\" class=\"lansetup_main_span\" style=\"width:10px; height:10px;\">\t\t<span class=\"lansetup_main_span\">%s</span>",
    v39,
    v41);
  printf("</span>");
  printf("<span class=\"lansetup_main_span\">");
  puts("<input type=\"checkbox\" name=\"del_allchk\" onclick=\"CheckAllCheckBox(static_lease.document, this, 'dellease');\">");
  printf("</span>");
  printf("</td></tr>");
  v42 = printf("<tr class=\"lansetup_main_tr\" height=\"120\"><td class=\"lansetup_main_td\" colspan=\"3\">");
  if ( is_mobile_agent(v42) )
  {
    sub_12790((int)"120", (int)"100%%", (int)"display:inline-block; *display:inline; zoom:1;");
    v43 = printf("<iframe name=\"static_lease\" src=\"timepro.cgi?tmenu=iframe&smenu=static_lease\"                         frameborder=no width=100%% height=120 align=center scrolling=yes></iframe>");
    sub_12770(v43);
  }
  else
  {
    printf("<iframe name=\"static_lease\" src=\"timepro.cgi?tmenu=iframe&smenu=static_lease\"                         frameborder=no width=100%% height=120 align=center scrolling=yes></iframe>");
  }
  printf("</td></tr>");
  v45 = sub_134F4(650, v44);
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s; border-bottom:1px #ccc solid; border-top:1px #ccc solid;\">\t\t<td class=\"lansetup_main_td\" style=\"padding-left:5px;\"><span class=\"lansetup_main_span\">%s</span></td>",
    "EEEEEE",
    v45);
  printf("<td class=\"lansetup_main_td\" colspan=2 align=\"right\" style=\"padding-right:17px;\">");
  printf("<span class=\"lansetup_main_span\" style=\"margin-right:10px;\" onclick=\"onclick_research_span();\">");
  v46 = sub_126C4();
  v48 = sub_134F4(465, v47);
  printf((const char *)&unk_5D17C, v46, v48);
  printf("</span>");
  printf("<span class=\"lansetup_main_span\" style=\"margin-right:10px;\" onclick=\"AddStaticLease();\">");
  v49 = sub_126C4();
  v51 = sub_134F4(435, v50);
  printf(
    "<img src=\"/%s/plus_icon.gif\" class=\"lansetup_main_span\" style=\"width:10px; height:10px;\">\t\t<span class=\"lansetup_main_span\">%s</span>",
    v49,
    v51);
  printf("</span>");
  printf("<span class=\"lansetup_main_span\">");
  puts("<input type=\"checkbox\" name=\"add_allchk\" onclick=\"CheckAllCheckBox(lan_pcinfo.document, this, 'addlease');\">");
  printf("</span>");
  printf("</td></tr>");
  v52 = printf("<tr class=\"lansetup_main_tr\" height=\"120\"><td class=\"lansetup_main_td\" colspan=\"3\">");
  if ( is_mobile_agent(v52) )
  {
    sub_12790((int)"120", (int)"100%%", (int)"display:inline-block; *display:inline; zoom:1;");
    v53 = printf("<iframe name=\"lan_pcinfo\" src=\"timepro.cgi?tmenu=iframe&smenu=lan_pcinfo\"                         frameborder=no width=100%% height=120 align=center scrolling=yes></iframe>");
    sub_12770(v53);
  }
  else
  {
    printf("<iframe name=\"lan_pcinfo\" src=\"timepro.cgi?tmenu=iframe&smenu=lan_pcinfo\"                         frameborder=no width=100%% height=120 align=center scrolling=yes></iframe>");
  }
  printf("</td></tr>");
  v55 = sub_134F4(466, v54);
  v56 = 0;
  printf(
    "<tr height=\"24\" class=\"lansetup_main_tr\" style=\"background-color:#%s; border-bottom:1px #ccc solid; border-top:1px #ccc solid;\">\t\t<td class=\"lansetup_main_td\" style=\"padding-left:5px;\" colspan=\"3\"><span class=\"lansetup_main_span\">%s</span>",
    "EEEEEE",
    v55);
  printf("<span class=\"lansetup_main_span\" style=\"padding-left:15px;\">");
  sub_11D7C((int)"manual_ip", 0, 3);
  printf("</span>");
  printf("<span class=\"lansetup_main_span\" style=\"padding-left:10px;\">");
  while ( 1 )
  {
    ++v56;
    printf(
      "<input type=text name='%s%d' size=2 maxlength=2 style=\"width:18pt; ime-mode: disabled;\" onfocus='this.select();' onkeypress=\"return HWKeyDown('%s',%d);\" onkeyup=\"HWKeyUp('%s',%d);\"",
      "manual_hw",
      v56,
      "manual_hw",
      v56,
      "manual_hw",
      v56);
    v58 = sub_134F4(512, v57);
    printf("title=\"%s%d\"", v58, v56);
    putchar(62);
    if ( v56 == 6 )
      break;
    putchar(45);
  }
  printf("</span>");
  printf("<span class=\"lansetup_main_span\" style=\"padding-left:10px;\">");
  v60 = sub_134F4(436, v59);
  printf("<input type=\"text\" name=\"desc\" maxlength=\"20\" style=\"width:120px;\" placeholder=\"%s\">", v60);
  printf("</span>");
  printf("<span class=\"lansetup_main_span\" style=\"padding-left:15px;\" onclick=\"AddManualStaticLease();\">");
  v61 = sub_126C4();
  v63 = sub_134F4(467, v62);
  printf(
    "<img src=\"/%s/plus_icon.gif\" class=\"lansetup_main_span\" style=\"width:10px; height:10px;\">\t\t<span class=\"lansetup_main_span\">%s</span>",
    v61,
    v63);
  printf("</span>");
  printf("</td></tr>");
  printf("</table>");
  printf("</form>");
  printf("<form method=\"post\" name=\"backup_lansetup\" style=\"padding:0; margin:0;\">");
  v64 = printf("</form>");
  if ( is_mobile_agent(v64) )
  {
    sub_12790((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v65 = printf("<iframe name=\"hiddenlansetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenlansetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    v66 = sub_12770(v65);
  }
  else
  {
    v66 = printf("<iframe name=\"hiddenlansetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenlansetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  if ( is_mobile_agent(v66) )
  {
    sub_12790((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v67 = printf("<iframe name=\"hiddenlanstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenlanstatus\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    sub_12770(v67);
  }
  else
  {
    printf("<iframe name=\"hiddenlanstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenlanstatus\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  puts("<script language=JavaScript>");
  puts("init_netconf_lansetup();");
  puts("</script>");
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v68 = sub_126C4();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v68);
  printf("</SPAN></td>");
  printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"lansetup_div_msg\">\n");
  printf("</SPAN></td>");
  printf("</tr></table></DIV>");
  printf("</DIV>");
  printf("<DIV id=\"%s\" style=\"display:none;\">", "info_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:151px; top:198px; width:340px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"340\" height=\"70\">");
  printf("<tr height=\"35\"><td width=\"1%%\" height=\"35\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  printf("</SPAN></td>");
  printf("<td width=\"99%%\" height=\"35\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"lansetup_div_info1\">\n");
  printf("</SPAN></td>");
  printf("</tr>");
  printf("<tr height=\"35\"><td width=\"1%%\" height=\"35\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  printf("</SPAN></td>");
  printf("<td width=\"99%%\" height=\"35\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"lansetup_div_info2\">\n");
  printf("</SPAN></td>");
  printf("</tr>");
  printf("</table></DIV>");
  return printf("</DIV>");
}
// E918: using guessed type int __fastcall get_ipmac_bind(_DWORD);
// E930: using guessed type int __fastcall get_wan_ifname(_DWORD, _DWORD);
// EA2C: using guessed type int __fastcall get_hwaddr_kernel(_DWORD, _DWORD);
// EE10: using guessed type int __fastcall convert_mac(_DWORD);
// F080: using guessed type int __fastcall get_dhcp_access_policy(_DWORD);
// F0EC: using guessed type int __fastcall istatus_get_intvalue_direct(_DWORD);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F620: using guessed type int __fastcall dhcpd_read_config(_DWORD);
// F6E0: using guessed type int __fastcall get_localbroadaddr(_DWORD, _DWORD);
// F74C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (000176E0) --------------------------------------------------------
int sub_176E0()
{
  sub_1644C();
  sub_133E4((int)"netconf", (int)"lansetup");
  return sub_16D18();
}

//----- (00017704) --------------------------------------------------------
int sub_17704()
{
  int v0; // r0@1
  int v1; // r1@2
  int v2; // r0@3

  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"netconf_hiddenlanstatus\">");
  puts("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  puts("<input type=hidden name=\"smenu\" value=\"hiddenlanstatus\">");
  printf("</form>");
  printf("</BODY>");
  v0 = printf("<script>");
  if ( dhcpd_get_op(v0) && get_dhcp_auto_detect_status("br0") )
  {
    v2 = sub_134F4(447, v1);
    printf("parent.document.getElementById('dhcpstat').innerHTML = '%s';", v2);
  }
  else
  {
    printf("parent.document.getElementById('dhcpstat').innerHTML = '';");
  }
  printf("if(!parent.document.runstat || parent.document.runstat == 'run')");
  printf("parent.document.timeoutval = setTimeout(function(){document.netconf_hiddenlanstatus.submit();}, 5000);");
  return printf("</script>");
}
// ECFC: using guessed type int __fastcall get_dhcp_auto_detect_status(_DWORD);
// EF00: using guessed type int __fastcall dhcpd_get_op(_DWORD);

//----- (000177D0) --------------------------------------------------------
signed int __fastcall sub_177D0(int a1, int a2, const char *a3)
{
  int v3; // r7@1
  const char *v4; // r6@1
  int v5; // r5@1
  int v6; // r4@1
  bool v8; // nf@4
  unsigned __int8 v9; // vf@4
  const char *v10; // r0@4

  v3 = a2;
  v4 = a3;
  v5 = a1;
  v6 = 0;
  while ( 1 )
  {
    v9 = __OFSUB__(v6, v3);
    v8 = v6 - v3 < 0;
    v10 = (const char *)(v5 + 148);
    ++v6;
    if ( !(v8 ^ v9) )
      break;
    v5 += 188;
    if ( !strcmp(v10, v4) )
      return 1;
  }
  return 0;
}

//----- (0001781C) --------------------------------------------------------
int __fastcall sub_1781C(int a1)
{
  int v1; // r6@1
  int result; // r0@1
  int v3; // r10@3
  int v4; // r0@4
  signed int v5; // r5@10
  signed int v6; // r7@13
  int v7; // r0@15
  signed int v8; // r3@21
  int v9; // r0@29
  signed int v10; // r4@31
  int v11; // r0@32
  int v12; // r4@33
  int v13; // r0@34
  int v14; // r0@34
  int v15; // r7@43
  int v16; // r5@43
  int v17; // r5@45
  int v18; // r0@47
  signed int v19; // r0@48
  int v20; // r0@50
  int v21; // r4@54
  int v22; // r0@57
  int v23; // [sp+0h] [bp-488h]@7
  int v24; // [sp+10h] [bp-478h]@9
  int v25; // [sp+24h] [bp-464h]@9
  char v26; // [sp+38h] [bp-450h]@9
  int v27; // [sp+4Ch] [bp-43Ch]@9
  int v28; // [sp+60h] [bp-428h]@9
  char v29; // [sp+74h] [bp-414h]@27
  char v30; // [sp+8Ch] [bp-3FCh]@27
  char v31; // [sp+94h] [bp-3F4h]@23
  int v32; // [sp+3B4h] [bp-D4h]@23
  char v33; // [sp+3B8h] [bp-D0h]@44
  char s1; // [sp+3D8h] [bp-B0h]@1
  char v35; // [sp+3F8h] [bp-90h]@2
  int v36; // [sp+418h] [bp-70h]@9
  int v37; // [sp+42Ch] [bp-5Ch]@9
  char v38; // [sp+440h] [bp-48h]@8
  int v39; // [sp+454h] [bp-34h]@7

  v1 = a1;
  result = get_value_post(a1, "act", &s1, 32);
  if ( !result )
    return result;
  if ( get_value_post(v1, "reboot", &v35, 32) )
  {
    v4 = strcmp(&v35, "reboot");
    v3 = 1 - v4;
    if ( (unsigned int)v4 > 1 )
      v3 = 0;
  }
  else
  {
    v3 = 0;
  }
  if ( !strcmp(&s1, "submit") )
  {
    dhcpd_read_config(&v23);
    strcpy((char *)&v39, "");
    if ( get_ip_value_post(v1, "ip", &v39) && get_ip_value_post(v1, "sm", &v38) )
    {
      set_use_local_gateway(0);
      set_lan_ipconfig(&v39, &v38, 0);
      sf_strncpy(&v26, &v39, 20);
      sf_strncpy(&v27, &v38, 20);
      get_subnet_range(&v39, &v38, &v24, &v25);
      get_ifconfig("br0", &v37, &v36);
      if ( !strcmp((const char *)&v28, (const char *)&v37) )
      {
        v5 = 1;
        sf_strncpy(&v28, &v39, 20);
      }
      else
      {
        v5 = 1;
      }
    }
    else
    {
      v5 = 0;
    }
    v6 = v5;
    if ( get_value_post(v1, "dhcp_enable", &v35, 32) && !strcmp(&v35, "on") )
    {
      v7 = dhcpd_set_op(1);
      dhcpd_stop(v7);
      if ( get_value_post(v1, "miprange", &v35, 32) && !strcmp(&v35, "on") )
      {
        if ( get_ip_value_post(v1, "spool_conf", &v35) )
          sf_strncpy(&v24, &v35, 20);
        if ( get_ip_value_post(v1, "epool_conf", &v35) )
          sf_strncpy(&v25, &v35, 20);
        v8 = 1;
      }
      else
      {
        v8 = 0;
      }
      v32 = v8;
      if ( !get_value_post(v1, "domain", &v31, 32) )
        strcpy(&v31, "");
      if ( check_unpermitted_chars(&v31) )
        strcpy(&v31, "");
      get_intvalue_post(v1, "leasetime", &v30);
      get_domain_name_server(&v28, &v29);
      set_autodns(1);
      v9 = get_value_post(v1, "dhcp_auto_detect", &v35, 32) && !strcmp(&v35, "on");
      set_dhcp_auto_detect(v9);
      syslog_msg(1, "@{43}");
      v10 = 1;
    }
    else
    {
      v11 = get_value_post(v1, "dhcp_enable", &v35, 32);
      if ( v11 )
      {
        v11 = strcmp(&v35, "off");
        v12 = v11;
        if ( !v11 )
        {
          dhcpd_set_op(0);
          set_dhcp_auto_detect(v12);
          set_dhcp_access_policy(v12);
          v13 = syslog_msg(2, "@{44}");
          v14 = check_twinip_enable(v13);
          if ( v14 )
            v14 = dhcpd_start(v14);
          v11 = dhcpd_stop(v14);
          v6 = 1;
        }
      }
      v10 = 0;
      if ( !v5 )
      {
LABEL_38:
        if ( v6 )
          v11 = dhcpd_flush_dynamic_lease(v11);
        if ( v10 )
          v11 = dhcpd_start(v11);
        if ( v3 )
        {
          v15 = hwinfo_get_reboot_duration(v11);
          v11 = check_remote_connection();
          v16 = v11;
          if ( !v11 )
          {
            get_ip_value_post(v1, "ip", &v39);
            v11 = sf_strncpy(&v33, &v39, 32);
          }
          v21 = v15 + 30;
          goto LABEL_55;
        }
        goto LABEL_56;
      }
    }
    v11 = dhcpd_commit_config(&v23);
    goto LABEL_38;
  }
  v11 = strcmp(&s1, "part");
  v17 = v11;
  if ( !v11 )
  {
    if ( get_value_post(v1, "dhcp_access_policy", &v35, 32) )
    {
      v18 = dhcpd_set_op(1);
      dhcpd_stop(v18);
      if ( !strcmp(&v35, "on") )
        v19 = 1;
      else
        v19 = v17;
      v20 = set_dhcp_access_policy(v19);
      dhcpd_start(v20);
    }
    v11 = get_value_post(v1, "mac_restrict", &v35, 32);
    if ( v11 )
    {
      strcmp(&v35, "on");
      v11 = set_ipmac_bind();
    }
  }
  if ( v3 )
  {
    v16 = 0;
    v21 = 0;
LABEL_55:
    v11 = saveconf(v11);
    goto LABEL_57;
  }
LABEL_56:
  v16 = 0;
  v21 = 0;
LABEL_57:
  v22 = signal_update(v11);
  result = signal_save(v22);
  if ( v3 )
  {
    printf("<script>");
    if ( !v16 )
      printf("document.refreshURL = '%s';\n", &v33);
    printf("document.rebootDuration = %d;", v21);
    printf("</script>");
    result = signal_reboot(3);
  }
  return result;
}
// E798: using guessed type int __fastcall dhcpd_start(_DWORD);
// E840: using guessed type int __fastcall set_autodns(_DWORD);
// E8A0: using guessed type int __fastcall get_intvalue_post(_DWORD, _DWORD, _DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E8F4: using guessed type int __fastcall set_dhcp_access_policy(_DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EBAC: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// ED38: using guessed type int __fastcall set_dhcp_auto_detect(_DWORD);
// EF9C: using guessed type int __fastcall dhcpd_set_op(_DWORD);
// EFCC: using guessed type int __fastcall dhcpd_flush_dynamic_lease(_DWORD);
// F110: using guessed type int __fastcall saveconf(_DWORD);
// F11C: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F470: using guessed type int syslog_msg(_DWORD, const char *, ...);
// F620: using guessed type int __fastcall dhcpd_read_config(_DWORD);
// F6B0: using guessed type int __fastcall signal_reboot(_DWORD);
// F770: using guessed type int __fastcall dhcpd_commit_config(_DWORD);
// F854: using guessed type int __fastcall set_use_local_gateway(_DWORD);
// F884: using guessed type int __fastcall dhcpd_stop(_DWORD);
// F95C: using guessed type int __fastcall get_domain_name_server(_DWORD, _DWORD);
// F9A4: using guessed type int check_remote_connection(void);
// FAF4: using guessed type int __fastcall get_subnet_range(_DWORD, _DWORD, _DWORD, _DWORD);
// FB0C: using guessed type int __fastcall set_lan_ipconfig(_DWORD, _DWORD, _DWORD);
// FB3C: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// FC20: using guessed type int set_ipmac_bind(void);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);
// FEB4: using guessed type int __fastcall check_twinip_enable(_DWORD);

//----- (00017DA0) --------------------------------------------------------
int __fastcall sub_17DA0(int a1, int a2)
{
  int v2; // r4@1

  v2 = a2;
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"netconf_hiddenlansetup\">");
  printf("</form>");
  printf("</BODY>");
  sub_1781C(v2);
  printf("<script>");
  puts("if(document.rebootDuration && parent.window.lansetup_reboot_process){");
  puts("parent.window.lansetup_reboot_process(document.rebootDuration, document.refreshURL);}");
  printf("else{UnMaskIt(parent.document,'apply_mask');}");
  return printf("</script>");
}

//----- (00017E20) --------------------------------------------------------
void __fastcall sub_17E20(int a1, signed int a2)
{
  signed int v2; // r7@1
  int v3; // r0@10
  int v4; // r3@15
  bool v5; // zf@15
  int v6; // r2@15
  char v7; // r3@15
  const char *v8; // r0@20
  char *v9; // r1@20
  char *v10; // r0@21
  int v11; // r5@25
  int v12; // r0@26
  int v13; // r4@27
  int v14; // r0@34
  int v15; // r0@34
  char *v16; // r0@36
  signed int v17; // r6@39
  void *v18; // r11@41
  int v19; // r7@41
  void *i; // r5@41
  bool v21; // nf@48
  unsigned __int8 v22; // vf@48
  int v23; // r6@51
  char *v24; // r0@52
  char *v25; // r0@52
  int v26; // r5@52
  int v27; // r1@52
  int v28; // r0@52
  int v29; // r1@52
  int v30; // r0@53
  int v31; // r0@55
  signed int v32; // r6@55
  signed int v33; // r1@56
  char *v34; // r0@58
  char *v35; // r0@60
  int v36; // r10@60
  int v37; // r5@65
  int v38; // r1@65
  int v39; // r0@65
  int v40; // r1@65
  int v41; // r0@66
  int v42; // r0@68
  signed int v43; // r1@69
  int v44; // r4@18
  signed int v45; // [sp+0h] [bp-2E0h]@0
  int *v46; // [sp+4h] [bp-2DCh]@0
  int *v47; // [sp+8h] [bp-2D8h]@0
  int *v48; // [sp+Ch] [bp-2D4h]@0
  void *ptr; // [sp+10h] [bp-2D0h]@36
  int v50; // [sp+14h] [bp-2CCh]@36
  signed int v51; // [sp+18h] [bp-2C8h]@2
  int v52; // [sp+1Ch] [bp-2C4h]@49
  char v53; // [sp+24h] [bp-2BCh]@52
  char v54; // [sp+124h] [bp-1BCh]@52
  char v55; // [sp+150h] [bp-190h]@52
  char v56; // [sp+190h] [bp-150h]@18
  char v57; // [sp+1D0h] [bp-110h]@27
  char v58; // [sp+1F0h] [bp-F0h]@3
  int v59; // [sp+218h] [bp-C8h]@17
  int v60; // [sp+21Ch] [bp-C4h]@17
  int v61; // [sp+220h] [bp-C0h]@17
  int v62; // [sp+224h] [bp-BCh]@17
  char v63; // [sp+228h] [bp-B8h]@22
  char v64; // [sp+240h] [bp-A0h]@7
  char s[20]; // [sp+254h] [bp-8Ch]@8
  char v66; // [sp+268h] [bp-78h]@52
  char s1; // [sp+27Ch] [bp-64h]@36
  char v68; // [sp+290h] [bp-50h]@36
  char v69; // [sp+2A4h] [bp-3Ch]@36

  v2 = a2;
  if ( !a2 )
  {
    v51 = a2;
    goto LABEL_36;
  }
  if ( get_value_post(a2, "act", &v58, 32) && !strcmp(&v58, "add") )
  {
    if ( !get_value_post(v2, "manual_check", &v58, 32) || strcmp(&v58, "on") )
    {
      v11 = 0;
      while ( 1 )
      {
        v45 = 32;
        v12 = get_value_array_post(v2, "addlease", v11++, &v58);
        v5 = v12 == 0;
        v10 = &v58;
        if ( v5 )
          break;
        v13 = atoi(&v58);
        sprintf(&v57, "m%d", v13);
        v5 = get_value_post(v2, &v57, s, 20) == 0;
        v10 = s;
        if ( v5 )
          break;
        v5 = check_unpermitted_chars(s) == 0;
        v10 = &v57;
        if ( !v5 )
          break;
        sprintf(&v57, "i%d", v13);
        v5 = get_value_post(v2, &v57, &v64, 20) == 0;
        v10 = &v64;
        if ( v5 )
          break;
        v5 = check_unpermitted_chars(&v64) == 0;
        v10 = &v64;
        if ( !v5 )
          break;
        dhcpd_add_static_lease(&v64, s);
      }
      goto LABEL_34;
    }
    if ( get_value_post(v2, "manual_ip", &v64, 20) )
    {
      if ( get_value_post(v2, "manual_hw", s, 20) )
      {
        if ( !check_unpermitted_chars(&v64) )
        {
          v3 = check_unpermitted_chars(s);
          if ( !v3 )
          {
            while ( 1 )
            {
              v4 = (unsigned __int8)s[v3];
              v5 = v4 == 0;
              v6 = v4 - 97;
              v7 = v4 - 32;
              if ( v5 )
                break;
              if ( (unsigned int)v6 <= 0x19 )
                s[v3] = v7;
              ++v3;
            }
            v45 = (signed int)&v59;
            v46 = &v60;
            v47 = &v61;
            v48 = &v62;
            if ( sscanf(s, "%02X:%02X:%02X:%02X:%02X:%02X") == 6 )
            {
              snprintf2(&v56, 64, "slease_%s", s, &v59, &v60, &v61, &v62);
              v44 = dhcpd_add_static_lease(&v64, s);
              convert_mac(s);
              if ( v44 == 1 )
              {
                v9 = &v64;
                v8 = "<script> alert(STATIC_LEASE_ALREADY_EXIST_IPADDRESS + ':%s'); </script>";
              }
              else
              {
                if ( v44 != 2 )
                {
                  v10 = (char *)get_value_post(v2, "desc", &v63, 24);
                  if ( v10 )
                  {
                    v10 = (char *)check_unpermitted_chars(&v63);
                    if ( !v10 )
                      v10 = (char *)iconfig_set_value_direct(&v56, &v63);
                  }
                  goto LABEL_34;
                }
                v8 = "<script> alert(STATIC_LEASE_ALREADY_EXIST_HWADDRESS + ':%s'); </script>";
                v9 = s;
              }
              v10 = (char *)printf(v8, v9);
LABEL_34:
              v14 = dhcpd_stop(v10);
              v51 = 1;
              v15 = dhcpd_start(v14);
              signal_save(v15);
              goto LABEL_36;
            }
          }
        }
      }
    }
  }
  v51 = 0;
LABEL_36:
  ptr = malloc(0xBC00u);
  memset(ptr, 0, 0xBC00u);
  v50 = get_hostinfo_from_arp("br0", 256, ptr);
  get_ifconfig("br0", &v69, &v68);
  sub_1644C();
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0;\">");
  puts("<script>");
  puts("function ClickEventPropagater(e){");
  puts("if(!e) e = window.event;");
  printf("e.cancelbubble = true; if(e.stopPropagation)\te.stopPropagation();");
  puts("}");
  puts("</script>");
  printf("<form name=\"lan_pcinfo_fm\" method=\"post\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=lan_pcinfo>");
  printf("<input type=hidden name=act value=>");
  printf("<input type=hidden name=clickedbg value=>");
  printf("<input type=hidden name=clickedid value=>");
  printf("<input type=hidden name=manual_check value=>");
  printf("<input type=hidden name=manual_ip value=>");
  printf("<input type=hidden name=manual_hw value=>");
  printf("<input type=hidden name=desc value=>");
  printf("<table class=\"lansetup_main_table\" style=\"width:100%%;\">\n");
  printf("<COL width=\"110\"><COL width=\"160\"><COL width=\"150\"><COL width=\"130\"><COL width=\"%%%%\">");
  v16 = getenv("REMOTE_ADDR");
  get_internal_pc_hardware_address(v16, &s1);
  v17 = s1 && sub_177D0((int)ptr, v50, &s1) && !dhcpd_search_static_lease(0, &s1);
  v18 = ptr;
  v19 = 0;
  for ( i = ptr; ; i = (char *)i + 188 )
  {
    v22 = __OFSUB__(v19, v50);
    v21 = v19++ - v50 < 0;
    if ( !(v21 ^ v22) )
      break;
    if ( !dhcpd_search_static_lease((char *)i + 128, 0)
      && !dhcpd_search_static_lease(0, (char *)i + 148)
      && strcmp(&s1, (const char *)i + 148)
      && check_same_network((char *)i + 128, &v69, &v68) )
      ++v17;
  }
  v52 = v17 > 5;
  if ( s1 && sub_177D0((int)ptr, v50, &s1) && (v23 = dhcpd_search_static_lease(0, &s1)) == 0 )
  {
    printf(
      "<tr class=\"lansetup_main_tr\" height=\"24\" style=\"background-color:#%s; cursor:pointer;\" id=\"addlease_line%d\" \t\t\t\tonclick=\"if(parent.window.onclick_list_tr)parent.window.onclick_list_tr(document, %d);\">",
      "FFFFFF",
      0,
      0,
      v45,
      v46,
      v47,
      v48);
    printf("<td class=\"lansetup_main_td\">");
    v24 = getenv("REMOTE_ADDR");
    printf("<span class=\"lansetup_main_span\" style=\"padding-left:5px\">%s</span>", v24);
    printf("</td>");
    printf("<td class=\"lansetup_main_td\">");
    sf_strncpy(&v66, &s1, 20);
    convert_mac(&s1);
    printf("<span class=\"lansetup_main_span\" style=\"padding-left:5px\">%s</span>", &s1);
    printf("</td>");
    convert_mac2(&s1);
    sf_strncpy(&s1, &v66, 20);
    memset(&v54, 0, 0x6Cu);
    v25 = getenv("REMOTE_ADDR");
    v26 = dhcpd_get_dynamic_lease(v25, &v54);
    printf("<td class=\"lansetup_main_td\">");
    memset(&v53, 0, 0x100u);
    convert_euckr_to_utf8(&v55, &v53);
    printf(
      "<span class=\"lansetup_main_span lansetup_ellipsis\" style=\"width:145px; padding-left:5px\">%s</span>",
      &v53);
    printf("</td>");
    printf("<td class=\"lansetup_main_td\">");
    printf("<span class=\"lansetup_main_span lansetup_ellipsis\" style=\"width:130px; padding-left:5px\">");
    v28 = sub_134F4(472, v27);
    printf((const char *)v28);
    if ( v26 )
      v30 = 441;
    else
      v30 = 469;
    v31 = sub_134F4(v30, v29);
    v32 = 1;
    printf(":%s</span>", v31);
    printf("</td>");
    printf("<td class=\"lansetup_main_td\" align=\"right\">");
    if ( v52 )
      v33 = 5;
    else
      v33 = 17;
    printf((const char *)&unk_5E9C1, v33);
    printf("</td>");
    printf("</tr>");
    printf("<input type=\"hidden\" name=m%d value=\"%s\">\n", 0, &s1);
    v34 = getenv("REMOTE_ADDR");
    printf("<input type=\"hidden\" name=i%d value=\"%s\">\n", 0, v34);
    printf("<input type=\"hidden\" name=h%d value=\"%s\">\n", 0, &v53);
    printf("<input type=\"hidden\" name=\"curpc\" value=\"1\">");
  }
  else
  {
    v32 = 0;
  }
  v35 = getenv("REMOTE_ADDR");
  get_internal_pc_hardware_address(v35, &s1);
  v36 = 0;
  while ( v36 < v50 )
  {
    if ( !dhcpd_search_static_lease((char *)v18 + 128, 0)
      && !dhcpd_search_static_lease(0, (char *)v18 + 148)
      && strcmp(&s1, (const char *)v18 + 148)
      && check_same_network((char *)v18 + 128, &v69, &v68) )
    {
      printf("<tr class=\"lansetup_main_tr\" height=\"24\" style=\"background-color:#%s; cursor:pointer;\" id=\"addlease_line%d\" \t\t\tonclick=\"if(parent.window.onclick_list_tr)parent.window.onclick_list_tr(document, %d);\">");
      printf("<td class=\"lansetup_main_td\">");
      *((_BYTE *)v18 + 128);
      printf("<span class=\"lansetup_main_span\" style=\"padding-left:5px\">%s</span>");
      printf("</td>");
      sf_strncpy(&v66, (char *)v18 + 148, 20);
      convert_mac((char *)v18 + 148);
      printf("<td class=\"lansetup_main_td\">");
      printf("<span class=\"lansetup_main_span\" style=\"padding-left:5px\">%s</span>", (char *)v18 + 148);
      printf("</td>");
      convert_mac2((char *)v18 + 148);
      sf_strncpy((char *)v18 + 148, &v66, 20);
      memset(&v54, 0, 0x6Cu);
      v37 = dhcpd_get_dynamic_lease((char *)v18 + 128, &v54);
      printf("<td class=\"lansetup_main_td\">");
      memset(&v53, 0, 0x100u);
      convert_euckr_to_utf8(&v55, &v53);
      printf(
        "<span class=\"lansetup_main_span lansetup_ellipsis\" style=\"width:145px; padding-left:5px\">%s</span>",
        &v53);
      printf("</td>");
      printf("<td class=\"lansetup_main_td\">");
      printf("<span class=\"lansetup_main_span lansetup_ellipsis\" style=\"width:130px; padding-left:5px\">");
      v39 = sub_134F4(472, v38);
      printf((const char *)v39);
      if ( v37 )
        v41 = 441;
      else
        v41 = 469;
      v42 = sub_134F4(v41, v40);
      printf(":%s</span>", v42);
      printf("</td>");
      printf("<td class=\"lansetup_main_td\" align=\"right\">");
      if ( v52 )
        v43 = 5;
      else
        v43 = 17;
      printf(
        "<span class=\"lansetup_main_span\" style=\"padding-right:%dpx;\">\t\t\t<input type=\"checkbox\" class=navi_chk name=\"addlease\" id=\"addlease%d\" value=\"%d\" \t\t\tonclick=\"ClickEventPropagater(event);\">\t\t\t</span>",
        v43,
        v32,
        v32,
        v45,
        v46,
        v47,
        v48);
      printf("</td>");
      printf("</tr>");
      printf("<input type=hidden name=m%d value=\"%s\">\n", v32, (char *)v18 + 148);
      printf("<input type=hidden name=i%d value=\"%s\">\n", v32, (char *)v18 + 128);
      printf("<input type=hidden name=h%d value=\"%s\">\n", v32++, &v53);
    }
    ++v36;
    v18 = (char *)v18 + 188;
  }
  while ( v32 <= 4 )
  {
    printf("<tr class=\"lansetup_main_tr\" height=\"24\"style=\"background-color:#%s\">");
    printf("<td class=\"lansetup_main_td\" colspan=\"5\"></td>");
    printf("</tr>");
    ++v32;
  }
  puts("</table>");
  puts("</form>");
  puts("</BODY>");
  puts("<script>");
  if ( v51 )
    puts("if(parent.window.AddPostSubmit)parent.window.AddPostSubmit();");
  printf("</script>");
  free(ptr);
}
// E798: using guessed type int __fastcall dhcpd_start(_DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E8E8: using guessed type int __fastcall iconfig_set_value_direct(_DWORD, _DWORD);
// EA20: using guessed type int __fastcall get_hostinfo_from_arp(_DWORD, _DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EB70: using guessed type int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EE10: using guessed type int __fastcall convert_mac(_DWORD);
// EF84: using guessed type int __fastcall convert_mac2(_DWORD);
// F11C: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F368: using guessed type int __fastcall dhcpd_get_dynamic_lease(_DWORD, _DWORD);
// F4B8: using guessed type int __fastcall convert_euckr_to_utf8(_DWORD, _DWORD);
// F800: using guessed type int __fastcall dhcpd_add_static_lease(_DWORD, _DWORD);
// F884: using guessed type int __fastcall dhcpd_stop(_DWORD);
// F9BC: using guessed type int __fastcall get_value_array_post(_DWORD, _DWORD, _DWORD, _DWORD);
// FBFC: using guessed type int __fastcall check_same_network(_DWORD, _DWORD, _DWORD);
// FC08: using guessed type int __fastcall dhcpd_search_static_lease(_DWORD, _DWORD);
// 17E20: using guessed type char s[20];

//----- (00018844) --------------------------------------------------------
int __fastcall sub_18844(int a1, signed int a2)
{
  signed int v2; // r6@1
  int i; // r5@6
  bool v4; // zf@7
  char *v5; // r0@7
  int v6; // r0@10
  signed int v7; // r11@12
  void *v8; // r7@15
  int v9; // r10@15
  int v10; // r0@16
  int v11; // r0@17
  bool v12; // cf@17
  int v13; // r4@21
  void *v14; // r6@21
  void *v15; // r5@21
  int v16; // r9@21
  int v17; // r1@22
  bool v18; // nf@23
  unsigned __int8 v19; // vf@23
  const char *v20; // r0@23
  int v21; // r0@25
  signed int v22; // r1@27
  char *v23; // r12@29
  char *v24; // r0@31
  signed int j; // r4@35
  int result; // r0@38
  signed int v27; // [sp+0h] [bp-1C0h]@0
  void *base; // [sp+8h] [bp-1B8h]@12
  int nmemb; // [sp+Ch] [bp-1B4h]@12
  signed int v30; // [sp+10h] [bp-1B0h]@2
  int v31; // [sp+14h] [bp-1ACh]@19
  char s; // [sp+1Ch] [bp-1A4h]@19
  char v33; // [sp+11Ch] [bp-A4h]@20
  char v34; // [sp+15Ch] [bp-64h]@3
  char v35; // [sp+170h] [bp-50h]@7
  char v36; // [sp+184h] [bp-3Ch]@16

  v2 = a2;
  if ( a2 )
  {
    if ( get_value_post(a2, "act", &v34, 20) || !strcmp(&v34, "remove") )
    {
      for ( i = 0; ; ++i )
      {
        v27 = 20;
        v4 = get_value_array_post(v2, "dellease", i, &v35) == 0;
        v5 = &v35;
        if ( v4 )
          break;
        dhcpd_remove_static_lease(&v35, 0);
      }
      if ( i )
      {
        v6 = dhcpd_stop(&v35);
        v5 = (char *)dhcpd_start(v6);
      }
      signal_save(v5);
      v30 = 1;
    }
    else
    {
      v30 = 0;
    }
  }
  else
  {
    v30 = a2;
  }
  sub_1644C();
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0;\">");
  puts("<script>");
  puts("function ClickEventPropagater(e){");
  puts("if(!e) e = window.event;");
  printf("e.cancelbubble = true; if(e.stopPropagation)\te.stopPropagation();");
  puts("}");
  puts("</script>");
  printf("<form name=\"static_lease_fm\" method=\"post\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=static_lease>");
  printf("<input type=hidden name=act value=>");
  printf("<table class=\"lansetup_main_table\" style=\"width:100%%;\">\n");
  printf("<COL width=\"110\"><COL width=\"160\"><COL width=\"150\"><COL width=\"130\"><COL width=\"%%%%\">");
  v7 = 0;
  base = malloc(0x6C00u);
  memset(base, 0, 0x6C00u);
  nmemb = dhcpd_get_all_static_lease(base, 256);
  qsort(base, nmemb, 0x6Cu, (__compar_fn_t)sub_165E4);
  while ( v7 < nmemb )
    ++v7;
  v8 = base;
  v9 = 0;
  while ( v9 < nmemb )
  {
    printf("<tr class=\"lansetup_main_tr\" height=\"24\" style=\"background-color:#%s; cursor:pointer;\" \t\t\tonclick=\"if(parent.window.onclick_static_tr)parent.window.onclick_static_tr(document, %d);\">");
    v10 = get_wan_ip("wan1", &v36);
    if ( v10 )
    {
      v11 = strcmp(&v36, (const char *)v8);
      v12 = (unsigned int)v11 <= 1;
      v10 = 1 - v11;
      if ( !v12 )
        v10 = 0;
    }
    v31 = v10;
    memset(&s, 0, 0x100u);
    sf_strncpy(&s, (char *)v8 + 44, 256);
    if ( !s )
    {
      snprintf2(&v33, 64, "slease_%s", (char *)v8 + 20, v27);
      iconfig_get_value_direct(&v33, &s);
    }
    printf("<td class=\"lansetup_main_td\">");
    printf("<span class=\"lansetup_main_span\" style=\"padding-left:5px\">%s</span>", v8);
    printf("</td>");
    convert_mac((char *)v8 + 20);
    printf("<td class=\"lansetup_main_td\">");
    printf("<span class=\"lansetup_main_span\" style=\"padding-left:5px\">%s</span>", (char *)v8 + 20);
    printf("</td>");
    convert_mac2((char *)v8 + 20);
    printf("<td class=\"lansetup_main_td\">");
    printf("<span class=\"lansetup_main_span lansetup_ellipsis\" style=\"width:145px; padding-left:5px\">%s</span>", &s);
    printf("</td>");
    printf("<td class=\"lansetup_main_td\">");
    memset(&s, 0, 0x100u);
    v13 = 0;
    v14 = malloc(0xBC00u);
    v15 = v14;
    v16 = get_hostinfo_from_bridge(1, 256, v14);
    while ( 1 )
    {
      v19 = __OFSUB__(v13, v16);
      v18 = v13 - v16 < 0;
      v20 = (char *)v15 + 148;
      ++v13;
      if ( !(v18 ^ v19) )
        break;
      v15 = (char *)v15 + 188;
      if ( !strcasecmp(v20, (const char *)v8 + 20) )
      {
        v21 = sub_134F4(472, v17);
        sf_strncpy(&s, v21, 256);
        break;
      }
    }
    free(v14);
    printf("<span class=\"lansetup_main_span lansetup_ellipsis\" style=\"width:130px; padding-left:5px\">%s</span>", &s);
    printf("</td>");
    printf("<td class=\"lansetup_main_td\" align=\"right\">");
    if ( v7 <= 5 )
      v22 = 17;
    else
      v22 = 5;
    v23 = "disabled";
    if ( !v31 )
      v23 = "";
    printf(
      "<span class=\"lansetup_main_span\" style=\"padding-right:%dpx;\">\t\t\t<input type=\"checkbox\" class=navi_chk name=\"dellease\" id=\"dellease%d\" value=\"%s\" \t\t\tonclick=\"ClickEventPropagater(event);\" %s></span>",
      v22,
      v9,
      v8,
      v23);
    printf("</td>");
    printf("</tr>");
    v24 = getenv("REMOTE_ADDR");
    if ( !strcmp(v24, (const char *)v8) )
      printf("<input type=\"hidden\" name=\"curpc\" value=\"1\">");
    ++v9;
    v8 = (char *)v8 + 108;
  }
  for ( j = v9; j <= 4; ++j )
  {
    printf("<tr class=\"lansetup_main_tr\" height=\"24\"style=\"background-color:#%s\">");
    printf("<td class=\"lansetup_main_td\" colspan=\"5\"></td>");
    printf("</tr>");
  }
  free(base);
  puts("</table>");
  puts("</form>");
  result = puts("</BODY>");
  if ( v30 )
    result = printf("<script> if(parent.window.RemovePostSubmit)parent.window.RemovePostSubmit(); </script>");
  return result;
}
// E798: using guessed type int __fastcall dhcpd_start(_DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E9FC: using guessed type int __fastcall get_hostinfo_from_bridge(_DWORD, _DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EDF8: using guessed type int __fastcall dhcpd_remove_static_lease(_DWORD, _DWORD);
// EE10: using guessed type int __fastcall convert_mac(_DWORD);
// EF84: using guessed type int __fastcall convert_mac2(_DWORD);
// F1C4: using guessed type int __fastcall iconfig_get_value_direct(_DWORD, _DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F578: using guessed type int __fastcall dhcpd_get_all_static_lease(_DWORD, _DWORD);
// F884: using guessed type int __fastcall dhcpd_stop(_DWORD);
// F8CC: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);
// F9BC: using guessed type int __fastcall get_value_array_post(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00018CFC) --------------------------------------------------------
signed int __fastcall sub_18CFC(int a1)
{
  int v1; // r5@1
  int v2; // r0@12
  int v3; // r0@18
  int v4; // r0@21
  int v5; // r0@22
  char v7; // [sp+0h] [bp-170h]@4
  char dest; // [sp+80h] [bp-F0h]@4
  char v9; // [sp+100h] [bp-70h]@9
  char v10; // [sp+120h] [bp-50h]@1
  char v11; // [sp+140h] [bp-30h]@11
  char v12; // [sp+150h] [bp-20h]@19

  v1 = a1;
  if ( !get_value_post(a1, "act", &v10, 31) )
    return 0;
  if ( strcmp(&v10, "save") )
  {
    if ( !strcmp(&v10, (const char *)&unk_5F0E6) )
    {
      strcpy(&v9, "");
      if ( get_value_post(v1, "http_auth", &v9, 15) )
      {
        set_http_auth_method(&v9);
        if ( !strcmp(&v9, "session") )
        {
          if ( get_value_post(v1, "use_captcha", &v11, 16) )
          {
            v2 = strcmp(&v11, "off");
            if ( v2 )
            {
              if ( !strcmp(&v11, "manual") )
                v2 = 2;
              else
                v2 = 1;
            }
            set_use_captcha_code(v2);
          }
          if ( get_value_post(v1, "captcha_attempt", &v11, 16) )
          {
            v3 = atoi(&v11);
            set_client_login_trial_count_without_captchar(v3);
          }
          strcpy(&v12, "");
          if ( get_value_post(v1, "http_session_timeout", &v12, 15) && v12 )
          {
            v4 = atoi(&v12);
            httpcon_set_session_timeout(60 * v4);
          }
        }
      }
      goto LABEL_22;
    }
    return 0;
  }
  if ( !sub_13298(v1) )
    return 0;
  strcpy(&dest, "");
  strcpy(&v7, "");
  get_value_post(v1, "new_passwd", &dest, 127);
  get_value_post(v1, &unk_5F0D6, &v7, 127);
  if ( check_unpermitted_chars(&v7) || !v7 && !dest )
    return 0;
  save_password(&v7, &dest);
LABEL_22:
  v5 = syslog_msg(1, "@{37}");
  signal_save(v5);
  signal_start("httpd");
  puts("<script>");
  puts("function GotoLoginPage(method)\n\t\t{\n\t\t\tif(method == 'session')\n\t\t\t\ttop.location.href='/sess-bin/login_session.cgi?logout=1';\n\t\t\telse if(method == 'basic')\n\t\t\t\ttop.location.href='/login/login.cgi';\n\t\t}");
  strcpy(&v9, "");
  get_http_auth_method(&v9);
  if ( v9 )
    printf("setTimeout(\"GotoLoginPage('%s')\", 4000);\n", &v9);
  puts("</script>");
  return 1;
}
// E864: using guessed type int __fastcall set_client_login_trial_count_without_captchar(_DWORD);
// E9E4: using guessed type int __fastcall get_http_auth_method(_DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EBA0: using guessed type int __fastcall set_http_auth_method(_DWORD);
// EC30: using guessed type int __fastcall save_password(_DWORD, _DWORD);
// EE1C: using guessed type int __fastcall signal_start(_DWORD);
// F014: using guessed type int __fastcall httpcon_set_session_timeout(_DWORD);
// F11C: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F470: using guessed type int syslog_msg(_DWORD, const char *, ...);
// F92C: using guessed type int __fastcall set_use_captcha_code(_DWORD);

//----- (00018FAC) --------------------------------------------------------
int __fastcall sub_18FAC(int a1, int a2)
{
  int v2; // r5@1
  signed int v3; // r6@1
  char *v4; // r0@5
  char *v5; // r0@9
  char *v6; // r0@13
  int v7; // r0@15
  char *v8; // r0@20
  char *v9; // r0@23
  int v10; // r0@25
  int v11; // r0@29
  int v13; // [sp+0h] [bp-B0h]@3
  char v14; // [sp+80h] [bp-30h]@1

  v2 = a2;
  v3 = sub_18CFC(a2);
  if ( get_value_post(v2, "act", &v14, 32) )
  {
    if ( !strcmp(&v14, "apply_email") )
    {
      if ( !get_value_post(v2, "email", &v13, 128) || check_unpermitted_chars(&v13) )
        v4 = "";
      else
        v4 = (char *)&v13;
      set_admin_email(v4);
      if ( !get_value_post(v2, "smtp", &v13, 128) || check_unpermitted_chars(&v13) )
        v5 = "";
      else
        v5 = (char *)&v13;
      set_smtp_server(v5);
      if ( !get_value_post(v2, &unk_5F238, &v13, 128) || check_unpermitted_chars(&v13) )
        v6 = "";
      else
        v6 = (char *)&v13;
      set_send_email(v6);
      v7 = get_value_post(v2, "smtp_auth", &v13, 128);
      if ( v7 )
      {
        if ( !strcmp((const char *)&v13, "on") )
        {
          set_smtp_auth(1);
          if ( !get_value_post(v2, "account", &v13, 128) || check_unpermitted_chars(&v13) )
            v8 = "";
          else
            v8 = (char *)&v13;
          set_smtp_account(v8);
          if ( get_value_post(v2, "smtp_pass", &v13, 128) )
            v9 = (char *)&v13;
          else
            v9 = "";
          v10 = set_smtp_password(v9);
          goto LABEL_29;
        }
        v7 = 0;
      }
    }
    else
    {
      if ( strcmp(&v14, "delete_email") )
        goto LABEL_30;
      set_admin_email("");
      set_smtp_server("");
      set_send_email("");
      set_smtp_account("");
      set_smtp_password("");
      v7 = 0;
    }
    v10 = set_smtp_auth(v7);
LABEL_29:
    v11 = signal_update(v10);
    signal_save(v11);
  }
LABEL_30:
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"sysconf_hiddenloginsetup\">");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  printf("UnMaskIt(parent.document, 'apply_mask');");
  if ( v3 )
    printf("MaskIt(parent.document, 'relogin_mask');");
  return printf("</script>");
}
// E7EC: using guessed type int __fastcall set_smtp_password(_DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// ED98: using guessed type int __fastcall set_admin_email(_DWORD);
// EE40: using guessed type int __fastcall set_smtp_account(_DWORD);
// F11C: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F2D8: using guessed type int __fastcall set_smtp_server(_DWORD);
// FA7C: using guessed type int __fastcall set_smtp_auth(_DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);
// FE90: using guessed type int __fastcall set_send_email(_DWORD);

//----- (0001922C) --------------------------------------------------------
int sub_1922C()
{
  int v0; // r1@1
  int v1; // r0@1
  _UNKNOWN *v2; // r4@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r1@1
  int v8; // r0@1
  int v9; // r1@1
  int v10; // r0@1
  char *v11; // r4@1
  int v12; // r1@1
  int v13; // r0@1
  int v14; // r0@1
  int v15; // r1@1
  char *v16; // r5@2
  int v17; // r0@4
  int v18; // r0@4
  int v19; // r1@4
  int v20; // r0@6
  int v21; // r1@6
  int v22; // r0@6
  int v23; // r1@6
  int v24; // r0@6
  int v25; // r1@6
  int v26; // r0@6
  int v28; // [sp+0h] [bp-298h]@1
  char v29; // [sp+80h] [bp-218h]@6
  char v30; // [sp+100h] [bp-198h]@6
  char v31; // [sp+180h] [bp-118h]@1
  char v32; // [sp+200h] [bp-98h]@1

  printf("<form method=post action=timepro.cgi name=email_fm style=\"padding:0; margin:0;\">");
  puts("<input type=hidden name=tmenu value=sysconf>");
  puts("<input type=hidden name=smenu value=login>");
  puts("<input type=hidden name=act value=>");
  printf("<table class=\"v3_table login_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"100\"><COL width=\"145\"><COL width=\"152\"><COL width=\"145\"><COL width=\"70\"><COL width=\"30\">");
  printf("<tr class=\"login_main_tr\" height=\"24\" style=\"background-color:#E3E3E3; border-top:1px #CCC solid; border-bottom:1px #CCC solid;\">\t\t<td class=\"login_main_td\" colspan=\"4\">");
  v1 = sub_134F4(933, v0);
  printf("<p class=\"login_main_p\"><b>%s</b></p>", v1);
  printf("</td><td class=\"login_main_td\" align=\"right\">");
  v2 = sub_126C4();
  v4 = sub_134F4(118, v3);
  printf(
    "<span class=\"login_main_span\" onclick=\"DeleteEmailConfig();\" style=\"width:55px; cursor:pointer;\">\t\t<img src=\"/%s/minus_icon.gif\" style=\"margin-right:5px;\">%s</span>",
    v2,
    v4);
  printf("</td><td class=\"login_main_td\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"5\"><td class=\"login_main_td\" colspan=\"6\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  v6 = sub_134F4(932, v5);
  printf("<p class=\"login_main_p\">%s</p>", v6);
  printf("</td><td class=\"login_main_td\">");
  get_admin_email(&v32);
  printf("<input type=text name=email style=\"width:140px;\" maxlength=120 value=%s>", &v32);
  printf("</td><td class=\"login_main_td\" align=\"right\">");
  v8 = sub_134F4(944, v7);
  printf("<span class=\"login_main_span\" style=\"margin-right:10px;\">%s</span>", v8);
  printf("</td><td class=\"login_main_td\">");
  get_smtp_server(&v31);
  printf("<input type=text name=smtp style=\"width:140px;\" maxlength=120 value=%s>", &v31);
  printf("</td><td class=\"login_main_td\" colspan=\"2\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  v10 = sub_134F4(940, v9);
  v11 = "checked";
  printf("<p class=\"login_main_p\">%s</p>", v10);
  printf("</td><td class=\"login_main_td\">");
  get_send_email(&v28);
  printf("<input type=text name=send_email style=\"width:140px;\" maxlength=120 value=%s>", &v28);
  printf("</td><td class=\"login_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  v13 = sub_134F4(945, v12);
  printf("<p class=\"login_main_p\">%s</p>", v13);
  printf("</td><td class=\"login_main_td\" colspan=\"5\">");
  v14 = printf("<span class=\"login_main_span\">");
  if ( get_smtp_auth(v14) )
    v16 = "checked";
  else
    v16 = "";
  v17 = sub_134F4(947, v15);
  printf(
    "<input type=radio id=\"smtptrue\" name=smtp_auth %s value=on onclick=\"ChangeAuth();\"><label for=\"smtptrue\">%s</label>",
    v16,
    v17);
  v18 = printf("</span><span class=\"login_main_span\" style=\"margin-left:15px;\">");
  if ( get_smtp_auth(v18) )
    v11 = "";
  v20 = sub_134F4(946, v19);
  printf(
    "<input type=radio id=\"smtpfalse\" name=smtp_auth %s value=off onclick=\"ChangeAuth();\"><label for=\"smtpfalse\">%s</label>",
    v11,
    v20);
  printf("</span>");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  v22 = sub_134F4(942, v21);
  printf("<p class=\"login_main_p\">%s</p>", v22);
  printf("</td><td class=\"login_main_td\" colspan=\"3\">");
  get_smtp_account(&v30);
  printf("<input type=text name=account style=\"width:140px;\" maxlength=120 value=\"%s\">", &v30);
  v24 = sub_134F4(943, v23);
  printf("<span class=\"login_main_span\" style=\"margin:0 5px 0 15px;\">%s</span>", v24);
  get_smtp_password(&v29);
  printf("<input type=password name=smtp_pass style=\"width:140px;\" maxlength=120 value=\"");
  sub_11658(&v29);
  printf("\">");
  printf("</td><td class=\"login_main_td\" align=\"right\">");
  printf("<button class=\"login_main_button\" style=\"width:55px;\" onclick=\"ChangeEmailConfig(); return ClickEventPropagater(event);\">");
  v26 = sub_134F4(28, v25);
  printf("<span class=\"login_main_span\">%s</span>", v26);
  printf("</button>");
  printf("</td><td class=\"login_main_td\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"5\" style=\"border-bottom:1px #CCC solid;\"><td class=\"login_main_td\" colspan=\"6\">");
  printf("</td></tr>");
  printf("</table>");
  printf("</form>");
  puts("<script language=JavaScript>");
  puts("ChangeAuth();");
  return printf("</script>");
}
// EDA4: using guessed type int __fastcall get_smtp_auth(_DWORD);
// EEB8: using guessed type int __fastcall get_smtp_password(_DWORD);
// F554: using guessed type int __fastcall get_smtp_account(_DWORD);
// FB00: using guessed type int __fastcall get_smtp_server(_DWORD);
// FCB0: using guessed type int __fastcall get_admin_email(_DWORD);
// FDDC: using guessed type int __fastcall get_send_email(_DWORD);

//----- (000195E4) --------------------------------------------------------
int sub_195E4()
{
  int v0; // r10@1
  int v1; // r4@2
  int v2; // r1@5
  int v3; // r0@5
  char *v4; // r5@5
  char *v5; // r8@5
  int v6; // r1@5
  char *v7; // r4@6
  int v8; // r0@8
  int v9; // r1@8
  int v10; // r0@8
  int v11; // r1@8
  int v12; // r0@10
  int v13; // r0@10
  int v14; // r4@10
  int v15; // r1@10
  int v16; // r5@10
  int v17; // r0@10
  int v18; // r1@10
  int v19; // r0@10
  int v20; // r1@10
  char *v21; // r4@11
  int v22; // r0@13
  int v23; // r1@13
  char *v24; // r4@14
  int v25; // r0@16
  int v26; // r1@16
  int v27; // r0@18
  int v28; // r0@18
  int v29; // r0@18
  int v30; // r1@18
  int v31; // r0@18
  int v32; // r1@18
  int v33; // r0@18
  int v34; // r0@18
  int v35; // r1@19
  int v36; // r0@19
  unsigned __int8 v38; // [sp+0h] [bp-100h]@1
  char dest; // [sp+80h] [bp-80h]@1
  char v40; // [sp+C0h] [bp-40h]@5

  v0 = get_captcha_usage_type();
  strcpy(&dest, "");
  strcpy((char *)&v38, "");
  get_id_password(&dest, &v38);
  if ( dest )
  {
    v1 = 1 - v38;
    if ( v38 > 1u )
      v1 = 0;
  }
  else
  {
    v1 = 1;
  }
  printf("<form method=post action=timepro.cgi name=session_fm style=\"padding:0; margin:0;\">");
  puts("<input type=hidden name=tmenu value=sysconf>");
  puts("<input type=hidden name=smenu value=login>");
  puts("<input type=hidden name=act value=>");
  printf("<input type=hidden name=noid value=%d>\n", v1);
  get_http_auth_method(&v40);
  printf("<input type=hidden name=prev_auth_method value=%s>\n", &v40);
  printf("<table class=\"v3_table login_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"100\"><COL width=\"450\"><COL width=\"62\"><COL width=\"30\">");
  printf("<tr class=\"login_main_tr\" height=\"24\" style=\"background-color:#E3E3E3; border-top:1px #CCC solid; border-bottom:1px #CCC solid;\">\t\t<td class=\"login_main_td\" colspan=\"4\">");
  v3 = sub_134F4(969, v2);
  v4 = "checked";
  v5 = "selected";
  printf("<p class=\"login_main_p\"><b>%s</b></p>", v3);
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  if ( !strcmp(&v40, "basic") )
    v7 = "checked";
  else
    v7 = "";
  v8 = sub_134F4(494, v6);
  printf(
    "<input type=radio id=\"authh\" name=http_auth value=basic %s onclick=\"InitLogin();\"><label for=\"authh\">%s</label>",
    v7,
    v8);
  printf("</td><td class=\"login_main_td\">");
  v10 = sub_134F4(929, v9);
  printf("<span class=\"login_main_span\">%s</span>", v10);
  printf("</td><td class=\"login_main_td\" colspan=\"2\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  if ( !strcmp(&v40, "basic") )
    v4 = "";
  v12 = sub_134F4(506, v11);
  printf(
    "<input type=radio id=\"auths\" name=http_auth value=session %s onclick=\"InitLogin();\"><label for=\"auths\">%s</label>",
    v4,
    v12);
  v13 = printf("</td><td class=\"login_main_td\" colspan=3>");
  v14 = httpcon_get_session_timeout(v13);
  v16 = sub_134F4(119, v15);
  v17 = sub_43AF4(v14, 60);
  printf(
    "<input type=text name=http_session_timeout value=%d size=3 maxlength=3 style='text-align: center;'> %s\n",
    v17,
    v16);
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  printf("</td><td class=\"login_main_td\">");
  v19 = sub_134F4(1145, v18);
  printf("%s", v19);
  printf("<select name='use_captcha' onchange='onChangeCaptchaUsage();' style='margin-left: 10px; height: 20px; border: 1px solid #CCC;'>");
  if ( v0 )
    v21 = "";
  else
    v21 = "selected";
  v22 = sub_134F4(1144, v20);
  printf("<option value='off' %s>%s</option>", v21, v22);
  if ( v0 == 1 )
    v24 = "selected";
  else
    v24 = "";
  v25 = sub_134F4(1140, v23);
  printf("<option value='always' %s>%s</option>", v24, v25);
  if ( v0 != 2 )
    v5 = "";
  v27 = sub_134F4(1143, v26);
  printf("<option value='manual' %s>%s</option>", v5, v27);
  v28 = printf("</select>");
  v29 = get_client_login_trial_count_without_captchar(v28);
  printf(
    "<input type='number' name='captcha_attempt' min=0 value=%d  style='width: 35px; text-align: center;margin: 0 5px; border: 1px solid #CCC;'>",
    v29);
  v31 = sub_134F4(1141, v30);
  printf("<p id='captcha_desc' style='display: inline;'>%s</p>", v31);
  printf("</td><td class=\"login_main_td\" align=\"right\">");
  printf("<button class=\"login_main_button\" style=\"width:55px;\" onclick=\"ApplySession(); return ClickEventPropagater(event);\">");
  v33 = sub_134F4(28, v32);
  printf("<span class=\"login_main_span\">%s</span>", v33);
  printf("</button>");
  printf("</td><td class=\"login_main_td\">");
  v34 = printf("</td></tr>");
  if ( check_default_pass(v34) )
  {
    printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
    printf("</td><td class=\"login_main_td\" colspan=3>");
    v36 = sub_134F4(1142, v35);
    printf("<span id='captcha_warning' style='color:gray;'>%s</span>", v36);
    printf("</td></tr>");
  }
  printf("</table>");
  printf("</form>");
  puts("<script language=JavaScript>");
  puts("InitLogin();");
  return printf("</script>");
}
// E9E4: using guessed type int __fastcall get_http_auth_method(_DWORD);
// F1A0: using guessed type int get_captcha_usage_type(void);
// F524: using guessed type int __fastcall check_default_pass(_DWORD);
// F8FC: using guessed type int __fastcall get_client_login_trial_count_without_captchar(_DWORD);
// FA04: using guessed type int __fastcall httpcon_get_session_timeout(_DWORD);
// FC98: using guessed type int __fastcall get_id_password(_DWORD, _DWORD);

//----- (000199C0) --------------------------------------------------------
int sub_199C0()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@2
  int v6; // r1@4
  int v7; // r0@4
  int v8; // r1@4
  int v9; // r0@5
  int v10; // r0@7
  int v11; // r1@7
  int v12; // r0@7
  int v13; // r1@7
  int v14; // r0@7
  int v15; // r1@7
  int v16; // r0@7
  int v17; // r1@7
  int v18; // r0@7
  int v19; // r1@7
  int v20; // r0@7
  int v21; // r1@7
  int v22; // r0@7
  int v23; // r1@7
  int v24; // r0@7
  int v26; // [sp+0h] [bp-1D0h]@1
  char v27; // [sp+80h] [bp-150h]@1
  char v28; // [sp+100h] [bp-D0h]@1
  char v29; // [sp+140h] [bp-90h]@1
  char v30; // [sp+180h] [bp-50h]@7
  char v31; // [sp+1A0h] [bp-30h]@7

  get_id_password(&v29, &v27);
  get_default_id_password(&v28, &v26);
  printf("<form method=post action=timepro.cgi name=login_fm style=\"padding:0; margin:0;\">");
  puts("<input type=hidden name=tmenu value=sysconf>");
  puts("<input type=hidden name=smenu value=login>");
  puts("<input type=hidden name=act value=>");
  printf("<table class=\"v3_table login_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"321\"><COL width=\"321\">");
  printf("<tr class=\"login_main_tr\" height=\"24\" style=\"background-color:#E3E3E3; border-top:1px #CCC solid; border-bottom:1px #CCC solid;\">\t\t<td class=\"login_main_td\" colspan=\"2\">");
  v1 = sub_134F4(941, v0);
  printf("<p class=\"login_main_p\"><b>%s</b></p>", v1);
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\" style=\"background-color:#FFFFFF;\"><td class=\"login_main_td\" colspan=\"2\">");
  printf("<table class=\"v3_table login_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"120\"><COL width=\"170\"><COL width=\"80\"><COL width=\"272\">");
  printf("<tr class=\"login_main_tr\" height=\"24\" style=\"background-color:#FFFFFF;\"><td class=\"login_main_td\">");
  v3 = sub_134F4(930, v2);
  printf("<p class=\"login_main_p\"><b>%s</b></p>", v3);
  printf("</td><td class=\"login_main_td\">");
  if ( v29 )
    v5 = (int)&v29;
  else
    v5 = sub_134F4(937, v4);
  printf("<span class=\"login_main_span\">%s</span>", v5);
  printf("</td><td class=\"login_main_td\">");
  v7 = sub_134F4(931, v6);
  printf("<p class=\"login_main_p\"><b>%s</b></p>", v7);
  printf("</td><td class=\"login_main_td\">");
  if ( v27 )
    v9 = 938;
  else
    v9 = 937;
  v10 = sub_134F4(v9, v8);
  printf("<span class=\"login_main_span\">%s</span>", v10);
  printf("</td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"5\"><td class=\"login_main_td\" colspan=\"2\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"72\"><td class=\"login_main_td\">");
  printf("<table class=\"v3_table login_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"100\"><COL width=\"145\"><COL width=\"76\">");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  v12 = sub_134F4(935, v11);
  printf("<p class=\"login_main_p\">%s</p>", v12);
  printf("</td><td class=\"login_main_td\">");
  puts("<input type=text name=new_login maxlength=32 style=\"width:140px\" value=>");
  printf("</td><td class=\"login_main_td\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  v14 = sub_134F4(936, v13);
  printf("<p class=\"login_main_p\">%s</p>", v14);
  printf("</td><td class=\"login_main_td\">");
  printf("<input type=password name=new_passwd style=\"width:140px\" maxlength=32 value=>");
  printf("<input type=text name=new_passwd_text style=\"display:none; ime-mode:disabled; width:140px;\" maxlength=32 value=>");
  printf("</td><td class=\"login_main_td\">");
  printf("<input type=checkbox id=passview NAME=password_view value=1 onclick=\"PasswordView(new_passwd,new_passwd_text,password_view);\" >");
  v16 = sub_134F4(1148, v15);
  printf("<label for=\"passview\">%s</label>", v16);
  printf("</td></tr>");
  v18 = sub_134F4(939, v17);
  printf("<input type=hidden name=default_captcha_desc value='%s'>\n", v18);
  puts("<input type=hidden name=captcha_file value=>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  v20 = sub_134F4(970, v19);
  printf("<p class=\"login_main_p\">%s</p>", v20);
  printf("</td><td class=\"login_main_td\" colspan=\"2\">");
  v22 = sub_134F4(939, v21);
  printf(
    "<input type=text name=captcha_code maxlength=\"5\" STYLE=\"width:205px; color:#888888;\" value=\"%s\"         \tonfocus=\"FocusCaptcha(document.login_fm);\" onblur=\"BlurCaptcha(document.login_fm);\">",
    v22);
  printf("</td></tr>");
  printf("</table>");
  printf("</td><td class=\"login_main_td\">");
  get_http_auth_method(&v30);
  get_ux_lang(&v31);
  puts("<table class=\"v3_table login_main_table\" width=\"321\" height=\"72\">");
  printf("<COL width=\"291\"><COL width=\"30\">");
  printf("<tr class=\"login_main_tr\"><td class=\"login_main_td\">");
  puts("<table class=\"v3_table login_main_table\" width=\"254\" height=\"72\">");
  printf("<COL width=\"90\"><COL width=\"201\">");
  printf(
    "<tr class=\"login_main_tr\" \t\tstyle=\"font: normal normal normal 12px arial; color:#000000; border:#C6C9CC 1px solid; background-color:#FFFFFF;\" height=\"72\">\t\t<td class=\"login_main_td\" style=\"cursor:pointer; background-color:#FAFAFA; border:0;\" \t\tonclick=\"iframe_captcha.location.reload();\">\t\t<img src=\"/images2/captcha_noborder.%s.gif\" style=\"border:0; margin-left:18px;\"></td>\n",
    &v31);
  strcmp(&v30, "session");
  printf("<td class=\"login_main_td\" style=\"border-left:1px #CCC solid;\">\t\t<iframe name=iframe_captcha id=iframe_captcha src=\"/%s/captcha.cgi\" width=\"200\" height=\"72\" \t\tframeborder=no scrolling=no></iframe>\t\t</td></tr>\n");
  printf("</table>");
  printf("</td><td class=\"login_main_td\"></td></tr></table>");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"5\"><td class=\"login_main_td\" colspan=\"2\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"5\" style=\"border-top:1px #CCC solid;\"><td class=\"login_main_td\" colspan=\"2\">");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"24\"><td class=\"login_main_td\">");
  printf("</td><td class=\"login_main_td\" align=\"right\" style=\"padding-right:30px;\">");
  printf("<button class=\"login_main_button\" style=\"width:90px;\" onclick=\"ApplyLogin(); return ClickEventPropagater(event);\">");
  v24 = sub_134F4(934, v23);
  printf("<span class=\"login_main_span\">%s</span>", v24);
  printf("</button>");
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\" height=\"5\"><td class=\"login_main_td\" colspan=\"2\">");
  printf("</td></tr>");
  printf("</table>");
  return printf("</form>");
}
// E9E4: using guessed type int __fastcall get_http_auth_method(_DWORD);
// FBF0: using guessed type int __fastcall get_ux_lang(_DWORD);
// FC98: using guessed type int __fastcall get_id_password(_DWORD, _DWORD);
// FE54: using guessed type int __fastcall get_default_id_password(_DWORD, _DWORD);

//----- (00019E0C) --------------------------------------------------------
int sub_19E0C()
{
  int v0; // r0@1
  int v1; // r0@2
  _UNKNOWN *v2; // r0@4
  _UNKNOWN *v3; // r0@4
  int v4; // r1@4
  int v5; // r0@4

  sub_133E4((int)"sysconf", (int)"login");
  puts("<style type=\"text/css\">");
  puts(".login_main_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".login_main_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".login_main_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".login_main_p {");
  puts("\tpadding:0 0 0 5px; display:inline-block;");
  puts("\tvertical-align:middle; margin:0;");
  puts("}");
  puts(".login_main_span {");
  puts("\tdisplay:inline-block; vertical-align:middle;");
  puts("}");
  puts(".login_main_button {");
  puts("\tpadding:0 1 0 1; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".login_main_td input[type=checkbox], .login_main_td input[type=radio] {");
  puts("display:inline-block; vertical-align:middle;");
  puts("}");
  puts("#login_div_msg p {");
  puts("margin:5 0 5 15px; text-align:left;");
  puts("}");
  puts(".login_ellipsis {");
  puts("text-overflow:ellipsis; overflow:hidden; white-space:nowrap; text-align:left;");
  puts("}");
  printf("input[type=\"text\"] {border:1px #CCC solid;}");
  printf("input[type=\"password\"] {border:1px #CCC solid;}");
  printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td {cursor:default;}");
  printf("</style>");
  printf("<table class=\"v3_table login_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"642\">");
  printf("<tr class=\"login_main_tr\"><td class=\"login_main_td\">");
  sub_199C0();
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\"><td class=\"login_main_td\">");
  sub_195E4();
  printf("</td></tr>");
  printf("<tr class=\"login_main_tr\"><td class=\"login_main_td\">");
  sub_1922C();
  v0 = printf("</td></tr>");
  if ( is_mobile_agent(v0) )
  {
    sub_12790((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v1 = printf("<iframe name=\"hiddenloginsetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenloginsetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    sub_12770(v1);
  }
  else
  {
    printf("<iframe name=\"hiddenloginsetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenloginsetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  printf("</table>");
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v2 = sub_126C4();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v2);
  printf("</SPAN></td>");
  printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"login_div_msg\">\n");
  printf("</SPAN></td>");
  printf((const char *)&unk_60F0E);
  printf("<DIV id=\"relogin_mask\" style=\"display:none;\">");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:171px; top:198px; width:300px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"300\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v3 = sub_126C4();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v3);
  printf("</SPAN></td>");
  v5 = sub_134F4(505, v4);
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\">%s",
    v5);
  printf("</SPAN></td>");
  return printf((const char *)&unk_60F0E);
}
// F74C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (0001A180) --------------------------------------------------------
int __fastcall sub_1A180(int a1, int a2, int a3)
{
  int v3; // r6@1
  int v4; // r7@1
  int v5; // r5@1

  v3 = a2;
  v4 = a3;
  v5 = a1;
  printf("<TR height=20 ID=%s STYLE=\"cursor:pointer; background-color:#%s;\" ONCLICK=\"clickSysconf(this);\">", a1);
  return printf("<TD></TD><TD>%s</TD><TD CLASS=text_gray ID=%s_value >%s</TD><TD>%s</TD></TR>\n", v3, v5, v4);
}

//----- (0001A1E0) --------------------------------------------------------
int sub_1A1E0()
{
  printf("<TR height=20 STYLE=\"background-Color:#%s\">");
  return printf("<TD></TD><TD></TD><TD CLASS=text_gray></TD><TD></TD></TR>");
}

//----- (0001A218) --------------------------------------------------------
int __fastcall sub_1A218(int a1, int a2, int a3)
{
  char *v3; // r2@2
  int v4; // r4@4
  int v5; // r1@5

  if ( a3 )
    v3 = "disabled";
  else
    v3 = "";
  printf("<select name=%s %s>", a1, v3);
  v4 = 0;
  do
  {
    v5 = v4++;
    printf("<option value=%d %s>%d", v5);
  }
  while ( v4 != 60 );
  return printf("</select>");
}

//----- (0001A294) --------------------------------------------------------
int __fastcall sub_1A294(int a1, int a2, int a3)
{
  char *v3; // r2@2
  int v4; // r4@4
  int v5; // r1@5

  if ( a3 )
    v3 = "disabled";
  else
    v3 = "";
  printf("<select name=%s %s>", a1, v3);
  v4 = 0;
  do
  {
    v5 = v4++;
    printf("<option value=%d %s >%d", v5);
  }
  while ( v4 != 24 );
  return printf("</select>");
}

//----- (0001A310) --------------------------------------------------------
int sub_1A310()
{
  int v0; // r1@1
  int v1; // r0@1

  printf("<table CELLPADDING=0 CELLSPACING=0><tr height=23px><td style=\"padding-left:5px;\">");
  v1 = sub_134F4(922, v0);
  printf("%s", v1);
  printf("</td>");
  return printf("</tr></table>");
}

//----- (0001A358) --------------------------------------------------------
int __fastcall sub_1A358(const char *a1, int a2)
{
  int v2; // r5@1
  const char *v3; // r4@1
  _UNKNOWN *v4; // r0@3

  v2 = a2;
  v3 = a1;
  if ( !strcmp(a1, "reboot_mask") )
  {
    printf("<style>");
    printf("#%s p { margin: 5px 0 5px 15px; text-align: left; }", v3);
    printf("</style>");
  }
  printf("<DIV id=\"%s\" style=\"display:none;\">", v3);
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v4 = sub_126C4();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v4);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\">%s\n",
    v2);
  printf("</SPAN></td>");
  return printf((const char *)&unk_60F0E);
}

//----- (0001A440) --------------------------------------------------------
_UNKNOWN *__fastcall sub_1A440(const char *a1)
{
  const char *v1; // r4@1
  int v2; // r1@1
  int v3; // r0@2
  const char *v4; // r1@11
  char *v5; // r0@11

  v1 = a1;
  if ( !strcmp(a1, "auto") )
  {
    v3 = 540;
  }
  else if ( !strcmp(v1, "kr") )
  {
    v3 = 111;
  }
  else if ( !strcmp(v1, "en") )
  {
    v3 = 110;
  }
  else if ( !strcmp(v1, "ch") )
  {
    v3 = 108;
  }
  else
  {
    if ( strcmp(v1, "cx") )
    {
      v5 = (char *)&unk_98520;
      v4 = "";
      goto LABEL_13;
    }
    v3 = 109;
  }
  v4 = (const char *)sub_134F4(v3, v2);
  v5 = (char *)&unk_98520;
LABEL_13:
  strcpy(v5, v4);
  return &unk_98520;
}

//----- (0001A4FC) --------------------------------------------------------
char *__fastcall sub_1A4FC(char *result, const char *a2, const char *a3, char a4, int a5)
{
  char *v5; // r6@1
  const char *v6; // r7@1
  char v7; // r8@1
  char *v8; // r4@2

  v5 = result;
  v6 = a3;
  v7 = a4;
  if ( (signed int)result <= 27 )
  {
    v8 = &byte_987C0[144 * (_DWORD)result];
    strcpy(&byte_987C0[144 * (_DWORD)result], a2);
    result = strcpy(&byte_987C0[8 * (18 * (_DWORD)v5 + 1)], v6);
    *((_DWORD *)v8 + 35) = a5;
    v8[136] = v7;
  }
  return result;
}

//----- (0001A554) --------------------------------------------------------
char *__fastcall sub_1A554(int a1, int a2)
{
  int v2; // r0@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r1@1
  int v8; // r0@1
  int v9; // r1@1
  int v10; // r0@1
  int v11; // r1@1
  int v12; // r0@1
  int v13; // r1@1
  int v14; // r0@1
  int v15; // r1@1
  int v16; // r0@1
  int v17; // r1@1
  int v18; // r0@1
  int v19; // r1@1
  int v20; // r0@1
  int v21; // r1@1
  int v22; // r0@1
  int v23; // r1@1
  int v24; // r0@1
  int v25; // r1@1
  int v26; // r0@1
  int v27; // r1@1
  int v28; // r0@1
  int v29; // r1@1
  int v30; // r0@1
  int v31; // r1@1
  int v32; // r0@1
  int v33; // r1@1
  int v34; // r0@1
  int v35; // r1@1
  int v36; // r0@1
  int v37; // r1@1
  int v38; // r0@1
  int v39; // r1@1
  int v40; // r0@1
  int v41; // r1@1
  int v42; // r0@1
  int v43; // r1@1
  int v44; // r0@1
  int v45; // r1@1
  int v46; // r0@1
  int v47; // r1@1
  int v48; // r0@1
  int v49; // r1@1
  int v50; // r0@1
  int v51; // r1@1
  int v52; // r0@1
  int v53; // r1@1
  int v54; // r0@1
  int v55; // r1@1
  int v56; // r0@1

  v2 = sub_134F4(348, a2);
  sub_1A4FC(0, "gmt0", (const char *)v2, 45, 720);
  v4 = sub_134F4(359, v3);
  sub_1A4FC((char *)1, "gmt1", (const char *)v4, 45, 660);
  v6 = sub_134F4(368, v5);
  sub_1A4FC((char *)2, "gmt2", (const char *)v6, 45, 600);
  v8 = sub_134F4(369, v7);
  sub_1A4FC((char *)3, "gmt3", (const char *)v8, 45, 540);
  v10 = sub_134F4(370, v9);
  sub_1A4FC((char *)4, "gmt4", (const char *)v10, 45, 480);
  v12 = sub_134F4(371, v11);
  sub_1A4FC((char *)5, "gmt5", (const char *)v12, 45, 420);
  v14 = sub_134F4(372, v13);
  sub_1A4FC((char *)6, "gmt6", (const char *)v14, 45, 360);
  v16 = sub_134F4(373, v15);
  sub_1A4FC((char *)7, "gmt7", (const char *)v16, 45, 300);
  v18 = sub_134F4(374, v17);
  sub_1A4FC((char *)8, "gmt8", (const char *)v18, 45, 240);
  v20 = sub_134F4(375, v19);
  sub_1A4FC((char *)9, "gmt9", (const char *)v20, 45, 180);
  v22 = sub_134F4(349, v21);
  sub_1A4FC((char *)0xA, "gmt10", (const char *)v22, 45, 120);
  v24 = sub_134F4(350, v23);
  sub_1A4FC((char *)0xB, "gmt11", (const char *)v24, 45, 60);
  v26 = sub_134F4(351, v25);
  sub_1A4FC((char *)0xC, "gmt12", (const char *)v26, 43, 0);
  v28 = sub_134F4(352, v27);
  sub_1A4FC((char *)0xD, "gmt13", (const char *)v28, 43, 60);
  v30 = sub_134F4(353, v29);
  sub_1A4FC((char *)0xE, "gmt14", (const char *)v30, 43, 120);
  v32 = sub_134F4(354, v31);
  sub_1A4FC((char *)0xF, "gmt15", (const char *)v32, 43, 180);
  v34 = sub_134F4(355, v33);
  sub_1A4FC((char *)0x10, "gmt16", (const char *)v34, 43, 210);
  v36 = sub_134F4(356, v35);
  sub_1A4FC((char *)0x11, "gmt17", (const char *)v36, 43, 240);
  v38 = sub_134F4(357, v37);
  sub_1A4FC((char *)0x12, "gmt18", (const char *)v38, 43, 300);
  v40 = sub_134F4(358, v39);
  sub_1A4FC((char *)0x13, "gmt19", (const char *)v40, 43, 330);
  v42 = sub_134F4(360, v41);
  sub_1A4FC((char *)0x14, "gmt20", (const char *)v42, 43, 360);
  v44 = sub_134F4(361, v43);
  sub_1A4FC((char *)0x15, "gmt21", (const char *)v44, 43, 420);
  v46 = sub_134F4(362, v45);
  sub_1A4FC((char *)0x16, "gmt22", (const char *)v46, 43, 480);
  v48 = sub_134F4(363, v47);
  sub_1A4FC((char *)0x17, "gmt23", (const char *)v48, 43, 540);
  v50 = sub_134F4(364, v49);
  sub_1A4FC((char *)0x18, "gmt24", (const char *)v50, 43, 600);
  v52 = sub_134F4(365, v51);
  sub_1A4FC((char *)0x19, "gmt25", (const char *)v52, 43, 660);
  v54 = sub_134F4(366, v53);
  sub_1A4FC((char *)0x1A, "gmt26", (const char *)v54, 43, 720);
  v56 = sub_134F4(367, v55);
  return sub_1A4FC((char *)0x1B, "gmt27", (const char *)v56, 43, 780);
}

//----- (0001A9F4) --------------------------------------------------------
int sub_1A9F4()
{
  char v1; // [sp+1h] [bp-107h]@1

  get_hostname(&v1);
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=23px><td colspan=4 style=\"padding-left:5px;\">");
  printf("<input type=text name=hostname  size=60 maxlength=60 value='%s'>", &v1);
  printf("</td></tr>");
  return printf("</TABLE>");
}
// FD64: using guessed type int __fastcall get_hostname(_DWORD);

//----- (0001AA50) --------------------------------------------------------
int sub_1AA50()
{
  int v1; // [sp+0h] [bp-108h]@1

  printf("<script>");
  sub_130BC((char *)&v1, 0x100u);
  printf("setTimeout(function() { ");
  printf("parent.document.getElementById('current_time').outerHTML = \"<span id='current_time'>%s</span>\";", &v1);
  printf(
    "parent.document.getElementsByName('sysconf_misc_iframe')[0].contentWindow.document.getElementById('realtime_value').outerHTML = '<TD CLASS=text_gray ID=realtime_value >%s</TD>';",
    &v1);
  printf("}, 500);");
  printf("setTimeout(function() { location.reload(); }, 3000);");
  return printf("</script>");
}

//----- (0001AACC) --------------------------------------------------------
char *sub_1AACC()
{
  char *result; // r0@2
  char v1; // [sp+4h] [bp-5Ch]@1

  get_timeserver_conf(&v1);
  if ( !strcmp(&v1, "null") )
  {
    result = "";
  }
  else
  {
    strcpy((char *)&unk_98560, &v1);
    result = (char *)&unk_98560;
  }
  return result;
}
// EA8C: using guessed type int __fastcall get_timeserver_conf(_DWORD);

//----- (0001AB1C) --------------------------------------------------------
int __fastcall sub_1AB1C(int a1)
{
  char *v1; // r5@1
  int v2; // r7@1
  int v3; // r1@1
  char *v4; // r4@2
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6

  v1 = "checked";
  v2 = get_nologin(a1);
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=23px><td style=\"padding-left:5px;\" colspan=4>");
  if ( v2 )
    v4 = "";
  else
    v4 = "checked";
  v5 = sub_134F4(955, v3);
  printf("<input type=radio id=nologin_off name=nologin value=0 %s ><label for=nologin_off> %s</label>", v4, v5);
  printf("</td></tr><tr height=23px><td style=\"padding-left:5px;\"colspan=4 >");
  if ( !v2 )
    v1 = "";
  v7 = sub_134F4(956, v6);
  printf("<input type=radio id=nologin_on name=nologin value=1 %s ><label for=nologin_on> %s</label>", v1, v7);
  printf("</td></tr>");
  return printf("</TABLE>");
}
// EFA8: using guessed type int __fastcall get_nologin(_DWORD);

//----- (0001ABC8) --------------------------------------------------------
int sub_1ABC8()
{
  FILE *v0; // r10@1
  int v1; // r7@2
  char *v2; // r0@4
  const char *v3; // r4@5
  char *v4; // r6@5
  const char *v5; // r6@6
  unsigned __int16 v6; // r11@6
  char *v7; // r0@6
  const char *v8; // r4@7
  char *v9; // r5@7
  const char *v10; // r5@8
  unsigned __int16 v11; // r4@8
  int v12; // r5@11
  int v13; // r4@11
  bool v14; // nf@13
  unsigned __int8 v15; // vf@13
  int v17; // [sp+0h] [bp-A8h]@4

  printf("<html><head></head><body width=100%% bottommargin=0 rightmargin=0 leftmargin=0 topmargin=0 marginheight=0 >");
  printf("<form method=post action=\"timepro.cgi\" name=\"upnp_list_fm\">");
  printf("<input type=hidden name=\"tmenu\" value=\"popup\">");
  printf("<input type=hidden name=\"smenu\" value=\"upnp_list\">");
  printf("<table cellspacing=0px cellpadding=0px border=0 width=100%% align=left>");
  v0 = fopen("/var/run/upnp_pmlist", "r");
  if ( v0 )
  {
    v1 = 0;
    while ( fgets((char *)&v17, 128, v0) )
    {
      v2 = strchr((const char *)&v17, 59);
      ++v1;
      if ( v2 )
      {
        *v2 = 0;
        v3 = v2 + 1;
        v4 = strchr(v2 + 1, 59);
        if ( v4 )
        {
          *v4 = 0;
          v5 = v4 + 1;
          v6 = atoi(v3);
          v7 = strchr(v5, 59);
          if ( v7 )
          {
            *v7 = 0;
            v8 = v7 + 1;
            v9 = strchr(v7 + 1, 59);
            if ( v9 )
            {
              *v9 = 0;
              v10 = v9 + 1;
              v11 = atoi(v8);
              *strchr(v10, 10) = 0;
              printf("<tr style=\"background:#%s;height:20px;\">");
              printf("<td width=72px style=\"padding-left:5px;\">%s</td>\n", &v17);
              printf("<td width=76px>%d</td>\n", v6);
              printf("<td width=146px>%s:%d</td>\n", v5, v11);
              printf("<td width=318px>%s</td>\n", v10);
              printf("</tr>");
            }
          }
        }
      }
    }
    fclose(v0);
  }
  else
  {
    v1 = 0;
  }
  v12 = 5 - v1;
  v13 = 0;
  while ( 1 )
  {
    v15 = __OFSUB__(v13, v12);
    v14 = v13++ - v12 < 0;
    if ( !(v14 ^ v15) )
      break;
    sub_1A1E0();
  }
  printf("</table>");
  printf("</form>");
  return printf((const char *)&unk_619C3);
}

//----- (0001ADC0) --------------------------------------------------------
signed int __fastcall sub_1ADC0(int a1)
{
  int v1; // r6@1
  int v2; // r0@5
  int v3; // r0@7
  int v4; // r4@10
  int v5; // r4@14
  const char *v6; // r1@15
  int v7; // r0@17
  int *v8; // r0@21
  signed int v9; // r1@21
  int v10; // r0@26
  int v11; // r0@29
  int v12; // r0@32
  int v13; // r4@37
  int v14; // r0@37
  bool v15; // zf@37
  signed int v16; // r3@40
  int v17; // r12@43
  int v18; // r4@46
  int v19; // r0@46
  int v20; // r3@46
  int v21; // r4@53
  int v22; // r0@53
  int v23; // r3@53
  int v24; // r4@60
  int v25; // r0@60
  int v26; // r3@60
  int v27; // r4@67
  int v28; // r0@67
  int v29; // r3@67
  int v30; // r4@74
  int v31; // r0@74
  int v32; // r3@74
  int v33; // r4@81
  int v34; // r0@81
  int v35; // r3@81
  int v36; // r4@88
  int v37; // r0@88
  int v38; // r3@88
  const char *v39; // r1@104
  signed int v40; // r0@104
  int v41; // r0@107
  int v42; // r0@108
  int v43; // r0@116
  int v45; // r0@120
  bool v46; // cf@120
  int v47; // r0@120
  int v48; // r0@146
  int v49; // r0@148
  int v50; // r0@149
  int v51; // r1@149
  int v52; // r0@150
  int v53; // [sp+0h] [bp-950h]@114
  int v54; // [sp+10h] [bp-940h]@114
  int v55; // [sp+24h] [bp-92Ch]@114
  char v56; // [sp+38h] [bp-918h]@114
  int v57; // [sp+4Ch] [bp-904h]@114
  int v58; // [sp+60h] [bp-8F0h]@114
  int v59; // [sp+3B8h] [bp-598h]@120
  int v60; // [sp+3BCh] [bp-594h]@120
  int v61; // [sp+3C0h] [bp-590h]@124
  int v62; // [sp+440h] [bp-510h]@127
  int v63; // [sp+4C0h] [bp-490h]@130
  char dest; // [sp+540h] [bp-410h]@133
  char v65; // [sp+5C0h] [bp-390h]@136
  _BYTE v66[3]; // [sp+641h] [bp-30Fh]@3
  char v67; // [sp+740h] [bp-210h]@119
  char s; // [sp+7C0h] [bp-190h]@140
  char v69; // [sp+800h] [bp-150h]@146
  int v70; // [sp+808h] [bp-148h]@146
  int v71; // [sp+80Ch] [bp-144h]@146
  int v72; // [sp+810h] [bp-140h]@144
  int v73; // [sp+814h] [bp-13Ch]@37
  int v74; // [sp+834h] [bp-11Ch]@46
  int v75; // [sp+838h] [bp-118h]@45
  char v76; // [sp+83Ch] [bp-114h]@51
  char v77; // [sp+83Dh] [bp-113h]@58
  char v78; // [sp+83Eh] [bp-112h]@65
  char v79; // [sp+83Fh] [bp-111h]@72
  char v80; // [sp+840h] [bp-110h]@79
  char v81; // [sp+841h] [bp-10Fh]@86
  char v82; // [sp+842h] [bp-10Eh]@93
  int v83; // [sp+844h] [bp-10Ch]@95
  int v84; // [sp+848h] [bp-108h]@96
  int v85; // [sp+84Ch] [bp-104h]@98
  int v86; // [sp+850h] [bp-100h]@96
  int v87; // [sp+854h] [bp-FCh]@98
  int v88; // [sp+858h] [bp-F8h]@1
  int v89; // [sp+898h] [bp-B8h]@110
  int v90; // [sp+8B8h] [bp-98h]@110
  int v91; // [sp+8CCh] [bp-84h]@110
  char v92; // [sp+8E0h] [bp-70h]@112
  int v93; // [sp+8F4h] [bp-5Ch]@112
  int v94; // [sp+908h] [bp-48h]@111
  int v95; // [sp+91Ch] [bp-34h]@20
  int v96; // [sp+92Ch] [bp-24h]@35
  int v97; // [sp+930h] [bp-20h]@2
  __int16 v98; // [sp+934h] [bp-1Ch]@46
  __int16 v99; // [sp+936h] [bp-1Ah]@34

  v1 = a1;
  if ( !get_value_post(a1, "service", &v88, 64) )
    return 0;
  v97 = 0;
  if ( !strcmp((const char *)&v88, "hostname") )
  {
    if ( !get_value_post(v1, "hostnameh", v66, 255) || check_unpermitted_chars(v66) )
      v2 = 0;
    else
      v2 = (int)v66;
    v3 = set_hostname(v2);
    goto LABEL_151;
  }
  if ( !strcmp((const char *)&v88, "autosaving") )
  {
    if ( get_value_post(v1, "autosavingh", &v88, 64) )
    {
      v4 = atoi((const char *)&v88);
      v3 = set_autosaving();
      if ( !v4 )
        v3 = saveconf(v3);
      goto LABEL_151;
    }
    return 0;
  }
  if ( !strcmp((const char *)&v88, "fakedns") )
  {
    if ( get_value_post(v1, "fakednsh", &v88, 64) )
    {
      v5 = atoi((const char *)&v88);
      if ( v5 )
        v6 = "@{62}";
      else
        v6 = "@{63}";
      syslog_msg(1, v6);
      v7 = set_fakedns(v5);
LABEL_102:
      v3 = signal_update(v7);
      goto LABEL_151;
    }
    return 0;
  }
  if ( !strcmp((const char *)&v88, "dhcp_restart") )
  {
    v7 = get_value_post(v1, "dhcp_auto_restart_1", &v88, 64);
    if ( v7 )
    {
      get_wan_hw_ifname("wan1", &v95);
      if ( !strcmp((const char *)&v88, "on") )
      {
        v8 = &v95;
        v9 = 1;
      }
      else
      {
        v8 = &v95;
        v9 = 0;
      }
      v7 = set_dhcp_auto_restart(v8, v9);
    }
    goto LABEL_102;
  }
  if ( !strcmp((const char *)&v88, "nologin") )
  {
    if ( !get_value_post(v1, "nologinh", &v88, 64) )
      return 0;
    v10 = atoi((const char *)&v88);
    v3 = set_nologin(v10);
LABEL_151:
    signal_save(v3);
    return 1;
  }
  if ( !strcmp((const char *)&v88, "wbmpopup") )
  {
    if ( !get_value_post(v1, "wbmpopuph", &v88, 64) )
      return 0;
    v11 = atoi((const char *)&v88);
    v3 = set_wbm_popup_flag(v11);
    goto LABEL_151;
  }
  if ( !strcmp((const char *)&v88, "apcplan") )
  {
    if ( !get_value_post(v1, "apcplanh", &v88, 64) )
      return 0;
    v12 = atoi((const char *)&v88);
    v3 = set_apcplan_flag(v12);
    goto LABEL_151;
  }
  if ( !strcmp((const char *)&v88, (const char *)&unk_61A66) )
  {
    v99 = 0;
    if ( get_value_post(v1, "autorebooth", &v88, 64) )
      v96 = atoi((const char *)&v88);
    else
      v96 = 0;
    set_autoreboot_config(&v96);
    memset(&v73, 0, 0x44u);
    v13 = get_value_post(v1, "everyday", &v99, 2);
    v14 = atoi((const char *)&v99);
    v15 = v14 == 0;
    if ( v14 )
      v15 = v13 == 0;
    v16 = !v15;
    if ( v15 )
      v17 = v16;
    else
      v17 = v14;
    v75 = v17;
    if ( !v17 )
    {
      v98 = 0;
      v74 = 1;
      v18 = get_value_post(v1, "sun", &v98, 2);
      v19 = strcmp((const char *)&v98, "1");
      v20 = 1 - v19;
      if ( (unsigned int)v19 > 1 )
        v20 = 0;
      if ( !v18 )
        v20 = 0;
      if ( v20 )
        v76 = atoi((const char *)&v98);
      else
        v76 = 0;
      v21 = get_value_post(v1, "mon", &v98, 2);
      v22 = strcmp((const char *)&v98, "1");
      v23 = 1 - v22;
      if ( (unsigned int)v22 > 1 )
        v23 = 0;
      if ( !v21 )
        v23 = 0;
      if ( v23 )
        v77 = atoi((const char *)&v98);
      else
        v77 = 0;
      v24 = get_value_post(v1, "tue", &v98, 2);
      v25 = strcmp((const char *)&v98, "1");
      v26 = 1 - v25;
      if ( (unsigned int)v25 > 1 )
        v26 = 0;
      if ( !v24 )
        v26 = 0;
      if ( v26 )
        v78 = atoi((const char *)&v98);
      else
        v78 = 0;
      v27 = get_value_post(v1, "wed", &v98, 2);
      v28 = strcmp((const char *)&v98, "1");
      v29 = 1 - v28;
      if ( (unsigned int)v28 > 1 )
        v29 = 0;
      if ( !v27 )
        v29 = 0;
      if ( v29 )
        v79 = atoi((const char *)&v98);
      else
        v79 = 0;
      v30 = get_value_post(v1, "thu", &v98, 2);
      v31 = strcmp((const char *)&v98, "1");
      v32 = 1 - v31;
      if ( (unsigned int)v31 > 1 )
        v32 = 0;
      if ( !v30 )
        v32 = 0;
      if ( v32 )
        v80 = atoi((const char *)&v98);
      else
        v80 = 0;
      v33 = get_value_post(v1, "fri", &v98, 2);
      v34 = strcmp((const char *)&v98, "1");
      v35 = 1 - v34;
      if ( (unsigned int)v34 > 1 )
        v35 = 0;
      if ( !v33 )
        v35 = 0;
      if ( v35 )
        v81 = atoi((const char *)&v98);
      else
        v81 = 0;
      v36 = get_value_post(v1, "sat", &v98, 2);
      v37 = strcmp((const char *)&v98, "1");
      v38 = 1 - v37;
      if ( (unsigned int)v37 > 1 )
        v38 = 0;
      if ( !v36 )
        v38 = 0;
      if ( v38 )
        v82 = atoi((const char *)&v98);
      else
        v82 = 0;
    }
    v83 = 0;
    if ( get_value_post(v1, "autorebootHour", &v88, 64) )
    {
      v86 = atoi((const char *)&v88);
      v84 = v86;
    }
    if ( get_value_post(v1, "autorebootMin", &v88, 64) )
    {
      v87 = atoi((const char *)&v88);
      v85 = v87;
    }
    remove_all_gen_schedule(&unk_61A66);
    if ( v96 )
      add_gen_schedule(&unk_61A66, &v73);
    v7 = iconfig_remove_config_tag("last_autoboot_stamp");
    goto LABEL_102;
  }
  if ( !strcmp((const char *)&v88, "restart") )
  {
    v39 = "@{42}";
    v40 = 1;
LABEL_108:
    v42 = syslog_msg(v40, v39);
LABEL_117:
    saveconf(v42);
    signal_reboot(3);
    return 2;
  }
  if ( !strcmp((const char *)&v88, "upnp") )
  {
    if ( !get_value_post(v1, "upnph", &v98, 2) )
      return 0;
    v41 = atoi((const char *)&v98);
    set_upnp(v41);
    v39 = "@{42}";
    v40 = 1;
    goto LABEL_108;
  }
  if ( !strcmp((const char *)&v88, "hubapmode") )
  {
    get_ifconfig("br0", &v91, &v90);
    get_value_post(v1, "use_local_gateway", &v89, 32);
    if ( !strcmp((const char *)&v89, "1") && get_ip_value_post(v1, "gw", &v94) )
    {
      set_use_local_gateway(1);
      set_lan_ipconfig(&v91, &v90, &v94);
      get_ip_value_post(v1, "fdns", &v93);
      get_ip_value_post(v1, "sdns", &v92);
      set_dns_shadow("br0", "local", &v93, &v92);
    }
    else
    {
      set_use_local_gateway(0);
      set_lan_ipconfig(&v91, &v90, 0);
    }
    dhcpd_read_config(&v53);
    sf_strncpy(&v56, &v91, 20);
    sf_strncpy(&v57, &v90, 20);
    get_subnet_range(&v91, &v90, &v54, &v55);
    if ( !strcmp((const char *)&v58, (const char *)&v91) )
      sf_strncpy(&v58, &v91, 20);
    v43 = dhcpd_commit_config(&v53);
    v42 = dhcpd_flush_dynamic_lease(v43);
    goto LABEL_117;
  }
  if ( !strcmp((const char *)&v88, "snmp") )
  {
    if ( get_value_post(v1, "snmp_run", &v67, 64) )
    {
      read_snmp_conf(&v59);
      system2("/sbin/iptables -D INPUT -p udp --dport %d -j ACCEPT", v60);
      v45 = strcmp(&v67, "on");
      v46 = (unsigned int)v45 <= 1;
      v47 = 1 - v45;
      if ( !v46 )
        v47 = 0;
      v59 = v47;
      if ( v47 )
      {
        get_intvalue_post(v1, "snmp_service_port", &v60);
        if ( get_value_post(v1, "snmp_community", &v67, 128) )
          sf_strncpy(&v61, &v67, 128);
        else
          strcpy((char *)&v61, "");
        if ( get_value_post(v1, "snmp_sysname", &v67, 128) )
          sf_strncpy(&v62, &v67, 128);
        else
          strcpy((char *)&v62, "");
        if ( get_value_post(v1, "snmp_location", &v67, 128) )
          sf_strncpy(&v63, &v67, 128);
        else
          strcpy((char *)&v63, "");
        if ( get_value_post(v1, "snmp_contact", &v67, 128) )
          sf_strncpy(&dest, &v67, 128);
        else
          strcpy(&dest, "");
        if ( get_value_post(v1, "snmp_descr", &v67, 128) )
          sf_strncpy(&v65, &v67, 128);
        else
          strcpy(&v65, "");
      }
      v7 = write_snmp_conf(&v59);
      goto LABEL_102;
    }
    return 0;
  }
  if ( !strcmp((const char *)&v88, "realtime") )
  {
    memset(&s, 0, 0x54u);
    get_value_post(v1, "server_list", &s, 64);
    if ( strcmp(&s, "null") || (get_value_post(v1, "server_edit", &s, 64), !check_unpermitted_chars(&s)) )
    {
      if ( !s )
        strcpy(&s, "null");
      if ( !get_intvalue_post(v1, "summer_flag", &v72) )
        v72 = 0;
      get_intvalue_post(v1, "gmtidx", &v97);
      sf_strncpy(&v69, &byte_987C0[144 * v97], 8);
      v70 = byte_987C0[144 * v97 + 136] == 43;
      v71 = *(_DWORD *)&byte_987C0[144 * v97 + 140];
      v48 = set_timeserver_conf(&s);
      v7 = clear_timed_status(v48);
      goto LABEL_102;
    }
    return 0;
  }
  if ( strcmp((const char *)&v88, "multilang") )
    return 0;
  v49 = get_value_post(v1, "multilang_lang", &v95, 16);
  if ( v49 )
  {
    v50 = set_system_lang(&v95);
    v49 = sub_13494(v50, v51);
  }
  v52 = signal_update(v49);
  signal_save(v52);
  return 3;
}
// E834: using guessed type int __fastcall set_nologin(_DWORD);
// E8A0: using guessed type int __fastcall get_intvalue_post(_DWORD, _DWORD, _DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EAB0: using guessed type int __fastcall set_dns_shadow(_DWORD, _DWORD, _DWORD, _DWORD);
// EB88: using guessed type int __fastcall set_upnp(_DWORD);
// ECC0: using guessed type int set_autosaving(void);
// ED68: using guessed type int __fastcall set_autoreboot_config(_DWORD);
// EF6C: using guessed type int __fastcall set_wbm_popup_flag(_DWORD);
// EFCC: using guessed type int __fastcall dhcpd_flush_dynamic_lease(_DWORD);
// F0F8: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// F110: using guessed type int __fastcall saveconf(_DWORD);
// F11C: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F26C: using guessed type int __fastcall write_snmp_conf(_DWORD);
// F314: using guessed type int __fastcall set_timeserver_conf(_DWORD);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F3C8: using guessed type int __fastcall set_hostname(_DWORD);
// F428: using guessed type int system2(const char *, ...);
// F470: using guessed type int syslog_msg(_DWORD, const char *, ...);
// F4D0: using guessed type int __fastcall set_system_lang(_DWORD);
// F5CC: using guessed type int __fastcall set_apcplan_flag(_DWORD);
// F620: using guessed type int __fastcall dhcpd_read_config(_DWORD);
// F638: using guessed type int __fastcall iconfig_remove_config_tag(_DWORD);
// F6B0: using guessed type int __fastcall signal_reboot(_DWORD);
// F71C: using guessed type int __fastcall set_fakedns(_DWORD);
// F758: using guessed type int __fastcall clear_timed_status(_DWORD);
// F770: using guessed type int __fastcall dhcpd_commit_config(_DWORD);
// F854: using guessed type int __fastcall set_use_local_gateway(_DWORD);
// FA70: using guessed type int __fastcall read_snmp_conf(_DWORD);
// FADC: using guessed type int __fastcall add_gen_schedule(_DWORD, _DWORD);
// FAF4: using guessed type int __fastcall get_subnet_range(_DWORD, _DWORD, _DWORD, _DWORD);
// FB0C: using guessed type int __fastcall set_lan_ipconfig(_DWORD, _DWORD, _DWORD);
// FB3C: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// FC14: using guessed type int __fastcall remove_all_gen_schedule(_DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);
// FD4C: using guessed type int __fastcall set_dhcp_auto_restart(_DWORD, _DWORD);

//----- (0001BA54) --------------------------------------------------------
int __fastcall sub_1BA54(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r4@1
  signed int v4; // r10@1
  const char *v5; // r0@2
  int v6; // r1@4
  char *v7; // r0@5
  int result; // r0@7
  const char *v9; // r0@10
  int v10; // r1@10
  int v11; // r0@10
  int v12; // r1@10
  int v13; // r1@11
  int v14; // r0@12
  int v15; // r0@13
  int v16; // r1@13
  int v17; // r0@13
  char *v18; // r0@14
  int v19; // r1@15
  int v20; // r0@15
  int v21; // r0@15
  int v22; // r1@15
  int v23; // r0@16
  int v24; // r1@16
  int v25; // r0@17
  int v26; // r0@18
  int v27; // r0@18
  int v28; // r1@18
  int v29; // r0@19
  int v30; // r1@19
  int v31; // r0@20
  int v32; // r0@21
  int v33; // r0@21
  int v34; // r1@21
  int v35; // r0@22
  int v36; // r1@22
  int v37; // r0@23
  int v38; // r0@24
  int v39; // r0@24
  int v40; // r1@24
  int v41; // r0@25
  int v42; // r1@25
  int v43; // r0@26
  int v44; // r0@27
  int v45; // r0@27
  int v46; // r1@27
  int v47; // r0@28
  int v48; // r1@28
  int v49; // r0@29
  int v50; // r0@30
  int v51; // r0@30
  int v52; // r1@30
  int v53; // r0@31
  int v54; // r1@31
  int v55; // r0@32
  int v56; // r0@33
  int v57; // r1@33
  int v58; // r0@34
  int v59; // r1@34
  int v60; // r0@35
  int v61; // r0@36
  int v62; // r1@36
  int v63; // r0@36
  int v64; // r0@36
  int v65; // r1@36
  int v66; // r0@37
  int v67; // r0@39
  int v68; // r1@39
  int v69; // r0@39
  int v70; // r1@39
  int v71; // r0@40
  int v72; // r0@42
  int v73; // r1@42
  int v74; // r0@42
  int v75; // r1@42
  int v76; // r0@43
  int v77; // r0@45
  int v78; // r1@45
  int v79; // r0@45
  int v80; // r0@46
  int v81; // r0@46
  int v82; // [sp+8h] [bp-788h]@39
  _BYTE v83[3]; // [sp+291h] [bp-4FFh]@10
  _BYTE v84[3]; // [sp+491h] [bp-2FFh]@10
  char v85; // [sp+591h] [bp-1FFh]@10
  char v86; // [sp+690h] [bp-100h]@33
  char v87; // [sp+6D7h] [bp-B9h]@7
  char v88; // [sp+717h] [bp-79h]@5
  char v89; // [sp+757h] [bp-39h]@42
  char v90; // [sp+767h] [bp-29h]@10
  int v91; // [sp+76Ch] [bp-24h]@33

  v2 = a2;
  v3 = a1;
  sub_1A554(a1, a2);
  sub_133E4((int)"sysconf", (int)"misc");
  v4 = sub_1ADC0(v2);
  if ( v4 != 3 )
  {
    if ( v3 )
    {
      v6 = get_pvalue(v3, "service");
      if ( !v6 )
      {
        strcpy(&v88, "multilang");
LABEL_10:
        printf("<style>");
        printf("form { margin: 0; }");
        printf(".selected { background-color: #C9D5E9 !important; }");
        printf("</style>");
        printf("<BODY style=\"padding:0px 0px; margin:0px 0px;\">");
        printf("<form method=post action=\"timepro.cgi\" name=\"main_form\">");
        puts("<input type=hidden name=tmenu value=iframe>");
        printf("<input type=hidden name=\"smenu\" value=\"sysconf_misc\">");
        puts("<input type=hidden name=service value=>");
        puts("<input type=hidden name=run value=>");
        puts("<input type=hidden name=hostnameh value=>");
        puts("<input type=hidden name=autosavingh value=>");
        puts("<input type=hidden name=fakednsh value=>");
        puts("<input type=hidden name=dhcp_auto_restart_1 value=>");
        puts("<input type=hidden name=nologinh value=>");
        puts("<input type=hidden name=wbmpopuph value=>");
        puts("<input type=hidden name=apcplanh value=>");
        puts("<input type=hidden name=autorebooth value=>");
        puts("<input type=hidden name=everyday value=>");
        puts("<input type=hidden name=autorebootHour value=>");
        puts("<input type=hidden name=autorebootMin value=>");
        puts("<input type=hidden name=sun value=>");
        puts("<input type=hidden name=mon value=>");
        puts("<input type=hidden name=tue value=>");
        puts("<input type=hidden name=wed value=>");
        puts("<input type=hidden name=thu value=>");
        puts("<input type=hidden name=fri value=>");
        puts("<input type=hidden name=sat value=>");
        puts("<input type=hidden name=restarth value=>");
        puts("<input type=hidden name=upnph value=>");
        printf("<table style=\"border-collapse:collapse; border-style:none none none none; width:100%%;\" cellspacing=0px cellpadding=0px>\n");
        printf("<COL WIDTH=9><COL WIDTH=220><COL width=350><COL>");
        get_system_lang(&v90);
        v9 = (const char *)sub_1A440(&v90);
        strcpy(v84, v9);
        strcpy(v83, "");
        v11 = sub_134F4(950, v10);
        sub_1A180((int)"multilang", v11, (int)v84);
        puts("<input type=hidden name=multilang_lang >");
        memset(&v85, 0, 0xFFu);
        get_hostname(&v85);
        if ( v85 )
        {
          snprintf2(
            v84,
            256,
            "<span id=hostname_status title=\"%s\" style=\" display:block; overflow:hidden; white-space:nowrap;  text-overflow:ellipsis; width:350px; \">%s </span>",
            &v85,
            &v85);
          snprintf2(
            v83,
            512,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap;  text-overflow:ellipsis;\">%s</span>",
            "hostname",
            "");
        }
        else
        {
          v14 = sub_134F4(958, v12);
          snprintf2(v84, 256, "<span id=hostname_status>%s</span>", v14, 0);
          strcpy(v83, "");
        }
        v15 = sub_134F4(927, v13);
        sub_1A180((int)"hostname", v15, (int)v84);
        sub_130BC(v84, 0x100u);
        strcpy(v83, "");
        v17 = sub_134F4(603, v16);
        sub_1A180((int)"realtime", v17, (int)v84);
        puts("<input type=hidden name=server_list>");
        puts("<input type=hidden name=server_edit>");
        puts("<input type=hidden name=gmtidx>");
        puts("<input type=hidden name=summer_flag>");
        if ( v4 == 1 )
        {
          printf("<script>");
          v18 = sub_1AACC();
          printf("parent.document.getElementsByName('server_edit')[0].value = '%s';", v18);
          printf("if((parent.document.getElementsByName('sysconf_misc_realtime_status')[0]) && parent.document.getElementsByName('sysconf_misc_realtime_status')[0].contentWindow)");
          printf("parent.document.getElementsByName('sysconf_misc_realtime_status')[0].contentWindow.location.reload();");
          printf("</script>");
        }
        strcpy(v84, "");
        strcpy(v83, "");
        v20 = sub_134F4(600, v19);
        v21 = sub_1A180((int)"configmgmt", v20, (int)v84);
        if ( get_autosaving(v21) <= 0 )
        {
          v25 = sub_134F4(900, v22);
          snprintf2(v84, 256, "<span id=autosaving_status>%s</span>", v25, 3);
          strcpy(v83, "");
        }
        else
        {
          v23 = sub_134F4(894, v22);
          snprintf2(v84, 256, "<span id=autosaving_status>%s</span>", v23, 3);
          snprintf2(
            v83,
            512,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap;  text-overflow:ellipsis;\">%s</span>",
            "auto_saving",
            "");
        }
        v26 = sub_134F4(948, v24);
        v27 = sub_1A180((int)"autosaving", v26, (int)v84);
        if ( get_fakedns(v27) <= 0 )
        {
          v31 = sub_134F4(900, v28);
          snprintf2(v84, 256, "<span id=fakedns_status>%s</span>", v31, 4);
          strcpy(v83, "");
        }
        else
        {
          v29 = sub_134F4(894, v28);
          snprintf2(v84, 256, "<span id=fakedns_status>%s</span>", v29, 4);
          snprintf2(
            v83,
            512,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap;  text-overflow:ellipsis;\">%s</span>",
            "fakedns",
            "");
        }
        v32 = sub_134F4(949, v30);
        v33 = sub_1A180((int)"fakedns", v32, (int)v84);
        if ( get_nologin(v33) )
        {
          v37 = sub_134F4(122, v34);
          snprintf2(v84, 256, "<span id=nologin_status>%s</span>", v37, 5);
          strcpy(v83, "");
        }
        else
        {
          v35 = sub_134F4(885, v34);
          snprintf2(v84, 256, "<span id=nologin_status>%s</span>", v35, 5);
          snprintf2(
            v83,
            512,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap; text-overflow:ellipsis;\">%s</span>",
            "nologin",
            "");
        }
        v38 = sub_134F4(957, v36);
        v39 = sub_1A180((int)"nologin", v38, (int)v84);
        if ( get_wbm_popup_flag(v39) <= 0 )
        {
          v43 = sub_134F4(951, v40);
          snprintf2(v84, 256, "<span id=wbm_popup_status>%s</span>", v43, 6);
          strcpy(v83, "");
        }
        else
        {
          v41 = sub_134F4(953, v40);
          snprintf2(v84, 256, "<span id=wbm_popup_status>%s</span>", v41, 6);
          snprintf2(
            v83,
            512,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap;  text-overflow:ellipsis;\">%s</span>",
            "wbmpopup",
            "");
        }
        v44 = sub_134F4(952, v42);
        v45 = sub_1A180((int)"wbmpopup", v44, (int)v84);
        if ( get_upnp(v45) <= 0 )
        {
          v49 = sub_134F4(900, v46);
          snprintf2(v84, 256, "<span id=upnp_status>%s</span>", v49, 7);
          strcpy(v83, "");
        }
        else
        {
          v47 = sub_134F4(894, v46);
          snprintf2(v84, 256, "<span id=upnp_status>%s</span>", v47, 7);
          snprintf2(
            v83,
            512,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap; text-overflow:ellipsis;\">%s</span>",
            "upnp",
            "");
        }
        v50 = sub_134F4(1012, v48);
        v51 = sub_1A180((int)"upnp", v50, (int)v84);
        if ( get_apcplan_flag(v51) <= 0 )
        {
          v55 = sub_134F4(900, v52);
          snprintf2(v84, 256, "<span id=apcpd_status>%s</span>", v55, 8);
          strcpy(v83, "");
        }
        else
        {
          v53 = sub_134F4(894, v52);
          snprintf2(v84, 256, "<span id=apcpd_status>%s</span>", v53, 8);
          snprintf2(
            v83,
            512,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap;  text-overflow:ellipsis;\">%s</span>",
            "apcpd",
            "");
        }
        v56 = sub_134F4(917, v54);
        sub_1A180((int)"apcplan", v56, (int)v84);
        get_autoreboot_config(&v91);
        memset(&v86, 0, 0x44u);
        read_sched_array(&unk_61A66, &v86, 1);
        if ( v91 )
        {
          v58 = sub_134F4(894, v57);
          snprintf2(v84, 256, "<span id=autoreboot_status>%s</span>", v58, 9);
          snprintf2(
            v83,
            512,
            "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap; text-overflow:ellipsis;\">%s</span>",
            &unk_61A66,
            "");
        }
        else
        {
          v60 = sub_134F4(900, v57);
          snprintf2(v84, 256, "<span id=autoreboot_status>%s</span>", v60, 9);
          strcpy(v83, "");
        }
        v61 = sub_134F4(45, v59);
        sub_1A180((int)&unk_61A66, v61, (int)v84);
        snprintf2(v84, 256, "<span id=restart_status></span>");
        snprintf2(
          v83,
          512,
          "<span title=\"%s\" style=\"overflow:hidden; white-space:nowrap; text-overflow:ellipsis;\">%s</span>",
          "restart",
          "");
        v63 = sub_134F4(921, v62);
        v64 = sub_1A180((int)"restart", v63, (int)v84);
        if ( get_use_local_gateway(v64) )
          v66 = 1013;
        else
          v66 = 959;
        v67 = sub_134F4(v66, v65);
        snprintf2(v84, 256, "<span id=hubapmode_status>%s</span>", v67, 11);
        strcpy(v83, "");
        v69 = sub_134F4(928, v68);
        sub_1A180((int)"hubapmode", v69, (int)v84);
        puts("<input type=hidden name=gw1 value=>");
        puts("<input type=hidden name=gw2 value=>");
        puts("<input type=hidden name=gw3 value=>");
        puts("<input type=hidden name=gw4 value=>");
        puts("<input type=hidden name=fdns1 value=>");
        puts("<input type=hidden name=fdns2 value=>");
        puts("<input type=hidden name=fdns3 value=>");
        puts("<input type=hidden name=fdns4 value=>");
        puts("<input type=hidden name=sdns1 value=>");
        puts("<input type=hidden name=sdns2 value=>");
        puts("<input type=hidden name=sdns3 value=>");
        puts("<input type=hidden name=sdns4 value=>");
        puts("<input type=hidden name=use_local_gateway value=>");
        read_snmp_conf(&v82);
        if ( v82 )
          v71 = 894;
        else
          v71 = 900;
        v72 = sub_134F4(v71, v70);
        strcpy(v84, (const char *)v72);
        strcpy(v83, "");
        v74 = sub_134F4(604, v73);
        sub_1A180((int)"snmp", v74, (int)v84);
        puts("<input type=hidden name=snmp_run>");
        puts("<input type=hidden name=snmp_service_port>");
        puts("<input type=hidden name=snmp_community>");
        puts("<input type=hidden name=snmp_sysname>");
        puts("<input type=hidden name=snmp_location>");
        puts("<input type=hidden name=snmp_contact>");
        puts("<input type=hidden name=snmp_descr>");
        strcpy(v84, "");
        strcpy(v83, "");
        get_wan_hw_ifname("wan1", &v89);
        if ( get_dhcp_auto_restart(&v89) )
          v76 = 894;
        else
          v76 = 900;
        v77 = sub_134F4(v76, v75);
        snprintf2(v84, 256, "<span id=dhcp_restart_status>%s</span>", v77, 13);
        v79 = sub_134F4(924, v78);
        sub_1A180((int)"dhcp_restart", v79, (int)v84);
        sub_1A1E0();
        sub_1A1E0();
        printf("</table>");
        printf("</form>");
        printf("</BODY>");
        printf("<script>");
        printf("setTimeout(function() { clickSysconf(document.getElementById('%s')); }, 50);", &v88);
        if ( v4 == 2 )
        {
          printf("setTimeout(function() {");
          v80 = printf("UnMaskIt(parent.document, 'apply_mask');");
          v81 = hwinfo_get_reboot_duration(v80);
          printf("maskRebootMsg(%d, null, parent.document);", v81);
          printf("}, 500);");
        }
        else
        {
          puts("setTimeout(function() {UnMaskIt(parent.document,'apply_mask'); }, 500);");
        }
        v5 = "</script>";
        return printf(v5);
      }
      v7 = &v88;
    }
    else
    {
      result = get_value_post(v2, "service", &v87, 64);
      if ( !result )
        return result;
      v6 = (int)&v87;
      v7 = &v88;
    }
    sf_strncpy(v7, v6, 64);
    goto LABEL_10;
  }
  printf("<BODY style=\"padding:0px 0px; margin:0px 0px;\">");
  printf("<script>top.location.reload();</script>");
  v5 = "</body>";
  return printf(v5);
}
// E744: using guessed type int __fastcall get_fakedns(_DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E90C: using guessed type int __fastcall get_wbm_popup_flag(_DWORD);
// EBAC: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// ECF0: using guessed type int __fastcall read_sched_array(_DWORD, _DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EFA8: using guessed type int __fastcall get_nologin(_DWORD);
// EFD8: using guessed type int __fastcall get_system_lang(_DWORD);
// F0C8: using guessed type int __fastcall get_autosaving(_DWORD);
// F0F8: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F284: using guessed type int __fastcall get_apcplan_flag(_DWORD);
// F29C: using guessed type int __fastcall get_autoreboot_config(_DWORD);
// F7F4: using guessed type int __fastcall get_dhcp_auto_restart(_DWORD);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);
// F890: using guessed type int __fastcall get_upnp(_DWORD);
// F9C8: using guessed type int __fastcall get_use_local_gateway(_DWORD);
// FA70: using guessed type int __fastcall read_snmp_conf(_DWORD);
// FD64: using guessed type int __fastcall get_hostname(_DWORD);

//----- (0001C7CC) --------------------------------------------------------
int sub_1C7CC()
{
  char *v0; // r4@1
  const char *v1; // r5@1
  _UNKNOWN *v2; // r0@3
  char *v3; // r4@5
  _UNKNOWN *v4; // r0@7
  char v6; // [sp+2h] [bp-FEh]@1
  __int16 v7; // [sp+22h] [bp-DEh]@1
  char v8; // [sp+40h] [bp-C0h]@8
  char s1; // [sp+E0h] [bp-20h]@1

  get_si("sw", &v6);
  get_system_lang(&s1);
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=23px><td style=\"padding-left:5px;width:\" colspan=4>");
  printf("<select name=multilang_lang style='height: 20px; width: 200px;'>");
  v0 = "selected";
  v1 = (const char *)&v7;
  if ( strcmp(&s1, "auto") )
    v0 = "";
  v2 = sub_1A440("auto");
  printf("<option value='auto' %s>%s</option>", v0, v2);
  do
  {
    if ( *v1 )
    {
      v3 = "selected";
      if ( strcmp(&s1, v1) )
        v3 = "";
      v4 = sub_1A440(v1);
      printf("<option value='%s' %s>%s</option>", v1, v3, v4);
    }
    v1 += 5;
  }
  while ( v1 != &v8 );
  printf("</select>");
  printf("</td></tr>");
  return printf("</TABLE>");
}
// E7D4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// EFD8: using guessed type int __fastcall get_system_lang(_DWORD);

//----- (0001C8E4) --------------------------------------------------------
int sub_1C8E4()
{
  int v0; // r1@1
  int v1; // r0@1
  char *v2; // r5@1
  int v3; // r1@1
  char *v4; // r4@2
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6
  int v8; // r1@6
  int v9; // r0@6
  int v10; // r1@6
  int v11; // r0@6
  int v12; // r1@6
  int v13; // r0@6
  int v14; // r1@6
  int v15; // r0@6
  int v16; // r1@6
  int v17; // r0@6
  int v19; // [sp+0h] [bp-2A0h]@1
  int v20; // [sp+4h] [bp-29Ch]@6
  char v21; // [sp+8h] [bp-298h]@6
  char v22; // [sp+88h] [bp-218h]@6
  char v23; // [sp+108h] [bp-198h]@6
  char v24; // [sp+188h] [bp-118h]@6
  char v25; // [sp+208h] [bp-98h]@6

  read_snmp_conf(&v19);
  printf("<style>");
  printf("#snmp_table table input[type=text] { padding-left: 5px; width: 150px;}");
  printf("#snmp_table table tr { height: 19px; }");
  printf("</style>");
  printf("<table style=\"border-collapse:collapse;\" width=100%% cellspacing=0px cellpadding=0px>\n");
  printf("<tr><td width=30%%>");
  v1 = sub_134F4(887, v0);
  v2 = "";
  printf("%s", v1);
  printf("</td>");
  printf("<td>");
  if ( v19 )
    v4 = "checked";
  else
    v4 = "";
  v5 = sub_134F4(894, v3);
  printf("<input type=radio name=snmp_run value=on %s onclick=\"ChangeSNMP();\"> %s", v4, v5);
  print_nbsp(5);
  if ( !v19 )
    v2 = "checked";
  v7 = sub_134F4(900, v6);
  printf(
    "<input type=radio name=snmp_run value=off %s style='margin-left: 20px;' onclick=\"ChangeSNMP();\"> %s",
    v2,
    v7);
  printf("</td></tr>");
  printf("<tr><td>");
  v9 = sub_134F4(788, v8);
  printf((const char *)v9);
  printf("</td>");
  printf("<td>");
  printf("<input type=text name=snmp_service_port size=5 maxlength=5 value=\"%d\">", v20);
  printf("</td></tr>");
  printf("<tr><td>");
  printf("SNMP Community");
  printf("</td>");
  printf("<td>");
  printf("<input type=text name=snmp_community maxlength=127 value=\"%s\">", &v21);
  printf("</td></tr>");
  printf("<tr><td>");
  v11 = sub_134F4(891, v10);
  printf((const char *)v11);
  printf("</td>");
  printf("<td>");
  printf("<input type=text name=snmp_sysname value=\"%s\">", &v22);
  printf("</td></tr>");
  printf("<tr><td>");
  v13 = sub_134F4(890, v12);
  printf((const char *)v13);
  printf("</td>");
  printf("<td>");
  printf("<input type=text name=snmp_location value=\"%s\">", &v23);
  printf("</td></tr>");
  printf("<tr><td>");
  v15 = sub_134F4(888, v14);
  printf((const char *)v15);
  printf("</td>");
  printf("<td>");
  printf("<input type=text name=snmp_contact value=\"%s\">", &v24);
  printf("</td></tr>");
  printf("<tr><td>");
  v17 = sub_134F4(889, v16);
  printf((const char *)v17);
  printf("</td>");
  printf("<td>");
  printf("<input type=text name=snmp_descr value=\"%s\">", &v25);
  printf("</td></tr>");
  printf("</table>");
  return printf("<script> ChangeSNMP(); </script>");
}
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// FA70: using guessed type int __fastcall read_snmp_conf(_DWORD);

//----- (0001CB88) --------------------------------------------------------
int __fastcall sub_1CB88(int a1)
{
  char *v1; // r5@1
  int v2; // r7@1
  int v3; // r1@1
  char *v4; // r4@2
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6
  int v8; // r1@6
  int v9; // r4@6
  int v10; // r1@6
  int v11; // r0@6

  v1 = "checked";
  v2 = get_upnp(a1);
  printf("<table width=100%% CELLPADDING=0 CELLSPACING=0 border=0>");
  printf("<tr height=23px>");
  printf("<td style=\"padding-left:5px;\" colspan=4>");
  if ( v2 )
    v4 = "checked";
  else
    v4 = "";
  v5 = sub_134F4(894, v3);
  printf("<input type=radio id=upnp_on name=upnp value=1 %s><label for=upnp_on> %s</label>", v4, v5);
  print_nbsp(10);
  if ( v2 )
    v1 = "";
  v7 = sub_134F4(900, v6);
  printf("<input type=radio id=upnp_off name=upnp value=0 %s><label for=upnp_off> %s</label>", v1, v7);
  printf("</td></tr><tr height=10px><td colspan=4></td></tr> ");
  printf("<tr><td colspan=4 style=\"padding-left:5px;\"");
  printf("<div id=\"upnp_div\">");
  printf("<table width=100%% border=0 cellspacing=0 cellpadding=0>\n");
  puts("<tr><td class=\"st_text_td\">");
  v9 = sub_134F4(1131, v8);
  v11 = sub_134F4(1130, v10);
  printf(
    "<SPAN class=\"movetomain\"><a href=\"javascript:MovePagetoMainURL('natrouterconf','portforward','mode=upnp');\"><u>%s</u></a> %s</SPAN>",
    v9,
    v11);
  printf("</td>");
  printf("</tr>");
  puts("</table>");
  printf("</div>");
  printf("</td>");
  printf("</tr>");
  printf("<tr><td>");
  printf("<div id=\"upnp_desc\" style=\"border:none; width:100%%; height:80px;\">");
  printf("</div>");
  return printf("</td></tr></table>");
}
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// F890: using guessed type int __fastcall get_upnp(_DWORD);

//----- (0001CCFC) --------------------------------------------------------
int __fastcall sub_1CCFC(int a1)
{
  char *v1; // r5@1
  int v2; // r7@1
  int v3; // r1@1
  char *v4; // r4@2
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6
  int v8; // r1@6
  int v9; // r0@6

  v1 = "checked";
  v2 = get_apcplan_flag(a1);
  printf("<table width=100%% CELLPADDING=0 CELLSPACING=0 border=0>");
  printf("<tr height=23px>");
  printf("<td style=\"padding-left:5px;\" colspan=4>");
  if ( v2 )
    v4 = "checked";
  else
    v4 = "";
  v5 = sub_134F4(894, v3);
  printf("<input type=radio id=apcplan_on name=apcplan value=1 %s><label for=apcplan_on> %s</label>", v4, v5);
  print_nbsp(10);
  if ( v2 )
    v1 = "";
  v7 = sub_134F4(900, v6);
  printf("<input type=radio id=apcplan_off name=apcplan value=0 %s><label for=apcplan_off> %s</label>", v1, v7);
  printf("</td><tr height=15px><td>&nbsp;</td></tr><tr height=23px><td style=\"padding-left:5px;\">");
  printf("<span class=gray_text><li>");
  v9 = sub_134F4(915, v8);
  printf((const char *)v9);
  puts("</span>");
  printf("</td>");
  return printf("</tr></table>");
}
// F284: using guessed type int __fastcall get_apcplan_flag(_DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);

//----- (0001CDE4) --------------------------------------------------------
int __fastcall sub_1CDE4(int a1)
{
  char *v1; // r5@1
  int v2; // r7@1
  int v3; // r1@1
  char *v4; // r4@2
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6

  v1 = "checked";
  v2 = get_wbm_popup_flag(a1);
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=23px><td style=\"padding-left:5px;\" colspan=4>");
  if ( v2 )
    v4 = "checked";
  else
    v4 = "";
  v5 = sub_134F4(953, v3);
  printf("<input type=radio id=wbmpopup_on name=wbmpopup value=1 %s ><label for=wbmpopup_on> %s</label>", v4, v5);
  print_nbsp(10);
  if ( v2 )
    v1 = "";
  v7 = sub_134F4(951, v6);
  printf("<input type=radio id=wbmpopup_off name=wbmpopup value=0 %s ><label for=wbmpopup_off> %s</label>", v1, v7);
  printf("</td></tr>");
  return printf("</TABLE>");
}
// E90C: using guessed type int __fastcall get_wbm_popup_flag(_DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);

//----- (0001CE90) --------------------------------------------------------
int __fastcall sub_1CE90(const char *a1)
{
  const char *v1; // r5@1
  int v2; // r4@1
  int v3; // r0@1
  char *v4; // r5@1
  char *v5; // r6@2
  signed int v6; // r4@7
  int v7; // r1@9
  int v8; // r0@9
  int v9; // r1@9
  int v10; // r0@9
  char v12; // [sp+8h] [bp-20h]@1

  v1 = a1;
  get_wan_hw_ifname(a1, &v12);
  v2 = get_dhcp_auto_restart(&v12);
  v3 = strcmp(v1, "wan1");
  v4 = "checked";
  if ( v2 )
    v5 = "checked";
  else
    v5 = "";
  if ( v2 )
    v4 = "";
  if ( v3 )
    v6 = 2;
  else
    v6 = 1;
  printf("<tr height=23px><td style=\"padding-left:5px;\" colspan=4>");
  v8 = sub_134F4(894, v7);
  printf(
    "<input type=radio id=dhcp_auto_restart_on_%d name=dhcp_auto_restart_%d value=on %s ><label for=dhcp_auto_restart_on_%d> %s</label>",
    v6,
    v6,
    v5,
    v6,
    v8);
  print_nbsp(10);
  v10 = sub_134F4(900, v9);
  printf(
    "<input type=radio id=dhcp_auto_restart_off_%d name=dhcp_auto_restart_%d value=off %s ><label for=dhcp_auto_restart_off_%d> %s</label>",
    v6,
    v6,
    v4,
    v6,
    v10);
  printf("</td></tr>");
  return printf("<tr height=5><td colspan=4>&nbsp;</td></tr>");
}
// F0F8: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// F7F4: using guessed type int __fastcall get_dhcp_auto_restart(_DWORD);

//----- (0001CF7C) --------------------------------------------------------
int sub_1CF7C()
{
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  sub_1CE90("wan1");
  return printf("</TABLE>");
}

//----- (0001CFA8) --------------------------------------------------------
int __fastcall sub_1CFA8(int a1)
{
  char *v1; // r5@1
  int v2; // r7@1
  int v3; // r1@1
  char *v4; // r4@2
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6
  int v8; // r1@6
  int v9; // r0@6

  v1 = "checked";
  v2 = get_fakedns(a1);
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=23px><td style=\"padding-left:5px;\" colspan=4>");
  if ( v2 )
    v4 = "checked";
  else
    v4 = "";
  v5 = sub_134F4(894, v3);
  printf("<input type=radio id=fakedns_on name=fakedns value=1 %s ><label for=fakedns_on> %s</label>", v4, v5);
  print_nbsp(10);
  if ( v2 )
    v1 = "";
  v7 = sub_134F4(900, v6);
  printf("<input type=radio id=fakedns_off name=fakedns value=0 %s ><label for=fakedns_off> %s</label>", v1, v7);
  printf("</td></tr>");
  printf("<tr height=5><td colspan=4>&nbsp;</td></tr>");
  v9 = sub_134F4(925, v8);
  printf(
    "<tr valign=bottom height=10><td colspan=4 style=\"padding-left:5px;\"><span class=gray_text><LI>%s</span></td></tr>",
    v9);
  return printf("</TABLE>");
}
// E744: using guessed type int __fastcall get_fakedns(_DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);

//----- (0001D078) --------------------------------------------------------
int __fastcall sub_1D078(int a1)
{
  char *v1; // r5@1
  int v2; // r7@1
  int v3; // r1@1
  char *v4; // r4@2
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6

  v1 = "checked";
  v2 = get_autosaving(a1);
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=23px><td style=\"padding-left:5px;width:\" colspan=4>");
  if ( v2 )
    v4 = "checked";
  else
    v4 = "";
  v5 = sub_134F4(894, v3);
  printf("<input type=radio id=autosaving_on name=autosaving value=1 %s><label for=autosaving_on> %s</label>", v4, v5);
  print_nbsp(10);
  if ( v2 )
    v1 = "";
  v7 = sub_134F4(900, v6);
  printf("<input type=radio id=autosaving_off name=autosaving value=0 %s><label for=autosaving_off> %s</label>", v1, v7);
  printf("</td></tr>");
  return printf("</TABLE>");
}
// F0C8: using guessed type int __fastcall get_autosaving(_DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);

//----- (0001D120) --------------------------------------------------------
int sub_1D120()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r4@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r0@2
  char *v9; // r1@2
  char *v10; // r0@6
  int v11; // r5@6
  int v12; // r0@6
  int v13; // r1@6
  int v14; // r0@6
  int v15; // r1@7
  int v16; // r0@8
  int v17; // r1@8
  int v18; // r0@8
  int v19; // r0@8
  int v20; // r0@8
  int v21; // r1@11
  int v22; // r0@11
  int v23; // r0@11
  int v24; // r1@11
  int v25; // r0@11
  int v26; // r0@11
  char v28; // [sp+4h] [bp-104h]@2
  char s2; // [sp+84h] [bp-84h]@1
  char v30; // [sp+C4h] [bp-44h]@7
  char v31; // [sp+D8h] [bp-30h]@9

  puts("<table cellspacing=0px cellpadding=0px>");
  printf("<tr style='height: 24px;'>");
  v1 = sub_134F4(1006, v0);
  v2 = 0;
  printf("<td style='width:150px;'><span style='padding-left: 5px;'>%s</span></td>", v1);
  printf((const char *)&unk_63526);
  v3 = printf("</td>");
  etr(v3);
  printf("<tr style='height: 24px;'>");
  v5 = sub_134F4(1008, v4);
  printf("<td><span style='padding-left: 5px;'>%s</span></td>\n", v5);
  puts("<td>");
  get_timeserver_conf(&s2);
  printf("<select name=server_list onchange=\"SelectTimeServer()\" style='width: 145px; margin-right: 10px; height: 20px; border: 1px solid #CCC;'>");
  v7 = sub_134F4(1007, v6);
  printf("<option value=null> %s </option>", v7);
  do
  {
    v8 = get_timeserver_list(v2++, &v28);
    v9 = &v28;
    if ( !v8 )
      break;
    printf("<option value=%s ", &v28);
    if ( !strcmp(&v28, &s2) )
      printf("selected");
    printf(">%s</option>", &v28);
  }
  while ( v2 != 15 );
  printf("</select>", v9);
  v10 = sub_1AACC();
  v11 = 0;
  printf(
    "<input type=text name=server_edit value=\"%s\" size=24 maxlength=60 style='border: 1px solid #CCC; padding-left: 4px; width: 215px; height: 20px;'>",
    v10);
  v12 = puts("</td>");
  etr(v12);
  printf("<tr style='height: 24px;'>");
  v14 = sub_134F4(1009, v13);
  printf("<td><span style='padding-left: 5px;'>%s</span></td>\n", v14);
  puts("<td>");
  puts("<select name=gmtidx style='width: 370px; border: 1px solid #CCC; height: 20px;'>");
  do
  {
    strcmp(&byte_987C0[144 * v11], &v30);
    v15 = v11++;
    printf("<option value=%d %s>%s</option>", v15);
  }
  while ( v11 != 28 );
  puts("</select>");
  v16 = printf("</td>");
  etr(v16);
  printf("<tr style='height: 24px;'>");
  puts("<td></td>");
  puts("<td>");
  printf("<input type=checkbox id=summer_flag name=summer_flag value=1 style='vertical-align: middle;' %s>");
  v18 = sub_134F4(1010, v17);
  printf("<label for=summer_flag>%s</label>", v18);
  v19 = puts("</td>");
  v20 = etr(v19);
  if ( !get_timed_status(v20) && (!get_wan_ip("wan1", &v31) || !get_wan_link("wan1")) )
  {
    printf("<tr height=70>");
    printf("<td colspan=2 align=left>");
    printf("<span class=gray_text>");
    v22 = sub_134F4(849, v21);
    v23 = printf((const char *)v22);
    br(v23);
    v25 = sub_134F4(850, v24);
    printf((const char *)v25);
    v26 = printf("</span>");
    etr(v26);
  }
  printf("</table>");
  printf("<iframe name=\"sysconf_misc_realtime_status\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_misc_realtime_status\" style='display: none;' frameborder=no></iframe>");
  puts("<script>");
  puts("SelectTimeServer();");
  return puts("</script>");
}
// EA8C: using guessed type int __fastcall get_timeserver_conf(_DWORD);
// F008: using guessed type int __fastcall get_wan_link(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F788: using guessed type int __fastcall br(_DWORD);
// F8CC: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);
// F98C: using guessed type int __fastcall get_timeserver_list(_DWORD, _DWORD);
// FE84: using guessed type int __cdecl get_timed_status(_DWORD);

//----- (0001D440) --------------------------------------------------------
int sub_1D440()
{
  int v0; // r1@1
  char *v1; // r5@1
  char *v2; // r4@2
  int v3; // r0@4
  int v4; // r1@4
  char *v5; // r4@5
  int v6; // r0@7
  int v7; // r0@7
  int v8; // r1@7
  char *v9; // r4@8
  int v10; // r0@10
  int v11; // r1@10
  char *v12; // r4@11
  int v13; // r0@13
  int v14; // r1@13
  char *v15; // r4@14
  int v16; // r0@16
  int v17; // r1@16
  char *v18; // r4@17
  int v19; // r0@19
  int v20; // r1@19
  char *v21; // r4@20
  int v22; // r0@22
  int v23; // r1@22
  char *v24; // r4@23
  int v25; // r0@25
  int v26; // r1@25
  char *v27; // r4@26
  int v28; // r0@28
  int v29; // r1@28
  int v30; // r0@30
  int v31; // r0@30
  int v32; // r1@30
  int v33; // r0@30
  int v34; // r1@30
  int v35; // r0@30
  int v36; // r1@30
  int v37; // r0@30
  int v38; // r0@30
  int v39; // r1@32
  int v40; // r0@32
  int v41; // r0@32
  int v42; // r1@32
  int v43; // r0@32
  int v45; // [sp+0h] [bp-58h]@1
  int v46; // [sp+24h] [bp-34h]@7
  char v47; // [sp+28h] [bp-30h]@10
  char v48; // [sp+29h] [bp-2Fh]@13
  char v49; // [sp+2Ah] [bp-2Eh]@16
  char v50; // [sp+2Bh] [bp-2Dh]@19
  char v51; // [sp+2Ch] [bp-2Ch]@22
  char v52; // [sp+2Dh] [bp-2Bh]@25
  char v53; // [sp+2Eh] [bp-2Ah]@28
  int v54; // [sp+34h] [bp-24h]@30
  int v55; // [sp+38h] [bp-20h]@30
  int v56; // [sp+44h] [bp-14h]@1

  get_autoreboot_config(&v56);
  memset(&v45, 0, 0x44u);
  read_sched_array(&unk_61A66, &v45, 1);
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%%>");
  printf("<tr height=40>");
  printf("<td style=\"padding-left:5px;padding-top:2px;\">");
  v1 = "checked";
  if ( v56 )
    v2 = "checked";
  else
    v2 = "";
  v3 = sub_134F4(894, v0);
  printf(
    "<input type=radio id=autoreboot_on name=autoreboot value=1 onclick=\"ClickAutoReboot_2(document.sysconf_fm);\" %s><label for=autoreboot_on> %s</label>",
    v2,
    v3);
  print_nbsp(10);
  if ( v56 )
    v5 = "";
  else
    v5 = "checked";
  v6 = sub_134F4(900, v4);
  v7 = printf(
         "<input type=radio id=autoreboot_off name=autoreboot value=0 onclick=\"ClickAutoReboot_2(document.sysconf_fm);\" %s><label for=autoreboot_off> %s</label>",
         v5,
         v6);
  br(v7);
  if ( v46 )
    v9 = "checked";
  else
    v9 = "";
  v10 = sub_134F4(240, v8);
  printf(
    "<input type=checkbox id=everyday name=everyday value=1 onclick=\"ClickEveryDay_2(document.sysconf_fm);\" style='margin-left: 5px;' %s><label for=everyday> %s</label>",
    v9,
    v10);
  print_nbsp(10);
  if ( v47 )
    v12 = "checked";
  else
    v12 = "";
  v13 = sub_134F4(255, v11);
  printf(
    " <input type=checkbox id=sun name=sun value=1 style='margin-left: 2px; margin-right: 6px;' %s><label for=sun>%s</label>",
    v12,
    v13);
  if ( v48 )
    v15 = "checked";
  else
    v15 = "";
  v16 = sub_134F4(246, v14);
  printf(" <input type=checkbox id=mon name=mon value=1 %s><label for=mon>%s</label>", v15, v16);
  if ( v49 )
    v18 = "checked";
  else
    v18 = "";
  v19 = sub_134F4(257, v17);
  printf(" <input type=checkbox id=tue name=tue value=1 %s><label for=tue>%s</label>", v18, v19);
  if ( v50 )
    v21 = "checked";
  else
    v21 = "";
  v22 = sub_134F4(260, v20);
  printf(" <input type=checkbox id=wed name=wed value=1 %s><label for=wed>%s</label>", v21, v22);
  if ( v51 )
    v24 = "checked";
  else
    v24 = "";
  v25 = sub_134F4(256, v23);
  printf(" <input type=checkbox id=thu name=thu value=1 %s><label for=thu>%s</label>", v24, v25);
  if ( v52 )
    v27 = "checked";
  else
    v27 = "";
  v28 = sub_134F4(243, v26);
  printf(" <input type=checkbox id=fri name=fri value=1 %s><label for=fri>%s</label>", v27, v28);
  if ( !v53 )
    v1 = "";
  v30 = sub_134F4(247, v29);
  v31 = printf(" <input type=checkbox id=sat name=sat value=1 %s><label for=sat>%s</label>", v1, v30);
  br(v31);
  print_nbsp(1);
  sub_1A294((int)"autorebootHour", v54, 0);
  v33 = sub_134F4(382, v32);
  printf((const char *)v33);
  print_nbsp(3);
  sub_1A218((int)"autorebootMin", v55, 0);
  v35 = sub_134F4(531, v34);
  printf((const char *)v35);
  v37 = sub_134F4(44, v36);
  v38 = printf((const char *)v37);
  if ( !get_timed_status(v38) && v56 )
  {
    br(0);
    v40 = sub_134F4(851, v39);
    v41 = printf("<span class=gray_text>%s</span>", v40);
    br(v41);
    print_nbsp(10);
    v43 = sub_134F4(852, v42);
    printf("<span class=gray_text>%s</span>", v43);
  }
  printf("</td>");
  printf("</tr></table>");
  return printf("<script> ClickAutoReboot_2(document.sysconf_fm);</script>");
}
// ECF0: using guessed type int __fastcall read_sched_array(_DWORD, _DWORD, _DWORD);
// F29C: using guessed type int __fastcall get_autoreboot_config(_DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// F788: using guessed type int __fastcall br(_DWORD);
// FE84: using guessed type int __cdecl get_timed_status(_DWORD);

//----- (0001D764) --------------------------------------------------------
int sub_1D764()
{
  int v0; // r0@1
  int v1; // r1@1
  char *v2; // r4@1
  char *v3; // r5@2
  int v4; // r0@4
  int v5; // r0@4
  int v6; // r1@4
  int v7; // r0@6
  int v8; // r1@6
  int v9; // r0@6
  int v10; // r1@6
  int v11; // r0@6
  char v13; // [sp+4h] [bp-5Ch]@6
  char v14; // [sp+18h] [bp-48h]@6
  char v15; // [sp+2Ch] [bp-34h]@6

  printf("<table width=100%% CELLPADDING=0 CELLSPACING=0 border=0>");
  printf("<tr height=\"24\">");
  v0 = printf("<td style=\"padding-left:5px;\" colspan=\"4\">");
  v2 = "checked";
  if ( get_use_local_gateway(v0) )
    v3 = "checked";
  else
    v3 = "";
  v4 = sub_134F4(1013, v1);
  printf(
    "<input type=\"radio\" id=use_local_gateway_on name=\"use_local_gateway\" value=\"1\" onclick=\"ChangeLanIPSetupForm(document.sysconf_fm);\" %s><label for=use_local_gateway_on> %s</label>",
    v3,
    v4);
  v5 = print_nbsp(10);
  if ( get_use_local_gateway(v5) )
    v2 = "";
  v7 = sub_134F4(959, v6);
  printf(
    "<input type=\"radio\" id=use_local_gateway_off name=\"use_local_gateway\" value=\"0\" onclick=\"ChangeLanIPSetupForm(document.sysconf_fm);\" %s><label for=use_local_gateway_off> %s</label>",
    v2,
    v7);
  strcpy(&v15, "");
  strcpy(&v14, "");
  strcpy(&v13, "");
  iconfig_get_value_direct("lan_gateway", &v15);
  get_dns_shadow("br0", "local", &v14, &v13);
  v9 = sub_134F4(493, v8);
  printf(
    "</td></tr><tr height=\"24\"><td style=\"padding-left:5px; width: 150px;\">%s</td><td colspan=\"3\" style=\"padding-left:5px;\">",
    v9);
  sub_11D7C((int)"gw", (int)&v15, 0);
  v11 = sub_134F4(492, v10);
  printf(
    "</td></tr><tr height=\"24\"><td style=\"padding-left:5px;\">%s</td><td colspan=\"3\" style=\"padding-left:5px;\">",
    v11);
  sub_11D7C((int)"fdns", (int)&v14, 0);
  printf("</td></tr><tr height=\"24\"><td style=\"padding-left:5px;\"></td><td colspan=\"3\" style=\"padding-left:5px;\">");
  sub_11D7C((int)"sdns", (int)&v13, 0);
  printf("</td>");
  printf("</tr>");
  printf("</table>");
  return printf("<script>ChangeLanIPSetupForm(document.sysconf_fm);</script>");
}
// F1C4: using guessed type int __fastcall iconfig_get_value_direct(_DWORD, _DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// F914: using guessed type int __fastcall get_dns_shadow(_DWORD, _DWORD, _DWORD, _DWORD);
// F9C8: using guessed type int __fastcall get_use_local_gateway(_DWORD);

//----- (0001D914) --------------------------------------------------------
int sub_1D914()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r4@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r0@1
  int v7; // r1@1
  int v8; // r4@1
  int v9; // r1@1
  int v10; // r0@2
  int v11; // r1@4
  int v12; // r0@4
  int v13; // r0@4
  int v14; // r1@4
  int v15; // r0@4
  int v16; // r4@4
  int v17; // r0@4
  int v18; // r0@4

  puts("<table cellspacing=0px cellpadding=0px>");
  printf("<colgroup><col width=150px></colgroup>");
  puts("<tr style='height: 26px;'>");
  puts("<td>");
  v1 = sub_134F4(918, v0);
  v2 = v1;
  v3 = hwinfo_get_reboot_duration(v1);
  printf(
    "<input type=button name=save VALUE=\"%s\"  onclick=\"RestoreDefaultConfig(%d);\" style=\"width:120px;\">",
    v2,
    v3);
  puts("</td>");
  v5 = sub_134F4(919, v4);
  v6 = printf("<td><span class=gray_text>%s</span></td>\n", v5);
  etr(v6);
  puts("<tr style='height: 26px;'>");
  puts("<td>");
  v8 = sub_134F4(965, v7);
  if ( file_exists("/var/run/savefs.gz") )
    v10 = (int)"";
  else
    v10 = sub_134F4(960, v9);
  printf("<input type=button name=save VALUE=\"%s\" onclick=\"ApplyBackup('%s')\" style=\"width:120px;\">", v8, v10);
  puts("</td>");
  v12 = sub_134F4(966, v11);
  printf("<td><span class=gray_text>%s</span></td>\n", v12);
  v13 = puts("</td>");
  etr(v13);
  puts("<tr style='height: 26px;'>");
  puts("<td>");
  v15 = sub_134F4(963, v14);
  v16 = v15;
  v17 = hwinfo_get_reboot_duration(v15);
  printf("<input type=button name=save VALUE=\"%s\"  onclick=\"RestoreConfig(%d)\" style=\"width:120px;\">", v16, v17);
  puts("</td>");
  printf("<td>");
  printf("<iframe name=\"sysconf_misc_configmgmt_submit\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_misc_configmgmt_submit\" frameborder=no width=400px height=26px scrolling=no></iframe>");
  printf("<input type=file name=\"restore_config_file\" size=10 maxlength=120 style='width:300px; display: none; color: #888;' disabled>");
  v18 = printf("</td>");
  etr(v18);
  return puts("</table>");
}
// EBAC: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F944: using guessed type int __fastcall file_exists(_DWORD);

//----- (0001DA9C) --------------------------------------------------------
int __fastcall sub_1DA9C(const char *a1)
{
  int v1; // r4@1
  int result; // r0@2

  v1 = (int)a1;
  if ( !strcmp(a1, "hostname") )
  {
    result = sub_1A9F4();
  }
  else if ( !strcmp((const char *)v1, "configmgmt") )
  {
    result = sub_1D914();
  }
  else if ( !strcmp((const char *)v1, "autosaving") )
  {
    result = sub_1D078(v1);
  }
  else if ( !strcmp((const char *)v1, "fakedns") )
  {
    result = sub_1CFA8(v1);
  }
  else if ( !strcmp((const char *)v1, "dhcp_restart") )
  {
    result = sub_1CF7C();
  }
  else if ( !strcmp((const char *)v1, "nologin") )
  {
    result = sub_1AB1C(v1);
  }
  else if ( !strcmp((const char *)v1, "wbmpopup") )
  {
    result = sub_1CDE4(v1);
  }
  else if ( !strcmp((const char *)v1, "upnp") )
  {
    result = sub_1CB88(v1);
  }
  else if ( !strcmp((const char *)v1, (const char *)&unk_61A66) )
  {
    result = sub_1D440();
  }
  else if ( !strcmp((const char *)v1, "restart") )
  {
    result = sub_1A310();
  }
  else if ( !strcmp((const char *)v1, "apcplan") )
  {
    result = sub_1CCFC(v1);
  }
  else if ( !strcmp((const char *)v1, "hubapmode") )
  {
    result = sub_1D764();
  }
  else if ( !strcmp((const char *)v1, "realtime") )
  {
    result = sub_1D120();
  }
  else if ( !strcmp((const char *)v1, "snmp") )
  {
    result = sub_1C8E4();
  }
  else
  {
    result = strcmp((const char *)v1, "multilang");
    if ( !result )
      result = sub_1C7CC();
  }
  return result;
}

//----- (0001DCFC) --------------------------------------------------------
int __fastcall sub_1DCFC(const char *a1, int a2, int a3)
{
  const char *v3; // r6@1
  int v4; // r5@1
  int v5; // r4@1

  v3 = a1;
  v4 = a3;
  v5 = a2;
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%% ID=%s_table STYLE=\"display:none;\">", a1);
  if ( v4 )
    printf(
      "<tr><td height=20 valign=center style=\"padding:3px;width:180px;\">&nbsp; <b>%s</b></td><td align=right>%s</td></tr>",
      v5,
      v4);
  else
    printf("<tr><td colspan=2 height=20 valign=center style=\"padding:3px;\">&nbsp; <b>%s</b></td></tr>", v5);
  printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=2 style='width:640px;'></td></tr>");
  printf("<tr><td  colspan=2 valign=top style=\"padding:5px\" >");
  sub_1DA9C(v3);
  return puts((const char *)&unk_6450B);
}

//----- (0001DD80) --------------------------------------------------------
int __fastcall sub_1DD80(int a1)
{
  int v1; // r5@1
  int v2; // r0@1
  char *v3; // r4@1
  int v4; // r3@1
  int v5; // r1@4
  int v6; // r0@4
  int v7; // r1@4
  int v8; // r0@4
  int v9; // r1@4
  int v10; // r0@4
  int v11; // r1@4
  int v12; // r0@4
  int v13; // r1@4
  int v14; // r0@4
  int v15; // r1@4
  int v16; // r0@4
  int v17; // r1@4
  int v18; // r0@4
  int v19; // r1@4
  int v20; // r0@4
  int v21; // r1@4
  int v22; // r0@4
  int v23; // r1@4
  int v24; // r0@4
  int v25; // r1@4
  int v26; // r0@4
  int v27; // r1@4
  int v28; // r0@4
  int v29; // r1@4
  int v30; // r0@4
  int v31; // r1@4
  int v32; // r0@4
  int v33; // r1@4
  int v34; // r0@4
  int v35; // r1@4
  int v36; // r0@4
  int v37; // r4@4
  int v38; // r0@4
  int v40; // [sp+0h] [bp-310h]@1
  char dest; // [sp+200h] [bp-110h]@1

  v1 = a1;
  strcpy(&dest, "");
  printf("<form method=\"post\" action=\"timepro.cgi\" name=\"sysconf_fm\"> ");
  puts("<table style=\"border-collapse:collapse; border-style:none solid solid solid; border-width:0px 1px 1px 1px; border-color:#eeeeee;width:642 \" cellspacing=0px cellpadding=0px>");
  printf("<input type=hidden name=tmenu value=sysconf>");
  printf("<input type=hidden name=\"smenu\" value=\"misc\">");
  v2 = printf("<input type=hidden name=\"act\"id=act  value=\"\">");
  str(v2);
  printf("<td width=100%% height=%d colspan=2 style='border-bottom: 1px solid #CCC;'>", 260);
  v3 = (char *)&v40 + snprintf2(&v40, 128, (const char *)&unk_646B1);
  v4 = get_pvalue(v1, "act");
  if ( v4 || (v4 = get_pvalue(v1, "service")) != 0 )
    snprintf2(v3, 128, "&service=%s", v4);
  printf(
    "<iframe name=\"sysconf_misc_iframe\" src=\"%s\" frameborder=no width=100%% height=340 align=left scrolling=yes></iframe>",
    &v40);
  printf("</td></tr>");
  puts("<tr height=165 style=\"background-Color:#eeeeee\"><td valign=top colspan=2>");
  v6 = sub_134F4(950, v5);
  sub_1DCFC("multilang", v6, 0);
  v8 = sub_134F4(927, v7);
  sub_1DCFC("hostname", v8, 0);
  v10 = sub_134F4(600, v9);
  sub_1DCFC("configmgmt", v10, 0);
  v12 = sub_134F4(948, v11);
  sub_1DCFC("autosaving", v12, 0);
  v14 = sub_134F4(949, v13);
  sub_1DCFC("fakedns", v14, 0);
  v16 = sub_134F4(957, v15);
  sub_1DCFC("nologin", v16, 0);
  v18 = sub_134F4(952, v17);
  sub_1DCFC("wbmpopup", v18, 0);
  v20 = sub_134F4(45, v19);
  sub_1DCFC((const char *)&unk_61A66, v20, 0);
  v22 = sub_134F4(921, v21);
  sub_1DCFC("restart", v22, 0);
  v24 = sub_134F4(917, v23);
  sub_1DCFC("apcplan", v24, 0);
  v26 = sub_134F4(1012, v25);
  sub_1DCFC("upnp", v26, 0);
  v28 = sub_134F4(928, v27);
  sub_1DCFC("hubapmode", v28, 0);
  v30 = sub_134F4(604, v29);
  sub_1DCFC("snmp", v30, 0);
  v32 = sub_134F4(603, v31);
  sub_1DCFC("realtime", v32, 0);
  v34 = sub_134F4(924, v33);
  sub_1DCFC("dhcp_restart", v34, 0);
  printf("</td></tr>");
  printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=2></td></tr>");
  printf("<tr align=right valign=middle height=28 style=\"background-Color:#eeeeee\"><td align=right width=595>");
  printf("</td><td align=right>");
  v36 = sub_134F4(28, v35);
  v37 = v36;
  v38 = hwinfo_get_reboot_duration(v36);
  printf("<input type=button id=apply_bt name=params_bt value=\"%s\" onclick=\"ApplySysconfig(%d);\">", v37, v38);
  printf("</td></tr>");
  printf("</table>");
  return printf("</form>");
}
// EBAC: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);

//----- (0001E0A8) --------------------------------------------------------
int __fastcall sub_1E0A8(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  _UNKNOWN *v7; // r0@1
  int v8; // r1@1
  int v9; // r4@1
  int v10; // r1@1
  int v11; // r0@1
  int v12; // r1@1
  int v13; // r0@1

  v2 = a1;
  sub_1A554(a1, a2);
  sub_133E4((int)"sysconf", (int)"misc");
  printf("<style>");
  printf("form { margin: 0; }");
  printf("input[type='text'] { border: 1px solid #CCC; }");
  printf("input[type='radio'], input[type='checkbox'] { vertical-align: sub; }");
  printf("</style>");
  sub_1DD80(v2);
  v4 = sub_134F4(27, v3);
  sub_1A358("apply_mask", v4);
  v6 = sub_134F4(954, v5);
  sub_1A358("reboot_mask", v6);
  printf("<style>");
  printf("#%s p { margin: 5px 0 5px 10px; text-align: left; }", &unk_6496B);
  printf("</style>");
  printf("<DIV id=\"%s\" style=\"display:none;\">", &unk_6496B);
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:200px; top:198px; width:240px; height:75px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"240\" height=\"70\">");
  printf("<tr><td width=\"35px\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v7 = sub_126C4();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v7);
  printf("</SPAN></td>");
  printf("<td height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\">\n");
  printf("<p id=configmgmt_success style='line-height: 21px; height: 40px;'>");
  v9 = sub_134F4(862, v8);
  v11 = sub_134F4(853, v10);
  printf("%s<br>%s</p>", v9, v11);
  v13 = sub_134F4(861, v12);
  printf("<p id=configmgmt_fail>%s</p>", v13);
  printf("<p id='configmgmt_reboot_seconds'></p>");
  printf("</SPAN></td>");
  return printf((const char *)&unk_60F0E);
}

//----- (0001E274) --------------------------------------------------------
FILE *__fastcall sub_1E274(int a1, int a2)
{
  FILE *result; // r0@1
  FILE *v3; // r4@1
  signed int v4; // r4@3
  const char *v5; // r0@8
  char v6; // [sp+8h] [bp-98h]@1
  void *ptr; // [sp+88h] [bp-18h]@1
  size_t n; // [sp+8Ch] [bp-14h]@1

  n = 0;
  get_value_post_multipart_file(a2, "restore_config_file", &ptr, &v6);
  result = fopen("/var/run/rsavefs.gz", "w+");
  v3 = result;
  if ( result )
  {
    fwrite(ptr, 1u, n, result);
    fclose(v3);
    system((const char *)&unk_64C49);
    if ( restore_backup_config("/var/run/rsavefs") == -1 )
    {
      if ( v6 )
      {
        syslog_msg(3, "%s%s", "@{22}", &v6, 128, &n);
        v4 = 0;
      }
      else
      {
        v4 = 0;
      }
    }
    else
    {
      syslog_msg(1, "%s%s");
      signal_reboot(3);
      v4 = 1;
    }
    unlink("/var/run/rsavefs.gz");
    unlink("/var/run/rsavefs");
    printf("<script>");
    if ( v4 )
      v5 = "location.href = 'timepro.cgi?tmenu=iframe&smenu=sysconf_misc_configmgmt_submit&act=restore&result=success';";
    else
      v5 = "location.href = 'timepro.cgi?tmenu=iframe&smenu=sysconf_misc_configmgmt_submit&act=restore&result=fail';";
    printf(v5);
    result = (FILE *)printf("</script>");
  }
  return result;
}
// F128: using guessed type int __fastcall get_value_post_multipart_file(_DWORD, _DWORD, _DWORD, _DWORD);
// F470: using guessed type int syslog_msg(_DWORD, const char *, ...);
// F6B0: using guessed type int __fastcall signal_reboot(_DWORD);
// FBD8: using guessed type int __fastcall restore_backup_config(_DWORD);

//----- (0001E3A8) --------------------------------------------------------
int __fastcall sub_1E3A8(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r6@1
  int v4; // r0@8
  int v5; // r0@8
  int v6; // r0@8
  int v7; // r0@8
  int v9; // [sp+0h] [bp-30h]@1

  v2 = a2;
  v3 = a1;
  sub_133E4((int)"sysconf", (int)"misc");
  if ( get_value_post(v2, "act", &v9, 32) )
  {
    if ( !strcmp((const char *)&v9, "default") )
    {
      defaultconf();
      signal_reboot(3);
    }
  }
  else if ( get_value(v3, "act", &v9, 32) && !strcmp((const char *)&v9, "restore") )
  {
    printf("<script>");
    printf("setTimeout(function() {");
    printf("UnMaskIt(parent.document, 'apply_mask');");
    if ( get_value(v3, "result", &v9, 32) && !strcmp((const char *)&v9, "success") )
    {
      printf("parent.document.getElementById('configmgmt_success').style.display = '';");
      v4 = printf("parent.document.getElementById('configmgmt_fail').style.display = 'none';");
      v5 = hwinfo_get_reboot_duration(v4);
      v6 = printf("maskRebootMsg(%d, 'configmgmt_reboot', parent.document);", v5);
      v7 = hwinfo_get_reboot_duration(v6);
      printf("setTimeout(function() { parent.location.reload(); }, %d000);", v7);
    }
    else
    {
      printf("parent.document.getElementById('configmgmt_success').style.display = 'none';");
      printf("parent.document.getElementById('configmgmt_fail').style.display = '';");
      printf("MaskIt(parent.document, 'configmgmt_reboot_mask');");
      printf("setTimeout(function() { UnMaskIt(parent.document, 'configmgmt_reboot_mask'); }, 5000);");
    }
    printf("}, 500);");
    printf("</script>");
  }
  printf("<style>");
  printf("body { margin: 0; background-color: #EEE; }");
  printf("form { margin: 0; }");
  printf("</style>");
  puts("<form method=post action=timepro.cgi name=default_fm enctype=\"multipart/form-data\">");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=sysconf_misc_configmgmt_submit>");
  puts("<input type=hidden name=act value=default>");
  printf("</form>");
  puts("<form method=post action=timepro.cgi name=restore_fm enctype=\"multipart/form-data\" style='padding-top: 2px;'>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=sysconf_misc_configmgmt_restore>");
  puts("<input type=hidden name=act value=restore>");
  printf("<td><input type=file name=\"restore_config_file\" size=10 maxlength=120 style='width:300px; color: #888;' onchange='validateCFGFile(this);'></td>");
  return printf("</form>");
}
// EBAC: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// F6B0: using guessed type int __fastcall signal_reboot(_DWORD);
// FA40: using guessed type int defaultconf(void);

//----- (0001E5E8) --------------------------------------------------------
int __fastcall sub_1E5E8(int a1)
{
  int v1; // r5@1
  int v2; // r6@3
  int v3; // r0@5
  int v4; // r1@7
  int v5; // r0@7
  int v6; // r0@7
  int v7; // r1@8
  int v8; // r0@8
  int v9; // r0@8
  const char *v10; // r4@8
  int v11; // r1@8
  int v12; // r0@8
  int v13; // r0@8
  char *v14; // r4@8
  char *v15; // r1@9
  int v16; // r1@11
  int v17; // r0@11
  int v18; // r1@11
  int v19; // r0@13
  int v20; // r0@13
  int v21; // r1@13
  int v22; // r0@13
  int v23; // r1@13
  int v24; // r0@13
  _UNKNOWN *v25; // r4@13
  int v26; // r1@13
  int v27; // r0@13
  int v28; // r1@13
  int v29; // r0@13
  int v30; // r1@13
  int v31; // r0@13
  int v32; // r0@13
  int v33; // r1@13
  int v34; // r0@13
  int v35; // r1@13
  int v36; // r1@14
  int v37; // r0@14
  int v38; // r1@14
  int v39; // r0@16
  int v40; // r0@17
  int v41; // r1@17
  int v42; // r0@17
  int v43; // r1@17
  int v44; // r0@17
  int v45; // r1@17
  int v46; // r0@17
  int v47; // r1@17
  int v48; // r0@17
  _UNKNOWN *v49; // r4@17
  int v50; // r1@17
  int v51; // r0@17
  int v52; // r1@17
  int v53; // r0@17
  int v54; // r1@17
  int v55; // r0@17
  int v56; // r0@17
  int v58; // [sp+4h] [bp-4B4h]@13
  int v59; // [sp+84h] [bp-434h]@13
  char v60; // [sp+104h] [bp-3B4h]@13
  char v61; // [sp+1C4h] [bp-2F4h]@13
  char dest; // [sp+2C4h] [bp-1F4h]@5
  char v63; // [sp+3C4h] [bp-F4h]@13
  int v64; // [sp+444h] [bp-74h]@8
  int v65; // [sp+484h] [bp-34h]@1
  int v66; // [sp+4A4h] [bp-14h]@1

  v1 = a1;
  v66 = 0;
  v2 = get_wan_ip("wan1", &v65) || get_default_gateway("br0", &v65);
  strcpy(&dest, "http://download.iptime.co.kr/online_upgrade/ipTIME_Firmware_Wizard(wired).exe");
  sub_133E4((int)"sysconf", (int)"swupgrade");
  puts("<table cellpadding=0px cellspacing=0px style='background-Color: #EEE; width: 641px;'>");
  puts("<tr><td>");
  puts("<table cellspacing=0px cellpadding=0px style='width: 640px; border-bottom: 1px solid #DDD;'>");
  v3 = get_intvalue(v1, "upgradedone", &v66);
  if ( v3 && v66 )
  {
    str(v3);
    printf("<td colspan=2>");
    v5 = sub_134F4(990, v4);
    printf((const char *)v5);
    v6 = puts("</td>");
    etr(v6);
  }
  printf("<tr style='background-color: #FFF; height: 24px;'>");
  v8 = sub_134F4(983, v7);
  v9 = printf("<td style='width:190px; padding-left: 5px;'>%s</td>", v8);
  v10 = (const char *)get_firmware_version2(v9);
  printf("<td>");
  printf(v10);
  printf("</td>");
  printf("</tr>");
  printf("<tr style='background-color: #F7F7F7; height: 24px;'>");
  v12 = sub_134F4(977, v11);
  printf("<td style='padding-left: 5px;'>%s</td>", v12);
  sub_1236C((int)&v64, 64);
  printf("<td>%s</td>", &v64);
  printf("</tr>");
  printf("<tr style='background-color: #FFF; height: 24px;'>");
  printf("<td colspan=2></td>");
  printf("</tr>");
  puts("</table></td></tr>");
  puts("<tr><td>");
  v13 = puts("<table cellspacing=0px cellpadding=0px>");
  str(v13);
  printf("<td style=\"height:20px; padding-top: 0px; padding-bottom: 2px; padding-left: 5px; padding-right: 10px;\">");
  v14 = "";
  puts("<form method=post action=timepro.cgi name=view_fm style='margin:0; padding: 5px 0;'>");
  if ( v2 )
    v15 = "checked";
  else
    v15 = "";
  printf(
    "<input type=radio id=firmup_online name=firmup value=online style='vertical-align: bottom;' onclick=\"FirmUpView();\" %s>",
    v15);
  v17 = sub_134F4(982, v16);
  printf("<label for=firmup_online style='margin-right: 35px;'> %s</label>", v17);
  if ( !v2 )
    v14 = "checked";
  v19 = sub_134F4(981, v18);
  printf(
    "<input type=radio id=firmup_manual name=firmup value=manual style='vertical-align: bottom;' onclick=\"FirmUpView();\" %s><label for=firmup_manual> %s</label>",
    v14,
    v19);
  printf("</td>");
  printf("<input type=hidden name=status_code>");
  v20 = printf("</form>");
  etr(v20);
  printf("<tr id=online>");
  puts("<td align=left>");
  printf("<table style='width: 640px;'>");
  printf("<tr height=40 valign=top><td>");
  printf("<table cellpadding=0px cellspacing=0px style='background-color: #FFF; width: 620px; margin: 0 5px; min-height:52px;'><tr><td style='padding: 10px; height: 52px;'>");
  printf("<span ID=firmware_status style='color:gray;'></span>");
  printf("</td></tr></table>");
  printf("</td></tr>");
  printf("<tr height=40 valign=top><td align=right>");
  puts("<form method=post action=timepro.cgi name=firmup2_fm style='margin: 5px 0 0 0; border-width: 1px 0; border-color: #DDD; border-style: solid; padding: 5px;'>");
  v22 = sub_134F4(317, v21);
  printf(
    "<input type=button name=autoup id=cancel_bt style=\"display:none;\" value=\"%s\" onclick=\"CancelFirmUp();\">\n",
    v22);
  v24 = sub_134F4(316, v23);
  printf(
    "<input type=button name=autoup id=onlineupdate_bt value=\"%s\" style='color:gray;' onclick=\"StartFirmUp();\" disabled>\n",
    v24);
  puts("</form>");
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<table cellpadding=0px cellspacing=0px style='margin-left: 5px;'>");
  v25 = sub_126C4();
  v27 = sub_134F4(991, v26);
  printf(
    "<tr style='height: 24px;'><td><img src='/%s/warning.gif' style='margin: 0 3px 1px 3px; vertical-align: middle;'><b style='color: gray;'>%s</b></td></tr>",
    v25,
    v27);
  v29 = sub_134F4(314, v28);
  printf((const char *)&unk_659D9, v29);
  printf("<tr style='height: 18px;'><td><span style='color: gray;'>");
  v31 = sub_134F4(315, v30);
  printf((const char *)v31, &dest);
  printf("</span></td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("</table>");
  printf("<iframe name=\"sysconf_swupgrade_online_status\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_swupgrade_online_status\" frameborder=no style='display:none;'></iframe>");
  v32 = printf("</td>");
  etr(v32);
  printf("<tr id=manual>");
  puts("<td align=left>");
  printf("<table style='width: 640px;'>");
  printf("<tr height=40 valign=top><td>");
  printf("<table id=manual_status_table cellpadding=0px cellspacing=0px style='margin: 0 5px; background-color: #FFF; width: 620px;'>");
  v34 = sub_134F4(984, v33);
  printf("<tr style='height: 18px;'><td style='color:gray; padding-left: 10px; padding-top: 10px;'>%s</td></tr>", v34);
  get_si("pi", &v58);
  snprintf2(&v61, 256, "%s", &v60);
  snprintf2(&v63, 128, "%s", &v59);
  if ( v61 )
  {
    printf("<tr style='height: 18px;'><td style='color:gray; padding-left: 10px;'>");
    v37 = sub_134F4(985, v36);
    printf((const char *)v37, &v61, &v63);
    printf("</td></tr>");
  }
  else if ( *(_BYTE *)sub_134F4(985, v35) )
  {
    v39 = sub_134F4(985, v38);
    printf("<tr style='height: 18px;'><td style='color:gray; padding-left: 10px;'>%s</td></tr>", v39);
  }
  v40 = sub_134F4(986, v38);
  printf("<tr style='height: 18px;'><td style='color:gray; padding-left: 10px;'>%s</td></tr>", v40);
  v42 = sub_134F4(987, v41);
  printf(
    "<tr style='height: 18px;'><td style='color:gray; padding-left: 10px; padding-bottom: 10px;'>%s</td></tr>",
    v42);
  printf("</table>");
  printf("<table id=manual_upload_table cellpadding=0px cellspacing=0px style='margin: 0 5px; background-color: #FFF; width: 620px; display: none;'>");
  v44 = sub_134F4(331, v43);
  printf("<tr style='height: 18px;'><td style='color:gray; padding-left: 10px; padding-top: 10px;'>%s</td></tr>", v44);
  v46 = sub_134F4(338, v45);
  printf("<tr style='height: 18px;'><td style='color:gray; padding-left: 10px;'>%s</td></tr>", v46);
  printf("<tr style='height: 18px;'><td style='color:gray; padding-left: 10px;'></td></tr>");
  printf("<tr style='height: 18px;'><td style='color:gray; padding-left: 10px; padding-bottom: 10px; height: 26px;'></td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<iframe name=\"sysconf_swupgrade_manual_file_form\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_swupgrade_manual_status\" frameborder=no scrolling='no' noresize style='width:100%%; height:39px;'></iframe>");
  puts("<form name='sysconf_swupgrade_manual_file_form' style='margin: 5px 0 0 0; padding: 5px; border-width: 1px 0; border-color: #DDD; border-style: solid; display: none;'>");
  printf("<input type=file name=upgrade size=30 maxlength=120 style='width: 430px; font-size: 12px; color:gray;' disabled>");
  v48 = sub_134F4(979, v47);
  printf(
    "<input type=button name=upload_submit value=\"%s\" style='float: right; font-size: 12px; color: gray;' disabled>\n",
    v48);
  puts("</form>");
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<table cellpadding=0px cellspacing=0px style='margin-left: 5px;'>");
  v49 = sub_126C4();
  v51 = sub_134F4(991, v50);
  printf(
    "<tr style='height: 24px;'><td><img src='/%s/warning.gif' style='margin: 0 3px 1px 3px; vertical-align: middle;'><b style='color: gray;'>%s</b></td></tr>",
    v49,
    v51);
  v53 = sub_134F4(314, v52);
  printf((const char *)&unk_659D9, v53);
  printf("<tr style='height: 18px;'><td><span style='color: gray;'>");
  v55 = sub_134F4(315, v54);
  printf((const char *)v55, &dest);
  printf("</span></td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("</table>");
  v56 = printf("</td>");
  etr(v56);
  puts("</table></td></tr>");
  printf("</table>");
  puts("<script>");
  puts("FirmUpView();");
  return puts("</script>");
}
// E7D4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// EC60: using guessed type int __fastcall get_firmware_version2(_DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// ED44: using guessed type int __fastcall get_default_gateway(_DWORD, _DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F440: using guessed type int __fastcall get_intvalue(_DWORD, _DWORD, _DWORD);
// F8CC: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);

//----- (0001ECA8) --------------------------------------------------------
int sub_1ECA8()
{
  int v0; // r4@1
  int v1; // r1@1
  int v2; // r0@1

  v0 = hwinfo_get_max_firmware_size();
  puts("<style type=\"text/css\">");
  printf("body { margin: 0; background-color: #EEE; }");
  puts("</style>");
  printf("<body>");
  sub_133E4((int)"sysconf", (int)"swupgrade");
  puts("<form method=post action=upgrade.cgi enctype=\"multipart/form-data\" name=image_upload style='margin: 5px 0 0 0; height: 22px; padding: 5px; border-width: 1px 0; border-color: #DDD; border-style: solid;'>");
  printf(
    "<input type=file name=upgrade size=30 maxlength=120 style='width: 430px; font-size: 12px; height: 22px; float:left;' onchange='onChangeForm(this, %d);'>",
    v0);
  puts("<input type=hidden name=act>");
  v2 = sub_134F4(979, v1);
  printf(
    "<input type=button name=upload_submit value=\"%s\" style='float: right; font-size: 12px; height: 22px;' onclick='firmwareSubmit();'>\n",
    v2);
  puts("</form>");
  printf("<script>");
  printf("onChangeForm(document.getElementsByName('upgrade')[0], %d);", v0);
  return printf("</script>");
}
// EE88: using guessed type int hwinfo_get_max_firmware_size(void);

//----- (0001ED74) --------------------------------------------------------
int __fastcall sub_1ED74(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r0@1
  int v4; // r5@6
  int v5; // r4@7
  int result; // r0@7
  signed int v7; // r0@8
  int v8; // r9@12
  int v9; // r0@12
  int v10; // r0@12
  int v11; // r10@12
  int v12; // r0@13
  int v13; // r6@13
  int v14; // r8@15
  int v15; // r1@17
  _UNKNOWN *v16; // r0@18
  int v17; // r7@18
  char *v18; // r4@18
  int v19; // r1@18
  int v20; // r0@18
  int i; // r0@18
  bool v22; // nf@20
  unsigned __int8 v23; // vf@20
  _UNKNOWN *v24; // r0@22
  int v25; // r7@22
  char *v26; // r4@22
  int v27; // r1@22
  int v28; // r0@22
  int j; // r0@22
  _UNKNOWN *v30; // r0@26
  int v31; // r7@26
  char *v32; // r6@26
  int v33; // r1@26
  int v34; // r5@26
  int v35; // r4@26
  int v36; // r0@26
  int v37; // r0@26
  int k; // r4@26
  _UNKNOWN *v39; // r0@30
  int v40; // r7@30
  char *v41; // r4@30
  int v42; // r1@30
  int v43; // r0@30
  int l; // r0@30
  _UNKNOWN *v45; // r0@34
  signed int v46; // r7@34
  char *v47; // r4@34
  int v48; // r1@34
  int v49; // r0@34
  int v50; // r4@34
  int v51; // r4@34
  int v52; // r6@34
  int v53; // r1@34
  int v54; // r5@34
  int v55; // r1@34
  int v56; // r0@34
  int v57; // r0@37
  int v58; // r0@40
  int v59; // r1@45
  int v60; // r0@46
  int v61; // r5@46
  int v62; // r1@47
  int v63; // r0@48
  int v64; // r5@49
  int v65; // r0@49
  _UNKNOWN *v66; // r0@51
  int v67; // r4@51
  int v68; // r1@51
  int v69; // r0@51
  int v70; // r1@52
  int v71; // r0@53
  char *v72; // r5@53
  int v73; // r4@53
  int v74; // r1@53
  int v75; // r0@53
  int v76; // r0@54
  int v77; // r4@55
  int v78; // r1@55
  int v79; // r0@55
  int v80; // r1@56
  int v81; // r0@56
  char v82[512]; // [sp+8h] [bp-500h]@13
  char v83; // [sp+208h] [bp-300h]@49
  char v84; // [sp+3C8h] [bp-140h]@49
  int v85; // [sp+448h] [bp-C0h]@13
  int v86; // [sp+468h] [bp-A0h]@34
  int v87; // [sp+488h] [bp-80h]@34
  int v88; // [sp+4A8h] [bp-60h]@44
  int v89; // [sp+4C8h] [bp-40h]@1

  v2 = a2;
  sub_133E4((int)"sysconf", (int)"swupgrade");
  v3 = get_value_post(v2, "act", &v89, 32);
  if ( !v3 )
    goto LABEL_12;
  if ( !strcmp((const char *)&v89, "update") )
  {
    set_firmup_status(1);
    v3 = signal_start("firmupui");
    goto LABEL_12;
  }
  if ( !strcmp((const char *)&v89, "cancel") )
  {
    v3 = system("/usr/bin/killall wget");
    goto LABEL_12;
  }
  v3 = strcmp((const char *)&v89, "status");
  v4 = v3;
  if ( v3 )
  {
LABEL_12:
    v8 = hwinfo_get_firmup_duration(v3);
    printf("<html>");
    printf("<form method=post name=firmup_fm action=timepro.cgi>");
    printf("<input type=hidden name=tmenu value=iframe>");
    printf("<input type=hidden name=smenu value=sysconf_swupgrade_online_status>");
    printf("<input type=hidden name=act>");
    printf("</form>");
    v9 = puts("<script>");
    v10 = get_firmup_status(v9);
    v11 = v10;
    if ( v10 )
    {
      snprintf2(&v85, 32, "firmup_counter_%d", v10);
      v12 = istatus_get_intvalue_direct(&v85);
      v13 = (int)v82;
      if ( v12 == -1 )
        v12 = 0;
      v14 = v12 + 1;
      if ( v12 + 1 > 64 )
        v14 = 0;
      snprintf2(&v85, 32, "firmup_counter_%d", v11);
      istatus_set_intvalue_direct(&v85, v14);
      switch ( v11 )
      {
        case 1:
          v16 = sub_126C4();
          v17 = 0;
          v18 = &v82[snprintf2(v82, 512, "<img width=10 height=10 src=\"/%s/apply_ani.gif\">", v16)];
          v20 = sub_134F4(328, v19);
          for ( i = snprintf2(v18, 512, " %s", v20); ; i = snprintf2(v18, 512, ".") )
          {
            v18 += i;
            v23 = __OFSUB__(v17, v14);
            v22 = v17++ - v14 < 0;
            if ( !(v22 ^ v23) )
              break;
          }
          puts("DisableRadio( parent.document.view_fm.firmup);");
          puts("DisableObj( parent.document.getElementById('onlineupdate_bt'));");
          puts("parent.document.getElementById('onlineupdate_bt').style.color = 'gray';");
          puts("ShowObj( parent.document.getElementById('cancel_bt'));");
          goto LABEL_58;
        case 2:
          puts("DisableRadio( parent.document.view_fm.firmup);");
          v24 = sub_126C4();
          v25 = 0;
          v26 = &v82[snprintf2(v82, 512, "<img width=10 height=10 src=\"/%s/apply_ani.gif\">", v24)];
          v28 = sub_134F4(324, v27);
          for ( j = snprintf2(v26, 512, " %s", v28); ; j = snprintf2(v26, 512, ".") )
          {
            v26 += j;
            v23 = __OFSUB__(v25, v14);
            v22 = v25++ - v14 < 0;
            if ( !(v22 ^ v23) )
              break;
          }
          goto LABEL_58;
        case 3:
          puts("DisableRadio( parent.document.view_fm.firmup);");
          puts("ShowObj( parent.document.getElementById('cancel_bt'));");
          v30 = sub_126C4();
          v31 = 0;
          v32 = &v82[snprintf2(v82, 512, "<img width=10 height=10 src=\"/%s/apply_ani.gif\">", v30)];
          v34 = sub_134F4(325, v33);
          v35 = hwinfo_get_max_firmware_size();
          v36 = get_filesize("/tmp/firmware");
          v37 = sub_43AF4(100 * v36, v35);
          for ( k = (int)&v32[snprintf2(v32, 512, " %s (%d %%) ", v34, v37)]; ; k += snprintf2(k, 512, ".") )
          {
            v23 = __OFSUB__(v31, v14);
            v22 = v31++ - v14 < 0;
            if ( !(v22 ^ v23) )
              break;
          }
          goto LABEL_58;
        case 4:
          puts("DisableRadio( parent.document.view_fm.firmup);");
          puts("HideObj( parent.document.getElementById('cancel_bt'));");
          v39 = sub_126C4();
          v40 = 0;
          v41 = &v82[snprintf2(v82, 512, "<img width=10 height=10 src=\"/%s/apply_ani.gif\">", v39)];
          v43 = sub_134F4(322, v42);
          for ( l = snprintf2(v41, 512, " %s", v43); ; l = snprintf2(v41, 512, ".") )
          {
            v41 += l;
            v23 = __OFSUB__(v40, v14);
            v22 = v40++ - v14 < 0;
            if ( !(v22 ^ v23) )
              break;
          }
          goto LABEL_58;
        case 5:
          puts("DisableRadio( parent.document.view_fm.firmup);");
          puts("HideObj( parent.document.getElementById('cancel_bt'));");
          get_ifconfig("br0", &v87, &v86);
          v45 = sub_126C4();
          v46 = 0;
          v47 = &v82[snprintf2(v82, 512, "<img width=10 height=10 src=\"/%s/apply_ani.gif\">", v45)];
          v49 = sub_134F4(330, v48);
          v50 = (int)&v47[snprintf2(v47, 512, " %s", v49)];
          v51 = v50 + snprintf2(v50, 512, "<span id=firmup_dot></span><br>");
          v52 = snprintf2(v51, 512, "&nbsp;&nbsp;&nbsp;&nbsp;");
          v54 = sub_134F4(857, v53);
          v56 = sub_134F4(879, v55);
          snprintf2(v51 + v52, 512, "(%s <span id=firmup_duration>%d</span>%s)", v54, v8, v56);
          set_firmup_status(100);
          goto LABEL_59;
        case 6:
          strcpy(v82, "");
          goto LABEL_57;
        default:
          goto LABEL_57;
        case 10:
        case 14:
          puts("EnableRadio( parent.document.view_fm.firmup);");
          puts("EnableObj( parent.document.getElementById('onlineupdate_bt'));");
          puts("parent.document.getElementById('onlineupdate_bt').style.color = '';");
          puts("HideObj( parent.document.getElementById('cancel_bt'));");
          if ( v11 == 14 )
            v57 = 326;
          else
            v57 = 327;
          v13 = (int)v82;
          break;
        case 11:
          v57 = 321;
          break;
        case 12:
          v57 = 323;
          break;
        case 13:
          v57 = 329;
          break;
      }
      v58 = sub_134F4(v57, v15);
      snprintf2(v13, 512, " %s", v58);
      set_firmup_status(0);
    }
    else if ( get_wan_ip("wan1", &v88) || get_default_gateway("br0", &v88) )
    {
      v64 = get_firmupcheck_status();
      get_si("pi", &v83);
      v65 = snprintf2(&v84, 128, &v83);
      switch ( v64 )
      {
        case 0:
          signal_start("firmupcheck");
          goto LABEL_51;
        case 1:
LABEL_51:
          v66 = sub_126C4();
          v67 = snprintf2(v82, 512, "<img width=10 height=10 src=\"/%s/apply_ani.gif\"> ", v66);
          v69 = sub_134F4(320, v68);
          snprintf2(&v82[v67], 512, (const char *)v69, &v84);
LABEL_58:
          v46 = 1;
          goto LABEL_59;
        default:
          break;
        case 3:
          set_firmupcheck_status(0);
          if ( get_firmupcheck_version(&v85) )
          {
            v71 = sub_134F4(339, v70);
            v46 = 0;
            v72 = &v82[snprintf2(v82, 512, (const char *)v71, &v85)];
            v73 = snprintf2(v72, 512, "<br>");
            v75 = sub_134F4(340, v74);
            snprintf2(&v72[v73], 512, (const char *)v75);
            puts("EnableObj( parent.document.getElementById('onlineupdate_bt'));");
            puts("parent.document.getElementById('onlineupdate_bt').style.color = '';");
            puts("HideObj( parent.document.getElementById('cancel_bt'));");
          }
          else
          {
            v76 = sub_134F4(318, v70);
            v46 = 0;
            snprintf2(v82, 512, (const char *)v76);
          }
          goto LABEL_59;
        case 4:
          v77 = get_firmware_version2(v65);
          set_firmupcheck_status(0);
          v79 = sub_134F4(319, v78);
          snprintf2(v82, 512, (const char *)v79, v77);
          break;
        case 5:
          set_firmupcheck_status(0);
          v81 = sub_134F4(318, v80);
          snprintf2(v82, 512, (const char *)v81);
          break;
      }
    }
    else
    {
      v60 = sub_134F4(48, v59);
      v61 = snprintf2(v82, 512, "%s<br>", v60);
      if ( !get_wan_link("wan1") && !get_default_gateway("br0", &v88) )
      {
        v63 = sub_134F4(49, v62);
        v46 = v11;
        snprintf2(&v82[v61], 512, "<br>%s", v63);
LABEL_59:
        printf("if(parent.document.getElementById('firmware_status'))");
        printf("parent.document.getElementById('firmware_status').innerHTML = '%s';\n", v82);
        if ( v11 == 5 )
        {
          printf("parent.PrintRemainTime('firmup_duration',%d);\n", v8);
          puts("PrintDot('firmup_dot',64,64);");
        }
        if ( v46 == 1 )
          printf("setTimeout(function() { location.href = 'timepro.cgi?tmenu=iframe&smenu=sysconf_swupgrade_online_status'; }, 3000);");
        puts("</script>");
        return printf("</html>");
      }
    }
LABEL_57:
    v46 = 0;
    goto LABEL_59;
  }
  v5 = ((int (*)(void))get_firmup_status)();
  result = printf("Status:%d", v5);
  if ( v5 == 5 )
  {
    v7 = 100;
  }
  else
  {
    if ( v5 <= 9 )
      return result;
    v7 = v4;
  }
  return set_firmup_status(v7);
}
// E7D4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// E828: using guessed type int __fastcall istatus_set_intvalue_direct(_DWORD, _DWORD);
// EC60: using guessed type int __fastcall get_firmware_version2(_DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// ED44: using guessed type int __fastcall get_default_gateway(_DWORD, _DWORD);
// EDEC: using guessed type int __fastcall get_firmup_status(_DWORD);
// EE1C: using guessed type int __fastcall signal_start(_DWORD);
// EE88: using guessed type int hwinfo_get_max_firmware_size(void);
// EEE8: using guessed type int __fastcall set_firmupcheck_status(_DWORD);
// F008: using guessed type int __fastcall get_wan_link(_DWORD);
// F0EC: using guessed type int __fastcall istatus_get_intvalue_direct(_DWORD);
// F17C: using guessed type int __fastcall get_filesize(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F23C: using guessed type int __fastcall hwinfo_get_firmup_duration(_DWORD);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F344: using guessed type int get_firmupcheck_status(void);
// F8CC: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);
// F908: using guessed type int __fastcall set_firmup_status(_DWORD);
// FD94: using guessed type int __fastcall get_firmupcheck_version(_DWORD);
// 1ED74: using guessed type char var_500[512];

//----- (0001F610) --------------------------------------------------------
int __fastcall sub_1F610(int a1)
{
  int v1; // r5@1
  int v3; // [sp+0h] [bp-50h]@1
  char v4; // [sp+20h] [bp-30h]@1

  v1 = a1;
  get_wan_type(a1, &v4);
  get_wan_hw_ifname(v1, &v3);
  sub_133E4((int)"netconf", (int)"wansetup");
  puts("<script language=JavaScript>");
  printf("ShowWansetup('%s','%s');", &v3, &v4);
  puts("check_dns()");
  puts("OnCheckEnableLCP();");
  return puts("</script>");
}
// E96C: using guessed type int __fastcall get_wan_type(_DWORD, _DWORD);
// F0F8: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);

//----- (0001F698) --------------------------------------------------------
int __fastcall sub_1F698(int a1, int a2, int a3, int a4)
{
  int v4; // r6@1
  int v5; // r7@1
  int v6; // r4@1
  int v7; // r1@3
  char *v8; // r1@6
  char *v9; // r0@7
  char *v10; // r1@9
  char *v11; // r0@10
  char *v12; // r1@12
  char *v13; // r0@13
  char *v14; // r1@15
  char *v15; // r0@16
  char *v16; // r5@21
  signed int v17; // r4@21
  char *v18; // r5@22
  signed int v19; // r4@22
  int result; // r0@23
  bool v21; // zf@27
  int v22; // r0@30
  char *v23; // r3@30
  char v24; // [sp+18h] [bp-40h]@7
  char v25; // [sp+1Dh] [bp-3Bh]@10
  char v26; // [sp+22h] [bp-36h]@13
  char v27; // [sp+27h] [bp-31h]@16
  char dest; // [sp+2Ch] [bp-2Ch]@3

  v4 = a1;
  v5 = a3;
  v6 = a4;
  if ( a2 && *(_BYTE *)a2 )
    sf_strncpy(&dest, a2, 20);
  else
    strcpy(&dest, "");
  if ( dest )
  {
    v8 = strtok(&dest, ".");
    if ( v8 )
    {
      v9 = &v24;
    }
    else
    {
      v9 = &v24;
      v8 = "0";
    }
    strcpy(v9, v8);
    v10 = strtok(0, ".");
    if ( v10 )
    {
      v11 = &v25;
    }
    else
    {
      v11 = &v25;
      v10 = "0";
    }
    strcpy(v11, v10);
    v12 = strtok(0, ".");
    if ( v12 )
    {
      v13 = &v26;
    }
    else
    {
      v13 = &v26;
      v12 = "0";
    }
    strcpy(v13, v12);
    v14 = strtok(0, ".");
    if ( v14 )
    {
      v15 = &v27;
    }
    else
    {
      v15 = &v27;
      v14 = "0";
    }
    strcpy(v15, v14);
  }
  else
  {
    v24 = 0;
    v27 = 0;
    v26 = 0;
    v25 = 0;
  }
  if ( v6 )
  {
    v18 = &v24;
    v19 = 1;
    do
    {
      printf(
        "<input type=text maxlength=3 size=3 id=\"disabled_%s%d\" style=\"width:28pt; ime-mode:disabled; background-color:#EEEEEE;\" value=\"%s\" disabled>",
        v4,
        v19,
        v18);
      v21 = v19 == 4;
      result = 46;
      ++v19;
      if ( !v21 )
        result = putchar(46);
      v18 += 5;
    }
    while ( v19 != 5 );
  }
  else
  {
    v16 = &v24;
    v17 = 1;
    while ( 1 )
    {
      v21 = v5 == 4;
      if ( v5 == 4 )
        v21 = v17 == 4;
      if ( v21 )
        break;
      v22 = sub_134F4(401, v7);
      v23 = v16;
      v16 += 5;
      printf(
        "<input type=text name=\"%s%d\" maxlength=3 size=3 style=\"width:28pt; ime-mode:disabled;\" value=\"%s\" onfocus=\"this.select();\"\t\t\t    onkeyup=\"IPKeyUp('%s',%d);\" onkeypress=\"return IPKeyDown('%s', %d)\" title=\"%s%d\">",
        v4,
        v17,
        v23,
        v4,
        v17,
        v4,
        v17,
        v22,
        v17,
        *(_DWORD *)&v24);
      v21 = v17 == 4;
      result = 46;
      ++v17;
      if ( !v21 )
        result = putchar(46);
      if ( v17 == 5 )
        return result;
    }
    result = printf(
               "<input type=text name=\"%s%d\" maxlength=3 size=3 style=\"width:28pt; ime-mode:disabled; background-color:#eeeeee;\" value=\"%s\" readonly>",
               v4,
               4,
               &v27);
  }
  return result;
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);

//----- (0001F87C) --------------------------------------------------------
int __fastcall sub_1F87C(int a1, int a2, const char *a3, int a4)
{
  int v4; // r4@1
  const char *v5; // r7@1
  int v6; // r8@1
  int v7; // r10@1
  int v8; // r1@1
  int v9; // r0@1
  char *v10; // r5@1
  const char *v11; // r1@2
  int v12; // r1@4
  int v13; // r0@4
  _UNKNOWN *v14; // r0@6
  char v16; // [sp+18h] [bp-140h]@4
  char v17; // [sp+118h] [bp-40h]@1

  v4 = a1;
  v5 = a3;
  v6 = a4;
  v7 = a2;
  puts("<td class=\"wansetup_main_td\">");
  v9 = sub_134F4(733, v8);
  v10 = "";
  printf("<span class=\"wansetup_main_p\">%s</span></td>\n", v9);
  puts("<td class=\"wansetup_main_td\">");
  snprintf2(&v17, 32, "hw_%s", v4);
  if ( *v5 )
    v11 = v5;
  else
    v11 = 0;
  sub_121A0((int)&v17, v11, v6);
  printf((const char *)&unk_669D1);
  printf(
    "<input type=checkbox id=\"macchk_%s\" class=navi_chk name=hw_conf_%s %s onclick=\"SetHWOnCheckEnableHWButton(this,'hw_%s','%s','macbutton_%s'); setdefaultmac(this, 'hw_%s', '%s');\"><label for=\"macchk_%s\">\n",
    v4,
    v4);
  v13 = sub_134F4(694, v12);
  printf("<span class=\"wansetup_main_span\">%s</span></label>", v13);
  snprintf2(&v16, 256, (const char *)&unk_66ABF, v4, v4, v7, v4, v4, v5, v4);
  snprintf2(&v17, 32, "macbutton_%s", v4);
  if ( !*v5 )
    v10 = "disabled";
  v14 = sub_126C4();
  printf(
    "<button type=\"button\" class=\"wansetup_main_button\" name=\"%s\" style=\"margin-left:5px;\" onclick=\"onclick_macsearchbtn('hw_%s')\" %s>\t\t<img src=\"/%s/fw_search.gif\" style=\"width:16px; height:16px; padding:0; margin:0;\"></button>",
    &v17,
    v4,
    v10,
    v14);
  return printf("</td>");
}
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);

//----- (0001F9DC) --------------------------------------------------------
int __fastcall sub_1F9DC(const char *a1, int a2, int a3)
{
  int v3; // r5@1
  char *v4; // r4@1
  const char *v5; // r7@1
  int v6; // r10@1
  int v7; // r8@4
  int v8; // r0@4
  char *v9; // r4@6
  int v10; // r1@10
  int v11; // r0@12
  char v13; // [sp+10h] [bp-1C0h]@1
  char v14; // [sp+90h] [bp-140h]@4
  char v15; // [sp+110h] [bp-C0h]@4
  char v16; // [sp+190h] [bp-40h]@3

  v3 = a2;
  v4 = &v13;
  v5 = a1;
  v6 = a3;
  get_wan_hw_ifname(a2, &v13);
  if ( !strcmp(v5, "pppoe") || !strcmp(v5, "pptp") )
  {
    v4 = &v16;
    get_pppoe_ifname(v3, &v16);
  }
  v7 = get_mtu_value(v4, 1);
  snprintf2(&v15, 128, "mtu.%s.%s.check", v5, &v13);
  snprintf2(&v14, 128, "mtu.%s.%s", v5, &v13);
  v8 = iconfig_get_intvalue_direct(&v15);
  if ( !v7 )
    v7 = v6;
  v9 = "checked";
  if ( v8 != -1 )
    v5 = (const char *)v8;
  if ( v8 == -1 )
    v5 = 0;
  printf("<td class=\"wansetup_main_td\">");
  puts("<span class=\"wansetup_main_p\">MTU</span>");
  printf("</td>");
  printf(
    "<td class=\"wansetup_main_td\"><input class=\"navi_text\" style=\"width:160px;\" type=text name=%s maxlength=4 value=%d></td>\n",
    &v14,
    v7);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\">");
  if ( !v5 )
    v9 = "";
  v11 = sub_134F4(731, v10);
  printf(
    "<input type=checkbox class=navi_chk id=\"mtuchk_%s\" name='%s' %s onclick=\"OnCheckEnableMTU(this, '%s')\">\t\t<label for=\"mtuchk_%s\"><span class=\"wansetup_main_span\">%s</span></label>\n",
    &v15,
    &v15,
    v9,
    &v14,
    &v15,
    v11);
  return printf("</td>");
}
// E9B4: using guessed type int __fastcall iconfig_get_intvalue_direct(_DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// F0F8: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// F1DC: using guessed type int __fastcall get_pppoe_ifname(_DWORD, _DWORD);
// F7C4: using guessed type int __fastcall get_mtu_value(_DWORD, _DWORD);

//----- (0001FB50) --------------------------------------------------------
int __fastcall sub_1FB50(int a1, int a2)
{
  int v2; // r11@1
  int v3; // r1@1
  int v4; // r0@1
  char *v5; // r4@1
  int v6; // r0@1
  char *v7; // r1@2
  int v8; // r1@4
  int v9; // r0@4
  char *v10; // r1@5
  int v11; // r1@7
  int v12; // r0@7
  char *v13; // r1@8
  int v14; // r1@10
  int v15; // r0@10
  char *v16; // r0@10
  int v17; // r3@10
  int v18; // r1@12
  int v19; // r0@12
  int v20; // r1@12
  int v21; // r0@14
  int v22; // r1@14
  int v23; // r0@14
  int v24; // r1@14
  int v25; // r0@14
  int v26; // r1@16
  int v27; // r0@16
  int v28; // r1@16
  int v29; // r0@16
  int v30; // r1@16
  int v31; // r0@16
  int v32; // r1@16
  int v33; // r0@16
  int v34; // r1@16
  int v35; // r0@16
  int v36; // r1@16
  int v37; // r0@16
  int v38; // r1@16
  int v39; // r0@16
  int v40; // r1@16
  int v41; // r0@16
  int v42; // r1@16
  int v43; // r0@16
  int v44; // r1@18
  int v45; // r0@18
  int v46; // r1@18
  int v47; // r0@18
  char *v48; // r1@19
  int v49; // r1@21
  int v50; // r0@21
  int v51; // r1@21
  int v52; // r0@21
  int v53; // r1@21
  int v54; // r0@21
  int v55; // r1@21
  int v56; // r0@21
  int v57; // r1@21
  int v58; // r0@21
  char *v59; // r1@22
  int v60; // r1@24
  int v61; // r0@24
  int v62; // r1@24
  int v63; // r0@24
  int v64; // r1@24
  int v65; // r0@24
  int v66; // r1@24
  int v67; // r0@24
  int v68; // r1@26
  int v69; // r0@26
  int v70; // r1@26
  int v71; // r0@26
  int v72; // r1@26
  int v73; // r0@26
  int v74; // r1@26
  int v75; // r0@26
  int v77; // [sp+Ch] [bp-334h]@12
  char v78; // [sp+10h] [bp-330h]@16
  char v79; // [sp+90h] [bp-2B0h]@16
  int v80; // [sp+138h] [bp-208h]@21
  int v81; // [sp+13Ch] [bp-204h]@21
  int v82; // [sp+140h] [bp-200h]@21
  int v83; // [sp+148h] [bp-1F8h]@21
  __int16 v84; // [sp+14Eh] [bp-1F2h]@1
  __int16 v85; // [sp+1CEh] [bp-172h]@1
  __int16 v86; // [sp+20Eh] [bp-132h]@1
  __int16 v87; // [sp+24Eh] [bp-F2h]@1
  unsigned __int8 v88; // [sp+26Eh] [bp-D2h]@7
  __int16 v89; // [sp+282h] [bp-BEh]@7
  __int16 v90; // [sp+296h] [bp-AAh]@10
  __int16 v91; // [sp+2AAh] [bp-96h]@16
  __int16 v92; // [sp+2BEh] [bp-82h]@16
  __int16 v93; // [sp+2D2h] [bp-6Eh]@14
  __int16 v94; // [sp+2E6h] [bp-5Ah]@12
  __int16 v95; // [sp+2FAh] [bp-46h]@12
  __int16 v96; // [sp+30Eh] [bp-32h]@1

  v2 = a2;
  strcpy((char *)&v86, "");
  strcpy((char *)&v85, "");
  get_wan_hw_ifname(v2, &v96);
  get_wan_type(v2, &v87);
  v4 = sub_134F4(667, v3);
  v5 = "";
  strcpy((char *)&v84, (const char *)v4);
  printf("<COL width=\"180\"><COL width=\"200\"><COL width=\"%%%%\">");
  puts("<form method=\"post\" action=\"timepro.cgi\" name=\"netconf_wansetup\">");
  puts("<input type=hidden name=\"tmenu\" value=\"netconf\">");
  puts("<input type=hidden name=\"smenu\" value=\"wansetup\">");
  puts("<input type=hidden name=\"act\" value=\"\">");
  puts("<input type=hidden name=\"ocolor\" value=\"\">");
  printf("<input type=hidden name=\"wan\" value=\"%s\">\n", v2);
  v6 = printf("<input type=hidden name=\"ifname\" value=\"%s\">\n", &v96);
  check_valid_account(v6);
  printf("<input type=hidden name=\"nopassword\" value=\"%d\">");
  puts("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"border-top:1px #CCC solid;\"><td class=\"wansetup_main_td\" colspan=\"3\"> ");
  if ( !strcmp((const char *)&v87, "dynamic") )
    v7 = "checked";
  else
    v7 = "";
  printf(
    "<input type=radio id=\"wan_type_id1\" name=\"wan_type\" class=\"navi_radio\" value=\"dynamic\" %s onclick=\"ShowWansetup('%s','dynamic')\"><label for=\"wan_type_id1\" style=\"display:inline-block; vertical-align:middle;\">",
    v7,
    &v96);
  v9 = sub_134F4(656, v8);
  printf("<span class=\"wansetup_main_span\" style=\"font-weight:700;\">%s</span></label></td></tr>\n", v9);
  puts("<tr class=\"wansetup_main_tr\" height=\"24\"><td class=\"wansetup_main_td\" colspan=\"3\"> ");
  if ( !strcmp((const char *)&v87, "pppoe") )
    v10 = "checked";
  else
    v10 = "";
  printf(
    "<input type=radio id=\"wan_type_id2\" name=\"wan_type\" class=\"navi_radio\" value=\"pppoe\" %s onclick=\"ShowWansetup('%s','pppoe')\"><label for=\"wan_type_id2\" style=\"display:inline-block; vertical-align:middle;\">",
    v10,
    &v96);
  v12 = sub_134F4(664, v11);
  printf("<span class=\"wansetup_main_span\" style=\"font-weight:700;\">%s</span></label></td></tr>", v12);
  strcpy((char *)&v88, "");
  strcpy((char *)&v89, "");
  puts("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"border-bottom:1px #CCC solid;\"><td class=\"wansetup_main_td\" colspan=\"3\"> ");
  if ( !strcmp((const char *)&v87, "static") )
    v13 = "checked";
  else
    v13 = "";
  printf(
    "<input type=radio id=\"wan_type_id3\" name=\"wan_type\" class=\"navi_radio\" value=\"static\" %s onclick=\"ShowWansetup('%s','static')\"><label for=\"wan_type_id3\" style=\"display:inline-block; vertical-align:middle;\">",
    v13,
    &v96);
  v15 = sub_134F4(666, v14);
  printf("<span class=\"wansetup_main_span\" style=\"font-weight:700;\">%s</span></label></td></tr>", v15);
  get_hwaddr_kernel(&v96, &v89);
  convert_mac(&v89);
  v16 = getenv("REMOTE_ADDR");
  get_internal_pc_hardware_address(v16, &v90);
  get_hwaddr_cloned(&v96, &v88);
  v17 = 1 - v88;
  if ( v88 > 1u )
    v17 = 0;
  v77 = v17;
  strcmp((const char *)&v87, "dynamic");
  printf("<tr id=\"dynamic\" class=\"wansetup_main_tr\" style=\"display:%s;\"><td colspan=\"3\">");
  printf("<table class=\"v3_table wansetup_main_table\" width=\"100%%\">");
  printf("<COL width=\"180\"><COL width=\"200\"><COL width=\"%%%%\">");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v19 = sub_134F4(216, v18);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v19);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  get_ifconfig(&v96, &v95, &v94);
  sub_1F698((int)"dynamicip", (int)&v95, 1, 1);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\">");
  if ( !get_dhclient_block_private_ip(&v96) )
    v5 = "checked";
  v21 = sub_134F4(651, v20);
  printf(
    "<input type=checkbox id=\"aprchkid\" class=\"navi_chk\" name=\"allow_private\" %s>\t\t<label for=\"aprchkid\"><span class=\"item_text wansetup_main_span\">%s</span></label>",
    v5,
    v21);
  printf("</td></tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  v23 = sub_134F4(907, v22);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v23);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_1F698((int)"dynamicsm", (int)&v94, 1, 1);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\"></td>");
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v25 = sub_134F4(345, v24);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v25);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  get_default_gateway(&v96, &v93);
  if ( !strncmp((const char *)&v93, "ppp", 3u) )
    sf_strncpy(&v93, &v95, 20);
  sub_1F698((int)"dynamicgw", (int)&v93, 1, 1);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\"></td>");
  printf("</tr>");
  get_dns_shadow(&v96, "dynamic", &v92, &v91);
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  v27 = sub_134F4(227, v26);
  printf("<td class=\"wansetup_main_td\"><span class=\"wansetup_main_p\">%s</span>\n", v27);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_1F698((int)&unk_67565, (int)&v92, 1, 0);
  puts((const char *)&unk_67572);
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v29 = sub_134F4(874, v28);
  printf("<td class=\"wansetup_main_td\"><span class=\"wansetup_main_p\">%s</span>\n", v29);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_1F698((int)"sdns_dynamic", (int)&v91, 1, 0);
  puts("</td>");
  puts("<td class=\"wansetup_main_td\">");
  get_manual_dns_flag(&v96, "dynamic");
  printf("<input type=checkbox name=\"dns_dynamic_chk\" class=navi_chk %s onclick=\"check_dns_dynamic();\" id=\"dns_dynamic_chkid\">\n");
  v31 = sub_134F4(637, v30);
  printf("<label for=\"dns_dynamic_chkid\"><span class=\"wansetup_main_span\">%s</span></label>\n", v31);
  puts("</td>");
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  sub_1F87C((int)"dynamic", (int)&v90, (const char *)&v89, v77);
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  sub_1F9DC("dynamic", v2, 1500);
  printf("</tr>");
  printf(
    "<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">\t\t<td class=\"wansetup_main_td\" colspan=\"3\"></td></tr>",
    "F7F7F7");
  printf("</table></td></tr>");
  read_pppoe_option(v2, &v78);
  strcmp((const char *)&v87, "pppoe");
  printf("<tr id=\"pppoe\" class=\"wansetup_main_tr\" style=\"display:%s;\"><td colspan=\"3\">");
  printf("<table class=\"v3_table wansetup_main_table\" width=\"100%%\">");
  printf("<COL width=\"180\"><COL width=\"200\"><COL width=\"%%%%\">");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v33 = sub_134F4(660, v32);
  printf("<td class=wansetup_main_td><span class=\"wansetup_main_p\">%s</span></td>", v33);
  printf(
    "<td class=wansetup_main_td><input class=navi_text type=text style=\"width:160px;\" name=\"userid\" maxlength=63 value=\"%s\"></td>\n",
    &v78);
  printf("<td class=wansetup_main_td></td>");
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  v35 = sub_134F4(663, v34);
  printf((const char *)&unk_67821, v35);
  printf("<td class=wansetup_main_td><input class=\"navi_text\" type=password style=\"width:160px;\" name=\"passwd\" \t\tid=\"passwd_passwd\" maxlength=63 value=\"");
  sub_11658(&v79);
  puts("\"><input class=\"navi_text\" type=text style=\"width:160px; display:none;\" id=\"passwd_text\" maxlength=63></td>");
  v37 = sub_134F4(1148, v36);
  printf(
    "<td class=wansetup_main_td><input type=\"checkbox\" id=\"passviewid\" name=\"passviewname\" onclick=\"clicked_passview(this.checked, 'passwd');\" value=\"1\">\t\t<label for=\"passviewid\">%s</label></td>",
    v37);
  printf("</tr>");
  printf(
    "<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">\t\t<td class=\"wansetup_main_td\" colspan=\"3\"></td></tr>",
    "FFFFFF");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  v39 = sub_134F4(216, v38);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v39);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  get_ifconfig(&v96, &v95, &v94);
  sub_1F698((int)"pppoeip", (int)&v95, 1, 1);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\"></td>");
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v41 = sub_134F4(907, v40);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v41);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_1F698((int)"pppoesm", (int)&v94, 1, 1);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\"></td>");
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  v43 = sub_134F4(345, v42);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v43);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  get_default_gateway(&v96, &v93);
  if ( !strncmp((const char *)&v93, "ppp", 3u) )
    sf_strncpy(&v93, &v95, 20);
  sub_1F698((int)"pppoegw", (int)&v93, 1, 1);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\"></td>");
  printf("</tr>");
  get_dns_shadow(&v96, "pppoe", &v92, &v91);
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v45 = sub_134F4(227, v44);
  printf("<td class=\"wansetup_main_td\"><span class=\"wansetup_main_p\">%s</span>\n", v45);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_1F698((int)&unk_67A3B, (int)&v92, 1, 0);
  puts((const char *)&unk_67572);
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  v47 = sub_134F4(874, v46);
  printf("<td class=\"wansetup_main_td\"><span class=\"wansetup_main_p\">%s</span>\n", v47);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_1F698((int)"sdns_pppoe", (int)&v91, 1, 0);
  puts("</td>");
  puts("<td class=\"wansetup_main_td\">");
  if ( get_manual_dns_flag(&v96, "pppoe") )
    v48 = "checked";
  else
    v48 = "";
  printf(
    "<input type=checkbox name=\"dns_pppoe_chk\" class=navi_chk %s onclick=\"check_dns_pppoe();\" id=\"dns_pppoe_chkid\">\n",
    v48);
  v50 = sub_134F4(637, v49);
  printf("<label for=\"dns_pppoe_chkid\"><span class=\"wansetup_main_span\">%s</span></label>\n", v50);
  puts("</td>");
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  sub_1F87C((int)"pppoe", (int)&v90, (const char *)&v89, v77);
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  sub_1F9DC("pppoe", v2, v83);
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  printf("<td class=\"wansetup_main_td\">");
  v52 = sub_134F4(476, v51);
  printf("<span class=\"wansetup_main_p\">%s</span>", v52);
  printf("</td>");
  printf("<td class=wansetup_main_td>");
  v54 = sub_134F4(475, v53);
  printf("<span class=\"wansetup_main_span\">%s</span>", v54);
  printf("<input class=\"navi_text\" type=text name=\"lcp_echo_interval\" size=3 maxlength=3 value=\"%d\" >", v81);
  v56 = sub_134F4(878, v55);
  printf("<span style=\"display:inline-block; vertical-align:middle; margin-right:5px;\">%s</span>", v56);
  v58 = sub_134F4(474, v57);
  printf("<span style=\"display:inline-block; vertical-align:middle; margin-left:5px;\">%s</span>", v58);
  printf("<input class=\"navi_text\" type=text name=\"lcp_echo_failure\" size=3 maxlength=3 value=\"%d\" >", v82);
  printf("</td>");
  printf("<td class=wansetup_main_td>");
  if ( v80 )
    v59 = "checked";
  else
    v59 = "";
  printf(
    "<input type=checkbox class=navi_chk id=\"lcpid\" name='lcp_flag' %s onclick=\"OnCheckEnableLCP()\" value=1>\n",
    v59);
  v61 = sub_134F4(731, v60);
  printf((const char *)&unk_67D4E, v61);
  printf("</td>");
  printf("</tr>");
  printf(
    "<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">\t\t<td class=\"wansetup_main_td\" colspan=\"3\"></td></tr>",
    "F7F7F7");
  printf("</table>");
  printf("</td></tr>");
  strcmp((const char *)&v87, "static");
  printf("<tr id=\"static\" class=\"wansetup_main_tr\" style=\"display:%s;\"><td colspan=\"3\">");
  printf("<table class=\"v3_table wansetup_main_table\" width=\"100%%\">");
  printf("<COL width=\"180\"><COL width=\"200\"><COL width=\"%%%%\">");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v63 = sub_134F4(216, v62);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v63);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  get_ifconfig(&v96, &v95, &v94);
  sub_1F698((int)"ip", (int)&v95, 1, 0);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\"></td>");
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  v65 = sub_134F4(907, v64);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v65);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_1F698((int)"sm", (int)&v94, 1, 0);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\"></td>");
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v67 = sub_134F4(345, v66);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v67);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  get_default_gateway(&v96, &v93);
  if ( !strncmp((const char *)&v93, "ppp", 3u) )
    sf_strncpy(&v93, &v95, 20);
  sub_1F698((int)"gw", (int)&v93, 1, 0);
  puts("</td>");
  printf("<td class=\"wansetup_main_td\"></td>");
  printf("</tr>");
  get_dns_shadow(&v96, "static", &v92, &v91);
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  v69 = sub_134F4(227, v68);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v69);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_1F698((int)&unk_67DE2, (int)&v92, 1, 0);
  puts((const char *)&unk_67572);
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  v71 = sub_134F4(874, v70);
  printf("<td class=\"wansetup_main_td\"><span class=\"item_text wansetup_main_p\">%s</span>\n", v71);
  printf("</td>");
  puts("<td class=\"wansetup_main_td\">");
  sub_1F698((int)"sdns_static", (int)&v91, 1, 0);
  puts((const char *)&unk_67572);
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "F7F7F7");
  sub_1F87C((int)"static", (int)&v90, (const char *)&v89, v77);
  printf("</tr>");
  printf("<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">", "FFFFFF");
  sub_1F9DC("static", v2, 1500);
  printf("</tr>");
  printf(
    "<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s;\">\t\t<td class=\"wansetup_main_td\" colspan=\"3\"></td></tr>",
    "F7F7F7");
  printf("</table></td></tr>");
  printf(
    "<tr class=\"wansetup_main_tr\" height=\"24\" style=\"background-color:#%s; border-bottom:1px #CCC solid;\">",
    "FFFFFF");
  v73 = sub_134F4(635, v72);
  printf("<td class=\"wansetup_main_td\"><span class=\"wansetup_main_p\" id=\"conntitle\">%s</span></td>", v73);
  printf("<td class=\"wansetup_main_td\" colspan=\"2\" height=\"24\">\t<div style=\"width:370px; display:inline-block; *display:inline; zoom:1; vertical-align:middle; margin:0; padding:0;\">\t<p id=\"connstatus\" style=\"width:370px; display:inline-block; *display:inline; zoom:1; vertical-align:middle; margin:0; padding:0;\"></p></div>");
  v75 = sub_134F4(28, v74);
  printf(
    "<div style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle; margin:0 0 0 10px; width:70px; padding:0;\">\t\t<input type=\"button\" class=\"bt\" id=\"appbtn\" value=\"%s\" onclick=\"apply_wansetup('%s','%s');\">\t\t<input type=\"button\" class=\"bt\" id=\"conbtn\" value=\"\" onclick=\"apply_connection('%s','%s');\" style=\"display:none;\"></div>\n",
    v75,
    v2,
    &v96,
    v2,
    &v96);
  printf("</td></tr>");
  puts("</form>");
  printf("<form method=\"post\" name=\"backup_wansetup\">");
  return printf("</form>");
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E96C: using guessed type int __fastcall get_wan_type(_DWORD, _DWORD);
// E984: using guessed type int __fastcall get_hwaddr_cloned(_DWORD, _DWORD);
// EA2C: using guessed type int __fastcall get_hwaddr_kernel(_DWORD, _DWORD);
// EB70: using guessed type int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD);
// ED44: using guessed type int __fastcall get_default_gateway(_DWORD, _DWORD);
// EE10: using guessed type int __fastcall convert_mac(_DWORD);
// EF60: using guessed type int __fastcall check_valid_account(_DWORD);
// F0F8: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// F1B8: using guessed type int __fastcall get_manual_dns_flag(_DWORD, _DWORD);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F530: using guessed type int __fastcall get_dhclient_block_private_ip(_DWORD);
// F728: using guessed type int __fastcall read_pppoe_option(_DWORD, _DWORD);
// F914: using guessed type int __fastcall get_dns_shadow(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00020A4C) --------------------------------------------------------
int __fastcall sub_20A4C(int a1)
{
  int v1; // r5@1
  int v2; // r1@3
  int v3; // r0@3
  int v4; // r1@3
  int v5; // r0@3
  int v6; // r0@3
  int v7; // r0@4
  int v8; // r0@4
  int v9; // r0@7
  int v10; // r0@7
  int v11; // r0@10
  _UNKNOWN *v12; // r0@12
  int v14; // [sp+0h] [bp-38h]@3
  char dest; // [sp+14h] [bp-24h]@1

  v1 = a1;
  strcpy(&dest, "");
  if ( !get_value(v1, "wan", &dest, 20) )
    strcpy(&dest, "wan1");
  puts("<script language=JavaScript>");
  puts("<!--");
  puts("function CheckNetworkConfig()");
  puts("{");
  get_netaddr("br0", &v14);
  printf("\tif(GetNetworkAddress('ip','sm')==\"%s\")\n", &v14);
  v3 = sub_134F4(659, v2);
  printf((const char *)&unk_681C2, v3);
  printf("\telse if(GetNetworkAddress('gw','sm')==\"%s\")\n", &v14);
  v5 = sub_134F4(658, v4);
  printf((const char *)&unk_681C2, v5);
  puts(" \telse");
  puts("\t{");
  puts("\t\treturn 1;");
  puts("\t}");
  puts("\treturn 0;");
  puts("}");
  puts("-->");
  puts("</script>");
  puts("<style type=\"text/css\">");
  puts(".wansetup_main_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".wansetup_main_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".wansetup_main_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".wansetup_main_p {");
  puts("\tpadding-left:5px; display:inline-block;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".wansetup_main_span {");
  puts("\tdisplay:inline-block; vertical-align:middle;");
  puts("}");
  puts(".wansetup_main_button {");
  puts("\tpadding:0 1 0 1; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".wansetup_main_td input[type=checkbox], .wansetup_main_td input[type=radio] {");
  puts("display:inline-block; vertical-align:middle;");
  puts("}");
  printf("input[type=\"text\"] {border:1px #CCC solid;}");
  printf("input[type=\"password\"] {border:1px #CCC solid;}");
  printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td {cursor:default;}");
  v6 = printf("</style>");
  if ( is_mobile_agent(v6) )
  {
    sub_12790((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v7 = printf("<iframe name=\"hiddenwansetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenwansetup\" \t\t\tframeborder=no width=0 height=0 align=center scrolling=no></iframe>");
    v8 = sub_12770(v7);
  }
  else
  {
    v8 = printf("<iframe name=\"hiddenwansetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenwansetup\" \t\t\tframeborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  if ( is_mobile_agent(v8) )
  {
    sub_12790((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v9 = printf(
           "<iframe name=\"hiddenwanstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenwanstatus&wan=%s\" \t\t\tframeborder=no width=0 height=0 align=center scrolling=no></iframe>",
           &dest);
    v10 = sub_12770(v9);
  }
  else
  {
    v10 = printf(
            "<iframe name=\"hiddenwanstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenwanstatus&wan=%s\" \t\t\tframeborder=no width=0 height=0 align=center scrolling=no></iframe>",
            &dest);
  }
  if ( is_mobile_agent(v10) )
  {
    sub_12790((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v11 = printf("<iframe name=\"hiddenmacsearch_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=netconfmacsearch\" \t\t\tframeborder=no width=0 height=0 align=center scrolling=no></iframe>");
    sub_12770(v11);
  }
  else
  {
    printf("<iframe name=\"hiddenmacsearch_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=netconfmacsearch\" \t\t\tframeborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  printf("<table class=\"v3_table wansetup_main_table\" width=\"100%%\">\n");
  sub_1FB50(v1, (int)&dest);
  sub_1F610((int)&dest);
  printf("</table>");
  printf("<script>");
  puts("init_checkform();");
  printf("</script>");
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v12 = sub_126C4();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v12);
  printf("</SPAN></td>");
  printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"wansetup_div_msg\">\n");
  printf("</SPAN></td>");
  printf((const char *)&unk_60F0E);
  printf("<DIV id=\"%s\" style=\"display:none;\">", "macsearch_mask");
  printf(
    "<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\" \t\tonclick=\"UnMaskIt(document,'%s');\">\n",
    "macsearch_mask");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:151px; top:128px; width:340px; height:210px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888; overflow:hidden;\" id=\"searchmaclist\">");
  return printf((const char *)&unk_60F1B);
}
// EEC4: using guessed type int __fastcall get_netaddr(_DWORD, _DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// F74C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (00020EC4) --------------------------------------------------------
int __fastcall sub_20EC4(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r7@3
  int v4; // r6@3
  void *v5; // r8@3
  void *v6; // r5@3
  int v7; // r10@3
  int v8; // r1@6
  int v9; // r0@6
  int v10; // r1@6
  int v11; // r0@6
  int v12; // r1@14
  int v13; // r0@14
  int v15; // [sp+0h] [bp-40h]@2
  char v16; // [sp+10h] [bp-30h]@1

  v2 = a2;
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"netconf_macsearchiframe\">");
  printf("<input type=\"hidden\" name=\"tmenu\" value=\"iframe\">");
  printf("<input type=\"hidden\" name=\"smenu\" value=\"netconfmacsearch\">");
  printf("<input type=\"hidden\" name=\"inputprefix\" value=\"\">");
  printf("<input type=\"hidden\" name=\"act\" value=\"\">");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  if ( get_value_post(v2, "act", &v16, 16) && get_value_post(v2, "inputprefix", &v15, 16) )
  {
    puts("function MakeMacAddrTable()");
    puts("{");
    puts("var obj = parent.document.getElementById('searchmaclist');");
    puts("var HTMLStr = '<div style=\\\"display:block; width:340px; height:24px;\\\">\t\t\t<table class=\\\"wansetup_main_table\\\" style=\\\"width:340px; height:24px;\\\">';");
    v3 = 0;
    v4 = 0;
    v5 = malloc(0xBC00u);
    memset(v5, 0, 0xBC00u);
    v6 = v5;
    v7 = get_hostinfo_from_arp("br0", 256, v5);
    while ( v3 < v7 )
    {
      if ( strcmp((const char *)v6 + 148, "00:00:00:00:00:00") )
      {
        convert_mac((char *)v6 + 148);
        if ( !v4 )
        {
          printf("HTMLStr += '<tr class=\\\"wansetup_main_tr\\\" height=\\\"24\\\">';");
          v9 = sub_134F4(783, v8);
          printf(
            "HTMLStr += '<td class=\\\"wansetup_main_td\\\" \t\t\t\t\tstyle=\\\"width:169px; background-color:#EEEEEE; border:1px #ccc solid;\\\">\t\t\t\t\t<span class=\\\"wansetup_main_span\\\" style=\\\"text-align:center; width:100%%;\\\">%s</span></td>';",
            v9);
          v11 = sub_134F4(782, v10);
          printf(
            "HTMLStr += '<td class=\\\"wansetup_main_td\\\" \t\t\t\t\tstyle=\\\"width:169px; background-color:#EEEEEE; border:1px #ccc solid;\\\">\t\t\t\t\t<span class=\\\"wansetup_main_span\\\" style=\\\"text-align:center; width:100%%;\\\">%s</span></td>';",
            v11);
          printf("HTMLStr += '</tr>';");
          printf("HTMLStr += '</table></div><div \t\t\tstyle=\\\"display:block; width:340px; max-height:186px; height:186px; overflow:auto; overflow-x:hidden; -ms-overflow-x:hidden;\\\">\t\t\t\t\t<table class=\\\"wansetup_main_table\\\" style=\\\"width:340px;\\\">';");
        }
        printf(
          "HTMLStr += '<tr class=\\\"wansetup_main_tr\\\" height=\\\"24\\\" style=\"cursor:pointer;\"\t\t\t\tonclick=\\\"SelectMacFromPopup(\\'%s\\', \\'%s\\');\\\" onmouseover=\\\"ChangeToOverColor(this);\\\" onmouseout=\\\"ChangeToOutColor(this);\\\">';",
          &v15,
          (char *)v6 + 148);
        printf(
          "HTMLStr += '<td class=\\\"wansetup_main_td\\\" style=\\\"border:1px #ccc solid;\\\">\t\t\t\t<span class=\\\"wansetup_main_span\\\" style=\\\"margin-left:5px; min-width:163px;\\\">%s</a></td>';",
          (char *)v6 + 148);
        if ( *(_BYTE *)v6 )
          printf(
            "HTMLStr += '<td class=\\\"wansetup_main_td\\\" style=\\\"border:1px #ccc solid;\\\">\t\t\t\t\t<span class=\\\"wansetup_main_span\\\" style=\\\"margin-left:5px; min-width:163px;\\\">%s(%s)</span></td>';",
            (char *)v6 + 128,
            v6);
        else
          printf(
            "HTMLStr += '<td class=\\\"wansetup_main_td\\\" style=\\\"border:1px #ccc solid;\\\">\t\t\t\t\t<span class=\\\"wansetup_main_span\\\" style=\\\"margin-left:5px; min-width:163px;\\\">%s</span></td>';",
            (char *)v6 + 128,
            v6);
        ++v4;
        printf("HTMLStr += '</tr>';");
      }
      ++v3;
      v6 = (char *)v6 + 188;
    }
    if ( !v4 )
    {
      printf("HTMLStr += '<tr class=\\\"wansetup_main_tr\\\" height=\\\"24\\\">';", "00:00:00:00:00:00");
      v13 = sub_134F4(784, v12);
      printf(
        "HTMLStr += '<td class=\\\"wansetup_main_td\\\" colspan=\\\"2\\\" style=\\\"background-color:#EEEEEE;\\\">\t\t\t\t<span class=\\\"wansetup_main_span\\\">%s</span></td>';",
        v13);
      printf("HTMLStr += '</tr>';");
    }
    free(v5);
    puts("HTMLStr += '</table></div>';");
    puts("obj.innerHTML = HTMLStr;");
    puts("}");
    printf("MakeMacAddrTable();");
  }
  return printf("</script>");
}
// EA20: using guessed type int __fastcall get_hostinfo_from_arp(_DWORD, _DWORD, _DWORD);
// EE10: using guessed type int __fastcall convert_mac(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00021164) --------------------------------------------------------
int __fastcall sub_21164(int a1)
{
  int v1; // r4@1
  int result; // r0@1
  int v3; // r0@2
  const char *v4; // r1@2
  int v5; // r0@8
  char v6; // [sp+Ch] [bp-18Ch]@5
  char dest; // [sp+10Ch] [bp-8Ch]@4
  char v8; // [sp+14Ch] [bp-4Ch]@1
  char v9; // [sp+16Ch] [bp-2Ch]@2

  v1 = a1;
  result = get_value_post(a1, "act", &v8, 32);
  if ( result )
  {
    get_value_post(v1, "wan", &v9, 20);
    v3 = strcmp(&v9, "wan2");
    v4 = "eth3";
    if ( v3 )
      v4 = "eth1";
    strcpy(&dest, v4);
    if ( !strcmp(&v8, "connect") )
    {
      set_wansetup_status(&v9, 1);
      snprintf2(&v6, 256, "%s(%s)", "@{40}", &v9);
      syslog_msg(1, &v6);
      stop_wan(&v9);
    }
    else if ( !strcmp(&v8, "disconnect") )
    {
      snprintf2(&v6, 256, "%s(%s)", "@{41}", &v9);
      syslog_msg(1, &v6);
      set_wansetup_status(&v9, 0);
      stop_wan(&v9);
      set_ifconfig(&dest);
    }
    v5 = istatus_remove_status_tag("lanwan_samenetwork");
    result = signal_update(v5);
  }
  return result;
}
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F3D4: using guessed type int __fastcall stop_wan(_DWORD);
// F470: using guessed type int syslog_msg(_DWORD, const char *, ...);
// FA10: using guessed type int __fastcall set_wansetup_status(_DWORD, _DWORD);
// FC8C: using guessed type int __fastcall set_ifconfig(_DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);
// FE60: using guessed type int __fastcall istatus_remove_status_tag(_DWORD);

//----- (000212C4) --------------------------------------------------------
int __fastcall sub_212C4(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r8@1
  int result; // r0@2
  int v5; // r1@6
  int v6; // r0@7
  int v7; // r0@12
  char *v8; // r4@15
  int v9; // r0@16
  char *v10; // r6@24
  int v11; // r1@24
  int v12; // r0@24
  int v13; // r5@24
  int v14; // r1@24
  int v15; // r0@25
  int v16; // r1@29
  char *v17; // r0@29
  int v18; // r1@33
  int v19; // r0@33
  int v20; // r1@37
  int v21; // r0@38
  int v22; // r1@40
  __int16 *v23; // r0@40
  int v24; // r1@42
  int v25; // r0@43
  __int16 v26; // [sp+2h] [bp-336h]@4
  __int16 v27; // [sp+202h] [bp-136h]@34
  __int16 v28; // [sp+242h] [bp-F6h]@37
  __int16 v29; // [sp+262h] [bp-D6h]@36
  __int16 v30; // [sp+282h] [bp-B6h]@2
  __int16 v31; // [sp+2A2h] [bp-96h]@36
  __int16 v32; // [sp+2B6h] [bp-82h]@36
  __int16 v33; // [sp+2CAh] [bp-6Eh]@4
  __int16 v34; // [sp+2DEh] [bp-5Ah]@4
  char v35; // [sp+2F2h] [bp-46h]@4
  __int16 v36; // [sp+306h] [bp-32h]@4
  __int16 v37; // [sp+316h] [bp-22h]@4

  v2 = a2;
  v3 = get_pvalue(a1, "wan");
  if ( !v3 )
  {
    result = get_value_post(v2, "wan", &v30, 32);
    if ( !result )
      return result;
    v3 = (int)&v30;
  }
  get_wan_type(v3, &v36);
  get_wan_hw_ifname(v3, &v37);
  memset(&v26, 0, 0x200u);
  get_wan_ipinfo(v3, &v35, &v34, &v33);
  if ( !strcmp((const char *)&v36, "pppoe") )
    sf_strncpy(&v33, &v35, 20);
  if ( !get_wansetup_status(v3) )
  {
    v6 = 393;
LABEL_30:
    v16 = sub_134F4(v6, v5);
    v17 = (char *)&v26;
    goto LABEL_31;
  }
  if ( !strcmp((const char *)&v36, "pppoe") || !strcmp((const char *)&v36, "pptp") )
  {
    if ( get_idle_timeout(&v37) || !get_wansetup_status(v3) )
    {
      v6 = 1047;
      goto LABEL_30;
    }
    v7 = get_pppoe_status(v3);
    if ( !v7 )
    {
      v6 = 390;
      goto LABEL_30;
    }
    if ( v7 == 4 )
    {
      v8 = (char *)&v26;
      if ( !v35 )
      {
        v9 = 1044;
LABEL_29:
        v16 = sub_134F4(v9, v5);
        v17 = v8;
LABEL_31:
        strcat(v17, (const char *)v16);
        goto LABEL_32;
      }
LABEL_23:
      v9 = 1045;
      goto LABEL_29;
    }
    if ( v7 == 6 )
    {
      v6 = 1048;
      goto LABEL_30;
    }
  }
  else
  {
    v8 = (char *)&v26;
    if ( v35 )
      goto LABEL_23;
    v10 = (char *)&v26 + strlen((const char *)&v26);
    v12 = sub_134F4(1049, v11);
    v13 = sprintf(v10, (const char *)v12);
    if ( istatus_get_intvalue_direct("lanwan_samenetwork") == 1 )
    {
      v15 = sub_134F4(732, v14);
      sprintf(&v10[v13], (const char *)v15, "JavaScript:MovePagetoMain(\\'netconf\\',\\'lansetup\\');");
      goto LABEL_32;
    }
    if ( istatus_get_intvalue_direct("privateip") == 1 && get_dhclient_block_private_ip(&v37) )
    {
      v9 = 1052;
      goto LABEL_29;
    }
  }
LABEL_32:
  if ( !get_wan_link(v3) )
  {
    strcpy((char *)&v26, "");
    v19 = sub_134F4(120, v18);
    strcat((char *)&v26, (const char *)v19);
  }
  memset(&v27, 0, 0x40u);
  if ( get_idle_timeout(&v37) || !get_wansetup_status(v3) )
  {
    if ( strcmp((const char *)&v36, "static") )
    {
      sf_strncpy(&v28, "connect", 32);
      if ( !strcmp((const char *)&v36, "dynamic") )
        v25 = 655;
      else
        v25 = 1053;
      v22 = sub_134F4(v25, v24);
      v23 = &v27;
      goto LABEL_46;
    }
  }
  else
  {
    get_dns_shadow(&v37, &v36, &v32, &v31);
    get_hwaddr_kernel(&v37, &v29);
    convert_mac(&v29);
    if ( strcmp((const char *)&v36, "static") )
    {
      sf_strncpy(&v28, "disconnect", 32);
      if ( !strcmp((const char *)&v36, "dynamic") )
        v21 = 654;
      else
        v21 = 1046;
      v22 = sub_134F4(v21, v20);
      v23 = &v27;
LABEL_46:
      sf_strncpy(v23, v22, 64);
      goto LABEL_47;
    }
  }
LABEL_47:
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"waninfostatus_fm\">");
  printf("<input type=\"hidden\" name=\"tmenu\" value=\"iframe\">");
  printf("<input type=\"hidden\" name=\"smenu\" value=\"hiddenwanstatus\">");
  printf("<input type=\"hidden\" name=\"wan\" value=\"%s\">", v3);
  printf("<input type=\"hidden\" name=\"wan_type\" value=\"%s\">", &v36);
  printf("<input type=\"hidden\" name=\"fdns\" value=\"%s\">", &v32);
  printf("<input type=\"hidden\" name=\"sdns\" value=\"%s\">", &v31);
  printf("<input type=\"hidden\" name=\"ip\" value=\"%s\">", &v35);
  printf("<input type=\"hidden\" name=\"sm\" value=\"%s\">", &v34);
  printf("<input type=\"hidden\" name=\"gw\" value=\"%s\">", &v33);
  printf("<input type=\"hidden\" name=\"buttonact\" value=\"%s\">", &v28);
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  printf("parent.document.getElementById('connstatus').innerHTML = '%s';\n", &v26);
  printf("parent.document.getElementById('conbtn').value = '%s';\n", &v27);
  puts("EnableObj(parent.document.getElementById('conbtn'));");
  puts("if(parent.window.footerbtn_view_control)\tparent.window.footerbtn_view_control(parent.document);");
  puts("if(parent.window.update_addrs)\t\t\tparent.window.update_addrs(document, parent.document);");
  puts("setTimeout(function(){document.waninfostatus_fm.submit(); \t\tif(parent.window.submitted){parent.window.submitted = false; UnMaskIt(parent.document,'apply_mask');}},3000);");
  return printf("</script>");
}
// E858: using guessed type int __fastcall get_wansetup_status(_DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E96C: using guessed type int __fastcall get_wan_type(_DWORD, _DWORD);
// EA2C: using guessed type int __fastcall get_hwaddr_kernel(_DWORD, _DWORD);
// EE10: using guessed type int __fastcall convert_mac(_DWORD);
// EEAC: using guessed type int __fastcall get_idle_timeout(_DWORD);
// F008: using guessed type int __fastcall get_wan_link(_DWORD);
// F0EC: using guessed type int __fastcall istatus_get_intvalue_direct(_DWORD);
// F0F8: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// F104: using guessed type int __fastcall get_wan_ipinfo(_DWORD, _DWORD, _DWORD, _DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F530: using guessed type int __fastcall get_dhclient_block_private_ip(_DWORD);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);
// F914: using guessed type int __fastcall get_dns_shadow(_DWORD, _DWORD, _DWORD, _DWORD);
// FE00: using guessed type int __fastcall get_pppoe_status(_DWORD);

//----- (00021820) --------------------------------------------------------
int __fastcall sub_21820(int a1, const char *a2, int a3)
{
  const char *v3; // r5@1
  int v4; // r7@1
  int v5; // r6@1
  char v7; // [sp+4h] [bp-17Ch]@2
  char v8; // [sp+84h] [bp-FCh]@2
  char v9; // [sp+104h] [bp-7Ch]@2
  char v10; // [sp+124h] [bp-5Ch]@7
  char s2; // [sp+138h] [bp-48h]@2
  char dest; // [sp+14Ch] [bp-34h]@4

  v3 = a2;
  v4 = a1;
  v5 = a3;
  if ( !strcmp(a2, "eth1") )
  {
    snprintf2(&v8, 128, "hw_conf_%s", v5);
    snprintf2(&v7, 128, "hw_%s", v5);
    get_hwaddr_kernel(v3, &s2);
    if ( get_value_post(v4, &v8, &v9, 32) && !strcmp(&v9, "on") )
    {
      strcpy(&dest, "");
      get_hw_value_post(v4, &v7, &dest);
      if ( !check_invalid_hwaddr(&dest) && strcmp(&dest, &s2) )
      {
        set_hwaddr_kernel(v3, &dest, 1);
        set_hwaddr_cloned(v3, &dest);
      }
    }
    else
    {
      get_hwaddr_org(v3, &v10);
      set_hwaddr_cloned(v3, 0);
      if ( strcmp(&v10, &s2) )
        set_hwaddr_kernel(v3, &v10, 1);
    }
  }
  return 0;
}
// EA2C: using guessed type int __fastcall get_hwaddr_kernel(_DWORD, _DWORD);
// EA50: using guessed type int __fastcall get_hwaddr_org(_DWORD, _DWORD);
// EC48: using guessed type int __fastcall set_hwaddr_cloned(_DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// F050: using guessed type int __fastcall check_invalid_hwaddr(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F50C: using guessed type int __fastcall set_hwaddr_kernel(_DWORD, _DWORD, _DWORD);
// F7DC: using guessed type int __fastcall get_hw_value_post(_DWORD, _DWORD, _DWORD);

//----- (00021980) --------------------------------------------------------
int __fastcall sub_21980(int a1, int a2, const char *a3)
{
  int v3; // r9@1
  const char *v4; // r4@1
  int v5; // r6@1
  int v6; // r5@1
  char v8; // [sp+Ch] [bp-1C4h]@4
  char v9; // [sp+8Ch] [bp-144h]@4
  char v10; // [sp+10Ch] [bp-C4h]@3
  char v11; // [sp+14Ch] [bp-84h]@4
  char v12; // [sp+18Ch] [bp-44h]@4
  int v13; // [sp+1ACh] [bp-24h]@9

  v3 = a1;
  v4 = a3;
  v5 = a2;
  v6 = hwinfo_get_mtu(a3);
  if ( !strcmp(v4, "pppoe") || !strcmp(v4, "pptp") )
    get_pppoe_ifname(v5, &v10);
  get_wan_hw_ifname(v5, &v11);
  snprintf2(&v9, 128, "mtu.%s.%s", v4, &v11);
  snprintf2(&v8, 128, "mtu.%s.%s.check", v4, &v11);
  if ( get_value_post(v3, &v8, &v12, 32) && !strcmp(&v12, "on") )
  {
    if ( get_intvalue_post(v3, &v9, &v13) )
    {
      iconfig_set_intvalue_direct(&v8, 1);
      v6 = get_mtu_value(&v11, 1);
      if ( v6 != v13 )
      {
        iconfig_set_intvalue_direct(&v9, v13);
        if ( strcmp(v4, "pppoe") && strcmp(v4, "pptp") )
          set_mtu_value(&v11, v13);
        v6 = v13;
      }
    }
  }
  else
  {
    iconfig_set_intvalue_direct(&v8, 0);
    if ( strcmp(v4, "pppoe") && strcmp(v4, "pptp") )
      set_mtu_value(&v11, v6);
  }
  return v6;
}
// E8A0: using guessed type int __fastcall get_intvalue_post(_DWORD, _DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EED0: using guessed type int __fastcall hwinfo_get_mtu(_DWORD);
// F0F8: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// F1DC: using guessed type int __fastcall get_pppoe_ifname(_DWORD, _DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F2C0: using guessed type int __fastcall set_mtu_value(_DWORD, _DWORD);
// F7C4: using guessed type int __fastcall get_mtu_value(_DWORD, _DWORD);
// FAC4: using guessed type int __fastcall iconfig_set_intvalue_direct(_DWORD, _DWORD);

//----- (00021B34) --------------------------------------------------------
int __fastcall sub_21B34(int a1)
{
  int v1; // r8@1
  int result; // r0@1
  const char *v3; // r0@3
  int v4; // r0@12
  int v5; // r1@15
  __int16 *v6; // r0@16
  int v7; // r0@31
  int v8; // r0@33
  int v9; // r0@33
  int v10; // r0@36
  int v11; // r0@36
  int v12; // r0@36
  int v13; // [sp+8h] [bp+0h]@1
  char v14; // [sp+208h] [bp+200h]@22
  char v15; // [sp+288h] [bp+280h]@24
  int v16; // [sp+330h] [bp+328h]@24
  char v17; // [sp+334h] [bp+32Ch]@26
  char v18; // [sp+338h] [bp+330h]@26
  int v19; // [sp+340h] [bp+338h]@24
  __int16 v20; // [sp+346h] [bp+33Eh]@28
  __int16 v21; // [sp+3C6h] [bp+3BEh]@4
  __int16 v22; // [sp+406h] [bp+3FEh]@28
  __int16 v23; // [sp+426h] [bp+41Eh]@28
  __int16 v24; // [sp+446h] [bp+43Eh]@28
  __int16 v25; // [sp+466h] [bp+45Eh]@33
  __int16 v26; // [sp+47Ah] [bp+472h]@33
  __int16 v27; // [sp+48Eh] [bp+486h]@6
  __int16 v28; // [sp+4A2h] [bp+49Ah]@6
  __int16 v29; // [sp+4B6h] [bp+4AEh]@6
  __int16 v30; // [sp+4CAh] [bp+4C2h]@2
  __int16 v31; // [sp+4DEh] [bp+4D6h]@4

  v1 = a1;
  result = get_value_post(a1, "act", &v13, 512);
  if ( result )
  {
    if ( !get_value_post(v1, "wan", &v30, 20) )
    {
      v3 = "No WAN name is specified. Debug it..";
      return puts(v3);
    }
    get_wan_hw_ifname(&v30, &v31);
    set_wansetup_status(&v30, 1);
    result = get_value_post(v1, "wan_type", &v21, 64);
    if ( !result )
      return result;
    signal_toggle(result);
    stop_wan(&v30);
    set_wan_type(&v30, &v21);
    if ( !strcmp((const char *)&v21, "static") )
    {
      strcpy((char *)&v29, "");
      get_ip_value_post(v1, "ip", &v29);
      strcpy((char *)&v28, "");
      get_ip_value_post(v1, "sm", &v28);
      strcpy((char *)&v27, "");
      get_ip_value_post(v1, "gw", &v27);
      set_wan_ipconfig(&v31, &v29, &v28, &v27);
      sub_21820(v1, (const char *)&v31, (int)&v21);
      set_ifconfig(&v31);
      if ( !sysconf_nat_get(1) )
        make_virtual_host_page(&v29);
      if ( check_default_gateway(&v27, &v29, &v28) )
      {
        set_default_gateway(&v31, 0);
      }
      else
      {
        set_default_gateway("br0", 0);
        if ( set_default_gateway(&v31, &v27) )
          set_default_gateway2(&v31, &v29, &v28, &v27);
      }
      v4 = sub_21980(v1, (int)&v30, (const char *)&v21);
      signal_wan(v4);
    }
    else if ( !strcmp((const char *)&v21, "dynamic") )
    {
      set_ifconfig(&v31);
      set_wan_ipconfig(&v31, "0.0.0.0", "255.255.255.0", 0);
      if ( !get_value_post(v1, "allow_private", &v13, 512) || (v5 = strcmp((const char *)&v13, "on")) != 0 )
      {
        v6 = &v31;
        v5 = 1;
      }
      else
      {
        v6 = &v31;
      }
      set_dhclient_block_private_ip(v6, v5);
      set_dhcp_auto_restart(&v31, 1);
      sub_21820(v1, (const char *)&v31, (int)&v21);
      sub_21980(v1, (int)&v30, (const char *)&v21);
    }
    else if ( !strcmp((const char *)&v21, "pppoe") )
    {
      if ( get_pppoe_status(&v30) == 7 )
        set_pppoe_status(&v30, 0);
      set_ifconfig(&v31);
      set_wan_ipconfig(&v31, "0.0.0.0", "255.255.255.0", 0);
      read_pppoe_option(&v30, &v14);
      get_value_post(v1, "userid", &v14, 128);
      if ( check_unpermitted_chars(&v14) )
        strcpy(&v14, "");
      get_value_post(v1, "passwd", &v15, 128);
      sub_21820(v1, (const char *)&v31, (int)&v21);
      v19 = sub_21980(v1, (int)&v30, (const char *)&v21);
      if ( get_intvalue_post(v1, "lcp_flag", &v16) )
      {
        get_intvalue_post(v1, "lcp_echo_interval", &v17);
        get_intvalue_post(v1, "lcp_echo_failure", &v18);
      }
      else
      {
        v16 = 0;
      }
      save_pppoe_option(&v30, &v14);
    }
    snprintf2(&v20, 128, "dns_%s_chk", &v21);
    snprintf2(&v23, 32, "fdns_%s", &v21);
    snprintf2(&v22, 32, "sdns_%s", &v21);
    if ( get_value_post(v1, &v20, &v24, 32) && !strcmp((const char *)&v24, "on")
      || !strcmp((const char *)&v21, "static") )
    {
      v7 = strcmp((const char *)&v21, "static");
      if ( v7 && !check_valid_account(v7) )
        goto LABEL_36;
      strcpy((char *)&v26, "");
      strcpy((char *)&v25, "");
      get_ip_value_post(v1, &v23, &v26);
      get_ip_value_post(v1, &v22, &v25);
      set_autodns(0);
      dhcpd_set_dns(&v26, &v25);
      set_manual_dns_flag(&v31, &v21, 1);
      v8 = set_dns_shadow(&v31, &v21, &v26, &v25);
      v9 = get_remote_addr(v8);
      syslog_msg(1, "@{57}", v9, &v26, &v25);
    }
    else
    {
      set_autodns(1);
      set_manual_dns_flag(&v31, &v21, 0);
    }
    set_system_dns(&v30);
LABEL_36:
    v10 = istatus_remove_status_tag("lanwan_samenetwork");
    v11 = signal_toggle(v10);
    v12 = signal_update(v11);
    signal_save(v12);
    puts("<script language=JavaScript>");
    v3 = "</script>";
    return puts(v3);
  }
  return result;
}
// E7F8: using guessed type int __fastcall get_remote_addr(_DWORD);
// E804: using guessed type int __fastcall set_dhclient_block_private_ip(_DWORD, _DWORD);
// E810: using guessed type int __fastcall dhcpd_set_dns(_DWORD, _DWORD);
// E840: using guessed type int __fastcall set_autodns(_DWORD);
// E8A0: using guessed type int __fastcall get_intvalue_post(_DWORD, _DWORD, _DWORD);
// E8B8: using guessed type int __fastcall make_virtual_host_page(_DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EAB0: using guessed type int __fastcall set_dns_shadow(_DWORD, _DWORD, _DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EF60: using guessed type int __fastcall check_valid_account(_DWORD);
// F0B0: using guessed type int __fastcall set_default_gateway2(_DWORD, _DWORD, _DWORD, _DWORD);
// F0F8: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// F11C: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// F1F4: using guessed type int __fastcall signal_wan(_DWORD);
// F218: using guessed type int __fastcall set_wan_type(_DWORD, _DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F338: using guessed type int __fastcall set_pppoe_status(_DWORD, _DWORD);
// F3D4: using guessed type int __fastcall stop_wan(_DWORD);
// F470: using guessed type int syslog_msg(_DWORD, const char *, ...);
// F494: using guessed type int __fastcall sysconf_nat_get(_DWORD);
// F62C: using guessed type int __fastcall set_system_dns(_DWORD);
// F728: using guessed type int __fastcall read_pppoe_option(_DWORD, _DWORD);
// F9EC: using guessed type int __fastcall set_wan_ipconfig(_DWORD, _DWORD, _DWORD, _DWORD);
// FA10: using guessed type int __fastcall set_wansetup_status(_DWORD, _DWORD);
// FB3C: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// FC44: using guessed type int __fastcall signal_toggle(_DWORD);
// FC8C: using guessed type int __fastcall set_ifconfig(_DWORD);
// FCD4: using guessed type int __fastcall set_default_gateway(_DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);
// FD4C: using guessed type int __fastcall set_dhcp_auto_restart(_DWORD, _DWORD);
// FD88: using guessed type int __fastcall check_default_gateway(_DWORD, _DWORD, _DWORD);
// FDA0: using guessed type int __fastcall save_pppoe_option(_DWORD, _DWORD);
// FE00: using guessed type int __fastcall get_pppoe_status(_DWORD);
// FE30: using guessed type int __fastcall set_manual_dns_flag(_DWORD, _DWORD, _DWORD);
// FE60: using guessed type int __fastcall istatus_remove_status_tag(_DWORD);

//----- (0002218C) --------------------------------------------------------
int __fastcall sub_2218C(int a1, int a2)
{
  int v2; // r4@1
  char v4; // [sp+0h] [bp-30h]@1

  v2 = a2;
  memset(&v4, 0, 0x20u);
  if ( get_value_post(v2, "act", &v4, 32) )
  {
    if ( !strcmp(&v4, "connect") || !strcmp(&v4, "disconnect") )
      sub_21164(v2);
    else
      sub_21B34(v2);
  }
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"netconf_wansetup\">");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  if ( v4 )
    printf("parent.window.submitted = true;");
  return printf("</script>");
}
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00022278) --------------------------------------------------------
int sub_22278()
{
  int v0; // r4@1

  printf("<style>");
  printf("body { margin: 0; }");
  printf("form { margin: 0; }");
  printf("tr { height: 24px; }");
  printf(".selected { background-color: #CCCCFF !important; }");
  printf(".highlight { background-color: #E8E8E8 !important; }");
  printf(".highlight_selected { background-color: #BBBBFF !important; }");
  printf("</style>");
  sub_133E4((int)"sysconf", (int)"syslog");
  printf((const char *)&unk_6966E);
  printf("<table cellspacing=0px cellpadding=0px style='width:100%%;'>\n");
  v0 = 0;
  do
  {
    ++v0;
    printf("<tr style='background-color:%s;'><td colspan=2><p name=blanktr>&nbsp;</p></td></tr>");
  }
  while ( v0 != 14 );
  printf("</table>");
  return printf("<iframe name=\"sysconf_syslog_log_status\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_syslog_log_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (00022358) --------------------------------------------------------
int sub_22358()
{
  int v0; // r1@1
  int v1; // r0@1

  printf("<tr style='background-color: #EEE; height: 24px;'><td>");
  v1 = sub_134F4(1005, v0);
  printf("<b style='padding-left: 5px;'>%s</b>", v1);
  printf("</td></tr>");
  printf("<tr style='border-top: 1px solid #CCC;'><td>");
  printf("<iframe name=\"sysconf_syslog_setup\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_syslog_setup\" frameborder=no style='width:100%%; height:120px;'></iframe>");
  return printf("</td></tr>");
}

//----- (000223B8) --------------------------------------------------------
int sub_223B8()
{
  printf("<style>");
  printf("body { margin: 0; background-color: #EEE; }");
  printf("form { margin: 0; }");
  printf("tr { height: 24px; }");
  printf("</style>");
  sub_133E4((int)"sysconf", (int)"syslog");
  puts("<form method=post action=timepro.cgi name=syslog_fm>");
  printf("<table id='sysconf_syslog_setup_table' cellspacing=0px cellpadding=0px style='width:100%%; padding-left: 5px; border-bottom: 1px solid #CCC;'>\n");
  printf("</table>");
  printf("<iframe name=\"sysconf_syslog_setup_status\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_syslog_setup_status\" frameborder=no style='display:none;'></iframe>");
  return printf("</form>");
}

//----- (0002244C) --------------------------------------------------------
int sub_2244C()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1
  _UNKNOWN *v4; // r4@1
  int v5; // r1@1
  int v6; // r0@1

  printf("<tr><td>");
  puts("<table cellspacing=0px cellpadding=0px style='border-bottom: 1px solid #CCC; height: 24px; background-color: #EEE;'>");
  printf("<colgroup><col width=158px><col width=402px><col width=81px></colgroup>");
  printf("<tr>");
  v1 = sub_134F4(1003, v0);
  printf("<td><span style='padding-left: 5px;'>%s</span></td>", v1);
  v3 = sub_134F4(998, v2);
  printf("<td><span>%s</span></td>", v3);
  puts("<td align=right>");
  v4 = sub_126C4();
  v6 = sub_134F4(1000, v5);
  printf(
    "<span name=rmlog_bt style='margin-right: 20px; cursor:pointer; width: 65px;' onclick=\"RemoveLog();\"><img src='/%s/minus_icon.gif' style='margin: 1px;'>%s</span>",
    v4,
    v6);
  printf("</td>");
  printf("</tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<iframe name=\"sysconf_syslog_log\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_syslog_log\" scrolling=yes frameborder=no style='width:100%%; height:336px; border-bottom: 1px solid #CCC;'></iframe>");
  printf("<iframe name=\"sysconf_syslog_log_clear\" src=\"timepro.cgi?tmenu=iframe&smenu=sysconf_syslog_log_clear\" frameborder=no style='display:none;'></iframe>");
  return printf("</td></tr>");
}

//----- (0002254C) --------------------------------------------------------
int __fastcall sub_2254C(int a1, int a2)
{
  int v2; // r5@1
  _UNKNOWN *v3; // r0@1

  v2 = a2;
  printf("<DIV id=\"%s\" style=\"display:none;\">", a1);
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v3 = sub_126C4();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v3);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\">%s\n",
    v2);
  printf("</SPAN></td>");
  return printf((const char *)&unk_60F0E);
}

//----- (000225F8) --------------------------------------------------------
int sub_225F8()
{
  int v0; // r1@1
  int v1; // r0@1

  sub_133E4((int)"sysconf", (int)"syslog");
  printf("<table cellspacing=0px cellpadding=0px style='width:100%%;'>\n");
  sub_2244C();
  sub_22358();
  printf("</table>");
  v1 = sub_134F4(27, v0);
  return sub_2254C((int)"apply_mask", v1);
}

//----- (0002264C) --------------------------------------------------------
int sub_2264C()
{
  int v0; // r1@1
  int v1; // r0@1

  sub_133E4((int)"sysconf", (int)"syslog");
  printf("<table cellspacing=0px cellpadding=0px style='width:100%%;'>\n");
  sub_2244C();
  sub_22358();
  printf("</table>");
  v1 = sub_134F4(27, v0);
  return sub_2254C((int)"apply_mask", v1);
}

//----- (000226A0) --------------------------------------------------------
int __fastcall sub_226A0(int a1)
{
  int v1; // r5@1
  int result; // r0@1
  int v3; // r0@3
  int v4; // r0@5
  int v5; // r0@7
  int v6; // r7@9
  int v7; // r0@10
  int v8; // r0@12
  int v9; // r4@14
  int v10; // r0@14
  int v11; // r0@15
  bool v12; // cf@15
  int v13; // r0@17
  int v14; // [sp+0h] [bp-38h]@1

  v1 = a1;
  result = get_value_post(a1, "act", &v14, 32);
  if ( result )
  {
    if ( !strcmp((const char *)&v14, "remove") )
    {
      v3 = syslog_clear();
    }
    else
    {
      if ( !strcmp((const char *)&v14, "sendmail") )
      {
        v4 = syslog_set_sendmail();
        signal_update(v4);
        return 1;
      }
      if ( get_value_post(v1, "log_flag", &v14, 32) )
      {
        v5 = strcmp((const char *)&v14, "on") == 0;
        syslog_set_status(v5);
      }
      if ( get_value_post(v1, "log_email_chk", &v14, 32) )
      {
        v7 = strcmp((const char *)&v14, "on");
        v6 = 1 - v7;
        if ( (unsigned int)v7 > 1 )
          v6 = 0;
      }
      else
      {
        v6 = 0;
      }
      v8 = get_value_post(v1, "email_hour", &v14, 32);
      if ( v8 )
        v8 = atoi((const char *)&v14);
      v9 = v8;
      v10 = get_value_post(v1, "log_rmflag_chk", &v14, 32);
      if ( v10 )
      {
        v11 = strcmp((const char *)&v14, "on");
        v12 = (unsigned int)v11 <= 1;
        v10 = 1 - v11;
        if ( !v12 )
          v10 = 0;
      }
      v13 = syslog_set_email_status(v6, v9, v10);
      v3 = signal_update(v13);
    }
    signal_save(v3);
    return 1;
  }
  return result;
}
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EFFC: using guessed type int __fastcall syslog_set_status(_DWORD);
// F08C: using guessed type int syslog_clear(void);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// FB60: using guessed type int __fastcall syslog_set_email_status(_DWORD, _DWORD, _DWORD);
// FC50: using guessed type int syslog_set_sendmail(void);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);

//----- (00022810) --------------------------------------------------------
int __fastcall sub_22810(int a1, int a2)
{
  int v2; // r4@1
  int result; // r0@1

  v2 = sub_226A0(a2);
  puts("<form method=post action=timepro.cgi name=syslog_fm>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=sysconf_syslog_log_clear>");
  puts("<input type=hidden name=act value='remove'>");
  result = printf("</form>");
  if ( v2 )
  {
    printf("<script>");
    printf((const char *)&unk_69E05);
    printf((const char *)&unk_69E61);
    result = printf("</script>");
  }
  return result;
}

//----- (00022898) --------------------------------------------------------
int __fastcall sub_22898(int a1)
{
  int v1; // r4@1
  int v2; // r0@1
  int v3; // r5@3
  int v4; // r7@3
  const char *v5; // r0@5
  int v6; // r0@10
  int v8; // [sp+4h] [bp-8Ch]@3
  int v9; // [sp+8h] [bp-88h]@10
  int v10; // [sp+Ch] [bp-84h]@4
  int v11; // [sp+14h] [bp-7Ch]@10
  char v12; // [sp+38h] [bp-58h]@1
  char v13; // [sp+58h] [bp-38h]@3
  char v14; // [sp+68h] [bp-28h]@1
  size_t v15; // [sp+6Ch] [bp-24h]@10
  void *s; // [sp+70h] [bp-20h]@1
  size_t n; // [sp+74h] [bp-1Ch]@10

  v1 = a1;
  malloc_syslog_string(&s);
  malloc_syslog_string(&v14);
  sub_133E4((int)"sysconf", (int)"syslog");
  printf("<div id='syslog_dummy_tr' style='display:none;'>");
  printf((const char *)&unk_6966E);
  printf("<table id='sysconf_syslog_log_table' cellspacing=0px cellpadding=0px style='width:100%%;'>\n");
  v2 = get_value(v1, "logid", &v12, 32);
  if ( v2 )
    v2 = atoi(&v12);
  v3 = v2;
  malloc_syslog_msg_structure(&v13, &v8, v2);
  v4 = 0;
  while ( syslog_read_syslog_msg(&v13, &v8) )
  {
    printf("<tr onclick=\"ChangeToClickColor(this);\" onmouseover=\"ChangeToOverColor(this);\" onmouseout=\"ChangeToOutColor(this)\">");
    printf("<td style=\"height:20px; padding: 0px 10px 0px 5px; width: 134px; \" >%s</td>", v10);
    puts("<td style=\"height:20px; padding: 0px 10px 0px 10px;\" >");
    if ( v8 == 1 )
    {
      v5 = "<span class=\"log_info_text\">";
    }
    else
    {
      v5 = "<span class=\"log_info_text\">";
      if ( v8 == 2 )
      {
        v5 = "<span class=\"log_warning_text\">";
      }
      else if ( v8 == 3 )
      {
        v5 = "<span class=\"log_error_text\">";
      }
    }
    puts(v5);
    memset(s, 0, n);
    memset(*(void **)&v14, 0, v15);
    syslog_decode_text(v11, &v14);
    syslog_convert_syslog_message(&s, &v14);
    sub_11658((const char *)s);
    v6 = printf("</span></td>");
    etr(v6);
    ++v4;
    if ( v3 < v9 )
      v3 = v9;
  }
  free_syslog_string(&s);
  free_syslog_string(&v14);
  free_syslog_msg_structure(&v13, &v8);
  printf("</table>");
  printf("</div>");
  printf("<script>");
  if ( v4 )
  {
    printf("setTRBackgroundColor();");
    printf("parent.document.getElementById('syslog_dummy_tr').outerHTML = document.getElementById('syslog_dummy_tr').innerHTML;");
    printf("DeleteBlankTr();");
  }
  printf((const char *)&unk_6A12D, v3);
  return printf("</script>");
}
// EBB8: using guessed type int __fastcall malloc_syslog_msg_structure(_DWORD, _DWORD, _DWORD);
// EC6C: using guessed type int __fastcall syslog_convert_syslog_message(_DWORD, _DWORD);
// F0A4: using guessed type int __fastcall syslog_decode_text(_DWORD, _DWORD);
// F254: using guessed type int __fastcall free_syslog_msg_structure(_DWORD, _DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F38C: using guessed type int __fastcall free_syslog_string(_DWORD);
// F4A0: using guessed type int __fastcall malloc_syslog_string(_DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// FE18: using guessed type int __fastcall syslog_read_syslog_msg(_DWORD, _DWORD);

//----- (00022AA4) --------------------------------------------------------
int __fastcall sub_22AA4(int a1, int a2)
{
  int v2; // r8@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r0@1
  int v7; // r1@1
  char *v8; // r4@2
  int v9; // r0@4
  int v10; // r0@4
  int v11; // r1@4
  char *v12; // r4@5
  int v13; // r0@7
  int v14; // r0@7
  int v15; // r0@7
  int v16; // r1@7
  int v17; // r0@7
  int v18; // r1@7
  int v19; // r5@7
  int v20; // r4@7
  int v21; // r0@7
  int v22; // r0@7
  int v23; // r0@7
  int v24; // r1@7
  int v25; // r0@7
  char *v26; // r1@10
  int v27; // r1@12
  int v28; // r0@12
  int v29; // r1@15
  int v30; // r0@15
  char *v31; // r1@16
  int v32; // r1@18
  int v33; // r0@18
  int v34; // r0@18
  int v35; // r1@18
  int v36; // r0@18
  const char *v37; // r0@18
  int v38; // r1@19
  int v39; // r0@19
  int v40; // r0@19
  int v41; // r1@20
  int v42; // r0@20
  char v44; // [sp+4h] [bp-124h]@8
  char v45; // [sp+84h] [bp-A4h]@7
  int v46; // [sp+104h] [bp-24h]@7
  unsigned int v47; // [sp+108h] [bp-20h]@7
  int v48; // [sp+10Ch] [bp-1Ch]@7

  v2 = sub_226A0(a2);
  print_start_main_table(v2);
  puts("<form method=post action=timepro.cgi name=syslog_fm>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=sysconf_syslog_setup_status>");
  puts("<input type=hidden name=act value=>");
  v3 = printf("<table id='sysconf_syslog_setup_table' cellspacing=0px cellpadding=0px style='width:100%%; padding-left: 5px; border-bottom: 1px solid #CCC;'>\n");
  str(v3);
  v5 = sub_134F4(1001, v4);
  printf("<td style='width:130px;'><span>%s</span></td>", v5);
  v6 = puts("<td colspan=2>");
  if ( syslog_get_status(v6) )
    v8 = "checked";
  else
    v8 = "";
  v9 = sub_134F4(894, v7);
  printf("<input type=radio id=log_flag_on name=log_flag value=on %s><label for=log_flag_on> %s</label>", v8, v9);
  v10 = print_nbsp(5);
  if ( syslog_get_status(v10) )
    v12 = "";
  else
    v12 = "checked";
  v13 = sub_134F4(901, v11);
  printf("<input type=radio id=log_flag_off name=log_flag value=off %s><label for=log_flag_off> %s</label>", v12, v13);
  v14 = printf("</td>");
  v15 = etr(v14);
  str(v15);
  v17 = sub_134F4(1002, v16);
  printf("<td><span>%s</span></td>", v17);
  puts("<td colspan=2>");
  v19 = sub_134F4(992, v18);
  v20 = syslog_get_count();
  v21 = syslog_max_count();
  printf("<span style='padding-left: 4px;'>%s : %d(%d)</span>", v19, v20, v21);
  v22 = printf("</td>");
  v23 = etr(v22);
  str(v23);
  v25 = sub_134F4(997, v24);
  printf("<td><span>%s</span></td>", v25);
  syslog_get_email_status(&v48, &v47, &v46);
  if ( get_admin_email(&v45) && get_smtp_server(&v44) )
  {
    printf("<td>");
    if ( v48 )
      v26 = "checked";
    else
      v26 = "";
    printf(
      "<input type=checkbox id=log_email_chk name=log_email_chk %s style='vertical-align: middle;' onclick='toggleTimeCheckbox();'>",
      v26);
    print_nbsp(1);
    printf("<label for=log_email_chk>");
    v28 = sub_134F4(995, v27);
    printf((const char *)v28);
    printf("</label>");
    if ( v47 > 0x17 )
      printf("<input type=number id=email_hour name=email_hour min=0 max=23 style='width: 37px; padding-left: 2px; border: 1px solid #CCC;'>");
    else
      printf("<input type=number id=email_hour name=email_hour min=0 max=23 style='width: 37px; padding-left: 2px; border: 1px solid #CCC;' value=%d>");
    printf("<label for=log_email_chk>");
    v30 = sub_134F4(996, v29);
    printf((const char *)v30);
    printf("</label>");
    printf("</td>");
    printf("<td style='width: 380px;'>");
    if ( v46 )
      v31 = "checked";
    else
      v31 = "";
    printf(
      "<input type=checkbox id=log_rmflag_chk name=\"log_rmflag_chk\" %s style='vertical-align: middle;'>",
      v31,
      "");
    print_nbsp(1);
    printf("<label for=log_rmflag_chk>");
    v33 = sub_134F4(994, v32);
    printf((const char *)v33);
    v34 = printf("</label>");
    etr(v34);
    printf("<tr style='height:40px;'>");
    printf("<td></td>");
    printf("<td align=left>");
    v36 = sub_134F4(1004, v35);
    printf("<input type=button name=\"sendmail_bt\" value=\"%s\" onclick=\"Send_Email();\">", v36);
    printf("</td>");
    v37 = "<td align=right>";
  }
  else
  {
    puts("<td><span style='padding-left: 2px;'>");
    v39 = sub_134F4(993, v38);
    printf((const char *)v39, "JavaScript:parent.MovePagetoMain('sysconf','login');");
    v40 = printf("</span></td>");
    etr(v40);
    printf("<tr style='height:45px;'>");
    v37 = "<td colspan=2 align=right>";
  }
  puts(v37);
  v42 = sub_134F4(28, v41);
  printf("<input type=button name=rmlog_bt value=\"%s\" style='margin-right: 20px;' onclick=\"ApplySyslog();\">", v42);
  printf("</td>");
  printf("</tr>");
  printf("</table>");
  puts("</form>");
  printf("<script>");
  printf("parent.document.getElementById('sysconf_syslog_setup_table').outerHTML = document.getElementById('sysconf_syslog_setup_table').outerHTML;");
  if ( v2 )
    printf("setTimeout(function() { UnMaskIt(parent.parent.document, 'apply_mask'); }, 500);");
  printf("parent.toggleTimeCheckbox();");
  return printf("</script>");
}
// E7BC: using guessed type int __fastcall syslog_get_status(_DWORD);
// E894: using guessed type int __fastcall syslog_get_email_status(_DWORD, _DWORD, _DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F0D4: using guessed type int syslog_get_count(void);
// F2A8: using guessed type int __fastcall print_start_main_table(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// F7A0: using guessed type int syslog_max_count(void);
// FB00: using guessed type int __fastcall get_smtp_server(_DWORD);
// FCB0: using guessed type int __fastcall get_admin_email(_DWORD);

//----- (00022E8C) --------------------------------------------------------
int __fastcall sub_22E8C(int a1)
{
  int v1; // r4@1
  int v2; // r0@1
  int v3; // r3@1
  int v4; // r0@5
  int v5; // r3@5
  int v6; // r0@15
  signed int v7; // r3@15
  int v8; // r0@19
  signed int v9; // r3@19
  int v10; // r0@23
  signed int v11; // r3@23
  int v12; // r0@27
  int v13; // r3@27
  int v14; // r0@31
  int v15; // r3@31

  v1 = a1;
  v2 = istatus_get_intvalue_direct("scan_type");
  if ( v2 == -1 )
    v3 = 0;
  *(_DWORD *)v1 = v2;
  if ( v2 == -1 )
    *(_DWORD *)v1 = v3;
  v4 = istatus_get_intvalue_direct("ping_type");
  if ( v4 == -1 )
    v5 = 0;
  *(_DWORD *)(v1 + 4) = v4;
  if ( v4 == -1 )
    *(_DWORD *)(v1 + 4) = v5;
  if ( istatus_get_value_direct("ping_addr", v1 + 8) == -1 )
    *(_BYTE *)(v1 + 8) = 0;
  if ( istatus_get_value_direct("tcp_addr", v1 + 40) == -1 )
    *(_BYTE *)(v1 + 40) = 0;
  if ( istatus_get_value_direct("text_color", v1 + 72) == -1 )
    strcpy((char *)(v1 + 72), "start");
  v6 = istatus_get_intvalue_direct("ping_count");
  if ( v6 == -1 )
    v7 = 3;
  *(_DWORD *)(v1 + 104) = v6;
  if ( v6 == -1 )
    *(_DWORD *)(v1 + 104) = v7;
  v8 = istatus_get_intvalue_direct("ping_datasize");
  if ( v8 == -1 )
    v9 = 100;
  *(_DWORD *)(v1 + 108) = v8;
  if ( v8 == -1 )
    *(_DWORD *)(v1 + 108) = v9;
  v10 = istatus_get_intvalue_direct("ping_timeout");
  if ( v10 == -1 )
    v11 = 1;
  *(_DWORD *)(v1 + 112) = v10;
  if ( v10 == -1 )
    *(_DWORD *)(v1 + 112) = v11;
  v12 = istatus_get_intvalue_direct("tcp_scan_start_port");
  if ( v12 == -1 )
    v13 = 0;
  *(_DWORD *)(v1 + 116) = v12;
  if ( v12 == -1 )
    *(_DWORD *)(v1 + 116) = v13;
  v14 = istatus_get_intvalue_direct("tcp_scan_end_port");
  if ( v14 == -1 )
    v15 = 0;
  *(_DWORD *)(v1 + 120) = v14;
  if ( v14 == -1 )
    *(_DWORD *)(v1 + 120) = v15;
  return 0;
}
// EC18: using guessed type int __fastcall istatus_get_value_direct(_DWORD, _DWORD);
// F0EC: using guessed type int __fastcall istatus_get_intvalue_direct(_DWORD);

//----- (00022FC4) --------------------------------------------------------
int sub_22FC4()
{
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:auto;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_hostscanlist\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=hostscanlist>");
  printf("<div id=\"hostscan_list\" style=\"height:360px; overflow:auto;\">");
  printf("</div>");
  printf("</form>");
  return printf("</BODY>");
}

//----- (0002302C) --------------------------------------------------------
int sub_2302C()
{
  int v0; // r10@1
  char *v1; // r4@2
  int v2; // r1@2
  int v3; // r0@3
  char *v4; // r4@3
  int v5; // r1@3
  int v6; // r0@3
  char *v7; // r4@3
  int v8; // r1@3
  int v9; // r0@3
  char *v10; // r4@3
  int v11; // r1@3
  int v12; // r6@3
  int v13; // r4@3
  int v14; // r1@3
  int v15; // r5@3
  int v16; // r0@3
  char *v17; // r5@3
  int v18; // r1@3
  int v19; // r4@3
  int v20; // r1@3
  int v21; // r0@3
  int v22; // r1@3
  char *v23; // r2@3
  int v24; // r3@3
  const char *v25; // r0@3
  int v26; // r1@4
  int v27; // r0@5
  char *v28; // r4@5
  int v29; // r1@5
  int v30; // r0@5
  char *v31; // r4@5
  int v32; // r1@5
  int v33; // r0@5
  char *v34; // r4@5
  int v35; // r1@5
  int v36; // r6@5
  int v37; // r4@5
  int v38; // r1@5
  int v39; // r5@5
  int v40; // r0@5
  int v41; // r1@7
  int v42; // r0@8
  char *v43; // r4@8
  int v44; // r1@8
  int v45; // r0@8
  char *v46; // r4@8
  int v47; // r1@8
  int v48; // r0@8
  char *v49; // r0@8
  FILE *v50; // r6@9
  signed int v51; // r4@10
  signed int v52; // r4@11
  char s; // [sp+4h] [bp-124h]@1
  char v55; // [sp+84h] [bp-A4h]@1
  char *save_ptr; // [sp+104h] [bp-24h]@2

  v0 = get_hostscan(&v55);
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_hostscanstatus\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=hostscanstatus>");
  printf("<div id=\"statline\">");
  printf("<table name=\"listtable\" class=\"v3_table hostscan_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  get_hostscan(&s);
  printf(
    "<tr height=\"24\" class=\"hostscan_main_tr\" style=\"background-color:#%s;\"><td class=\"hostscan_main_td\"><p class=\"hostscan_main_p\">",
    "FFFFFF");
  if ( s )
  {
    v1 = strtok_r(&s, " ", &save_ptr);
    if ( !strcmp(v1, "icmp") )
    {
      v3 = sub_134F4(1030, v2);
      printf("%s PING\t", v3);
      v4 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v6 = sub_134F4(401, v5);
      printf("%s:%s\t", v6, v4);
      v7 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v9 = sub_134F4(1027, v8);
      printf("%s:%s\t", v9, v7);
      v10 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v12 = sub_134F4(1036, v11);
      v13 = atoi(v10);
      v15 = sub_134F4(878, v14);
      v16 = sub_43AF4(v13, 1000);
      printf("%s:%d%s\t", v12, v16, v15);
      v17 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v19 = sub_134F4(1028, v18);
      v21 = sub_134F4(1029, v20);
      v22 = v19;
      v23 = v17;
      v24 = v21;
      v25 = "%s:%s%s\t";
LABEL_6:
      printf(v25, v22, v23, v24);
      goto LABEL_9;
    }
    if ( !strcmp(v1, "arp") )
    {
      v27 = sub_134F4(1025, v26);
      printf("%s PING\t", v27);
      v28 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v30 = sub_134F4(401, v29);
      printf("%s:%s\t", v30, v28);
      v31 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v33 = sub_134F4(1027, v32);
      printf("%s:%s\t", v33, v31);
      v34 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v36 = sub_134F4(1036, v35);
      v37 = atoi(v34);
      v39 = sub_134F4(878, v38);
      v40 = sub_43AF4(v37, 1000);
      v22 = v36;
      v24 = v39;
      v23 = (char *)v40;
      v25 = "%s:%d%s\t";
      goto LABEL_6;
    }
    if ( !strcmp(v1, "tcp") )
    {
      v42 = sub_134F4(1035, v41);
      printf("%s\t", v42);
      v43 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v45 = sub_134F4(401, v44);
      printf("%s:%s\t", v45, v43);
      v46 = strtok_r(0, " ", &save_ptr);
      print_nbsp(4);
      v48 = sub_134F4(1032, v47);
      printf("%s:%s~", v48, v46);
      v49 = strtok_r(0, " ", &save_ptr);
      printf("%s\t", v49);
    }
  }
LABEL_9:
  printf("</p></td></tr>");
  v50 = fopen("/var/log/hostscan.log", "rb");
  if ( v50 )
  {
    v51 = 1;
    while ( fgets(&s, 128, v50) )
    {
      if ( strcmp(&s, "\n") )
      {
        printf("<tr height=\"24\" class=\"hostscan_main_tr\" style=\"background-color:#%s;\"><td class=\"hostscan_main_td\"><p class=\"hostscan_main_p\">");
        printf("%s", &s);
        printf("</p></td></tr>");
        ++v51;
      }
    }
    while ( v51 <= 14 )
    {
      printf("<tr height=\"24\" class=\"hostscan_main_tr\" style=\"background-color:#%s;\"><td class=\"hostscan_main_td\"><p class=\"hostscan_main_p\">");
      printf("</p></td></tr>");
      ++v51;
    }
    fclose(v50);
  }
  else
  {
    v52 = 1;
    do
    {
      printf("<tr height=\"24\" class=\"hostscan_main_tr\" style=\"background-color:#%s;\"><td class=\"hostscan_main_td\"><p class=\"hostscan_main_p\">");
      ++v52;
      printf("</p></td></tr>");
    }
    while ( v52 != 15 );
  }
  printf("</table>");
  printf("</div>");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  printf("if(parent.window.init_hostscan_status)parent.window.init_hostscan_status(document, %d);", v0);
  return printf("</script>");
}
// F4F4: using guessed type int __fastcall get_hostscan(_DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);

//----- (00023550) --------------------------------------------------------
int __fastcall sub_23550(int a1, int a2)
{
  int v2; // r8@1
  int v3; // r1@1
  int v4; // r0@1
  char *v5; // r5@1
  int v6; // r1@1
  char *v7; // r4@2
  int v8; // r0@4
  int v9; // r1@4
  int v10; // r0@6
  int v11; // r1@6
  int v12; // r0@6
  int v13; // r1@6
  int v14; // r0@6
  int v15; // r1@6
  int v16; // r0@6
  int v17; // r4@6
  int v18; // r1@6
  int v19; // r0@6
  int v20; // r1@6
  int v21; // r0@6
  int v22; // r5@6
  int v23; // r4@6
  int v24; // r1@6
  int v25; // r0@6
  int v26; // r1@6
  int v27; // r0@6
  int v28; // r1@6
  int v29; // r0@6
  int v30; // r1@6
  int v31; // r0@6
  _UNKNOWN *v32; // r4@6
  int v33; // r1@6
  int v34; // r0@6
  _UNKNOWN *v35; // r4@6
  int v36; // r1@6
  int v37; // r0@6
  int v38; // r1@6
  int v39; // r0@6
  _UNKNOWN *v40; // r4@6
  int v41; // r1@6
  int v42; // r0@6
  int v43; // r0@6
  int v44; // r0@7
  int v45; // r0@9
  int v46; // r0@10
  int v47; // r0@10
  int v48; // r0@13
  int result; // r0@13
  const char *v50; // r0@16

  v2 = a2;
  printf("<table class=\"v3_table hostscan_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  puts("<form method=get action=\"timepro.cgi\" name=\"hostscan_fm\">");
  puts("<input type=hidden name=\"tmenu\" value=\"expertconf\">");
  puts("<input type=hidden name=\"smenu\" value=\"hostscan\">");
  printf("<input type=\"hidden\" name=act value\"\">");
  printf("<input type=\"hidden\" name=submitted value\"0\">");
  printf("<COL width=\"130\"><COL width=\"100\"><COL width=\"60\"><COL width=\"80\"><COL width=\"140\"><COL width=\"%%%%\">");
  printf("<tr class=\"hostscan_main_tr\" height=\"24\"><td class=\"hostscan_main_td\">");
  *(_DWORD *)v2;
  printf("<input type=radio name=sel id=\"sel_ping\" value=%d onclick=\"hostscanRadio_disableForm(0)\" %s>\n");
  v4 = sub_134F4(1031, v3);
  v5 = "selected";
  printf("<label for=\"sel_ping\">%s</label>", v4);
  printf("</td><td class=\"hostscan_main_td\">");
  *(_DWORD *)v2;
  printf("<select class=navi_select name=ping_type onchange=\"hostscanSel_disableForm()\" %s>\n");
  if ( *(_DWORD *)(v2 + 4) )
    v7 = "";
  else
    v7 = "selected";
  v8 = sub_134F4(1030, v6);
  printf("<option value=%d %s>%s\n", 0, v7, v8);
  if ( *(_DWORD *)(v2 + 4) != 1 )
    v5 = "";
  v10 = sub_134F4(1025, v9);
  printf("<option value=%d %s>%s\n", 1, v5, v10);
  puts("</select>");
  printf("</td><td class=\"hostscan_main_td\" align=\"right\">");
  v12 = sub_134F4(401, v11);
  printf("<span class=\"hostscan_main_span\" style='margin-right:5px;'>%s</span>", v12);
  printf("</td><td class=\"hostscan_main_td\" colspan=\"2\">");
  sub_11D7C((int)"ip", v2 + 8, 1);
  printf("</td><td class=\"hostscan_main_td\"></td></tr>");
  printf("<tr class=\"hostscan_main_tr\" height=\"24\"><td class=\"hostscan_main_td\">");
  printf("</td><td class=\"hostscan_main_td\">");
  v14 = sub_134F4(1027, v13);
  printf(
    "<span class=\"hostscan_main_span\">%s \t\t<input type=text class=navi_text class=navimenu_text name=count maxlength=3 size=3 value=%d></span>\n",
    v14,
    *(_DWORD *)(v2 + 104));
  printf("</td><td class=\"hostscan_main_td\" align=\"right\">");
  v16 = sub_134F4(1036, v15);
  printf("<span class=\"hostscan_main_span\" style='margin-right:5px;'>%s</span>", v16);
  printf("</td><td class=\"hostscan_main_td\">");
  v17 = *(_DWORD *)(v2 + 112);
  v19 = sub_134F4(878, v18);
  printf("<input type=text class=navi_text name=timeout maxlength=2 size=2 value=%d>%s</span>\n", v17, v19);
  printf("</td><td class=\"hostscan_main_td\" colspan=\"2\">");
  v21 = sub_134F4(1028, v20);
  v22 = *(_DWORD *)(v2 + 108);
  v23 = v21;
  v25 = sub_134F4(1029, v24);
  printf(
    "<span class=\"hostscan_main_span\">%s \t\t<input type=text class=navi_text name=datasize maxlength=5 size=5 value=%d>%s\n",
    v23,
    v22,
    v25);
  printf("</td></tr>");
  printf("<tr class=\"hostscan_main_tr\" height=\"24\"><td class=\"hostscan_main_td\">");
  *(_DWORD *)v2;
  printf("<input type=radio name=\"sel\" id=\"sel_tcp\" value=%d onclick=\"hostscanRadio_disableForm(1)\" %s>\n");
  v27 = sub_134F4(1035, v26);
  printf("<label for=\"sel_tcp\">%s</label>", v27);
  printf("</td><td class=\"hostscan_main_td\" colspan=\"3\">");
  v29 = sub_134F4(401, v28);
  printf("<span class=\"hostscan_main_span\">%s", v29);
  sub_11D7C((int)"pip", v2 + 40, 1);
  printf((const char *)&unk_6B14C);
  v31 = sub_134F4(1032, v30);
  printf(
    "<span class=\"hostscan_main_span\">%s <input type=text class=navi_text name=start maxlength=5 size=5 value=%d>\n",
    v31,
    *(_DWORD *)(v2 + 116));
  printf("~<input type=text class=navi_text name=end maxlength=5 size=5 value=%d></span>\n", *(_DWORD *)(v2 + 120));
  puts("</td></tr>");
  printf("<tr class=\"hostscan_main_tr\" height=\"5\"><td class=\"hostscan_main_td\" colspan=\"6\">");
  printf("</td></tr>");
  printf("<tr class=\"hostscan_main_tr\" height=\"5\" style=\"border-top:1px #CCC solid;\"><td class=\"hostscan_main_td\" colspan=\"6\">");
  printf("</td></tr>");
  printf("<tr class=\"hostscan_main_tr\" height=\"24\"><td class=\"hostscan_main_td\" colspan=\"6\" style=\"padding-left:5px;\">");
  printf("<button type=\"button\" class=\"hostscan_main_button\" style=\"width:55px;\" \t\tonclick=\"hostscanStart(); return ClickEventPropagater();\" id=\"startbtn\">");
  v32 = sub_126C4();
  v34 = sub_134F4(1033, v33);
  printf(
    "<span class=\"hostscan_main_span\"><img src=\"/%s/apscan.gif\" style=\"margin-right:5px;\">%s</span>",
    v32,
    v34);
  printf("</button>");
  printf("<button type=\"button\" class=\"hostscan_main_button\" style=\"width:55px; margin-left:10px;\" \t\tonclick=\"hostscanStop(); return ClickEventPropagater();\" id=\"stopbtn\">");
  v35 = sub_126C4();
  v37 = sub_134F4(901, v36);
  printf(
    "<span class=\"hostscan_main_span\"><img src=\"/%s/minus_icon.gif\" style=\"margin-right:5px;\">%s</span>",
    v35,
    v37);
  printf("</button>");
  printf("</td></tr>");
  printf("<tr class=\"hostscan_main_tr\" height=\"5\" style=\"border-bottom:1px #CCC solid;\"><td class=\"hostscan_main_td\" colspan=\"6\">");
  printf("</td></tr>");
  printf("<tr class=\"hostscan_main_tr\" height=\"24\" style=\"background-color:#DBDBDB; border-top:1px #ccc solid; border-bottom:1px #ccc solid;\">\t\t<td class=\"hostscan_main_td\" colspan=\"4\">");
  v39 = sub_134F4(1034, v38);
  printf(
    "<p class=\"hostscan_main_p\"><b>%s</b></p></td><td class=\"hostscan_main_td\" colspan=\"2\" align=\"right\" style=\"padding-right:15px;\">",
    v39);
  v40 = sub_126C4();
  v42 = sub_134F4(1026, v41);
  printf(
    "<span class=\"hostscan_main_span\" onclick=\"hostscanClear();\" style=\"cursor:pointer;\">\t\t<img src=\"/%s/minus_icon.gif\" style=\"margin-right:5px;\">%s</span>",
    v40,
    v42);
  printf("</td></tr>");
  printf("</form>");
  v43 = printf("<tr class=\"hostscan_main_tr\" height=\"360\" style=\"border-bottom:1px #CCC solid;\">\t\t<td class=\"hostscan_main_td\" colspan=\"6\">");
  if ( is_mobile_agent(v43) )
  {
    sub_12790((int)"360", (int)"100%%", (int)"display:inline-block; *display:inline; zoom:1;");
    v44 = printf("<iframe name=\"hostscanlist_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hostscanlist\"                         frameborder=no width=100%% height=360 align=center scrolling=no></iframe>");
    sub_12770(v44);
  }
  else
  {
    printf("<iframe name=\"hostscanlist_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hostscanlist\"                         frameborder=no width=100%% height=360 align=center scrolling=no></iframe>");
  }
  printf("</td></tr>");
  v45 = printf("</table>");
  if ( is_mobile_agent(v45) )
  {
    sub_12790((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v46 = printf("<iframe name=\"hostscanstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hostscanstatus\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    v47 = sub_12770(v46);
  }
  else
  {
    v47 = printf("<iframe name=\"hostscanstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hostscanstatus\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  if ( is_mobile_agent(v47) )
  {
    sub_12790((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v48 = printf("<iframe name=\"hostscansubmit_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hostscansubmit\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    result = sub_12770(v48);
  }
  else
  {
    result = printf("<iframe name=\"hostscansubmit_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hostscansubmit\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  if ( *(_DWORD *)v2 )
  {
    if ( *(_DWORD *)v2 != 1 )
      return result;
    puts("<script language=JavaScript>");
    v50 = "hostscanRadio_disableForm(1);";
  }
  else
  {
    puts("<script language=JavaScript>");
    puts("hostscanRadio_disableForm(0);");
    v50 = "hostscanSel_disableForm();";
  }
  puts(v50);
  puts("init_hostscan();");
  return puts("</script>");
}
// F74C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (00023AF4) --------------------------------------------------------
int __fastcall sub_23AF4(int a1)
{
  int v1; // r7@1
  _UNKNOWN *v2; // r0@1
  char v4; // [sp+4h] [bp-94h]@1

  v1 = a1;
  sub_22E8C((int)&v4);
  sub_133E4((int)"expertconf", (int)"hostscan");
  puts("<style type=\"text/css\">");
  puts(".hostscan_main_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".hostscan_main_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".hostscan_main_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".hostscan_main_p {");
  puts("\tpadding:0 0 0 5px; display:inline-block;");
  puts("\tvertical-align:middle; margin:0;");
  puts("}");
  puts(".hostscan_main_span {");
  puts("\tdisplay:inline-block; vertical-align:middle;");
  puts("}");
  puts(".hostscan_main_button {");
  puts("\tpadding:0 1px 0 1px; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".hostscan_main_td input[type=checkbox], .hostscan_main_td input[type=radio] {");
  puts("display:inline-block; vertical-align:middle;");
  puts("}");
  puts("#hostscan_div_msg p {");
  puts("margin:5px 0 5px 15px; text-align:left;");
  puts("}");
  puts(".hostscan_ellipsis {");
  puts("text-overflow:ellipsis; overflow:hidden; white-space:nowrap; text-align:left;");
  puts("}");
  printf("input[type=\"text\"] {border:1px #CCC solid;}");
  printf("input[type=\"password\"] {border:1px #CCC solid;}");
  printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td {cursor:default;}");
  printf("</style>");
  sub_23550(v1, (int)&v4);
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v2 = sub_126C4();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v2);
  printf("</SPAN></td>");
  printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"hostscan_div_msg\">\n");
  printf("</SPAN></td>");
  return printf((const char *)&unk_60F0E);
}

//----- (00023D68) --------------------------------------------------------
int __fastcall sub_23D68(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r4@1
  int v4; // r0@4
  char *v5; // r1@4
  int v6; // r2@4
  int v7; // r0@9
  int v8; // r3@10
  int v9; // lr@13
  int v10; // r12@13
  char *v11; // r0@13
  const char *v12; // r2@13
  int v13; // r3@13
  int v14; // r0@22
  char v16; // [sp+10h] [bp-310h]@11
  char s1; // [sp+210h] [bp-110h]@1

  v2 = a2;
  v3 = a1;
  if ( get_value_post(a1, "act", &s1, 256) )
  {
    get_intvalue_post(v3, "sel", v2);
    if ( *(_DWORD *)v2 )
    {
      if ( *(_DWORD *)v2 != 1 )
        goto LABEL_8;
      get_ip_value_post(v3, "pip", v2 + 40);
      get_intvalue_post(v3, "start", v2 + 116);
      v5 = "end";
      v4 = v3;
      v6 = v2 + 120;
    }
    else
    {
      get_ip_value_post(v3, "ip", v2 + 8);
      get_intvalue_post(v3, "ping_type", v2 + 4);
      get_intvalue_post(v3, "count", v2 + 104);
      get_intvalue_post(v3, "timeout", v2 + 112);
      if ( *(_DWORD *)(v2 + 4) )
        goto LABEL_8;
      v4 = v3;
      v5 = "datasize";
      v6 = v2 + 108;
    }
    get_intvalue_post(v4, v5, v6);
LABEL_8:
    if ( strcmp(&s1, "start") )
    {
      if ( !strcmp(&s1, "stop") )
      {
        strcpy((char *)(v2 + 72), "stop");
        stop_hostscan(1);
      }
      else if ( !strcmp(&s1, "clear") )
      {
        ((void (*)(void))clear_hostscan_log)();
      }
      goto LABEL_22;
    }
    strcpy((char *)(v2 + 72), "start");
    v7 = stop_hostscan(1);
    if ( *(_DWORD *)v2 )
    {
      if ( *(_DWORD *)v2 != 1 )
        goto LABEL_17;
      v10 = *(_DWORD *)(v2 + 116);
      v9 = *(_DWORD *)(v2 + 120);
      v12 = "tcp %s %d %d";
      v11 = &v16;
      v13 = v2 + 40;
    }
    else
    {
      v8 = *(_DWORD *)(v2 + 4);
      if ( !v8 )
      {
        v7 = snprintf2(
               &v16,
               512,
               "icmp %s %d %d %d",
               v2 + 8,
               *(_DWORD *)(v2 + 104),
               1000 * *(_DWORD *)(v2 + 112),
               *(_DWORD *)(v2 + 108));
LABEL_17:
        clear_hostscan_log(v7);
        start_hostscan(&v16);
LABEL_22:
        istatus_set_intvalue_direct("scan_type", *(_DWORD *)v2);
        istatus_set_intvalue_direct("ping_type", *(_DWORD *)(v2 + 4));
        istatus_set_value_direct("ping_addr", v2 + 8);
        istatus_set_value_direct("tcp_addr", v2 + 40);
        istatus_set_value_direct("text_color", v2 + 72);
        istatus_set_intvalue_direct("ping_count", *(_DWORD *)(v2 + 104));
        istatus_set_intvalue_direct("ping_datasize", *(_DWORD *)(v2 + 108));
        istatus_set_intvalue_direct("tcp_scan_start_port", *(_DWORD *)(v2 + 116));
        v14 = istatus_set_intvalue_direct("tcp_scan_end_port", *(_DWORD *)(v2 + 120));
        signal_update(v14);
        return 0;
      }
      if ( v8 != 1 )
        goto LABEL_17;
      v9 = 1000 * *(_DWORD *)(v2 + 112);
      v10 = *(_DWORD *)(v2 + 104);
      v11 = &v16;
      v12 = "arp %s %d %d";
      v13 = v2 + 8;
    }
    v7 = snprintf2(v11, 512, v12, v13, v10, v9);
    goto LABEL_17;
  }
  return 0;
}
// E828: using guessed type int __fastcall istatus_set_intvalue_direct(_DWORD, _DWORD);
// E8A0: using guessed type int __fastcall get_intvalue_post(_DWORD, _DWORD, _DWORD);
// E99C: using guessed type int __fastcall clear_hostscan_log(_DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// ED5C: using guessed type int __fastcall stop_hostscan(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F89C: using guessed type int __fastcall start_hostscan(_DWORD);
// F950: using guessed type int __fastcall istatus_set_value_direct(_DWORD, _DWORD);
// FB3C: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);

//----- (00024038) --------------------------------------------------------
int __fastcall sub_24038(int a1, int a2)
{
  int v2; // r4@1
  char v4; // [sp+4h] [bp-8Ch]@1

  v2 = a2;
  sub_22E8C((int)&v4);
  sub_23D68(v2, (int)&v4);
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_hostscansubmit\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=hostscansubmit>");
  printf("</form>");
  printf("</BODY>");
  return printf("<script>if(parent.window.init_hostscan_submit)parent.window.init_hostscan_submit();</script>");
}

//----- (000240B8) --------------------------------------------------------
int __fastcall sub_240B8(int result)
{
  int i; // r2@1
  int v2; // r3@5
  bool v3; // zf@5
  int v4; // r1@5
  char v5; // r3@5

  for ( i = 0; ; ++i )
  {
    v2 = *(_BYTE *)(result + i);
    v3 = v2 == 0;
    v4 = v2 - 97;
    v5 = v2 - 32;
    if ( v3 )
      break;
    if ( (unsigned int)v4 <= 0x19 )
      *(_BYTE *)(result + i) = v5;
  }
  return result;
}

//----- (000240E4) --------------------------------------------------------
int sub_240E4()
{
  printf("<TR height=24 STYLE=\"cursor:pointer; background-Color:#%s\">");
  return printf("<TD width=100%% colspan=6 CLASS=text_gray></TD></TR>");
}

//----- (0002411C) --------------------------------------------------------
int sub_2411C()
{
  printf("<TR height=\"0\" id=\"_-guard_line\" class=\"pf_tr\" style=\"display:none;\">");
  return printf("<TD colspan=\"6\"></TD></TR>");
}

//----- (0002413C) --------------------------------------------------------
int sub_2413C()
{
  _UNKNOWN *v0; // r0@1
  int v1; // r1@1
  int v2; // r0@1

  printf("<TR height=\"24\" ID=\"_-new_line\" class=\"pf_tr\" style=\"cursor:pointer; background-color:#%s;\">\n");
  puts("<TD align=\"left\" width=\"30\" class=\"pf_td\">");
  puts("<SPAN id=\"_-new_line_span_1\" class=\"pf_span\" style=\"padding-left:5px;\"                 onclick=\"onClickedPFRule('user','','','','','','','','','','','','','','','','','');\">");
  v0 = sub_126C4();
  printf("<img src=\"/%s/pf_new_rule.gif\">\n", v0);
  puts("</SPAN></TD>");
  puts("<TD align=\"left\" colspan=\"5\" class=\"pf_td\">");
  puts("<a name=\"_-new_line\" class=\"pf_a\">");
  printf("<SPAN ID=\"_-new_line_span_2\" class=\"pf_span\" style=\"color:#4789FF;\"                onclick=\"onClickedPFRule('user','','','','','','','','','','','','','','','','','');\">");
  v2 = sub_134F4(738, v1);
  return printf("%s</SPAN></A></TD></TR>", v2);
}

//----- (000241E0) --------------------------------------------------------
int sub_241E0()
{
  puts("<style type=\"text/css\">");
  puts(".pf_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".pf_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".pf_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".left_padding_td {");
  puts("\tpadding:0 0 0 5; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pf_p {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pf_span {");
  puts("\tpadding:0 0 0 0; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pf_select {");
  puts("\tpadding:0 0 0 0; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pf_textbox {");
  puts("\tpadding:1px 0 1px 0; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pf_button {");
  puts("\tpadding:0 1px 0 1px; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pf_checkbox {");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pf_a {");
  puts("\tvertical-align:middle; text-decoration:none;");
  puts("\tdisplay:inline-block; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;");
  puts("}");
  puts(".pf_overflowable {");
  puts("\tpadding:0 0 0 0; margin:0 0 0 0; border:none none none none; vertical-align:middle; text-decoration:none;");
  puts("\tdisplay:inline-block; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;");
  puts("}");
  puts(".pf_opacity_30 {");
  puts("\topacity:0.3;");
  puts("\t-moz-opacity:0.3;");
  puts("\t-khtml-opacity:0.3;");
  puts("\tfilter:alpha(opacity=30);");
  puts("}");
  printf("::-webkit-input-placeholder {");
  printf("\tcolor:#B4B4B4;");
  putchar(125);
  printf(":-moz-placeholder {");
  printf("\tcolor:#B4B4B4;");
  printf("\topacity:1;");
  putchar(125);
  printf((const char *)&unk_6C3AA);
  printf("\tcolor:#B4B4B4;");
  printf("\topacity:1;");
  putchar(125);
  printf(":-ms-input-placeholder {");
  printf("\tcolor:#B4B4B4;");
  putchar(125);
  return printf("</style>");
}

//----- (000244BC) --------------------------------------------------------
int __fastcall sub_244BC(int a1)
{
  int v1; // r9@1
  FILE *v2; // r10@1
  char *v3; // r7@2
  signed int v4; // r8@2
  char *v5; // r0@5
  const char *v6; // r4@5
  char *v7; // r0@8
  int v8; // r6@8
  char *v9; // r0@8
  const char *v10; // r0@9
  char *v11; // r0@11
  char *v12; // r4@11
  const char *v13; // r0@12
  char *v14; // r0@14
  char *v15; // r0@20
  const char *v16; // r0@21
  int v17; // r5@25
  char *v18; // r8@28
  const char *v19; // r0@29
  int v20; // r1@31
  int v21; // r0@31
  int v22; // r1@31
  int v23; // r0@31
  int v24; // r1@31
  int v25; // r0@31
  int v26; // r1@31
  int v27; // r0@31
  int v28; // r1@31
  int v29; // r0@31
  _UNKNOWN *v30; // r4@31
  int v31; // r1@31
  int v32; // r0@31
  int v33; // r0@31
  int *v34; // r1@32
  const char *v35; // r0@32
  int *v36; // r1@33
  const char *v37; // r0@33
  int v38; // r1@35
  int v39; // r0@35
  int v40; // r1@35
  int v41; // r0@35
  int v42; // r1@35
  int v43; // r0@35
  int v44; // r1@35
  int v45; // r0@35
  int v46; // r1@35
  int v47; // r0@35
  _UNKNOWN *v48; // r4@35
  int v49; // r1@35
  int v50; // r0@35
  int v51; // r0@35
  int v52; // r0@36
  int v53; // r1@38
  int v54; // r0@38
  int v55; // r1@38
  int v56; // r0@38
  int v57; // r1@38
  int v58; // r0@38
  int v59; // r1@38
  int v60; // r0@38
  _UNKNOWN *v61; // r4@38
  int v62; // r1@38
  int v63; // r0@38
  _UNKNOWN *v64; // r1@38
  int *v65; // r4@38
  int v66; // r0@38
  int v67; // r2@39
  char v68[4]; // r0@39
  int v69; // r1@41
  int v70; // r0@41
  int v71; // r1@41
  int v72; // r0@41
  int v73; // r1@41
  int v74; // r0@41
  int v75; // r1@41
  int v76; // r0@41
  _UNKNOWN *v77; // r4@41
  int v78; // r1@41
  int v79; // r0@41
  _UNKNOWN *v80; // r1@41
  int v81; // r0@41
  int result; // r0@45
  int v83; // r1@46
  int v84; // r0@46
  int v85; // r1@46
  int v86; // r0@46
  int v87; // r1@46
  int v88; // r0@46
  int v89; // r1@46
  int v90; // r0@46
  int v91; // r1@46
  int v92; // r0@46
  int v93; // r0@46
  int v94; // r0@49
  _UNKNOWN *v95; // r0@51
  int v96; // r1@51
  int v97; // r0@51
  int v98; // r1@51
  int v99; // r0@51
  FILE *v100; // r6@51
  int v101; // r5@52
  char *v102; // r0@54
  int v103; // r7@57
  int v104; // r1@59
  int v105; // r0@59
  int v106; // r1@59
  int v107; // r0@59
  _UNKNOWN *v108; // r0@59
  int v109; // r1@59
  int v110; // r0@59
  char *v111; // r1@60
  int v112; // r1@62
  char *v113; // r1@63
  char *v114; // r0@64
  char *v115; // r1@66
  char *v116; // r0@67
  char *v117; // r0@69
  bool v118; // zf@69
  char *v119; // r1@69
  char *v120; // r5@75
  signed int v121; // r4@75
  int v122; // r0@77
  char *v123; // r3@77
  int v124; // r0@80
  const char *v125; // r0@80
  int v126; // r1@80
  int v127; // r0@81
  _UNKNOWN *v128; // r0@82
  int v129; // r1@82
  int v130; // r0@82
  int v131; // r1@82
  int v132; // r0@82
  int v133; // r1@82
  int v134; // r0@82
  _UNKNOWN *v135; // r0@82
  int v136; // r1@82
  int v137; // r0@82
  int v138; // r1@82
  int v139; // r0@82
  _UNKNOWN *v140; // r0@82
  int v141; // r1@82
  int v142; // r0@82
  int v143; // r1@82
  int v144; // r0@82
  int v145; // r1@82
  int v146; // r0@82
  _UNKNOWN *v147; // r4@82
  int v148; // r1@82
  int v149; // r0@82
  _UNKNOWN *v150; // r4@82
  int v151; // r1@82
  int v152; // r0@82
  int v153; // r0@82
  int v154; // r0@83
  _UNKNOWN *v155; // r4@85
  int v156; // r1@85
  int v157; // r0@85
  int v158; // r1@85
  int v159; // r0@85
  int v160; // r1@85
  int v161; // r0@85
  _UNKNOWN *v162; // r4@90
  int v163; // r1@90
  int v164; // r0@90
  _UNKNOWN *v165; // r0@90
  char s; // [sp+18h] [bp-4F0h]@5
  char v167; // [sp+218h] [bp-2F0h]@54
  int v168; // [sp+418h] [bp-F0h]@31
  char v169; // [sp+498h] [bp-70h]@64
  char v170; // [sp+49Dh] [bp-6Bh]@67
  char v171; // [sp+4A2h] [bp-66h]@71
  char v172; // [sp+4A7h] [bp-61h]@74
  char v173; // [sp+4ACh] [bp-5Ch]@62
  char v174; // [sp+4C0h] [bp-48h]@59
  char v175; // [sp+4D4h] [bp-34h]@59

  v1 = a1;
  sub_133E4((int)"natrouterconf", (int)"portforward");
  sub_241E0();
  puts("<script language=JavaScript>");
  puts("function SelectServer()");
  puts("{");
  puts("\tvar F = document.portforward_fm;");
  puts("\tButtonViewControl('modify', document);");
  puts("\t\tF.protocol.value = 'tcp';");
  puts("\t\tF.ext_sport.value = '';\tF.ext_eport.value='';");
  puts("\t\tF.int_sport.value = '';\tF.int_eport.value='';");
  puts("\t\tF.trigger_sport.value = '';\tF.trigger_eport.value='';");
  puts("\t\tF.forward_ports.value = '';");
  puts("\tif(F.sel_server.value == '0') {");
  puts("\tChangeInputForm('user',document);");
  puts("\t\tEnableObj_For_PF(F.protocol);\tEnableObj_For_PF(F.int_sport);\tEnableObj_For_PF(F.int_eport);");
  puts("\t}");
  v2 = fopen("/var/virtsvr_rule", "r");
  if ( v2 )
  {
    v3 = 0;
    v4 = 1;
    while ( 1 )
    {
      v17 = feof(v2);
      if ( v17 || v4 == 11 )
        break;
      memset(&s, 0, 0x200u);
      fgets(&s, 512, v2);
      v5 = strtok(&s, ":");
      v6 = v5;
      if ( v5 )
      {
        printf("\telse if(F.sel_server.value == '%s') {\n", v5);
        puts("\tChangeInputForm('user',document);");
        puts("\t\tF.int_eport.value='';");
        if ( !strcmp(v6, "pptp") )
        {
          puts("\t\tF.protocol.value = 'tcp';");
          puts("\t\tF.ext_sport.value = '1723';\tF.ext_eport.value='';");
          puts("\t\tF.int_sport.value = '1723';\tF.int_eport.value='';");
          puts("\t\tEnableObj_For_PF(F.protocol);\tEnableObj_For_PF(F.int_sport);\tEnableObj_For_PF(F.int_eport);");
        }
        else
        {
          strtok((char *)v17, ":");
          v7 = strtok((char *)v17, ":");
          v8 = atoi(v7);
          strtok((char *)v17, ":");
          strtok((char *)v17, ":");
          strtok((char *)v17, ":");
          v9 = strtok((char *)v17, ":");
          if ( v8 <= 1 )
          {
            printf("\t\tF.protocol.value = '%s';\n", v9);
            v10 = "\t\tEnableObj_For_PF(F.protocol);";
          }
          else
          {
            v10 = "\t\tDisableObj_For_PF(F.protocol);";
          }
          printf(v10);
          strtok(0, ":");
          v11 = strtok(0, ":");
          v12 = v11;
          if ( v8 <= 1 )
          {
            if ( v11 )
            {
              v14 = strchr(v11, 45);
              v3 = v14;
              if ( v14 )
                *v14 = 0;
              printf("\t\tF.int_sport.value = '%s';\n", v12);
            }
            if ( v3 )
              printf("\t\tF.int_eport.value = '%s';\n", v12);
            printf("\t\tEnableObj_For_PF(F.int_sport);");
            v13 = "\t\tEnableObj_For_PF(F.int_eport);";
          }
          else
          {
            puts("\t\tF.int_sport.value = '';");
            puts("\t\tF.int_eport.value = '';");
            printf("\t\tDisableObj_For_PF(F.int_sport);");
            v13 = "\t\tDisableObj_For_PF(F.int_eport);";
          }
          printf(v13);
          strtok(0, ":");
          v15 = strtok(0, ":");
          if ( v8 <= 1 )
          {
            printf("\t\tF.ext_sport.value = '%s';\n", v15);
            puts("\t\tF.ext_eport.value = '';");
            printf("\t\tEnableObj_For_PF(F.ext_sport);");
            v16 = "\t\tEnableObj_For_PF(F.ext_eport);";
          }
          else
          {
            puts("\t\tF.ext_sport.value = '';");
            puts("\t\tF.ext_eport.value = '';");
            printf("\t\tDisableObj_For_PF(F.ext_sport);");
            v16 = "\t\tDisableObj_For_PF(F.ext_eport);";
          }
          printf(v16);
        }
        puts("\t}");
        ++v4;
      }
    }
    fclose(v2);
  }
  puts("\telse if(F.sel_server.value == 'NULL') {");
  puts("\tChangeInputForm('user',document);");
  puts("\t\tF.protocol.value = 'tcp';");
  puts("\t\tF.ext_sport.value = '';\tF.ext_eport.value='';");
  puts("\t\tF.int_sport.value = '';\tF.int_eport.value='';");
  puts("\t\tEnableObj_For_PF(F.protocol);\tEnableObj_For_PF(F.int_sport);\tEnableObj_For_PF(F.int_eport);");
  puts("\t}");
  puts("\telse if(F.sel_server.value == 'trigger') {");
  puts("\tChangeInputForm('trigger',document);");
  puts("\t\tF.protocol.value = 'tcp';");
  puts("\t\tF.ext_sport.value = '';\tF.ext_eport.value='';");
  puts("\t\tF.int_sport.value = '';\tF.int_eport.value='';");
  puts("\t\tEnableObj_For_PF(F.protocol);\tEnableObj_For_PF(F.int_sport);\tEnableObj_For_PF(F.int_eport);");
  puts("\t}");
  puts("}");
  puts("</script>");
  printf("<table class=v3_table>");
  printf("<form method=get action=\"timepro.cgi\" name=\"portforward_fm\">");
  printf("<input type=hidden name=\"tmenu\" value=\"natrouterconf\">");
  printf("<input type=hidden name=\"smenu\" value=\"portforward\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  printf("<input type=hidden name=\"clicked_name\" value=\"\">");
  printf("<input type=hidden name=\"clicked_bg\" value=\"\">");
  printf("<input type=hidden name=\"old_priority\" value=\"\">");
  printf("<input type=hidden name=\"cur_priority\" value=\"\">");
  printf("<input type=hidden name=\"rule_count\" value=\"0\">");
  printf("<tr class=\"pf_tr\"><td colspan=2 width=100%% class=\"pf_td\" style=\"vertical-align:top;\">");
  if ( v1 )
  {
    v19 = (const char *)get_pvalue(v1, "mode");
    v18 = (char *)v19;
    if ( !v19 || !strcmp(v19, "user") )
      goto LABEL_31;
    if ( !strcmp(v18, "all") )
    {
      puts("<input type=\"hidden\" name=\"mode\" value=\"all\">");
      printf("<TABLE width=100%% class=\"pf_table\">");
      printf("<COL WIDTH=\"45\"><COL WIDTH=\"100\"><COL WIDTH=\"140\"><COL WIDTH=\"140\"><COL WIDTH=\"120\"><COL WIDTH=\"%%\">\n");
      printf("<TR height=\"24\" class=\"pf_tr\">");
      v39 = sub_134F4(786, v38);
      printf("<TD class=\"pf_td\"><P align=\"center\" class=\"pf_p\">%s</P></TD>\n", v39);
      v41 = sub_134F4(1139, v40);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v41);
      v43 = sub_134F4(764, v42);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v43);
      v45 = sub_134F4(758, v44);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v45);
      v47 = sub_134F4(760, v46);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v47);
      v48 = sub_126C4();
      v50 = sub_134F4(118, v49);
      printf(
        "<TD class=\"pf_td\"><P align=\"right\" class=\"pf_p\" style=\"margin:0; padding-right:17px;\">\t\t\t<a class=\"pf_a\" style=\"cursor:pointer; padding-bottom:3px;\" onclick=\"onDeleteClicked('user');\">\t\t\t<img src=\"/%s/minus_icon.gif\">%s</a>&nbsp;<input type=\"checkbox\" name=\"alldel_user\" \t\t\tonclick=\"onAllDeleteChecked('user',document,this.checked);\"></P></TD>\n",
        v48,
        v50);
      printf("</TR>");
      printf("<TR style=\"border-collapse:collapse; position:relative; border-top:1px rgba(128,128,128,0.3); solid !important;\t\t\tborder-bottom:1px rgba(128,128,128,0.3); solid !important;\">");
      printf("<TD colspan=\"6\" width=\"100%%\" height=\"216\" class=\"pf_td\">");
      v51 = snprintf2(&v168, 128, "timepro.cgi?tmenu=iframe&smenu=user_portforward&mode=all");
      if ( is_mobile_agent(v51) )
      {
        sub_12790((int)"216", (int)"100%", (int)"display:inline-block");
        v52 = printf(
                "<iframe name=\"user_portforward\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scrolling=yes>\t\t\t\t</iframe>",
                &v168);
        sub_12770(v52);
      }
      else
      {
        printf(
          "<iframe name=\"user_portforward\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scrolling=yes>\t\t\t\t</iframe>",
          &v168);
      }
      printf("</TD></TR>");
      printf("<TR height=\"24\" class=\"pf_tr\">");
      v54 = sub_134F4(786, v53);
      printf("<TD class=\"pf_td\"><P align=\"center\" class=\"pf_p\">%s</P></TD>\n", v54);
      v56 = sub_134F4(1132, v55);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v56);
      v58 = sub_134F4(764, v57);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v58);
      v60 = sub_134F4(758, v59);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v60);
      puts("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\"></P></TD>");
      v61 = sub_126C4();
      v63 = sub_134F4(118, v62);
      v64 = v61;
      v65 = &v168;
      printf(
        "<TD class=\"pf_td\"><P align=\"right\" class=\"pf_p\" style=\"margin:0; padding-right:17px;\">\t\t\t<a class=\"pf_a\" style=\"cursor:pointer; padding-bottom:3px;\" onclick=\"onDeleteClicked('upnp');\">\t\t\t<img src=\"/%s/minus_icon.gif\">%s</a>&nbsp;<input type=\"checkbox\" name=\"alldel_upnp\" \t\t\tonclick=\"onAllDeleteChecked('upnp',document,this.checked);\"></P></TD>\n",
        v64,
        v63);
      printf("</TR>");
      printf("<TR style=\"border-collapse:collapse; position:relative; border-top:1px rgba(128,128,128,0.3); solid !important;\t\t\tborder-bottom:1px rgba(128,128,128,0.3); solid !important;\">");
      printf("<TD colspan=\"6\" width=\"100%%\" height=\"144\" class=\"pf_td\">");
      v66 = snprintf2(&v168, 128, "timepro.cgi?tmenu=iframe&smenu=upnp_portforward&mode=all");
      if ( is_mobile_agent(v66) )
      {
        v67 = (int)"display:inline-block";
        *(_DWORD *)v68 = "144";
LABEL_43:
        sub_12790(*(int *)v68, (int)"100%", v67);
        v36 = v65;
        v37 = "<iframe name=\"upnp_portforward\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scrolling=yes>\t\t\t\t</iframe>";
        goto LABEL_49;
      }
    }
    else
    {
      if ( strcmp(v18, "upnp") )
      {
        result = strcmp(v18, "trigger_status");
        if ( result )
          return result;
        puts("<input type=\"hidden\" name=\"mode\" value=\"trigger_status\">");
        printf("<TABLE width=100%% class=\"pf_table\">");
        printf("<COL WIDTH=\"45\"><COL WIDTH=\"100\"><COL WIDTH=\"140\"><COL WIDTH=\"140\"><COL WIDTH=\"120\"><COL WIDTH=\"%%\">\n");
        printf("<TR height=\"24\" class=\"pf_tr\">");
        v84 = sub_134F4(786, v83);
        printf("<TD class=\"pf_td\"><P align=\"center\" class=\"pf_p\">%s</P></TD>\n", v84);
        v86 = sub_134F4(812, v85);
        printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v86);
        v88 = sub_134F4(764, v87);
        printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v88);
        v90 = sub_134F4(815, v89);
        printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v90);
        v92 = sub_134F4(809, v91);
        printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v92);
        puts("<TD class=\"pf_td\"><P align=\"right\" class=\"pf_p\" style=\"margin:0; padding-right:17px;\"></P></TD>");
        printf("</TR>");
        printf("<TR style=\"border-collapse:collapse; position:relative; border-top:1px rgba(128,128,128,0.3); solid !important;\t\t\tborder-bottom:1px rgba(128,128,128,0.3); solid !important;\">");
        printf("<TD colspan=\"6\" width=\"100%%\" height=\"384\" class=\"pf_td\">");
        v93 = snprintf2(&v168, 128, (const char *)&unk_6D397);
        if ( !is_mobile_agent(v93) )
        {
          v34 = &v168;
          v35 = "<iframe name=\"trigger_portforward\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scrolling=yes>\t\t\t\t</iframe>";
          goto LABEL_50;
        }
        sub_12790((int)"384", (int)"100%", (int)"display:inline-block");
        v37 = "<iframe name=\"trigger_portforward\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scrolling=yes>\t\t\t\t</iframe>";
        v36 = &v168;
        goto LABEL_49;
      }
      puts("<input type=\"hidden\" name=\"mode\" value=\"upnp\">");
      printf("<TABLE width=100%% class=\"pf_table\">");
      printf("<COL WIDTH=\"45\"><COL WIDTH=\"100\"><COL WIDTH=\"140\"><COL WIDTH=\"140\"><COL WIDTH=\"120\"><COL WIDTH=\"%%\">\n");
      printf("<TR height=\"24\" class=\"pf_tr\">");
      v70 = sub_134F4(786, v69);
      printf("<TD class=\"pf_td\"><P align=\"center\" class=\"pf_p\">%s</P></TD>\n", v70);
      v72 = sub_134F4(1139, v71);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v72);
      v74 = sub_134F4(764, v73);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v74);
      v76 = sub_134F4(758, v75);
      printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v76);
      puts("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\"></P></TD>");
      v77 = sub_126C4();
      v79 = sub_134F4(118, v78);
      v80 = v77;
      v65 = &v168;
      printf(
        "<TD class=\"pf_td\"><P align=\"right\" class=\"pf_p\" style=\"margin:0; padding-right:17px;\">\t\t\t<a class=\"pf_a\" style=\"cursor:pointer; padding-bottom:3px;\" onclick=\"onDeleteClicked('upnp');\">\t\t\t<img src=\"/%s/minus_icon.gif\">%s</a>&nbsp;<input type=\"checkbox\" name=\"alldel_upnp\" \t\t\tonclick=\"onAllDeleteChecked('upnp',document,this.checked);\"></P></TD>\n",
        v80,
        v79);
      printf("</TR>");
      printf("<TR style=\"border-collapse:collapse; position:relative; border-top:1px rgba(128,128,128,0.3); solid !important;\t\t\tborder-bottom:1px rgba(128,128,128,0.3); solid !important;\">");
      printf("<TD colspan=\"6\" width=\"100%%\" height=\"384\" class=\"pf_td\">");
      v81 = snprintf2(&v168, 128, (const char *)&unk_6D2B5);
      if ( is_mobile_agent(v81) )
      {
        v67 = (int)"display:inline-block";
        *(_DWORD *)v68 = "384";
        goto LABEL_43;
      }
    }
    v34 = v65;
    v35 = "<iframe name=\"upnp_portforward\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scrolling=yes>\t\t\t\t</iframe>";
    goto LABEL_50;
  }
  v18 = 0;
LABEL_31:
  puts("<input type=\"hidden\" name=\"mode\" value=\"user\">");
  printf("<TABLE width=100%% class=\"pf_table\">");
  printf("<COL WIDTH=\"45\"><COL WIDTH=\"100\"><COL WIDTH=\"140\"><COL WIDTH=\"140\"><COL WIDTH=\"120\"><COL WIDTH=\"%%\">\n");
  printf("<TR height=\"24\" class=\"pf_tr\">");
  v21 = sub_134F4(786, v20);
  printf("<TD class=\"pf_td\"><P align=\"center\" class=\"pf_p\">%s</P></TD>\n", v21);
  v23 = sub_134F4(1139, v22);
  printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v23);
  v25 = sub_134F4(764, v24);
  printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v25);
  v27 = sub_134F4(758, v26);
  printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v27);
  v29 = sub_134F4(760, v28);
  printf("<TD class=\"pf_td\"><P align=\"left\" class=\"pf_p\">%s</P></TD>\n", v29);
  v30 = sub_126C4();
  v32 = sub_134F4(118, v31);
  printf(
    "<TD class=\"pf_td\"><P align=\"right\" class=\"pf_p\" style=\"margin:0; padding-right:17px;\">\t\t\t<a class=\"pf_a\" style=\"cursor:pointer; padding-bottom:3px;\" onclick=\"onDeleteClicked('user');\">\t\t\t<img src=\"/%s/minus_icon.gif\">%s</a>&nbsp;<input type=\"checkbox\" name=\"alldel_user\" \t\t\tonclick=\"onAllDeleteChecked('user',document,this.checked);\"></P></TD>\n",
    v30,
    v32);
  printf("</TR>");
  printf("<TR style=\"border-collapse:collapse; position:relative; border-top:1px rgba(128,128,128,0.3); solid !important;\t\t\tborder-bottom:1px rgba(128,128,128,0.3); solid !important;\">");
  printf("<TD colspan=\"6\" width=\"100%%\" height=\"384\" class=\"pf_td\">");
  v33 = snprintf2(&v168, 128, (const char *)&unk_6CE8C);
  if ( !is_mobile_agent(v33) )
  {
    v34 = &v168;
    v35 = "<iframe name=\"user_portforward\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scrolling=yes>\t\t\t\t</iframe>";
LABEL_50:
    printf(v35, v34);
    goto LABEL_51;
  }
  sub_12790((int)"384", (int)"100%", (int)"display:inline-block");
  v36 = &v168;
  v37 = "<iframe name=\"user_portforward\" src=\"%s\" frameborder=no width=100%% height=100%% align=center scrolling=yes>\t\t\t\t</iframe>";
LABEL_49:
  v94 = printf(v37, v36);
  sub_12770(v94);
LABEL_51:
  printf((const char *)&unk_6450B);
  printf("</td></tr>");
  puts("<tr height=\"100\" class=\"pf_tr\" style=\"background-Color:#eeeeee;\">");
  printf("<td width=557 class=\"pf_td\">");
  printf("<TABLE width=557 class=\"pf_table\">");
  puts("<TR id=\"form_line_1\" height=\"24\" class=\"pf_tr\">");
  puts("<TD width=\"10\" align=\"center\" class=\"pf_td\">");
  v95 = sub_126C4();
  printf("<img src=\"/%s/pf_square_icon.gif\"></TD>\n", v95);
  printf("<TD width=\"70\" class=\"pf_td\">");
  v97 = sub_134F4(866, v96);
  printf("<span class=\"pf_span\">%s</span></TD>", v97);
  printf("<TD width=\"155\" align=\"left\" class=\"pf_td\">");
  printf("<input type=\"text\" name=\"rule_name\" size=\"21\" style=\"width:145px;\" maxlength=\"127\" class=\"pf_textbox\" \t\tonkeydown=\"ButtonViewControl('modify'); return true;\">");
  printf("</TD><TD width=\"160\" align=\"left\" class=\"pf_td\" id=\"SELMENUBOXTD\">");
  printf("<select name=\"sel_server\" class=\"pf_select\" style=\"width:160px;\" onchange=\"SelectServer();\">");
  v99 = sub_134F4(773, v98);
  printf("<option value=\"0\">%s</option>", v99);
  v100 = fopen("/var/virtsvr_rule", "r");
  if ( v100 )
  {
    v18 = 0;
    v101 = 0;
    while ( 1 )
    {
      v103 = feof(v100);
      if ( v103 )
        break;
      memset(&v167, 0, 0x200u);
      fgets(&v167, 512, v100);
      v102 = strtok(&v167, ":");
      v18 = v102;
      if ( v102 )
      {
        v118 = v101++ == 10;
        if ( v118 )
          break;
        printf("<option value=\"%s\">", v102);
        v18 = strtok((char *)v103, ":");
        printf("%s</option>", v18);
      }
    }
    fclose(v100);
  }
  printf("<option value=\"NULL\">---------------------------</option>");
  v105 = sub_134F4(814, v104);
  printf("<option value=\"trigger\">%s</option>", v105);
  printf("</select>");
  printf("</TD><TD width=\"162\" class=\"pf_td\" align=\"left\" id=\"DISABLEBOXTD\">");
  printf("<SPAN class=\"pf_span\">");
  v107 = sub_134F4(785, v106);
  printf(
    "<input type=\"checkbox\" class=\"pf_checkbox\" name=\"disable\" id=\"disable_id\" onclick=\"onCheckedDisable();\">\n\t\t<label for=\"disable_id\">%s</label>\n",
    v107);
  printf("</SPAN>");
  printf("</TD></TR>");
  puts("<TR id=\"form_line_2\" height=\"24\" class=\"pf_tr\">");
  puts("<TD width=\"10\" align=\"center\" class=\"pf_td\">");
  v108 = sub_126C4();
  printf("<img src=\"/%s/pf_square_icon.gif\"></TD>\n", v108);
  printf("<TD width=\"70\" class=\"pf_td\">");
  v110 = sub_134F4(759, v109);
  printf("<span class=\"pf_span\">%s</span></TD>", v110);
  printf("<TD width=\"155\" align=\"left\" class=\"pf_td\">");
  get_ifconfig("br0", &v175, &v174);
  if ( v175 )
    v111 = &v175;
  else
    v111 = "";
  sf_strncpy(&v173, v111, 20);
  if ( v173 )
  {
    v113 = strtok(&v173, ".");
    if ( v113 )
    {
      v114 = &v169;
    }
    else
    {
      v114 = &v169;
      v113 = "0";
    }
    sf_strncpy(v114, v113, 5);
    v115 = strtok(0, ".");
    if ( v115 )
    {
      v116 = &v170;
    }
    else
    {
      v116 = &v170;
      v115 = "0";
    }
    sf_strncpy(v116, v115, 5);
    v117 = strtok(0, ".");
    v119 = v117;
    v118 = v117 == 0;
    if ( v117 )
      v117 = &v171;
    else
      v119 = "0";
    if ( v118 )
      v117 = &v171;
    sf_strncpy(v117, v119, 5);
    sf_strncpy(&v172, &unk_6BDC4, 5);
  }
  else
  {
    v169 = 0;
    v172 = 0;
    v171 = 0;
    v170 = 0;
  }
  v120 = &v169;
  v121 = 1;
  do
  {
    v122 = sub_134F4(401, v112);
    v123 = v120;
    v120 += 5;
    printf(
      "<input type=text name=\"%s%d\" maxlength=3 size=3 style=\"width:34px; ime-mode:disabled;\" class=\"pf_textbox\" value=\"%s\" onfocus=\"this.select();\" onkeypress=\"return IPKeyDown('%s', %d);\" title=\"%s%d\" onkeydown=\"ButtonViewControl('modify'); return true;\" onkeyup=\"IPKeyUp('%s',%d);\">",
      "internal_ip",
      v121,
      v123,
      "internal_ip",
      v121,
      v122,
      v121,
      "internal_ip",
      v121);
    v118 = v121++ == 4;
    if ( !v118 )
      putchar(46);
  }
  while ( v121 != 5 );
  printf("</TD>");
  printf("<TD width=\"322\" colspan=\"2\" class=\"pf_td\" id=\"CURCONNBOXTD\">");
  v124 = printf("<SPAN class=\"pf_span\">");
  v125 = (const char *)get_remote_addr(v124);
  snprintf2(&v175, 20, v125);
  if ( strcmp(&v175, "Twin IP") )
  {
    v127 = sub_134F4(748, v126);
    printf(
      "<input type=\"checkbox\" class=\"pf_checkbox\" name=\"re_ip\" id=\"re_ip_id\" onclick=\"onCheckedReip(this,'internal_ip','%s');\">\n\t\t\t<label for=\"re_ip_id\">%s</label>\n",
      &v175,
      v127);
  }
  printf("</SPAN>");
  printf("</TD>");
  printf("</TR>");
  puts("<TR id=\"form_line_3\" height=\"24\" class=\"pf_tr\">");
  puts("<TD width=\"10\" align=\"center\" class=\"pf_td\">");
  v128 = sub_126C4();
  printf("<img src=\"/%s/pf_square_icon.gif\"></TD>\n", v128);
  printf("<TD width=\"70\" class=\"pf_td\">");
  v130 = sub_134F4(803, v129);
  printf("<span class=\"pf_span\">%s</span></TD>", v130);
  printf("<TD width=\"477\" colspan=\"3\" align=\"left\" class=\"pf_td\">");
  printf("<SPAN class=\"pf_span\" width=\"80\">");
  printf("<select class=\"pf_select\" name=\"protocol\" style=\"width:80px;\" onchange=\"onChangeProtocol(document);\">");
  printf("<option value=\"tcp\">TCP</option>");
  printf("<option value=\"udp\">UDP</option>");
  printf("<option value=\"tcpudp\">TCP/UDP</option>");
  printf("<option value=\"gre\">GRE</option>");
  printf("</select>");
  printf("</SPAN>");
  printf("<SPAN class=\"pf_span\" width=\"146\">");
  v132 = sub_134F4(758, v131);
  printf("<SPAN class=\"pf_span\" style=\"padding:0px 5px 0px 5px;\">%s</SPAN>", v132);
  printf("<input type=\"text\" name=\"ext_sport\" class=\"pf_textbox\" size=5 maxlength=5 style=\"width:42px;\" \t\tonkeydown=\"ButtonViewControl('modify'); return true;\"> ~ ");
  printf("<input type=\"text\" name=\"ext_eport\" class=\"pf_textbox\" size=5 maxlength=5 style=\"width:42px;\" \t\tonkeydown=\"ButtonViewControl('modify'); return true;\">");
  printf("</SPAN>");
  printf("<SPAN class=\"pf_span\" width=\"146\" id=\"INTPORTBOX\">");
  v134 = sub_134F4(760, v133);
  printf("<SPAN class=\"pf_span\" style=\"padding:0px 5px 0px 5px;\">%s</SPAN>", v134);
  printf("<input type=\"text\" name=\"int_sport\" class=\"pf_textbox\" size=5 maxlength=5 style=\"width:42px;\" \t\tonkeydown=\"ButtonViewControl('modify'); return true;\"> ~ ");
  printf("<input type=\"text\" name=\"int_eport\" class=\"pf_textbox\" size=5 maxlength=5 style=\"width:42px;\" \t\tonkeydown=\"ButtonViewControl('modify'); return true;\">");
  printf("</SPAN>");
  printf("</TD>");
  printf("</TR>");
  puts("<TR id=\"form_line_trigger1\" height=\"24\" class=\"pf_tr\" style=\"display:none;\">");
  puts("<TD width=\"10\" align=\"center\" class=\"pf_td\">");
  v135 = sub_126C4();
  printf("<img src=\"/%s/pf_square_icon.gif\"></TD>\n", v135);
  printf("<TD width=\"70\" class=\"pf_td\">");
  v137 = sub_134F4(817, v136);
  printf("<span class=\"pf_span\">%s</span></TD>", v137);
  printf("<TD width=\"155\" align=\"left\" class=\"pf_td\">");
  printf("<select class=\"pf_select\" name=\"trigger_protocol\" style=\"width:80px;\" onchange=\"ButtonViewControl('modify');\">");
  printf("<option value=\"tcp\">TCP</option>");
  printf("<option value=\"udp\">UDP</option>");
  printf("</select>");
  printf("</TD>");
  printf("<TD width=\"322\" colspan=\"2\" class=\"pf_td\" align=\"left\">");
  printf("<SPAN class=\"pf_span\">");
  v139 = sub_134F4(811, v138);
  printf("<SPAN class=\"pf_span\" style=\"padding-right:5px;\">%s</SPAN>", v139);
  printf("<input type=\"text\" name=\"trigger_sport\" class=\"pf_textbox\" size=5 maxlength=5 style=\"width:42px;\" \t\tonkeydown=\"ButtonViewControl('modify'); return true;\"> ~ ");
  printf("<input type=\"text\" name=\"trigger_eport\" class=\"pf_textbox\" size=5 maxlength=5 style=\"width:42px;\" \t\tonkeydown=\"ButtonViewControl('modify'); return true;\">");
  printf("</SPAN>");
  printf("</TD>");
  printf("</TR>");
  puts("<TR id=\"form_line_trigger2\" height=\"24\" class=\"pf_tr\" style=\"display:none;\">");
  puts("<TD width=\"10\" align=\"center\" class=\"pf_td\">");
  v140 = sub_126C4();
  printf("<img src=\"/%s/pf_square_icon.gif\"></TD>\n", v140);
  printf("<TD width=\"70\" class=\"pf_td\">");
  v142 = sub_134F4(810, v141);
  printf("<span class=\"pf_span\">%s</span></TD>", v142);
  printf("<TD width=\"155\" align=\"left\" class=\"pf_td\">");
  printf("<select class=\"pf_select\" name=\"forward_protocol\" style=\"width:80px;\" onchange=\"ButtonViewControl('modify');\">");
  printf("<option value=\"tcp\">TCP</option>");
  printf("<option value=\"udp\">UDP</option>");
  printf("</select>");
  printf("</TD>");
  printf("<TD width=\"322\" colspan=\"2\" class=\"pf_td\" align=\"left\">");
  v144 = sub_134F4(811, v143);
  printf("<SPAN class=\"pf_span\" style=\"padding-right:5px;\">%s</SPAN>", v144);
  printf("<input type=\"text\" name=\"forward_ports\" class=\"pf_textbox\" size=26 maxlength=127 style=\"width:160px;\" \t\tonkeydown=\"ButtonViewControl('modify'); return true;\">");
  printf("</TD>");
  printf("</TR>");
  printf("</TABLE>");
  printf("</td>");
  puts("<td width=\"85\" align=\"right\" height=\"100\" class=\"pf_td\" id=\"PRIORITYBOX\">");
  puts("<TABLE class=\"pf_table\" style=\"width:85px;\">");
  printf("<TR class=\"pf_tr\" style=\"height:24px;\">");
  puts("<TD class=\"pf_td\" align=\"right\">");
  puts("<SPAN class=\"pf_span\">");
  v146 = sub_134F4(787, v145);
  printf(
    "%s <input type=\"text\" name=\"priority\" class=\"pf_textbox\"                 size=3 maxlength=3 style=\"width:37px;\" onchange=\"onChangedPriority(%d);\">",
    v146,
    100);
  puts("</SPAN>");
  printf("</TD>");
  printf("</TR>");
  printf("<TR class=\"pf_tr\" style=\"height:24px;\">");
  puts("<TD class=\"pf_td\" align=\"right\">");
  printf("<button type=\"button\" name=\"pri_up\" class=\"pf_button\" style=\"width:80px; text-align: left; padding-left: 5px; white-space:nowrap;\" onclick=\"onRowUpClicked();\">");
  v147 = sub_126C4();
  v149 = sub_134F4(768, v148);
  printf("<img src=\"/%s/fw_up.gif\" style='margin: 0 2px 1px 0;'>%s</button>", v147, v149);
  printf("</TD>");
  printf("</TR>");
  printf("<TR class=\"pf_tr\" style=\"height:24px;\">");
  puts("<TD class=\"pf_td\" align=\"right\">");
  printf("<button type=\"button\" name=\"pri_down\" class=\"pf_button\" style=\"width:80px; text-align: left; padding-left: 5px; white-space:nowrap;\" onclick=\"onRowDownClicked();\">");
  v150 = sub_126C4();
  v152 = sub_134F4(767, v151);
  printf("<img src=\"/%s/fw_down.gif\" style='margin: 0 2px 1px 0;'>%s</button>", v150, v152);
  printf("</TD>");
  printf("</TR>");
  printf("<TR class=\"pf_tr\" style=\"height:24px;\">");
  puts("<TD class=\"pf_td\" align=\"right\">");
  printf("&nbsp;");
  printf("</TD>");
  printf("</TR>");
  printf("</TABLE>");
  printf("</td></tr>");
  puts("<tr id=\"form_line_5\" height=\"26\" class=\"pf_tr\">");
  puts("<td colspan=2 class=\"pf_td\" align=\"center\">");
  printf("<TABLE class=\"pf_table\" width=\"100%%\">\n");
  puts("<TD class=\"pf_td\" width=\"466\">");
  v153 = snprintf2(&v168, 256, (const char *)&unk_6E69B);
  if ( is_mobile_agent(v153) )
  {
    sub_12790((int)"26", (int)"466", (int)"display:inline-block; vertical-align:middle;");
    v154 = printf(
             "<iframe name=\"restore_iframe\" src=\"%s\" frameborder=no width=466 height=26 align=center scrolling=no></iframe>",
             &v168);
    sub_12770(v154);
  }
  else
  {
    printf(
      "<iframe name=\"restore_iframe\" src=\"%s\" frameborder=no width=466 height=26 align=center scrolling=no></iframe>",
      &v168);
  }
  puts("</TD>");
  puts("<TD class=\"pf_td\" align=\"right\" style=\"padding-right:5px;\">");
  puts("<button type=\"button\" class=\"pf_button\" name=\"new_rule_btn\" style=\"width:65px;\" onclick=\"onNewRuleBtnClicked();\">");
  v155 = sub_126C4();
  v157 = sub_134F4(740, v156);
  printf("<img src=\"/%s/pf_plus_icon.gif\"> %s\n", v155, v157);
  puts("</button>");
  memset(&v175, 0, 0x14u);
  get_ifconfig("br0", &v175, &v174);
  printf(
    "<button type=\"button\" class=\"pf_button\" name=\"apply_btn\" style=\"width:45px;\" onclick=\"onApplyBtnClicked('%s','%s',%d);\">\n",
    &v175,
    &v174,
    100);
  v159 = sub_134F4(28, v158);
  puts((const char *)v159);
  puts("</button>");
  puts("<button type=\"button\" class=\"pf_button\" name=\"cancel_btn\" style=\"width:45px;\" onclick=\"onCancelBtnClicked();\">");
  v161 = sub_134F4(47, v160);
  puts((const char *)v161);
  puts("</button>");
  puts("</TD>");
  puts("</TABLE>");
  puts("</td>");
  puts("</tr>");
  puts("<tr id=\"form_line_blank\" height=\"26\" class=\"pf_tr\" style=\"display:none;\">");
  puts("<td colspan=2 class=\"pf_td\" align=\"center\">");
  printf("</td></tr>");
  printf("</form>");
  puts("</table>");
  if ( v1 )
    v18 = (char *)get_pvalue(v1, "mode");
  if ( v18 )
  {
    if ( !strcmp(v18, "upnp") )
    {
      printf("<SCRIPT>");
      printf("var obj = parent.frames[3].document.getElementById('pf_select_menu');");
      printf("if(obj){");
      printf("obj.value = 'upnp';");
      putchar(125);
      printf("</SCRIPT>");
    }
  }
  printf(
    "<DIV ID=\"%s\" style=\"position:absolute; left:%dpx; top:%dpx; width:%dpx; height:%dpx; z-index:1; background-color:#ffffff;                 opacity:1.0; display:none;\">\n",
    "restore_mask");
  printf("<table width=\"%d\" height=\"%d\">\n", 642, 536);
  printf("<tr><td width=\"100%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"height:30px; vertical-align:middle; display:block; text-align:center;\">");
  v162 = sub_126C4();
  v164 = sub_134F4(765, v163);
  printf("<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; vertical-align:middle;\">%s", v162, v164);
  printf("</SPAN></td></tr></table></DIV>");
  printf(
    "<DIV ID=\"%s\" style=\"position:absolute; left:%dpx; top:%dpx; width:%dpx; height:%dpx; z-index:1; background-color:#ffffff;                 opacity:1.0; display:none;\">\n",
    "apply_mask");
  printf("<table width=\"%d\" height=\"%d\">\n", 642, 536);
  printf("<tr><td width=\"100%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"height:30px; vertical-align:middle; display:block; text-align:center;\">");
  v165 = sub_126C4();
  printf("<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; vertical-align:middle;\">", v165);
  printf("</SPAN></td></tr></table></DIV>");
  printf(
    "<DIV ID=\"%s\" style=\"position:absolute; left:%dpx; top:%dpx; width:%dpx; height:%dpx; z-index:1; background-color:#ffffff;                 opacity:0.4; display:none;\">\n",
    "fixed_mask",
    0,
    408,
    642,
    128);
  printf("<table width=\"%d\" height=\"%d\">\n", 642, 128);
  printf("<tr><td width=\"100%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"height:30px; vertical-align:middle; display:block; text-align:center;\">");
  return printf("</SPAN></td></tr></table></DIV>");
}
// E7F8: using guessed type int __fastcall get_remote_addr(_DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F74C: using guessed type int __fastcall is_mobile_agent(_DWORD);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);

//----- (00025B30) --------------------------------------------------------
signed int __fastcall sub_25B30(int a1)
{
  int v1; // r4@1
  signed int result; // r0@1

  v1 = a1;
  result = sub_12380();
  if ( !result )
    result = sub_244BC(v1);
  return result;
}

//----- (00025B50) --------------------------------------------------------
int __fastcall sub_25B50(int result, int a2)
{
  int v2; // r8@1
  int v3; // r7@1
  int v4; // r10@1
  int v5; // r9@2
  int v6; // r5@2
  int v7; // r4@2
  int v8; // r6@6
  int v9; // r4@6
  int v10; // r5@7
  char *v11; // r0@12
  const char *v12; // r2@12
  char *v13; // r3@12
  int v14; // r4@14
  char *v15; // r0@17
  const char *v16; // r2@17
  char *v17; // r3@17
  int v18; // [sp+0h] [bp-378h]@12
  int v19; // [sp+4h] [bp-374h]@11
  char s; // [sp+1Ch] [bp-35Ch]@2
  char v21; // [sp+21Ch] [bp-15Ch]@11
  char v22; // [sp+31Ch] [bp-5Ch]@11
  char v23; // [sp+33Ch] [bp-3Ch]@11

  v2 = *(_DWORD *)(result + 536);
  v3 = result;
  v4 = a2;
  if ( v2 )
  {
    memset(&s, 0, 0x200u);
    v5 = v2;
    v6 = v2;
    v7 = 0;
    do
    {
      ++v7;
      if ( *(_DWORD *)(v6 + 24) )
        snprintf2(&s, 512, "%s%d ", &s, *(_DWORD *)(v6 + 24));
      v6 += 4;
    }
    while ( v7 != 10 );
    v8 = v3 + 4;
    printf("<TR height=\"24\" id=\"%s\" class=\"pf_tr\" style=\"cursor:pointer; background-color:#%s;\" ", v3 + 4);
    v9 = (int)"false";
    if ( *(_BYTE *)(v3 + 517) )
      v10 = (int)"true";
    else
      v10 = (int)"false";
    if ( !*(_BYTE *)(v3 + 516) )
      v9 = (int)"true";
    printf(
      "onclick=\"onClickedPFRule('trigger_status','%s','','','%s','','','','','%d','%d','%s','%s',%s,'%d','', %s)\">\n",
      v8,
      v2,
      *(_DWORD *)(v2 + 8),
      *(_DWORD *)(v2 + 12),
      v2 + 16,
      &s,
      v9,
      v4,
      v10);
    printf(
      "<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"30\" style=\"color:%s; padding-left:5px;\">%d</TD>\n",
      &v23,
      v4);
    puts("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"100\">");
    printf("<a name=\"%s\" title=\"%s\" class=\"pf_a\" style=\"width:80px; color:%s;\">%s</a>\n", v8, v8, &v23, v8);
    puts("</TD>");
    printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v23);
    memset(&v21, 0, 0x100u);
    memset(&v22, 0, 0x20u);
    snprintf2(&v21, 256, "%s", v2 + 64);
    printf("<SPAN style=\"width:140px;\" class=\"pf_overflowable\" title=\"%s\">%s</SPAN></TD>\n", &v21, &v21);
    printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v23);
    sf_strncpy(&v22, v2, 32);
    sub_240B8((int)&v22);
    snprintf2(&v21, 256, "%s", &v22);
    if ( *(_DWORD *)(v2 + 12) )
    {
      v11 = &v21;
      v12 = "%s(%d~%d)";
      v13 = &v21;
      v18 = *(_DWORD *)(v2 + 8);
      v19 = *(_DWORD *)(v2 + 12);
    }
    else
    {
      v12 = "%s(%d)";
      v11 = &v21;
      v13 = &v21;
      v18 = *(_DWORD *)(v2 + 8);
    }
    snprintf2(v11, 256, v12, v13, v18, v19);
    printf("<SPAN style=\"width:140px;\" class=\"pf_overflowable\" title=\"%s\">%s</SPAN></TD>\n", &v21, &v21);
    printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v23);
    memset(&v21, 0, 0x100u);
    memset(&v22, 0, 0x20u);
    sf_strncpy(&v22, v2 + 16, 32);
    sub_240B8((int)&v22);
    snprintf2(&v21, 256, "%s(", &v22);
    v14 = 0;
    do
    {
      v15 = &v21;
      v16 = "%s%d";
      v17 = &v21;
      if ( !*(_DWORD *)(v5 + 24) )
        break;
      if ( v14 != 9 )
      {
        if ( *(_DWORD *)(v5 + 28) )
        {
          v15 = &v21;
          v16 = "%s%d,";
          v17 = &v21;
        }
      }
      ++v14;
      snprintf2(v15, 256, v16, v17, *(_DWORD *)(v5 + 24));
      v5 += 4;
    }
    while ( v14 != 10 );
    snprintf2(&v21, 256, "%s)", &v21);
    printf("<SPAN style=\"width:140px;\" class=\"pf_overflowable\" title=\"%s\">%s</SPAN></TD>\n", &v21, &v21);
    printf("<TD height=\"24\" align=\"right\" class=\"pf_td\" style=\"color:%s;\">\n", &v23);
    result = puts((const char *)&unk_6EF65);
  }
  return result;
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);

//----- (00025EB0) --------------------------------------------------------
int __fastcall sub_25EB0(int a1, int a2)
{
  int v2; // r9@1
  int v3; // r10@1
  char *v4; // r0@3
  int v5; // r1@3
  int result; // r0@5
  int v7; // r11@5
  int v8; // r12@6
  int v9; // lr@7
  int v10; // ST18_4@11
  int v11; // ST08_4@11
  int v12; // ST0C_4@11
  int v13; // ST10_4@11
  int v14; // ST14_4@11
  int v15; // lr@11
  char v16; // [sp+34h] [bp-15Ch]@11
  char v17; // [sp+134h] [bp-5Ch]@11
  char v18; // [sp+154h] [bp-3Ch]@3

  v2 = a1;
  v3 = a2;
  if ( *(_BYTE *)(a1 + 516) && *(_BYTE *)(a1 + 524) != 1 )
  {
    v4 = &v18;
    v5 = (int)"#000000";
  }
  else
  {
    v5 = (int)"#B4B4B4";
    v4 = &v18;
  }
  result = sf_strncpy(v4, v5, 20);
  v7 = *(_DWORD *)(v2 + 532);
  if ( v7 )
  {
    v8 = (int)"false";
    if ( *(_BYTE *)(v2 + 517) )
      v9 = (int)"true";
    else
      v9 = (int)"false";
    if ( !*(_BYTE *)(v2 + 516) )
      v8 = (int)"true";
    v10 = v8;
    v11 = *(_DWORD *)(v7 + 8);
    v12 = *(_DWORD *)(v7 + 12);
    v13 = *(_DWORD *)(v7 + 16);
    v14 = *(_DWORD *)(v7 + 20);
    printf(
      "<TR height=\"24\" id=\"%s\" class=\"pf_tr\" style=\"cursor:pointer; background-color:#%s;\" \t\tonclick=\"onClickedPFRule('upnp','%s','','%s','%s','%d','%d','%d','%d','','','','',%s,'%d','%d',%s);\">\n",
      v2 + 4);
    printf(
      "<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"30\" style=\"color:%s; padding-left:5px;\">%d</TD>\n",
      &v18,
      v3);
    puts("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"100\">");
    printf(
      "<a name=\"%s\" title=\"%s\" class=\"pf_a\" style=\"width:80px; color:%s;\">%s</a>\n",
      v2 + 4,
      v2 + 4,
      &v18,
      v2 + 4,
      v7,
      v11,
      v12,
      v13,
      v14,
      v10,
      v3,
      1,
      v9);
    puts("</TD>");
    printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v18);
    memset(&v16, 0, 0x100u);
    memset(&v17, 0, 0x20u);
    snprintf2(&v16, 256, "%s", v7 + 24);
    printf("<SPAN style=\"width:140px;\" class=\"pf_overflowable\" title=\"%s\">%s</SPAN></TD>\n", &v16, &v16);
    printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v18);
    memset(&v16, 0, 0x100u);
    memset(&v17, 0, 0x20u);
    sf_strncpy(&v17, v7, 32);
    sub_240B8((int)&v17);
    v15 = *(_DWORD *)(v7 + 12);
    if ( v15 )
      snprintf2(&v16, 256, (const char *)&unk_6F03E, &v16, &v17, *(_DWORD *)(v7 + 8), v15);
    else
      snprintf2(&v16, 256, (const char *)&unk_6F04A, &v16, &v17, *(_DWORD *)(v7 + 8));
    printf("<SPAN style=\"width:140px;\" class=\"pf_overflowable\" title=\"%s\">%s</SPAN></TD>\n");
    printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v18);
    puts((const char *)&unk_6F053);
    printf("<TD height=\"24\" align=\"right\" class=\"pf_td\" style=\"color:%s; %s\">\n", &v18);
    *(_BYTE *)(v2 + 517);
    printf("<input type=\"checkbox\" name=\"delcheck\" value=\"%s/%d\" %s>\n", v7, *(_DWORD *)(v7 + 8));
    result = puts((const char *)&unk_6EF65);
  }
  return result;
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);

//----- (00026180) --------------------------------------------------------
int __fastcall sub_26180(int a1, int a2, int a3)
{
  int v3; // r11@1
  int v4; // r9@1
  int v5; // r8@1
  int v6; // r10@1
  char *v7; // r0@3
  int v8; // r1@3
  int result; // r0@5
  bool v10; // zf@5
  int v11; // r12@11
  int v12; // lr@12
  int v13; // r5@17
  int v14; // r4@17
  int v15; // lr@21
  int v16; // r4@22
  int v17; // r1@29
  int v18; // r0@29
  char *v19; // r0@30
  const char *v20; // r2@30
  char *v21; // r3@30
  char *v22; // r0@35
  const char *v23; // r2@35
  char *v24; // r3@35
  int v25; // lr@36
  int v26; // r5@40
  int v27; // r4@40
  char *v28; // r0@43
  const char *v29; // r2@43
  char *v30; // r3@43
  char *v31; // r0@49
  char *v32; // r3@49
  const char *v33; // r2@49
  char *v34; // r0@52
  char *v35; // r3@52
  const char *v36; // r2@52
  int v37; // r5@55
  int v38; // r4@55
  char *v39; // r0@58
  const char *v40; // r2@58
  char *v41; // r3@58
  int v42; // [sp+0h] [bp-390h]@30
  char *v43; // [sp+0h] [bp-390h]@35
  int v44; // [sp+0h] [bp-390h]@52
  int v45; // [sp+4h] [bp-38Ch]@16
  int v46; // [sp+28h] [bp-368h]@1
  int v47; // [sp+2Ch] [bp-364h]@8
  char s; // [sp+34h] [bp-35Ch]@17
  char v49; // [sp+234h] [bp-15Ch]@27
  char v50; // [sp+334h] [bp-5Ch]@27
  char v51; // [sp+354h] [bp-3Ch]@3

  v3 = a2;
  v46 = a1;
  v4 = a3;
  v5 = *(_DWORD *)(a2 + 532);
  v6 = *(_DWORD *)(a2 + 536);
  if ( *(_BYTE *)(a2 + 516) && *(_BYTE *)(a2 + 524) != 1 )
  {
    v7 = &v51;
    v8 = (int)"#000000";
  }
  else
  {
    v8 = (int)"#B4B4B4";
    v7 = &v51;
  }
  result = sf_strncpy(v7, v8, 20);
  v10 = v5 == 0;
  if ( !v5 )
    v10 = v6 == 0;
  if ( !v10 )
  {
    v47 = v3 + 4;
    printf("<TR height=\"24\" id=\"%s\" class=\"pf_tr\" style=\"cursor:pointer; background-color:#%s;\" ", v47);
    if ( v46 == 1 )
    {
      v11 = (int)"true";
      if ( *(_BYTE *)(v3 + 516) )
        v12 = (int)"false";
      else
        v12 = (int)"true";
      if ( !*(_BYTE *)(v3 + 517) )
        v11 = (int)"false";
      printf(
        "onclick=\"onClickedPFRule('user','%s','0','%s','%s','%d','%d','%d','%d','','','','',%s,'%d','%d', %s)\">\n",
        v47,
        v5 + 24,
        v5,
        *(_DWORD *)(v5 + 8),
        *(_DWORD *)(v5 + 12),
        *(_DWORD *)(v5 + 16),
        *(_DWORD *)(v5 + 20),
        v12,
        v4,
        1,
        v11);
    }
    else
    {
      memset(&s, 0, 0x200u);
      v13 = 0;
      v14 = v6;
      do
      {
        ++v13;
        if ( *(_DWORD *)(v14 + 24) )
          snprintf2(&s, 512, "%s%d ", &s, *(_DWORD *)(v14 + 24));
        v14 += 4;
      }
      while ( v13 != 10 );
      v15 = (int)"true";
      if ( *(_BYTE *)(v3 + 516) )
        v16 = (int)"false";
      else
        v16 = (int)"true";
      if ( !*(_BYTE *)(v3 + 517) )
        v15 = (int)"false";
      printf(
        "onclick=\"onClickedPFRule('trigger','%s','trigger','','%s','','','','','%d','%d','%s','%s',%s,'%d','', %s)\">\n",
        v47,
        v6,
        *(_DWORD *)(v6 + 8),
        *(_DWORD *)(v6 + 12),
        v6 + 16,
        &s,
        v16,
        v4,
        v15);
    }
    printf(
      "<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"30\" style=\"color:%s; padding-left:5px;\">%d</TD>\n",
      &v51,
      v4);
    puts("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"100\">");
    printf("<a name=\"%s\" title=\"%s\" class=\"pf_a\" style=\"width:80px; color:%s;\">%s</a>\n", v47);
    puts("</TD>");
    printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v51);
    memset(&v49, 0, 0x100u);
    memset(&v50, 0, 0x20u);
    if ( v46 == 1 )
    {
      snprintf2(&v49, 256, "%s", v5 + 24, v47);
    }
    else
    {
      sf_strncpy(&v50, v6, 32);
      sub_240B8((int)&v50);
      v18 = sub_134F4(816, v17);
      snprintf2(&v49, 256, "%s-%s", v18, &v50);
      if ( *(_DWORD *)(v6 + 12) )
      {
        v19 = &v49;
        v20 = "%s(%d~%d)";
        v21 = &v49;
        v42 = *(_DWORD *)(v6 + 8);
        v45 = *(_DWORD *)(v6 + 12);
      }
      else
      {
        v20 = "%s(%d)";
        v19 = &v49;
        v21 = &v49;
        v42 = *(_DWORD *)(v6 + 8);
      }
      snprintf2(v19, 256, v20, v21, v42, v45);
    }
    printf("<SPAN style=\"width:140px;\" class=\"pf_overflowable\" title=\"%s\">%s</SPAN></TD>\n", &v49, &v49);
    printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v51);
    memset(&v49, 0, 0x100u);
    memset(&v50, 0, 0x20u);
    if ( v46 == 1 )
    {
      sf_strncpy(&v50, v5, 32);
      sub_240B8((int)&v50);
      if ( !strcmp((const char *)v5, "gre") )
      {
        v22 = &v49;
        v23 = "%s%s";
        v24 = &v49;
        v43 = &v50;
      }
      else
      {
        v25 = *(_DWORD *)(v5 + 12);
        if ( v25 )
        {
          snprintf2(&v49, 256, (const char *)&unk_6F03E, &v49, &v50, *(_DWORD *)(v5 + 8), v25);
          goto LABEL_47;
        }
        v23 = (const char *)&unk_6F04A;
        v43 = &v50;
        v22 = &v49;
        v24 = &v49;
        v45 = *(_DWORD *)(v5 + 8);
      }
      snprintf2(v22, 256, v23, v24, v43, v45);
    }
    else
    {
      sf_strncpy(&v50, v6 + 16, 32);
      sub_240B8((int)&v50);
      snprintf2(&v49, 256, "%s(", &v50);
      v26 = v6;
      v27 = 0;
      do
      {
        v28 = &v49;
        v29 = "%s%d";
        v30 = &v49;
        if ( !*(_DWORD *)(v26 + 24) )
          break;
        if ( v27 != 9 && *(_DWORD *)(v26 + 28) )
        {
          v28 = &v49;
          v29 = "%s%d,";
          v30 = &v49;
        }
        ++v27;
        snprintf2(v28, 256, v29, v30, *(_DWORD *)(v26 + 24));
        v26 += 4;
      }
      while ( v27 != 10 );
      snprintf2(&v49, 256, "%s)", &v49);
    }
LABEL_47:
    printf("<SPAN style=\"width:140px;\" class=\"pf_overflowable\" title=\"%s\">%s</SPAN></TD>\n", &v49, &v49);
    printf("<TD height=\"24\" align=\"left\" class=\"pf_td\" width=\"140\" style=\"color:%s;\">\n", &v51);
    memset(&v49, 0, 0x100u);
    memset(&v50, 0, 0x20u);
    if ( v46 == 1 )
    {
      sf_strncpy(&v50, v5, 32);
      sub_240B8((int)&v50);
      if ( strcmp((const char *)v5, "gre") )
      {
        if ( *(_DWORD *)(v5 + 16) )
        {
          if ( *(_DWORD *)(v5 + 20) )
          {
            v34 = &v49;
            v35 = &v50;
            v36 = "%s(%d~%d)";
            v44 = *(_DWORD *)(v5 + 16);
            v45 = *(_DWORD *)(v5 + 20);
          }
          else
          {
            v36 = "%s(%d)";
            v34 = &v49;
            v35 = &v50;
            v44 = *(_DWORD *)(v5 + 16);
          }
          snprintf2(v34, 256, v36, v35, v44, v45);
        }
        goto LABEL_63;
      }
      v31 = &v49;
      v32 = &v50;
      v33 = "%s";
    }
    else
    {
      sf_strncpy(&v50, v6 + 16, 32);
      sub_240B8((int)&v50);
      snprintf2(&v49, 256, "%s(", &v50);
      v37 = v6;
      v38 = 0;
      do
      {
        v39 = &v49;
        v40 = "%s%d";
        v41 = &v49;
        if ( !*(_DWORD *)(v37 + 24) )
          break;
        if ( v38 != 9 && *(_DWORD *)(v37 + 28) )
        {
          v39 = &v49;
          v40 = "%s%d,";
          v41 = &v49;
        }
        ++v38;
        snprintf2(v39, 256, v40, v41, *(_DWORD *)(v37 + 24));
        v37 += 4;
      }
      while ( v38 != 10 );
      v31 = &v49;
      v33 = "%s)";
      v32 = &v49;
    }
    snprintf2(v31, 256, v33, v32);
LABEL_63:
    printf("<SPAN style=\"width:140px;\" class=\"pf_overflowable\" title=\"%s\">%s</SPAN></TD>\n");
    printf("<TD height=\"24\" align=\"right\" class=\"pf_td\" style=\"color:%s; %s\">\n", &v51);
    *(_BYTE *)(v3 + 517);
    printf("<input type=\"checkbox\" name=\"delcheck\" value=\"%s\" %s>\n", v47);
    result = puts((const char *)&unk_6EF65);
  }
  return result;
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);

//----- (00026808) --------------------------------------------------------
FILE *__fastcall sub_26808(int a1, int a2)
{
  FILE *result; // r0@1
  FILE *v3; // r4@1
  char v4; // [sp+8h] [bp-90h]@1
  void *ptr; // [sp+88h] [bp-10h]@1
  size_t n; // [sp+8Ch] [bp-Ch]@1

  n = 0;
  get_value_post_multipart_file(a2, "pf_restore_file", &ptr, &v4);
  result = fopen("/tmp/user_pf.set.tmp", "w+");
  v3 = result;
  if ( result )
  {
    fwrite(ptr, 1u, n, result);
    result = (FILE *)fclose(v3);
  }
  return result;
}
// F128: using guessed type int __fastcall get_value_post_multipart_file(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00026880) --------------------------------------------------------
int __fastcall sub_26880(int a1)
{
  int v1; // r6@1
  int v2; // r5@1
  int i; // r4@1
  bool v4; // nf@9
  unsigned __int8 v5; // vf@9
  int v7; // [sp+0h] [bp-20h]@1
  int v8; // [sp+4h] [bp-1Ch]@1
  int v9; // [sp+8h] [bp-18h]@1
  int v10; // [sp+Ch] [bp-14h]@1

  v7 = a1;
  v10 = 0;
  v8 = 0;
  v9 = 0;
  sub_133E4((int)"natrouterconf", (int)"portforward");
  sub_241E0();
  printf("<BODY style=\"padding:0px 0px 0px 0px; margin:0px 0px 0px 0px;\">");
  printf("<form method=post action=\"timepro.cgi\" name=\"trigger_portforward_fm\" style=\"margin:0px 0px 0px 0px; padding:0px 0px 0px 0px;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"trigger_portforward\">");
  printf("<table style=\"table-layout:fixed; border-collapse:collapse; border-style:none none none none; width:100%%;\">\n");
  printf("<COL WIDTH=\"45\"><COL WIDTH=\"100\"><COL WIDTH=\"140\"><COL WIDTH=\"140\"><COL WIDTH=\"120\"><COL WIDTH=\"%%\">\n");
  v1 = 0;
  portforward_read_db("user_pf", &v8);
  v2 = 0;
  for ( i = v8; i; i = *(_DWORD *)i )
  {
    if ( *(_DWORD *)(i + 528) == 1 && *(_BYTE *)(*(_DWORD *)(i + 536) + 64) )
    {
      ++v2;
      ++v1;
      sub_25B50(i, v2);
    }
  }
  while ( 1 )
  {
    ++v2;
    v5 = __OFSUB__(i, 16 - v1);
    v4 = i++ - (16 - v1) < 0;
    if ( !(v4 ^ v5) )
      break;
    sub_240E4();
  }
  printf((const char *)&unk_6FFDC);
  puts("<SCRIPT language=\"javascript\">");
  puts("parent.UnMaskIt(parent.document,'apply_mask');");
  printf("onClickedPFRule('trigger_status','','','','','','','','','','','','','','','');");
  printf("</SCRIPT>");
  printf("</BODY>");
  free_portforward_list(&v8);
  return v7;
}
// FBB4: using guessed type int __fastcall portforward_read_db(_DWORD, _DWORD);
// FC80: using guessed type int __fastcall free_portforward_list(_DWORD);

//----- (000269C4) --------------------------------------------------------
signed int __fastcall sub_269C4(const char *a1, const char *a2, int a3, signed int a4)
{
  const char *v4; // r6@1
  int v5; // r8@1
  signed int v6; // r7@1
  const char *v7; // r4@2
  size_t v8; // r5@2
  char *v9; // r0@4
  const char *v10; // r4@7
  size_t v11; // r0@7
  size_t v12; // r6@9
  void *v13; // r5@14
  signed int v14; // r2@14
  int v15; // r1@15
  int v16; // r3@17
  signed int result; // r0@20

  v4 = a2;
  v5 = a3;
  v6 = a4;
  if ( !a1 )
    goto LABEL_21;
  v7 = a1;
  v8 = strlen(a2);
  while ( strncmp(v7, v4, v8) )
  {
    v9 = strchr(v7, 38);
    v7 = v9 + 1;
    if ( !v9 )
      goto LABEL_21;
  }
  if ( !v7 )
    goto LABEL_21;
  v10 = &v7[v8 + 1];
  v11 = (size_t)strchr(v10, 38);
  if ( !v11 )
    v11 = (size_t)&v10[strlen(v10)];
  v12 = v11 - (_DWORD)v10;
  if ( (const char *)v11 != v10 )
  {
    if ( v6 <= (signed int)v12 )
      v12 = v6 - 1;
    if ( strchr(v10, 37) )
      v12 *= 3;
    v13 = malloc(v12 + 1);
    memcpy(v13, v10, v12);
    *((_BYTE *)v13 + v12) = 0;
    v14 = 0;
    while ( v14 < (signed int)v12 )
    {
      v15 = (int)((char *)v13 + v14);
      if ( *((_BYTE *)v13 + v14) == 43 )
        *((_BYTE *)v13 + v14) = 32;
      v16 = *((_BYTE *)v13 + v14++);
      if ( v16 == 38 )
      {
        *(_BYTE *)v15 = 0;
        break;
      }
    }
    decode_string(v13);
    sf_strncpy(v5, v13, v6);
    free(v13);
    result = 1;
  }
  else
  {
LABEL_21:
    result = 0;
  }
  return result;
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// EC24: using guessed type int __fastcall decode_string(_DWORD);

//----- (00026B04) --------------------------------------------------------
int __fastcall sub_26B04(int a1, char *s, int a3, int a4, int a5)
{
  char *v5; // r7@1
  int v6; // r8@1
  int v7; // r9@1
  int v8; // r4@2
  int v9; // r5@2
  size_t v10; // r6@2
  char *v11; // r0@6
  const char *v12; // r4@9
  size_t v13; // r0@9
  int v14; // r6@11
  void *v15; // r5@16
  int v16; // r2@16
  int v17; // r1@17
  int v18; // r3@19

  v5 = s;
  v6 = a3;
  v7 = a4;
  if ( !a1 )
    return 0;
  v8 = a1;
  v9 = 0;
  v10 = strlen(s);
  while ( strncmp((const char *)v8, v5, v10) )
  {
LABEL_6:
    v11 = strchr((const char *)v8, 38);
    v8 = (int)(v11 + 1);
    if ( !v11 )
      return 0;
  }
  if ( v9 != v6 )
  {
    ++v9;
    goto LABEL_6;
  }
  if ( !v8 )
    return 0;
  v12 = (const char *)(v8 + v10 + 1);
  v13 = (size_t)strchr(v12, 38);
  if ( !v13 )
    v13 = (size_t)&v12[strlen(v12)];
  v14 = v13 - (_DWORD)v12;
  if ( (const char *)v13 == v12 )
    return 0;
  if ( a5 <= v14 )
    v14 = a5 - 1;
  if ( strchr(v12, 37) )
    v14 *= 3;
  v15 = malloc(v14 + 1);
  memcpy(v15, v12, v14);
  *((_BYTE *)v15 + v14) = 0;
  v16 = 0;
  while ( v16 < v14 )
  {
    v17 = (int)((char *)v15 + v16);
    if ( *((_BYTE *)v15 + v16) == 43 )
      *((_BYTE *)v15 + v16) = 32;
    v18 = *((_BYTE *)v15 + v16++);
    if ( v18 == 38 )
    {
      *(_BYTE *)v17 = 0;
      break;
    }
  }
  decode_string(v15);
  sf_strncpy(v7, v15, a5);
  free(v15);
  return 1;
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// EC24: using guessed type int __fastcall decode_string(_DWORD);

//----- (00026C58) --------------------------------------------------------
signed int __fastcall sub_26C58(const char *a1)
{
  int v1; // r7@1
  signed int v2; // r0@2
  signed int v3; // r4@3
  int v4; // r5@5
  int v5; // r4@5
  int v6; // r0@6
  int v7; // r0@9
  int v9; // [sp+8h] [bp-C838h]@5
  int v10; // [sp+C808h] [bp-38h]@2

  v1 = (int)a1;
  if ( !a1 )
    return -1;
  v2 = sub_269C4(a1, "act", (int)&v10, 32);
  if ( v2 )
  {
    if ( !strcmp((const char *)&v10, "del") )
    {
      memset(&v9, 0, 0xC800u);
      v4 = (int)&v9;
      v5 = 0;
      do
      {
        v6 = sub_26B04(v1, "delcheck", v5, v4, 512);
        v4 += 512;
        if ( !v6 )
          break;
        ++v5;
      }
      while ( v5 != 100 );
      v2 = portforward_remove_rules("upnp_pf", &v9, v5);
      v3 = v2;
      goto LABEL_9;
    }
    return -1;
  }
  v3 = -1;
LABEL_9:
  v7 = signal_update(v2);
  signal_save(v7);
  return v3;
}
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// F734: using guessed type int __fastcall portforward_remove_rules(_DWORD, _DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);

//----- (00026D40) --------------------------------------------------------
int __fastcall sub_26D40(int a1, const char *a2)
{
  int v2; // r4@1
  const char *v3; // r5@1
  const char *v4; // r6@1
  int v5; // r4@6
  int j; // r5@6
  int v7; // r7@9
  int v8; // r5@9
  bool v9; // nf@13
  unsigned __int8 v10; // vf@13
  int result; // r0@15
  int v12; // r4@15
  int i; // r5@16
  int v14; // r7@19
  int v15; // r5@19
  char s; // [sp+4h] [bp-44h]@2
  char v17; // [sp+23h] [bp-25h]@3
  int v18; // [sp+24h] [bp-24h]@1
  int v19; // [sp+28h] [bp-20h]@1
  int v20; // [sp+2Ch] [bp-1Ch]@1

  v2 = a1;
  v3 = a2;
  v19 = 0;
  v20 = 0;
  v18 = 0;
  sub_133E4((int)"natrouterconf", (int)"portforward");
  sub_241E0();
  v4 = (const char *)get_pvalue(v2, "mode");
  if ( !v4 )
  {
    memset(&s, 0, 0x20u);
    if ( sub_269C4(v3, "view_mode", (int)&s, 32) )
    {
      v17 = (char)v4;
      v4 = &s;
    }
  }
  printf("<BODY style=\"padding:0px 0px 0px 0px; margin:0px 0px 0px 0px;\">");
  printf("<form method=post action=\"timepro.cgi\" name=\"upnp_portforward_fm\" style=\"margin:0px 0px 0px 0px; padding:0px 0px 0px 0px;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"upnp_portforward\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  printf("<input type=hidden name=\"view_mode\" value=\"%s\">");
  printf("<input type=hidden name=\"mode\" value=\"\">");
  printf("<input type=hidden name=\"priority\" value=\"\">");
  printf("<input type=hidden name=\"old_priority\" value=\"\">");
  printf("<table style=\"table-layout:fixed; border-collapse:collapse; border-style:none none none none; width:100%%;\">\n");
  printf("<COL WIDTH=\"45\"><COL WIDTH=\"100\"><COL WIDTH=\"140\"><COL WIDTH=\"140\"><COL WIDTH=\"120\"><COL WIDTH=\"%%\">\n");
  sub_26C58(v3);
  if ( v4 && strcmp(v4, "upnp") )
  {
    result = strcmp(v4, "all");
    v12 = result;
    if ( result )
      return result;
    portforward_read_db("upnp_pf", &v18);
    for ( i = v18; i && !*(_DWORD *)(i + 528); i = *(_DWORD *)i )
    {
      ++v12;
      sub_25EB0(i, v12);
    }
    v14 = v12;
    v15 = 0;
    while ( 1 )
    {
      ++v12;
      v10 = __OFSUB__(v15, 6 - v14);
      v9 = v15++ - (6 - v14) < 0;
      if ( !(v9 ^ v10) )
        break;
      sub_240E4();
    }
  }
  else
  {
    portforward_read_db("upnp_pf", &v18);
    v5 = 0;
    for ( j = v18; j && !*(_DWORD *)(j + 528); j = *(_DWORD *)j )
    {
      ++v5;
      sub_25EB0(j, v5);
    }
    v7 = v5;
    v8 = 0;
    while ( 1 )
    {
      ++v5;
      v10 = __OFSUB__(v8, 16 - v7);
      v9 = v8++ - (16 - v7) < 0;
      if ( !(v9 ^ v10) )
        break;
      sub_240E4();
    }
  }
  printf((const char *)&unk_6FFDC);
  puts("<SCRIPT language=\"javascript\">");
  puts("parent.UnMaskIt(parent.document,'apply_mask');");
  if ( v4 )
  {
    if ( !strcmp(v4, "upnp") )
      printf("onClickedPFRule('upnp','','','','','','','','','','','','','','','');");
  }
  printf("</SCRIPT>");
  printf("</BODY>");
  return free_portforward_list(&v18);
}
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);
// FBB4: using guessed type int __fastcall portforward_read_db(_DWORD, _DWORD);
// FC80: using guessed type int __fastcall free_portforward_list(_DWORD);

//----- (00027004) --------------------------------------------------------
void *__fastcall sub_27004(const char *a1)
{
  const char *v1; // r8@1
  void *v2; // r11@1
  int v3; // r0@2
  int v4; // r5@2
  void *v5; // r9@5
  void *v6; // r7@5
  int v7; // r0@12
  int v8; // r5@17
  int v9; // r1@20
  int v10; // r0@22
  int v11; // r5@22
  int v12; // r0@29
  int v13; // r0@34
  int v14; // r0@36
  int v15; // r0@44
  int v16; // r0@46
  int v17; // r0@52
  int v18; // r0@54
  int v19; // r0@59
  int v20; // r6@59
  int v21; // r0@61
  int v22; // r0@67
  int v23; // r0@72
  int v24; // r0@74
  int v25; // r0@80
  int v26; // r0@82
  size_t v27; // r0@96
  signed int v28; // r2@96
  size_t v29; // r10@96
  int v30; // r3@97
  bool v31; // zf@97
  signed int i; // r4@103
  const char *v33; // r5@105
  void *v34; // r8@108
  signed int v35; // r7@108
  int v36; // r0@109
  signed int v37; // r3@120
  void *v39; // [sp+4h] [bp-42Ch]@1
  char v40[512]; // [sp+8h] [bp-428h]@96
  char s; // [sp+208h] [bp-228h]@1

  v1 = a1;
  v2 = malloc(0x21Cu);
  init_pf_rule();
  memset(&s, 0, 0x200u);
  v39 = v2;
  if ( !sub_269C4(v1, "mode", (int)&s, 512) )
    goto LABEL_130;
  v3 = pf_line_spchar_validate(&s);
  v4 = 1 - v3;
  if ( (unsigned int)v3 > 1 )
    v4 = 0;
  if ( !strcmp(&s, "user") )
  {
    v5 = 0;
    v6 = malloc(0x30u);
    init_pf_netfilter();
    insert_nf_to_rule(v2, v6);
    *((_DWORD *)v2 + 132) = 0;
    goto LABEL_9;
  }
  if ( !strcmp(&s, "trigger") )
  {
    v6 = 0;
    v5 = malloc(0x58u);
    init_tr_netfilter();
    insert_tr_to_rule(v2, v5);
    *((_DWORD *)v2 + 132) = 1;
  }
  else
  {
LABEL_130:
    v6 = 0;
    v5 = 0;
    v4 = 0;
  }
LABEL_9:
  memset(&s, 0, 0x200u);
  if ( v4 )
  {
    if ( sub_269C4(v1, "name", (int)&s, 512) )
    {
      v7 = pf_line_spchar_validate(&s);
      v4 = 1 - v7;
      if ( (unsigned int)v7 > 1 )
        v4 = 0;
      sf_strncpy((char *)v2 + 4, &s, 512);
    }
    else
    {
      v4 = 0;
    }
  }
  memset(&s, 0, 0x200u);
  if ( !v4 )
    goto LABEL_126;
  if ( sub_269C4(v1, "disabled", (int)&s, 512) )
  {
    v8 = pf_line_spchar_validate(&s);
    if ( atoi(&s) == 1 )
      *((_BYTE *)v2 + 516) = 0;
    if ( v8 )
      goto LABEL_126;
  }
  v9 = *((_DWORD *)v2 + 132);
  if ( v9 )
  {
    if ( v9 != 1 )
      goto LABEL_126;
    memset(&s, 0, 0x200u);
    if ( sub_269C4(v1, "trigger_protocol", (int)&s, 8) )
    {
      v22 = pf_line_spchar_validate(&s);
      v20 = 1 - v22;
      if ( (unsigned int)v22 > 1 )
        v20 = 0;
      sf_strncpy(v5, &s, 8);
    }
    else
    {
      v20 = 0;
    }
    memset(&s, 0, 0x200u);
    if ( v20 )
    {
      if ( !sub_269C4(v1, "trigger_sport", (int)&s, 512) )
        goto LABEL_131;
      v23 = pf_line_spchar_validate(&s);
      v20 = 1 - v23;
      if ( (unsigned int)v23 > 1 )
        v20 = 0;
      v24 = atoi(&s);
      if ( (unsigned int)(v24 - 1) <= 0xFFFE )
        *((_DWORD *)v5 + 2) = v24;
      else
LABEL_131:
        v20 = 0;
    }
    memset(&s, 0, 0x200u);
    if ( v20 )
    {
      if ( sub_269C4(v1, "trigger_eport", (int)&s, 512) )
      {
        v25 = pf_line_spchar_validate(&s);
        v20 = 1 - v25;
        if ( (unsigned int)v25 > 1 )
          v20 = 0;
        v26 = atoi(&s);
        if ( (unsigned int)(v26 - 1) <= 0xFFFE )
          *((_DWORD *)v5 + 3) = v26;
        else
          v20 = 0;
      }
      else
      {
        v20 = 1;
      }
    }
    memset(&s, 0, 0x200u);
    if ( v20 )
    {
      if ( sub_269C4(v1, (const char *)&unk_6F669, (int)&s, 8) )
      {
        if ( pf_line_spchar_validate(&s) )
          v20 = 0;
        sf_strncpy((char *)v5 + 16, &s, 8);
      }
      else
      {
        v20 = 0;
      }
    }
    memset(&s, 0, 0x200u);
    if ( !v20 || !sub_269C4(v1, "forward_ports", (int)&s, 512) )
      goto LABEL_126;
    if ( pf_line_spchar_validate(&s) )
      v20 = 0;
    if ( !s )
      goto LABEL_126;
    sf_strncpy(v40, &s, 512);
    v27 = strlen(v40);
    v28 = 0;
    v29 = v27;
    while ( v28 < (signed int)v27 )
    {
      v30 = (unsigned __int8)v40[v28];
      v31 = v30 == 44;
      if ( v30 != 44 )
        v31 = v30 == 32;
      if ( v31 )
        v40[v28] = 0;
      ++v28;
    }
    for ( i = 0; ; ++i )
    {
      v33 = &v40[i];
      if ( i >= (signed int)v27 )
        break;
      if ( v40[i] )
        goto LABEL_108;
    }
    v33 = 0;
LABEL_108:
    v34 = v5;
    v35 = 0;
    while ( 1 )
    {
      v37 = (signed int)v33;
      if ( v33 )
        v37 = 1;
      if ( v35 > 9 )
        v37 = 0;
      if ( !v37 )
        goto LABEL_125;
      v36 = atoi(v33);
      if ( (unsigned int)(v36 - 1) > 0xFFFE )
        goto LABEL_126;
      *((_DWORD *)v34 + 6) = v36;
      while ( 1 )
      {
        if ( i >= (signed int)v29 )
          goto LABEL_118;
        if ( !*v33 )
          break;
        ++v33;
        ++i;
      }
      while ( !*v33 )
      {
        ++i;
        ++v33;
        if ( i >= (signed int)v29 )
          goto LABEL_118;
      }
      if ( i >= (signed int)v29 )
LABEL_118:
        v33 = 0;
      ++v35;
      v34 = (char *)v34 + 4;
    }
  }
  memset(&s, 0, 0x200u);
  if ( !sub_269C4(v1, "internal_ip", (int)&s, 20) )
    goto LABEL_132;
  v10 = pf_line_spchar_validate(&s);
  v11 = 1 - v10;
  if ( (unsigned int)v10 > 1 )
    v11 = 0;
  sf_strncpy((char *)v6 + 24, &s, 20);
  if ( !is_valid_pf_ipv4((char *)v6 + 24) )
LABEL_132:
    v11 = 0;
  memset(&s, 0, 0x200u);
  if ( v11 )
  {
    if ( sub_269C4(v1, "protocol", (int)&s, 8) )
    {
      v12 = pf_line_spchar_validate(&s);
      v11 = 1 - v12;
      if ( (unsigned int)v12 > 1 )
        v11 = 0;
      sf_strncpy(v6, &s, 8);
    }
    else
    {
      v11 = 0;
    }
  }
  memset(&s, 0, 0x200u);
  if ( !v11 || !sub_269C4(v1, "ext_sport", (int)&s, 512) )
  {
    if ( !strcmp((const char *)v6, "gre") )
      goto LABEL_41;
LABEL_40:
    v11 = 0;
    goto LABEL_41;
  }
  v13 = pf_line_spchar_validate(&s);
  v11 = 1 - v13;
  if ( (unsigned int)v13 > 1 )
    v11 = 0;
  v14 = atoi(&s);
  if ( (unsigned int)(v14 - 1) > 0xFFFE )
    goto LABEL_40;
  *((_DWORD *)v6 + 2) = v14;
LABEL_41:
  memset(&s, 0, 0x200u);
  if ( v11 )
  {
    if ( sub_269C4(v1, "ext_eport", (int)&s, 512) )
    {
      v15 = pf_line_spchar_validate(&s);
      v11 = 1 - v15;
      if ( (unsigned int)v15 > 1 )
        v11 = 0;
      v16 = atoi(&s);
      if ( (unsigned int)(v16 - 1) <= 0xFFFE )
        *((_DWORD *)v6 + 3) = v16;
      else
        v11 = 0;
    }
    else
    {
      v11 = 1;
    }
  }
  memset(&s, 0, 0x200u);
  if ( v11 )
  {
    if ( sub_269C4(v1, "int_sport", (int)&s, 512) )
    {
      v17 = pf_line_spchar_validate(&s);
      v11 = 1 - v17;
      if ( (unsigned int)v17 > 1 )
        v11 = 0;
      v18 = atoi(&s);
      if ( (unsigned int)(v18 - 1) <= 0xFFFE )
        *((_DWORD *)v6 + 4) = v18;
      else
        v11 = 0;
    }
    else
    {
      v11 = 1;
    }
  }
  memset(&s, 0, 0x200u);
  if ( !v11 )
    goto LABEL_126;
  if ( !sub_269C4(v1, "int_eport", (int)&s, 512) )
    return v39;
  v19 = pf_line_spchar_validate(&s);
  v20 = 1 - v19;
  if ( (unsigned int)v19 > 1 )
    v20 = 0;
  v21 = atoi(&s);
  if ( (unsigned int)(v21 - 1) > 0xFFFE )
    goto LABEL_126;
  *((_DWORD *)v6 + 5) = v21;
LABEL_125:
  if ( !v20 )
  {
LABEL_126:
    delete_pf_rule(0, v2);
    v39 = 0;
  }
  return v39;
}
// E738: using guessed type int __fastcall insert_nf_to_rule(_DWORD, _DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// ECB4: using guessed type int __fastcall is_valid_pf_ipv4(_DWORD);
// EE58: using guessed type int __fastcall delete_pf_rule(_DWORD, _DWORD);
// EEA0: using guessed type int init_pf_netfilter(void);
// EFB4: using guessed type int init_pf_rule(void);
// F6C8: using guessed type int __fastcall pf_line_spchar_validate(_DWORD);
// F818: using guessed type int init_tr_netfilter(void);
// FB6C: using guessed type int __fastcall insert_tr_to_rule(_DWORD, _DWORD);
// 27004: using guessed type char var_428[512];

//----- (0002778C) --------------------------------------------------------
int __fastcall sub_2778C(int result)
{
  if ( result )
    result = delete_pf_rule(0, result);
  return result;
}
// EE58: using guessed type int __fastcall delete_pf_rule(_DWORD, _DWORD);

//----- (000277A0) --------------------------------------------------------
signed int __fastcall sub_277A0(const char *a1)
{
  int v1; // r7@1
  signed int v2; // r0@2
  signed int v3; // r4@3
  int v4; // r5@5
  int v5; // r0@6
  int v6; // r1@6
  signed int v7; // r2@6
  int v8; // r0@6
  int v9; // r0@8
  int v10; // r0@11
  int v11; // r1@11
  signed int v12; // r2@11
  int v13; // r0@11
  int v14; // r5@16
  int v15; // r4@16
  int v16; // r0@17
  int v17; // r0@20
  int v19; // [sp+8h] [bp-C858h]@16
  int v20; // [sp+C808h] [bp-58h]@5
  int v21; // [sp+C828h] [bp-38h]@2

  v1 = (int)a1;
  if ( !a1 )
    return -1;
  v2 = sub_269C4(a1, "act", (int)&v21, 32);
  if ( v2 )
  {
    if ( !strcmp((const char *)&v21, "add") )
    {
      memset(&v20, 0, 0x20u);
      v4 = (int)sub_27004((const char *)v1);
      if ( sub_269C4((const char *)v1, "priority", (int)&v20, 32) )
      {
        v5 = atoi((const char *)&v20);
        v6 = v4;
        v7 = v5;
        v8 = (int)"user_pf";
      }
      else
      {
        v8 = (int)"user_pf";
        v6 = v4;
        v7 = 100;
      }
      v9 = portforward_add_rule(v8, v6, v7);
LABEL_14:
      v3 = v9;
      v2 = sub_2778C(v4);
      goto LABEL_20;
    }
    if ( !strcmp((const char *)&v21, "modify") )
    {
      memset(&v20, 0, 0x20u);
      v4 = (int)sub_27004((const char *)v1);
      if ( sub_269C4((const char *)v1, "priority", (int)&v20, 32) )
      {
        v10 = atoi((const char *)&v20);
        v11 = v4;
        v12 = v10;
        v13 = (int)"user_pf";
      }
      else
      {
        v13 = (int)"user_pf";
        v11 = v4;
        v12 = -1;
      }
      v9 = portforward_modify_rule(v13, v11, v12);
      goto LABEL_14;
    }
    if ( !strcmp((const char *)&v21, "del") )
    {
      memset(&v19, 0, 0xC800u);
      v14 = (int)&v19;
      v15 = 0;
      do
      {
        v16 = sub_26B04(v1, "delcheck", v15, v14, 512);
        v14 += 512;
        if ( !v16 )
          break;
        ++v15;
      }
      while ( v15 != 100 );
      v2 = portforward_remove_rules("user_pf", &v19, v15);
      v3 = v2;
      goto LABEL_20;
    }
    return -1;
  }
  v3 = -1;
LABEL_20:
  v17 = signal_update(v2);
  signal_save(v17);
  return v3;
}
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EF24: using guessed type int __fastcall portforward_add_rule(_DWORD, _DWORD, _DWORD);
// F734: using guessed type int __fastcall portforward_remove_rules(_DWORD, _DWORD, _DWORD);
// F998: using guessed type int __fastcall portforward_modify_rule(_DWORD, _DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);

//----- (000279A0) --------------------------------------------------------
int __fastcall sub_279A0(int a1, const char *a2)
{
  int v2; // r4@1
  const char *v3; // r8@1
  const char *v4; // r7@1
  signed int v5; // r10@4
  int v6; // r4@6
  int v7; // r5@6
  int v8; // r6@10
  int v9; // r5@14
  int v10; // r6@14
  int v11; // r4@14
  int result; // r0@18
  int v13; // r5@19
  int i; // r4@19
  int v15; // r6@24
  int v16; // r5@28
  int v17; // r6@28
  int v18; // r4@28
  int v19; // r8@32
  signed int v20; // r3@32
  int v21; // r1@38
  int v22; // r1@40
  const char *v23; // r0@40
  bool v24; // nf@42
  unsigned __int8 v25; // vf@42
  int v26; // r5@45
  int v27; // r12@50
  int v28; // lr@51
  int v29; // r4@56
  int v30; // r6@56
  int v31; // r5@56
  int v32; // lr@60
  int v33; // r5@61
  const char *v34; // r0@66
  char v35; // [sp+24h] [bp-26Ch]@56
  char v36; // [sp+224h] [bp-6Ch]@37
  char s; // [sp+244h] [bp-4Ch]@2
  char v38; // [sp+263h] [bp-2Dh]@3
  int v39; // [sp+264h] [bp-2Ch]@1
  int v40; // [sp+268h] [bp-28h]@1
  unsigned int v41; // [sp+26Ch] [bp-24h]@1

  v2 = a1;
  v3 = a2;
  v40 = 0;
  v41 = 0;
  v39 = 0;
  sub_133E4((int)"natrouterconf", (int)"portforward");
  sub_241E0();
  v4 = (const char *)get_pvalue(v2, "mode");
  if ( !v4 )
  {
    memset(&s, 0, 0x20u);
    if ( sub_269C4(v3, "view_mode", (int)&s, 32) )
    {
      v38 = (char)v4;
      v4 = &s;
    }
  }
  printf("<BODY style=\"padding:0px 0px 0px 0px; margin:0px 0px 0px 0px;\">");
  printf("<form method=post action=\"timepro.cgi\" name=\"user_portforward_fm\" style=\"margin:0px 0px 0px 0px; padding:0px 0px 0px 0px;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"user_portforward\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  printf("<input type=hidden name=\"view_mode\" value=\"%s\">");
  printf("<input type=hidden name=\"mode\" value=\"\">");
  printf("<input type=hidden name=\"name\" value=\"\">");
  printf("<input type=hidden name=\"int_sport\" value=\"\">");
  printf("<input type=hidden name=\"int_eport\" value=\"\">");
  printf("<input type=hidden name=\"ext_sport\" value=\"\">");
  printf("<input type=hidden name=\"ext_eport\" value=\"\">");
  printf("<input type=hidden name=\"trigger_protocol\" value=\"\">");
  printf("<input type=hidden name=\"trigger_sport\" value=\"\">");
  printf("<input type=hidden name=\"trigger_eport\" value=\"\">");
  printf("<input type=hidden name=\"forward_ports\" value=\"\">");
  printf("<input type=hidden name=\"forward_protocol\" value=\"\">");
  printf("<input type=hidden name=\"internal_ip\" value=\"\">");
  printf("<input type=hidden name=\"protocol\" value=\"\">");
  printf("<input type=hidden name=\"disabled\" value=\"\">");
  printf("<input type=hidden name=\"priority\" value=\"\">");
  printf("<input type=hidden name=\"old_priority\" value=\"\">");
  printf("<table style=\"table-layout:fixed; border-collapse:collapse; border-style:none none none none; width:100%%;\">\n");
  printf("<COL WIDTH=\"45\"><COL WIDTH=\"100\"><COL WIDTH=\"140\"><COL WIDTH=\"140\"><COL WIDTH=\"120\"><COL WIDTH=\"%%\">\n");
  v5 = sub_277A0(v3);
  portforward_read_db("user_pf", &v39);
  if ( !v4 || !strcmp(v4, "user") )
  {
    v6 = v39;
    v7 = 0;
    while ( v6 && !*(_DWORD *)(v6 + 528) )
    {
      ++v7;
      sub_26180(1, v6, v7);
      v6 = *(_DWORD *)v6;
    }
    v8 = v7;
    sub_2411C();
    while ( v6 && *(_DWORD *)(v6 + 528) == 1 )
    {
      ++v7;
      sub_26180(2, v6, v7);
      v6 = *(_DWORD *)v6;
      ++v8;
    }
    v9 = v7 + 1;
    sub_2413C();
    v10 = v8 + 1;
    v11 = 0;
    while ( 1 )
    {
      ++v9;
      v25 = __OFSUB__(v11, 16 - v10);
      v24 = v11++ - (16 - v10) < 0;
      if ( !(v24 ^ v25) )
        break;
      sub_240E4();
    }
    goto LABEL_31;
  }
  result = strcmp(v4, "all");
  if ( !result )
  {
    v13 = 0;
    for ( i = v39; i && !*(_DWORD *)(i + 528); i = *(_DWORD *)i )
    {
      ++v13;
      sub_26180(1, i, v13);
    }
    v15 = v13;
    sub_2411C();
    while ( i && *(_DWORD *)(i + 528) == 1 )
    {
      ++v13;
      sub_26180(2, i, v13);
      i = *(_DWORD *)i;
      ++v15;
    }
    v16 = v13 + 1;
    sub_2413C();
    v17 = v15 + 1;
    v18 = 0;
    while ( 1 )
    {
      ++v16;
      v25 = __OFSUB__(v18, 9 - v17);
      v24 = v18++ - (9 - v17) < 0;
      if ( !(v24 ^ v25) )
        break;
      sub_240E4();
    }
LABEL_31:
    printf((const char *)&unk_6FFDC);
    puts("<SCRIPT language=\"javascript\">");
    puts("parent.UnMaskIt(parent.document,'apply_mask');");
    puts("function onNewLineClicked(mode){");
    puts("\tvar obj = document.getElementById(\"_-new_line\");");
    puts("\tif(obj){ \n\tobj.scrollIntoView(true);");
    puts("\tif(mode){");
    puts("\t\tonClickedPFRule(mode,'','','','','','','','','','','','','','','');\n}");
    puts("\telse{");
    puts("\t\tonClickedPFRule('user','','','','','','','','','','','','','','','');\n}");
    puts("\t}\n}");
    if ( v5 == -1 )
    {
      if ( !v4 || !strcmp(v4, "all") )
        printf("onNewLineClicked();");
      else
        printf("onNewLineClicked('%s');", v4);
      memset(&v36, 0, 0x20u);
      if ( !sub_269C4(v3, "act", (int)&v36, 32) || strcmp(&v36, "add") || v41 <= 0x63 )
        goto LABEL_73;
      v22 = sub_134F4(766, v21);
      v23 = "alert('%s');";
    }
    else
    {
      v19 = v39;
      v20 = 1;
      while ( 1 )
      {
        v25 = 0;
        v24 = v19 < 0;
        if ( v19 )
        {
          v25 = __OFSUB__(v20, v5);
          v24 = v20 - v5 < 0;
        }
        v26 = v24 ^ v25 ? 1 : 0;
        ++v20;
        if ( !(v24 ^ v25) )
          break;
        v19 = *(_DWORD *)v19;
      }
      if ( v19 )
      {
        if ( *(_DWORD *)(v19 + 528) )
        {
          v29 = *(_DWORD *)(v19 + 536);
          memset(&v35, v26, 0x200u);
          v30 = v26;
          v31 = v29;
          do
          {
            ++v30;
            if ( *(_DWORD *)(v31 + 24) )
              snprintf2(&v35, 512, "%s%d ", &v35, *(_DWORD *)(v31 + 24));
            v31 += 4;
          }
          while ( v30 != 10 );
          v32 = (int)"false";
          if ( *(_BYTE *)(v19 + 517) )
            v33 = (int)"true";
          else
            v33 = (int)"false";
          if ( !*(_BYTE *)(v19 + 516) )
            v32 = (int)"true";
          printf(
            "onClickedPFRule('trigger','%s','trigger','','%s','','','','','%d','%d','%s','%s',%s,'%d','', %s);",
            v19 + 4,
            v29,
            *(_DWORD *)(v29 + 8),
            *(_DWORD *)(v29 + 12),
            v29 + 16,
            &v35,
            v32,
            v5,
            v33);
        }
        else
        {
          v27 = (int)"false";
          if ( *(_BYTE *)(v19 + 517) )
            v28 = (int)"true";
          else
            v28 = (int)"false";
          if ( !*(_BYTE *)(v19 + 516) )
            v27 = (int)"true";
          printf(
            "onClickedPFRule('user','%s','0','%s','%s','%d','%d','%d','%d','','','','',%s,'%d','%d', %s);",
            v19 + 4,
            *(_DWORD *)(v19 + 532) + 24,
            *(_DWORD *)(v19 + 532),
            *(_DWORD *)(*(_DWORD *)(v19 + 532) + 8),
            *(_DWORD *)(*(_DWORD *)(v19 + 532) + 12),
            *(_DWORD *)(*(_DWORD *)(v19 + 532) + 16),
            *(_DWORD *)(*(_DWORD *)(v19 + 532) + 20),
            v27,
            v5,
            1,
            v28);
        }
        printf("\tvar obj = document.getElementById('%s');", v19 + 4);
        v34 = "\tif(obj) obj.scrollIntoView(true);";
        goto LABEL_72;
      }
      if ( !v4 || !strcmp(v4, "all") )
      {
        v34 = "onNewLineClicked();";
LABEL_72:
        printf(v34);
        goto LABEL_73;
      }
      v23 = "onNewLineClicked('%s');";
      v22 = (int)v4;
    }
    printf(v23, v22);
LABEL_73:
    printf("parent.document.portforward_fm.rule_count.value = %d;", v41);
    printf("onLoadCompleted(parent.document);");
    printf("</SCRIPT>");
    printf("</BODY>");
    result = free_portforward_list(&v39);
  }
  return result;
}
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);
// FBB4: using guessed type int __fastcall portforward_read_db(_DWORD, _DWORD);
// FC80: using guessed type int __fastcall free_portforward_list(_DWORD);

//----- (00028060) --------------------------------------------------------
int __fastcall sub_28060(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  int result; // r0@1
  int v8; // r1@2
  int v9; // r0@3
  int v10; // r0@5
  int v11; // r0@5
  int v12; // r0@5
  int v13; // [sp+0h] [bp-88h]@1

  v2 = a2;
  printf("<BODY style=\"height:26px; display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"portforward_file_fm\" enctype=\"multipart/form-data\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"restore_portforward\">");
  printf("<input type=\"hidden\" name=\"commit\" value=\"pf_restore\">");
  printf("<table class=v3_table width=100%% height=26 style=\"vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0;\">");
  printf("<tr style=\"vertical-align:middle;\" height=24><td width=94>");
  v4 = sub_134F4(772, v3);
  printf(
    "<input type=button name=\"saverulebtn\" value=\"%s\" onclick=\"self.location.href='download_portforward.cgi'\" ",
    v4);
  printf("style=\"width:94px; font-size:12px; padding:1 0 1 0; margin:0 0 0 5; text-align:center;\"></td>");
  v6 = sub_134F4(770, v5);
  printf("<td width=94><input type=button value=\"%s\" onclick=\"parent.Portforward_Restore();\" ", v6);
  printf("style=\"width:94px; font-size:12px; padding:1 0 1 0; margin:0 0 0 5; text-align:center;\"></td>");
  printf("<td><input type=file name=\"pf_restore_file\" maxlength=100 style=\"padding:1 0 1 0; margin:0 0 0 5;\"></td>");
  printf((const char *)&unk_6FFD7);
  printf("</BODY>");
  result = get_value_post_multipart(v2, "commit", &v13, 128);
  if ( result )
  {
    printf("<script>");
    if ( portforward_update_by_file("/tmp/user_pf.set.tmp", "user_pf") == -1 )
      v9 = 769;
    else
      v9 = 771;
    v10 = sub_134F4(v9, v8);
    printf("alert('%s');", v10);
    printf("parent.UnMaskIt(parent.document,'restore_mask');");
    printf("parent.onChangedPFView(parent.parent.frames[3].document.getElementById('pf_select_menu').value);");
    printf((const char *)&unk_7007E);
    v11 = printf("</script>");
    v12 = signal_update(v11);
    result = signal_save(v12);
  }
  return result;
}
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EE34: using guessed type int __fastcall portforward_update_by_file(_DWORD, _DWORD);
// F248: using guessed type int __fastcall get_value_post_multipart(_DWORD, _DWORD, _DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);

//----- (000281D4) --------------------------------------------------------
int sub_281D4()
{
  sub_133E4((int)"natrouterconf", (int)"router");
  printf("<style>");
  printf("body { margin: 0; }");
  printf(".title td { background-color: #EEE; }");
  printf(".selected { background-color: #C9D5E9 !important; }");
  printf("</style>");
  puts("<form method=post action=\"timepro.cgi\" name=\"router_list_fm\" style='margin: 0;'>");
  printf("<table id='natrouterconf_list'>");
  printf("</table>");
  printf("</form>");
  return printf("<iframe name=\"natrouterconf_router_status\" src=\"timepro.cgi?tmenu=iframe&smenu=natrouterconf_router_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (00028268) --------------------------------------------------------
int sub_28268()
{
  int v0; // r0@1
  int v1; // r1@1
  int v2; // r5@1
  _UNKNOWN *v3; // r0@1

  printf("<table cellpadding='0px' cellspacing='0px' style='width: 641px;padding: 0;margin: 0;'>");
  printf("<iframe name=\"natrouterconf_router_list\" src=\"timepro.cgi?tmenu=iframe&smenu=natrouterconf_router_list\" frameborder=no style='width:100%%; height:408px;'></iframe>");
  sub_133E4((int)"natrouterconf", (int)"router");
  printf("<style>");
  printf("#setup_table tr { background-color: #EEE; }");
  printf("#setup_table td { background-color: inherit; padding-left: 10px; }");
  printf("input[type='text'] { border: 1px solid #CCC; text-align: center; }");
  printf("</style>");
  puts("<tr><td>");
  puts("<form method=post action=\"timepro.cgi\" name=\"router_setup_fm\" style='margin: 0;'>");
  puts("<table id='setup_table' cellspacing=0px cellpadding=0px style='border-top:1px solid #CCC;'>");
  printf("</table>");
  printf("</form>");
  printf("</td></tr>");
  v0 = printf("<iframe name=\"natrouterconf_router_setup\" src=\"timepro.cgi?tmenu=iframe&smenu=natrouterconf_router_setup\" frameborder=no style='display:none;'></iframe>");
  print_end_main_table(v0);
  v2 = sub_134F4(27, v1);
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v3 = sub_126C4();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v3);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\">%s\n",
    v2);
  printf("</SPAN></td>");
  return printf((const char *)&unk_60F0E);
}
// F5F0: using guessed type int __fastcall print_end_main_table(_DWORD);

//----- (000283E0) --------------------------------------------------------
signed int __fastcall sub_283E0(const char *a1, int a2)
{
  int v2; // r4@1
  int v3; // r0@1
  int v4; // r2@1
  unsigned int v5; // r1@1
  char *v6; // r1@4
  signed int result; // r0@5

  v2 = a2;
  v3 = atoi(a1);
  v4 = 0;
  v5 = 0;
  while ( v4 < v3 )
    v5 |= 0x80000000 >> v4++;
  v6 = inet_ntoa((struct in_addr)((v5 >> 24) | (v5 << 24) | ((v5 & 0xFF0000) >> 8) | ((unsigned __int16)(v5 & 0xFF00) << 8)));
  if ( v6 )
  {
    sf_strncpy(v2, v6, 20);
    result = 0;
  }
  else
  {
    result = -1;
  }
  return result;
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);

//----- (00028448) --------------------------------------------------------
signed int __fastcall sub_28448(int a1)
{
  int v1; // r7@1
  signed int v2; // r4@4
  int i; // r5@5
  int v4; // r0@17
  int v6; // [sp+8h] [bp-2AF8h]@2
  signed int v7; // [sp+Ch] [bp-2AF4h]@14
  int v8; // [sp+28B0h] [bp-250h]@5
  char s; // [sp+2A40h] [bp-C0h]@2
  int v10; // [sp+2A44h] [bp-BCh]@12
  int v11; // [sp+2A4Ch] [bp-B4h]@12
  int v12; // [sp+2A60h] [bp-A0h]@12
  int v13; // [sp+2A74h] [bp-8Ch]@14
  int v14; // [sp+2AA8h] [bp-58h]@6
  int v15; // [sp+2AC8h] [bp-38h]@1

  v1 = a1;
  if ( !get_value_post(a1, "act", &v15, 32) )
    return 0;
  memset(&v6, 0, 0x68u);
  memset(&s, 0, 0x68u);
  read_rt_db(&v6);
  if ( !strcmp((const char *)&v15, "delete") || !strcmp((const char *)&v15, "modify") )
  {
    memset(&v8, 0, 0x190u);
    for ( i = 0; get_value_array_post(v1, "delchk", i, &v14); ++i )
      *(&v8 + i) = atoi((const char *)&v14);
    v2 = 2;
    delete_rt_entry_list(&v6, &v8, i);
  }
  else
  {
    v2 = 1;
  }
  if ( !strcmp((const char *)&v15, "add") || !strcmp((const char *)&v15, "modify") )
  {
    get_value_post(v1, "rtselect", &v15, 32);
    if ( !check_unpermitted_chars(&v15) )
    {
      sf_strncpy(&v10, &v15, 8);
      get_ip_value_post(v1, "targetip", &v11);
      strcpy((char *)&v12, "");
      if ( get_value_post(v1, "netmask", &v15, 32) )
        sub_283E0((const char *)&v15, (int)&v12);
      strcpy((char *)&v13, "");
      get_ip_value_post(v1, "gw", &v13);
      if ( v7 <= 99 )
        add_rt_entry(&v6);
      v2 = 3;
      goto LABEL_17;
    }
    return 0;
  }
LABEL_17:
  v4 = write_rt_db(&v6);
  signal_save(v4);
  return v2;
}
// E750: using guessed type int __fastcall read_rt_db(_DWORD);
// E78C: using guessed type int __fastcall delete_rt_entry_list(_DWORD, _DWORD, _DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EF30: using guessed type int __cdecl add_rt_entry(_DWORD);
// F11C: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F9BC: using guessed type int __fastcall get_value_array_post(_DWORD, _DWORD, _DWORD, _DWORD);
// FB3C: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// FB84: using guessed type int __fastcall write_rt_db(_DWORD);

//----- (000286A4) --------------------------------------------------------
int __fastcall sub_286A4(int a1, int a2)
{
  signed int v2; // r4@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r1@1
  int v9; // r0@1
  int v10; // r0@1
  int v11; // r0@1
  int v12; // r1@1
  int v13; // r0@1
  int v14; // r1@1
  int v15; // r0@1
  int v16; // r1@1
  int v17; // r0@1
  int v18; // r1@1
  int v19; // r0@1
  int v20; // r1@1
  int v21; // r0@1
  int v22; // r0@1
  int v23; // r0@1
  int v24; // r1@1
  int v25; // r0@1
  int v26; // r0@1
  const char *v27; // r0@2

  v2 = sub_28448(a2);
  sub_133E4((int)"natrouterconf", (int)"router");
  puts("<form method=post action=\"timepro.cgi\" name=\"router_setup_fm\">");
  puts("<input type=hidden name=\"tmenu\" value='iframe'>");
  puts("<input type=hidden name=\"smenu\" value='natrouterconf_router_setup'>");
  puts("<input type=hidden name=\"act\" value=\"\">");
  printf("<input type=hidden name=\"delchk\" value=''>");
  printf("<input type=hidden name=\"rtselect\" value=''>");
  printf("<input type=hidden name=\"netmask\" value=''>");
  printf("<input type=hidden name=\"targetip1\" value=''>");
  printf("<input type=hidden name=\"targetip2\" value=''>");
  printf("<input type=hidden name=\"targetip3\" value=''>");
  printf("<input type=hidden name=\"targetip4\" value=''>");
  printf("<input type=hidden name=\"gw1\" value=''>");
  printf("<input type=hidden name=\"gw2\" value=''>");
  printf("<input type=hidden name=\"gw3\" value=''>");
  printf("<input type=hidden name=\"gw4\" value=''>");
  puts("</form>");
  printf("<table id='setup_table' cellspacing=0px cellpadding=0px style='border-top:1px solid #CCC; width:100%%;'>\n");
  printf("<colgroup><col width='8%%'><col width='25.5%%'><col width='6%%'><col width='8%%'><col width='11%%'><col width='25.5%%'><col width='16%%'></colgroup>");
  printf("<input type=hidden name=\"index\" value=''>");
  v3 = print_blank_line(7, 10);
  str(v3);
  v5 = sub_134F4(1126, v4);
  printf("<td>%s</td>", v5);
  puts("<td>");
  puts("<select name=\"rtselect\" onchange=\"rttypeOnchange()\" style='width:70px;'>");
  v7 = sub_134F4(737, v6);
  printf("<option value=\"net\">%s\n", v7);
  v9 = sub_134F4(378, v8);
  printf("<option value=\"host\">%s\n", v9);
  puts("</select>");
  puts("</td>");
  v10 = puts("<td colspan=5>");
  etr(v10);
  v11 = print_blank_line(7, 5);
  str(v11);
  v13 = sub_134F4(1097, v12);
  printf("<td>%s</td>", v13);
  puts("<td>");
  sub_11D7C((int)"targetip", 0, 1);
  puts("</td>");
  v15 = sub_134F4(515, v14);
  printf("<td>%s</td>", v15);
  puts("<td>");
  puts("<input type=text name=\"netmask\" maxlength=2 size=2 style=\"width:30px\">");
  puts("</td>");
  v17 = sub_134F4(346, v16);
  printf("<td>%s</td>", v17);
  puts("<td>");
  sub_11D7C((int)"gw", 0, 1);
  puts("</td>");
  puts("<td  align=left>");
  v19 = sub_134F4(3, v18);
  printf("<input type=button name=\"addbt\" value=\"%s\" onclick=\"AddSubmit('add')\">\n", v19);
  v21 = sub_134F4(535, v20);
  printf(
    "<input type=button name=\"modifybt\" value=\"%s\" onclick=\"AddSubmit('modify')\" style='display:none;'>\n",
    v21);
  v22 = puts("</td>");
  etr(v22);
  v23 = print_blank_line(7, 15);
  str(v23);
  puts("<td colspan=7 align=left><font color='gray'>");
  v25 = sub_134F4(517, v24);
  printf((const char *)v25, 100);
  v26 = puts("</td>");
  etr(v26);
  print_blank_line(7, 5);
  printf("<tr style='background-color: #CCC; height: 1px;'><td colspan=7></td></tr>");
  puts("</table>");
  printf("<script>");
  if ( v2 )
    v27 = "parent.document.getElementsByName('natrouterconf_router_list')[0].contentWindow.document.getElementsByName('natrouterconf_router_status')[0].contentWindow.location.href = 'timepro.cgi?tmenu=iframe&smenu=natrouterconf_router_status';";
  else
    v27 = "parent.document.getElementById('setup_table').outerHTML = document.getElementById('setup_table').outerHTML;";
  printf(v27);
  printf("document.getElementById('setup_table').outerHTML = '';");
  printf("UnMask(parent.document, 'apply_mask');");
  return printf("</script>");
}
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (00028A04) --------------------------------------------------------
int __fastcall sub_28A04(int a1, int a2)
{
  int v2; // r7@1
  signed int v3; // r8@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r1@1
  int v9; // r0@1
  int v10; // r1@1
  int v11; // r0@1
  int v12; // r1@1
  int v13; // r0@1
  _UNKNOWN *v14; // r4@1
  int v15; // r1@1
  int v16; // r0@1
  bool v17; // zf@2
  int v18; // r1@2
  int v19; // r0@2
  int v20; // r0@4
  _UNKNOWN *v21; // r0@6
  int v22; // r6@6
  int v23; // r1@6
  int v24; // r0@6
  const char *v25; // r0@12
  int v27; // [sp+0h] [bp-29C0h]@1
  int v28; // [sp+4h] [bp-29BCh]@5
  int v29; // [sp+14h] [bp-29ACh]@4
  int v30; // [sp+28A8h] [bp-118h]@4

  v2 = 0;
  v3 = sub_28448(a2);
  memset(&v27, 0, 0x68u);
  read_rt_db(&v27);
  sub_133E4((int)"natrouterconf", (int)"router");
  puts("<form method=post action=\"timepro.cgi\" name=\"router_list_fm\" style='margin: 0;'>");
  puts("<input type=hidden name=\"tmenu\" value='iframe'>");
  puts("<input type=hidden name=\"smenu\" value='natrouterconf_router_status'>");
  puts("<input type=hidden name=\"act\" value=\"delete\">");
  printf("<table id='natrouterconf_list' style='width: 100%%; height: 100%%;' border='0' cellpadding='0' cellspacing='0'>");
  printf("<colgroup><col width=27px><col width=104px><col width=147px><col width=160px><col width=136px></colgroup>");
  printf("<tr class='title'>");
  v5 = sub_134F4(752, v4);
  printf("<td style='text-align:center; height:24px;'>%s</td>", v5);
  v7 = sub_134F4(1126, v6);
  printf("<td>%s</td>", v7);
  v9 = sub_134F4(1097, v8);
  printf("<td>%s</td>", v9);
  v11 = sub_134F4(515, v10);
  printf("<td>%s</td>", v11);
  v13 = sub_134F4(346, v12);
  printf("<td>%s</td>", v13);
  puts("<td align=right width=68>");
  v14 = sub_126C4();
  v16 = sub_134F4(118, v15);
  printf(
    "<span onclick=\"deleteRT();\" style='cursor:pointer;'><img src='/%s/minus_icon.gif' style='margin-bottom:1px;'>%s</span>",
    v14,
    v16);
  puts("<input type=checkbox name=\"allchk\" onclick=\"CheckAllCheckBox(document, this, 'delchk');\" style='margin-right:16px;'>");
  puts("</td>");
  printf("</tr>");
  while ( v2 < v28 )
  {
    v17 = strcmp((const char *)&v27 + 104 * v2 + 12, "host") == 0;
    v19 = 377;
    if ( !v17 )
      v19 = 736;
    v20 = sub_134F4(v19, v18);
    strcpy((char *)&v30, (const char *)v20);
    printf("<tr style='background-color:#%s; height:24px; cursor:pointer;' onclick='clickRT(%d);'>");
    printf("<td align=center><span>%d</span></td>", v2 + 1);
    printf("<td><span>%s</span></td>", &v30);
    printf("<td><span>%s</span></td>", &v29 + 26 * v2);
    printf("<td><span>%s</span></td>", &v27 + 26 * v2 + 10);
    printf("<td><span>%s</span></td>", &v27 + 26 * v2 + 15);
    printf("<td align=right>");
    printf("<input type=checkbox name=\"delchk\" value=\"%d\" style='margin-right:16px;'>", v2);
    printf("</td>");
    printf("</tr>");
    ++v2;
  }
  printf("<TR id='add_rule_tr' height=24px STYLE=\"background-Color:#%s; cursor: pointer;\" onclick='clearInputValue();'>");
  v21 = sub_126C4();
  v22 = v2 + 1;
  printf("<TD align=center><span style='padding-left:5px;'><img src='/%s/pf_new_rule.gif'></span></TD>", v21);
  v24 = sub_134F4(739, v23);
  printf("<TD colspan=5 align=left style='color:#4789FF;'>%s</TD>", v24);
  printf("</TR>");
  while ( v22 <= 15 )
  {
    printf("<TR height=24px STYLE=\"background-Color:#%s\">");
    printf("<TD colspan=6></TD></TR>");
    ++v22;
  }
  printf("</table>");
  puts("</form>");
  printf("<script>");
  printf("parent.document.getElementById('natrouterconf_list').outerHTML = document.getElementById('natrouterconf_list').outerHTML;");
  if ( v3 == 2 )
  {
    printf("parent.parent.document.getElementsByName('index')[0].value = '';");
LABEL_13:
    printf("parent.window.clearInputValue();");
    v25 = "parent.window.natrouterSetCursor(( parent.document.getElementsByTagName('span').length - 2 ) / 5);";
    goto LABEL_14;
  }
  if ( v3 )
    goto LABEL_13;
  v25 = "highlightAddedTr();";
LABEL_14:
  printf(v25);
  printf("UnMask(parent.parent.document, 'apply_mask');");
  return printf("</script>");
}
// E750: using guessed type int __fastcall read_rt_db(_DWORD);

//----- (00028DBC) --------------------------------------------------------
int __fastcall sub_28DBC(int a1, int a2, int a3)
{
  int v3; // r6@1
  int v4; // r7@1
  int v5; // r5@1

  v3 = a2;
  v4 = a3;
  v5 = a1;
  printf(
    "<TR height=20 ID=%s STYLE=\"cursor:pointer; background-color:#%s;\" ONCLICK=\"clickNatrouterconfMiscTr(this);\">",
    a1);
  return printf("<TD></TD><TD>%s</TD><TD CLASS=text_gray ID=%s_value >%s</TD><TD>%s</TD></TR>\n", v3, v5, v4);
}

//----- (00028E1C) --------------------------------------------------------
int __fastcall sub_28E1C(int a1, int a2, int a3)
{
  int v3; // r6@1
  signed int v4; // r4@2
  signed int v5; // r4@3
  bool v6; // zf@5
  bool v7; // nf@5
  unsigned __int8 v8; // vf@5
  int result; // r0@5

  v3 = a3;
  if ( a1 )
  {
    v4 = 1;
    while ( 1 )
    {
      v8 = __OFSUB__(v4, v3);
      v6 = v4 == v3;
      v7 = v4 - v3 < 0;
      result = (int)"<input type='hidden' name='w%d%s%d'>";
      ++v4;
      if ( !((unsigned __int8)(v7 ^ v8) | v6) )
        break;
      printf("<input type='hidden' name='w%d%s%d'>");
    }
  }
  else
  {
    v5 = 1;
    while ( 1 )
    {
      v8 = __OFSUB__(v5, v3);
      v6 = v5 == v3;
      v7 = v5 - v3 < 0;
      result = (int)"<input type='hidden' name='%s%d'>";
      ++v5;
      if ( !((unsigned __int8)(v7 ^ v8) | v6) )
        break;
      printf("<input type='hidden' name='%s%d'>");
    }
  }
  return result;
}

//----- (00028E88) --------------------------------------------------------
int __fastcall sub_28E88(int a1)
{
  int v1; // r4@1

  v1 = a1;
  printf("<form method=post action='timepro.cgi' name='natrouterconf_misc_dmztwinip%d_fm'>", a1);
  printf("<input type=hidden name='tmenu' value='iframe'>");
  printf("<input type=hidden name='smenu' value='natrouterconf_misc_submit'>");
  printf("<input type=hidden name='act' value='dmztwinip'>");
  printf("<input type=hidden name='wanid' value='%d'>", v1);
  printf("<input type=hidden name='w%dmode' value=''>", v1);
  printf("<input type=hidden name='w%dleasetime'>", v1);
  printf("<input type=hidden name='get_w%dhosthw'>", v1);
  sub_28E1C(v1, (int)"ip", 4);
  sub_28E1C(v1, (int)"hw", 6);
  return printf("</form>");
}

//----- (00028F3C) --------------------------------------------------------
int __fastcall sub_28F3C(const char *a1, int a2)
{
  int v2; // r5@1
  const char *v3; // r4@1
  _UNKNOWN *v4; // r0@3

  v2 = a2;
  v3 = a1;
  if ( !strcmp(a1, "reboot_mask") )
  {
    printf("<style>");
    printf("#%s p { margin: 5px 0 5px 15px; text-align: left; }", v3);
    printf("</style>");
  }
  printf("<DIV id=\"%s\" style=\"display:none;\">", v3);
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v4 = sub_126C4();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v4);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\">%s\n",
    v2);
  printf("</SPAN></td>");
  return printf((const char *)&unk_60F0E);
}

//----- (00029024) --------------------------------------------------------
int sub_29024()
{
  sub_133E4((int)"natrouterconf", (int)"misc");
  printf("<BODY style=\"padding:0px 0px; margin:0px 0px;\">");
  printf("<form method=post action=\"timepro.cgi\" id=\"main_form\" name=\"main_form\" style=\"margin:0;\">");
  printf("</form>");
  printf("<iframe name=\"natrouterconf_misc_status\" src=\"timepro.cgi?tmenu=iframe&smenu=natrouterconf_misc_status\" frameborder=no style='display:none;'></iframe>");
  return printf("</BODY>");
}

//----- (0002907C) --------------------------------------------------------
int sub_2907C()
{
  int v0; // r0@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r4@1
  int v7; // r0@1
  int v8; // r1@1
  int v9; // r0@1
  int v10; // r1@1
  int v11; // r0@1
  int v13; // [sp+0h] [bp-110h]@1

  strcpy((char *)&v13, "");
  sub_133E4((int)"natrouterconf", (int)"misc");
  printf("<style>");
  printf("input[type='text'] { text-align: center; }");
  printf("</style>");
  printf("<form method=\"post\" action=\"timepro.cgi\" name=\"natrouterconf_fm\" style='margin:0;'>");
  printf("<input type=hidden id=\"menu_id\" name=\"menu_id\" value=\"\">");
  v0 = puts("<table style=\"border-collapse:collapse; border-style:none solid solid solid; border-width:0px 1px 1px 1px; border-color:#eeeeee;width:642px; \" cellspacing=0px cellpadding=0px>");
  str(v0);
  printf("<td width=100%% height=%d colspan=2>", 260);
  printf("<iframe name=\"natrouterconf_misc_menu\" src=\"timepro.cgi?tmenu=iframe&smenu=natrouterconf_misc\" frameborder=no width=100%% height=260 align=left scrolling=yes></iframe>");
  v1 = printf("</td>");
  etr(v1);
  printf("<tr height=245 style=\"background-Color:#eeeeee\"><td id='apply_html' valign=top colspan=2></td></tr>");
  printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=2></td></tr>");
  printf((const char *)&unk_71870);
  printf("<td align=right id='apply_bt_dmztwinip1' style='padding: 4px 4px 0 0; display:none;'>");
  v3 = sub_134F4(28, v2);
  printf("<input type=\"button\" name='apply' id=\"w1_apply\" value=\"%s\" onclick=\"submit_dmztwinip(1, false)\">", v3);
  printf("</td>");
  printf("<td align=right id='apply_bt_natonoff' style='padding:4px 4px 0 0; display:none;'>");
  v5 = sub_134F4(29, v4);
  v6 = v5;
  v7 = hwinfo_get_reboot_duration(v5);
  printf("<input type=button name=\"nat_apply\" value=\"%s\" onclick=\"applyNatOnOff(%d);\">\n", v6, v7);
  printf("</td>");
  printf("<td align=right id='apply_bt_pppoe' style='padding:4px 4px 0 0; display:none;'>");
  v9 = sub_134F4(28, v8);
  printf("<input type=button name=\"pppoe_relay_apply\" value=\"%s\" onclick=\"ApplyPPPoE();\">\n", v9);
  printf("</td>");
  printf("<td align=right id='apply_bt_upnp_relay' style='padding:4px 4px 0 0; display:none;'>");
  v11 = sub_134F4(28, v10);
  printf("<input type=button name=\"upnp_relay_apply\" value=\"%s\" onclick=\"Apply_UPNP_RELAY();\">\n", v11);
  printf("</td>");
  printf("</td></tr>");
  printf("</table>");
  printf("</form>");
  return printf("<iframe name=\"natrouterconf_misc_submit\" src=\"timepro.cgi?tmenu=iframe&smenu=natrouterconf_misc_submit\" frameborder=no style='display:none;'></iframe>");
}
// EBAC: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);

//----- (0002923C) --------------------------------------------------------
int sub_2923C()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1

  sub_2907C();
  printf("<DIV id=\"%s\" style=\"display:none;\">", &unk_71C05);
  printf(
    "<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\" onclick=\"UnMaskIt(document, '%s');\">\n",
    &unk_71C05);
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:151; top:128; height:210px; width:340px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  printf("<iframe name=\"mac_list\" frameborder=no style='width:340px; height:210px;'></iframe>");
  printf("</DIV>");
  printf("</DIV>");
  v1 = sub_134F4(27, v0);
  sub_28F3C("apply_mask", v1);
  v3 = sub_134F4(565, v2);
  return sub_28F3C("reboot_mask", v3);
}

//----- (000292DC) --------------------------------------------------------
int sub_292DC()
{
  int v0; // r1@1
  int v1; // r0@5
  int v2; // r0@9
  int v3; // r5@9
  void *v4; // r7@9
  void *v5; // r4@9
  int v6; // r6@9
  int v7; // r0@10
  void *v8; // r1@10
  bool v9; // nf@12
  unsigned __int8 v10; // vf@12
  size_t v11; // r0@18
  int v12; // r1@20
  int v13; // r0@20
  int v14; // r4@20
  int v15; // r5@22
  int v16; // r3@22
  size_t v17; // r0@23
  int v18; // r1@23
  int v19; // r0@25
  int v20; // r1@25
  int v21; // r0@26
  int v22; // r0@28
  int v23; // r1@28
  int v24; // r0@28
  int v25; // r1@28
  int v26; // r0@29
  int v27; // r0@31
  int v28; // r1@31
  int v29; // r0@31
  int v30; // r0@31
  int v31; // r1@31
  int v32; // r0@32
  int v33; // r0@34
  int v34; // r1@34
  int v35; // r0@34
  signed int v36; // r4@34
  int v38; // [sp+Ch] [bp-82Ch]@7
  char v39; // [sp+22Ch] [bp-60Ch]@9
  int v40; // [sp+42Ch] [bp-40Ch]@20
  int v41; // [sp+62Ch] [bp-20Ch]@4
  int v42; // [sp+72Ch] [bp-10Ch]@9
  int v43; // [sp+7ACh] [bp-8Ch]@1
  char v44; // [sp+7B0h] [bp-88h]@8
  char v45; // [sp+7C4h] [bp-74h]@6
  char v46; // [sp+7D8h] [bp-60h]@9
  int v47; // [sp+7F8h] [bp-40h]@20
  char v48; // [sp+810h] [bp-28h]@21

  sub_133E4((int)"natrouterconf", (int)"misc");
  printf("<BODY style=\"padding:0px 0px; margin:0px 0px;\">");
  printf("<form method=post action=\"timepro.cgi\" id=\"main_form\" name=\"main_form\" style=\"margin:0;\">");
  puts("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=\"smenu\" value=\"natrouterconf_misc\">");
  printf("<table style=\"border-collapse:collapse; border-style:none none none none; width:100%%;\" cellspacing=0px cellpadding=0px>\n");
  printf("<COL WIDTH=9><COL WIDTH=220><COL width=350><COL>");
  dmztwinip_read_config("wan1", &v43);
  if ( v43 )
  {
    if ( v43 == 1 )
    {
      strcpy((char *)&v41, "DMZ");
      if ( v45 )
      {
        sprintf((char *)&v38, " IP - %s", &v45);
        strcat((char *)&v41, (const char *)&v38);
      }
    }
    else if ( v43 == 2 )
    {
      strcpy((char *)&v41, "Twin IP");
      if ( v44 )
      {
        sprintf((char *)&v38, " - %s", &v44);
        strcat((char *)&v41, (const char *)&v38);
        memset(&v46, 0, 0x20u);
        get_ip_by_hwaddr(&v46, &v44);
        memset(&v42, 0, 0x80u);
        memset(&v39, 0, 0x200u);
        v2 = dhcpd_get_all_dynamic_lease();
        v3 = 0;
        v4 = malloc(108 * v2);
        v5 = v4;
        v6 = dhcpd_get_all_dynamic_lease();
        while ( 1 )
        {
          v10 = __OFSUB__(v3, v6);
          v9 = v3++ - v6 < 0;
          if ( !(v9 ^ v10) )
            break;
          v7 = maccmp();
          v8 = v5;
          v5 = (char *)v5 + 108;
          if ( !v7 )
          {
            sf_strncpy(&v42, (char *)v8 + 44, 128);
            break;
          }
        }
        convert_euckr_to_utf8(&v42, &v39);
        if ( v46 || v39 )
        {
          if ( v39 )
            snprintf2(&v38, 544, "(%s, %s)", &v46, &v39);
          else
            snprintf2(&v38, 544, "(%s)", &v46);
          v11 = strlen((const char *)&v41);
          strncat((char *)&v41, (const char *)&v38, 255 - v11);
        }
        free(v4);
      }
    }
  }
  else
  {
    v1 = sub_134F4(745, v0);
    strcpy((char *)&v41, (const char *)v1);
  }
  strcpy((char *)&v40, "");
  v13 = sub_134F4(571, v12);
  v14 = 0;
  sub_28DBC((int)"dmztwinip1", v13, (int)&v41);
  memset(&v47, 0, 0x18u);
  strcpy((char *)&v41, "");
  strcpy((char *)&v40, "");
  read_ftp_private_port(&v47, 6);
  while ( 1 )
  {
    v15 = *(int *)((char *)&v47 + v14);
    v16 = *(int *)((char *)&v47 + v14);
    v14 += 4;
    if ( !v16 )
      break;
    snprintf2(&v48, 16, "%d, ");
    strcat((char *)&v41, &v48);
  }
  v17 = strlen((const char *)&v41);
  if ( v17 > 1 )
    *((_BYTE *)&v41 + v17 - 2) = v15;
  v19 = sub_134F4(572, v18);
  sub_28DBC((int)"ftp", v19, (int)&v41);
  if ( sysconf_nat_get(1) )
    v21 = 894;
  else
    v21 = 900;
  v22 = sub_134F4(v21, v20);
  strcpy((char *)&v41, (const char *)v22);
  strcpy((char *)&v40, "");
  v24 = sub_134F4(573, v23);
  sub_28DBC((int)"natonoff", v24, (int)&v41);
  if ( get_pppoe_relay_enabled() )
    v26 = 894;
  else
    v26 = 900;
  v27 = sub_134F4(v26, v25);
  strcpy((char *)&v41, (const char *)v27);
  strcpy((char *)&v40, "");
  v29 = sub_134F4(574, v28);
  v30 = sub_28DBC((int)"pppoe", v29, (int)&v41);
  if ( get_upnp_relay(v30) )
    v32 = 894;
  else
    v32 = 900;
  v33 = sub_134F4(v32, v31);
  strcpy((char *)&v41, (const char *)v33);
  strcpy((char *)&v40, "");
  v35 = sub_134F4(575, v34);
  v36 = 5;
  sub_28DBC((int)"upnp_relay", v35, (int)&v41);
  do
  {
    printf("<TR height=20 STYLE=\"background-Color:#%s\">");
    ++v36;
    printf("<TD></TD><TD></TD><TD CLASS=text_gray></TD><TD></TD></TR>");
  }
  while ( v36 != 13 );
  printf("</table>");
  printf("</form>");
  printf("<script>");
  printf("parent.document.getElementById('main_form').outerHTML = document.getElementById('main_form').outerHTML;");
  printf("setTimeout(function() {parent.window.clickNatrouterconfMiscTr();}, 50);");
  printf("</script>");
  return printf("</BODY>");
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E948: using guessed type int __fastcall get_ip_by_hwaddr(_DWORD, _DWORD);
// EA14: using guessed type int __fastcall dmztwinip_read_config(_DWORD, _DWORD);
// EB40: using guessed type int dhcpd_get_all_dynamic_lease(void);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// F380: using guessed type int __fastcall read_ftp_private_port(_DWORD, _DWORD);
// F458: using guessed type int __fastcall get_upnp_relay(_DWORD);
// F494: using guessed type int __fastcall sysconf_nat_get(_DWORD);
// F4B8: using guessed type int __fastcall convert_euckr_to_utf8(_DWORD, _DWORD);
// FB18: using guessed type int maccmp(void);

//----- (00029898) --------------------------------------------------------
int __fastcall sub_29898(int a1)
{
  int v1; // r7@1
  int result; // r0@1
  int v3; // r6@2
  int v4; // r0@3
  int v5; // r4@4
  int v6; // r0@4
  char *v7; // r3@4
  signed int v8; // r4@4
  int v9; // r5@5
  int v10; // r0@13
  signed int v11; // r4@13
  const char *v12; // r1@18
  int v13; // r0@20
  int v14; // r3@22
  int v15; // r0@26
  int v16; // r4@26
  int v17; // r10@29
  int v18; // r0@30
  int v19; // r6@30
  bool v20; // zf@30
  int v21; // r0@30
  int v22; // r0@34
  int v23; // r8@34
  signed int v24; // r10@35
  int v25; // r5@47
  int v26; // r0@49
  const char *v27; // r0@49
  int v28; // r0@51
  int v29; // r0@55
  int v30; // r0@61
  int v31; // r0@63
  char v32; // [sp+4h] [bp-1DCh]@3
  char v33; // [sp+84h] [bp-15Ch]@1
  int v34; // [sp+104h] [bp-DCh]@32
  int v35; // [sp+108h] [bp-D8h]@35
  char v36; // [sp+130h] [bp-B0h]@57
  char v37; // [sp+150h] [bp-90h]@32
  char v38; // [sp+170h] [bp-70h]@7
  char s[24]; // [sp+190h] [bp-50h]@3
  char v40; // [sp+1A8h] [bp-38h]@38
  int v41; // [sp+1BCh] [bp-24h]@24
  char v42; // [sp+1C0h] [bp-20h]@4

  v1 = a1;
  result = get_value_post(a1, "act", &v33, 128);
  if ( !result )
    return result;
  v3 = strcmp(&v33, "addftpport");
  if ( v3 )
  {
    v9 = strcmp(&v33, "delftpport");
    if ( !v9 )
    {
      v4 = read_ftp_private_port(s, 6);
      if ( v4 )
      {
        do
        {
          snprintf2(&v38, 32, "port%d_ch", v9);
          if ( get_value_post(v1, &v38, &v32, 32) && !strcmp(&v32, "checked") )
            *(_DWORD *)&s[4 * v9] = 0;
          ++v9;
        }
        while ( v9 != 6 );
        v4 = write_ftp_private_port(s, 6);
      }
      goto LABEL_62;
    }
    if ( !strcmp(&v33, "natonoff") )
    {
      get_value_post(v1, "nat_run", &v33, 128);
      v10 = atoi(&v33);
      v11 = v10;
      if ( v10 )
        v11 = 1;
      if ( !v11 && sysconf_nat_get(v10 + 1) || (v4 = sysconf_nat_get(1)) == 0 )
      {
        sysconf_nat_set(v11, 0);
        v12 = "@{78}";
        if ( !v11 )
          v12 = "@{77}";
        v13 = syslog_msg(1, v12);
        v8 = 1;
        v4 = saveconf(v13);
        goto LABEL_63;
      }
      goto LABEL_33;
    }
    if ( !strcmp(&v33, "pppoe") )
    {
      get_value_post(v1, "pppoe_relay", &v33, 128);
      v8 = 0;
      v14 = atoi(&v33);
      if ( v14 )
        v14 = 1;
      v41 = v14;
      v4 = set_pppoe_relay_enabled(v14);
      goto LABEL_63;
    }
    if ( !strcmp(&v33, "upnp_relay") )
    {
      v15 = get_intvalue_post(v1, "upnp_relay", &v41);
      v16 = v41;
      v4 = get_upnp_relay(v15);
      if ( v16 != v4 )
      {
        v4 = set_upnp_relay(v41);
        if ( v41 )
        {
          discover_upper_upnp_igd(v4);
          v4 = portforward_upnp_relay_init("user_pf");
          v8 = 0;
          goto LABEL_63;
        }
      }
LABEL_62:
      v8 = 0;
      goto LABEL_63;
    }
    v4 = strcmp(&v33, "dmztwinip");
    v17 = v4;
    if ( v4 )
      goto LABEL_62;
    get_value_post(v1, "wanid", &v38, 32);
    v18 = atoi(&v38);
    v19 = v18;
    v20 = v18 == 1;
    v21 = (int)"wan2";
    if ( v20 )
      v21 = (int)"wan1";
    dmztwinip_read_config(v21, &v34);
    snprintf2(&v37, 32, "w%dmode", v19);
    v4 = get_value_post(v1, &v37, &v38, 32);
    if ( !v4 )
    {
LABEL_33:
      v8 = 1;
      goto LABEL_63;
    }
    v22 = atoi(&v38);
    v23 = v22;
    if ( v34 == 2 )
    {
      dhcpd_remove_static_lease(v17, &v35);
      dhcpd_remove_dynamic_lease(v17, &v35);
      v24 = 1;
    }
    else
    {
      if ( v22 == 2 )
      {
        snprintf2(&v32, 128, "w%dhw", v19);
        get_hw_value_post(v1, &v32, &v40);
        dhcpd_remove_static_lease(0, &v40);
        dhcpd_remove_dynamic_lease(0, &v40);
        v24 = 1;
        goto LABEL_47;
      }
      v24 = 0;
    }
    if ( !v23 )
    {
      dmztwinip_apply_off(v19, &v34);
      write_file("/proc/driver/twinip", "0");
      goto LABEL_50;
    }
    if ( v23 == 1 )
    {
      if ( v34 == 2 )
      {
        dmztwinip_apply_off(v19, &v34);
        write_file("/proc/driver/twinip", "0");
      }
      snprintf2(&v32, 128, "w%dip", v19);
      get_ip_value_post(v1, &v32, &v38);
      dmztwinip_apply_dmz(v19, &v38, &v34);
LABEL_50:
      v34 = v23;
      if ( v19 == 1 )
        v28 = (int)"wan1";
      else
        v28 = (int)"wan2";
      v4 = dmztwinip_write_config(v28, &v34);
      if ( v34 == 2 )
      {
        dhcpd_remove_static_lease(0, &v35);
        dhcpd_remove_dynamic_lease(0, &v35);
        if ( v19 == 1 )
          v29 = (int)"wan1";
        else
          v29 = (int)"wan2";
        v4 = get_wan_ip(v29, &v36);
        if ( v4 )
          v4 = dhcpd_add_static_lease(&v36, &v35);
      }
      else if ( !v24 )
      {
        v8 = 0;
        goto LABEL_63;
      }
      v30 = dhcpd_stop(v4);
      v8 = 0;
      v4 = dhcpd_start(v30);
      goto LABEL_63;
    }
    if ( v23 != 2 )
      goto LABEL_50;
LABEL_47:
    snprintf2(&v32, 128, "w%dhw", v19);
    get_hw_value_post(v1, &v32, &v40);
    snprintf2(&v32, 128, (const char *)&unk_72040, v19);
    get_value_post(v1, &v32, &v38, 32);
    v25 = atoi(&v38);
    if ( v34 == 1 )
      dmztwinip_apply_off(v19, &v34);
    v26 = get_twinip_wan_virtual_ip("wan1");
    snprintf2(&v32, 128, "1 %s ", v26);
    v27 = (const char *)get_twinip_wan_virtual_ip("wan2");
    strcat(&v32, v27);
    write_file("/proc/driver/twinip", &v32);
    dmztwinip_apply_twinip(v19, &v40, v25, &v34);
    goto LABEL_50;
  }
  memset(s, 0, 0x18u);
  v4 = get_value_post(v1, "ftp_port", &v32, 128);
  if ( !v4 )
    goto LABEL_62;
  v5 = read_ftp_private_port(s, 6);
  v6 = atoi(&v32);
  v7 = &v42 + 4 * v5;
  v8 = v3;
  *((_DWORD *)v7 - 12) = v6;
  v4 = write_ftp_private_port(s, 6);
LABEL_63:
  v31 = signal_update(v4);
  signal_save(v31);
  if ( v8 )
    signal_reboot(3);
  return 1;
}
// E798: using guessed type int __fastcall dhcpd_start(_DWORD);
// E7C8: using guessed type int __fastcall dmztwinip_write_config(_DWORD, _DWORD);
// E8A0: using guessed type int __fastcall get_intvalue_post(_DWORD, _DWORD, _DWORD);
// E8AC: using guessed type int __fastcall dmztwinip_apply_dmz(_DWORD, _DWORD, _DWORD);
// EA14: using guessed type int __fastcall dmztwinip_read_config(_DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// ED74: using guessed type int __fastcall sysconf_nat_set(_DWORD, _DWORD);
// EDF8: using guessed type int __fastcall dhcpd_remove_static_lease(_DWORD, _DWORD);
// F0BC: using guessed type int __fastcall set_pppoe_relay_enabled(_DWORD);
// F110: using guessed type int __fastcall saveconf(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F2FC: using guessed type int __fastcall set_upnp_relay(_DWORD);
// F380: using guessed type int __fastcall read_ftp_private_port(_DWORD, _DWORD);
// F3F8: using guessed type int __fastcall discover_upper_upnp_igd(_DWORD);
// F458: using guessed type int __fastcall get_upnp_relay(_DWORD);
// F470: using guessed type int syslog_msg(_DWORD, const char *, ...);
// F494: using guessed type int __fastcall sysconf_nat_get(_DWORD);
// F59C: using guessed type int __fastcall write_ftp_private_port(_DWORD, _DWORD);
// F650: using guessed type int __fastcall dmztwinip_apply_off(_DWORD, _DWORD);
// F6B0: using guessed type int __fastcall signal_reboot(_DWORD);
// F7DC: using guessed type int __fastcall get_hw_value_post(_DWORD, _DWORD, _DWORD);
// F800: using guessed type int __fastcall dhcpd_add_static_lease(_DWORD, _DWORD);
// F884: using guessed type int __fastcall dhcpd_stop(_DWORD);
// F8CC: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);
// F920: using guessed type int __fastcall get_twinip_wan_virtual_ip(_DWORD);
// FB3C: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// FC38: using guessed type int __fastcall dmztwinip_apply_twinip(_DWORD, _DWORD, _DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);
// FD04: using guessed type int __fastcall dhcpd_remove_dynamic_lease(_DWORD, _DWORD);
// FD34: using guessed type int __fastcall write_file(_DWORD, _DWORD);
// FE3C: using guessed type int __fastcall portforward_upnp_relay_init(_DWORD);
// 29898: using guessed type char s[24];

//----- (00029EBC) --------------------------------------------------------
int __fastcall sub_29EBC(int a1)
{
  int v1; // r7@1
  char *v2; // r0@1
  int v3; // r0@1
  int v4; // r0@3
  int v5; // r1@3
  char *v6; // r5@3
  char *v7; // r4@4
  int v8; // r0@6
  int v9; // r0@6
  int v10; // r1@6
  char *v11; // r4@7
  int v12; // r0@9
  int v13; // r0@9
  int v14; // r1@9
  int v15; // r0@11
  int v16; // r0@11
  char *v17; // r2@12
  int v18; // r1@14
  int v19; // r0@14
  int v20; // r0@15
  int v21; // r1@15
  int v22; // r2@15
  signed int v23; // r0@17
  int v24; // r0@17
  int v25; // r1@18
  int v26; // r0@18
  int v27; // r0@19
  char *v28; // r2@20
  int v29; // r1@22
  int v30; // r0@22
  int v31; // r0@22
  const char *v32; // r1@22
  int v33; // r2@22
  int v34; // r1@30
  int v35; // r0@30
  int v36; // r0@30
  char *v37; // r2@31
  int v38; // r1@33
  int v39; // r0@33
  int v40; // r1@33
  char *v41; // r2@33
  int v42; // r4@35
  int v43; // r0@35
  int v44; // r0@35
  int v45; // r0@36
  const char *v46; // r0@38
  char v48; // [sp+14h] [bp-224h]@14
  char v49; // [sp+114h] [bp-124h]@17
  int v50; // [sp+194h] [bp-A4h]@3
  char v51; // [sp+198h] [bp-A0h]@27
  int v52; // [sp+1ACh] [bp-8Ch]@15
  char v53; // [sp+1C0h] [bp-78h]@16
  char v54; // [sp+1D4h] [bp-64h]@16
  char dest[4]; // [sp+1E8h] [bp-50h]@1
  char s; // [sp+1ECh] [bp-4Ch]@1
  char v57; // [sp+1FCh] [bp-3Ch]@1
  int v58; // [sp+210h] [bp-28h]@1
  int v59; // [sp+214h] [bp-24h]@1
  char v60; // [sp+218h] [bp-20h]@33

  v1 = a1;
  v58 = 0;
  v59 = 0;
  *(_DWORD *)dest = 0;
  memset(&s, 0, 0x10u);
  v2 = getenv("REMOTE_ADDR");
  get_internal_pc_hardware_address(v2, &v57);
  v3 = (int)"wan1";
  if ( v1 != 1 )
    v3 = (int)"wan2";
  v4 = dmztwinip_read_config(v3, &v50);
  str(v4);
  puts("<td colspan=3>");
  printf("<input type=hidden name=opmode value=%d>", v50);
  v6 = "checked";
  if ( v50 )
    v7 = "";
  else
    v7 = "checked";
  v8 = sub_134F4(745, v5);
  v9 = printf(
         "<input type=radio id='w%dmode_off' name=\"w%dmode\" value=0 onclick='select_twinipdmz(this.value,%d)' %s><label for='w%dmode_off'><span class=\"bold_item_text\">%s</span></label>",
         v1,
         v1,
         v1,
         v7,
         v1,
         v8);
  br(v9);
  if ( v50 == 1 )
    v11 = "checked";
  else
    v11 = "";
  v12 = sub_134F4(123, v10);
  v13 = printf(
          "<input type=radio id='w%dmode_dmz' name=\"w%dmode\" value=1 onclick='select_twinipdmz(this.value,%d)' %s><label for='w%dmode_dmz'><span class=\"bold_item_text\">DMZ</span> (%s)</label>",
          v1,
          v1,
          v1,
          v11,
          v1,
          v12);
  br(v13);
  if ( v50 != 2 )
    v6 = "";
  v15 = sub_134F4(1123, v14);
  printf((const char *)&unk_721EF, v1, v1, v1, v6, v1, v15);
  v16 = puts("</td>");
  etr(v16);
  print_blank_line(2, 5);
  printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=2></td></tr>");
  if ( v50 == 1 )
    v17 = "block";
  else
    v17 = "none";
  printf("<tr id=\"w%dipaddr\" style='display:%s; height:30px;'>\n", v1, v17);
  v19 = sub_134F4(389, v18);
  printf("<td style='padding-left:9px;'>%s</td>", v19);
  puts("<td >");
  snprintf2(&v48, 256, "w%dip", v1);
  if ( v50 == 1 )
  {
    v20 = (int)&v48;
    v21 = (int)&v52;
    v22 = 2;
  }
  else
  {
    get_ifconfig("br0", &v54, &v53);
    v20 = (int)&v48;
    v21 = (int)&v54;
    v22 = 3;
  }
  v23 = sub_11D7C(v20, v21, v22);
  v24 = get_remote_addr(v23);
  snprintf2(&v49, 128, "%s", v24);
  print_nbsp(1);
  if ( strcmp(&v49, "Twin IP") )
  {
    printf(
      "<input type=checkbox id=ip_checkbox%d name='re_ip' onclick=\"OnCheckEnableIP(this, '%s', '%s')\"><label for='ip_checkbox%d'>",
      v1,
      &v48,
      &v49,
      v1);
    v26 = sub_134F4(387, v25);
    printf((const char *)v26, &v49);
    printf("</label>");
  }
  v27 = puts("</td>");
  etr(v27);
  if ( v50 == 2 )
    v28 = "block";
  else
    v28 = "none";
  printf("<tr id=\"w%dhwaddr\" style='display:%s; height:30px;'>\n", v1, v28);
  v30 = sub_134F4(512, v29);
  printf("<td style='padding-left:10px;'>%s</td>", v30);
  puts("<td align=left>");
  v31 = snprintf2(&v48, 256, "w%dhw", v1);
  if ( v50 == 2 )
    v31 = (int)&v48;
  else
    v32 = 0;
  if ( v50 == 2 )
  {
    v32 = &v51;
    v33 = 0;
  }
  else
  {
    v31 = (int)&v48;
  }
  if ( v50 != 2 )
    v33 = (int)v32;
  sub_121A0(v31, v32, v33);
  print_nbsp(3);
  snprintf2(&v48, 256, (const char *)&unk_723E8, v1);
  printf(
    "<button type='button' name='macbutton_dynamic' style='width: 20px; height: 20px; vertical-align: top; position: relative;' onclick='popup_search_mac(\"%s\");'>",
    &v48);
  printf("<img src='/images2/fw_search.gif' style='width:16px; height:16px; position: absolute; left: 0; top: 0;'></button>");
  print_nbsp(1);
  convert_mac(&v57);
  printf(
    "<input type=checkbox id='mac_checkbox%d' name=\"get_w%dhosthw\" onclick='get_hwaddr(this,%d,\"%s\")'>\n",
    v1,
    v1,
    v1,
    &v57);
  v35 = sub_134F4(347, v34);
  printf("<label for='mac_checkbox%d'>%s</label>", v1, v35);
  v36 = puts("</td>");
  etr(v36);
  if ( v50 == 2 )
    v37 = "block";
  else
    v37 = "none";
  printf("<tr id=\"w%dlease_time\" style='display:%s; height:30px; '>\n", v1, v37);
  v39 = sub_134F4(1124, v38);
  printf("<td style='padding-left:10px;'>%s</td>", v39);
  puts("<td colspan=7 align=left>");
  read_real_ipclone_leasetime();
  v40 = v1 - 1;
  v41 = &v60 + 4 * (v1 - 1);
  if ( !*((_DWORD *)v41 - 2) )
    *((_DWORD *)v41 - 2) = 60;
  v42 = *((_DWORD *)&v60 + v40 - 2);
  v43 = sub_134F4(878, v40);
  printf(
    "<input type=text name=\"w%dleasetime\" id=\"w%dleasetime\"size=5 maxlength=5 value=\"%d\" style='width:50px;'> %s\n",
    v1,
    v1,
    v42,
    v43);
  v44 = puts("</td>");
  etr(v44);
  if ( !dest[0] )
  {
    v45 = (int)"wan2";
    if ( v1 == 1 )
      v45 = (int)"wan1";
    v46 = (const char *)get_twinip_wan_virtual_ip(v45);
    strcpy(dest, v46);
  }
  return printf("<script>select_twinipdmz(%d,%d); </script>", v50, v1);
}
// E7F8: using guessed type int __fastcall get_remote_addr(_DWORD);
// EA14: using guessed type int __fastcall dmztwinip_read_config(_DWORD, _DWORD);
// EB70: using guessed type int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EE10: using guessed type int __fastcall convert_mac(_DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F308: using guessed type int read_real_ipclone_leasetime(void);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// F788: using guessed type int __fastcall br(_DWORD);
// F920: using guessed type int __fastcall get_twinip_wan_virtual_ip(_DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// 2A300: using guessed type void *off_2A300;

//----- (0002A3B0) --------------------------------------------------------
int __fastcall sub_2A3B0(const char *a1)
{
  const char *v1; // r4@1
  int result; // r0@2
  int v3; // r5@3
  int v4; // r0@4
  int v5; // r4@4
  int v6; // r0@4
  int v7; // r1@4
  int v8; // r0@4
  int v9; // r1@4
  int v10; // r0@4
  int v11; // r1@4
  int v12; // r0@4
  int v13; // r0@4
  int v14; // r0@4
  int v15; // r1@9
  int v16; // r0@9
  int v17; // r0@9
  int v18; // r0@11
  int v19; // r1@11
  int v20; // r0@11
  char *v21; // r4@11
  int v22; // r1@11
  char *v23; // r5@12
  int v24; // r0@14
  int v25; // r1@14
  int v26; // r0@16
  int v27; // r0@16
  int v28; // r0@16
  int v29; // r1@16
  int v30; // r0@16
  int v31; // r1@16
  int v32; // r0@16
  int v33; // r0@20
  int v34; // r1@20
  int v35; // r0@20
  char *v36; // r4@20
  int v37; // r1@20
  char *v38; // r5@21
  int v39; // r0@23
  int v40; // r1@23
  int v41; // r0@25
  int v42; // r0@25
  int v43; // r0@25
  int v44; // r1@25
  int v45; // r0@25
  int v46; // r0@27
  int v47; // r1@27
  int v48; // r0@27
  char *v49; // r4@27
  int v50; // r0@27
  int v51; // r1@27
  char *v52; // r5@28
  int v53; // r0@30
  int v54; // r0@30
  int v55; // r1@30
  int v56; // r0@32
  int v57; // r0@32
  int v58; // [sp+0h] [bp-28h]@4

  v1 = a1;
  if ( !strcmp(a1, "dmztwinip1") )
  {
    printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=2></td></tr>");
    print_blank_line(2, 2);
    return sub_29EBC(1);
  }
  v3 = strcmp(v1, "ftp");
  if ( !v3 )
  {
    printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=8></td></tr>");
    print_blank_line(8, 4);
    memset(&v58, 0, 0x18u);
    v4 = read_ftp_private_port(&v58, 6);
    v5 = 0;
    v6 = printf("<input type=hidden name=\"ftp_port_count\" value=\"%d\">\n", v4);
    str(v6);
    v8 = sub_134F4(542, v7);
    printf("<td rowspan=2 style='padding-left:9px;'>%s</td>", v8);
    puts("<td colspan=5>");
    v10 = sub_134F4(788, v9);
    printf((const char *)v10);
    print_nbsp(3);
    puts("<input type=text name=\"ftp_port\" maxlength=5 size=5 value=\"\">");
    puts("</td>");
    printf("<td align=right style='width:10%%; height:25px;'>\n");
    v12 = sub_134F4(3, v11);
    printf("<input type=button name=\"ftp_apply\" value=\"%s\" onclick=\"addFtpPort(%d);\">\n", v12, 5);
    puts("</td>");
    v13 = printf("<td></td>");
    v14 = etr(v13);
    str(v14);
    do
    {
      puts("<td width=60>");
      printf("<input type=checkbox id='port%d_ch' name=\"port%d_ch\">", v5, v5);
      printf("<input type=hidden name=\"port%d\" value=\"%d\">", v5, *(int *)((char *)&v58 + v3));
      if ( *(int *)((char *)&v58 + v3) )
      {
        printf("<label for='port%d_ch'>", v5);
        printf("%d", *(int *)((char *)&v58 + v3));
        printf("</label>");
      }
      else
      {
        putchar(45);
      }
      ++v5;
      puts("</td>");
      v3 += 4;
    }
    while ( v5 != 5 );
    puts("<td align=right style='height:25px;'>");
    v16 = sub_134F4(118, v15);
    printf("<input type=button name=\"ftp_del\" value=\"%s\" onclick=\"delFtpPort();\">\n", v16);
    puts("</td>");
    v17 = puts("<td></td>");
    return etr(v17);
  }
  if ( !strcmp(v1, "natonoff") )
  {
    printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=2></td></tr>");
    v18 = print_blank_line(2, 2);
    str(v18);
    v20 = sub_134F4(568, v19);
    v21 = "";
    printf("<td style='padding-left:9px;'>%s</td>", v20);
    puts("<td colspan=5>");
    if ( sysconf_nat_get(1) )
      v23 = "checked";
    else
      v23 = "";
    v24 = sub_134F4(894, v22);
    printf("<input type=radio id='nat_on' name=\"nat_run\" value=1 %s><label for='nat_on'>%s</label>", v23, v24);
    print_nbsp(10);
    if ( !sysconf_nat_get(1) )
      v21 = "checked";
    v26 = sub_134F4(900, v25);
    printf("<input type=radio id='nat_off' name=\"nat_run\" value=0 %s><label for='nat_off'>%s</label>", v21, v26);
    printf("</td>");
    v27 = printf("<td colspan=2></td>");
    v28 = etr(v27);
    str(v28);
    printf("<td></td>");
    printf((const char *)&unk_729E3);
    v30 = sub_134F4(566, v29);
    printf((const char *)v30);
    v32 = sub_134F4(567, v31);
    printf("%s", v32);
LABEL_17:
    v17 = printf("</span></td>");
    return etr(v17);
  }
  if ( !strcmp(v1, "pppoe") )
  {
    printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=2></td></tr>");
    v33 = print_blank_line(2, 2);
    str(v33);
    v35 = sub_134F4(795, v34);
    v36 = "";
    printf("<td style='padding-left:9px;'>%s</td>", v35);
    puts("<td colspan=7>");
    if ( get_pppoe_relay_enabled() )
      v38 = "checked";
    else
      v38 = "";
    v39 = sub_134F4(894, v37);
    printf("<input type=radio id='pppoe_on' name=\"pppoe_relay\" value=1 %s><label for='pppoe_on'>%s</label>", v38, v39);
    print_nbsp(10);
    if ( !get_pppoe_relay_enabled() )
      v36 = "checked";
    v41 = sub_134F4(900, v40);
    printf(
      "<input type=radio id='pppoe_off' name=\"pppoe_relay\" value=0 %s><label for='pppoe_off'>%s</label>",
      v36,
      v41);
    v42 = printf("</td>");
    etr(v42);
    v43 = print_blank_line(2, 5);
    str(v43);
    printf("<td></td>");
    printf((const char *)&unk_729E3);
    v45 = sub_134F4(794, v44);
    printf((const char *)v45);
    goto LABEL_17;
  }
  result = strcmp(v1, "upnp_relay");
  if ( !result )
  {
    printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=2></td></tr>");
    v46 = print_blank_line(2, 2);
    str(v46);
    v48 = sub_134F4(1133, v47);
    v49 = "";
    printf("<td style='padding-left:9px;'>%s</td>", v48);
    v50 = puts("<td colspan=7>");
    if ( get_upnp_relay(v50) )
      v52 = "checked";
    else
      v52 = "";
    v53 = sub_134F4(894, v51);
    printf(
      "<input type=radio id='upnp_relay_on' name=\"upnp_relay\" value=1 %s><label for='upnp_relay_on'>%s</label>",
      v52,
      v53);
    v54 = print_nbsp(10);
    if ( !get_upnp_relay(v54) )
      v49 = "checked";
    v56 = sub_134F4(900, v55);
    printf(
      "<input type=radio id='upnp_relay_off' name=\"upnp_relay\" value=0 %s><label for='upnp_relay_off'>%s</label>",
      v49,
      v56);
    v57 = printf("</td>");
    etr(v57);
    result = print_blank_line(2, 5);
  }
  return result;
}
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F380: using guessed type int __fastcall read_ftp_private_port(_DWORD, _DWORD);
// F458: using guessed type int __fastcall get_upnp_relay(_DWORD);
// F494: using guessed type int __fastcall sysconf_nat_get(_DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (0002A8C0) --------------------------------------------------------
int __fastcall sub_2A8C0(const char *a1, int a2)
{
  const char *v2; // r6@1
  int v3; // r5@1

  v2 = a1;
  v3 = a2;
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%% ID=%s_table STYLE=\"display:none;\">", a1);
  printf("<colgroup><col width=25%%></colgroup>");
  printf(
    "<tr><td height=20 valign=center style=\"padding:3px;width:180px;\">&nbsp; <b>%s</b></td><td align=right>%s</td></tr>",
    v3);
  sub_2A3B0(v2);
  return puts((const char *)&unk_6450B);
}

//----- (0002A928) --------------------------------------------------------
int __fastcall sub_2A928(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r1@1
  int v8; // r0@1
  int v9; // r1@1
  int v10; // r0@1
  int v11; // r1@1
  int v12; // r0@1

  v2 = sub_29898(a2);
  sub_133E4((int)"natrouterconf", (int)"misc");
  sub_28E88(1);
  puts("<form method=post action=\"timepro.cgi\" name=\"natrouterconf_misc_ftp_fm\">");
  puts("<input type=hidden name=\"tmenu\" value='iframe'>");
  puts("<input type=hidden name=\"smenu\" value='natrouterconf_misc_submit'>");
  puts("<input type=hidden name=\"act\" value=\"dmztwinip\">");
  puts("<input type=hidden name=\"ftp_port\" value=\"\">");
  puts("<input type=hidden name=\"port0_ch\" value=\"\">");
  puts("<input type=hidden name=\"port1_ch\" value=\"\">");
  puts("<input type=hidden name=\"port2_ch\" value=\"\">");
  puts("<input type=hidden name=\"port3_ch\" value=\"\">");
  puts("<input type=hidden name=\"port4_ch\" value=\"\">");
  printf("</form>");
  puts("<form method=post action=\"timepro.cgi\" name=\"natrouterconf_misc_natonoff_fm\">");
  puts("<input type=hidden name=\"tmenu\" value='iframe'>");
  puts("<input type=hidden name=\"smenu\" value='natrouterconf_misc_submit'>");
  puts("<input type=hidden name=\"act\" value=\"natonoff\">");
  puts("<input type=hidden name=\"nat_run\" value=\"\">");
  printf("</form>");
  puts("<form method=post action=\"timepro.cgi\" name=\"natrouterconf_misc_pppoe_fm\">");
  puts("<input type=hidden name=\"tmenu\" value='iframe'>");
  puts("<input type=hidden name=\"smenu\" value='natrouterconf_misc_submit'>");
  puts("<input type=hidden name=\"act\" value=\"pppoe\">");
  puts("<input type=hidden name=\"pppoe_relay\" value=\"\">");
  printf("</form>");
  puts("<form method=post action=\"timepro.cgi\" name=\"natrouterconf_misc_upnp_relay_fm\">");
  puts("<input type=hidden name=\"tmenu\" value='iframe'>");
  puts("<input type=hidden name=\"smenu\" value='natrouterconf_misc_submit'>");
  puts("<input type=hidden name=\"act\" value=\"upnp_relay\">");
  puts("<input type=hidden name=\"upnp_relay\" value=\"\">");
  printf("</form>");
  printf("<table>");
  puts("<tr height=245 style=\"background-Color:#eeeeee\"><td id='apply_html' valign=top colspan=2>");
  v4 = sub_134F4(571, v3);
  sub_2A8C0("dmztwinip1", v4);
  v6 = sub_134F4(572, v5);
  sub_2A8C0("ftp", v6);
  v8 = sub_134F4(573, v7);
  sub_2A8C0("natonoff", v8);
  v10 = sub_134F4(574, v9);
  sub_2A8C0("pppoe", v10);
  v12 = sub_134F4(575, v11);
  sub_2A8C0("upnp_relay", v12);
  printf("</td></tr>");
  printf("</table>");
  printf("<script>");
  printf("parent.document.getElementById('apply_html').innerHTML = document.getElementById('apply_html').innerHTML;");
  if ( v2 )
    printf("parent.document.getElementsByName('natrouterconf_misc_menu')[0].contentWindow.document.getElementsByName('natrouterconf_misc_status')[0].contentWindow.location.reload();");
  printf("setTimeout(function() {UnMaskIt(parent.document, 'apply_mask');}, 500);");
  return printf("</script>");
}

//----- (0002ABA0) --------------------------------------------------------
int __fastcall sub_2ABA0(int a1)
{
  int v1; // r4@1
  int result; // r0@1
  int v3; // r0@3
  int v4; // r10@3
  int v5; // r7@3
  int v6; // r11@3
  int v7; // r0@3
  int v8; // r1@3
  int v9; // r0@3
  int v10; // r1@3
  int v11; // r0@3
  int v12; // r0@3
  int v13; // r0@3
  const char *v14; // r8@4
  const char *v15; // r9@5
  signed int v16; // r4@5
  int v17; // r5@5
  signed int v18; // r3@6
  int v19; // r0@7
  int v20; // r1@11
  int v21; // r0@11
  int v22; // r0@11
  int *v23; // [sp+4h] [bp-BC8Ch]@5
  int v24; // [sp+10h] [bp-BC80h]@3
  int v25; // [sp+BC10h] [bp-80h]@1
  int v26; // [sp+BC30h] [bp-60h]@5
  int v27; // [sp+BC34h] [bp-5Ch]@5
  int v28; // [sp+BC38h] [bp-58h]@5
  int v29; // [sp+BC3Ch] [bp-54h]@5
  int v30; // [sp+BC40h] [bp-50h]@5
  int v31; // [sp+BC44h] [bp-4Ch]@5
  int v32; // [sp+BC54h] [bp-3Ch]@5
  int v33; // [sp+BC58h] [bp-38h]@2

  v1 = a1;
  result = get_value(a1, "formname", &v25, 32);
  if ( result )
  {
    result = get_value(v1, "macprefix", &v33, 16);
    if ( result )
    {
      sub_133E4((int)"natrouterconf", (int)"misc");
      printf("<style>");
      printf("body { margin: 0; padding: 0; }");
      printf("tr { border: 1px solid #CCC; }");
      printf(".selected { background-color: #E8E8E8 !important; }");
      printf("</style>");
      memset(&v24, 0, 0xBC00u);
      v3 = get_hostinfo_from_arp("br0", 256, &v24);
      v4 = 0;
      v5 = 0;
      v6 = v3;
      v7 = print_start_content_table(v3);
      str(v7);
      v9 = sub_134F4(783, v8);
      printf(
        "<td style='text-align:center; padding: 4px 0 3px 0; background-color:#EEE; width: 170px; border-right: 1px solid #CCC;'>%s</td>",
        v9);
      v11 = sub_134F4(782, v10);
      v12 = printf("<td style='text-align:center; background-color: #EEE;'>%s</td>", v11);
      v13 = etr(v12);
      while ( v5 < v6 )
      {
        v14 = (const char *)(&v24 + 47 * v5 + 37);
        v13 = strcmp(v14, "00:00:00:00:00:00");
        if ( v13 )
        {
          convert_mac(v14);
          printf(
            "<tr onmouseover='trMouseOverEvent(this);' onmouseout='trMouseOutEvent(this);' onclick='SelectMacFromPopup_%d(); UnMaskIt(parent.document, \"search_popup\");'>",
            v5);
          printf("<td style='padding: 5px 10px 4px 10px; border-right: 1px solid #CCC;'>");
          v15 = (const char *)(&v24 + 47 * v5 + 32);
          printf("<script>");
          sscanf(v14, "%02X-%02X-%02X-%02X-%02X-%02X", &v26, &v27, &v28, &v29, &v30, &v31);
          v23 = &v32;
          sscanf(v15, "%03d.%03d.%03d.%03d");
          printf("function SelectMacFromPopup_%d() {", v5);
          v16 = 1;
          v17 = 0;
          do
          {
            v18 = v16++;
            printf("parent.document.%s.%s%d.value = '%02X';", &v25, &v33, v18, *(int *)((char *)&v26 + v17 * 4), v23);
            ++v17;
          }
          while ( v16 != 7 );
          putchar(125);
          printf("</script>");
          printf("<span>%s</span></td>", v14);
          v19 = printf("<td style='padding-left: 10px;'>%s</td>", v15);
          v13 = etr(v19);
          ++v4;
        }
        ++v5;
      }
      if ( !v4 )
      {
        str(v13);
        printf("<td colspan=2>");
        v21 = sub_134F4(784, v20);
        v22 = printf("%s", v21);
        v13 = etr(v22);
      }
      print_end_content_table(v13);
      result = printf("</table>");
    }
  }
  return result;
}
// EA20: using guessed type int __fastcall get_hostinfo_from_arp(_DWORD, _DWORD, _DWORD);
// EE10: using guessed type int __fastcall convert_mac(_DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// F8A8: using guessed type int __fastcall print_start_content_table(_DWORD);
// FBA8: using guessed type int __fastcall print_end_content_table(_DWORD);

//----- (0002AE7C) --------------------------------------------------------
int __fastcall sub_2AE7C(int a1, int a2)
{
  int v2; // r2@1
  int result; // r0@2
  int v4; // r3@4
  int v5; // r3@8

  v2 = *(_DWORD *)(a1 + 4);
  if ( a2 )
  {
    result = 0;
    while ( v2 )
    {
      v5 = *(_DWORD *)(v2 + 528);
      v2 = *(_DWORD *)(v2 + 544);
      if ( v5 == 1 )
        ++result;
    }
  }
  else
  {
    result = 0;
    while ( v2 )
    {
      v4 = *(_DWORD *)(v2 + 528);
      v2 = *(_DWORD *)(v2 + 544);
      if ( !v4 )
        ++result;
    }
  }
  return result;
}

//----- (0002AECC) --------------------------------------------------------
int sub_2AECC()
{
  printf("<TR height=24 STYLE=\"cursor:pointer; background-Color:#%s\">");
  return printf("<TD width=100%% colspan=10 CLASS=text_gray></TD></TR>");
}

//----- (0002AF04) --------------------------------------------------------
int __fastcall sub_2AF04(unsigned int a1)
{
  unsigned int v1; // r4@1
  const char *v2; // r0@3
  _UNKNOWN *v3; // r0@5
  const char *v4; // r0@7
  int v5; // r1@9
  int v6; // r0@9

  v1 = a1;
  printf("<TR height=\"24\" ID=\"_-new_line\" class=\"fw_tr\" style=\"cursor:pointer; background-color:#%s;\">\n");
  puts("<TD align=\"left\" width=\"30\" class=\"fw_td\">");
  if ( v1 <= 1 || v1 != 2 )
    v2 = "<SPAN id=\"_-new_line_span_1\" class=\"fw_span\" style=\"padding-left:5px;\"\t\t\t onclick=\"onClickedFWRule('internet','','','','','','','','','','','','','','','','','');\">";
  else
    v2 = "<SPAN id=\"_-new_line_span_1\" class=\"fw_span\" style=\"padding-left:5px;\"\t\t\t onclick=\"onClickedFWRule('wifi','','','','','','','','','','','','','','','','','');\">";
  puts(v2);
  v3 = sub_126C4();
  printf("<img src=\"/%s/pf_new_rule.gif\">\n", v3);
  puts("</SPAN></TD>");
  puts("<TD align=\"left\" colspan=\"9\" class=\"fw_td\">");
  puts("<a name=\"_-new_line\" class=\"fw_a\">");
  if ( v1 <= 1 || v1 != 2 )
    v4 = "<SPAN ID=\"_-new_line_span_2\" class=\"fw_span\" style=\"color:#4789FF;\"\t\t \tonclick=\"onClickedFWRule('internet','','','','','','','','','','','','','','','','','');\">";
  else
    v4 = "<SPAN ID=\"_-new_line_span_2\" class=\"fw_span\" style=\"color:#4789FF;\"\t\t \tonclick=\"onClickedFWRule('wifi','','','','','','','','','','','','','','','','','');\">";
  printf(v4);
  v6 = sub_134F4(291, v5);
  return printf("%s</SPAN></A></TD></TR>", v6);
}

//----- (0002AFDC) --------------------------------------------------------
int sub_2AFDC()
{
  puts("<style type=\"text/css\">");
  puts(".fw_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".fw_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".fw_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".left_padding_td {");
  puts("\tpadding:0 0 0 5; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".fw_p {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".fw_span {");
  puts("\tpadding:0 0 0 0; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".fw_select {");
  puts("\tpadding:0 0 0 0; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".fw_textbox {");
  puts("\tpadding:1px 0 1px 0; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".fw_button {");
  puts("\tpadding:0 1px 0 1px; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".fw_checkbox {");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".fw_a {");
  puts("\tvertical-align:middle; text-decoration:none;");
  puts("\tdisplay:inline-block; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;");
  puts("}");
  puts(".fw_overflowable {");
  puts("\tpadding:0 0 0 0; margin:0 0 0 0; border:none none none none; vertical-align:middle; text-decoration:none;");
  puts("\tdisplay:inline-block; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;");
  puts("}");
  puts(".fw_opacity_30 {");
  puts("\topacity:0.3;");
  puts("\t-moz-opacity:0.3;");
  puts("\t-khtml-opacity:0.3;");
  puts("\tfilter:alpha(opacity=30);");
  puts("}");
  printf("::-webkit-input-placeholder {");
  printf("\tcolor:#B4B4B4;");
  putchar(125);
  printf(":-moz-placeholder {");
  printf("\tcolor:#B4B4B4;");
  printf("\topacity:1;");
  putchar(125);
  printf((const char *)&unk_6C3AA);
  printf("\tcolor:#B4B4B4;");
  printf("\topacity:1;");
  putchar(125);
  printf(":-ms-input-placeholder {");
  printf("\tcolor:#B4B4B4;");
  putchar(125);
  return printf("</style>");
}

//----- (0002B2B8) --------------------------------------------------------
int __fastcall sub_2B2B8(int a1, char *a2)
{
  int v2; // r6@1
  char *v3; // r0@3
  int v4; // r1@5
  char *v5; // r1@6
  char *v6; // r0@7
  char *v7; // r1@9
  char *v8; // r0@10
  char *v9; // r0@12
  bool v10; // zf@12
  const char *v11; // r1@12
  char *v12; // r5@19
  signed int v13; // r4@19
  int v14; // r0@20
  char *v15; // r3@20
  int v16; // r0@23
  char v18; // [sp+18h] [bp-38h]@7
  char v19; // [sp+1Dh] [bp-33h]@10
  char v20; // [sp+22h] [bp-2Eh]@14
  char v21; // [sp+27h] [bp-29h]@17
  char dest; // [sp+2Ch] [bp-24h]@3

  v2 = a1;
  if ( a2 && *a2 )
  {
    v3 = &dest;
  }
  else
  {
    a2 = "";
    v3 = &dest;
  }
  strcpy(v3, a2);
  if ( dest )
  {
    v5 = strtok(&dest, ".");
    if ( v5 )
    {
      v6 = &v18;
    }
    else
    {
      v6 = &v18;
      v5 = "0";
    }
    strcpy(v6, v5);
    v7 = strtok(0, ".");
    if ( v7 )
    {
      v8 = &v19;
    }
    else
    {
      v8 = &v19;
      v7 = "0";
    }
    strcpy(v8, v7);
    v9 = strtok(0, ".");
    v11 = v9;
    v10 = v9 == 0;
    if ( v9 )
      v9 = &v20;
    else
      v11 = "0";
    if ( v10 )
      v9 = &v20;
    strcpy(v9, v11);
    strcpy(&v21, (const char *)&unk_7340C);
  }
  else
  {
    v18 = 0;
    v21 = 0;
    v20 = 0;
    v19 = 0;
  }
  v12 = &v18;
  v13 = 1;
  do
  {
    v14 = sub_134F4(401, v4);
    v15 = v12;
    v12 += 5;
    printf(
      "<input type=text name=\"%s%d\" maxlength=3 size=3 style=\"width:25px; ime-mode:disabled;\" class=\"fw_textbox\" value=\"%s\" onfocus=\"this.select();\" onkeypress=\"return IPKeyDown('%s', %d);\" title=\"%s%d\" onkeydown=\"ButtonViewControl('modify'); return true;\" onkeyup=\"IPKeyUp('%s',%d);\">",
      v2,
      v13,
      v15,
      v2,
      v13,
      v14,
      v13,
      v2,
      v13,
      *(_DWORD *)&v18);
    v10 = v13++ == 4;
    if ( !v10 )
      putchar(46);
  }
  while ( v13 != 5 );
  v16 = sub_134F4(401, v4);
  return printf(
           "~<input type=text name=\"%s%d\" maxlength=3 size=3 style=\"width:25px; ime-mode:disabled;\" onfocus=\"this.select();\"                    class=\"fw_textbox\" onkeypress=\"return IPKeyDown('%s', %d);\" title=\"%s%d\" \t\t\tonkeyup=\"IPKeyUp('%s',%d);\" onkeydown=\"ButtonViewControl('modify'); return true;\">",
           v2,
           5,
           v2,
           5,
           v16,
           5,
           v2,
           5);
}

//----- (0002B430) --------------------------------------------------------
char *__fastcall sub_2B430(int a1)
{
  int v1; // r5@1
  int v2; // r1@2
  int v3; // r0@2
  int v4; // r1@2
  int v5; // r0@2
  int v6; // r1@2
  int v7; // r0@2
  int v8; // r1@2
  int v9; // r0@2
  int v10; // r1@2
  int v11; // r0@2
  int v12; // r1@2
  int v13; // r0@2
  int v14; // r1@2
  int v15; // r0@2
  int v16; // r1@2
  int v17; // r0@2

  v1 = a1;
  if ( !byte_985A0[0] )
  {
    sf_strncpy(byte_985A0, "Mon", 6);
    v3 = sub_134F4(289, v2);
    sf_strncpy(&unk_985A6, v3, 15);
    sf_strncpy(&unk_985B5, "Tue", 6);
    v5 = sub_134F4(311, v4);
    sf_strncpy(&unk_985BB, v5, 15);
    sf_strncpy(&unk_985CA, "Wed", 6);
    v7 = sub_134F4(312, v6);
    sf_strncpy(&unk_985D0, v7, 15);
    sf_strncpy(&unk_985DF, "Thu", 6);
    v9 = sub_134F4(309, v8);
    sf_strncpy(&unk_985E5, v9, 15);
    sf_strncpy(&unk_985F4, "Fri", 6);
    v11 = sub_134F4(282, v10);
    sf_strncpy(&unk_985FA, v11, 15);
    sf_strncpy(&unk_98609, "Sat", 6);
    v13 = sub_134F4(302, v12);
    sf_strncpy(&unk_9860F, v13, 15);
    sf_strncpy(&unk_9861E, "Sun", 6);
    v15 = sub_134F4(307, v14);
    sf_strncpy(&unk_98624, v15, 15);
    sf_strncpy(&unk_98633, "Every", 6);
    v17 = sub_134F4(274, v16);
    sf_strncpy(&unk_98639, v17, 15);
  }
  return &byte_985A0[21 * v1];
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);

//----- (0002C4D0) --------------------------------------------------------
FILE *__fastcall sub_2C4D0(int a1, int a2)
{
  FILE *result; // r0@1
  FILE *v3; // r4@1
  char v4; // [sp+8h] [bp-90h]@1
  void *ptr; // [sp+88h] [bp-10h]@1
  size_t n; // [sp+8Ch] [bp-Ch]@1

  n = 0;
  get_value_post_multipart_file(a2, "fw_restore_file", &ptr, &v4);
  result = fopen("/tmp/user_fw.set.tmp", "w+");
  v3 = result;
  if ( result )
  {
    fwrite(ptr, 1u, n, result);
    result = (FILE *)fclose(v3);
  }
  return result;
}
// F128: using guessed type int __fastcall get_value_post_multipart_file(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0002C548) --------------------------------------------------------
int __fastcall sub_2C548(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r1@2
  int v8; // r0@3
  int v9; // r0@5
  int v10; // r0@5
  int v11; // r0@5
  int v13; // [sp+0h] [bp-88h]@1

  v2 = a2;
  sub_2AFDC();
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"firewall_file_fm\" enctype=\"multipart/form-data\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"restore_firewall\">");
  printf("<input type=\"hidden\" name=\"commit\" value=\"fw_restore\">");
  printf("<table class=v3_table height=26>");
  printf("<tr class=\"fw_tr\"><td width=\"10\" class=\"fw_td\"></td><td width=94 class=\"fw_td\">");
  v4 = sub_134F4(303, v3);
  printf(
    "<input type=button name=\"saverulebtn\" value=\"%s\" onclick=\"self.location.href='download_firewall.cgi'\" ",
    v4);
  printf("class=\"fw_button\" style=\"width:94px; text-align:center;\"></td>");
  v6 = sub_134F4(299, v5);
  printf("<td width=94><input type=button value=\"%s\" onclick=\"parent.Firewall_Restore();\" ", v6);
  printf("class=\"fw_button\" style=\"width:94px; text-align:center;\"></td>");
  printf("<td><input type=file name=\"fw_restore_file\" maxlength=100 style=\"padding:1 0 1 0; margin:0 0 0 5;\"></td>");
  printf((const char *)&unk_6FFD7);
  printf("</BODY>");
  printf("<script>");
  if ( get_value_post_multipart(v2, "commit", &v13, 128) )
  {
    if ( firewall_update_by_file("/tmp/user_fw.set.tmp", "/var/run/stat_fw.set", "user_fw") == -1 )
      v8 = 343;
    else
      v8 = 344;
    v9 = sub_134F4(v8, v7);
    printf("alert('%s');", v9);
    printf("parent.UnMaskIt(parent.document,'restore_mask');");
    v10 = printf("parent.onChangedFWView('internet');");
    v11 = signal_update(v10);
    signal_save(v11);
  }
  printf((const char *)&unk_7007E);
  return printf("</script>");
}
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EE64: using guessed type int __fastcall firewall_update_by_file(_DWORD, _DWORD, _DWORD);
// F248: using guessed type int __fastcall get_value_post_multipart(_DWORD, _DWORD, _DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);

//----- (0002C6C4) --------------------------------------------------------
signed int __fastcall sub_2C6C4(int a1, const char *a2)
{
  int v2; // r6@1
  const char *v3; // r5@1
  signed int v4; // r4@1
  signed int v6; // r2@4
  const char *v7; // r0@8

  v2 = a1;
  v3 = a2;
  v4 = 0;
  while ( 1 )
  {
    v6 = *(_DWORD *)(v2 + 4 * v4);
    if ( *(_DWORD *)(v2 + 4 * v4) )
      v6 = 1;
    if ( v4 > 199 )
      v6 = 0;
    v7 = *(const char **)(v2 + 4 * v4++);
    if ( !v6 )
      break;
    if ( !strcmp(v7, v3) )
      return 1;
  }
  return 0;
}

//----- (0002C71C) --------------------------------------------------------
char *__fastcall sub_2C71C(int a1)
{
  char *result; // r0@3
  const char *v2; // r4@4

  if ( *(_BYTE *)(a1 + 16) || *(_BYTE *)(a1 + 144) )
  {
    v2 = (const char *)(a1 + 8);
    if ( !strcmp((const char *)(a1 + 8), "ip") || !strcmp(v2, "ipmac") )
      result = "ip";
    else
      result = "mac";
  }
  else
  {
    result = "all";
  }
  return result;
}

//----- (0002C784) --------------------------------------------------------
int sub_2C784()
{
  void *v0; // r8@1
  int v1; // r10@1
  int v2; // r1@1
  int v3; // r0@1
  char *v4; // r0@1
  void *v5; // r5@2
  int v6; // r4@2
  bool v7; // nf@5
  unsigned __int8 v8; // vf@5
  const char *v9; // r0@5
  char *v10; // r0@8
  char *v11; // r0@9
  void *v12; // r6@9
  int v13; // r7@9
  int v14; // r0@17
  char v16; // [sp+4h] [bp-5Ch]@1
  char v17; // [sp+18h] [bp-48h]@1
  char s2; // [sp+2Ch] [bp-34h]@1

  sub_2AFDC();
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"firewall_maclist_fm\" style=\"margin:0; border:0; padding:0;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"macsearch_firewall\">");
  printf("<table class=v3_table height=22>");
  v0 = malloc(0xBC00u);
  memset(v0, 0, 0xBC00u);
  v1 = get_hostinfo_from_arp("br0", 256, v0);
  get_ifconfig("br0", &v17, &v16);
  puts("<select name=\"macselect\" class=\"fw_select\" style=\"width:145px; overflow:hidden;\" \t\tonchange=\"parent.onClickedMacSelect(parent.document);\">");
  v3 = sub_134F4(288, v2);
  printf("<option value=\"none\">%s</option>", v3);
  v4 = getenv("REMOTE_ADDR");
  get_internal_pc_hardware_address(v4, &s2);
  if ( s2 )
  {
    v5 = v0;
    v6 = 0;
    while ( 1 )
    {
      v8 = __OFSUB__(v6, v1);
      v7 = v6 - v1 < 0;
      v9 = (char *)v5 + 148;
      ++v6;
      if ( !(v7 ^ v8) )
        break;
      v5 = (char *)v5 + 188;
      if ( !strcmp(v9, &s2) )
      {
        if ( !dhcpd_search_static_lease(0, &s2) )
        {
          v10 = getenv("REMOTE_ADDR");
          printf((const char *)&unk_75C50, &s2, &s2, v10);
        }
        break;
      }
    }
  }
  v11 = getenv("REMOTE_ADDR");
  get_internal_pc_hardware_address(v11, &s2);
  v12 = v0;
  v13 = 0;
  while ( 1 )
  {
    v8 = __OFSUB__(v13, v1);
    v7 = v13++ - v1 < 0;
    if ( !(v7 ^ v8) )
      break;
    if ( !dhcpd_search_static_lease((char *)v12 + 128, 0)
      && !dhcpd_search_static_lease(0, (char *)v12 + 148)
      && strcmp(&s2, (const char *)v12 + 148)
      && check_same_network((char *)v12 + 128, &v17, &v16) )
      printf((const char *)&unk_75C50, (char *)v12 + 148, (char *)v12 + 148, (char *)v12 + 128);
    v12 = (char *)v12 + 188;
  }
  v14 = sub_134F4(300, 0);
  printf("<option value=\"search\">%s</option>", v14);
  printf("</select>");
  free(v0);
  printf((const char *)&unk_6FFDC);
  return printf("</BODY>");
}
// EA20: using guessed type int __fastcall get_hostinfo_from_arp(_DWORD, _DWORD, _DWORD);
// EB70: using guessed type int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// FBFC: using guessed type int __fastcall check_same_network(_DWORD, _DWORD, _DWORD);
// FC08: using guessed type int __fastcall dhcpd_search_static_lease(_DWORD, _DWORD);

//----- (0002C99C) --------------------------------------------------------
const char *__fastcall sub_2C99C(char *src)
{
  const char *result; // r0@1
  int v2; // [sp+0h] [bp-28h]@1

  strncpy((char *)&v2, src, 0x20u);
  strtok((char *)&v2, ".");
  strtok(0, ".");
  strtok(0, ".");
  result = strtok(0, ".");
  if ( result )
    result = (const char *)atoi(result);
  return result;
}

//----- (0002CA04) --------------------------------------------------------
int __fastcall sub_2CA04(int result)
{
  if ( result )
    result = delete_fw_rule(0, result);
  return result;
}
// EA38: using guessed type int __fastcall delete_fw_rule(_DWORD, _DWORD);

//----- (0002CA18) --------------------------------------------------------
signed int __fastcall sub_2CA18(const char *a1, const char *a2, int a3, signed int a4)
{
  const char *v4; // r6@1
  int v5; // r8@1
  signed int v6; // r7@1
  const char *v7; // r4@2
  size_t v8; // r5@2
  char *v9; // r0@4
  const char *v10; // r4@7
  size_t v11; // r0@7
  size_t v12; // r6@9
  void *v13; // r5@14
  signed int v14; // r2@14
  int v15; // r1@15
  int v16; // r3@17
  signed int result; // r0@20

  v4 = a2;
  v5 = a3;
  v6 = a4;
  if ( !a1 )
    goto LABEL_21;
  v7 = a1;
  v8 = strlen(a2);
  while ( strncmp(v7, v4, v8) )
  {
    v9 = strchr(v7, 38);
    v7 = v9 + 1;
    if ( !v9 )
      goto LABEL_21;
  }
  if ( !v7 )
    goto LABEL_21;
  v10 = &v7[v8 + 1];
  v11 = (size_t)strchr(v10, 38);
  if ( !v11 )
    v11 = (size_t)&v10[strlen(v10)];
  v12 = v11 - (_DWORD)v10;
  if ( (const char *)v11 != v10 )
  {
    if ( v6 <= (signed int)v12 )
      v12 = v6 - 1;
    if ( strchr(v10, 37) )
      v12 *= 3;
    v13 = malloc(v12 + 1);
    memcpy(v13, v10, v12);
    *((_BYTE *)v13 + v12) = 0;
    v14 = 0;
    while ( v14 < (signed int)v12 )
    {
      v15 = (int)((char *)v13 + v14);
      if ( *((_BYTE *)v13 + v14) == 43 )
        *((_BYTE *)v13 + v14) = 32;
      v16 = *((_BYTE *)v13 + v14++);
      if ( v16 == 38 )
      {
        *(_BYTE *)v15 = 0;
        break;
      }
    }
    decode_string(v13);
    sf_strncpy(v5, v13, v6);
    free(v13);
    result = 1;
  }
  else
  {
LABEL_21:
    result = 0;
  }
  return result;
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// EC24: using guessed type int __fastcall decode_string(_DWORD);

//----- (0002CB58) --------------------------------------------------------
void *__fastcall sub_2CB58(const char *a1)
{
  const char *v1; // r10@1
  void *v2; // r9@1
  void *v3; // r11@1
  void *v4; // r7@1
  int v5; // r5@3
  int v6; // r0@24
  char v7; // r4@27
  int v8; // r3@34
  int v9; // r0@47
  unsigned int v10; // r3@82
  int v11; // r8@95
  int v12; // r0@107
  int v13; // r4@108
  int v14; // r8@136
  int v15; // r0@148
  int v16; // r4@149
  signed int v17; // r3@164
  int v19; // [sp+0h] [bp-288h]@1
  char s1; // [sp+200h] [bp-88h]@94
  char v21; // [sp+220h] [bp-68h]@89
  char dest; // [sp+240h] [bp-48h]@3

  v1 = a1;
  v2 = malloc(0x224u);
  v3 = v2;
  v4 = malloc(0x1C8u);
  init_fw_rule(v2);
  init_fw_netfilter(v4);
  *((_DWORD *)v2 + 133) = v4;
  memset(&v19, 0, 0x200u);
  if ( !sub_2CA18(v1, "mode", (int)&v19, 32) || fw_spchar_validate(&v19) )
  {
    v5 = 0;
  }
  else
  {
    strcpy(&dest, (const char *)&v19);
    v5 = 1;
  }
  memset(&v19, 0, 0x200u);
  if ( v5 )
  {
    if ( !sub_2CA18(v1, "name", (int)&v19, 512)
      || (strncpy((char *)v2, (const char *)&v19, 0x200u), *((_BYTE *)v2 + 511) = 0, fw_spchar_validate(&v19)) )
      v5 = 0;
  }
  memset(&v19, 0, 0x200u);
  if ( v5 )
  {
    if ( !sub_2CA18(v1, "days", (int)&v19, 32) || fw_spchar_validate(&v19) )
    {
      v5 = 0;
    }
    else
    {
      v5 = 1;
      *((_DWORD *)v2 + 129) = atoi((const char *)&v19);
    }
  }
  memset(&v19, 0, 0x200u);
  if ( !v5 )
    goto LABEL_22;
  if ( !sub_2CA18(v1, "policy", (int)&v19, 32) || fw_spchar_validate(&v19) )
    goto LABEL_21;
  if ( strcmp((const char *)&v19, "accept") )
  {
    if ( !strcmp((const char *)&v19, "drop") )
    {
      *((_DWORD *)v4 + 112) = 0;
      v5 = 1;
      goto LABEL_22;
    }
LABEL_21:
    v5 = 0;
    goto LABEL_22;
  }
  *((_DWORD *)v4 + 112) = 1;
  v5 = 1;
LABEL_22:
  memset(&v19, 0, 0x200u);
  if ( !v5 )
    goto LABEL_183;
  if ( !sub_2CA18(v1, "stime", (int)&v19, 32) )
    goto LABEL_184;
  v6 = fw_spchar_validate(&v19);
  v5 = 1 - v6;
  if ( (unsigned int)v6 > 1 )
    v5 = 0;
  if ( !strcmp((const char *)&v19, "all") )
  {
    *((_DWORD *)v2 + 131) = 0;
    *((_DWORD *)v2 + 130) = 0;
    v7 = 1;
    goto LABEL_33;
  }
  if ( v5 )
    *((_DWORD *)v2 + 130) = atoi((const char *)&v19);
  if ( *((_DWORD *)v2 + 130) >= 0x960u )
  {
LABEL_184:
    v5 = 0;
    v7 = 0;
  }
  else
  {
LABEL_183:
    v7 = 0;
  }
LABEL_33:
  memset(&v19, 0, 0x200u);
  if ( v5 )
    v8 = ((unsigned __int8)v7 ^ 1) & 1;
  else
    v8 = 0;
  if ( v8 )
  {
    if ( sub_2CA18(v1, "etime", (int)&v19, 32) )
    {
      if ( fw_spchar_validate(&v19) )
      {
        v5 = 0;
      }
      else
      {
        v5 = 1;
        *((_DWORD *)v2 + 131) = atoi((const char *)&v19);
      }
      if ( *((_DWORD *)v2 + 131) >= 0x960u )
        v5 = 0;
    }
    else
    {
      v5 = 1;
    }
  }
  memset(&v19, 0, 0x200u);
  if ( !v5 )
    goto LABEL_177;
  if ( sub_2CA18(v1, "disabled", (int)&v19, 32) )
  {
    if ( fw_spchar_validate(&v19) )
      goto LABEL_177;
    v9 = atoi((const char *)&v19);
    if ( v9 )
    {
      if ( v9 != 1 )
        goto LABEL_177;
      *((_DWORD *)v2 + 128) = 0;
    }
    else
    {
      *((_DWORD *)v2 + 128) = 1;
    }
  }
  if ( !strcmp(&dest, "internet") )
  {
    memset(&v19, 0, 0x200u);
    if ( sub_2CA18(v1, "direction", (int)&v19, 8)
      && !fw_spchar_validate(&v19)
      && (!strcmp((const char *)&v19, "inout")
       || !strcmp((const char *)&v19, "outin")
       || !strcmp((const char *)&v19, "both")) )
      strcpy((char *)v4, (const char *)&v19);
    else
      v5 = 0;
    memset(&v19, 0, 0x200u);
    if ( !v5
      || !sub_2CA18(v1, "protocol", (int)&v19, 8)
      || fw_spchar_validate(&v19)
      || strcmp((const char *)&v19, "none")
      && strcmp((const char *)&v19, "tcp")
      && strcmp((const char *)&v19, "udp")
      && strcmp((const char *)&v19, "icmp")
      && strcmp((const char *)&v19, "gre")
      && strcmp((const char *)&v19, "tcpudp") )
      goto LABEL_185;
    strcpy((char *)v4 + 432, (const char *)&v19);
    if ( strcmp((const char *)v4 + 432, "none")
      && strcmp((const char *)v4 + 432, "gre")
      && strcmp((const char *)v4 + 432, "icmp") )
    {
      memset(&v19, 0, 0x200u);
      if ( sub_2CA18(v1, "sport", (int)&v19, 8) )
      {
        if ( fw_spchar_validate(&v19) )
          v5 = 0;
        else
          *((_DWORD *)v4 + 110) = atoi((const char *)&v19);
        if ( *((_DWORD *)v4 + 110) >= 0x10000u )
          v5 = 0;
      }
      memset(&v19, 0, 0x200u);
      if ( v5 && sub_2CA18(v1, "eport", (int)&v19, 8) )
      {
        if ( fw_spchar_validate(&v19) )
          v5 = 0;
        else
          *((_DWORD *)v4 + 111) = atoi((const char *)&v19);
        v10 = *((_DWORD *)v4 + 111);
        if ( v10 >= 0x10000 )
          v5 = 0;
        if ( *((_DWORD *)v4 + 110) > (signed int)v10 )
LABEL_185:
          v5 = 0;
      }
    }
    memset(&v19, 0, 0x200u);
    if ( v5 )
    {
      if ( !sub_2CA18(v1, "src_addr_type", (int)&v19, 8) || fw_spchar_validate(&v19) )
        v5 = 0;
      else
        strcpy(&v21, (const char *)&v19);
    }
    memset(&v19, 0, 0x200u);
    if ( !v5 || !sub_2CA18(v1, "dest_addr_type", (int)&v19, 8) || fw_spchar_validate(&v19) )
      goto LABEL_163;
    strcpy(&s1, (const char *)&v19);
    if ( !strcmp(&v21, "all") )
    {
      strcpy((char *)v4 + 8, "ip");
LABEL_118:
      if ( !strcmp(&s1, "all") )
        goto LABEL_164;
      memset(&v19, 0, 0x200u);
      if ( sub_2CA18(v1, "dest_start", (int)&v19, 32) )
      {
        if ( fw_spchar_validate(&v19) )
          v5 = 0;
        else
          strcpy((char *)v4 + 80, (const char *)&v19);
        if ( validate_ipv4_addr((char *)v4 + 80) )
          v5 = 0;
      }
      memset(&v19, 0, 0x200u);
      if ( !sub_2CA18(v1, "dest_end", (int)&v19, 32) )
        goto LABEL_164;
      if ( fw_spchar_validate(&v19) )
      {
        v5 = 0;
      }
      else if ( v5 )
      {
        strcpy((char *)v4 + 112, (const char *)&v19);
      }
      if ( !validate_ipv4_addr((char *)v4 + 112) )
        goto LABEL_164;
      goto LABEL_163;
    }
    strcpy((char *)v4 + 8, &v21);
    v11 = strcmp(&v21, "ip");
    if ( v11 )
    {
      v13 = strcmp(&v21, "mac");
      if ( v13 )
        goto LABEL_163;
      memset(&v19, 0, 0x200u);
      if ( !sub_2CA18(v1, (const char *)&unk_75CD9, (int)&v19, 32) )
        goto LABEL_163;
      if ( fw_spchar_validate(&v19) )
        v5 = v13;
      else
        strcpy((char *)v4 + 144, (const char *)&v19);
      v12 = validate_mac_addr((char *)v4 + 144);
    }
    else
    {
      memset(&v19, 0, 0x200u);
      if ( !sub_2CA18(v1, (const char *)&unk_75CD9, (int)&v19, 32)
        || (!fw_spchar_validate(&v19) ? strcpy((char *)v4 + 16, (const char *)&v19) : (v5 = v11),
            validate_ipv4_addr((char *)v4 + 16)) )
        v5 = 0;
      memset(&v19, 0, 0x200u);
      if ( !sub_2CA18(v1, "src_end", (int)&v19, 32) )
      {
LABEL_117:
        if ( v5 )
          goto LABEL_118;
LABEL_164:
        v17 = 0;
        goto LABEL_176;
      }
      if ( fw_spchar_validate(&v19) )
      {
        v5 = 0;
      }
      else if ( v5 )
      {
        strcpy((char *)v4 + 48, (const char *)&v19);
      }
      v12 = validate_ipv4_addr((char *)v4 + 48);
    }
    if ( !v12 )
      goto LABEL_117;
LABEL_163:
    v5 = 0;
    goto LABEL_164;
  }
  if ( !strcmp(&dest, "site") )
  {
    memset(&v19, 0, 0x200u);
    if ( sub_2CA18(v1, "src_addr_type", (int)&v19, 8) && !fw_spchar_validate(&v19) )
    {
      strcpy(&v21, (const char *)&v19);
      if ( !strcmp(&v21, "all") )
      {
        strcpy((char *)v4 + 8, "ip");
LABEL_159:
        memset(&v19, 0, 0x200u);
        if ( !v5 )
          goto LABEL_164;
        if ( sub_2CA18(v1, "dest_start", (int)&v19, 256) && !fw_spchar_validate(&v19) )
        {
          convert_url_to_new(&v19, (char *)v4 + 176);
          goto LABEL_164;
        }
        goto LABEL_163;
      }
      strcpy((char *)v4 + 8, &v21);
      v14 = strcmp(&v21, "ip");
      if ( !v14 )
      {
        memset(&v19, 0, 0x200u);
        if ( !sub_2CA18(v1, (const char *)&unk_75CD9, (int)&v19, 32)
          || (!fw_spchar_validate(&v19) ? strcpy((char *)v4 + 16, (const char *)&v19) : (v5 = v14),
              validate_ipv4_addr((char *)v4 + 16)) )
          v5 = 0;
        memset(&v19, 0, 0x200u);
        if ( !sub_2CA18(v1, "src_end", (int)&v19, 32) )
          goto LABEL_159;
        if ( fw_spchar_validate(&v19) )
        {
          v5 = 0;
        }
        else if ( v5 )
        {
          strcpy((char *)v4 + 48, (const char *)&v19);
        }
        v15 = validate_ipv4_addr((char *)v4 + 48);
LABEL_155:
        if ( !v15 )
          goto LABEL_159;
        goto LABEL_158;
      }
      v16 = strcmp(&v21, "mac");
      if ( !v16 )
      {
        memset(&v19, 0, 0x200u);
        if ( sub_2CA18(v1, (const char *)&unk_75CD9, (int)&v19, 32) )
        {
          if ( fw_spchar_validate(&v19) )
            v5 = v16;
          else
            strcpy((char *)v4 + 144, (const char *)&v19);
          v15 = validate_mac_addr((char *)v4 + 144);
          goto LABEL_155;
        }
      }
    }
LABEL_158:
    v5 = 0;
    goto LABEL_159;
  }
  if ( strcmp(&dest, "wifi") )
  {
LABEL_177:
    delete_fw_rule(0, v2);
    return 0;
  }
  memset(&v19, 0, 0x200u);
  if ( !sub_2CA18(v1, "band", (int)&v19, 8) )
    goto LABEL_186;
  if ( fw_spchar_validate(&v19) )
    v5 = 0;
  if ( !strcmp((const char *)&v19, "2g") || !strcmp((const char *)&v19, "5g") || !strcmp((const char *)&v19, "all") )
  {
    if ( v5 )
      strcpy((char *)v2 + 536, (const char *)&v19);
  }
  else
  {
LABEL_186:
    v5 = 0;
  }
  v17 = 1;
LABEL_176:
  *((_DWORD *)v2 + 132) = v17;
  if ( !v5 )
    goto LABEL_177;
  return v3;
}
// EA08: using guessed type int __fastcall init_fw_rule(_DWORD);
// EA38: using guessed type int __fastcall delete_fw_rule(_DWORD, _DWORD);
// F038: using guessed type int __fastcall validate_mac_addr(_DWORD);
// F194: using guessed type int __fastcall validate_ipv4_addr(_DWORD);
// F278: using guessed type int __fastcall convert_url_to_new(_DWORD, _DWORD);
// F47C: using guessed type int __fastcall init_fw_netfilter(_DWORD);
// FE48: using guessed type int __fastcall fw_spchar_validate(_DWORD);

//----- (0002D7EC) --------------------------------------------------------
signed int __fastcall sub_2D7EC(const char *a1)
{
  const char *v1; // r8@1
  signed int v2; // r0@2
  signed int v3; // r4@3
  int v4; // r5@5
  int v5; // r0@6
  int v6; // r1@6
  int v7; // r2@6
  signed int v8; // r3@6
  int v9; // r0@6
  int v10; // r0@8
  int v11; // r0@11
  int v12; // r1@11
  int v13; // r2@11
  signed int v14; // r3@11
  int v15; // r0@11
  int *v16; // r10@16
  int v17; // r7@16
  int v18; // r5@17
  int v19; // r6@17
  char *v20; // r0@21
  int v21; // r4@24
  size_t v22; // r0@24
  size_t v23; // r6@28
  void *v24; // r0@32
  const void *v25; // r1@32
  void *v26; // r5@32
  signed int v27; // r2@32
  int v28; // r1@33
  int v29; // r3@35
  int v30; // r0@40
  int v32; // [sp+0h] [bp-19240h]@16
  char s; // [sp+19000h] [bp-240h]@5
  int v34; // [sp+19200h] [bp-40h]@2

  v1 = a1;
  if ( !a1 )
    return -1;
  memset(&v34, 0, 0x20u);
  v2 = sub_2CA18(v1, "act", (int)&v34, 32);
  if ( !v2 )
  {
    v3 = -1;
    goto LABEL_40;
  }
  if ( !strcmp((const char *)&v34, "add") )
  {
    v4 = (int)sub_2CB58(v1);
    memset(&s, 0, 0x200u);
    if ( sub_2CA18(v1, "priority", (int)&s, 32) )
    {
      v5 = atoi(&s);
      v6 = (int)"/var/run/stat_fw.set";
      v7 = v4;
      v8 = v5;
      v9 = (int)"user_fw";
    }
    else
    {
      v9 = (int)"user_fw";
      v6 = (int)"/var/run/stat_fw.set";
      v7 = v4;
      v8 = 200;
    }
    v10 = fw_add_db(v9, v6, v7, v8);
LABEL_14:
    v3 = v10;
    v2 = sub_2CA04(v4);
    goto LABEL_40;
  }
  if ( !strcmp((const char *)&v34, "modify") )
  {
    v4 = (int)sub_2CB58(v1);
    memset(&s, 0, 0x200u);
    if ( sub_2CA18(v1, "priority", (int)&s, 32) )
    {
      v11 = atoi(&s);
      v12 = (int)"/var/run/stat_fw.set";
      v13 = v4;
      v14 = v11;
      v15 = (int)"user_fw";
    }
    else
    {
      v15 = (int)"user_fw";
      v12 = (int)"/var/run/stat_fw.set";
      v13 = v4;
      v14 = -1;
    }
    v10 = fw_modify_db(v15, v12, v13, v14);
    goto LABEL_14;
  }
  if ( strcmp((const char *)&v34, "del") )
    return -1;
  memset(&v32, 0, 0x19000u);
  v16 = &v32;
  v17 = 0;
  do
  {
    v18 = (int)v1;
    v19 = 0;
    while ( strncmp((const char *)v18, "delcheck", 8u) )
    {
LABEL_21:
      v20 = strchr((const char *)v18, 38);
      v18 = (int)(v20 + 1);
      if ( !v20 )
        goto LABEL_39;
    }
    if ( v19 != v17 )
    {
      ++v19;
      goto LABEL_21;
    }
    if ( !v18 )
      break;
    v21 = v18 + 9;
    v22 = (size_t)strchr((const char *)(v18 + 9), 38);
    if ( !v22 )
      v22 = v21 + strlen((const char *)(v18 + 9));
    if ( v22 == v21 )
      break;
    if ( (signed int)(v22 - v21) >= 511 )
      v23 = 511;
    else
      v23 = v22 - v21;
    if ( strchr((const char *)(v18 + 9), 37) )
      v23 *= 3;
    v24 = malloc(v23 + 1);
    v25 = (const void *)(v18 + 9);
    v26 = v24;
    memcpy(v24, v25, v23);
    *((_BYTE *)v26 + v23) = 0;
    v27 = 0;
    while ( v27 < (signed int)v23 )
    {
      v28 = (int)((char *)v26 + v27);
      if ( *((_BYTE *)v26 + v27) == 43 )
        *((_BYTE *)v26 + v27) = 32;
      v29 = *((_BYTE *)v26 + v27++);
      if ( v29 == 38 )
      {
        *(_BYTE *)v28 = 0;
        break;
      }
    }
    decode_string(v26);
    sf_strncpy(v16, v26, 512);
    ++v17;
    free(v26);
    v16 += 128;
  }
  while ( v17 != 200 );
LABEL_39:
  v2 = fw_delete_rules("user_fw", "/var/run/stat_fw.set", &v32, v17);
  v3 = v2;
LABEL_40:
  v30 = signal_update(v2);
  signal_save(v30);
  return v3;
}
// E75C: using guessed type int __fastcall fw_add_db(_DWORD, _DWORD, _DWORD, _DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EC24: using guessed type int __fastcall decode_string(_DWORD);
// FB54: using guessed type int __fastcall fw_delete_rules(_DWORD, _DWORD, _DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);
// FD40: using guessed type int __fastcall fw_modify_db(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0002DB08) --------------------------------------------------------
int __fastcall sub_2DB08(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r5@1
  int v4; // r6@1

  v2 = a2;
  v3 = a1;
  v4 = lock_file(a1);
  fw_read_status(v3, v2);
  return unlock_file(v4);
}
// ECD8: using guessed type int __fastcall fw_read_status(_DWORD, _DWORD);
// FCBC: using guessed type int __fastcall unlock_file(_DWORD);
// FEA8: using guessed type int __fastcall lock_file(_DWORD);

//----- (0002DB34) --------------------------------------------------------
int __fastcall sub_2DB34(int a1, int a2, int a3)
{
  int v3; // r11@1
  const char *v4; // r1@2
  int v5; // r9@4
  int v6; // r4@4
  int v7; // r6@5
  int v8; // r5@8
  char *v9; // r0@10
  int v10; // r0@10
  int v11; // r1@10
  int v12; // r12@10
  int v13; // lr@10
  char *v14; // r3@15
  int v15; // r10@18
  int v16; // r1@24
  const char *v17; // r0@26
  char *v18; // r0@28
  const char *v19; // r2@28
  int v20; // r3@28
  int v21; // r0@29
  const char *v22; // r0@35
  _UNKNOWN *v23; // r0@41
  const char *v24; // r2@41
  _UNKNOWN *v25; // r3@41
  char *v26; // r0@41
  _UNKNOWN *v27; // r0@42
  int v28; // r0@43
  int v29; // r3@43
  _UNKNOWN *v30; // r0@45
  _UNKNOWN *v31; // r0@46
  _UNKNOWN *v32; // r0@48
  _UNKNOWN *v33; // r0@49
  int v34; // r1@50
  const char *v35; // r0@53
  char *v36; // r0@55
  const char *v37; // r2@55
  int v38; // r3@55
  int v39; // r0@56
  char *v40; // r0@61
  const char *v41; // r1@61
  const char *v42; // r2@68
  char *v43; // r0@68
  int i; // r2@70
  int v45; // r3@76
  bool v46; // zf@76
  int v47; // r1@76
  char v48; // r3@76
  int v49; // r1@78
  int v50; // r0@79
  int v51; // r0@81
  _UNKNOWN *v52; // r0@82
  const char *v53; // r2@82
  _UNKNOWN *v54; // r3@82
  char *v55; // r0@82
  _UNKNOWN *v56; // r0@84
  _UNKNOWN *v57; // r0@85
  int v58; // r1@86
  int v59; // r4@86
  int v60; // r5@88
  int v61; // r7@88
  int v62; // r0@89
  int v63; // r1@89
  int v64; // r1@90
  int v65; // r4@91
  int v66; // r12@92
  int v67; // r6@92
  int v68; // r1@93
  char *v69; // r6@96
  int v70; // r5@96
  int v71; // r0@97
  int v72; // r3@98
  int v73; // r0@100
  int v74; // r1@100
  int v75; // r0@100
  int v76; // r1@100
  int v77; // r0@100
  int v78; // r1@100
  int v79; // r0@100
  int v80; // r1@100
  int v81; // r0@100
  int v82; // r1@100
  int v83; // r0@100
  int v84; // r1@100
  int v85; // r0@100
  int v87; // [sp+0h] [bp-1B8h]@24
  int v88; // [sp+4h] [bp-1B4h]@24
  int v89; // [sp+58h] [bp-160h]@4
  int v90; // [sp+5Ch] [bp-15Ch]@4
  char *v91; // [sp+60h] [bp-158h]@10
  int v92; // [sp+64h] [bp-154h]@0
  char *src; // [sp+68h] [bp-150h]@15
  char *v94; // [sp+70h] [bp-148h]@22
  char s[256]; // [sp+7Ch] [bp-13Ch]@26
  char dest; // [sp+17Ch] [bp-3Ch]@4
  char v97; // [sp+190h] [bp-28h]@103

  v3 = a2;
  if ( *(_DWORD *)(a2 + 512) )
    v4 = "#000000";
  else
    v4 = "#B4B4B4";
  v90 = a1;
  v89 = a3;
  strcpy(&dest, v4);
  v5 = *(_DWORD *)(v3 + 532);
  v6 = *(_BYTE *)(v5 + 176);
  if ( v90 & 1 )
    v7 = (int)"ffffff";
  else
    v7 = (int)"f7f7f7";
  if ( *(_BYTE *)(v5 + 176) )
    v8 = (int)"site";
  else
    v8 = (int)"internet";
  v9 = sub_2C71C(*(_DWORD *)(v3 + 532));
  v91 = v9;
  v10 = strcmp(v9, "ip");
  v12 = (int)"accept";
  v13 = (int)"false";
  if ( v10 )
    v92 = v5 + 144;
  else
    v11 = v5 + 16;
  if ( !v10 )
    v92 = v11;
  src = (char *)(v5 + 48);
  v14 = "ip";
  if ( !*(_BYTE *)(v5 + 80) )
    v14 = "all";
  if ( v6 )
    v15 = v5 + 176;
  else
    v15 = v5 + 80;
  if ( *(_DWORD *)(v5 + 448) != 1 )
    v12 = (int)"drop";
  v94 = (char *)(v5 + 112);
  if ( !*(_DWORD *)(v3 + 512) )
    v13 = (int)"true";
  printf(
    "<TR height=\"24\" ID=\"%s\" class=\"fw_tr\" style=\"cursor:pointer; background-color:#%s;\" \t\tonclick=\"onClickedFWRule('%s','%s','%s','%s','%s','%s','%s','%s',%d,%d,'%s','%s','%s',%d,'%04d','%04d',%s,%d);\">\n",
    v3,
    v7,
    v8,
    v3,
    v91,
    v92,
    src,
    v14,
    v15,
    v94,
    *(_DWORD *)(v5 + 440),
    *(_DWORD *)(v5 + 444),
    v5,
    v5 + 432,
    v12,
    *(_DWORD *)(v3 + 516),
    *(_DWORD *)(v3 + 520),
    *(_DWORD *)(v3 + 524),
    v13,
    v90);
  printf(
    "<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"30\" style=\"color:%s; padding-left:5px;\">%d</TD>\n",
    &dest,
    v90);
  puts("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"80\">");
  printf("<a name=\"%s\" title=\"%s\" class=\"fw_a\" style=\"width:80px; color:%s;\">%s</a>\n", v3, v3, &dest, v3);
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"80\" style=\"color:%s;\">\n", &dest);
  if ( !strcmp((const char *)(v5 + 8), "ip") )
  {
    if ( *(_BYTE *)(v5 + 48) )
    {
      v17 = sub_2C99C(src);
      snprintf2(s, 256, "%s~%d", v5 + 16, v17);
      goto LABEL_39;
    }
    if ( *(_BYTE *)(v5 + 16) )
    {
      v18 = s;
      v19 = "%s";
      v20 = v5 + 16;
    }
    else
    {
      v21 = sub_134F4(264, v16);
      v19 = "%s";
      v20 = v21;
      v18 = s;
    }
    goto LABEL_32;
  }
  if ( !strcmp((const char *)(v5 + 8), "mac") )
  {
    v19 = "%s";
    v18 = s;
    v20 = v5 + 144;
LABEL_32:
    snprintf2(v18, 256, v19, v20);
    goto LABEL_39;
  }
  if ( !strcmp((const char *)(v5 + 8), "ipmac") )
  {
    if ( *(_BYTE *)(v5 + 48) )
    {
      v22 = sub_2C99C(src);
      snprintf2(s, 256, "%s~%d", v5 + 16, v22);
    }
    else
    {
      snprintf2(s, 256, "%s", v5 + 16);
    }
    strcat(s, "/");
    strcat(s, (const char *)(v5 + 144));
  }
  else
  {
    strcpy(s, "ERROR");
  }
LABEL_39:
  printf("<SPAN style=\"width:80px;\" class=\"fw_overflowable\" title=\"%s\">\n", s);
  printf("%s", s);
  puts("</SPAN>");
  puts("</TD>");
  printf("<TD height=\"24\" align=\"center\" class=\"fw_td\" width=\"20\" style=\"color:%s;\">\n", &dest);
  if ( !strcmp((const char *)v5, "inout") )
  {
    if ( *(_DWORD *)(v3 + 512) )
    {
      v23 = sub_126C4();
      v24 = "<img src=\"/%s/fw_right_arrow.gif\">";
      v25 = v23;
      v26 = s;
    }
    else
    {
      v27 = sub_126C4();
      v24 = "<img src=\"/%s/fw_right_arrow.gif\" class=\"fw_opacity_30\">";
      v25 = v27;
      v26 = s;
    }
  }
  else
  {
    v28 = strcmp((const char *)v5, "outin");
    v29 = *(_DWORD *)(v3 + 512);
    if ( v28 )
    {
      if ( v29 )
      {
        v32 = sub_126C4();
        v24 = "<img src=\"/%s/fw_both_arrow.gif\">";
        v25 = v32;
        v26 = s;
      }
      else
      {
        v33 = sub_126C4();
        v24 = "<img src=\"/%s/fw_both_arrow.gif\" class=\"fw_opacity_30\">";
        v25 = v33;
        v26 = s;
      }
    }
    else if ( v29 )
    {
      v30 = sub_126C4();
      v24 = "<img src=\"/%s/fw_left_arrow.gif\">";
      v25 = v30;
      v26 = s;
    }
    else
    {
      v31 = sub_126C4();
      v24 = "<img src=\"/%s/fw_left_arrow.gif\" class=\"fw_opacity_30\">";
      v25 = v31;
      v26 = s;
    }
  }
  snprintf2(v26, 256, v24, v25);
  printf("%s", s);
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"90\" style=\"color:%s;\">\n", &dest);
  if ( *(_BYTE *)(v5 + 176) )
  {
    strcpy(s, (const char *)(v5 + 176));
  }
  else if ( *(_BYTE *)(v5 + 112) )
  {
    v35 = sub_2C99C(v94);
    snprintf2(s, 256, "%s~%d", v5 + 80, v35);
  }
  else
  {
    if ( *(_BYTE *)(v5 + 80) )
    {
      v36 = s;
      v37 = "%s";
      v38 = v5 + 80;
    }
    else
    {
      v39 = sub_134F4(264, v34);
      v37 = "%s";
      v38 = v39;
      v36 = s;
    }
    snprintf2(v36, 256, v37, v38);
  }
  printf("<SPAN style=\"width:90px;\" class=\"fw_overflowable\" title=\"%s\">\n", s);
  printf("%s", s);
  puts("</SPAN>");
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"70\" style=\"color:%s;\">\n", &dest);
  if ( *(_BYTE *)(v5 + 176) )
  {
    strcpy(s, " ");
    goto LABEL_78;
  }
  if ( !strcmp((const char *)(v5 + 432), "none") )
  {
    v40 = s;
    v41 = "all";
LABEL_65:
    strcpy(v40, v41);
    goto LABEL_70;
  }
  if ( !strcmp((const char *)(v5 + 432), "icmp") || !strcmp((const char *)(v5 + 432), "gre") )
  {
    v41 = (const char *)(v5 + 432);
    v40 = s;
    goto LABEL_65;
  }
  if ( *(_DWORD *)(v5 + 440) )
  {
    if ( *(_DWORD *)(v5 + 444) )
    {
      v42 = "%d~%d(%s)";
      v43 = s;
      v87 = *(_DWORD *)(v5 + 444);
      v88 = v5 + 432;
    }
    else
    {
      v43 = s;
      v42 = "%d(%s)";
      v87 = v5 + 432;
    }
    snprintf2(v43, 256, v42);
  }
  else
  {
    snprintf2(s, 256, "%s", v5 + 432);
  }
LABEL_70:
  for ( i = 0; ; ++i )
  {
    v45 = (unsigned __int8)s[i];
    v46 = v45 == 0;
    v47 = v45 - 97;
    v48 = v45 - 32;
    if ( v46 )
      break;
    if ( (unsigned int)v47 <= 0x19 )
      s[i] = v48;
  }
LABEL_78:
  printf("<SPAN style=\"width:70px;\" class=\"fw_overflowable\" title=\"%s\">\n", s);
  printf("%s", s);
  puts("</SPAN>");
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"30\" style=\"color:%s;\">\n", &dest);
  if ( *(_DWORD *)(v5 + 448) == 1 )
    v50 = 294;
  else
    v50 = 295;
  v51 = sub_134F4(v50, v49);
  snprintf2(s, 256, "%s", v51, v87, v88);
  printf("<SPAN style=\"width:30px;\" class=\"fw_overflowable\" title=\"%s\">%s<SPAN>", s, s);
  puts("</TD>");
  printf("<TD height=\"24\" align=\"right\" class=\"fw_td\" style=\"color:%s; width:15px;\">\n", &dest);
  if ( *(_DWORD *)(v3 + 512) )
  {
    if ( v89 == 1 )
    {
      v56 = sub_126C4();
      v53 = "/%s/fw_play.gif";
      v54 = v56;
      v55 = s;
    }
    else
    {
      v57 = sub_126C4();
      v53 = "/%s/fw_pause.gif";
      v54 = v57;
      v55 = s;
    }
  }
  else
  {
    v52 = sub_126C4();
    v53 = "/%s/fw_stop_gray.gif";
    v54 = v52;
    v55 = s;
  }
  snprintf2(v55, 256, v53, v54);
  printf("<img src=\"%s\" style=\"margin-right:3px; vertical-align:middle;\">\n", s);
  puts("</TD>");
  printf("<TD height=\"24\" align=\"left\" class=\"fw_td\" width=\"155\" style=\"color:%s;\">\n", &dest);
  memset(s, 0, 0x100u);
  v59 = *(_DWORD *)(v3 + 520);
  if ( v59 )
  {
    v61 = sub_43AF4(*(_DWORD *)(v3 + 520), 100);
    sub_43BD0(v59, 0x64u);
    v60 = v64;
  }
  else
  {
    if ( !*(_DWORD *)(v3 + 524) )
    {
      v62 = sub_134F4(266, v58);
      snprintf2(s, 256, "%s ", v62);
      goto LABEL_95;
    }
    v60 = *(_DWORD *)(v3 + 520);
    v61 = *(_DWORD *)(v3 + 520);
  }
  v65 = *(_DWORD *)(v3 + 524);
  if ( v65 )
  {
    v67 = sub_43AF4(*(_DWORD *)(v3 + 524), 100);
    sub_43BD0(v65, 0x64u);
    v66 = v68;
  }
  else
  {
    v66 = 0;
    v67 = 0;
  }
  snprintf2(s, 256, "%02d:%02d~%02d:%02d ", v61, v60, v67, v66);
LABEL_95:
  if ( *(_DWORD *)(v3 + 516) )
  {
    v69 = &byte_98648;
    v70 = 0;
    do
    {
      v72 = *(_DWORD *)(v3 + 516) >> v70++;
      if ( v72 & 1 )
      {
        if ( !byte_98648 )
        {
          v73 = sub_134F4(307, v63);
          sf_strncpy(&byte_98648, v73, 16);
          v75 = sub_134F4(289, v74);
          sf_strncpy(&unk_98658, v75, 16);
          v77 = sub_134F4(311, v76);
          sf_strncpy(&unk_98668, v77, 16);
          v79 = sub_134F4(312, v78);
          sf_strncpy(&unk_98678, v79, 16);
          v81 = sub_134F4(309, v80);
          sf_strncpy(&unk_98688, v81, 16);
          v83 = sub_134F4(282, v82);
          sf_strncpy(&unk_98698, v83, 16);
          v85 = sub_134F4(302, v84);
          sf_strncpy(&unk_986A8, v85, 16);
        }
        snprintf2(s, 256, "%s%s/", s, v69);
      }
      v69 += 16;
    }
    while ( v70 != 7 );
    *(&v97 + strlen(s) - 277) = 0;
  }
  else
  {
    v71 = sub_134F4(274, v63);
    snprintf2(s, 256, "%s %s", s, v71);
  }
  printf("<SPAN style=\"width:155px;\" class=\"fw_overflowable\" title=\"%s\">\n", s);
  printf("%s", s);
  puts("</SPAN>");
  puts("</TD>");
  printf("<TD height=\"24\" align=\"right\" class=\"fw_td\" style=\"%s\">\n");
  printf("<input type=\"checkbox\" name=\"delcheck\" value=\"%s\">\n", v3);
  puts("</TD>");
  return printf("</TR>");
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// 98648: using guessed type char byte_98648;
// 2DB34: using guessed type char s[256];

//----- (0002E5C0) --------------------------------------------------------
int __fastcall sub_2E5C0(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r10@1
  const char *v4; // r6@1
  int v5; // r7@6
  int v6; // r4@6
  signed int v7; // r5@6
  signed int v8; // r0@7
  int v9; // r1@7
  int v10; // r2@7
  bool v11; // zf@7
  int v12; // r12@7
  int v13; // r0@7
  int v14; // r5@13
  int v15; // r1@13
  int v16; // r7@13
  int v17; // r4@13
  int result; // r0@17
  int v19; // r4@17
  int v20; // r8@18
  int v21; // r7@18
  int v22; // r4@18
  int v23; // r1@20
  int v24; // r2@20
  int v25; // r5@25
  int v26; // r4@25
  int v27; // r9@29
  signed int v28; // r3@29
  int v29; // r1@35
  int v30; // r1@37
  const char *v31; // r0@37
  bool v32; // nf@39
  unsigned __int8 v33; // vf@39
  int v34; // r11@45
  int v35; // r4@45
  int v36; // r6@46
  char *v37; // r0@48
  char *v38; // r5@48
  int v39; // r0@48
  int v40; // r2@48
  int v41; // r3@48
  int v42; // lr@48
  char *v43; // r3@54
  int v44; // r4@62
  int v45; // r12@67
  const char *v46; // r0@70
  int v47; // [sp+48h] [bp-3A8h]@52
  signed int v48; // [sp+54h] [bp-39Ch]@4
  char s; // [sp+58h] [bp-398h]@1
  char v50; // [sp+37Ch] [bp-74h]@34
  char v51; // [sp+39Ch] [bp-54h]@2
  char v52; // [sp+3BBh] [bp-35h]@3
  int v53; // [sp+3BCh] [bp-34h]@1
  int v54; // [sp+3C0h] [bp-30h]@1
  int v55; // [sp+3C4h] [bp-2Ch]@1

  v2 = a1;
  v3 = a2;
  memset(&s, 0, 0x324u);
  v55 = 0;
  v53 = 0;
  v54 = 0;
  sub_133E4((int)"firewallconf", (int)"firewall");
  sub_2AFDC();
  v4 = (const char *)get_pvalue(v2, "mode");
  if ( !v4 )
  {
    memset(&v51, 0, 0x20u);
    if ( sub_2CA18((const char *)v3, "view_mode", (int)&v51, 32) )
    {
      v52 = (char)v4;
      v4 = &v51;
    }
  }
  printf("<BODY style=\"padding:0px 0px 0px 0px; margin:0px 0px 0px 0px;\">");
  printf("<form method=post action=\"timepro.cgi\" name=\"firewall_iframe_fm\" style=\"margin:0px 0px 0px 0px; padding:0px 0px 0px 0px;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  printf("<input type=hidden name=\"smenu\" value=\"firewall\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  printf("<input type=hidden name=\"view_mode\" value=\"%s\">");
  printf("<input type=hidden name=\"mode\" value=\"\">");
  printf("<input type=hidden name=\"name\" value=\"\">");
  printf("<input type=hidden name=\"src_addr_type\" value=\"\">");
  printf("<input type=hidden name=\"src_start\" value=\"\">");
  printf("<input type=hidden name=\"src_end\" value=\"\">");
  printf("<input type=hidden name=\"dest_addr_type\" value=\"\">");
  printf("<input type=hidden name=\"dest_start\" value=\"\">");
  printf("<input type=hidden name=\"dest_end\" value=\"\">");
  printf("<input type=hidden name=\"sport\" value=\"\">");
  printf("<input type=hidden name=\"eport\" value=\"\">");
  printf("<input type=hidden name=\"direction\" value=\"\">");
  printf("<input type=hidden name=\"protocol\" value=\"\">");
  printf("<input type=hidden name=\"policy\" value=\"\">");
  printf("<input type=hidden name=\"days\" value=\"\">");
  printf("<input type=hidden name=\"stime\" value=\"\">");
  printf("<input type=hidden name=\"etime\" value=\"\">");
  printf("<input type=hidden name=\"disabled\" value=\"\">");
  printf("<input type=hidden name=\"priority\" value=\"\">");
  printf("<input type=hidden name=\"old_priority\" value=\"\">");
  printf("<input type=hidden name=\"band\" value=\"\">");
  printf("<table style=\"table-layout:fixed; border-collapse:collapse; border-style:none none none none; width:100%%;\">\n");
  printf("<COL WIDTH=\"45\"><COL WIDTH=\"65\"><COL WIDTH=\"80\"><COL WIDTH=\"20\">\t\t<COL WIDTH=\"90\"><COL WIDTH=\"70\"><COL WIDTH=\"30\"><COL WIDTH=\"15\"><COL WIDTH=\"155\"><COL WIDTH=\"%%\">\n");
  v48 = sub_2D7EC((const char *)v3);
  if ( v4 && strncmp(v4, "all", 3u) )
  {
    result = strncmp(v4, "internet", 8u);
    v19 = result;
    if ( result )
      return result;
    sub_2DB08((int)"/var/run/stat_fw.set", (int)&s);
    fw_read_db("user_fw", &v53);
    v20 = v19;
    v21 = 1;
    v22 = v54;
    while ( v22 && !*(_DWORD *)(v22 + 528) )
    {
      if ( sub_2C6C4((int)&s, (const char *)v22) )
      {
        sub_2AE7C((int)&v53, 0);
        v23 = v22;
        v24 = 1;
      }
      else
      {
        sub_2AE7C((int)&v53, 0);
        v24 = 0;
        v23 = v22;
      }
      sub_2DB34(v21, v23, v24);
      v22 = *(_DWORD *)(v22 + 544);
      ++v20;
      ++v21;
    }
    v25 = v20 + 1;
    free_fw_status_list(&s, v22);
    sub_2AF04(1u);
    v26 = 0;
    while ( 1 )
    {
      ++v25;
      v33 = __OFSUB__(v26, 15 - v20);
      v32 = v26++ - (15 - v20) < 0;
      if ( !(v32 ^ v33) )
        break;
      sub_2AECC();
    }
  }
  else
  {
    sub_2DB08((int)"/var/run/stat_fw.set", (int)&s);
    fw_read_db("user_fw", &v53);
    v5 = 0;
    v6 = v54;
    v7 = 1;
    while ( v6 && !*(_DWORD *)(v6 + 528) )
    {
      v8 = sub_2C6C4((int)&s, (const char *)v6);
      v9 = v6;
      v10 = 1;
      v12 = v8;
      v11 = v8 == 0;
      v13 = v7;
      if ( v11 )
      {
        v10 = v12;
        v13 = v7;
        v9 = v6;
      }
      sub_2DB34(v13, v9, v10);
      v6 = *(_DWORD *)(v6 + 544);
      ++v5;
      ++v7;
    }
    printf("<TR height=\"0\" id=\"_-guard_line\" class=\"fw_tr\" style=\"display:none;\">", v6);
    printf((const char *)&unk_767FB);
    v14 = v5 + 1;
    free_fw_status_list(&s, v15);
    sub_2AF04(0);
    v16 = v5 + 1;
    v17 = 0;
    while ( 1 )
    {
      ++v14;
      v33 = __OFSUB__(v17, 16 - v16);
      v32 = v17++ - (16 - v16) < 0;
      if ( !(v32 ^ v33) )
        break;
      sub_2AECC();
    }
  }
  printf((const char *)&unk_6FFDC);
  puts("<SCRIPT language=\"javascript\">");
  puts("parent.UnMaskIt(parent.document,'apply_mask');");
  puts("function onNewLineClicked(mode){");
  puts("\tvar obj = document.getElementById(\"_-new_line\");");
  puts("\tif(obj){ \n\tobj.scrollIntoView(true);");
  puts("\tif(mode){");
  puts("\t\tonClickedFWRule(mode,'','','','','','','','','','','','','','','','','');\n}");
  puts("\telse{");
  puts("\t\tonClickedFWRule('internet','','','','','','','','','','','','','','','','','');\n}");
  puts("\t}\n}");
  if ( v48 == -1 )
  {
    if ( !v4 || !strcmp(v4, "all") )
      printf("onNewLineClicked();");
    else
      printf("onNewLineClicked('%s');", v4);
    memset(&v50, 0, 0x20u);
    if ( !sub_2CA18((const char *)v3, "act", (int)&v50, 32) || strcmp(&v50, "add") || v53 <= 199 )
      goto LABEL_77;
    v30 = sub_134F4(293, v29);
    v31 = "alert('%s');";
  }
  else
  {
    v27 = v54;
    v28 = 1;
    while ( 1 )
    {
      v33 = 0;
      v32 = v27 < 0;
      if ( v27 )
      {
        v33 = __OFSUB__(v28, v48);
        v32 = v28 - v48 < 0;
      }
      ++v28;
      if ( !(v32 ^ v33) )
        break;
      v27 = *(_DWORD *)(v27 + 544);
    }
    if ( v27 )
    {
      if ( *(_DWORD *)(v27 + 528) )
      {
        if ( strcmp(v4, "internet") )
        {
          v45 = (int)"false";
          if ( !*(_DWORD *)(v27 + 512) )
            v45 = (int)"true";
          printf(
            "onClickedFWRule('%s','%s','','','','','','',0,0,'','','%s',%d,'%04d','%04d',%s,0,'%s');",
            "wifi",
            v27,
            "drop",
            *(_DWORD *)(v27 + 516),
            *(_DWORD *)(v27 + 520),
            *(_DWORD *)(v27 + 524),
            v45,
            v27 + 536);
          goto LABEL_70;
        }
      }
      else if ( strcmp(v4, "wifi") )
      {
        v34 = *(_DWORD *)(v27 + 532);
        v35 = *(_BYTE *)(v34 + 176);
        if ( *(_BYTE *)(v34 + 176) )
          v36 = (int)"site";
        else
          v36 = (int)"internet";
        v37 = sub_2C71C(*(_DWORD *)(v27 + 532));
        v38 = v37;
        v39 = strcmp(v37, "ip");
        v42 = (int)"accept";
        if ( v39 )
          v41 = v34 + 144;
        else
          v40 = v34 + 16;
        if ( v39 )
          v47 = v41;
        else
          v47 = v40;
        v43 = "ip";
        if ( !*(_BYTE *)(v34 + 80) )
          v43 = "all";
        if ( v35 )
          v3 = v34 + 176;
        if ( !v35 )
          v3 = v34 + 80;
        if ( *(_DWORD *)(v34 + 448) != 1 )
          v42 = (int)"drop";
        v44 = (int)"false";
        if ( !*(_DWORD *)(v27 + 512) )
          v44 = (int)"true";
        printf(
          "onClickedFWRule('%s','%s','%s','%s','%s','%s','%s','%s',%d,%d,'%s','%s','%s',%d,'%04d','%04d',%s,%d);",
          v36,
          v27,
          v38,
          v47,
          v34 + 48,
          v43,
          v3,
          v34 + 112,
          *(_DWORD *)(v34 + 440),
          *(_DWORD *)(v34 + 444),
          v34,
          v34 + 432,
          v42,
          *(_DWORD *)(v27 + 516),
          *(_DWORD *)(v27 + 520),
          *(_DWORD *)(v27 + 524),
          v44,
          v48);
        goto LABEL_70;
      }
      printf("onNewLineClicked('%s');", v4);
LABEL_70:
      printf("\tvar obj = document.getElementById('%s');", v27);
      v46 = "\tif(obj) obj.scrollIntoView(true);";
LABEL_76:
      printf(v46);
      goto LABEL_77;
    }
    if ( !v4 || !strcmp(v4, "all") )
    {
      v46 = "onNewLineClicked();";
      goto LABEL_76;
    }
    v31 = "onNewLineClicked('%s');";
    v30 = (int)v4;
  }
  printf(v31, v30);
LABEL_77:
  printf("parent.document.firewall_fm.rule_count.value = %d;", v53);
  printf("onLoadCompleted(parent.document);");
  printf("</SCRIPT>");
  printf("</BODY>");
  return free_fw_list(&v53);
}
// EBD0: using guessed type int __fastcall free_fw_list(_DWORD);
// F098: using guessed type int __fastcall free_fw_status_list(_DWORD, _DWORD);
// F5FC: using guessed type int __fastcall fw_read_db(_DWORD, _DWORD);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);

//----- (0002EDB0) --------------------------------------------------------
int __fastcall sub_2EDB0(int a1)
{
  return printf("<script>alert(\"%s\");</script>\n", a1);
}

//----- (0002EDC0) --------------------------------------------------------
signed int __fastcall sub_2EDC0(int a1)
{
  char *v1; // r0@3
  char *v2; // r0@3
  char *v3; // r0@3
  char *v4; // r0@3
  char *v5; // r0@3
  char *v6; // r0@3
  char *v7; // r0@3
  char *v8; // r0@3
  char *v9; // r0@3
  char *v10; // r0@3
  char *v11; // r0@3
  char *v12; // r0@3
  int i; // r0@3
  int v14; // r3@4
  signed int result; // r0@5
  char v16; // [sp+4h] [bp-7Ch]@1
  char v17; // [sp+18h] [bp-68h]@1
  char v18; // [sp+2Ch] [bp-54h]@1
  int v19; // [sp+40h] [bp-40h]@3
  int v20; // [sp+44h] [bp-3Ch]@3
  int v21; // [sp+48h] [bp-38h]@3
  int v22; // [sp+4Ch] [bp-34h]@3
  int v23; // [sp+50h] [bp-30h]@3
  int v24; // [sp+54h] [bp-2Ch]@3
  int v25; // [sp+58h] [bp-28h]@3
  int v26; // [sp+5Ch] [bp-24h]@3
  int v27; // [sp+60h] [bp-20h]@3
  int v28; // [sp+64h] [bp-1Ch]@3
  int v29; // [sp+68h] [bp-18h]@3
  int v30; // [sp+6Ch] [bp-14h]@3

  sf_strncpy(&v18, a1, 20);
  get_lan_ipconfig(&v17, &v16, 0);
  if ( v17 && v16 )
  {
    v1 = strtok(&v18, ".");
    v27 = atoi(v1);
    v2 = strtok(0, ".");
    v28 = atoi(v2);
    v3 = strtok(0, ".");
    v29 = atoi(v3);
    v4 = strtok(0, ".");
    v30 = atoi(v4);
    strtok(0, ".");
    v5 = strtok(&v17, ".");
    v23 = atoi(v5);
    v6 = strtok(0, ".");
    v24 = atoi(v6);
    v7 = strtok(0, ".");
    v25 = atoi(v7);
    v8 = strtok(0, ".");
    v26 = atoi(v8);
    strtok(0, ".");
    v9 = strtok(&v16, ".");
    v19 = atoi(v9);
    v10 = strtok(0, ".");
    v20 = atoi(v10);
    v11 = strtok(0, ".");
    v21 = atoi(v11);
    v12 = strtok(0, ".");
    v22 = atoi(v12);
    strtok(0, ".");
    for ( i = 0; ; i += 4 )
    {
      v14 = *(int *)((char *)&v19 + i);
      if ( (*(int *)((char *)&v27 + i) ^ *(int *)((char *)&v23 + i)) & v14 )
        break;
      if ( i == 12 )
        goto LABEL_8;
      *(int *)((char *)&v19 + i) = ~v14;
    }
    result = 0;
  }
  else
  {
LABEL_8:
    result = 1;
  }
  return result;
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// FE78: using guessed type int __fastcall get_lan_ipconfig(_DWORD, _DWORD, _DWORD);

//----- (0002EF70) --------------------------------------------------------
int __fastcall sub_2EF70(const char *a1, int a2)
{
  int v2; // r7@1
  const char *v3; // r6@1
  int v4; // r9@1
  int v5; // r10@1
  int v6; // r4@1
  signed int v7; // r3@2
  int v8; // r1@5
  int v9; // r0@7
  int v10; // r0@7
  int v11; // r1@8
  int v12; // r0@10
  int v13; // r0@10
  char *v14; // r4@13
  int v15; // r8@13
  int v16; // r1@13
  int v17; // r0@13
  int v18; // r1@13
  int v19; // r0@15
  int v20; // r1@15
  int v21; // r0@15
  int v22; // r0@15
  int v23; // r5@16
  int v24; // r0@18
  int v25; // r4@18
  int v26; // r1@20
  int v27; // r0@20
  int v28; // r4@21
  int v29; // r1@21
  int v30; // r0@21
  int v31; // r3@21
  int v32; // r0@24
  char *v33; // r4@25
  int v34; // r5@27
  int v35; // r1@27
  int v36; // r0@28
  int v37; // r0@30
  int v38; // r1@30
  int v39; // r0@30
  int v40; // r1@31
  int v41; // r2@31
  int v42; // r1@33
  int v43; // r0@33
  _UNKNOWN *v44; // r4@33
  int v45; // r1@33
  int v46; // r0@33
  int v47; // r1@33
  int v48; // r0@33
  int v49; // r1@33
  int v50; // r0@33
  int v51; // r1@33
  int v52; // r0@33
  _UNKNOWN *v53; // r4@33
  int v54; // r1@33
  int v55; // r0@33
  char v57; // [sp+10h] [bp-40h]@30

  v2 = a2;
  v3 = a1;
  check_valid_account(a1);
  v4 = get_remote_mgmt_port();
  v5 = get_remote_mgmt_flag();
  printf("<form name=\"%s_ipform\" method=post action=\"timepro.cgi\" style=\"padding:0; margin:0;\">\n", v3);
  puts("<input type=hidden name=\"tmenu\" value=\"firewallconf\">");
  puts("<input type=hidden name=\"smenu\" value=\"accesslist\">");
  puts("<input type=\"hidden\" name=\"act\" value=\"\">");
  printf("<input type=\"hidden\" name=\"nopassword\" value=\"%d\">\n");
  v6 = (int)"true";
  if ( !strcmp(v3, "ext") )
    v7 = *(_DWORD *)(v2 + 32);
  else
    v7 = *(_DWORD *)(v2 + 68);
  if ( v7 > 9 )
    v8 = (int)"true";
  else
    v8 = (int)"false";
  v9 = printf("<input type=\"hidden\" name=\"nomore\" value=\"%s\">\n", v8);
  v10 = get_remote_addr(v9);
  if ( accesslist_already_regist(v3, v10) )
    v11 = (int)"true";
  else
    v11 = (int)"false";
  v12 = printf("<input type=\"hidden\" name=\"noadd\" value=\"%s\">\n", v11);
  v13 = get_remote_addr(v12);
  if ( !sub_2EDC0(v13) )
    v6 = (int)"false";
  printf("<input type=\"hidden\" name=\"isinternal\" value=\"%s\">\n", v6);
  puts("<table class=\"v3_table access_main_table\" width=\"642\" style=\"padding:0; margin:0;\">");
  printf("<COL width=\"170\"><COL width=\"200\"><COL width=\"192\"><COL width=\"60\"><COL width=\"20\">");
  if ( !strcmp(v3, "ext") )
  {
    v14 = "";
    v15 = strcmp((const char *)v2, "run");
    printf("<tr class=\"access_main_tr\" style=\"background-color:#E3E3E3;\" height=\"24\">\t\t\t<td class=\"access_main_td\" style=\"border-top:1px #CCC solid; border-bottom:1px #CCC solid;\" colspan=\"5\">");
    v17 = sub_134F4(133, v16);
    printf("<p class=\"access_main_p\"><b>%s</b></p>", v17);
    printf("</td></tr>");
    printf("<tr class=\"access_main_tr\" height=\"24\"><td class=\"access_main_td\" style=\"border-bottom:1px #CCC solid;\">");
    if ( v5 )
      v14 = "checked";
    v19 = sub_134F4(137, v18);
    printf(
      "<input type=checkbox id=\"extuse\" class=navi_chk name=rmgmt_chk %s onclick=\"disableFormAccessList();\">\t\t\t<label for=\"extuse\">%s</label>",
      v14,
      v19);
    printf("</td><td class=\"access_main_td\" style=\"border-bottom:1px #CCC solid;\">");
    v21 = sub_134F4(2, v20);
    printf("<span class=\"access_main_span\" style=\"margin-right:5px;\">%s</span>", v21);
    printf("<input type=text name=rmgmt_port maxlength=5 size=5 value=%d style=\"width:45px;\">\n", v4);
    printf("</td><td class=\"access_main_td\" style=\"border-bottom:1px #CCC solid;\" colspan=\"2\" align=\"right\">");
    v22 = strcmp(v3, "ext");
    if ( v22 )
      v23 = *(_DWORD *)(v2 + 68);
    else
      v23 = *(_DWORD *)(v2 + 32);
    v28 = get_remote_addr(v22);
    v30 = sub_134F4(28, v29);
    v31 = v28;
    v25 = 1 - v15;
    if ( (unsigned int)v15 > 1 )
      v25 = 0;
    printf(
      "<button class=\"access_main_button\" style=\"width:55px;\" onclick=\"%s_RemoteConn(%d, '%s'); return ClickEventPropagater(event);\">\t\t\t%s</button>",
      v3,
      v23,
      v31,
      v30);
    printf("</td><td class=\"access_main_td\" style=\"border-bottom:1px #CCC solid;\">");
  }
  else
  {
    v24 = strcmp((const char *)(v2 + 36), "run");
    v25 = 1 - v24;
    if ( (unsigned int)v24 > 1 )
      v25 = 0;
    printf("<tr class=\"access_main_tr\" style=\"background-color:#E3E3E3;\" height=\"24\">\t\t\t<td class=\"access_main_td\" style=\"border-top:1px #CCC solid; border-bottom:1px #CCC solid;\" colspan=\"5\">");
    v27 = sub_134F4(135, v26);
    printf("<p class=\"access_main_p\"><b>%s</b></p>", v27);
  }
  printf("</td></tr>");
  v32 = printf("<tr class=\"access_main_tr\" height=\"24\">\t\t<td class=\"access_main_td\" style=\"border-bottom:1px #CCC solid;\">");
  if ( v25 )
    v33 = "checked";
  else
    v33 = "";
  v34 = get_remote_addr(v32);
  if ( !strcmp(v3, "ext") )
    v36 = 134;
  else
    v36 = 136;
  v37 = sub_134F4(v36, v35);
  printf(
    "<input type=checkbox class=navi_chk name=%s_chk %s onclick=\"disableFormAccessList(); %s_partsubmit(this,'%s');\" id=\"%s_chkid\">\t\t<label for=\"%s_chkid\">%s</label>",
    v3,
    v33,
    v3,
    v34,
    v3,
    v3,
    v37);
  printf("</td><td class=\"access_main_td\" colspan=\"2\" style=\"border-bottom:1px #CCC solid;\">");
  v39 = sub_134F4(910, v38);
  printf("<span class=\"access_main_span\">%s</span>", v39);
  printf("<span class=\"access_main_span\" style=\"margin-left:5px;\">");
  snprintf2(&v57, 32, "%s_regip", v3);
  if ( !strcmp(v3, "ext") )
  {
    v40 = (int)"";
    v41 = 1;
  }
  else
  {
    v40 = (int)"";
    v41 = 3;
  }
  sub_11D7C((int)&v57, v40, v41);
  printf((const char *)&unk_770C2);
  v43 = sub_134F4(0, v42);
  printf(
    "<input type=text name=\"%s_ipexplan\" size=12 maxlength=12 placeholder=\"%s\" style=\"width:135px;\">\n",
    v3,
    v43);
  printf("</span>");
  printf("</td><td class=\"access_main_td\" align=\"right\" style=\"border-bottom:1px #CCC solid;\">");
  v44 = sub_126C4();
  v46 = sub_134F4(3, v45);
  printf(
    "<button id=\"%sbt\"class=\"access_main_button\" style=\"width:55px;\" onclick=\"%s_IPadd(); return ClickEventPropagater(event);\">\t\t<span class=\"access_main_span\"><img src=\"/%s/plus_icon.gif\" style=\"padding-right:4px;\">%s</span>\t\t</button>",
    v3,
    v3,
    v44,
    v46);
  printf("</td><td class=\"access_main_td\" style=\"border-bottom:1px #CCC solid;\">");
  printf("</td></tr>");
  printf("<tr class=\"access_main_tr\" height=\"22\">\t\t<td class=\"access_main_td\" style=\"border-bottom:1px #CCC solid;\" colspan=\"5\">");
  puts("<table class=\"v3_table access_main_table\" width=\"642\" style=\"padding:0; margin:0;\">");
  printf("<COL width=\"260\"><COL width=\"292\"><COL width=\"70\"><COL width=\"20\">");
  printf("<tr class=\"access_main_tr\" height=\"22\"><td class=\"access_main_td\">");
  v48 = sub_134F4(401, v47);
  printf(
    "<p class=\"access_main_p\" style=\"*display:inline; zoom:1;\">%s</p>\t\t<span class=\"access_main_span\" style=\"margin-left:5px; *display:inline; zoom:1;\">\t\t<font color=\"gray\">",
    v48);
  v50 = sub_134F4(1, v49);
  printf((const char *)v50, 10);
  printf("</font></span>");
  printf("</td><td class=\"access_main_td\">");
  v52 = sub_134F4(215, v51);
  printf("<span class=\"access_main_span\">%s</span>", v52);
  printf("</td><td class=\"access_main_td\" align=\"right\">");
  v53 = sub_126C4();
  v55 = sub_134F4(118, v54);
  printf(
    "<span class=\"access_main_span\" style=\"cursor:pointer;\" onclick=\"%s_IPdel();\">\t\t<img src=\"/%s/minus_icon.gif\" class=\"access_main_span\" style=\"width:10px; height:10px;\">\t\t<span class=\"access_main_span\">%s</span></span>",
    v3,
    v53,
    v55);
  printf("<input type=checkbox name=\"%s_allcheck\" onclick=\"%s_allcheckfunc(this);\">\n", v3, v3);
  printf("</td><td class=\"access_main_td\">");
  printf("</td></tr>");
  printf("</table>");
  printf("</td></tr>");
  puts("</table>");
  return printf("</form>");
}
// E7F8: using guessed type int __fastcall get_remote_addr(_DWORD);
// EC90: using guessed type int get_remote_mgmt_port(void);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EE94: using guessed type int __fastcall accesslist_already_regist(_DWORD, _DWORD);
// EF60: using guessed type int __fastcall check_valid_account(_DWORD);
// F830: using guessed type int get_remote_mgmt_flag(void);

//----- (0002F470) --------------------------------------------------------
int __fastcall sub_2F470(int a1)
{
  int v1; // r4@1
  int v2; // r0@1
  int v3; // r0@2
  int v4; // r0@4
  int v5; // r0@5

  v1 = a1;
  printf("<table class=\"v3_table access_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<tr class=\"access_main_tr\"><td class=\"access_main_td\">");
  sub_2EF70("ext", v1);
  printf("</td></tr>");
  v2 = printf("<tr class=\"access_main_tr\"><td class=\"access_main_td\">");
  if ( is_mobile_agent(v2) )
  {
    sub_12790((int)"66", (int)"100%%", (int)"display:inline-block; *display:inline; zoom:1;");
    v3 = printf("<iframe name=\"haext_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=haext\"                         frameborder=no width=100%% height=66 align=center scrolling=auto></iframe>");
    sub_12770(v3);
  }
  else
  {
    printf("<iframe name=\"haext_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=haext\"                         frameborder=no width=100%% height=66 align=center scrolling=auto></iframe>");
  }
  printf("</td></tr>");
  printf("<tr class=\"access_main_tr\"><td class=\"access_main_td\">");
  sub_2EF70("int", v1);
  printf("</td></tr>");
  v4 = printf("<tr class=\"access_main_tr\"><td class=\"access_main_td\">");
  if ( is_mobile_agent(v4) )
  {
    sub_12790((int)"66", (int)"100%%", (int)"display:inline-block; *display:inline; zoom:1;");
    v5 = printf("<iframe name=\"haint_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=haint\"                         frameborder=no width=100%% height=66 align=center scrolling=auto></iframe>");
    sub_12770(v5);
  }
  else
  {
    printf("<iframe name=\"haint_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=haint\"                         frameborder=no width=100%% height=66 align=center scrolling=auto></iframe>");
  }
  printf("</td></tr></table>");
  puts("<script language=JavaScript>");
  printf("disableFormAccessList();");
  return puts("</script>");
}
// F74C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (0002F594) --------------------------------------------------------
signed int sub_2F594()
{
  signed int result; // r0@1
  int v1; // r5@1
  int v2; // r1@2
  int v3; // r4@2
  _UNKNOWN *v4; // r0@2
  int v5; // r0@2
  int v6; // r8@2
  _UNKNOWN *v7; // r0@2
  int v8; // r1@2
  char *v9; // r4@3
  _UNKNOWN *v10; // r5@5
  int v11; // r0@5
  int v12; // r1@5
  int v13; // r0@5
  _UNKNOWN *v14; // r0@5
  int v15; // r1@5
  char *v16; // r4@6
  _UNKNOWN *v17; // r5@8
  int v18; // r0@8
  int v19; // r1@8
  int v20; // r0@8
  int v21; // r1@8
  int v22; // r0@8
  int v23; // r1@8
  int v24; // r0@8
  _UNKNOWN *v25; // r0@8
  char *v26; // r2@9
  char *v27; // r1@12
  _UNKNOWN *v28; // r0@14
  char *v29; // r2@15
  char *v30; // r1@18
  _UNKNOWN *v31; // r0@20
  char *v32; // r2@21
  char *v33; // r1@24
  _UNKNOWN *v34; // r0@26
  char *v35; // r2@27
  char *v36; // r1@30
  _UNKNOWN *v37; // r0@32
  int v38; // r1@32
  char *v39; // r4@33
  _UNKNOWN *v40; // r5@35
  int v41; // r0@35
  char *v42; // r1@36
  _UNKNOWN *v43; // r0@38
  int v44; // r1@38
  char *v45; // r4@39
  _UNKNOWN *v46; // r5@41
  int v47; // r0@41
  char *v48; // r1@42
  int v49; // r1@44
  int v50; // r0@44
  int v51; // r0@44
  int v52; // r0@45
  _UNKNOWN *v53; // r0@47
  int v54; // [sp+0h] [bp-1A0h]@2
  char v55; // [sp+100h] [bp-A0h]@2
  char v56; // [sp+148h] [bp-58h]@5
  char v57; // [sp+168h] [bp-38h]@2
  char v58; // [sp+169h] [bp-37h]@14
  char v59; // [sp+16Ah] [bp-36h]@20
  char v60; // [sp+16Bh] [bp-35h]@26
  char v61; // [sp+16Ch] [bp-34h]@32
  char v62; // [sp+16Dh] [bp-33h]@38
  int v63; // [sp+178h] [bp-28h]@5
  int v64; // [sp+17Ch] [bp-24h]@5

  result = sub_12380();
  v1 = result;
  if ( !result )
  {
    sub_133E4((int)"firewallconf", (int)"accesslist");
    puts("<style type=\"text/css\">");
    puts(".access_main_table {");
    puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
    puts("\ttable-layout:fixed;");
    puts("}");
    puts(".access_main_tr {");
    puts("\tborder:0 0 0 0; padding:0 0 0 0;");
    puts("}");
    puts(".access_main_td {");
    puts("\tpadding:0 0 0 0; font-size:12px;");
    puts("\tvertical-align:middle;");
    puts("}");
    puts(".access_main_p {");
    puts("\tpadding:0 0 0 5px; display:inline-block;");
    puts("\tvertical-align:middle; margin:0;");
    puts("}");
    puts(".access_main_span {");
    puts("\tdisplay:inline-block; vertical-align:middle;");
    puts("}");
    puts(".access_main_button {");
    puts("\tpadding:0 1 0 1; margin:0 0 0 0; font-size:12px;");
    puts("\tvertical-align:middle;");
    puts("}");
    puts(".access_main_td input[type=checkbox], .access_main_td input[type=radio] {");
    puts("display:inline-block; vertical-align:middle;");
    puts("}");
    puts("#access_div_msg p {");
    puts("margin:5 0 5 15px; text-align:left;");
    puts("}");
    puts(".access_ellipsis {");
    puts("text-overflow:ellipsis; overflow:hidden; white-space:nowrap; text-align:left;");
    puts("}");
    printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td {cursor:default;}");
    printf("</style>");
    puts("<table class=\"v3_table access_main_table\" width=\"642\" style=\"padding:0; margin:0;\">");
    printf("<COL width=\"642\">");
    printf("<tr class=\"access_main_tr\"><td class=\"access_main_td\">");
    memset(&v55, v1, 0x48u);
    accesslist_set_read_config(&v55);
    sub_2F470((int)&v55);
    printf("</td></tr>");
    printf("<tr class=\"access_main_tr\"><td class=\"access_main_td\">");
    read_dos_config(&v57);
    printf("<form method=post action=\"timepro.cgi\" name=\"firewallconfetc\" style=\"padding:0; margin:0;\">");
    printf("<input type=hidden name=\"tmenu\" value=\"firewallconf\">");
    printf("<input type=hidden name=\"smenu\" value=\"etc\">");
    printf("<input type=hidden name=\"act\" value=\"\">");
    puts("<table class=\"v3_table access_main_table\" width=\"642\" style=\"padding:0; margin:0;\">");
    printf("<COL width=\"311\"><COL width=\"311\"><COL width=\"20\">");
    printf("<tr class=\"access_main_tr\" height=\"24\" style=\"background-color:#E3E3E3; cursor:pointer;\" onclick=\"onclick_etclist();\" id=\"etctitle\">\t\t<td class=\"access_main_td\" colspan=\"3\" style=\"border-top:1px #CCC solid; border-bottom:1px #CCC solid;\">");
    v3 = sub_134F4(583, v2);
    v4 = sub_126C4();
    printf(
      "<span class=\"access_main_span\" style=\"padding:0 0 0 5px;\"><b>%s</b></span>\t\t<img src=\"/%s/menu_list_closed.png\" \t\tstyle=\"margin-left:5px; width:16px; height:14px; vertical-align:middle; display:inline-block; *display:inline; zoom:1;\" \t\tid=\"timg\">",
      v3,
      v4);
    v5 = printf("</td></tr>");
    v6 = get_csrf_op(v5);
    get_csrf_whites(&v54);
    printf("<tr class=\"access_main_tr\" height=\"24\" style=\"background-color:#FFFFFF; display:none;\" name=\"etcline\">\t\t<td class=\"access_main_td\" style=\"padding:0 0 0 5px;\">");
    v7 = sub_126C4();
    if ( v6 )
      v9 = "on";
    else
      v9 = "off";
    v10 = v7;
    v11 = sub_134F4(186, v8);
    printf(
      "<img src=\"/%s/trigger_%s.png\" id=\"csrf_img\" onclick=\"onclick_onoffbtn(this);\" \t\tstyle=\"vertical-align:middle; height:22px; display:inline-block; *display:inline; zoom:1; cursor:pointer;\">\t\t<span class=\"access_main_span\">%s</span>",
      v10,
      v9,
      v11);
    printf("<input type=\"hidden\" name=\"csrf\" value=\"%d\">");
    printf("</td><td class=\"access_main_td\">");
    printf("</td><td class=\"access_main_td\"></td></tr>");
    printf("<tr class=\"access_main_tr\" height=\"24\" style=\"background-color:#F7F7F7; display:none;\" name=\"etcline\">\t\t<td class=\"access_main_td\" colspan=\"2\" style=\"padding:0 0 0 5px;\">");
    v13 = sub_134F4(188, v12);
    printf(
      "<input type=text name=\"whitedomains\" maxlength=256 size=64 value='%s' style=\"width:605px;\" placeholder=\"%s\">\n",
      &v54,
      v13);
    printf("</td><td class=\"access_main_td\">");
    printf("</td></tr>");
    get_arp_protection(&v63, &v64, &v56);
    printf("<tr class=\"access_main_tr\" height=\"24\" style=\"background-color:#FFFFFF; display:none;\" name=\"etcline\">\t\t<td class=\"access_main_td\" colspan=\"2\" style=\"padding:0 0 0 5px;\">");
    v14 = sub_126C4();
    if ( v63 )
      v16 = "on";
    else
      v16 = "off";
    v17 = v14;
    v18 = sub_134F4(37, v15);
    printf((const char *)&unk_77EDD, v17, v16, v18);
    printf("<input type=\"hidden\" name=\"arp_protection\" value=\"%d\">");
    printf("<span class=\"access_main_span\" style=\"margin-left:10px;\">");
    v20 = sub_134F4(35, v19);
    printf("%s<input type=text name=period size=3 maxlength=3 value=%d>", v20, v64);
    v22 = sub_134F4(33, v21);
    printf((const char *)v22);
    v24 = sub_134F4(34, v23);
    printf((const char *)v24);
    printf("</span>");
    printf("</td><td class=\"access_main_td\">");
    printf("</td></tr>");
    printf(
      "<tr class=\"access_main_tr\" height=\"24\" style=\"background-color:#%s; display:none;\" name=\"etcline\">\t\t<td class=\"access_main_td\" style=\"padding:0 0 0 5px;\">",
      "F7F7F7");
    v25 = sub_126C4();
    if ( v57 == 48 )
      v26 = "off";
    else
      v26 = "on";
    printf(
      "<img src=\"/%s/trigger_%s.png\" id=\"synflood_img\" onclick=\"onclick_onoffbtn(this);\" \t\tstyle=\"vertical-align:middle; height:22px; display:inline-block; *display:inline; zoom:1; cursor:pointer;\">\t\t<span class=\"access_main_span\">SYN Flood</span>",
      v25,
      v26);
    if ( v57 == 48 )
      v27 = "off";
    else
      v27 = "on";
    printf("<input type=\"hidden\" name=\"synflood\" value=\"%s\">", v27);
    printf("</td><td class=\"access_main_td\">");
    v28 = sub_126C4();
    if ( v58 == 48 )
      v29 = "off";
    else
      v29 = "on";
    printf(
      "<img src=\"/%s/trigger_%s.png\" id=\"smurf_img\" onclick=\"onclick_onoffbtn(this);\" \t\tstyle=\"vertical-align:middle; height:22px; display:inline-block; *display:inline; zoom:1; cursor:pointer;\">\t\t<span class=\"access_main_span\">Smurf</span>",
      v28,
      v29);
    if ( v58 == 48 )
      v30 = "off";
    else
      v30 = "on";
    printf("<input type=\"hidden\" name=\"smurf\" value=\"%s\">", v30);
    printf("</td><td class=\"access_main_td\"></td></tr>");
    printf(
      "<tr class=\"access_main_tr\" height=\"24\"style=\"background-color:#%s; display:none;\" name=\"etcline\">\t\t<td class=\"access_main_td\" style=\"padding:0 0 0 5px;\">",
      "FFFFFF");
    v31 = sub_126C4();
    if ( v59 == 48 )
      v32 = "off";
    else
      v32 = "on";
    printf(
      "<img src=\"/%s/trigger_%s.png\" id=\"sourceroute_img\" onclick=\"onclick_onoffbtn(this);\" \t\tstyle=\"vertical-align:middle; height:22px; display:inline-block; *display:inline; zoom:1; cursor:pointer;\">\t\t<span class=\"access_main_span\">IP source routing</span>",
      v31,
      v32);
    if ( v59 == 48 )
      v33 = "off";
    else
      v33 = "on";
    printf("<input type=\"hidden\" name=\"sourceroute\" value=\"%s\">", v33);
    printf("</td><td class=\"access_main_td\">");
    v34 = sub_126C4();
    if ( v60 == 48 )
      v35 = "off";
    else
      v35 = "on";
    printf(
      "<img src=\"/%s/trigger_%s.png\" id=\"ipspoof_img\" onclick=\"onclick_onoffbtn(this);\" \t\tstyle=\"vertical-align:middle; height:22px; display:inline-block; *display:inline; zoom:1; cursor:pointer;\">\t\t<span class=\"access_main_span\">IP Spoofing</span>",
      v34,
      v35);
    if ( v60 == 48 )
      v36 = "off";
    else
      v36 = "on";
    printf("<input type=\"hidden\" name=\"ipspoof\" value=\"%s\">", v36);
    printf("</td><td class=\"access_main_td\"></td></tr>");
    printf(
      "<tr class=\"access_main_tr\" height=\"24\" style=\"background-color:#%s; display:none;\" name=\"etcline\">\t\t<td class=\"access_main_td\" style=\"padding:0 0 0 5px;\">",
      "F7F7F7");
    v37 = sub_126C4();
    if ( v61 == 48 )
      v39 = "off";
    else
      v39 = "on";
    v40 = v37;
    v41 = sub_134F4(184, v38);
    printf(
      "<img src=\"/%s/trigger_%s.png\" id=\"icmpblock_img\" onclick=\"onclick_onoffbtn(this);\" \t\tstyle=\"vertical-align:middle; height:22px; display:inline-block; *display:inline; zoom:1; cursor:pointer;\">\t\t<span class=\"access_main_span\">%s</span>",
      v40,
      v39,
      v41);
    if ( v61 == 48 )
      v42 = "off";
    else
      v42 = "on";
    printf("<input type=\"hidden\" name=\"icmpblock\" value=\"%s\">", v42);
    printf("</td><td class=\"access_main_td\">");
    v43 = sub_126C4();
    if ( v62 == 48 )
      v45 = "off";
    else
      v45 = "on";
    v46 = v43;
    v47 = sub_134F4(185, v44);
    printf(
      "<img src=\"/%s/trigger_%s.png\" id=\"internal_icmpbk_img\" onclick=\"onclick_onoffbtn(this);\" \t\tstyle=\"vertical-align:middle; height:22px; display:inline-block; *display:inline; zoom:1; cursor:pointer;\">\t\t<span class=\"access_main_span\">%s</span>",
      v46,
      v45,
      v47);
    if ( v62 == 48 )
      v48 = "off";
    else
      v48 = "on";
    printf("<input type=\"hidden\" name=\"internal_icmpbk\" value=\"%s\">", v48);
    printf("</td><td class=\"access_main_td\"></td></tr>");
    printf(
      "<tr class=\"access_main_tr\" height=\"24\" style=\"background-color:#%s; display:none;\" name=\"etcline\">\t\t\t<td class=\"access_main_td\" colspan=\"3\"></td></tr>",
      "FFFFFF");
    printf("<tr class=\"access_main_tr\" height=\"5\" name=\"etcline\" style=\"display:none;\">\t\t<td class=\"access_main_td\" colspan=\"3\" style=\"border-top:1px #CCC solid;\"></td></tr>");
    printf("<tr class=\"access_main_tr\" height=\"24\" name=\"etcline\" style=\"display:none;\">\t\t<td class=\"access_main_td\" colspan=\"2\" align=\"right\">");
    v50 = sub_134F4(28, v49);
    printf(
      "<button class=\"access_main_button\" onclick=\"submitDoS(); return ClickEventPropagater(event);\" style=\"width:55px;\">\t\t%s</button>",
      v50);
    printf("</td><td class=\"access_main_td\">");
    printf("</td></tr>");
    printf("</table>");
    printf("</form>");
    printf("<script>");
    printf("ChangeARPProtection();");
    printf("</script>");
    printf("</td></tr>");
    v51 = printf("</table>");
    if ( is_mobile_agent(v51) )
    {
      sub_12790((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
      v52 = printf("<iframe name=\"hasetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hasetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
      sub_12770(v52);
    }
    else
    {
      printf("<iframe name=\"hasetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hasetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    }
    printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
    puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
    printf("</DIV>");
    puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
    puts("<table width=\"180\" height=\"70\">");
    printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
    puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
    v53 = sub_126C4();
    printf(
      "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
      v53);
    printf("</SPAN></td>");
    printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"access_div_msg\">\n");
    printf("</SPAN></td>");
    printf((const char *)&unk_60F0E);
    result = printf("<script>init_accesslist();</script>");
  }
  return result;
}
// EB64: using guessed type int __fastcall read_dos_config(_DWORD);
// EE04: using guessed type int __fastcall get_csrf_whites(_DWORD);
// F290: using guessed type int __fastcall get_arp_protection(_DWORD, _DWORD, _DWORD);
// F44C: using guessed type int __fastcall get_csrf_op(_DWORD);
// F74C: using guessed type int __fastcall is_mobile_agent(_DWORD);
// FB78: using guessed type int __fastcall accesslist_set_read_config(_DWORD);

//----- (0002FD3C) --------------------------------------------------------
int __fastcall sub_2FD3C(int a1)
{
  signed int v1; // r6@1
  signed int i; // r4@4
  int v3; // r0@7
  int v4; // r0@7
  int v5; // r4@7
  int v6; // r0@7
  int v7; // r6@8
  int v8; // r7@11
  int v9; // r0@13
  char v11; // [sp+4h] [bp-ACh]@2
  char v12; // [sp+84h] [bp-2Ch]@2

  v1 = 0;
  check_valid_account(a1);
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0;\">");
  puts("<form name=\"int_ipform_list\" method=post action=\"timepro.cgi\" style=\"padding:0; margin:0;\">");
  puts("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  puts("<input type=hidden name=\"smenu\" value=\"haint\">");
  puts("<input type=\"hidden\" name=\"act\" value=\"\">");
  printf("<input type=\"hidden\" name=\"nopassword\" value=\"%d\">\n");
  printf("<input type=\"hidden\" name=\"maxcount\" value=\"%d\">\n", 10);
  printf("<table class=\"v3_table access_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"30\"><COL width=\"230\"><COL width=\"292\"><COL width=\"70\"><COL width=\"%%%%\">");
  do
  {
    if ( !accesslist_get_ip("int", v1, &v12, &v11) )
      break;
    ++v1;
    printf("<tr class=\"access_main_tr\" height=\"22\" style=\"background-color:#%s;\"><td class=\"access_main_td\">");
    printf("<p class=\"access_main_p\">%d</p>", v1);
    printf("</td><td class=\"access_main_td\">");
    printf("<span class=\"access_main_span\">%s</span>", &v12);
    printf("</td><td class=\"access_main_td\">");
    printf("<span class=\"access_main_span\"><font color=\"gray\">%s</font></span>", &v11);
    printf("</td><td class=\"access_main_td\" align=\"right\">");
    printf("<input type=checkbox name=\"int_delchk\" value=\"%s\">\n", &v12);
    printf("</td><td class=\"access_main_td\">");
    printf("</td></tr>");
  }
  while ( v1 != 10 );
  printf("<input type=\"hidden\" name=\"rcount\" value=\"%d\">\n", v1);
  for ( i = v1; i <= 2; ++i )
  {
    printf("<tr class=\"access_main_tr\" height=\"22\" style=\"background-color:#%s;\"><td class=\"access_main_td\" colspan=\"5\">");
    printf("</td></tr>");
  }
  puts("</table>");
  puts("</form>");
  v3 = printf("</BODY>");
  v4 = get_remote_addr(v3);
  v5 = (int)"true";
  v6 = accesslist_already_regist("int", v4);
  if ( v1 <= 9 )
    v7 = (int)"false";
  else
    v7 = (int)"true";
  if ( v6 )
    v8 = (int)"false";
  else
    v8 = (int)"true";
  v9 = get_remote_addr(v6);
  if ( !sub_2EDC0(v9) )
    v5 = (int)"false";
  return printf(
           "<script>if(parent.window.init_accessform)parent.window.init_accessform('int', %s,%s,%s);</script>",
           v7,
           v8,
           v5);
}
// E7F8: using guessed type int __fastcall get_remote_addr(_DWORD);
// EA68: using guessed type int __fastcall accesslist_get_ip(_DWORD, _DWORD, _DWORD, _DWORD);
// EE94: using guessed type int __fastcall accesslist_already_regist(_DWORD, _DWORD);
// EF60: using guessed type int __fastcall check_valid_account(_DWORD);

//----- (0002FF68) --------------------------------------------------------
int __fastcall sub_2FF68(int a1)
{
  signed int v1; // r6@1
  signed int i; // r4@4
  int v3; // r0@7
  int v4; // r0@7
  int v5; // r4@7
  int v6; // r0@7
  int v7; // r6@8
  int v8; // r7@11
  int v9; // r0@13
  char v11; // [sp+4h] [bp-ACh]@2
  char v12; // [sp+84h] [bp-2Ch]@2

  v1 = 0;
  check_valid_account(a1);
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0;\">");
  puts("<form name=\"ext_ipform_list\" method=post action=\"timepro.cgi\" style=\"padding:0; margin:0;\">");
  puts("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  puts("<input type=hidden name=\"smenu\" value=\"haext\">");
  puts("<input type=\"hidden\" name=\"act\" value=\"\">");
  printf("<input type=\"hidden\" name=\"nopassword\" value=\"%d\">\n");
  printf("<input type=\"hidden\" name=\"maxcount\" value=\"%d\">\n", 10);
  printf("<table class=\"v3_table access_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"30\"><COL width=\"230\"><COL width=\"292\"><COL width=\"70\"><COL width=\"%%%%\">");
  do
  {
    if ( !accesslist_get_ip("ext", v1, &v12, &v11) )
      break;
    ++v1;
    printf("<tr class=\"access_main_tr\" height=\"22\" style=\"background-color:#%s;\"><td class=\"access_main_td\">");
    printf("<p class=\"access_main_p\">%d</p>", v1);
    printf("</td><td class=\"access_main_td\">");
    printf("<span class=\"access_main_span\">%s</span>", &v12);
    printf("</td><td class=\"access_main_td\">");
    printf("<span class=\"access_main_span\"><font color=\"gray\">%s</font></span>", &v11);
    printf("</td><td class=\"access_main_td\" align=\"right\">");
    printf("<input type=checkbox name=\"ext_delchk\" value=\"%s\">\n", &v12);
    printf("</td><td class=\"access_main_td\">");
    printf("</td></tr>");
  }
  while ( v1 != 10 );
  printf("<input type=\"hidden\" name=\"rcount\" value=\"%d\">\n", v1);
  for ( i = v1; i <= 2; ++i )
  {
    printf("<tr class=\"access_main_tr\" height=\"22\" style=\"background-color:#%s;\"><td class=\"access_main_td\" colspan=\"5\">");
    printf("</td></tr>");
  }
  puts("</table>");
  puts("</form>");
  v3 = printf("</BODY>");
  v4 = get_remote_addr(v3);
  v5 = (int)"true";
  v6 = accesslist_already_regist("ext", v4);
  if ( v1 <= 9 )
    v7 = (int)"false";
  else
    v7 = (int)"true";
  if ( v6 )
    v8 = (int)"false";
  else
    v8 = (int)"true";
  v9 = get_remote_addr(v6);
  if ( !sub_2EDC0(v9) )
    v5 = (int)"false";
  return printf(
           "<script>if(parent.window.init_accessform)parent.window.init_accessform('ext', %s,%s,%s);</script>",
           v7,
           v8,
           v5);
}
// E7F8: using guessed type int __fastcall get_remote_addr(_DWORD);
// EA68: using guessed type int __fastcall accesslist_get_ip(_DWORD, _DWORD, _DWORD, _DWORD);
// EE94: using guessed type int __fastcall accesslist_already_regist(_DWORD, _DWORD);
// EF60: using guessed type int __fastcall check_valid_account(_DWORD);

//----- (00030194) --------------------------------------------------------
int __fastcall sub_30194(int a1, int a2)
{
  int v2; // r7@1
  int v3; // r0@5
  char *v4; // r1@5
  char *v5; // r2@5
  int v6; // r0@6
  int v7; // r1@7
  int v8; // r0@8
  int v9; // r0@14
  int v10; // r0@15
  int v11; // r1@16
  int v12; // r0@17
  int v13; // r0@20
  int v14; // r0@22
  signed int v15; // r0@23
  int v16; // r0@29
  int v17; // r1@38
  int *v18; // r1@40
  char *v19; // r0@40
  int v20; // r0@41
  int v21; // r0@42
  int v22; // r5@52
  int v23; // r1@54
  int v24; // r0@55
  int v25; // r0@56
  int v26; // r5@59
  int v27; // r1@60
  int v28; // r0@61
  int v29; // r0@62
  int v30; // r0@63
  int v31; // r0@63
  char v32; // r3@68
  char v33; // r3@72
  char v34; // r3@76
  char v35; // r3@80
  char v36; // r3@84
  char v37; // r3@88
  int v38; // r0@100
  char *v39; // r0@101
  int v40; // r0@108
  int v41; // r0@108
  int v42; // r0@119
  int v43; // r0@119
  int v45; // [sp+Ch] [bp-54Ch]@102
  int v46; // [sp+10Ch] [bp-44Ch]@101
  char v47; // [sp+20Ch] [bp-34Ch]@99
  char v48; // [sp+30Ch] [bp-24Ch]@64
  char s; // [sp+38Ch] [bp-1CCh]@1
  int v50; // [sp+3ACh] [bp-1ACh]@48
  char s1; // [sp+3B0h] [bp-1A8h]@5
  int v52; // [sp+3D0h] [bp-188h]@39
  char dest; // [sp+3D4h] [bp-184h]@53
  int v54; // [sp+414h] [bp-144h]@3
  int v55; // [sp+454h] [bp-104h]@3
  int v56; // [sp+494h] [bp-C4h]@1
  int v57; // [sp+4D4h] [bp-84h]@66
  int v58; // [sp+4F4h] [bp-64h]@36
  int v59; // [sp+514h] [bp-44h]@6
  char v60; // [sp+528h] [bp-30h]@70
  char v61; // [sp+529h] [bp-2Fh]@74
  char v62; // [sp+52Ah] [bp-2Eh]@78
  char v63; // [sp+52Bh] [bp-2Dh]@82
  char v64; // [sp+52Ch] [bp-2Ch]@86
  char v65; // [sp+52Dh] [bp-2Bh]@90
  int v66; // [sp+538h] [bp-20h]@90
  int v67; // [sp+53Ch] [bp-1Ch]@90

  v2 = a2;
  memset(&s, 0, 0x48u);
  accesslist_set_read_config(&s);
  if ( !get_value_post(v2, "act", &v56, 64) )
    memset(&v56, 0, 0x40u);
  memset(&v55, 0, 0x40u);
  if ( get_value_post(v2, "act", &v54, 64) )
  {
    if ( !strcmp((const char *)&v54, "int_run") )
    {
      v3 = strcmp(&s1, "run");
      if ( v3 )
      {
        v6 = get_remote_addr(v3);
        sf_strncpy(&v59, v6, 20);
        if ( !accesslist_already_regist("int", &v59) && sub_2EDC0((int)&v59) )
        {
          v8 = sub_134F4(909, v7);
          accesslist_add_ip("int", &v59, v8, &s);
        }
        accesslist_iptables_cmd(2);
        snprintf2(&s1, 32, "run");
      }
      goto LABEL_63;
    }
    if ( !strcmp((const char *)&v54, (const char *)&unk_79095) )
    {
      if ( strcmp(&s1, "stop") )
      {
        accesslist_iptables_cmd(4);
        strcpy(&s1, "stop");
      }
      goto LABEL_63;
    }
    if ( !strcmp((const char *)&v54, "ext_run") )
    {
      v9 = strcmp(&s, "run");
      if ( v9 )
      {
        v10 = get_remote_addr(v9);
        sf_strncpy(&v59, v10, 20);
        if ( !accesslist_already_regist("ext", &v59) && !sub_2EDC0((int)&v59) )
        {
          v12 = sub_134F4(909, v11);
          accesslist_add_ip("ext", &v59, v12, &s);
        }
        accesslist_iptables_cmd(1);
        strcpy(&s, "run");
      }
      if ( get_value_post(v2, "rmgmt_port", &v54, 64) )
      {
        v13 = atoi((const char *)&v54);
        set_remote_mgmt_port(v13);
      }
      if ( !get_value_post(v2, "rmgmt_chk", &v54, 64) )
        goto LABEL_23;
      v14 = strcmp((const char *)&v54, "on");
LABEL_32:
      if ( !v14 )
      {
        v15 = 1;
        goto LABEL_24;
      }
LABEL_23:
      v15 = 0;
LABEL_24:
      set_remote_mgmt_flag(v15);
LABEL_63:
      v30 = accesslist_set_write_config(&s, v4, v5);
      v31 = signal_update(v30);
      signal_save(v31);
      goto LABEL_64;
    }
    if ( !strcmp((const char *)&v54, "ext_stop") )
    {
      if ( strcmp(&s, "stop") )
      {
        accesslist_iptables_cmd(3);
        strcpy(&s, "stop");
      }
      if ( get_value_post(v2, "rmgmt_port", &v54, 64) )
      {
        v16 = atoi((const char *)&v54);
        set_remote_mgmt_port(v16);
      }
      if ( !get_value_post(v2, "rmgmt_chk", &v54, 64) )
        goto LABEL_23;
      v14 = strcmp((const char *)&v54, "on");
      goto LABEL_32;
    }
    if ( !strcmp((const char *)&v54, "int_ipadd") )
    {
      get_ip_value_post(v2, "int_regip", &v59);
      get_value_post(v2, "int_ipexplan", &v58, 32);
      if ( check_unpermitted_chars(&v58) )
        strcpy((char *)&v58, " ");
      if ( !accesslist_already_regist("int", &v59) )
      {
        if ( v52 <= 9 )
        {
          v18 = &v59;
          v19 = "int";
LABEL_51:
          accesslist_add_ip(v19, v18, &v58, &s);
          goto LABEL_63;
        }
LABEL_41:
        v20 = 912;
LABEL_42:
        v21 = sub_134F4(v20, v17);
        sub_2EDB0(v21);
        goto LABEL_63;
      }
    }
    else
    {
      if ( strcmp((const char *)&v54, "ext_ipadd") )
      {
        v22 = strcmp((const char *)&v54, "int_del");
        if ( v22 )
        {
          if ( !strcmp((const char *)&v54, "ext_del") )
          {
            strcpy(&dest, "");
            v26 = 0;
            while ( 1 )
            {
              v29 = get_value_array_post(v2, "ext_delchk", v26++, &dest);
              v4 = &dest;
              v5 = &s;
              if ( !v29 )
                break;
              if ( !accesslist_remove_ip("ext") )
              {
                v28 = sub_134F4(913, v27);
                sub_2EDB0(v28);
              }
            }
          }
        }
        else
        {
          strcpy(&dest, "");
          while ( 1 )
          {
            v25 = get_value_array_post(v2, &unk_7910E, v22++, &dest);
            v4 = &dest;
            v5 = &s;
            if ( !v25 )
              break;
            if ( !accesslist_remove_ip("int") )
            {
              v24 = sub_134F4(913, v23);
              sub_2EDB0(v24);
            }
          }
        }
        goto LABEL_63;
      }
      get_ip_value_post(v2, "ext_regip", &v59);
      get_value_post(v2, "ext_ipexplan", &v58, 32);
      if ( check_unpermitted_chars(&v58) )
        strcpy((char *)&v58, " ");
      if ( !accesslist_already_regist("ext", &v59) )
      {
        if ( v50 <= 9 )
        {
          v18 = &v59;
          v19 = "ext";
          goto LABEL_51;
        }
        goto LABEL_41;
      }
    }
    v20 = 914;
    goto LABEL_42;
  }
LABEL_64:
  if ( get_value_post(v2, "act", &v48, 128) && !strcmp(&v48, "dos_submit") )
  {
    if ( get_value_post(v2, "synflood", &v57, 32) && !strcmp((const char *)&v57, "on") )
      v32 = 49;
    else
      v32 = 48;
    v60 = v32;
    if ( get_value_post(v2, "smurf", &v57, 32) && !strcmp((const char *)&v57, "on") )
      v33 = 49;
    else
      v33 = 48;
    v61 = v33;
    if ( get_value_post(v2, "sourceroute", &v57, 32) && !strcmp((const char *)&v57, "on") )
      v34 = 49;
    else
      v34 = 48;
    v62 = v34;
    if ( get_value_post(v2, "ipspoof", &v57, 32) && !strcmp((const char *)&v57, "on") )
      v35 = 49;
    else
      v35 = 48;
    v63 = v35;
    if ( get_value_post(v2, "icmpblock", &v57, 32) && !strcmp((const char *)&v57, "on") )
      v36 = 49;
    else
      v36 = 48;
    v64 = v36;
    if ( get_value_post(v2, "internal_icmpbk", &v57, 32) && !strcmp((const char *)&v57, "on") )
      v37 = 49;
    else
      v37 = 48;
    v65 = v37;
    get_arp_protection(&v66, &v67, &v58);
    if ( !get_intvalue_post(v2, "arp_protection", &v66) )
      v66 = 0;
    if ( v66 )
    {
      if ( !get_intvalue_post(v2, "period", &v67) )
        v67 = 10;
      if ( !get_value_post(v2, "ifname", &v58, 32) )
        strcpy((char *)&v58, "eth0");
    }
    if ( check_unpermitted_chars(&v58) )
      strcpy((char *)&v58, "eth0");
    set_arp_protection(v66, v67, &v58);
    if ( !get_value_post(v2, "csrf", &v47, 256) )
      goto LABEL_108;
    v38 = atoi(&v47);
    set_csrf_op(v38);
    if ( get_value_post(v2, "whitedomains", &v47, 256) )
    {
      sf_strncpy(&v46, &v47, 256);
      sf_strncpy(&v45, &v46, 256);
      strtoupper(&v45);
      if ( strstr((const char *)&v45, "<SCRIPT>") )
        strcpy((char *)&v46, "");
      if ( !check_unpermitted_chars(&v46) )
        goto LABEL_107;
      v39 = (char *)&v46;
    }
    else
    {
      v39 = (char *)&v46;
    }
    strcpy(v39, "");
LABEL_107:
    set_csrf_whites(&v46);
LABEL_108:
    v40 = apply_dos_config(&v60);
    v41 = signal_update(v40);
    signal_save(v41);
  }
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"firewallconf_hasetup\">");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  if ( !strcmp((const char *)&v56, "ext_run")
    || !strcmp((const char *)&v56, "ext_stop")
    || !strcmp((const char *)&v56, "ext_ipadd")
    || !strcmp((const char *)&v56, "ext_del") )
    printf("if(parent.window.refresh_extlist) parent.window.refresh_extlist();");
  if ( !strcmp((const char *)&v56, "int_run")
    || !strcmp((const char *)&v56, (const char *)&unk_79095)
    || !strcmp((const char *)&v56, "int_ipadd")
    || !strcmp((const char *)&v56, "int_del") )
    printf("if(parent.window.refresh_intlist) parent.window.refresh_intlist();");
  v42 = printf("UnMaskIt(parent.document, 'apply_mask');");
  v43 = get_remote_addr(v42);
  if ( !sub_2EDC0(v43)
    && (!strcmp((const char *)&v56, "ext_run") || !strcmp((const char *)&v56, "ext_stop"))
    && get_value_post(v2, "rmgmt_chk", &v56, 64)
    && get_value_post(v2, "rmgmt_port", &v55, 64)
    && !strcmp((const char *)&v56, "on") )
    printf("if(parent.window.redirect_loginpage_and_logout)parent.window.redirect_loginpage_and_logout('%s');", &v55);
  return printf("</script>");
}
// E7F8: using guessed type int __fastcall get_remote_addr(_DWORD);
// E888: using guessed type int __fastcall set_csrf_op(_DWORD);
// E8A0: using guessed type int __fastcall get_intvalue_post(_DWORD, _DWORD, _DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E978: using guessed type int __fastcall set_csrf_whites(_DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EB58: using guessed type int __fastcall accesslist_iptables_cmd(_DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EE94: using guessed type int __fastcall accesslist_already_regist(_DWORD, _DWORD);
// EF0C: using guessed type int __fastcall set_arp_protection(_DWORD, _DWORD, _DWORD);
// F11C: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F290: using guessed type int __fastcall get_arp_protection(_DWORD, _DWORD, _DWORD);
// F3B0: using guessed type int __fastcall strtoupper(_DWORD);
// F518: using guessed type int __fastcall set_remote_mgmt_flag(_DWORD);
// F56C: using guessed type int __fastcall apply_dos_config(_DWORD);
// F6EC: using guessed type int __fastcall accesslist_add_ip(_DWORD, _DWORD, _DWORD, _DWORD);
// F7AC: using guessed type int __cdecl accesslist_remove_ip(_DWORD);
// F860: using guessed type int __fastcall accesslist_set_write_config(_DWORD, _DWORD, _DWORD);
// F9BC: using guessed type int __fastcall get_value_array_post(_DWORD, _DWORD, _DWORD, _DWORD);
// FAB8: using guessed type int __fastcall set_remote_mgmt_port(_DWORD);
// FB3C: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// FB78: using guessed type int __fastcall accesslist_set_read_config(_DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);

//----- (00030D0C) --------------------------------------------------------
int __fastcall sub_30D0C(int a1, int a2, int a3, int a4)
{
  int v4; // r5@1
  int v5; // r6@1
  int v6; // r4@1
  int v7; // r7@1

  v4 = a2;
  v5 = a3;
  v6 = a1;
  v7 = a4;
  printf(
    "<TR height=20px ID=%s STYLE=\"cursor:pointer; background-color:#%s;\" ONCLICK=\"clickQosMenu(%d, '%s');\">",
    a1);
  printf("<TD style='width:130px;'><span style='margin-left:  5px; '>%s</span></TD>", v4);
  printf("<TD ID=%s_value CLASS=text_gray style='width:100px;'>%s</TD>", v6, v5);
  return printf("<TD ID=%s_value2 style='width:410px;'>%s</TD></TR>\n", v6, v7);
}

//----- (00030D94) --------------------------------------------------------
int __fastcall sub_30D94(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r1@1
  int v4; // r4@1
  int v5; // r1@1
  int v6; // r0@1

  v2 = sub_134F4(844, a2);
  v4 = sub_134F4(843, v3);
  v6 = sub_134F4(823, v5);
  return printf(
           "<script>var lang = { sharing_bounded: \"%s\", sharing_borrow: \"%s\", bpi_off: \"%s\" };</script>",
           v2,
           v4,
           v6);
}

//----- (00030DDC) --------------------------------------------------------
int sub_30DDC()
{
  int v0; // r0@1
  int v1; // r1@1

  printf("<style>");
  printf("body, td { padding: 0; margin: 0; }");
  printf((const char *)&unk_7956E);
  v0 = printf("</style>");
  sub_30D94(v0, v1);
  sub_133E4((int)"trafficconf", (int)"qos");
  puts("<form id='rule_list_form' method=post action=\"timepro.cgi\" name=\"rule_list_fm\" style='margin: 0;'>");
  printf("</form>");
  return printf("<iframe name=\"trafficconf_qos_list_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_qos_list_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (00030E50) --------------------------------------------------------
int sub_30E50()
{
  int v0; // r0@1
  int v1; // r1@1

  printf("<style>");
  printf("body { margin: 0; }");
  printf((const char *)&unk_7956E);
  v0 = printf("</style>");
  sub_30D94(v0, v1);
  sub_133E4((int)"trafficconf", (int)"qos");
  printf("<table id='menu_list_table' style=\"border-collapse:collapse; border-style:none none none none; width:100%%;\" cellspacing=0px cellpadding=0px>\n");
  printf("</table>");
  return printf("<iframe name=\"trafficconf_qos_menu_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_qos_menu_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (00030EC4) --------------------------------------------------------
int __fastcall sub_30EC4(int a1, int a2)
{
  int v2; // r5@1
  _UNKNOWN *v3; // r0@1

  v2 = a2;
  printf("<DIV id=\"%s\" style=\"display:none;\">", a1);
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v3 = sub_126C4();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v3);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\">%s\n",
    v2);
  printf("</SPAN></td>");
  return printf((const char *)&unk_60F0E);
}

//----- (00030F70) --------------------------------------------------------
int __fastcall sub_30F70(int a1)
{
  int v1; // r8@1
  int v2; // r0@1
  int v3; // r1@1
  char *v4; // r4@1
  char *v5; // r5@2
  int v6; // r0@4
  int v7; // r1@4
  char *v8; // r5@5
  int v9; // r0@7
  int v10; // r1@7
  char *v11; // r5@8
  int v12; // r0@10
  int v13; // r1@10
  char *v14; // r5@11
  int v15; // r0@13
  int v16; // r1@13
  int v17; // r0@15
  int v18; // r1@15
  int v19; // r0@15
  int v20; // r1@15
  int v21; // r2@15
  int v22; // r0@16
  unsigned int v23; // r1@16
  int v24; // r1@18
  int v25; // r0@18
  int v26; // r1@18
  int v27; // r2@18
  int v28; // r0@19
  unsigned int v29; // r1@19
  int v30; // r0@21
  int v31; // r0@21
  int v32; // r4@21
  int v33; // r1@21
  int v34; // r0@21
  int v36; // [sp+0h] [bp-Ch]@1
  int v37; // [sp+4h] [bp-8h]@1
  int (__fastcall *v38)(_DWORD, _DWORD); // [sp+8h] [bp-4h]@0
  int v39; // [sp+Ch] [bp+0h]@1
  unsigned int v40; // [sp+2Ch] [bp+20h]@1
  unsigned int v41; // [sp+30h] [bp+24h]@1
  char v42; // [sp+36h] [bp+2Ah]@1
  char v43; // [sp+37h] [bp+2Bh]@1

  v36 = (int)&v41;
  v42 = 0;
  v37 = (int)&v43;
  v41 = 0;
  v40 = 0;
  v43 = 0;
  v1 = a1;
  max_bandwidth_get(a1, &v39, &v40, &v42);
  printf("<style>");
  printf(".dot { width: 4px; height: 4px; background-color: black; margin: 8px; float: left; }");
  printf("</style>");
  v2 = printf("<form method=post action=\"timepro.cgi\" name=\"bandwidth_fm%d\" style='margin: 0;'>\n", v1);
  str(v2);
  printf("<td style='width:25%%;'>\n");
  printf("<div class='dot'></div>");
  printf("<select name=\"svc\" onChange=\"selectService('%d')\" style='width:100px;'>\n", v1);
  v4 = "selected";
  if ( !strcmp((const char *)&v39, "userdefine") )
    v5 = "selected";
  else
    v5 = "";
  v6 = sub_134F4(820, v3);
  printf("<option value=\"userdefine\" %s> %s \n", v5, v6);
  if ( !strcmp((const char *)&v39, "xdsl") )
    v8 = "selected";
  else
    v8 = "";
  v9 = sub_134F4(832, v7);
  printf("<option value=\"xdsl\" %s> %s \n", v8, v9);
  if ( !strcmp((const char *)&v39, "optical") )
    v11 = "selected";
  else
    v11 = "";
  v12 = sub_134F4(831, v10);
  printf("<option value=\"optical\" %s> %s \n", v11, v12);
  if ( !strcmp((const char *)&v39, "liteoptical") )
    v14 = "selected";
  else
    v14 = "";
  v15 = sub_134F4(829, v13);
  printf("<option value=\"liteoptical\" %s> %s \n", v14, v15);
  if ( strcmp((const char *)&v39, (const char *)&unk_7993D) )
    v4 = "";
  v17 = sub_134F4(830, v16);
  printf("<option value=\"gigaoptical\" %s> %s \n", v4, v17);
  puts("</select>");
  puts("</td>");
  v19 = sub_134F4(128, v18);
  printf("<td style='width:55px;'>%s</td>", v19);
  puts("<td style='width:135px;'>");
  if ( v42 )
  {
    printf("<input type=number name=\"dn\" value=\"%d\" min=0 style='width:60px;'>\n", v40);
  }
  else
  {
    v22 = sub_43EA8(v40, v20, v21, 0, (int)&v41, (int)&v43, v38);
    sub_43FA8(v22, v23, 0, 0x3F500000u);
    printf("<input type=number name=\"dn\" value=\"%g\" min=0 style='width:60px;'>\n");
  }
  printf("<span>Mbps</span>");
  puts("</td>");
  v25 = sub_134F4(1129, v24);
  printf("<td style='width:45px'>%s</td>", v25);
  puts("<td>");
  if ( v43 )
  {
    printf("<input type=number name=\"up\" value=\"%d\" min=0 style='width:60px;'>\n", v41);
  }
  else
  {
    v28 = sub_43EA8(v41, v26, v27, 0, v36, v37, v38);
    sub_43FA8(v28, v29, 0, 0x3F500000u);
    printf("<input type=number name=\"up\" value=\"%g\" min=0 style='width:60px;'>\n");
  }
  printf("<span>Mbps</span>");
  v30 = puts("</td>");
  etr(v30);
  printf("</form>");
  print_blank_line(5, 59);
  printf("<tr>");
  v31 = printf("<td colspan=5 align=right>");
  v32 = hwinfo_get_reboot_duration(v31);
  v34 = sub_134F4(28, v33);
  printf(
    "<button type='button' name='bandwidth_submit_button' style='width: 40px;font-size: 12px;height: 20px;padding: 0; margin:2px 10px;' onclick='bandwidthSubmit(%d, %d);'>%s</button>",
    v1,
    v32,
    v34,
    v36,
    v37);
  printf("</td>");
  return printf("</tr>");
}
// EBAC: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// F974: using guessed type int __fastcall max_bandwidth_get(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (000312D8) --------------------------------------------------------
int __fastcall sub_312D8(const char *a1)
{
  const char *v1; // r4@1
  int v2; // r0@2
  int v3; // r1@2
  char *v4; // r5@2
  char *v5; // r4@3
  int v6; // r0@5
  int v7; // r1@5
  int v8; // r0@7
  int v9; // r0@7
  int v10; // r0@7
  int v11; // r0@7
  int v12; // r4@7
  int v13; // r1@7
  int v14; // r0@7
  signed int v15; // r0@10
  int result; // r0@12
  int v17; // r0@14
  int v18; // r1@14
  char *v19; // r4@14
  char *v20; // r5@15
  int v21; // r0@17
  int v22; // r0@17
  int v23; // r1@17
  int v24; // r0@19
  int v25; // r0@19
  int v26; // r0@19
  int v27; // r1@19
  int v28; // r0@19
  int v29; // r0@20
  int v30; // r1@22
  int v31; // r0@22
  int v32; // r1@22
  int v33; // r0@22
  int v34; // r1@22
  int v35; // r0@22
  int v36; // r1@22
  int v37; // r0@22
  int v38; // r1@22
  int v39; // r0@22
  int v40; // r1@22
  int v41; // r0@22
  int v42; // r1@22
  int v43; // r0@22
  int v44; // r1@22
  int v45; // r0@22
  char *v46; // r1@25
  char *v47; // r0@26
  int v48; // r1@28
  int v49; // r0@28
  int v50; // r1@28
  int v51; // r0@28
  int v52; // r1@28
  int v53; // r0@28
  int v54; // r1@28
  int v55; // r0@28
  int v56; // r1@28
  int v57; // r0@28
  int v58; // r1@28
  int v59; // r0@28
  int v60; // r1@28
  int v61; // r0@28
  int v62; // r1@28
  int v63; // r0@28
  int v64; // r1@28
  int v65; // r0@28
  char dest; // [sp+1Fh] [bp-61h]@23
  char v67; // [sp+3Fh] [bp-41h]@22
  char v68; // [sp+53h] [bp-2Dh]@22
  char v69; // [sp+67h] [bp-19h]@26
  int v70; // [sp+6Ch] [bp-14h]@2

  v1 = a1;
  if ( !strcmp(a1, "onoff") )
  {
    v2 = tc_mode_get(&v70);
    str(v2);
    puts("<td colspan=3 style='padding-left: 5px;'>");
    puts("<form method=post action=\"timepro.cgi\" name=\"onoff_fm\" style='margin: 0;'>");
    v4 = "";
    if ( v70 )
      v5 = "checked";
    else
      v5 = "";
    v6 = sub_134F4(894, v3);
    printf("<input id=\"orun_true\" type=radio name=\"run\" value=1 %s><label for=\"orun_true\">%s</label>", v5, v6);
    print_nbsp(10);
    if ( !v70 )
      v4 = "checked";
    v8 = sub_134F4(900, v7);
    printf("<input id=\"orun_false\" type=radio name=\"run\" value=0 %s><label for=\"orun_false\">%s</label>", v4, v8);
    printf("</form>");
    v9 = puts("</td>");
    etr(v9);
    v10 = print_blank_line(3, 60);
    str(v10);
    v11 = printf("<td colspan=3 align=right>");
    v12 = hwinfo_get_reboot_duration(v11);
    v14 = sub_134F4(28, v13);
    printf(
      "<button type='button' name='onoff_submit_button' style='width: 40px;font-size: 12px;height: 20px;padding: 0; margin:2px 10px;' onclick='onoffSubmit(%d);'>%s</button>",
      v12,
      v14);
LABEL_20:
    v29 = printf("</td>");
    return etr(v29);
  }
  if ( !strncmp(v1, "type", 4u) )
  {
    if ( !strcmp(v1, "type") )
      v15 = 1;
    else
      v15 = atoi(v1 + 4);
    result = sub_30F70(v15);
  }
  else
  {
    if ( !strcmp(v1, "smartqos") )
    {
      str(0);
      puts("<form method=post action=\"timepro.cgi\" name=\"smartqos_fm\" style='margin: 0;'>");
      v17 = printf("<td style='padding-left: 5px;'>");
      v19 = "";
      if ( smart_qos_mode_get(v17) )
        v20 = "checked";
      else
        v20 = "";
      v21 = sub_134F4(894, v18);
      printf("<input type=radio id=\"srun_true\" name=\"run\" value=1 %s><label for=\"srun_true\">%s</label>", v20, v21);
      v22 = print_nbsp(10);
      if ( !smart_qos_mode_get(v22) )
        v19 = "checked";
      v24 = sub_134F4(900, v23);
      printf(
        "<input type=radio id=\"srun_false\" name=\"run\" value=0 %s><label for=\"srun_false\">%s</label>",
        v19,
        v24);
      printf("</td>");
      v25 = printf("</form>");
      etr(v25);
      v26 = print_blank_line(3, 60);
      str(v26);
      printf("<td colspan=3 align=right>");
      v28 = sub_134F4(28, v27);
      printf(
        "<button type='button' name='smartqos_submit_button' style='width: 40px;font-size: 12px;height: 20px;padding: 0; margin:2px 10px;' onclick='smartqosSubmit();'>%s</button>",
        v28);
      goto LABEL_20;
    }
    result = strcmp(v1, "rule");
    if ( !result )
    {
      printf("<style>");
      printf("#rule_table td select { width:100px; height: 20px; }");
      printf("#rule_table input[type='text'][name^='ip'] { width: 30px !important; padding-left: 2px; }");
      printf((const char *)&unk_79FE9);
      printf("</style>");
      puts("<form method=post action=\"timepro.cgi\" name=\"rule_fm\" style='margin: 0;'>");
      puts("<tr style='height: 22px;'>");
      puts("<td>");
      printf("<div class='dot'></div>");
      puts("<select name=\"property\" onchange='checkChanges(); changedProperty(document);'>");
      v31 = sub_134F4(834, v30);
      printf("<option value=\"%d\" > %s\n", 2, v31);
      v33 = sub_134F4(835, v32);
      printf("<option value=\"%d\" > %s\n", 3, v33);
      puts("</select>");
      puts("</td>");
      printf("<td colspan=3>");
      v35 = sub_134F4(828, v34);
      printf("<span>%s</span>", v35);
      puts((const char *)&unk_7A127);
      v37 = sub_134F4(845, v36);
      printf("<span style='margin-left:42px;'>%s</span>", v37);
      puts("<input type=number name=\"up\" value=\"0\" min=0 style=\"width:60px; margin-left: 4px; margin-right: 2px; padding-left: 2px;\" onchange='checkChanges();' onkeyup='checkChanges();'><span>Mbps</span>");
      puts("</td>");
      printf("<td align=right>");
      v39 = sub_134F4(839, v38);
      printf(
        "<span>%s</span><input type='number' name='priority' min=1 style='width: 40px; margin: 0 5px; padding-left: 2px;' onchange='checkChanges();' onkeyup='checkChanges();'>",
        v39);
      printf("</td>");
      puts("</tr>");
      puts("<tr style='height: 22px;'>");
      puts("<td>");
      printf("<div class='dot'></div>");
      puts("<select name=\"iptype\" onchange='changedIptype( document ); checkChanges()'>");
      v41 = sub_134F4(826, v40);
      printf("<option value=\"single\" >%s</option>", v41);
      v43 = sub_134F4(825, v42);
      printf((const char *)&unk_7A3E8, v43);
      printf("<option value=\"twinip\" >Twin IP</option>");
      v45 = sub_134F4(822, v44);
      printf("<option value=\"all\" >%s</option>", v45);
      puts("</select>");
      puts("</td>");
      puts("<td colspan=3>");
      get_ifconfig("br0", &v68, &v67);
      sub_11D7C((int)"ip", (int)&v68, 3);
      if ( v68 )
        sf_strncpy(&dest, &v68, 32);
      else
        strcpy(&dest, "");
      strtok(&dest, ".");
      strtok(0, ".");
      strtok(0, ".");
      v46 = strtok(0, ".");
      if ( v46 )
      {
        v47 = &v69;
      }
      else
      {
        v47 = &v69;
        v46 = "";
      }
      strcpy(v47, v46);
      printf("<span id='ip_tilde'>&nbsp;~&nbsp;</span>");
      v49 = sub_134F4(401, v48);
      printf(
        "<input type=text name=\"%s%d\" maxlength=3 size=3 style=\"width:30px; ime-mode:disabled;\" value=\"%s\" onfocus=\"this.select();\"                    onkeyup=\"IPKeyUp('%s',%d);\" onkeypress=\"return IPKeyDown('%s', %d)\" title=\"%s%d\">",
        "ip",
        5,
        &v69,
        "ip",
        5,
        "ip",
        5,
        v49,
        5);
      printf("<script>");
      printf("if( document.getElementsByName('ip4')[0].addEventListener ) {");
      printf("document.getElementsByName('ip4')[0].addEventListener('keyup', function() { checkChanges()});");
      printf("document.getElementsByName('ip5')[0].addEventListener('keyup', function() { checkChanges()});");
      printf("} else {");
      printf("document.getElementsByName('ip4')[0].attachEvent('keyup', function() { checkChanges()});");
      printf("document.getElementsByName('ip5')[0].attachEvent('keyup', function() { checkChanges()});");
      putchar(125);
      printf("</script>");
      print_nbsp(1);
      printf("<input id=bpi_checkbox type=checkbox name=bpichk style='vertical-align:bottom;' onclick='checkChanges();'>");
      printf("<label id=bpi_text for=bpi_checkbox>");
      v51 = sub_134F4(821, v50);
      printf((const char *)v51);
      printf("</label>");
      puts("</td>");
      printf("<td align=right>");
      v53 = sub_134F4(840, v52);
      printf(
        "<button type='button' name='pri_up' style='width:70px; font-size:12px; height:20px; padding: 0px; margin: 0 5px 0 0;' onclick='movePriorityUp();'><img src='/images2/fw_up.gif' style='margin:0 3px 3px 0;'>%s</button>",
        v53);
      printf("</td>");
      puts("</tr>");
      puts("<tr style='height: 22px;'>");
      puts("<td>");
      printf("<div class='dot'></div>");
      puts("<select name=\"port_select\" onchange='changedPortSelect( document ); checkChanges();'>");
      v55 = sub_134F4(833, v54);
      printf("<option value=\"manual\" >%s</option>", v55);
      printf("<option value=\"www\" >WWW</option>");
      printf("<option value=\"ms\" >MS stream</option>");
      puts("</select>");
      puts("</td>");
      puts("<td style='width:142px;'>");
      puts("<select name=\"protocol\" style='width:96px;' onchange='checkChanges();changedProtocol(document);'>");
      printf("<option value=\"all\">------</option>");
      printf("<option value=\"tcpudp\">TCP/UDP</option>");
      printf("<option value=\"tcp\">TCP</option>");
      printf("<option value=\"udp\">UDP</option>");
      puts("</select>");
      puts("</td>");
      puts("<td colspan=2 align=left>");
      printf("<input type=number name='portfrom' min=1 max=65535 style='width:55px; float: left;' onchange='checkChanges()'>");
      printf("<span class='port_tilde'>&nbsp;~&nbsp</span>");
      printf("<input type=number name='portto' min=1 max=65535 style='width:55px;' onchange='checkChanges()'>");
      puts("</td>");
      printf("<td align=right>");
      v57 = sub_134F4(838, v56);
      printf(
        "<button type='button' name='pri_down' style='width:70px; font-size:12px; height:20px; padding: 0px; margin: 0 5px 0 0;' onclick='movePriorityDown();'><img src='/images2/fw_down.gif' style='margin:0 3px 3px 0;'>%s</button>",
        v57);
      printf("</td>");
      puts("</tr>");
      printf("<tr>");
      printf("<td align='right' colspan=5 style='padding-right:5px; padding-top: 12px;'>");
      printf("<button type='button' name='new_rule_btn' style='width: 60px;font-size: 12px;height: 20px;padding: 0; margin:2px;' onclick='clickNewRuleButton();'>");
      v59 = sub_134F4(827, v58);
      printf("<img src='/images2/pf_plus_icon.gif' style='margin: 1px 2px 1px 1px;'>%s", v59);
      printf("</button>");
      v61 = sub_134F4(28, v60);
      printf(
        "<button type='button' name='apply_btn' style='width: 50px;font-size: 12px;height: 20px;padding: 0; margin:2px;' onclick='ruleSubmit(\"add\");'>%s</button>",
        v61);
      v63 = sub_134F4(535, v62);
      printf(
        "<button type='button' name='modify_btn' style='width: 50px;font-size: 12px;height: 20px;padding: 0; margin:2px;' onclick='ruleSubmit(\"modify\");'>%s</button>",
        v63);
      v65 = sub_134F4(47, v64);
      printf(
        "<button type='button' name='cancel_btn' style='width: 50px;font-size: 12px;height: 20px;padding: 0; margin:2px;' onclick='clickCancelButton();'>%s</button>",
        v65);
      printf("</td>");
      printf("</tr>");
      result = printf("</form>");
    }
  }
  return result;
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E9C0: using guessed type int __fastcall tc_mode_get(_DWORD);
// EBAC: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F14C: using guessed type int __fastcall smart_qos_mode_get(_DWORD);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (00031AE4) --------------------------------------------------------
int __fastcall sub_31AE4(const char *a1, int a2)
{
  const char *v2; // r6@1
  int v3; // r5@1

  v2 = a1;
  v3 = a2;
  printf("<TABLE border=0 valign=top CELLSPACING=0 CELLPADDING=0 WIDTH=100%% ID=%s_table STYLE=\"display:none;\">", a1);
  printf(
    "<tr><td height=20 valign=center style=\"padding:3px;width:130px;\">&nbsp;<b>%s</b></td><td align=right>%s</td></tr>",
    v3);
  printf("<tr height=1px style=\"background-Color:#dddddd\"><td colspan=5></td></tr>");
  sub_312D8(v2);
  return puts((const char *)&unk_6450B);
}

//----- (00031B48) --------------------------------------------------------
int sub_31B48()
{
  int v0; // r0@1
  int v1; // r1@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r1@1
  int v9; // r0@1
  int v10; // r1@1
  int v11; // r0@1
  int v12; // r1@1
  int v13; // r0@1
  int v14; // r0@1
  const char *v15; // r0@2
  _UNKNOWN *v16; // r4@4
  int v17; // r1@4
  int v18; // r0@4
  int v19; // r0@4
  int v20; // r1@4
  int v21; // r0@4
  int v22; // r1@4
  int v23; // r0@4
  int v24; // r1@4
  int v25; // r0@4
  int v26; // r1@4
  int v27; // r0@4
  int v28; // r0@4
  int v29; // r1@4
  int v30; // r0@4
  int v31; // r1@4
  int v32; // r0@4

  puts("<table class=menu_main_table cellpadding=0px cellspacing=0px style='width:640px; margin: 0;'>");
  printf("<style>");
  printf("input[type='text'], input[type='number'] { border: 1px solid #CCC; padding-left: 2px; }");
  v0 = printf("</style>");
  sub_30D94(v0, v1);
  sub_133E4((int)"trafficconf", (int)"qos");
  printf("<tr><td>");
  printf("<table style=\"border-collapse:collapse; border-style:none none none none; width:100%%;\" cellspacing=0px cellpadding=0px>\n");
  printf("<tr><td>");
  printf("<iframe name=\"trafficconf_qos_menu\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_qos_menu\" frameborder=no style='width:100%%; height:60px;'></iframe>");
  printf("</td></tr>");
  printf("<tr style='height:20px; background-color: #DBDBDB; border-top: 1px solid #CCC;'><td>");
  v3 = sub_134F4(842, v2);
  printf("<b style='margin-left: 5px;'>%s</b>", v3);
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=100%% style='background-color:#EEE; border-bottom: 1px solid #CCC;'>");
  printf("<colgroup><col width=5%%><col width=20%%><col width=23%%><col width=22%%><col width=9%%><col width=9%%><col width=12%%></colgroup>");
  printf("<tr style='height: 20px;'>");
  printf("<td></td>");
  v5 = sub_134F4(401, v4);
  printf("<td>%s</td>", v5);
  v7 = sub_134F4(803, v6);
  printf("<td>%s</td>", v7);
  v9 = sub_134F4(837, v8);
  printf("<td>%s</td>", v9);
  v11 = sub_134F4(128, v10);
  printf("<td>%s</td>", v11);
  v13 = sub_134F4(1129, v12);
  printf("<td>%s</td>", v13);
  v14 = printf("<td align=right>");
  if ( smart_qos_mode_get(v14) )
    v15 = "<span id='userrule_delete_button' style='display: none;'>";
  else
    v15 = "<span id='userrule_delete_button'>";
  printf(v15);
  v16 = sub_126C4();
  v18 = sub_134F4(118, v17);
  printf("<span style='cursor:pointer;' onclick='deleteUserRule();'><img src='/%s/minus_icon.gif'>%s</span>", v16, v18);
  puts("<input type=checkbox name=\"allchk\" onclick=\"CheckAllCheckBox(document.getElementsByName('trafficconf_qos_list')[0].contentWindow.document, this, 'del');\">");
  printf("</span>");
  v19 = puts("</td>");
  etr(v19);
  printf("</table>");
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<iframe name=\"trafficconf_qos_list\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_qos_list\" frameborder=no style='width:100%%; height:300px;'></iframe>");
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<table cellspacing=0 cellpadding=0 width=100%% style='border-top: 1px solid #CCC;'>");
  puts("<tr id='apply_html' style=\"background-Color:#eeeeee\"><td valign=top colspan=2>");
  v21 = sub_134F4(754, v20);
  sub_31AE4("onoff", v21);
  v23 = sub_134F4(819, v22);
  sub_31AE4("type", v23);
  v25 = sub_134F4(886, v24);
  sub_31AE4("smartqos", v25);
  v27 = sub_134F4(818, v26);
  sub_31AE4("rule", v27);
  printf("</td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("</table>");
  printf("<iframe name=\"trafficconf_qos_setup\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_qos_setup\" frameborder=no style='display:none;'></iframe>");
  printf("</td></tr>");
  printf("<script>");
  printf("DisableObj(document.getElementsByName('ip1')[0]);");
  printf("DisableObj(document.getElementsByName('ip2')[0]);");
  printf("DisableObj(document.getElementsByName('ip3')[0]);");
  v28 = printf("</script>");
  print_end_main_table(v28);
  v30 = sub_134F4(27, v29);
  sub_30EC4((int)"apply_mask", v30);
  v32 = sub_134F4(1115, v31);
  return sub_30EC4((int)"reboot_mask", v32);
}
// F14C: using guessed type int __fastcall smart_qos_mode_get(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F5F0: using guessed type int __fastcall print_end_main_table(_DWORD);

//----- (00031E9C) --------------------------------------------------------
int __fastcall sub_31E9C(const char *a1)
{
  const char *v1; // r4@1
  const unsigned __int16 **v2; // r0@1
  const char *v3; // r2@1
  const unsigned __int16 *v4; // r0@1
  int v6; // t1@4

  v1 = a1;
  v2 = _ctype_b_loc();
  v3 = v1;
  v4 = *v2;
  do
  {
    if ( !(v4[*v3] & 0x800) )
      return -7;
    v6 = (v3++)[1];
  }
  while ( v6 );
  return atoi(v1);
}

//----- (00031EE4) --------------------------------------------------------
int __fastcall sub_31EE4(int a1, int a2, int a3, int a4)
{
  int v4; // r7@1
  int v5; // r10@1
  int v6; // r9@1
  int v7; // r6@1
  int v8; // r1@1
  int v9; // r0@1
  int v10; // r1@1
  int v11; // r0@1
  int v12; // r3@1
  signed int v13; // r8@2
  int v14; // r0@5
  char *v15; // r0@6
  const char *v16; // r1@8
  char *v17; // r0@8
  int v18; // r6@9
  const char *v19; // r0@9
  char *v20; // r0@11
  const char *v21; // r1@11
  const char *v22; // r0@12
  int v23; // r1@12
  char *v24; // r0@13
  int v25; // r1@13
  signed int v26; // r2@16
  int v27; // r0@17
  int v28; // r4@20
  int v29; // r0@21
  int v30; // r3@29
  int v31; // r3@40
  unsigned __int8 v32; // r2@41
  int v33; // r3@45
  bool v34; // zf@45
  int v35; // r3@52
  bool v36; // zf@52
  int v37; // r1@63
  int v38; // r0@66
  int v39; // r0@68
  signed int v40; // r1@71
  int v41; // r0@74
  unsigned int v42; // r1@74
  signed int v43; // r1@78
  int v44; // r0@81
  unsigned int v45; // r1@81
  int v46; // r0@84
  int v47; // r2@87
  int v48; // r0@89
  char s[20]; // [sp+4h] [bp-294h]@1
  char v51[20]; // [sp+16h] [bp-282h]@1
  char dest; // [sp+84h] [bp-214h]@1
  _BYTE v53[3]; // [sp+95h] [bp-203h]@1
  char v54[4]; // [sp+104h] [bp-194h]@1
  char v55; // [sp+108h] [bp-190h]@1
  int v56; // [sp+184h] [bp-114h]@1
  char v57; // [sp+188h] [bp-110h]@1
  int v58; // [sp+204h] [bp-94h]@44
  int v59; // [sp+208h] [bp-90h]@51
  unsigned __int16 v60; // [sp+20Ch] [bp-8Ch]@40
  __int16 v61; // [sp+20Eh] [bp-8Ah]@40
  __int16 v62; // [sp+210h] [bp-88h]@50
  __int16 v63; // [sp+212h] [bp-86h]@57
  unsigned __int8 v64; // [sp+214h] [bp-84h]@43
  char v65; // [sp+216h] [bp-82h]@43
  char v66; // [sp+217h] [bp-81h]@5
  char v67; // [sp+237h] [bp-61h]@5
  char v68; // [sp+257h] [bp-41h]@26

  v4 = a3;
  v5 = a1;
  v6 = a2;
  v7 = a4;
  memcpy(s, "isolated, bounded", 0x12u);
  memset(v51, 0, 0x6Eu);
  memcpy(&dest, "isolated, borrow", 0x11u);
  memset(v53, 0, 0x6Fu);
  *(_DWORD *)v54 = 0;
  memset(&v55, 0, 0x7Cu);
  v56 = 0;
  memset(&v57, 0, 0x7Cu);
  v9 = sub_134F4(844, v8);
  strcpy(v54, (const char *)v9);
  v11 = sub_134F4(843, v10);
  strcpy((char *)&v56, (const char *)v11);
  v12 = *(_DWORD *)(v4 + 52);
  if ( v12 & 1 )
  {
    v13 = 0;
  }
  else
  {
    if ( !(v12 & 2) )
      return 0;
    v13 = 1;
  }
  printf("<tr style='background-color:#%s; height:20px; cursor: pointer;' onclick='loadInputValue(%d);'>");
  printf("<td name='index'><span style='margin-left: 10px;'>%d</span></td>\n", v7 + 1);
  puts("<td name='ip_address'>");
  strcpy(&v66, "");
  strcpy(&v67, "");
  v14 = v13 + 1;
  if ( *(_DWORD *)(v4 + 96 * v13 + 112) > 0x20u )
  {
    strcpy(&v66, (const char *)(v4 + 96 * v14));
    strcpy((char *)&unk_986B8, (const char *)(v4 + 96 * v13 + 120));
    strtok((char *)&unk_986B8, ".");
    strtok(0, ".");
    strtok(0, ".");
    v15 = strtok(0, ".");
    if ( !v15 )
    {
      strcpy((char *)&unk_986B8, "");
      v15 = (char *)&unk_986B8;
    }
    v16 = v15;
    v17 = &v67;
    goto LABEL_11;
  }
  v18 = 96 * v14;
  v19 = (const char *)get_twinip_wan_virtual_ip("wan1");
  if ( strcmp((const char *)(v4 + v18), v19) )
  {
    v22 = (const char *)get_twinip_wan_virtual_ip("wan2");
    if ( !strcmp((const char *)(v4 + v18), v22) )
    {
      v24 = &v66;
      v25 = (int)&unk_7B6C4;
    }
    else
    {
      if ( !*(_BYTE *)(v4 + v18) )
      {
        v27 = sub_134F4(16, v23);
        v26 = 64;
        v25 = v27;
        v24 = &v66;
        goto LABEL_18;
      }
      v24 = &v66;
      v25 = v4 + v18;
    }
    v26 = 16;
LABEL_18:
    v20 = (char *)sf_strncpy(v24, v25, v26);
    goto LABEL_19;
  }
  v16 = "Twin IP";
  v17 = &v66;
LABEL_11:
  v20 = strcpy(v17, v16);
LABEL_19:
  if ( v5 && (v28 = v5 + 8, (v20 = (char *)strcmp((const char *)(v5 + 8), "USER_TYPE")) != 0) )
  {
    v29 = strcmp((const char *)(v5 + 8), "SQ_TYPE");
  }
  else
  {
    if ( !v6 || (v28 = v6 + 8, (v20 = (char *)strcmp((const char *)(v6 + 8), "USER_TYPE")) == 0) )
    {
      v30 = *(_DWORD *)(v4 + 96 * v13 + 92);
      if ( v30 == 6 )
      {
        v20 = &v68;
        v21 = "TCP";
      }
      else if ( v30 == 17 )
      {
        v20 = &v68;
        v21 = "UDP";
      }
      else
      {
        if ( v30 == 255 )
          v21 = "TCP/UDP";
        if ( v30 == 255 )
          v20 = &v68;
        else
          v21 = "";
        if ( v30 != 255 )
          v20 = &v68;
      }
      goto LABEL_40;
    }
    v29 = strcmp((const char *)(v6 + 8), "SQ_TYPE");
  }
  if ( v29 )
  {
    v20 = &v68;
    v21 = (const char *)v28;
  }
  else
  {
    v20 = &v68;
    v21 = "ALL";
  }
LABEL_40:
  strcpy(v20, v21);
  v31 = v4 + 96 * v13;
  v60 = *(_WORD *)(v31 + 140);
  v61 = *(_WORD *)(v31 + 142);
  if ( v5 )
    v32 = *(_BYTE *)(v5 + 45);
  else
    v32 = *(_BYTE *)(v6 + 45);
  v64 = v32;
  v65 = *(_DWORD *)(v4 + 96 * v13 + 112) >> 31;
  if ( v5 )
  {
    v33 = *(_BYTE *)(v5 + 44);
    v34 = v33 == 0;
    if ( *(_BYTE *)(v5 + 44) )
      v33 = *(_DWORD *)(v5 + 40) << 10;
    else
      v58 = *(_DWORD *)(v5 + 40);
    if ( !v34 )
      v58 = v33;
  }
  else
  {
    v58 = 0;
  }
  v62 = 0;
  if ( v6 )
  {
    v35 = *(_BYTE *)(v6 + 44);
    v36 = v35 == 0;
    if ( *(_BYTE *)(v6 + 44) )
      v35 = *(_DWORD *)(v6 + 40) << 10;
    else
      v59 = *(_DWORD *)(v6 + 40);
    if ( !v36 )
      v59 = v35;
  }
  else
  {
    v59 = 0;
  }
  v63 = 0;
  printf("%s", &v66);
  if ( v67 )
    printf("~%s", &v67);
  puts("</td>");
  puts("<td name='protocol'>");
  printf("%s", &v68);
  print_nbsp(1);
  if ( v61 )
  {
    printf("%d - %d", v60);
  }
  else if ( v60 )
  {
    printf("%d", v60);
  }
  puts("</td>");
  puts("<td name='property'>");
  printf("%s", &s[128 * v64]);
  if ( *(_BYTE *)(v4 + 96 * v13 + 120) || *(_DWORD *)(v4 + 96 * v13 + 112) )
  {
    if ( v65 )
      v38 = 824;
    else
      v38 = 823;
    v39 = sub_134F4(v38, v37);
    printf("(%s)\n", v39);
  }
  puts("</td>");
  puts("<td name='download'>");
  if ( v58 )
  {
    if ( v58 & 0x3FF )
    {
      v41 = sub_43ECC(v58);
      sub_43FA8(v41, v42, 0, 0x3F500000u);
      printf("%gMbps");
    }
    else
    {
      v40 = v58 + 1023;
      if ( v58 >= 0 )
        v40 = v58;
      printf("%dMbps", v40 >> 10);
    }
  }
  else
  {
    printf("------");
  }
  puts("</td>");
  puts("<td name='upload'>");
  if ( v59 )
  {
    if ( v59 & 0x3FF )
    {
      v44 = sub_43ECC(v59);
      sub_43FA8(v44, v45, 0, 0x3F500000u);
      printf("%gMbps");
    }
    else
    {
      v43 = v59 + 1023;
      if ( v59 >= 0 )
        v43 = v59;
      printf("%dMbps", v43 >> 10);
    }
  }
  else
  {
    printf("------");
  }
  puts("</td>");
  puts("<td align=right >");
  if ( v5 )
    v46 = *(_DWORD *)v5;
  else
    v46 = 0;
  if ( v6 )
    v47 = *(_DWORD *)v6;
  else
    v47 = 0;
  printf("<input type=checkbox name=\"del\" value=\"%d %d\"\n", v46, v47);
  v48 = puts("</td>");
  etr(v48);
  return 0;
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// F920: using guessed type int __fastcall get_twinip_wan_virtual_ip(_DWORD);
// 31EE4: using guessed type char s[20];

//----- (00032560) --------------------------------------------------------
int __fastcall sub_32560(int a1, int a2, int a3)
{
  int result; // r0@2
  const unsigned __int16 **v4; // r0@5
  int *v5; // r2@5
  const unsigned __int16 *v6; // r0@5
  int v7; // t1@8
  int v8; // [sp+0h] [bp-108h]@2

  if ( a2 )
    result = get_value_post(a2, a3, &v8, 256);
  else
    result = get_value(a1, a3, &v8, 256);
  if ( result )
  {
    v4 = _ctype_b_loc();
    v5 = &v8;
    v6 = *v4;
    do
    {
      if ( !(v6[*(_BYTE *)v5] & 0x800) )
        return -7;
      v7 = *((_BYTE *)v5 + 1);
      v5 = (int *)((char *)v5 + 1);
    }
    while ( v7 );
    result = atoi((const char *)&v8);
  }
  return result;
}
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (000325DC) --------------------------------------------------------
int __fastcall sub_325DC(int a1, int a2)
{
  int v2; // r6@1
  int v3; // r10@1
  const char *v4; // r1@1
  int v5; // r4@26
  const char *v6; // r1@28
  char *v7; // r0@30
  int v8; // r0@31
  bool v9; // cf@31
  char *v10; // r0@32
  signed int v11; // r5@32
  int v12; // r4@35
  signed int v13; // r7@39
  int v14; // r0@45
  int v15; // r0@50
  __int16 v16; // r2@50
  char *v17; // r3@50
  signed int v18; // r8@56
  signed int v19; // r0@58
  signed int v20; // r2@62
  int v21; // r0@64
  signed int v22; // r5@67
  signed int v23; // r0@69
  int v24; // r0@72
  signed int v25; // r2@74
  int v26; // r0@76
  bool v27; // zf@79
  bool v28; // nf@79
  int v30; // r0@90
  char v31; // [sp+14h] [bp-19Ch]@3
  char v32; // [sp+94h] [bp-11Ch]@35
  char v33; // [sp+100h] [bp-B0h]@51
  int s; // [sp+114h] [bp-9Ch]@1
  int v35; // [sp+118h] [bp-98h]@2
  __int16 v36; // [sp+11Ch] [bp-94h]@17
  __int16 v37; // [sp+11Eh] [bp-92h]@19
  __int16 v38; // [sp+120h] [bp-90h]@5
  __int16 v39; // [sp+122h] [bp-8Eh]@9
  char v40; // [sp+124h] [bp-8Ch]@12
  unsigned __int8 v41; // [sp+125h] [bp-8Bh]@23
  char v42; // [sp+126h] [bp-8Ah]@15
  char v43; // [sp+127h] [bp-89h]@13
  char v44; // [sp+147h] [bp-69h]@13
  char v45; // [sp+167h] [bp-49h]@21
  int v46; // [sp+188h] [bp-28h]@83
  char dest; // [sp+18Ch] [bp-24h]@1

  v2 = a1;
  v3 = a2;
  memcpy(&dest, &unk_793C8, 4u);
  memset(&s, 0, 0x74u);
  s = sub_32560(0, v2, (int)"dn");
  if ( s < 0 || (v35 = sub_32560(0, v2, (int)"up"), v35 < 0) )
  {
    v24 = 1159;
    goto LABEL_90;
  }
  v38 = get_value_post(v2, "dnu", &v31, 128) && atoi(&v31) == 1;
  v39 = get_value_post(v2, "unu", &v31, 128) && atoi(&v31) == 1;
  if ( get_value_post(v2, "property", &v31, 128) )
    v40 = atoi(&v31);
  get_ip_value_post(v2, "sip", &v43);
  get_ip_value_post(v2, "eip", &v44);
  if ( get_value_post(v2, "bpichk", &v31, 32) && !strcmp(&v31, "true") )
    v42 = 1;
  if ( get_value_post(v2, "portfrom", &v31, 32) )
    v36 = atoi(&v31);
  if ( get_value_post(v2, "portto", &v31, 32) )
    v37 = atoi(&v31);
  if ( get_value_post(v2, "protocol", &v31, 32) )
    strcpy(&v45, &v31);
  if ( get_value_post(v2, "priority", &v31, 32) )
    v41 = atoi(&v31);
  if ( !strcmp(&v43, &v44) )
    strcpy(&v44, "");
  v5 = 0;
LABEL_27:
  if ( v5 )
    v6 = &v44;
  else
    v6 = &v43;
  strcpy(&v31, v6);
  v7 = &v31;
  v4 = ".";
  do
  {
    v10 = strtok(v7, v4);
    v11 = (signed int)v10;
    if ( !v10 )
    {
      ++v5;
      if ( v5 != 2 )
        goto LABEL_27;
      if ( get_value_post(v2, "iptype", &v32, 32) && (v12 = atoi(&v32)) != 0 )
      {
        v2 = (int)&s;
        strcpy(&v44, "");
        if ( v12 == 1 )
        {
          v14 = get_twinip_wan_virtual_ip("wan1");
          v13 = v11;
          sf_strncpy(&v43, v14, 16);
        }
        else
        {
          v13 = v11;
        }
      }
      else if ( v44 && check_ippool_range(&v43, &v44) )
      {
        if ( v42 )
        {
          v13 = 2147483648;
          inet_addr(&v44);
          inet_addr(&v43);
        }
        else
        {
          v13 = 33;
        }
      }
      else
      {
        strcpy(&v44, "");
        v13 = 0;
      }
      if ( !strcmp(&v45, "tcpudp") )
      {
        v2 = 255;
      }
      else if ( !strcmp(&v45, "tcp") )
      {
        v2 = 6;
      }
      else
      {
        v15 = strcmp(&v45, "udp");
        if ( v15 )
        {
          v16 = 0;
          v17 = &v33;
        }
        else
        {
          v2 = 17;
        }
        if ( v15 )
        {
          v2 = 0;
          *((_WORD *)v17 + 14) = v16;
          *((_WORD *)v17 + 15) = v16;
        }
      }
      if ( s )
      {
        if ( v3 == 1 )
          v19 = 2;
        else
          v19 = 3;
        if ( check_bandwidth_limitation(v19) < 0 )
          goto LABEL_72;
        if ( v3 == 1 )
          v20 = 2;
        else
          v20 = 3;
        v21 = class_create("USER_TYPE", 0, v20, s);
        v18 = v21;
        if ( v21 < 0 )
          goto LABEL_77;
        filter_add_to_class(v21, v2, &v43, v13);
      }
      else
      {
        v18 = -2;
      }
      if ( !v35 )
      {
        v22 = -2;
LABEL_79:
        v27 = v18 == 0;
        v28 = v18 < 0;
        if ( v18 > 0 )
        {
          v27 = v22 == 0;
          v28 = v22 < 0;
        }
        if ( !v28 && !v27 )
          class_make_couple(v18, v22);
        tc_count_file_read(&v46);
        if ( v46 > 126 )
        {
          v24 = 1158;
          goto LABEL_90;
        }
        ++v46;
        tc_count_file_write(v46);
        if ( v46 <= v41 )
          v41 = 0;
        return class_priority_order_write(v18, v22, v41);
      }
      if ( v3 == 1 )
        v23 = 4;
      else
        v23 = 5;
      if ( check_bandwidth_limitation(v23) < 0 )
      {
LABEL_72:
        v24 = 1161;
        goto LABEL_90;
      }
      if ( v3 == 1 )
        v25 = 4;
      else
        v25 = 5;
      v26 = class_create("USER_TYPE", 0, v25, v35);
      v22 = v26;
      if ( v26 >= 0 )
      {
        filter_add_to_class(v26, v2, &v43, v13);
        goto LABEL_79;
      }
LABEL_77:
      v24 = 1160;
      goto LABEL_90;
    }
    v8 = atoi(v10);
    v4 = ".";
    v9 = (unsigned int)v8 >= 0xFF;
    v27 = v8 == 255;
    v7 = 0;
  }
  while ( v27 || !v9 );
  v24 = 395;
LABEL_90:
  v30 = sub_134F4(v24, (int)v4);
  return printf("<script>alert('%s');</script>", v30);
}
// E87C: using guessed type int __fastcall tc_count_file_read(_DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// EC78: using guessed type int __fastcall class_make_couple(_DWORD, _DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F2E4: using guessed type int __fastcall class_create(_DWORD, _DWORD, _DWORD, _DWORD);
// F53C: using guessed type int __cdecl filter_add_to_class(_DWORD, _DWORD, _DWORD, _DWORD);
// F80C: using guessed type int __fastcall tc_count_file_write(_DWORD);
// F920: using guessed type int __fastcall get_twinip_wan_virtual_ip(_DWORD);
// F9D4: using guessed type int __fastcall class_priority_order_write(_DWORD, _DWORD, _DWORD);
// FA34: using guessed type int __fastcall check_ippool_range(_DWORD, _DWORD);
// FB3C: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// FC68: using guessed type int __fastcall check_bandwidth_limitation(_DWORD);

//----- (00032C44) --------------------------------------------------------
int __fastcall sub_32C44(int a1)
{
  int v1; // r7@1
  int v2; // lr@1
  const char *v3; // r4@2
  char *v4; // r5@2
  int v5; // r0@3
  int v6; // r0@5
  int v7; // r1@9
  char v9; // [sp+8h] [bp-B0h]@2
  int v10; // [sp+88h] [bp-30h]@1
  char s; // [sp+8Ch] [bp-2Ch]@1
  int v12; // [sp+9Ch] [bp-1Ch]@1

  v1 = a1;
  v10 = 7103844;
  memset(&s, 0, 0x10u);
  tc_count_file_read(&v12);
  v2 = 0;
  while ( get_value_array_post(v1, &v10, v2, &v9) )
  {
    v3 = strtok(&v9, " ");
    v4 = strtok(0, " ");
    if ( v3 )
    {
      v5 = atoi(v3);
      class_destroy(v5);
    }
    if ( v4 )
    {
      v6 = atoi(v4);
      class_destroy(v6);
    }
    if ( v3 )
      v3 = (const char *)atoi(v3);
    if ( v4 )
      v7 = atoi(v4);
    else
      v7 = 0;
    class_priority_order_write(v3, v7, -1);
    ++v2;
    --v12;
  }
  tc_count_file_write(v12);
  return 0;
}
// E87C: using guessed type int __fastcall tc_count_file_read(_DWORD);
// F7D0: using guessed type int __fastcall class_destroy(_DWORD);
// F80C: using guessed type int __fastcall tc_count_file_write(_DWORD);
// F9BC: using guessed type int __fastcall get_value_array_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F9D4: using guessed type int __fastcall class_priority_order_write(_DWORD, _DWORD, _DWORD);

//----- (00032D50) --------------------------------------------------------
int __fastcall sub_32D50(int a1)
{
  int v1; // r5@1
  int v2; // r0@1
  int v3; // r0@3
  int v5; // [sp+0h] [bp-30h]@1

  v1 = a1;
  v2 = get_value_post(a1, "wan_idx", &v5, 32);
  if ( v2 )
    v2 = atoi((const char *)&v5);
  tc_open(v2);
  v3 = sub_32C44(v1);
  tc_close(v3);
  tc_reconfig();
  return 0;
}
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F6D4: using guessed type int tc_reconfig(void);
// FCEC: using guessed type int __fastcall tc_close(_DWORD);
// FDF4: using guessed type int __fastcall tc_open(_DWORD);

//----- (00032DC0) --------------------------------------------------------
int __fastcall sub_32DC0(int a1, int a2)
{
  int v2; // r6@1
  int v3; // r4@4
  int v4; // r0@6
  int v5; // r0@9
  char *v6; // r1@9
  int v7; // r0@11
  int v8; // r10@13
  int v9; // r0@13
  int v10; // r8@15
  int v11; // r7@16
  int v12; // r5@19
  int v13; // r0@26
  int v14; // r7@27
  int v15; // r0@28
  signed int v16; // r4@29
  int v17; // r0@38
  int v18; // r0@39
  int v19; // r5@41
  int v20; // r0@41
  int v21; // r0@42
  bool v22; // cf@42
  int v23; // r0@47
  int result; // r0@48
  const char *v25; // r0@50
  const char *v26; // r0@57
  char v27; // [sp+8h] [bp-B0h]@21
  char s1; // [sp+28h] [bp-90h]@11
  char v29; // [sp+48h] [bp-70h]@3
  char v30; // [sp+68h] [bp-50h]@1
  int v31; // [sp+88h] [bp-30h]@24
  int v32; // [sp+8Ch] [bp-2Ch]@21
  int v33; // [sp+90h] [bp-28h]@6
  unsigned __int8 v34; // [sp+97h] [bp-21h]@21

  v2 = a2;
  sub_133E4((int)"trafficconf", (int)"qos");
  if ( get_value_post(v2, "act", &v30, 32) )
  {
    if ( strstr(&v30, "setup_tc_wan") )
    {
      if ( get_value_post(v2, "run", &v29, 32) )
        v3 = atoi(&v29) & 1;
      else
        v3 = 0;
      v4 = tc_mode_get(&v33);
      if ( v3 != v33 )
        v4 = tc_mode_set(v3);
      goto LABEL_47;
    }
    if ( strstr(&v30, "setup_bandwidth_wan") )
    {
      v5 = get_value_post(v2, "svc", &v29, 32);
      v6 = "";
      if ( v5 )
        v6 = &v29;
      sf_strncpy(&s1, v6, 32);
      v7 = get_value_post(v2, "dn", &v29, 32);
      if ( v7 )
        v7 = sub_31E9C(&v29);
      v8 = v7;
      v9 = get_value_post(v2, "up", &v29, 32);
      if ( v9 )
        v9 = sub_31E9C(&v29);
      v10 = v9;
      if ( get_value_post(v2, "dnu", &v29, 32) )
        v11 = (unsigned __int8)atoi(&v29);
      else
        v11 = 0;
      if ( get_value_post(v2, "upu", &v29, 32) )
        v12 = (unsigned __int8)atoi(&v29);
      else
        v12 = 0;
      max_bandwidth_get(1, &v27, &v32, &v34);
      v4 = strcmp(&s1, &v27);
      if ( v4 || v8 != v32 || v34 != v11 || v10 != v31 || (unsigned __int8)v33 != v12 )
      {
        tc_open(v4);
        v13 = max_bandwidth_set(1, &s1, v8, v11);
        tc_close(v13);
        v4 = tc_count_file_write(0);
      }
      goto LABEL_47;
    }
    v14 = lock_file("tc_lock_file");
    if ( !strcmp(&v30, "add") )
    {
      v15 = get_value_post(v2, "wan_idx", &v27, 32);
      if ( v15 )
      {
        v15 = atoi(&v27);
        v16 = v15;
      }
      else
      {
        v16 = 1;
      }
      tc_open(v15);
    }
    else
    {
      if ( !strcmp(&v30, "delete") )
      {
        sub_32D50(v2);
LABEL_46:
        v4 = unlock_file(v14);
LABEL_47:
        v23 = signal_update(v4);
        signal_save(v23);
        goto LABEL_48;
      }
      if ( strcmp(&v30, "modify") )
      {
        if ( !strcmp(&v30, (const char *)&unk_7B837) )
        {
          v19 = smart_qos_mode_get(0);
          v20 = get_value_post(v2, "run", &v27, 32);
          if ( v20 )
          {
            v21 = strcmp(&v27, "1");
            v22 = (unsigned int)v21 <= 1;
            v20 = 1 - v21;
            if ( !v22 )
              v20 = 0;
          }
          if ( v20 != v19 )
          {
            smart_qos_mode_set();
            istatus_remove_tag_prefix("sqpc+");
          }
        }
        goto LABEL_46;
      }
      if ( get_value_post(v2, "wan_idx", &v27, 32) )
        v16 = atoi(&v27);
      else
        v16 = 1;
      v17 = tc_count_file_read(&v31);
      tc_open(v17);
      sub_32C44(v2);
    }
    v18 = sub_325DC(v2, v16);
    tc_close(v18);
    tc_reconfig();
    goto LABEL_46;
  }
LABEL_48:
  puts("<form method=post action=\"timepro.cgi\" name=\"qos_onoff_fm\">");
  puts("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  puts("<input type=hidden name=\"smenu\" value=\"trafficconf_qos_setup\">");
  puts("<input type=hidden name=\"act\" value=\"setup_tc_wan\">");
  puts("<input type=hidden name=\"run\" value=\"\">");
  printf("</form>");
  puts("<form method=post action=\"timepro.cgi\" name=\"qos_wan1_bandwidth_fm\">");
  puts("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  puts("<input type=hidden name=\"smenu\" value=\"trafficconf_qos_setup\">");
  puts("<input type=hidden name=\"act\" value=\"setup_bandwidth_wan1\">");
  puts("<input type=hidden name=\"svc\" value=\"\">");
  puts("<input type=hidden name=\"dn\" value=\"\">");
  printf("<input type=hidden name=\"dnu\" value=\"%d\">\n", 0);
  puts("<input type=hidden name=\"up\" value=\"\">");
  printf("<input type=hidden name=\"upu\" value=\"%d\">\n", 0);
  printf("</form>");
  puts("<form method=post action=\"timepro.cgi\" name=\"qos_smartqos_fm\">");
  puts("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  puts("<input type=hidden name=\"smenu\" value=\"trafficconf_qos_setup\">");
  puts("<input type=hidden name=\"act\" value=\"setup_smartqos_wan1\">");
  puts("<input type=hidden name=\"run\" value=\"\">");
  printf("</form>");
  puts("<form method=post action=\"timepro.cgi\" name=\"qos_rule_fm\">");
  puts("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  puts("<input type=hidden name=\"smenu\" value=\"trafficconf_qos_setup\">");
  puts("<input type=hidden name=\"act\" value=\"\">");
  puts("<input type=hidden name=\"property\" value=\"\">");
  puts("<input type=hidden name=\"priority\" value=\"\">");
  puts("<input type=hidden name=\"dn\" value=\"\">");
  printf("<input type=hidden name=\"dnu\" value=\"%d\">\n", 0);
  puts("<input type=hidden name=\"up\" value=\"\">");
  printf("<input type=hidden name=\"upu\" value=\"%d\">\n", 0);
  puts("<input type=hidden name=\"iptype\" value=\"\">");
  puts("<input type=hidden name=\"sip1\" value=\"\">");
  puts("<input type=hidden name=\"sip2\" value=\"\">");
  puts("<input type=hidden name=\"sip3\" value=\"\">");
  puts("<input type=hidden name=\"sip4\" value=\"\">");
  puts("<input type=hidden name=\"eip1\" value=\"\">");
  puts("<input type=hidden name=\"eip2\" value=\"\">");
  puts("<input type=hidden name=\"eip3\" value=\"\">");
  puts("<input type=hidden name=\"eip4\" value=\"\">");
  puts("<input type=hidden name=\"bpichk\" value=\"\">");
  puts("<input type=hidden name=\"protocol\" value=\"\">");
  puts("<input type=hidden name=\"portfrom\" value=\"\">");
  puts("<input type=hidden name=\"portto\" value=\"\">");
  puts("<input type=hidden name=\"del\" value=\"\">");
  puts("<input type=hidden name=\"wan_idx\" value=\"\">");
  printf("</form>");
  result = get_value_post(v2, "act", &v30, 32);
  if ( result )
  {
    printf("<script>");
    printf("setTimeout(function() {");
    printf("UnMaskIt(parent.document, 'apply_mask');");
    printf("menuWindow(parent.document).document.getElementsByName('trafficconf_qos_menu_status')[0]");
    printf((const char *)&unk_7BDFA);
    if ( strstr(&v30, "setup_tc_wan") )
    {
      v25 = "&menu=setup_tc';";
    }
    else if ( strstr(&v30, "setup_bandwidth_wan") )
    {
      v25 = "&menu=setup_bandwidth';";
    }
    else if ( strstr(&v30, "setup_smartqos_wan") )
    {
      v25 = "&menu=setup_smartqos';";
    }
    else
    {
      v25 = "';";
    }
    printf(v25);
    printf("parent.document.getElementsByName('trafficconf_qos_list')[0].contentWindow.document.getElementsByName('trafficconf_qos_list_status')[0]");
    printf((const char *)&unk_7BF30);
    if ( strstr(&v30, "setup_tc_wan") )
    {
      v26 = "&menu=setup_tc';";
    }
    else if ( strstr(&v30, "setup_bandwidth_wan") )
    {
      v26 = "&menu=setup_bandwidth';";
    }
    else if ( strstr(&v30, "setup_smartqos_wan") )
    {
      v26 = "&menu=setup_smartqos';";
    }
    else
    {
      v26 = "';";
    }
    printf(v26);
    printf("}, 500);");
    result = printf("</script>");
  }
  return result;
}
// E87C: using guessed type int __fastcall tc_count_file_read(_DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E9C0: using guessed type int __fastcall tc_mode_get(_DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EBDC: using guessed type int __fastcall tc_mode_set(_DWORD);
// F05C: using guessed type int smart_qos_mode_set(void);
// F140: using guessed type int __fastcall max_bandwidth_set(_DWORD, _DWORD, _DWORD, _DWORD);
// F14C: using guessed type int __fastcall smart_qos_mode_get(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F6D4: using guessed type int tc_reconfig(void);
// F80C: using guessed type int __fastcall tc_count_file_write(_DWORD);
// F974: using guessed type int __fastcall max_bandwidth_get(_DWORD, _DWORD, _DWORD, _DWORD);
// FCBC: using guessed type int __fastcall unlock_file(_DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);
// FCEC: using guessed type int __fastcall tc_close(_DWORD);
// FD10: using guessed type int __fastcall istatus_remove_tag_prefix(_DWORD);
// FDF4: using guessed type int __fastcall tc_open(_DWORD);
// FEA8: using guessed type int __fastcall lock_file(_DWORD);

//----- (00033510) --------------------------------------------------------
int __fastcall sub_33510(int a1, int a2)
{
  int v2; // r8@1
  int v3; // r10@1
  int v4; // r0@1
  int v5; // r0@4
  int v6; // r5@4
  unsigned int v7; // r5@5
  int v8; // r6@14
  int v9; // r7@14
  int v10; // r0@15
  char *v11; // r1@15
  char *v12; // r0@16
  bool v13; // zf@16
  const char *v14; // r0@16
  int v15; // r1@18
  int v16; // r0@18
  int v17; // r6@21
  int v18; // r0@22
  int v19; // r4@22
  int v20; // r3@23
  int v21; // r0@23
  int v22; // r3@28
  const char *v23; // r0@31
  _UNKNOWN *v24; // r0@33
  int v25; // r1@33
  int v26; // r0@33
  int v27; // r0@36
  int v28; // r5@36
  const char *v29; // r0@42
  int v30; // r0@45
  int v31; // r0@48
  char v33; // [sp+Ch] [bp-16Ch]@15
  char v34; // [sp+4Ch] [bp-12Ch]@18
  char v35; // [sp+10Ch] [bp-6Ch]@8
  char v36; // [sp+12Ch] [bp-4Ch]@1
  unsigned int v37; // [sp+14Ch] [bp-2Ch]@4
  unsigned int v38; // [sp+150h] [bp-28h]@4
  char v39; // [sp+156h] [bp-22h]@4
  char v40; // [sp+157h] [bp-21h]@4

  v2 = a2;
  v3 = a1;
  v4 = get_value_post(a2, "act", &v36, 32);
  if ( v4 )
  {
    v4 = strcmp(&v36, "delete");
    if ( !v4 )
      v4 = sub_32D50(v2);
  }
  tc_open(v4);
  sub_133E4((int)"trafficconf", (int)"qos");
  printf("<body>");
  puts("<form id='rule_list_form' method=post action=\"timepro.cgi\" name=\"rule_list_fm\" style='margin: 0;'>");
  puts("<input type=hidden name=\"tmenu\" value=\"iframe\">");
  puts("<input type=hidden name=\"smenu\" value=\"trafficconf_qos_list_status\">");
  puts("<input type=hidden name=\"act\" value=\"delete\">");
  v5 = printf("<table cellspacing=0 cellpadding=0 style='width:100%%;'>");
  v38 = 0;
  v37 = 0;
  v40 = 0;
  v39 = 0;
  v6 = smart_qos_mode_get(v5);
  if ( v6 )
  {
    v7 = 0;
    do
    {
      if ( istatus_get_index_info_direct("sqpc+", v7, 0) == -1 )
        break;
      ++v7;
    }
    while ( v7 != 254 );
    printf("<colgroup><col width=5%%><col width=20%%><col width=23%%><col width=22%%><col width=9%%><col width=9%%><col width=12%%></colgroup>");
    max_bandwidth_get(1, &v35, &v37, &v39);
    if ( !v39 )
      v37 >>= 10;
    if ( !v40 )
      v38 >>= 10;
    if ( v7 )
    {
      v37 = sub_43A2C(v37, v7);
      v38 = sub_43A2C(v38, v7);
    }
    v8 = 0;
    v9 = 0;
    do
    {
      v10 = istatus_get_index_info_direct("sqpc+", v8++, &v33);
      v11 = "wan";
      if ( v10 == -1 )
        break;
      v12 = strstr(&v33, "wan");
      v13 = v12 == 0;
      v14 = v12 + 3;
      if ( !v13 && atoi(v14) == 1 )
      {
        ++v9;
        printf("<tr style='background-color:#%s; height:20px;'>");
        printf("<td><span style='margin-left: 10px;'>%d</span></td>\n", v9);
        printf("<td name='ip_address'>");
        printf("%s</td>", &v34);
        printf("<td name='protocol'>ALL</td>");
        v16 = sub_134F4(844, v15);
        printf("<td name='property'>%s</td>", v16);
        printf("<td name='download' align=right>%dMbps</td>", v37);
        printf("<td name='upload' align=right>%dMbps</td>", v38);
        printf("<td align=right ></td>");
      }
    }
    while ( v8 != 254 );
  }
  else
  {
    printf("<colgroup><col width=5%%><col width=20%%><col width=23%%><col width=22%%><col width=9%%><col width=9%%><col width=12%%></colgroup>");
    v17 = 0;
    do
    {
      v18 = class_get(v17);
      v19 = v18;
      if ( !*(_DWORD *)v18 )
        break;
      v20 = *(_BYTE *)(v18 + 38);
      v21 = *(_DWORD *)(v18 + 248);
      if ( (unsigned int)(v20 - 2) > 1 )
      {
        if ( !v21 )
        {
          v22 = v6++;
          sub_31EE4(0, v19, v19, v22);
        }
      }
      else
      {
        if ( v21 )
          v21 = class_find();
        sub_31EE4(v19, v21, v19, v6++);
      }
      ++v17;
    }
    while ( v17 != 254 );
    if ( v6 <= 14 )
      v23 = "<script>parent.parent.document.getElementById('userrule_delete_button').style.margin = '';</script>";
    else
      v23 = "<script>parent.parent.document.getElementById('userrule_delete_button').style.margin = '0 17px 0 0';</script>";
    printf(v23);
    printf("<TR id='add_rule_tr' height=20px STYLE=\"background-Color:#%s; cursor:pointer;\" onclick='clearInputValue(%d);'>");
    v24 = sub_126C4();
    v7 = v6 + 1;
    printf("<TD style='width:5%%;'><span style='padding-left:10px;'><img src='/%s/pf_new_rule.gif'></span></TD>", v24);
    v26 = sub_134F4(739, v25);
    printf("<TD colspan=6 align=left style='color:#4789FF; width:95%%;'>%s</TD>", v26);
    printf("</TR>");
  }
  while ( (signed int)v7 <= 14 )
  {
    ++v7;
    printf("<TR height=20px STYLE=\"background-Color:#%s\"><TD colspan=7></TD></TR>");
  }
  printf("</table>", v11);
  printf("</form>");
  printf("<script>");
  v27 = printf("parent.document.getElementById('rule_list_form').outerHTML = document.getElementById('rule_list_form').outerHTML;");
  v28 = smart_qos_mode_get(v27);
  if ( get_value_post(v2, "act", &v36, 32) )
  {
    printf("setTimeout(function() { UnMaskIt(parent.parent.document, 'apply_mask'); }, 500);");
    printf("parent.parent.document.getElementsByName('allchk')[0].checked = false;");
  }
  if ( get_value(v3, "menu", &v36, 32) )
  {
    if ( !v28 )
    {
      v29 = "parent.parent.document.getElementById('userrule_delete_button').style.display = '';";
LABEL_47:
      printf(v29);
      goto LABEL_48;
    }
LABEL_43:
    printf("parent.parent.document.getElementById('userrule_delete_button').style.display = 'none';");
    printf("(function sq_init_page() {");
    printf("\tif(!parent.parent.menuWindow(parent.parent.document).getSelectedTr) {");
    printf("\t\tsetTimeout(sq_init_page, 20); return;");
    printf("\t}");
    printf("\tif(!parent.parent.menuWindow(parent.parent.document).getSelectedTr( ))");
    printf("\t\tmenuWindow(parent.parent.document).clickQosMenu(0, 'onoff');");
    printf("})();");
    v29 = "setTimeout(function() { location.href = \"timepro.cgi?tmenu=iframe&smenu=trafficconf_qos_list_status\";}, 3000);";
    goto LABEL_47;
  }
  if ( v28 )
    goto LABEL_43;
  if ( !get_value(v3, "index", &v36, 32) )
  {
    printf("(function qos_init_page() { ");
    printf("\tif(!parent.parent.menuWindow(parent.parent.document).getSelectedTr) {");
    printf("\t\tsetTimeout(qos_init_page, 20); return; ");
    printf("\t}");
    printf("\tif(!parent.parent.menuWindow(parent.parent.document).getSelectedTr())");
    printf("\t\tparent.clearInputValue(parent.getTrIndex(parent.document.getElementById('add_rule_tr')));");
    v29 = "})();";
    goto LABEL_47;
  }
  v30 = atoi(&v36);
  printf("parent.window.loadInputValue(%d, true );", v30);
LABEL_48:
  printf("</script>");
  v31 = printf("</body>");
  return tc_close(v31);
}
// EDB0: using guessed type int __fastcall istatus_get_index_info_direct(_DWORD, _DWORD, _DWORD);
// F14C: using guessed type int __fastcall smart_qos_mode_get(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F3EC: using guessed type int class_find(void);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// F974: using guessed type int __fastcall max_bandwidth_get(_DWORD, _DWORD, _DWORD, _DWORD);
// FCC8: using guessed type int __fastcall class_get(_DWORD);
// FCEC: using guessed type int __fastcall tc_close(_DWORD);
// FDF4: using guessed type int __fastcall tc_open(_DWORD);

//----- (00033A94) --------------------------------------------------------
int __fastcall sub_33A94(int a1)
{
  int v1; // r7@1
  int v2; // r1@1
  int v3; // r0@2
  int v4; // r0@4
  int v5; // r1@4
  int v6; // r0@4
  int v7; // r1@4
  int v8; // r0@5
  int v9; // r0@13
  int v10; // r1@13
  int v11; // r0@15
  unsigned int v12; // r12@15
  const char *v13; // r2@15
  int v14; // r3@15
  char *v15; // r0@15
  int v16; // r4@16
  int v17; // r1@16
  int v18; // r2@16
  int v19; // r3@16
  int v20; // r0@16
  unsigned int v21; // r1@16
  __int64 v22; // r0@16
  int v23; // r0@17
  int v24; // r1@19
  int v25; // r0@21
  unsigned int v26; // r12@21
  const char *v27; // r2@21
  int v28; // r3@21
  char *v29; // r0@21
  int v30; // r4@22
  int v31; // r1@22
  int v32; // r2@22
  int v33; // r3@22
  int v34; // r0@22
  unsigned int v35; // r1@22
  __int64 v36; // r0@22
  int v37; // r0@23
  int v38; // r1@25
  int v39; // r0@25
  int v40; // r0@25
  int v41; // r1@25
  int v42; // r0@26
  int v43; // r0@28
  int v44; // r1@28
  int v45; // r0@28
  const char *v46; // r0@30
  __int64 v48; // [sp+0h] [bp-3B8h]@4
  int (__fastcall *v49)(_DWORD, _DWORD); // [sp+8h] [bp-3B0h]@0
  char dest; // [sp+Ch] [bp-3ACh]@4
  char v51; // [sp+20Ch] [bp-1ACh]@4
  char src; // [sp+30Ch] [bp-ACh]@15
  char v53; // [sp+34Ch] [bp-6Ch]@4
  char v54; // [sp+36Ch] [bp-4Ch]@28
  unsigned int v55; // [sp+38Ch] [bp-2Ch]@4
  unsigned int v56; // [sp+390h] [bp-28h]@4
  int v57; // [sp+394h] [bp-24h]@4
  int v58; // [sp+398h] [bp-20h]@1
  char v59; // [sp+39Fh] [bp-19h]@4

  v1 = a1;
  printf("<body style=\"padding:0px 0px; margin:0px 0px;\">");
  printf("<table id='menu_list_table' style=\"border-collapse:collapse; border-style:none none none none; width:100%%;\" cellspacing=0px cellpadding=0px>\n");
  v58 = 0;
  tc_mode_get(&v58);
  if ( v58 )
    v3 = 894;
  else
    v3 = 900;
  v4 = sub_134F4(v3, v2);
  strcpy(&v51, (const char *)v4);
  strcpy(&dest, "");
  v6 = sub_134F4(754, v5);
  sub_30D0C((int)"onoff", v6, (int)&v51, (int)&dest);
  LOBYTE(v58) = 0;
  v57 = 0;
  v56 = 0;
  v55 = 0;
  v59 = 0;
  tc_mode_get(&v57);
  HIDWORD(v48) = &v59;
  max_bandwidth_get(1, &v53, &v55, &v58);
  if ( !strcmp(&v53, "xdsl") )
  {
    v8 = 832;
  }
  else if ( !strcmp(&v53, "optical") )
  {
    v8 = 831;
  }
  else if ( !strcmp(&v53, "liteoptical") )
  {
    v8 = 829;
  }
  else if ( !strcmp(&v53, (const char *)&unk_7993D) )
  {
    v8 = 830;
  }
  else
  {
    v8 = 820;
  }
  v9 = sub_134F4(v8, v7);
  strcpy(&v51, (const char *)v9);
  strcpy(&dest, "");
  if ( (_BYTE)v58 )
  {
    v23 = sub_134F4(128, v10);
    v13 = "%s[%dMbps] ";
    v12 = v55;
    v14 = v23;
    v15 = &src;
  }
  else
  {
    if ( v55 & 0x3FF )
    {
      v16 = sub_134F4(128, v10);
      v20 = sub_43EA8(v55, v17, v18, v19, (int)&v56, (int)&v59, v49);
      LODWORD(v22) = sub_43FA8(v20, v21, 0, 0x3F500000u);
      v14 = v16;
      v13 = "%s[%gMbps] ";
      v48 = v22;
      v15 = &src;
      goto LABEL_19;
    }
    v11 = sub_134F4(128, v10);
    v12 = v55 >> 10;
    v13 = "%s[%dMbps] ";
    v14 = v11;
    v15 = &src;
  }
  LODWORD(v48) = v12;
LABEL_19:
  snprintf2(v15, 32, v13, v14, v48);
  strcat(&dest, &src);
  if ( v59 )
  {
    v37 = sub_134F4(1129, v24);
    v27 = "%s[%dMbps]";
    v26 = v56;
    v28 = v37;
    v29 = &src;
  }
  else
  {
    if ( v56 & 0x3FF )
    {
      v30 = sub_134F4(1129, v24);
      v34 = sub_43EA8(v56, v31, v32, v33, v48, SHIDWORD(v48), v49);
      LODWORD(v36) = sub_43FA8(v34, v35, 0, 0x3F500000u);
      v28 = v30;
      v27 = "%s[%gMbps]";
      v48 = v36;
      v29 = &src;
      goto LABEL_25;
    }
    v25 = sub_134F4(1129, v24);
    v26 = v56 >> 10;
    v27 = "%s[%dMbps]";
    v28 = v25;
    v29 = &src;
  }
  LODWORD(v48) = v26;
LABEL_25:
  snprintf2(v29, 32, v27, v28, v48);
  strcat(&dest, &src);
  v39 = sub_134F4(819, v38);
  v40 = sub_30D0C((int)"type", v39, (int)&v51, (int)&dest);
  if ( smart_qos_mode_get(v40) )
    v42 = 894;
  else
    v42 = 900;
  v43 = sub_134F4(v42, v41);
  strcpy(&v51, (const char *)v43);
  strcpy(&dest, "");
  v45 = sub_134F4(886, v44);
  sub_30D0C((int)"smartqos", v45, (int)&v51, (int)&dest);
  printf("</table>");
  printf("<script>");
  printf("parent.document.getElementById('menu_list_table').outerHTML = document.getElementById('menu_list_table').outerHTML;");
  if ( get_value(v1, "menu", &v54, 32) )
  {
    if ( strstr(&v54, "setup_tc") )
    {
      v46 = "parent.window.clickQosMenu(0, 'onoff');";
LABEL_35:
      printf(v46);
      goto LABEL_36;
    }
    if ( strstr(&v54, "setup_bandwidth") )
    {
      v46 = "parent.window.clickQosMenu(1, 'type');";
      goto LABEL_35;
    }
    if ( strstr(&v54, (const char *)&unk_7C881) )
    {
      v46 = "parent.window.clickQosMenu(2, 'smartqos');";
      goto LABEL_35;
    }
  }
LABEL_36:
  printf("</script>");
  return printf("</body>");
}
// E9C0: using guessed type int __fastcall tc_mode_get(_DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// F14C: using guessed type int __fastcall smart_qos_mode_get(_DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// F974: using guessed type int __fastcall max_bandwidth_get(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00033EE8) --------------------------------------------------------
int sub_33EE8()
{
  printf("<style>");
  printf("body { margin: 0; }");
  printf("table { border: 0; }");
  printf("tr { background-color: #FFF; }");
  printf("</style>");
  printf("<body>");
  printf("<table id=conninfo_total_table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=100%%'>");
  printf("</table>");
  printf("<iframe name=\"trafficconf_conninfo_total_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_conninfo_total_status\" frameborder=no style='display:none;'></iframe>");
  return printf("</body>");
}

//----- (00033F68) --------------------------------------------------------
int __fastcall sub_33F68(unsigned __int64 a1, char *a2)
{
  signed __int64 v2; // r6@1
  char *v3; // r8@1
  int v4; // r0@4
  unsigned int v5; // r2@4
  const char *v6; // r1@4
  int v7; // r3@4
  char *v8; // r0@4
  int v9; // r0@7
  int v10; // r4@7
  int v12; // r0@9
  int v13; // r4@9

  v2 = a1;
  v3 = a2;
  if ( a1 > 0x40000000 )
  {
    v4 = sub_43AF4(a1 & 0x3FFFFFFF, 108003328);
    v5 = v2 >> 30;
    v6 = "%d.%d GB";
    v7 = v4;
    v8 = v3;
  }
  else if ( (unsigned int)a1 > 0x100000 )
  {
    v9 = sub_449BC(a1 & 0xFFFFF, 105472LL);
    v5 = (unsigned int)v2 >> 20;
    v10 = v9;
    v6 = "%d.%d MB";
    v8 = v3;
    v7 = v10;
  }
  else
  {
    if ( (unsigned int)a1 <= 0x400 )
      return sprintf(a2, "%d B", a1);
    v12 = sub_449BC(a1 & 0x3FF, 103LL);
    v5 = (unsigned int)v2 >> 10;
    v13 = v12;
    v8 = v3;
    v7 = v13;
    v6 = "%d.%d KB";
  }
  return sprintf(v8, v6, v5, v7);
}

//----- (00034070) --------------------------------------------------------
FILE *__fastcall sub_34070(int a1)
{
  int v1; // r8@1
  const char *v2; // r0@1
  FILE *result; // r0@1
  FILE *v4; // r10@1
  in_addr_t v5; // r11@2
  in_addr_t v6; // r9@2
  char *v7; // r7@3
  char *v8; // r0@4
  const char *v9; // r5@4
  const char *v10; // r0@7
  char *v11; // r0@8
  const char *v12; // r5@8
  char *v13; // r0@14
  const char *v14; // r5@14
  signed int v15; // r4@17
  char *v16; // r0@20
  const char *v17; // r5@20
  char *v18; // r0@23
  int *v19; // r2@24
  int *v20; // r3@27
  int i; // r6@30
  int v22; // r0@36
  int v23; // r3@37
  int v24; // r3@39
  __int64 v25; // r4@42
  int v26; // lr@42
  int v27; // r12@42
  int v28; // r3@42
  void *v29; // r0@45
  void *v30; // r4@45
  void *v31; // r5@45
  int v32; // r0@52
  int v33; // r3@53
  int v34; // r3@55
  int v35; // r1@58
  __int64 v36; // r2@58
  int v37; // r3@71
  int v38; // r2@71
  int v39; // r4@84
  int *v40; // r2@88
  int *v41; // r3@88
  int v42; // [sp+4h] [bp-2ACh]@1
  in_addr_t v43; // [sp+8h] [bp-2A8h]@2
  in_addr_t v44; // [sp+Ch] [bp-2A4h]@1
  char v45; // [sp+10h] [bp-2A0h]@3
  in_addr_t s; // [sp+210h] [bp-A0h]@3
  int v47; // [sp+224h] [bp-8Ch]@25
  int v48; // [sp+228h] [bp-88h]@24
  char v49; // [sp+230h] [bp-80h]@28
  int v50; // [sp+238h] [bp-78h]@27
  char s2; // [sp+24Ch] [bp-64h]@2
  char v52; // [sp+260h] [bp-50h]@2
  char v53; // [sp+274h] [bp-3Ch]@2

  v1 = a1;
  v42 = lock_file("trafficconf_conninfo_connection_lock_file");
  v2 = (const char *)get_twinip_wan_virtual_ip("wan1");
  v44 = inet_addr(v2);
  system("cat /proc/net/ip_conntrack > /var/run/ip_conntrack");
  result = fopen("/var/run/ip_conntrack", "r");
  v4 = result;
  if ( result )
  {
    get_ifconfig("br0", &s2, &v52);
    v43 = inet_addr(&s2);
    v5 = inet_addr(&v52);
    get_wan_ip("wan1", &v53);
    v6 = inet_addr(&v53);
LABEL_85:
    while ( fgets(&v45, 512, v4) )
    {
      memset(&s, 0, 0x38u);
      v7 = strtok(&v45, " ");
      if ( strcmp(v7, "EXPECTING:") )
      {
        do
        {
          v8 = strtok(0, " ");
          v9 = v8;
        }
        while ( v8 && strncmp(v8, "src=", 4u) );
        sscanf(v9, "src=%s", &v53);
        s = inet_addr(&v53);
        if ( s == -1 )
        {
          v10 = "Data format is wrong!<BR>";
LABEL_47:
          puts(v10);
        }
        else
        {
          do
          {
            v11 = strtok(0, " ");
            v12 = v11;
          }
          while ( v11 && strncmp(v11, "dst=", 4u) );
          sscanf(v12, "dst=%s", &v53);
          if ( strcmp(&v53, &s2) )
          {
            if ( (v43 ^ s) & v5 && v6 != s && v44 != s )
            {
              do
              {
                v13 = strtok(0, " ");
                v14 = v13;
              }
              while ( v13 && strncmp(v13, "src=", 4u) );
              sscanf(v14, "src=%s", &v53);
              s = inet_addr(&v53);
              if ( s != -1 )
              {
                v15 = 1;
                goto LABEL_20;
              }
            }
            else
            {
              v15 = 0;
LABEL_20:
              while ( 1 )
              {
                v16 = strtok(0, " ");
                v17 = v16;
                if ( !v16 )
                  break;
                if ( !strncmp(v16, "org=", 4u) )
                {
                  if ( v15 )
                  {
                    v40 = &v47;
                    v41 = (int *)&v49;
                  }
                  else
                  {
                    v40 = &v48;
                    v41 = &v50;
                  }
                  sscanf(v17, "org=%d:%llu", v40, v41);
                  v18 = strtok(0, " ");
                  if ( v15 )
                    v19 = &v48;
                  else
                    v19 = &v47;
                  if ( v15 )
                    v20 = &v50;
                  else
                    v20 = (int *)&v49;
                  sscanf(v18, "rpl=%d:%llu", v19, v20);
                  break;
                }
              }
              for ( i = *(_DWORD *)v1; i; i = *(_DWORD *)(i + 52) )
              {
                if ( *(_DWORD *)i == s )
                {
                  if ( !strcmp(v7, "tcp") )
                  {
                    ++*(_DWORD *)(i + 4);
                  }
                  else if ( !strcmp(v7, "udp") )
                  {
                    ++*(_DWORD *)(i + 8);
                  }
                  else
                  {
                    v22 = strcmp(v7, "icmp");
                    if ( v22 )
                      v23 = *(_DWORD *)(i + 16);
                    else
                      v23 = *(_DWORD *)(i + 12);
                    v24 = v23 + 1;
                    if ( v22 )
                      *(_DWORD *)(i + 16) = v24;
                    else
                      *(_DWORD *)(i + 12) = v24;
                  }
                  v25 = *(_QWORD *)(i + 32) + *(_QWORD *)&v49;
                  v26 = *(_DWORD *)(i + 24);
                  v27 = *(_DWORD *)(i + 20) + v47;
                  v28 = v48;
                  *(_QWORD *)(i + 40) += *(_QWORD *)&v50;
                  *(_DWORD *)(i + 20) = v27;
                  *(_QWORD *)(i + 32) = v25;
                  *(_DWORD *)(i + 24) = v26 + v28;
                  goto LABEL_85;
                }
              }
              v29 = malloc(0x38u);
              v30 = v29;
              v31 = v29;
              if ( !v29 )
              {
                v10 = "Out of memory!";
                goto LABEL_47;
              }
              memset(v29, 0, 0x38u);
              *(_DWORD *)v30 = s;
              if ( !strcmp(v7, "tcp") )
              {
                ++*((_DWORD *)v30 + 1);
              }
              else if ( !strcmp(v7, "udp") )
              {
                ++*((_DWORD *)v30 + 2);
              }
              else
              {
                v32 = strcmp(v7, "icmp");
                if ( v32 )
                  v33 = *((_DWORD *)v30 + 4);
                else
                  v33 = *((_DWORD *)v30 + 3);
                v34 = v33 + 1;
                if ( v32 )
                  *((_DWORD *)v30 + 4) = v34;
                else
                  *((_DWORD *)v30 + 3) = v34;
              }
              *((_DWORD *)v30 + 5) = v47;
              v35 = *(_DWORD *)v1;
              *((_QWORD *)v30 + 4) = *(_QWORD *)&v49;
              *((_DWORD *)v30 + 6) = v48;
              v36 = *(_QWORD *)&v50;
              *((_QWORD *)v30 + 5) = *(_QWORD *)&v50;
              if ( v35 )
                v36 = *(_DWORD *)(v1 + 4);
              else
                *((_DWORD *)v30 + 12) = 0;
              if ( v35 )
                *((_DWORD *)v30 + 13) = HIDWORD(v36);
              else
                *(_DWORD *)v1 = v30;
              if ( v35 )
                *(_DWORD *)(v36 + 52) = v30;
              else
                *((_DWORD *)v30 + 13) = 0;
              *(_DWORD *)(v1 + 4) = v30;
              if ( v35 )
                *((_DWORD *)v30 + 12) = v36;
              do
              {
                v39 = *((_DWORD *)v31 + 12);
                if ( !v39 )
                  break;
                if ( ((*(_DWORD *)v31 >> 24) | (*(_DWORD *)v31 << 24) | ((*(_DWORD *)v31 & 0xFF0000u) >> 8) | ((*(_DWORD *)v31 & 0xFF00) << 8)) < ((*(_DWORD *)v39 >> 24) | (*(_DWORD *)v39 << 24) | ((*(_DWORD *)v39 & 0xFF0000u) >> 8) | ((*(_DWORD *)v39 & 0xFF00) << 8)) )
                {
                  v37 = *((_DWORD *)v31 + 13);
                  v38 = *(_DWORD *)(v39 + 48);
                  if ( v37 )
                    *(_DWORD *)(v37 + 48) = v39;
                  *(_DWORD *)(v39 + 52) = v37;
                  if ( !v37 )
                    *(_DWORD *)(v1 + 4) = v39;
                  if ( v38 )
                  {
                    *(_DWORD *)(v39 + 48) = v31;
                    *((_DWORD *)v31 + 13) = v39;
                  }
                  else
                  {
                    *(_DWORD *)(v39 + 48) = v31;
                  }
                  if ( v38 )
                  {
                    *(_DWORD *)(v38 + 52) = v31;
                    *((_DWORD *)v31 + 12) = v38;
                  }
                  else
                  {
                    *((_DWORD *)v31 + 13) = v39;
                    *((_DWORD *)v31 + 12) = 0;
                  }
                  if ( !v38 )
                    *(_DWORD *)v1 = v31;
                }
                v31 = (void *)*((_DWORD *)v31 + 12);
              }
              while ( v31 );
            }
          }
        }
      }
    }
    fclose(v4);
    unlink("/var/run/ip_conntrack");
    result = (FILE *)unlock_file(v42);
  }
  return result;
}
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F8CC: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);
// F920: using guessed type int __fastcall get_twinip_wan_virtual_ip(_DWORD);
// FCBC: using guessed type int __fastcall unlock_file(_DWORD);
// FEA8: using guessed type int __fastcall lock_file(_DWORD);

//----- (000345E0) --------------------------------------------------------
int sub_345E0()
{
  return get_file_value("/proc/sys/net/nf_conntrack_max", 1);
}
// EEF4: using guessed type int __fastcall get_file_value(_DWORD, _DWORD);

//----- (000345F0) --------------------------------------------------------
int __fastcall sub_345F0(int a1, int a2, int a3, int a4, int a5)
{
  signed int v5; // r10@0
  int v6; // r11@1
  int v7; // r9@1
  int v8; // r0@1
  int v9; // r7@5
  int v10; // r6@6
  int v11; // r4@6
  int v12; // r0@6
  int v13; // r8@7
  int v14; // r5@8
  int v15; // r0@9
  int v16; // r2@9
  int v17; // r3@9
  int v18; // r4@9
  int v19; // r1@9
  int v20; // r2@9
  int v21; // r3@9
  int v22; // r0@9
  int v23; // r0@10
  int v24; // r4@11
  int v25; // r5@11
  int v26; // r0@11
  int v27; // r2@11
  int v28; // r3@11
  int v29; // r0@12
  int v30; // r2@12
  int v31; // r3@12
  int v32; // r0@12
  int v33; // r0@13
  int v34; // r2@13
  int v35; // r3@13
  int v36; // r4@13
  int v37; // r0@13
  int v38; // r2@13
  int v39; // r3@13
  unsigned int v40; // r3@14
  signed int v41; // r5@15
  int v42; // r0@18
  int v43; // r2@18
  int v44; // r3@18
  int v45; // r0@18
  int v46; // r2@18
  int v47; // r3@18
  int v48; // r0@18
  unsigned int v49; // r0@18
  int v50; // r1@19
  int v51; // r0@20
  int v52; // r2@20
  int v53; // r3@20
  int v54; // r0@20
  int v55; // r2@20
  int v56; // r3@20
  int v57; // r0@20
  unsigned int v58; // r0@20
  int v59; // r0@22
  int v60; // r2@22
  int v61; // r3@22
  int v62; // r0@22
  int v63; // r2@22
  int v64; // r3@22
  int v65; // r0@22
  unsigned int v66; // r0@22
  int v67; // r4@24
  int v68; // r0@24
  int v69; // r2@24
  int v70; // r3@24
  int v71; // r0@24
  int v72; // r2@24
  int v73; // r3@24
  int v74; // r0@24
  unsigned int v75; // r0@24
  int v76; // r0@25
  int v77; // r2@25
  int v78; // r3@25
  int v79; // r0@25
  int v80; // r2@25
  int v81; // r3@25
  int v82; // r0@25
  unsigned int v83; // r5@25
  int v84; // r1@25
  int v85; // r0@25
  int v87; // [sp+4h] [bp-3Ch]@1
  int v88; // [sp+8h] [bp-38h]@1
  int v89; // [sp+Ch] [bp-34h]@1
  int v90; // [sp+10h] [bp-30h]@1
  unsigned int v91; // [sp+14h] [bp-2Ch]@3

  v89 = a2;
  v88 = a3;
  v87 = a4;
  v90 = a1;
  v6 = a2 + a1 + a3 + a4;
  v7 = sub_345E0();
  v8 = sub_445BC(v6);
  if ( !a5 )
    v5 = 212;
  v91 = v8;
  if ( a5 )
  {
    printf("<table border='0' cellpadding='0' cellspacing='0' width='%d'>\n", 420);
    puts("<tr>");
    printf("<td width='%d'><font color='gray'>0</td>\n", 95);
    printf("<td width='%d'><font color='gray'>2</td>\n", 99);
    printf("<td width='%d'><font color='gray'>10</td>\n", 99);
    printf("<td width='%d'><font color='gray'>50</td>\n", 99);
    printf("<td width='10'><font color='gray'>100%%</td>\n");
    puts("<td width='38'></td>");
    puts("</tr>");
    puts("</table>");
    v5 = 380;
  }
  v9 = v7 / 2;
  if ( v6 > v7 / 2 )
  {
    v10 = sub_445BC(3 * v5 >> 2);
    v11 = sub_445BC(v6 - v9);
    v12 = v7 - v9;
LABEL_9:
    v15 = sub_445BC(v12);
    v18 = sub_44800(v11, v15, v16, v17);
    v19 = sub_445BC((unsigned int)v5 >> 2);
    v22 = v18;
LABEL_12:
    v29 = sub_44668(v22, v19, v20, v21);
    v32 = sub_44424(v10, v29, v30, v31);
    goto LABEL_14;
  }
  v13 = sub_43AF4(v7, 10);
  if ( v6 > v13 )
  {
    v14 = sub_43AF4(v7, -10);
    v10 = sub_445BC((unsigned int)v5 >> 1);
    v11 = sub_445BC(v14 + v6);
    v12 = v14 + v9;
    goto LABEL_9;
  }
  v23 = sub_43AF4(v7, 50);
  if ( v6 > v23 )
  {
    v10 = sub_445BC(v5 >> 2);
    v24 = sub_43AF4(v7, -50);
    v25 = sub_445BC(v24 + v6);
    v26 = sub_445BC(v24 + v13);
    v22 = sub_44800(v25, v26, v27, v28);
    v19 = v10;
    goto LABEL_12;
  }
  v33 = sub_445BC(v23);
  v36 = sub_44800(v91, v33, v34, v35);
  v37 = sub_445BC(v5 >> 2);
  v32 = sub_44668(v36, v37, v38, v39);
LABEL_14:
  v40 = sub_44960(v32);
  if ( (signed int)v40 < 5 )
    v41 = 5;
  else
    v41 = v40;
  printf("<table border='0' cellpadding='0' cellspacing='0' style='border: 1px solid #CCC;' width='%d'>\n", v5);
  puts((const char *)&unk_7CCCA);
  puts((const char *)&unk_7CC7E);
  printf("\t\t\t<table border='0' cellpadding='0' cellspacing='1' width='%d'>\n", v41);
  puts((const char *)&unk_7CCC7);
  if ( v90 )
  {
    v42 = sub_445BC(v90);
    v45 = sub_44800(v42, v91, v43, v44);
    v48 = sub_44668(v45, 0x42C80000u, v46, v47);
    v49 = sub_44960(v48);
    printf("\t\t\t\t\t<td width='%d%%' height='9' bgcolor='#4D9DCE' title='TCP %d'></td>\n", v49, v90);
  }
  v50 = v89;
  if ( v89 )
  {
    v51 = sub_445BC(v89);
    v54 = sub_44800(v51, v91, v52, v53);
    v57 = sub_44668(v54, 0x42C80000u, v55, v56);
    v58 = sub_44960(v57);
    printf("\t\t\t\t\t<td width='%d%%' height='9' bgcolor='#FD8116' title='UDP %d'></td>\n", v58, v89);
  }
  if ( v88 )
  {
    v59 = sub_445BC(v88);
    v62 = sub_44800(v59, v91, v60, v61);
    v65 = sub_44668(v62, 0x42C80000u, v63, v64);
    v66 = sub_44960(v65);
    printf("\t\t\t\t\t<td width='%d%%' height='9' bgcolor='#74CA2D' title='ICMP %d'></td>\n", v66, v88);
  }
  if ( v87 )
  {
    v67 = sub_134F4(1127, v50);
    v68 = sub_445BC(v87);
    v71 = sub_44800(v68, v91, v69, v70);
    v74 = sub_44668(v71, 0x42C80000u, v72, v73);
    v75 = sub_44960(v74);
    printf("\t\t\t\t\t<td width='%d%%' height='9' bgcolor='#F0C800' title='%s %d'></td>\n", v75, v67, v87);
  }
  puts((const char *)&unk_7CDF4);
  puts((const char *)&unk_7CDFE);
  puts((const char *)&unk_7CE0A);
  printf("\t\t<td width='%d'></td>", v5 - v41);
  v76 = sub_445BC(v7);
  v79 = sub_44800(v91, v76, v77, v78);
  v82 = sub_44668(v79, 0x42C80000u, v80, v81);
  v83 = sub_44960(v82);
  sub_43BD0(100 * v6, v7);
  v85 = sub_43AF4(100 * v84, v7);
  printf("\t\t<td width='96' align='center'><font color='gray'>%d.%02d%% (%d)</td>\n", v83, v85, v6);
  puts((const char *)&unk_7CDF7);
  return puts("</table>");
}

//----- (00034A1C) --------------------------------------------------------
int sub_34A1C()
{
  int v0; // r10@2
  int v1; // r9@2
  int v2; // r11@2
  int v3; // r7@2
  int v4; // r6@2
  unsigned __int64 v5; // r0@2
  int v6; // r8@2
  __int64 v7; // r0@3
  int v8; // lr@3
  int v9; // r12@3
  int v10; // r3@3
  int v11; // r4@3
  int v12; // r1@5
  int v13; // r0@7
  int v14; // r0@8
  int v15; // r0@8
  int v16; // r0@8
  __int64 v18; // [sp+8h] [bp-100h]@0
  int v19; // [sp+1Ch] [bp-ECh]@2
  unsigned __int64 v20; // [sp+20h] [bp-E8h]@2
  unsigned __int64 v21; // [sp+28h] [bp-E0h]@2
  int v22; // [sp+34h] [bp-D4h]@2
  char v23; // [sp+38h] [bp-D0h]@8
  char s; // [sp+B8h] [bp-50h]@2
  int v25; // [sp+D8h] [bp-30h]@1
  int v26; // [sp+DCh] [bp-2Ch]@1

  v25 = 0;
  v26 = 0;
  sub_34070((int)&v25);
  printf("<body>");
  printf("<table id=conninfo_total_table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=100%%>");
  if ( v25 )
  {
    v0 = 0;
    v20 = 0LL;
    v1 = 0;
    v2 = 0;
    v3 = 0;
    v4 = 0;
    v22 = sub_345E0();
    LODWORD(v5) = sprintf(&s, "%d", v22);
    v19 = 0;
    v6 = v25;
    v21 = 0LL;
    while ( v6 )
    {
      v18 = *(_QWORD *)(v6 + 40);
      v20 += *(_QWORD *)(v6 + 32);
      HIDWORD(v7) = HIDWORD(v21);
      LODWORD(v7) = v21 + v18;
      v8 = *(_DWORD *)(v6 + 4);
      v9 = *(_DWORD *)(v6 + 24);
      v5 = v7 + v18;
      v2 += *(_DWORD *)(v6 + 8);
      v3 += *(_DWORD *)(v6 + 12);
      v10 = *(_DWORD *)(v6 + 16);
      v11 = *(_DWORD *)(v6 + 20);
      v6 = *(_DWORD *)(v6 + 52);
      v1 += v8;
      v4 += v10;
      v0 += v11;
      v21 = v5;
      v19 += v9;
    }
    str(v5);
    puts("<td rowspan=2 height=40 style='padding-left:5px;'>");
    if ( v22 )
    {
      sub_345F0(v1, v2, v3, v4, 1);
    }
    else
    {
      v13 = sub_134F4(1127, v12);
      printf(
        "<span style='font: normal normal normal 10px arial;'>TCP: %d, UDP: %d, ICMP: %d, %s: %d</span>",
        v1,
        v2,
        v3,
        v13,
        v4,
        v18);
    }
    puts("</td>");
    printf("<td width=90 style='vertical-align:bottom;'>%d</td>\n", v0);
    sub_33F68(v20, &v23);
    v14 = printf("<td width=111 style='vertical-align:bottom;'>%s</td>\n", &v23);
    v15 = etr(v14);
    str(v15);
    printf("<td width=90 style='vertical-align:top;'>%d</td>\n", v19);
    sub_33F68(v21, &v23);
    v16 = printf("<td width=111 style='vertical-align:top;'>%s</td>\n", &v23);
    etr(v16);
  }
  printf("</table>");
  printf("<script>");
  printf("parent.document.getElementById('conninfo_total_table').outerHTML = document.getElementById('conninfo_total_table').outerHTML;");
  printf("setTimeout(function() { location.reload(); }, 3000);");
  printf("</script>");
  return printf("</body>");
}
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);

//----- (00034C54) --------------------------------------------------------
signed int sub_34C54()
{
  signed int result; // r0@1
  int v1; // r4@1
  int v2; // r1@2
  int v3; // r0@2
  int v4; // r7@3
  int v5; // r6@3
  int v6; // r5@3
  int v7; // r10@3
  int v8; // r0@3
  int v9; // r12@3
  int v10; // r3@4
  int v11; // r2@4
  int v12; // r1@4
  int v13; // r1@6
  int v14; // r1@6
  int v15; // r8@6
  int v16; // r0@7
  int v17; // r1@9
  int v18; // r0@9
  int v19; // r1@9
  int v20; // r0@9
  int v21; // r0@9
  int v22; // r0@9
  int v23; // r1@9
  int v24; // r0@9
  int v25; // r1@9
  int v26; // r0@9
  int v27; // r0@9
  int v28; // r0@10
  int v29; // r0@10
  int v30; // r1@10
  int v31; // r0@10
  int v32; // r0@10
  int v33; // r1@10
  int v34; // r0@10
  int v35; // r1@10
  int v36; // r0@10
  int v37; // r1@10
  int v38; // r0@10
  int v39; // r1@10
  int v40; // r0@10
  int v41; // r0@10
  int v42; // r0@10
  int v43; // r1@10
  int v44; // r0@10
  int v45; // r1@10
  int v46; // r0@10
  int v47; // r0@10
  int v48; // r0@10
  int v49; // r0@10
  const char *v50; // r0@11
  int v51; // r0@13
  int v52; // r1@13
  int v53; // r4@13
  _UNKNOWN *v54; // r0@13
  int v55; // [sp+0h] [bp-48h]@3
  int v56; // [sp+20h] [bp-28h]@2
  int v57; // [sp+24h] [bp-24h]@2

  result = sub_12380();
  v1 = result;
  if ( !result )
  {
    puts("<table id='trafficconf_conninfo_main_table' cellpadding=0px cellspacing=0px width=641px>");
    v56 = v1;
    v57 = v1;
    sub_34070((int)&v56);
    printf("<tr style='background-color: #E3E3E3; height: 24px;'>");
    printf("<td style='border-style:solid; border-color: #CCC; border-width: 1px 0 1px 0;'>");
    v3 = sub_134F4(1024, v2);
    printf("<b style='padding-left: 5px;'>%s</b>", v3);
    printf("</td>");
    printf("</tr>");
    puts("<tr><td>");
    printf("<table cellspacing=0px cellpadding=0px style='background-color:#EEE; width: 100%%'>\n");
    if ( v56 )
    {
      v4 = v1;
      v5 = v1;
      v6 = v1;
      v7 = sub_345E0();
      v8 = sprintf((char *)&v55, "%d", v7);
      v9 = v56;
      while ( v9 )
      {
        v10 = *(_DWORD *)(v9 + 4);
        v11 = *(_DWORD *)(v9 + 8);
        v12 = *(_DWORD *)(v9 + 12);
        v8 = *(_DWORD *)(v9 + 16);
        v9 = *(_DWORD *)(v9 + 52);
        v6 += v10;
        v5 += v11;
        v4 += v12;
        v1 += v8;
      }
      str(v8);
      v15 = sub_134F4(1023, v13);
      if ( v7 )
        v16 = (int)&v55;
      else
        v16 = sub_134F4(751, v14);
      printf("<td rowspan=2 width=440px style='padding-left: 5px;'>%s (%d / %s) </td>\n", v15, v5 + v6 + v4 + v1, v16);
      v18 = sub_134F4(1019, v17);
      printf("<td style='width:90px;'>%s</td>", v18);
      v20 = sub_134F4(1018, v19);
      v21 = printf("<td style='width:111px;'>%s</td>", v20);
      v22 = etr(v21);
      str(v22);
      v24 = sub_134F4(1021, v23);
      printf("<td style='width:90px;'>%s</td>", v24);
      v26 = sub_134F4(1020, v25);
      v27 = printf("<td style='width:111px;'>%s</td>", v26);
      etr(v27);
    }
    printf("</table>");
    v28 = printf("</td></tr>");
    str(v28);
    printf("<td>");
    printf("<iframe name=\"trafficconf_conninfo_total\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_conninfo_total\" frameborder=no style='width:100%%; height:40px;'></iframe>");
    v29 = printf("</td>");
    etr(v29);
    printf("<tr style='background-color: #E3E3E3; height: 24px;'>");
    v31 = sub_134F4(1017, v30);
    printf(
      "<td style='border-style:solid; border-color:#CCC; border-width: 1px 0 1px 0;'><b style='padding-left:5px;'>%s</b></td>",
      v31);
    printf("</tr>");
    printf("<tr><td>");
    v32 = printf("<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=100%% style='background-color:#EEE; border-bottom: 1px solid #CCC; padding-left:5px;'>");
    str(v32);
    v34 = sub_134F4(401, v33);
    printf("<td rowspan=2 style='width:170px;'>%s</td>", v34);
    v36 = sub_134F4(1022, v35);
    printf("<td rowspan=2 colspan=2 style='width:265px;'>%s</td>", v36);
    v38 = sub_134F4(1019, v37);
    printf("<td style='width:90px;'>%s</td>", v38);
    v40 = sub_134F4(1018, v39);
    v41 = printf("<td style='width:111px;'>%s</td>", v40);
    v42 = etr(v41);
    str(v42);
    v44 = sub_134F4(1021, v43);
    printf("<td style='width:90px;'>%s</td>", v44);
    v46 = sub_134F4(1020, v45);
    v47 = printf("<td style='width:111px;'>%s</td>", v46);
    etr(v47);
    printf("</table>");
    v48 = printf("</td></tr>");
    str(v48);
    v49 = printf("<td style='border-bottom: 1px solid #CCC; '>");
    if ( is_mobile_agent(v49) )
    {
      printf("<div style=\"height:336px; width:100%%; -webkit-overflow-scrolling: touch; overflow-y:scroll; overflow-x:hidden; display:inline-block;\">");
      printf("<iframe name=\"trafficconf_conninfo_info\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_conninfo_info\" frameborder=no style='width:100%%; height:336px;'></iframe>");
      v50 = "</div>";
    }
    else
    {
      v50 = "<iframe name=\"trafficconf_conninfo_info\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_conninfo_info\" frameborder=no style='width:100%%; height:336px;'></iframe>";
    }
    printf(v50);
    v51 = printf("</td>");
    etr(v51);
    printf("</table>");
    v53 = sub_134F4(27, v52);
    printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
    puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
    printf("</DIV>");
    puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
    puts("<table width=\"180\" height=\"70\">");
    printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
    puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
    v54 = sub_126C4();
    printf(
      "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
      v54);
    printf("</SPAN></td>");
    printf(
      "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\">%s\n",
      v53);
    printf("</SPAN></td>");
    result = printf((const char *)&unk_60F0E);
  }
  return result;
}
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F74C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (0003503C) --------------------------------------------------------
int __fastcall sub_3503C(int a1, int a2)
{
  int v2; // r4@1
  signed int v3; // r4@5
  int result; // r0@7
  char v5; // [sp+8h] [bp-150h]@5
  char v6; // [sp+108h] [bp-50h]@3
  char v7; // [sp+128h] [bp-30h]@1

  v2 = a2;
  if ( get_value_post(a2, "act", &v7, 32)
    && !strcmp(&v7, "clear")
    && get_value_post(v2, "ip", &v6, 20)
    && !check_unpermitted_chars(&v6) )
  {
    quote_r(&v6, 20);
    snprintf2(&v5, 256, "echo '%s 32' >> %s", &v6, "/proc/ctproc/cleanup");
    system(&v5);
    sleep(1u);
    v3 = 1;
  }
  else
  {
    v3 = 0;
  }
  puts("<form method=post action=timepro.cgi name=conninfo_fm>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=trafficconf_conninfo_info_submit>");
  puts("<input type=hidden name=act>");
  puts("<input type=hidden name=ip>");
  result = printf("</form>");
  if ( v3 )
  {
    printf("<script>");
    printf("if(parent.document.getElementsByName('trafficconf_conninfo_info_status')[0])");
    printf("parent.document.getElementsByName('trafficconf_conninfo_info_status')[0].contentWindow.location.reload();");
    printf("setTimeout(function() { UnMaskIt(parent.parent.document, 'apply_mask'); }, 500);");
    result = printf("</script>");
  }
  return result;
}
// E990: using guessed type int __fastcall quote_r(_DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// F11C: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0003519C) --------------------------------------------------------
int sub_3519C()
{
  int v0; // r11@1
  int v1; // r7@1
  signed int v2; // r9@2
  int v3; // r3@2
  char *v4; // r0@5
  int v5; // r0@5
  int v6; // r8@5
  const char *v7; // r0@5
  char *v8; // r0@6
  const char *v9; // r1@6
  const char *v10; // r0@7
  int v11; // r1@15
  int v12; // r4@17
  int v13; // r5@17
  int v14; // r6@17
  int v15; // r0@17
  int v16; // r1@18
  int v17; // r0@18
  char *v18; // r1@19
  char *v19; // r1@23
  char *v20; // r2@25
  const char *v21; // r0@25
  int v22; // r0@30
  int v23; // r0@30
  char *v24; // r1@31
  char *v25; // r1@35
  char *v26; // r2@37
  const char *v27; // r0@37
  int v28; // r0@42
  signed int v30; // r10@4
  char s; // [sp+8h] [bp-258h]@14
  char v32; // [sp+108h] [bp-158h]@21
  char v33; // [sp+188h] [bp-D8h]@5
  char v34; // [sp+1B4h] [bp-ACh]@13
  char dest; // [sp+1F4h] [bp-6Ch]@6
  char v36; // [sp+208h] [bp-58h]@5
  char s2; // [sp+21Ch] [bp-44h]@1
  int v38; // [sp+230h] [bp-30h]@1
  int v39; // [sp+234h] [bp-2Ch]@1

  v38 = 0;
  v39 = 0;
  v0 = sub_345E0();
  sub_34070((int)&v38);
  get_wan_ip("wan1", &s2);
  printf("<body>");
  printf("<table id=conninfo_info_table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=100%% style='background-color:#EEE;'>");
  v1 = v38;
  if ( v38 )
  {
    v2 = 0;
    v3 = v38;
    do
    {
      v3 = *(_DWORD *)(v3 + 52);
      ++v2;
    }
    while ( v3 );
    v30 = 0;
    while ( 1 )
    {
      v4 = inet_ntoa(*(struct in_addr *)v1);
      sf_strncpy(&v36, v4, 20);
      memset(&v33, 0, 0x6Cu);
      v5 = dhcpd_get_dynamic_lease(&v36, &v33);
      str(v5);
      v6 = v30 & 1;
      printf("<td rowspan=2 width=170 style='padding-left: 5px; height:42px; %s'>\n");
      v7 = (const char *)get_twinip_wan_virtual_ip("wan1");
      if ( !strcmp(&v36, v7) )
      {
        v8 = &dest;
        v9 = "Twin IP(1)";
      }
      else
      {
        v10 = (const char *)get_twinip_wan_virtual_ip("wan2");
        if ( !strcmp(&v36, v10) )
        {
          v9 = "Twin IP(2)";
          v8 = &dest;
        }
        else
        {
          if ( strcmp(&v36, &s2) )
          {
            sf_strncpy(&dest, &v36, 20);
            goto LABEL_13;
          }
          v8 = &dest;
          v9 = "CPU(WAN1)";
        }
      }
      strcpy(v8, v9);
LABEL_13:
      printf("%s", &dest);
      if ( v34 )
      {
        memset(&s, 0, 0x100u);
        convert_euckr_to_utf8(&v34, &s);
        printf((const char *)&unk_7D836, &s);
      }
      puts("</td>");
      printf("<td rowspan=2 width=220px %s>\n");
      if ( v0 )
      {
        sub_345F0(*(_DWORD *)(v1 + 4), *(_DWORD *)(v1 + 8), *(_DWORD *)(v1 + 12), *(_DWORD *)(v1 + 16), 0);
      }
      else
      {
        v12 = *(_DWORD *)(v1 + 4);
        v13 = *(_DWORD *)(v1 + 8);
        v14 = *(_DWORD *)(v1 + 12);
        v15 = sub_134F4(1127, v11);
        printf(
          "<span style='font: normal normal normal 10px arial;'>TCP: %d, UDP: %d, ICMP: %d, %s: %d</span>",
          v12,
          v13,
          v14,
          v15,
          *(_DWORD *)(v1 + 16));
      }
      puts("</td>");
      printf("<td rowspan=2 width=40 %s>");
      v17 = sub_134F4(118, v16);
      printf(
        "<input type=button name='cleanup_bt' value='%s' style='margin-right: 5px;'onclick=ClearConntrack('%s')>\n",
        v17,
        &v36);
      printf("</td>");
      if ( v6 )
        v18 = "background-color:#F7F7F7;";
      else
        v18 = "";
      printf("<td width=92px style='vertical-align:bottom; %s'>%d</td>\n", v18, *(_DWORD *)(v1 + 20));
      sub_33F68(*(_QWORD *)(v1 + 32), &v32);
      if ( v2 <= 8 )
      {
        v21 = "<td width=109 style='vertical-align: bottom; %s'>%s</td>\n";
        if ( v6 )
          v19 = "background-color:#F7F7F7;";
        else
          v19 = "";
        v20 = &v32;
      }
      else
      {
        if ( v6 )
          v19 = "background-color:#F7F7F7;";
        else
          v19 = "";
        v20 = &v32;
        v21 = "<td width=94 style='vertical-align: bottom; %s'>%s</td>\n";
      }
      v22 = printf(v21, v19, v20);
      v23 = etr(v22);
      str(v23);
      if ( v6 )
        v24 = "background-color:#F7F7F7;";
      else
        v24 = "";
      printf("<td width=92 style='vertical-align:top; %s'>%d</td>\n", v24, *(_DWORD *)(v1 + 24));
      sub_33F68(*(_QWORD *)(v1 + 40), &v32);
      if ( v2 <= 8 )
      {
        v27 = "<td width=109 style='vertical-align:top; %s'>%s</td>\n";
        if ( v6 )
          v25 = "background-color:#F7F7F7;";
        else
          v25 = "";
        v26 = &v32;
      }
      else
      {
        if ( v6 )
          v25 = "background-color:#F7F7F7;";
        else
          v25 = "";
        v26 = &v32;
        v27 = "<td width=94 style='vertical-align:top; %s'>%s</td>\n";
      }
      v28 = printf(v27, v25, v26);
      etr(v28);
      v1 = *(_DWORD *)(v1 + 52);
      ++v30;
      if ( !v1 )
      {
        while ( v30 <= 7 )
        {
          printf("<tr><td colspan=5 style='height: 42px; %s'></td></tr>");
          ++v30;
        }
        break;
      }
    }
  }
  printf("</table>");
  printf("<script>");
  printf("parent.document.getElementById('conninfo_info_table').outerHTML = document.getElementById('conninfo_info_table').outerHTML;");
  printf("setTimeout(function() { location.reload(); }, 3000);");
  printf("</script>");
  return printf("</body>");
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F368: using guessed type int __fastcall dhcpd_get_dynamic_lease(_DWORD, _DWORD);
// F4B8: using guessed type int __fastcall convert_euckr_to_utf8(_DWORD, _DWORD);
// F8CC: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);
// F920: using guessed type int __fastcall get_twinip_wan_virtual_ip(_DWORD);

//----- (00035598) --------------------------------------------------------
int sub_35598()
{
  sub_133E4((int)"trafficconf", (int)"conninfo");
  printf("<style>");
  printf("body { margin: 0; }");
  printf("table { border: 0; }");
  printf("#conninfo_info_table >tbody >tr >td { background-color:#FFF; }");
  printf("#conninfo_info_table >tbody >tr >td { background-color: inehrit; }");
  printf("</style>");
  printf("<body>");
  printf("<table id=conninfo_info_table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=100%% style='background-color:#EEE;'>");
  printf("</table>");
  printf("<iframe name=\"trafficconf_conninfo_info_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_conninfo_info_status\" frameborder=no style='display:none;'></iframe>");
  printf("<iframe name=\"trafficconf_conninfo_info_submit\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_conninfo_info_submit\" frameborder=no style='display:none;'></iframe>");
  return printf("</body>");
}

//----- (00035644) --------------------------------------------------------
int sub_35644()
{
  printf("<style>");
  printf("tr { height: 25px; }");
  printf("body { margin: 0; }");
  printf("form { margin: 0; }");
  printf("</style>");
  puts("<form method=post action=timepro.cgi name=conntimeout_fm>");
  printf("<table id='trafficconf_connctrl_timeout_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  printf("</table>");
  printf("</form>");
  return printf("<iframe name=\"trafficconf_connctrl_timeout_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_connctrl_timeout_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (000356C4) --------------------------------------------------------
int sub_356C4()
{
  printf("<style>");
  printf("tr { height: 25px; }");
  printf("body { margin: 0; }");
  printf("form { margin: 0; }");
  printf("</style>");
  puts("<form method=post action=timepro.cgi name=connctrl_fm>");
  printf("<table id='trafficconf_connctrl_connctrl_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  printf("</table>");
  printf("</form>");
  return printf("<iframe name=\"trafficconf_connctrl_connctrl_status\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_connctrl_connctrl_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (00035744) --------------------------------------------------------
int sub_35744()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r0@1

  printf("<tr style='background-color:#E3E3E3;'><td style='border-width: 1px 0 1px 0; border-color: #CCC; border-style: solid; padding-left: 5px;'>");
  v1 = sub_134F4(101, v0);
  printf("<b>%s</b>", v1);
  printf("</td></tr>");
  printf("<tr><td>");
  printf("<iframe name=\"trafficconf_connctrl_timeout\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_connctrl_timeout\" frameborder=no style='width:100%%; height:150px;'></iframe>");
  printf("</td></tr>");
  printf("<tr style='background-color:#EEE; height: 32px;'>");
  printf("<td align=left colspan=4 style='padding-left: 5px; border-width: 1px 0 1px 0; border-style: solid; border-color: #CCC;'>");
  v3 = sub_134F4(884, v2);
  printf("<input type=button name=default_bt value=\"%s\" onclick=\"DefaultConnTimeout();\">", v3);
  print_nbsp(3);
  v5 = sub_134F4(28, v4);
  printf("<input type=button name=apply_bt value=\"%s\" onclick=\"ApplyConnTimeout();\">", v5);
  v6 = printf("</td>");
  return etr(v6);
}
// F32C: using guessed type int __fastcall etr(_DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);

//----- (00035800) --------------------------------------------------------
int sub_35800()
{
  int v0; // r1@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r0@1
  _UNKNOWN *v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r1@1
  int v9; // r0@1
  int v10; // r0@1

  printf("<tr><td>");
  printf("<iframe name=\"trafficconf_connctrl_connctrl\" src=\"timepro.cgi?tmenu=iframe&smenu=trafficconf_connctrl_connctrl\" frameborder=no style='width:100%%; height:100px;'></iframe>");
  printf("</td></tr>");
  printf("<tr style='background-color:#EEE; height: 32px;'>");
  printf("<td align=left colspan=4 style='background-color: #EEE; padding-left: 5px; border-width: 1px 0 1px 0; border-style: solid; border-color: #CCC;'>");
  v1 = sub_134F4(884, v0);
  printf("<input type=button name=default_bt value=\"%s\" onclick=\"DefaultConnCtrl();\">", v1);
  print_nbsp(3);
  v3 = sub_134F4(28, v2);
  printf("<input type=button name=apply_bt value=\"%s\" onclick=\"ApplyConnCtrl();\">", v3);
  v4 = printf("</td>");
  etr(v4);
  printf("<tr style='background-color:#F7F7F7'>");
  printf("<td align=left colspan=4 style='background-color:#EEE; padding: 5px;'>");
  v5 = sub_126C4();
  printf("<img src='/%s/warning.gif' style='width:14px; height: 14px; vertical-align:bottom;'>", v5);
  printf("<span class=gray_text>");
  v7 = sub_134F4(98, v6);
  printf((const char *)v7);
  printf("</span>");
  printf("<span class=gray_text style='display:block;'>");
  v9 = sub_134F4(99, v8);
  printf((const char *)v9);
  printf("</span>");
  v10 = printf("</td>");
  return etr(v10);
}
// F32C: using guessed type int __fastcall etr(_DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);

//----- (00035910) --------------------------------------------------------
signed int sub_35910()
{
  signed int result; // r0@1
  int v1; // r0@2
  int v2; // r1@2
  int v3; // r4@2
  _UNKNOWN *v4; // r0@2

  result = sub_12380();
  if ( !result )
  {
    sub_133E4((int)"trafficconf", (int)"connctrl");
    printf("<style>");
    printf("tr { height: 25px; }");
    printf("</style>");
    puts("<table id='trafficconf_connctrl_main_table' cellpadding=0px cellspacing=0px width=641px>");
    sub_35800();
    v1 = sub_35744();
    print_end_main_table(v1);
    v3 = sub_134F4(27, v2);
    printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
    puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
    printf("</DIV>");
    puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
    puts("<table width=\"180\" height=\"70\">");
    printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
    puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
    v4 = sub_126C4();
    printf(
      "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
      v4);
    printf("</SPAN></td>");
    printf(
      "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\">%s\n",
      v3);
    printf("</SPAN></td>");
    result = printf((const char *)&unk_60F0E);
  }
  return result;
}
// F5F0: using guessed type int __fastcall print_end_main_table(_DWORD);

//----- (00035A2C) --------------------------------------------------------
int __fastcall sub_35A2C(int a1)
{
  int v1; // r4@1

  v1 = a1;
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_syn_sent", *(_DWORD *)(a1 + 16));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_syn_recv", *(_DWORD *)(v1 + 20));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_established", *(_DWORD *)(v1 + 24));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_fin_wait", *(_DWORD *)(v1 + 28));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_close_wait", *(_DWORD *)(v1 + 32));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_last_ack", *(_DWORD *)(v1 + 36));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_time_wait", *(_DWORD *)(v1 + 40));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_close", *(_DWORD *)(v1 + 44));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_udp_timeout", *(_DWORD *)(v1 + 48));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_udp_timeout_stream", *(_DWORD *)(v1 + 52));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_icmp_timeout", *(_DWORD *)(v1 + 56));
  write_file_intval("/proc/sys/net/ipv4/netfilter/ip_conntrack_generic_timeout", *(_DWORD *)(v1 + 60));
  iconfig_set_intvalue_direct("tcp_timeout_syn_sent", *(_DWORD *)(v1 + 16));
  iconfig_set_intvalue_direct("tcp_timeout_syn_recv", *(_DWORD *)(v1 + 20));
  iconfig_set_intvalue_direct("tcp_timeout_eastablished", *(_DWORD *)(v1 + 24));
  iconfig_set_intvalue_direct("tcp_timeout_fin_wait", *(_DWORD *)(v1 + 28));
  iconfig_set_intvalue_direct("tcp_timeout_close_wait", *(_DWORD *)(v1 + 32));
  iconfig_set_intvalue_direct("tcp_timeout_last_ack", *(_DWORD *)(v1 + 36));
  iconfig_set_intvalue_direct("tcp_timeout_time_wait", *(_DWORD *)(v1 + 40));
  iconfig_set_intvalue_direct("tcp_timeout_close", *(_DWORD *)(v1 + 44));
  iconfig_set_intvalue_direct("udp_timeout", *(_DWORD *)(v1 + 48));
  iconfig_set_intvalue_direct("udp_timeout_stream", *(_DWORD *)(v1 + 52));
  iconfig_set_intvalue_direct("icmp_timeout", *(_DWORD *)(v1 + 56));
  iconfig_set_intvalue_direct("generic_timeout", *(_DWORD *)(v1 + 60));
  return 0;
}
// FAC4: using guessed type int __fastcall iconfig_set_intvalue_direct(_DWORD, _DWORD);
// FE24: using guessed type int __fastcall write_file_intval(_DWORD, _DWORD);

//----- (00035BBC) --------------------------------------------------------
int __fastcall sub_35BBC(int a1)
{
  int v1; // r5@1
  int v2; // r0@3
  int v4; // [sp+0h] [bp-90h]@3
  char v5; // [sp+10h] [bp-80h]@3
  char v6; // [sp+14h] [bp-7Ch]@3
  char v7; // [sp+18h] [bp-78h]@3
  char v8; // [sp+1Ch] [bp-74h]@3
  char v9; // [sp+20h] [bp-70h]@3
  char v10; // [sp+24h] [bp-6Ch]@3
  char v11; // [sp+28h] [bp-68h]@3
  char v12; // [sp+2Ch] [bp-64h]@3
  char v13; // [sp+30h] [bp-60h]@3
  char v14; // [sp+34h] [bp-5Ch]@3
  char v15; // [sp+38h] [bp-58h]@3
  char v16; // [sp+3Ch] [bp-54h]@3
  char v17; // [sp+40h] [bp-50h]@1

  v1 = a1;
  if ( get_value_post(a1, "act", &v17, 64) && !strcmp(&v17, "apply_timeout") )
  {
    get_intvalue_post(v1, "tcp_timeout_syn_sent", &v5);
    get_intvalue_post(v1, "tcp_timeout_syn_recv", &v6);
    get_intvalue_post(v1, "tcp_timeout_eastablished", &v7);
    get_intvalue_post(v1, "tcp_timeout_fin_wait", &v8);
    get_intvalue_post(v1, "tcp_timeout_close_wait", &v9);
    get_intvalue_post(v1, "tcp_timeout_last_ack", &v10);
    get_intvalue_post(v1, "tcp_timeout_time_wait", &v11);
    get_intvalue_post(v1, "tcp_timeout_close_value", &v12);
    get_intvalue_post(v1, "udp_timeout", &v13);
    get_intvalue_post(v1, "udp_timeout_stream", &v14);
    get_intvalue_post(v1, "icmp_timeout", &v15);
    get_intvalue_post(v1, "generic_timeout", &v16);
    v2 = sub_35A2C((int)&v4);
    signal_save(v2);
  }
  return 0;
}
// E8A0: using guessed type int __fastcall get_intvalue_post(_DWORD, _DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00035D0C) --------------------------------------------------------
int __fastcall sub_35D0C(int a1)
{
  int v1; // r4@1

  v1 = a1;
  write_file_intval("/proc/sys/net/nf_conntrack_max", *(_DWORD *)a1);
  write_file_intval("/proc/sys/net/netfilter/udp_conntrack_max", *(_DWORD *)(v1 + 4));
  write_file_intval("/proc/sys/net/netfilter/icmp_conntrack_max", *(_DWORD *)(v1 + 8));
  write_file_intval("/proc/sys/net/netfilter/max_rate_per_ip", *(_DWORD *)(v1 + 12));
  iconfig_set_intvalue_direct("ip_conntrack_max", *(_DWORD *)v1);
  iconfig_set_intvalue_direct("udp_conntrack_max", *(_DWORD *)(v1 + 4));
  iconfig_set_intvalue_direct("icmp_conntrack_max", *(_DWORD *)(v1 + 8));
  iconfig_set_intvalue_direct("max_rate_per_ip", *(_DWORD *)(v1 + 12));
  return 0;
}
// FAC4: using guessed type int __fastcall iconfig_set_intvalue_direct(_DWORD, _DWORD);
// FE24: using guessed type int __fastcall write_file_intval(_DWORD, _DWORD);

//----- (00035D9C) --------------------------------------------------------
int __fastcall sub_35D9C(int a1)
{
  int v1; // r5@1
  int v2; // r0@3
  int v4; // [sp+0h] [bp-90h]@3
  char v5; // [sp+4h] [bp-8Ch]@3
  char v6; // [sp+8h] [bp-88h]@3
  char v7; // [sp+Ch] [bp-84h]@3
  char v8; // [sp+40h] [bp-50h]@1

  v1 = a1;
  if ( get_value_post(a1, "act", &v8, 64) && !strcmp(&v8, "apply") )
  {
    get_intvalue_post(v1, "all", &v4);
    get_intvalue_post(v1, "udp_max", &v5);
    get_intvalue_post(v1, "icmp_max", &v6);
    get_intvalue_post(v1, "rate_per_ip", &v7);
    v2 = sub_35D0C((int)&v4);
    signal_save(v2);
  }
  return 0;
}
// E8A0: using guessed type int __fastcall get_intvalue_post(_DWORD, _DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00035E4C) --------------------------------------------------------
int __fastcall sub_35E4C(int a1)
{
  int v1; // r4@1

  v1 = a1;
  *(_DWORD *)(a1 + 16) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_syn_sent", 1);
  *(_DWORD *)(v1 + 20) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_syn_recv", 1);
  *(_DWORD *)(v1 + 24) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_established", 1);
  *(_DWORD *)(v1 + 28) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_fin_wait", 1);
  *(_DWORD *)(v1 + 32) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_close_wait", 1);
  *(_DWORD *)(v1 + 36) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_last_ack", 1);
  *(_DWORD *)(v1 + 40) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_time_wait", 1);
  *(_DWORD *)(v1 + 44) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_close", 1);
  *(_DWORD *)(v1 + 48) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_udp_timeout", 1);
  *(_DWORD *)(v1 + 52) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_udp_timeout_stream", 1);
  *(_DWORD *)(v1 + 56) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_icmp_timeout", 1);
  *(_DWORD *)(v1 + 60) = get_file_value("/proc/sys/net/ipv4/netfilter/ip_conntrack_generic_timeout", 1);
  return 0;
}
// EEF4: using guessed type int __fastcall get_file_value(_DWORD, _DWORD);

//----- (00035F4C) --------------------------------------------------------
int __fastcall sub_35F4C(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r4@1
  int v6; // r1@1
  int v7; // r0@1
  int v8; // r0@1
  int v9; // r4@1
  int v10; // r1@1
  int v11; // r0@1
  int v12; // r4@1
  int v13; // r1@1
  int v14; // r0@1
  int v15; // r0@1
  int v16; // r4@1
  int v17; // r1@1
  int v18; // r0@1
  int v19; // r4@1
  int v20; // r1@1
  int v21; // r0@1
  int v22; // r0@1
  int v23; // r4@1
  int v24; // r1@1
  int v25; // r0@1
  int v26; // r4@1
  int v27; // r1@1
  int v28; // r0@1
  int v29; // r0@1
  int v30; // r4@1
  int v31; // r1@1
  int v32; // r0@1
  int v33; // r4@1
  int v34; // r1@1
  int v35; // r0@1
  int v36; // r0@1
  int v37; // r4@1
  int v38; // r1@1
  int v39; // r0@1
  int v40; // r4@1
  int v41; // r1@1
  int v42; // r0@1
  int v43; // r0@1
  int v45; // [sp+0h] [bp-A8h]@1
  int v46; // [sp+10h] [bp-98h]@1
  int v47; // [sp+14h] [bp-94h]@1
  int v48; // [sp+18h] [bp-90h]@1
  int v49; // [sp+1Ch] [bp-8Ch]@1
  int v50; // [sp+20h] [bp-88h]@1
  int v51; // [sp+24h] [bp-84h]@1
  int v52; // [sp+28h] [bp-80h]@1
  int v53; // [sp+2Ch] [bp-7Ch]@1
  int v54; // [sp+30h] [bp-78h]@1
  int v55; // [sp+34h] [bp-74h]@1
  int v56; // [sp+38h] [bp-70h]@1
  int v57; // [sp+3Ch] [bp-6Ch]@1
  char v58; // [sp+40h] [bp-68h]@1
  int v59; // [sp+50h] [bp-58h]@1
  int v60; // [sp+54h] [bp-54h]@1
  int v61; // [sp+58h] [bp-50h]@1
  int v62; // [sp+5Ch] [bp-4Ch]@1
  int v63; // [sp+60h] [bp-48h]@1
  int v64; // [sp+64h] [bp-44h]@1
  int v65; // [sp+68h] [bp-40h]@1
  int v66; // [sp+6Ch] [bp-3Ch]@1
  int v67; // [sp+70h] [bp-38h]@1
  int v68; // [sp+74h] [bp-34h]@1
  int v69; // [sp+78h] [bp-30h]@1
  int v70; // [sp+7Ch] [bp-2Ch]@1

  sub_35BBC(a2);
  sub_35E4C((int)&v58);
  hwinfo_get_conntrack_default(&v45);
  puts("<form method=post action=timepro.cgi name=conntimeout_fm>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=trafficconf_connctrl_timeout_status>");
  puts("<input type=hidden name=act value=>");
  printf("<input type=hidden name=default_tcp_timeout_syn_sent value=%d>\n", v46);
  printf("<input type=hidden name=default_tcp_timeout_syn_recv value=%d>\n", v47);
  printf("<input type=hidden name=default_tcp_timeout_eastablished value=%d>\n", v48);
  printf("<input type=hidden name=default_tcp_timeout_fin_wait value=%d>\n", v49);
  printf("<input type=hidden name=default_tcp_timeout_close_wait value=%d>\n", v50);
  printf("<input type=hidden name=default_tcp_timeout_last_ack value=%d>\n", v51);
  printf("<input type=hidden name=default_tcp_timeout_time_wait value=%d>\n", v52);
  printf("<input type=hidden name=default_tcp_timeout_close_value value=%d>\n", v53);
  printf("<input type=hidden name=default_udp_timeout value=%d>\n", v54);
  printf("<input type=hidden name=default_udp_timeout_stream value=%d>\n", v55);
  printf("<input type=hidden name=default_icmp_timeout value=%d>\n", v56);
  printf("<input type=hidden name=default_generic_timeout value=%d>\n", v57);
  printf("<table id='trafficconf_connctrl_timeout_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  printf("<tr %s>", "");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "TCP SYN SENT TIMEOUT");
  printf("<td >");
  v2 = v59;
  v4 = sub_134F4(878, v3);
  printf("<input type=number name=tcp_timeout_syn_sent style='width:66px;' min=0 value=%d> %s", v2, v4);
  printf("</td>");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "TCP SYN RECV TIMEOUT");
  printf("<td >");
  v5 = v60;
  v7 = sub_134F4(878, v6);
  printf("<input type=number name=tcp_timeout_syn_recv style='width:66px;' min=0 value=%d> %s", v5, v7);
  v8 = printf("</td>");
  etr(v8);
  printf("<tr %s>", "style='background-color:#F7F7F7'");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "TCP ESTABLISHED TIMEOUT");
  printf("<td >");
  v9 = v61;
  v11 = sub_134F4(878, v10);
  printf("<input type=number name=tcp_timeout_eastablished style='width:66px;' min=0 value=%d> %s", v9, v11);
  printf("</td>");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "TCP FIN WAIT TIMEOUT");
  printf("<td >");
  v12 = v62;
  v14 = sub_134F4(878, v13);
  printf("<input type=number name=tcp_timeout_fin_wait style='width:66px;' min=0 value=%d> %s", v12, v14);
  v15 = printf("</td>");
  etr(v15);
  printf("<tr %s>", "");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "TCP CLOSE WAIT TIMEOUT");
  printf("<td >");
  v16 = v63;
  v18 = sub_134F4(878, v17);
  printf("<input type=number name=tcp_timeout_close_wait style='width:66px;' min=0 value=%d> %s", v16, v18);
  printf("</td>");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "TCP LAST ACK TIMEOUT");
  printf("<td >");
  v19 = v64;
  v21 = sub_134F4(878, v20);
  printf("<input type=number name=tcp_timeout_last_ack style='width:66px;' min=0 value=%d> %s", v19, v21);
  v22 = printf("</td>");
  etr(v22);
  printf("<tr %s>", "style='background-color:#F7F7F7'");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "TCP TIME WAIT TIMEOUT");
  printf("<td >");
  v23 = v65;
  v25 = sub_134F4(878, v24);
  printf("<input type=number name=tcp_timeout_time_wait style='width:66px;' min=0 value=%d> %s", v23, v25);
  printf("</td>");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "TCP CLOSE TIMEOUT");
  printf("<td >");
  v26 = v66;
  v28 = sub_134F4(878, v27);
  printf("<input type=number name=tcp_timeout_close_value style='width:66px;' min=0 value=%d> %s", v26, v28);
  v29 = printf("</td>");
  etr(v29);
  printf("<tr %s>", "");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "UDP TIMEOUT");
  printf("<td >");
  v30 = v67;
  v32 = sub_134F4(878, v31);
  printf("<input type=number name=udp_timeout style='width:66px;' min=0 value=%d> %s", v30, v32);
  printf("</td>");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "UDP STREAM TIMEOUT");
  printf("<td >");
  v33 = v68;
  v35 = sub_134F4(878, v34);
  printf("<input type=number name=udp_timeout_stream style='width:66px;' min=0 value=%d> %s", v33, v35);
  v36 = printf("</td>");
  etr(v36);
  printf("<tr %s>", "style='background-color:#F7F7F7'");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "ICMP TIMEOUT");
  printf("<td >");
  v37 = v69;
  v39 = sub_134F4(878, v38);
  printf("<input type=number name=icmp_timeout style='width:66px;' min=0 value=%d> %s", v37, v39);
  printf("</td>");
  printf("<td style='width:%dpx; padding-left: 5px;'>%s</td>", 180, "GENERIC TIMEOUT");
  printf("<td >");
  v40 = v70;
  v42 = sub_134F4(878, v41);
  printf("<input type=number name=generic_timeout style='width:66px;' min=0 value=%d> %s", v40, v42);
  v43 = printf("</td>");
  etr(v43);
  printf("</table>");
  printf("</form>");
  printf("<script>");
  printf("parent.document.getElementById('trafficconf_connctrl_timeout_table').outerHTML = document.getElementById('trafficconf_connctrl_timeout_table').outerHTML;");
  printf("setTimeout(function() {UnMaskIt(parent.parent.document, 'apply_mask');}, 500);");
  return printf("</script>");
}
// F32C: using guessed type int __fastcall etr(_DWORD);
// F824: using guessed type int __fastcall hwinfo_get_conntrack_default(_DWORD);

//----- (00036480) --------------------------------------------------------
int __fastcall sub_36480(int a1)
{
  int v1; // r4@1

  v1 = a1;
  *(_DWORD *)a1 = get_file_value("/proc/sys/net/nf_conntrack_max", 1);
  *(_DWORD *)(v1 + 4) = get_file_value("/proc/sys/net/netfilter/udp_conntrack_max", 1);
  *(_DWORD *)(v1 + 8) = get_file_value("/proc/sys/net/netfilter/icmp_conntrack_max", 1);
  *(_DWORD *)(v1 + 12) = get_file_value("/proc/sys/net/netfilter/max_rate_per_ip", 1);
  return 0;
}
// EEF4: using guessed type int __fastcall get_file_value(_DWORD, _DWORD);

//----- (000364E0) --------------------------------------------------------
int __fastcall sub_364E0(int a1, int a2)
{
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r4@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r1@1
  int v8; // r0@1
  int v9; // r0@1
  int v10; // r1@1
  int v11; // r0@1
  int v12; // r4@1
  int v13; // r1@1
  int v14; // r0@1
  int v15; // r1@1
  int v16; // r4@1
  int v17; // r1@1
  int v18; // r0@1
  int v19; // r0@1
  int v20; // r1@1
  int v21; // r0@1
  int v22; // r4@1
  int v23; // r1@1
  int v24; // r0@1
  int v25; // r1@1
  int v26; // r4@1
  int v27; // r1@1
  int v28; // r0@1
  int v29; // r0@1
  int v30; // r1@1
  int v31; // r0@1
  int v32; // r1@1
  int v33; // r0@1
  int v34; // r0@1
  int v36; // [sp+0h] [bp-A0h]@1
  int v37; // [sp+4h] [bp-9Ch]@1
  int v38; // [sp+8h] [bp-98h]@1
  int v39; // [sp+Ch] [bp-94h]@1
  int v40; // [sp+40h] [bp-60h]@1
  int v41; // [sp+44h] [bp-5Ch]@1
  int v42; // [sp+48h] [bp-58h]@1
  int v43; // [sp+4Ch] [bp-54h]@1

  sub_35D9C(a2);
  sub_36480((int)&v40);
  hwinfo_get_conntrack_default(&v36);
  puts("<form method=post action=timepro.cgi name=connctrl_fm>");
  puts("<input type=hidden name=tmenu value=iframe>");
  puts("<input type=hidden name=smenu value=trafficconf_connctrl_connctrl_status>");
  puts("<input type=hidden name=act value=>");
  printf("<input type=hidden name=default_all value=%d>\n", v36);
  printf("<input type=hidden name=default_udp_max value=%d>\n", v37);
  printf("<input type=hidden name=default_icmp_max value=%d>\n", v38);
  printf("<input type=hidden name=default_rate_per_ip value=%d>\n", v39);
  printf("<table id='trafficconf_connctrl_connctrl_table' cellpadding=0px cellspacing=0px width=100%%>\n");
  printf("<tr %s>", "");
  v3 = sub_134F4(93, v2);
  printf("<td style='padding-left: 5px; width: 180px;'>%s</td>", v3);
  printf("<td colspan=3>");
  v4 = v40;
  v6 = sub_134F4(97, v5);
  printf("<input type=number name=all style='width:66px;' min=0 value=%d> %s", v4, v6);
  print_nbsp(1);
  v8 = sub_134F4(95, v7);
  printf("( 0 : %s, 512 ~ )", v8);
  v9 = printf("</td>");
  etr(v9);
  printf("<tr %s>", "style='background-color:#F7F7F7'");
  v11 = sub_134F4(96, v10);
  printf("<td style='padding-left: 5px; width: 180px;'>%s</td>", v11);
  printf("<td colspan=3>");
  v12 = v41;
  v14 = sub_134F4(97, v13);
  printf("<input type=number name=udp_max style='width:66px;' min=0 value=%d> %s", v12, v14);
  print_nbsp(1);
  v16 = sub_134F4(95, v15);
  v18 = sub_134F4(93, v17);
  printf("( 0 : %s ,10 ~ %s )", v16, v18);
  v19 = printf("</td>");
  etr(v19);
  printf("<tr %s>", "");
  v21 = sub_134F4(92, v20);
  printf("<td style='padding-left: 5px; width: 180px;'>%s</td>", v21);
  printf("<td colspan=3>");
  v22 = v42;
  v24 = sub_134F4(97, v23);
  printf("<input type=number name=icmp_max style='width:66px;' min=0 value=%d> %s", v22, v24);
  print_nbsp(1);
  v26 = sub_134F4(95, v25);
  v28 = sub_134F4(93, v27);
  printf("( 0 : %s ,1 ~ %s )", v26, v28);
  v29 = printf("</td>");
  etr(v29);
  printf("<tr %s>", "style='background-color:#F7F7F7'");
  v31 = sub_134F4(94, v30);
  printf("<td style='padding-left: 5px; width: 180px;'>%s</td>", v31);
  printf("<td colspan=3>");
  printf("<input type=number name=rate_per_ip style='width:66px;' min=0 value=%d> %%", v43);
  print_nbsp(1);
  v33 = sub_134F4(95, v32);
  printf("( 0 : %s ,1 ~ 100 )", v33);
  v34 = printf("</td>");
  etr(v34);
  printf("</table>");
  printf("</form>");
  printf("<script>");
  printf("parent.document.getElementById('trafficconf_connctrl_connctrl_table').outerHTML = document.getElementById('trafficconf_connctrl_connctrl_table').outerHTML;");
  printf("setTimeout(function() {UnMaskIt(parent.parent.document, 'apply_mask');}, 500);");
  return printf("</script>");
}
// F32C: using guessed type int __fastcall etr(_DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// F824: using guessed type int __fastcall hwinfo_get_conntrack_default(_DWORD);

//----- (000367DC) --------------------------------------------------------
int __fastcall sub_367DC(signed int a1)
{
  signed int v1; // r10@1
  int v2; // r5@1
  char *v3; // r1@2
  const char *v4; // r0@5
  int v5; // r3@7
  int v6; // r1@10
  int v7; // r0@10
  int v8; // r0@10
  int v9; // r1@11
  char *v10; // r5@11
  char *v11; // r4@12
  int v12; // r0@14
  int v13; // r1@14
  char *v14; // r4@15
  int v15; // r0@17
  char *v16; // r1@18
  char *v17; // r1@21
  char *v18; // r1@24
  char *v19; // r1@27
  int v20; // r1@31
  int v21; // r0@31
  int v23; // [sp+0h] [bp-408h]@1
  int v24; // [sp+274h] [bp-194h]@1
  char v25; // [sp+3ACh] [bp-5Ch]@7
  __int16 v26; // [sp+3B6h] [bp-52h]@7
  int v27; // [sp+3C0h] [bp-48h]@7
  __int16 v28; // [sp+3CAh] [bp-3Eh]@7
  int v29; // [sp+3D4h] [bp-34h]@17
  __int16 v30; // [sp+3DEh] [bp-2Ah]@26

  v1 = a1;
  get_si("hw", &v23);
  ++dword_986D8;
  v2 = v24;
  printf("<tr class='list' style='background-color: #%s'>");
  if ( v1 < 0x10000 )
    v3 = (char *)v1;
  else
    v3 = "WAN";
  if ( v1 < 0x10000 )
    v4 = "<td style='width: 55px;'>%d</td>";
  else
    v4 = "<td style='width: 55px;'>%s</td>";
  printf(v4, v3);
  get_link_status(v1, &v25);
  read_portconfig(v1, &v28);
  puts("<td width=20>");
  printf("%s", &v25);
  printf("</td>");
  puts("<td width=15>");
  printf("%s", &v26);
  printf("</td>");
  puts("<td width=20>");
  printf("%s", &v27);
  printf("</td>");
  v5 = v1 == v2;
  if ( v2 == 1 )
    v5 = 0;
  if ( v5 )
  {
    puts("<td colspan=4>");
    v7 = sub_134F4(670, v6);
    v8 = printf("%s</td>\n", v7);
  }
  else
  {
    puts("<td>");
    printf("<select name=mode%d  style='height: 20px;' onchange=\"SelectLinkMode(%d);\">\n", v1, v1);
    v10 = "selected";
    if ( !strcmp((const char *)&v28, "auto") )
      v11 = "selected";
    else
      v11 = "";
    v12 = sub_134F4(669, v9);
    printf("<option value=auto %s>%s", v11, v12);
    if ( !strcmp((const char *)&v28, "forced") )
      v14 = "selected";
    else
      v14 = "";
    v15 = sub_134F4(675, v13);
    printf("<option value=forced %s>%s</option>", v14, v15);
    printf("</select>");
    printf("</td>");
    puts("<td>");
    printf("<select name=speed%d style='height: 20px;' onchange=\"SelectLinkMode(%d);\">\n", v1, v1);
    if ( !strcmp((const char *)&v29, "1000") )
      v16 = "selected";
    else
      v16 = "";
    printf("<option value=1000 %s>1Gbps</option>\n", v16);
    if ( !strcmp((const char *)&v29, "100") )
      v17 = "selected";
    else
      v17 = "";
    printf("<option value=100 %s>100Mbps</option>\n", v17);
    if ( !strcmp((const char *)&v29, "10") )
      v18 = "selected";
    else
      v18 = "";
    printf("<option value=10 %s>10Mbps</option>\n", v18);
    printf("</select>");
    printf("</td>");
    puts("<td>");
    printf("<select name=duplex%d style='height: 20px;'>\n", v1);
    if ( !strcmp((const char *)&v30, "full") )
      v19 = "selected";
    else
      v19 = "";
    printf("<option value=full %s>FULL</option>\n", v19);
    if ( strcmp((const char *)&v30, "half") )
      v10 = "";
    printf("<option value=half %s>HALF</option>\n", v10);
    printf("</select>");
    printf("</td>");
    puts("<td>");
    v21 = sub_134F4(28, v20);
    v8 = printf(
           "<input class=navi_bt type=button name=\"port%d_bt\" value=\"%s\" onclick=\"ApplyLinkSetup(%d);\"\"></td>\n",
           v1,
           v21,
           v1);
  }
  return etr(v8);
}
// E774: using guessed type int __fastcall get_link_status(_DWORD, _DWORD);
// E7D4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F4E8: using guessed type int __fastcall read_portconfig(_DWORD, _DWORD);
// 986D8: using guessed type int dword_986D8;

//----- (00036B3C) --------------------------------------------------------
int __fastcall sub_36B3C(int a1)
{
  int v1; // r7@1
  unsigned int v2; // r0@3
  int v3; // r5@4
  int v4; // r3@13
  const char *v5; // r1@13
  int v6; // r2@13
  int v7; // r5@17
  int v8; // r1@17
  int v9; // r0@17
  signed int v10; // r4@17
  int v11; // r1@17
  int v12; // r0@17
  int v13; // r1@17
  int v14; // r0@17
  int v15; // r1@17
  int v16; // r0@17
  int v17; // r1@17
  int v18; // r0@17
  int v19; // r0@17
  bool v20; // nf@19
  unsigned __int8 v21; // vf@19
  int v22; // r0@20
  int v23; // r4@20
  int v25; // [sp+8h] [bp-7D0h]@12
  int v26; // [sp+27Ch] [bp-55Ch]@12
  int v27; // [sp+3B4h] [bp-424h]@17
  int v28; // [sp+628h] [bp-1B0h]@17
  __int16 v29; // [sp+762h] [bp-76h]@4
  __int16 v30; // [sp+782h] [bp-56h]@1
  __int16 v31; // [sp+7A2h] [bp-36h]@4
  int v32; // [sp+7ACh] [bp-2Ch]@7
  __int16 v33; // [sp+7B6h] [bp-22h]@9

  v1 = a1;
  if ( get_value(a1, "act", &v30, 32) && !strcmp((const char *)&v30, "setport") )
  {
    v2 = get_value(v1, "port", &v30, 32);
    if ( v2 )
    {
      v3 = atoi((const char *)&v30);
      read_portconfig(v3, &v31);
      sprintf((char *)&v29, "mode%d", v3);
      if ( get_value(v1, &v29, &v30, 32) )
        sf_strncpy(&v31, &v30, 10);
      sprintf((char *)&v29, "speed%d", v3);
      if ( get_value(v1, &v29, &v30, 32) )
        sf_strncpy(&v32, &v30, 10);
      if ( !strcmp((const char *)&v32, "1000") )
      {
        strcpy((char *)&v33, "full");
      }
      else
      {
        sprintf((char *)&v29, "duplex%d", v3);
        if ( get_value(v1, &v29, &v30, 32) )
          sf_strncpy(&v33, &v30, 10);
      }
      set_port_config(v3, &v31);
      write_portconfig(v3, &v31);
      get_si("hw", &v25);
      if ( v3 > v26 )
      {
        v4 = v3 - 0x10000;
        v5 = "%s: WAN%d(%s,%s)";
        v6 = (int)"@{38}";
      }
      else
      {
        v4 = v3;
        v5 = "%s: LAN %d(%s,%s)";
        v6 = (int)"@{38}";
      }
      syslog_msg(1, v5, v6, v4, &v32, &v33);
      v2 = sleep(2u);
    }
    signal_save(v2);
  }
  get_si("hw", &v27);
  v7 = v28;
  puts("<form method=get action=timepro.cgi name=linksetup_fm>");
  puts("<input type=hidden name=tmenu value=trafficconf>");
  puts("<input type=hidden name=smenu value=linksetup>");
  puts("<input type=hidden name=act value=>");
  puts("<input type=hidden name=port value=>");
  puts("<tr><td>");
  printf("<table class='list_table' cellspacing=0px cellpadding=0px style='width: 100%%;'>\n");
  printf("<tr class='title'>");
  v9 = sub_134F4(788, v8);
  v10 = 0;
  printf("<td style='width: 55px;'>%s</td>", v9);
  v12 = sub_134F4(673, v11);
  printf("<td colspan=3>%s</td>", v12);
  v14 = sub_134F4(897, v13);
  printf("<td>%s</td>", v14);
  v16 = sub_134F4(686, v15);
  printf("<td>%s</td>", v16);
  v18 = sub_134F4(672, v17);
  printf("<td>%s</td>", v18);
  v19 = printf("<td></td>");
  etr(v19);
  sub_367DC(65537);
  while ( 1 )
  {
    v21 = __OFSUB__(v10, v7);
    v20 = v10++ - v7 < 0;
    if ( !(v20 ^ v21) )
      break;
    sub_367DC(v10);
  }
  printf("<tr style='height: 1px;'>");
  printf("<td colspan=8 style='border-top: 1px solid #CCC;'></td>");
  v22 = printf("</tr>");
  print_end_content_table(v22);
  puts("</form>");
  puts("<script>");
  v23 = 0;
  while ( 1 )
  {
    v21 = __OFSUB__(v23, v7);
    v20 = v23++ - v7 < 0;
    if ( !(v20 ^ v21) )
      break;
    printf("SelectLinkMode(%d);\n");
  }
  printf("SelectLinkMode(%d);\n", 65537);
  return puts("</script>");
}
// E7D4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// ED2C: using guessed type int __fastcall set_port_config(_DWORD, _DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F470: using guessed type int syslog_msg(_DWORD, const char *, ...);
// F4E8: using guessed type int __fastcall read_portconfig(_DWORD, _DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// F848: using guessed type int __fastcall write_portconfig(_DWORD, _DWORD);
// FBA8: using guessed type int __fastcall print_end_content_table(_DWORD);

//----- (00036F0C) --------------------------------------------------------
int __fastcall sub_36F0C(int a1)
{
  int v1; // r4@1
  int v2; // r0@1

  v1 = a1;
  printf("<style>");
  printf(".list_table td { padding: 0 5px; }");
  printf("tr.title td { padding: 5px; border-bottom: 1px solid #CCC; }");
  printf("tr.list { height: 23px; }");
  printf("</style>");
  print_file("/home/httpd/js/trafficconf_linksetup_24ports.js");
  printf("<table cellpadding=0px cellspacing=0px style='width: 100%%;'>\n");
  v2 = sub_36B3C(v1);
  return print_end_main_table(v2);
}
// F5F0: using guessed type int __fastcall print_end_main_table(_DWORD);
// FE0C: using guessed type int __fastcall print_file(_DWORD);

//----- (00036F78) --------------------------------------------------------
__int64 __fastcall sub_36F78(int a1, int a2)
{
  __int64 v2; // r2@2

  switch ( a1 )
  {
    case 0:
      v2 = *(_QWORD *)(a2 + 8);
      break;
    default:
      v2 = 0LL;
      break;
    case 3:
      v2 = *(_QWORD *)a2;
      break;
    case 5:
      v2 = *(_QWORD *)(a2 + 16);
      break;
    case 6:
      v2 = *(_QWORD *)(a2 + 24);
      break;
    case 13:
      v2 = *(_QWORD *)(a2 + 80);
      break;
    case 14:
      v2 = *(_QWORD *)(a2 + 72);
      break;
    case 16:
      v2 = *(_QWORD *)(a2 + 96);
      break;
    case 17:
      v2 = *(_QWORD *)(a2 + 88);
      break;
    case 26:
      v2 = *(_QWORD *)(a2 + 40);
      break;
    case 27:
      v2 = *(_QWORD *)(a2 + 48);
      break;
  }
  return v2;
}

//----- (00037058) --------------------------------------------------------
int __fastcall sub_37058(int a1, int a2)
{
  int v3; // r0@3

  switch ( a1 )
  {
    case 0:
      v3 = 677;
      return sub_134F4(v3, a2);
    default:
      return (int)"";
    case 3:
      v3 = 683;
      break;
    case 5:
      v3 = 676;
      break;
    case 6:
      v3 = 682;
      break;
    case 13:
      v3 = 689;
      break;
    case 14:
      v3 = 692;
      break;
    case 16:
      v3 = 691;
      break;
    case 17:
      v3 = 688;
      break;
    case 26:
      v3 = 679;
      break;
    case 27:
      v3 = 678;
      break;
  }
  return sub_134F4(v3, a2);
}

//----- (0003714C) --------------------------------------------------------
int sub_3714C()
{
  int v0; // r6@1
  int v1; // r1@1
  int v2; // r0@1
  int v3; // r4@1
  int v4; // r1@1
  int v5; // r0@2
  int v6; // r1@5
  int v7; // r4@5
  int v8; // r0@6
  int v9; // r0@9
  signed int i; // r5@9
  int v11; // r1@10
  int v12; // r4@10
  int v13; // r0@11
  int v14; // r1@16
  int v15; // r0@16
  int v16; // r0@16
  int v17; // r0@16
  int v19; // [sp+4h] [bp-434h]@1
  int v20; // [sp+278h] [bp-1C0h]@1
  char s; // [sp+3B0h] [bp-88h]@5

  get_si("hw", &v19);
  v0 = v20;
  puts("<form method=get action=timepro.cgi name=linkstat_fm>");
  puts("<input type=hidden name=tmenu value=trafficconf>");
  puts("<input type=hidden name=smenu value=linkstat>");
  puts("<input type=hidden name=act value=>");
  puts("<tr><td>");
  printf("<table cellspacing=0px cellpadding=0px style='width: 100%%;'>\n");
  printf("<tr class='title'>");
  v2 = sub_134F4(788, v1);
  v3 = -1;
  printf("<td style='width: 25px; padding: 0 3px;'>%s</td>", v2);
  do
  {
    ++v3;
    v5 = sub_37058(v3, v4);
    if ( *(_BYTE *)v5 )
      v5 = printf("<td style='padding: 0 3px; font-size:9px'>%s</td>", v5);
  }
  while ( v3 != 29 );
  etr(v5);
  memset(&s, 0, 0x78u);
  get_eport_stat(65537, &s);
  printf("<tr class='list' style='background-color: #FFF;'>");
  printf("<td style='width: 25px; padding: 0 3px;'>%s</td>", "WAN");
  v7 = -1;
  do
  {
    ++v7;
    v8 = sub_37058(v7, v6);
    if ( *(_BYTE *)v8 )
    {
      sub_36F78(v7, (int)&s);
      v8 = printf("<td style='padding: 0 3px; font-size:9px'>%llu</td>");
    }
  }
  while ( v7 != 29 );
  v9 = etr(v8);
  for ( i = 1; i <= v0; ++i )
  {
    memset(&s, 0, 0x78u);
    get_eport_stat(i, &s);
    printf("<tr class='list' style='background-color: #%s'>");
    printf("<td style='width: 25px; padding: 0 3px;'>%d</td>", i);
    v12 = -1;
    do
    {
      ++v12;
      v13 = sub_37058(v12, v11);
      if ( *(_BYTE *)v13 )
      {
        sub_36F78(v12, (int)&s);
        v13 = printf("<td style='padding: 0 3px; font-size:9px'>%llu</td>");
      }
    }
    while ( v12 != 29 );
    v9 = etr(v13);
  }
  str(v9);
  printf("<td colspan=%d align=right style='border-top: 1px solid #CCC;'>\n", 16);
  v15 = sub_134F4(671, v14);
  printf("<input type=button name=clear_sub value=\" %s \" style='margin: 5px;' onclick=\"ClearLinkStat();\">\n", v15);
  v16 = printf("</td>");
  v17 = etr(v16);
  print_end_content_table(v17);
  return printf("</form>");
}
// E7D4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// EB7C: using guessed type int __fastcall get_eport_stat(_DWORD, _DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// FBA8: using guessed type int __fastcall print_end_content_table(_DWORD);

//----- (000373A4) --------------------------------------------------------
int __fastcall sub_373A4(int a1)
{
  int v2; // [sp+0h] [bp-28h]@1

  if ( get_value(a1, "act", &v2, 32) && !strcmp((const char *)&v2, "clear") )
    clear_port_statistics();
  return 0;
}
// F35C: using guessed type int clear_port_statistics(void);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (000373F4) --------------------------------------------------------
int __fastcall sub_373F4(int a1)
{
  int v1; // r4@1
  int v2; // r0@1

  v1 = a1;
  printf("<style>");
  printf("tr.title td { border-bottom: 1px solid #CCC;; }");
  printf("tr.list { height: 20px; }");
  printf("</style>");
  printf("<table cellpadding=0px cellspacing=0px style='width: 100%%;'>\n");
  sub_373A4(v1);
  v2 = sub_3714C();
  return print_end_main_table(v2);
}
// F5F0: using guessed type int __fastcall print_end_main_table(_DWORD);

//----- (00037450) --------------------------------------------------------
int __fastcall sub_37450(int a1)
{
  int v1; // r5@1
  int v2; // r0@5
  int v3; // r0@7
  int v4; // r9@8
  int v5; // r10@9
  char *v6; // r2@11
  int v7; // r0@11
  int v8; // r1@11
  int v9; // r0@16
  int v10; // r8@18
  int v11; // r7@22
  int v12; // r6@25
  int v13; // r0@26
  int v14; // r2@29
  int v15; // r0@30
  int v16; // r4@34
  int v17; // r0@35
  int v18; // r0@42
  int v20; // [sp+0h] [bp-220h]@19
  char v21; // [sp+80h] [bp-1A0h]@18
  char nptr; // [sp+100h] [bp-120h]@3
  char v23; // [sp+180h] [bp-A0h]@2

  v1 = a1;
  if ( ((int (*)(void))get_value)() )
  {
    if ( strcmp(&v23, "conf") )
    {
      if ( !strcmp(&v23, "clear") )
      {
        v3 = netdetect_clear_all_history();
      }
      else
      {
        v3 = strcmp(&v23, "sendemail");
        if ( !v3 )
          v3 = write_file("/var/run/nd_send_immediately", "1");
      }
      goto LABEL_42;
    }
    if ( !get_value(v1, "op_radio", &nptr, 128) || strcmp(&nptr, "on") )
    {
      v3 = netdetect_set_on_off(0);
LABEL_42:
      v18 = signal_update(v3);
      signal_save(v18);
      return 0;
    }
    netdetect_set_on_off(1);
    v2 = get_value(v1, "sel_port", &nptr, 128);
    if ( v2 )
      v2 = atoi(&nptr);
    v4 = v2;
    if ( !get_value(v1, "sel_level", &nptr, 128) )
    {
      v5 = 1;
LABEL_16:
      v9 = get_value(v1, "burst_drop", &nptr, 128);
      if ( v9 )
        v9 = atoi(&nptr);
      v10 = v9;
      if ( get_admin_email(&v21) && get_smtp_server(&v20) )
      {
        if ( get_value(v1, "rp_mail", &nptr, 128) && get_value(v1, "rp_time", &nptr, 128) )
          v11 = atoi(&nptr);
        else
          v11 = 255;
        if ( get_value(v1, "rp_first", &nptr, 128) )
        {
          v13 = strcmp(&nptr, "on");
          v12 = 1 - v13;
          if ( (unsigned int)v13 > 1 )
            v12 = 0;
        }
        else
        {
          v12 = 0;
        }
        if ( get_value(v1, "rp_clear", &nptr, 128) )
        {
          v15 = strcmp(&nptr, "on");
          v14 = 1 - v15;
          if ( (unsigned int)v15 > 1 )
            v14 = 0;
        }
        else
        {
          v14 = 0;
        }
        netdetect_set_email_policy(v11, v12, v14);
      }
      if ( get_value(v1, &unk_7FDFA, &nptr, 128) )
      {
        v17 = strcmp(&nptr, "on");
        v16 = 1 - v17;
        if ( (unsigned int)v17 > 1 )
          v16 = 0;
      }
      else
      {
        v16 = 0;
      }
      netdetect_set_portrange_and_monitorlevel(v4, v5);
      v3 = netdetect_set_burst_drop(v10, v16);
      goto LABEL_42;
    }
    if ( !strcmp(&nptr, "pre_defined") )
    {
      v6 = &nptr;
      v7 = v1;
      v8 = (int)"level_type";
    }
    else
    {
      if ( strcmp(&nptr, "user_defined") )
      {
LABEL_15:
        v5 = atoi(&nptr);
        goto LABEL_16;
      }
      v8 = (int)"user_level";
      v6 = &nptr;
      v7 = v1;
    }
    get_value(v7, v8, v6, 128);
    goto LABEL_15;
  }
  return 0;
}
// E870: using guessed type int __fastcall netdetect_set_portrange_and_monitorlevel(_DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EAEC: using guessed type int __fastcall netdetect_set_on_off(_DWORD);
// ED80: using guessed type int __fastcall netdetect_set_burst_drop(_DWORD, _DWORD);
// F3BC: using guessed type int netdetect_clear_all_history(void);
// F3E0: using guessed type int __fastcall netdetect_set_email_policy(_DWORD, _DWORD, _DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// FB00: using guessed type int __fastcall get_smtp_server(_DWORD);
// FCB0: using guessed type int __fastcall get_admin_email(_DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);
// FD34: using guessed type int __fastcall write_file(_DWORD, _DWORD);

//----- (00037784) --------------------------------------------------------
int sub_37784()
{
  char *v0; // r6@1
  int v1; // r11@1
  int v2; // r8@1
  int v3; // r7@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r0@1
  int v8; // r0@1
  int v9; // r1@1
  int v10; // r0@1
  int v11; // r0@1
  int v12; // r1@1
  char *v13; // r4@2
  int v14; // r0@4
  int v15; // r0@4
  int v16; // r1@4
  char *v17; // r4@5
  int v18; // r0@7
  int v19; // r0@7
  int v20; // r0@7
  int v21; // r1@7
  int v22; // r0@7
  int v23; // r1@7
  char *v24; // r4@8
  int v25; // r0@10
  int v26; // r1@10
  char *v27; // r4@11
  int v28; // r0@13
  int v29; // r0@13
  int v30; // r0@13
  int v31; // r1@13
  int v32; // r0@13
  char *v33; // r1@14
  int v34; // r1@16
  char *v35; // r4@17
  int v36; // r0@19
  int v37; // r1@19
  char *v38; // r4@20
  int v39; // r0@22
  int v40; // r1@22
  char *v41; // r4@23
  int v42; // r0@25
  char *v43; // r1@26
  int v44; // r1@28
  int v45; // r4@29
  int v46; // r0@31
  int v47; // r0@31
  int v48; // r0@31
  int v49; // r1@31
  int v50; // r0@31
  int v51; // r1@31
  char *v52; // r4@32
  int v53; // r0@34
  int v54; // r1@34
  int v55; // r0@36
  int v56; // r1@36
  char *v57; // r7@37
  int v58; // r0@39
  int v59; // r0@39
  int v60; // r0@39
  int v61; // r1@39
  int v62; // r0@39
  int v63; // r1@39
  char *v64; // r1@42
  int v65; // r1@44
  int v66; // r0@44
  int v67; // r1@44
  int v68; // r0@44
  int v69; // r1@44
  char *v70; // r4@45
  int v71; // r0@47
  int v72; // r1@47
  char *v73; // r4@48
  int v74; // r0@50
  int v75; // r0@51
  int v76; // r0@51
  int v77; // r1@51
  int v78; // r0@51
  int v79; // r0@51
  int v80; // r0@51
  int v81; // r1@51
  int v82; // r0@51
  int v83; // r0@51
  int v84; // r1@51
  int v85; // r0@51
  int v86; // r7@51
  int v87; // r1@51
  int v88; // r0@51
  int v89; // r0@51
  int v90; // r0@51
  int v91; // r0@51
  int v92; // r1@51
  int v93; // r0@51
  int v94; // r1@51
  int v95; // r0@51
  int v96; // r1@51
  int v97; // r0@51
  int v98; // r1@51
  int v99; // r0@51
  int v100; // r1@51
  int v101; // r0@51
  int v102; // r0@51
  int v103; // r0@51
  int v104; // r0@51
  int v105; // r8@51
  int v106; // r4@52
  char *v107; // r0@53
  const char *v108; // r0@53
  const char *v109; // r0@54
  int v110; // r1@56
  char *v111; // r3@57
  int v112; // r1@64
  bool v113; // zf@64
  int v114; // r0@64
  char *v115; // r4@64
  int v116; // r0@66
  int v117; // r0@66
  int v118; // r0@69
  int v120; // r0@70
  int v121; // [sp+Ch] [bp-25Ch]@1
  char dest; // [sp+14h] [bp-254h]@53
  char v123; // [sp+114h] [bp-154h]@40
  char v124; // [sp+194h] [bp-D4h]@39
  char v125; // [sp+214h] [bp-54h]@7
  char v126; // [sp+224h] [bp-44h]@7
  int v127; // [sp+234h] [bp-34h]@1
  int v128; // [sp+238h] [bp-30h]@1
  int v129; // [sp+23Ch] [bp-2Ch]@1

  v0 = "selected";
  v121 = netdetect_get_detect_port_range();
  v1 = netdetect_get_monitor_level();
  v2 = netdetect_get_burst_drop();
  v3 = netdetect_get_virus_drop();
  v4 = netdetect_get_email_policy(&v129, &v128, &v127);
  print_start_main_table(v4);
  printf("<form method=get action=timepro.cgi name=netdetect_fm>");
  printf("<input type=hidden name=tmenu value=firewallconf>");
  printf("<input type=hidden name=smenu value=netdetect>");
  printf("<input type=hidden name=act value=>");
  printf("<input type=hidden name=netdetect_op value=>");
  v6 = sub_134F4(728, v5);
  v7 = print_sub_title(v6, 1);
  v8 = print_start_content_table(v7);
  str(v8);
  v10 = sub_134F4(754, v9);
  print_item_desc(v10, 0, 0, 0);
  v11 = puts("<td class=item_td>");
  if ( netdetect_get_on_off(v11) )
    v13 = "checked";
  else
    v13 = "";
  v14 = sub_134F4(894, v12);
  printf("<input type=radio name=op_radio value=on %s> %s", v13, v14);
  v15 = print_nbsp(5);
  if ( netdetect_get_on_off(v15) )
    v17 = "";
  else
    v17 = "checked";
  v18 = sub_134F4(900, v16);
  printf("<input type=radio name=op_radio value=off %s> %s", v17, v18);
  print_nbsp(10);
  v19 = get_ifconfig("br0", &v126, &v125);
  v20 = etr(v19);
  str(v20);
  v22 = sub_134F4(721, v21);
  print_item_desc(v22, 0, 0, 0);
  printf("<td class=item_td>");
  if ( v121 )
    v24 = "";
  else
    v24 = "checked";
  v25 = sub_134F4(722, v23);
  printf("<input type=radio name=sel_port value=0 onclick=\"disable_sel_port('virus')\" %s> %s", v24, v25);
  print_nbsp(5);
  if ( v121 )
    v27 = "checked";
  else
    v27 = "";
  v28 = sub_134F4(720, v26);
  printf("<input type=radio name=sel_port value=1 onclick=\"disable_sel_port('all')\" %s>%s", v27, v28);
  v29 = puts("</td>");
  v30 = etr(v29);
  str(v30);
  v32 = sub_134F4(711, v31);
  print_item_desc(v32, 0, 0, 0);
  printf("<td class=item_td>");
  if ( v1 > 2 )
    v33 = "";
  else
    v33 = "checked";
  printf("<input type=radio name=sel_level value=pre_defined onclick=\"disable_sel_level('predefine')\" %s> ", v33);
  printf("<select name=\"level_type\">");
  if ( v1 )
    v35 = "";
  else
    v35 = "selected";
  v36 = sub_134F4(713, v34);
  printf("<option value=\"0\" %s>%s", v35, v36);
  if ( v1 == 1 )
    v38 = "selected";
  else
    v38 = "";
  v39 = sub_134F4(714, v37);
  printf("<option value=\"1\" %s>%s", v38, v39);
  if ( v1 == 2 )
    v41 = "selected";
  else
    v41 = "";
  v42 = sub_134F4(712, v40);
  printf("<option value=\"2\" %s>%s", v41, v42);
  puts("</select>");
  print_nbsp(5);
  if ( v1 > 2 )
    v43 = "checked";
  else
    v43 = "";
  printf("<input type=radio name=sel_level value=user_defined onclick=\"disable_sel_level('userdefine')\" %s> ", v43);
  if ( v1 <= 2 )
    v45 = 0;
  else
    v45 = v1;
  v46 = sub_134F4(715, v44);
  printf("<input type=text name=user_level value=%d size=4 maxlength=4> %s", v45, v46);
  v47 = puts("</td>");
  v48 = etr(v47);
  str(v48);
  v50 = sub_134F4(695, v49);
  print_item_desc(v50, 0, 0, 0);
  printf("<td class=item_td>");
  printf("<select name=burst_drop onclick=\"disable_sel_port('all')\">");
  if ( v2 )
    v52 = "";
  else
    v52 = "selected";
  v53 = sub_134F4(696, v51);
  printf("<option value=0 %s>%s", v52, v53);
  if ( !v2 )
    v0 = "";
  v55 = sub_134F4(698, v54);
  printf("<option value=1 %s>%s", v0, v55);
  puts("</select>");
  print_nbsp(5);
  if ( v3 )
    v57 = "checked";
  else
    v57 = "";
  v58 = sub_134F4(697, v56);
  printf("<input type=checkbox name=virus_drop %s> %s", v57, v58);
  v59 = puts("</td>");
  v60 = etr(v59);
  str(v60);
  v62 = sub_134F4(703, v61);
  print_item_desc(v62, 0, 0, 0);
  printf("<td class=item_td>");
  if ( get_admin_email(&v124) && get_smtp_server(&v123) )
  {
    if ( v129 == 255 )
      v64 = "";
    else
      v64 = "checked";
    printf("<input type=checkbox name=rp_mail onclick=\"checkEmailOption()\" %s>", v64);
    v66 = sub_134F4(706, v65);
    printf(" %s ", v66);
    printf("<input type=text name=rp_time value=%d size=2 maxlength=2>");
    v68 = sub_134F4(707, v67);
    printf(" %s", v68);
    print_nbsp(3);
    if ( v127 )
      v70 = "checked";
    else
      v70 = "";
    v71 = sub_134F4(704, v69);
    printf("<input type=checkbox name=rp_clear %s> %s", v70, v71);
    if ( v128 )
      v73 = "checked";
    else
      v73 = "";
    v74 = sub_134F4(705, v72);
    printf("<br><input type=checkbox name=rp_first %s> %s", v73, v74);
  }
  else
  {
    v120 = sub_134F4(993, v63);
    printf((const char *)v120, "JavaScript:MovePagetoMain('sysconf','login');");
  }
  v75 = puts("</td>");
  v76 = etr(v75);
  str(v76);
  printf("<td align=right colspan=2 class=item_td>");
  v78 = sub_134F4(28, v77);
  v79 = printf("<input type=button name=netdetect_conf value=\"%s\" onclick=\"ConfNetDetect()\"></td>", v78);
  v80 = etr(v79);
  print_end_content_table(v80);
  v82 = sub_134F4(716, v81);
  print_sub_title(v82, 0);
  v83 = printf("<tr><td><table border='0' cellpadding='0' cellspacing='0' width=100%%>\n");
  str(v83);
  puts("<td align=left>");
  v85 = sub_134F4(718, v84);
  v86 = 0;
  printf("<input type=button name=send_email value=\"%s\" onclick=\"SendEmail()\" %s>", v85);
  puts("</td>");
  puts("<td align=right>");
  v88 = sub_134F4(699, v87);
  printf("<input type=button name=clear_history value=\"%s\" onclick=\"ClearHistory()\">", v88);
  v89 = puts("</td>");
  etr(v89);
  v90 = printf("</table></td></tr>");
  v91 = print_start_content_table(v90);
  str(v91);
  v93 = sub_134F4(710, v92);
  print_item_desc(v93, 140, 0, 0);
  v95 = sub_134F4(401, v94);
  print_item_desc(v95, 80, 0, 0);
  v97 = sub_134F4(803, v96);
  print_item_desc(v97, 60, 0, 0);
  v99 = sub_134F4(702, v98);
  print_item_desc(v99, 70, 0, 0);
  v101 = sub_134F4(701, v100);
  v102 = print_item_desc(v101, 250, 0, 0);
  v103 = etr(v102);
  v104 = netdetect_read_current_history(v103);
  v105 = v104;
  while ( v86 < v105 )
  {
    v104 = netdetect_get_history_by_index(v86);
    v106 = v104;
    if ( *(_DWORD *)(v104 + 4) )
    {
      str(v104);
      conv_time(*(_DWORD *)(v106 + 20), &dest, 1);
      print_item(&dest, 0, 0, 0);
      v107 = inet_ntoa(*(struct in_addr *)(v106 + 4));
      snprintf2(&dest, 256, "%s", v107, 0);
      v108 = (const char *)get_twinip_wan_virtual_ip("wan1");
      if ( !strcmp(&dest, v108) || (v109 = (const char *)get_twinip_wan_virtual_ip("wan2"), !strcmp(&dest, v109)) )
        strcpy(&dest, "Twin IP");
      print_item(&dest, 0, 0, 0);
      v110 = *(_DWORD *)(v106 + 8);
      if ( v110 == 6 )
      {
        v111 = "TCP";
      }
      else if ( v110 == 17 )
      {
        v111 = "UDP";
      }
      else
      {
        v111 = "ICMP";
        if ( v110 != 1 )
          v111 = "Multi Port";
      }
      snprintf2(&dest, 256, "%s", v111, 0);
      if ( *(_DWORD *)(v106 + 8) > 1u )
        snprintf2(&dest, 256, "%s/%d", &dest, *(_DWORD *)(v106 + 12));
      print_item(&dest, 0, 0, 0);
      snprintf2(&dest, 256, "%d", *(_DWORD *)(v106 + 16), 0);
      print_item(&dest, 0, 0, 0);
      v112 = *(_DWORD *)(v106 + 12);
      v113 = (*(_DWORD *)(v106 + 24) & 0x8000) == 0;
      v114 = *(_DWORD *)(v106 + 8);
      v115 = "black";
      if ( v113 )
        v115 = "red";
      v116 = netdetect_comment_for_specified_port(v114, v112);
      snprintf2(&dest, 256, "<font color=%s>%s</font>", v115, v116);
      v117 = print_item(&dest, 0, 0, 0);
      v104 = etr(v117);
    }
    ++v86;
  }
  print_end_content_table(v104);
  v118 = puts("</form>");
  print_end_main_table(v118);
  puts("<script language=JavaScript>");
  printf("disable_sel_level('%s');\n");
  printf("disable_sel_port('%s');\n");
  puts("checkEmailOption();");
  printf("document.body.style.backgroundColor = '';");
  return puts("</script>");
}
// EBE8: using guessed type int netdetect_get_virus_drop(void);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EF18: using guessed type int __fastcall print_item(_DWORD, _DWORD, _DWORD, _DWORD);
// EF78: using guessed type int __fastcall conv_time(_DWORD, _DWORD, _DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F230: using guessed type int __fastcall netdetect_get_on_off(_DWORD);
// F2A8: using guessed type int __fastcall print_start_main_table(_DWORD);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F374: using guessed type int __fastcall print_sub_title(_DWORD, _DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// F5F0: using guessed type int __fastcall print_end_main_table(_DWORD);
// F680: using guessed type int __fastcall netdetect_comment_for_specified_port(_DWORD, _DWORD);
// F6F8: using guessed type int __fastcall netdetect_get_history_by_index(_DWORD);
// F764: using guessed type int __fastcall print_item_desc(_DWORD, _DWORD, _DWORD, _DWORD);
// F8A8: using guessed type int __fastcall print_start_content_table(_DWORD);
// F8E4: using guessed type int __fastcall netdetect_get_email_policy(_DWORD, _DWORD, _DWORD);
// F920: using guessed type int __fastcall get_twinip_wan_virtual_ip(_DWORD);
// F9F8: using guessed type int netdetect_get_detect_port_range(void);
// FB00: using guessed type int __fastcall get_smtp_server(_DWORD);
// FB30: using guessed type int netdetect_get_burst_drop(void);
// FB9C: using guessed type int __fastcall netdetect_read_current_history(_DWORD);
// FBA8: using guessed type int __fastcall print_end_content_table(_DWORD);
// FBCC: using guessed type int netdetect_get_monitor_level(void);
// FCB0: using guessed type int __fastcall get_admin_email(_DWORD);

//----- (0003810C) --------------------------------------------------------
signed int __fastcall sub_3810C(int a1)
{
  int v1; // r4@1
  signed int result; // r0@1

  v1 = a1;
  result = sub_12380();
  if ( !result )
  {
    sub_37450(v1);
    result = sub_37784();
  }
  return result;
}

//----- (00038130) --------------------------------------------------------
int __fastcall sub_38130(int a1)
{
  int v1; // r5@1
  char *v2; // r0@1
  const char *v3; // r0@1
  char *v4; // r0@4
  unsigned __int16 v5; // r0@5
  char *v6; // r0@8
  unsigned __int16 v7; // r0@9
  int v8; // r6@10
  int v9; // r0@11
  int v10; // r5@11
  int v11; // r4@11
  int v12; // r1@12
  unsigned int v13; // r1@13
  int v14; // r1@16
  int v15; // r0@16
  int v16; // r1@16
  int v17; // r0@16
  int v18; // r1@16
  int v19; // r0@16
  int v20; // r1@16
  int v21; // r0@16
  int v22; // r1@16
  int v23; // r0@16
  int v24; // r1@16
  int v25; // r0@16
  int v26; // r1@16
  int v27; // r0@16
  int v28; // r0@16
  int v29; // r8@16
  signed int v30; // r5@16
  int v31; // r0@17
  int v32; // r7@17
  struct in_addr v33; // r0@17
  char *v34; // r0@18
  const char *v35; // r0@20
  int v36; // r1@22
  char *v37; // r3@23
  int v38; // r0@30
  int v39; // r2@30
  int v40; // r1@30
  char *v41; // r4@30
  int v42; // r7@30
  char *v43; // r12@32
  int v44; // r1@37
  int v45; // r0@37
  int v46; // r1@38
  int v47; // r0@38
  char v49; // [sp+10h] [bp-140h]@3
  char v50; // [sp+90h] [bp-C0h]@22
  char v51; // [sp+108h] [bp-48h]@16
  char v52; // [sp+118h] [bp-38h]@16
  char cp; // [sp+128h] [bp-28h]@1

  v1 = a1;
  puts("<script language=JavaScript>");
  puts("<!--");
  puts("function Confirm()");
  puts("{");
  puts("\tvar F = document.ndwarning_fm;");
  puts("\tvar chk_ignore = false;");
  puts("\tvar chk_warn = false;");
  puts("\tfor (i=0; i < F.elements.length; i++)");
  puts("\t{");
  puts("\t\tif (F.elements[i].type == 'checkbox')");
  puts("\t\t{");
  puts("\t\t\tif (F.elements[i].checked)");
  puts("\t\t\t{");
  puts("\t\t\t\tif (chk_ignore == false)");
  puts("\t\t\t\t\tF.ignore.value = F.elements[i].value;");
  puts("\t\t\t\telse");
  puts("\t\t\t\t\tF.ignore.value += \" \" + F.elements[i].value;");
  puts("\t\t\t\tchk_ignore = true;");
  puts("\t\t\t}");
  puts("\t\t\telse");
  puts("\t\t\t{");
  puts("\t\t\t\tif (chk_warn == false)");
  puts("\t\t\t\t\tF.warn.value = F.elements[i].value;");
  puts("\t\t\t\telse");
  puts("\t\t\t\t\tF.warn.value += \" \" + F.elements[i].value;");
  puts("\t\t\t\tchk_warn = true;");
  puts("\t\t\t}");
  puts("\t\t}");
  puts("\t}");
  puts("\tF.flag.value = \"nd-report\"");
  puts("\tF.act.value = \"confirm\"");
  puts("\tF.submit();");
  puts("}");
  puts("-->");
  puts("</script>");
  v2 = getenv("REMOTE_ADDR");
  sf_strncpy(&cp, v2, 16);
  v3 = (const char *)get_pvalue(v1, "act");
  if ( v3 && !strcmp(v3, "confirm") )
  {
    if ( get_value(v1, "ignore", &v49, 128) )
    {
      v4 = strtok(&v49, " ");
      do
      {
        v5 = atoi(v4);
        netdetect_write_option(v5, 0);
        v4 = strtok(0, " ");
      }
      while ( v4 );
    }
    else if ( get_value(v1, "warn", &v49, 128) )
    {
      v6 = strtok(&v49, " ");
      do
      {
        v7 = atoi(v6);
        netdetect_write_option(v7, 0x8000);
        v6 = strtok(0, " ");
      }
      while ( v6 );
    }
    ((void (*)(void))netdetect_read_current_history)();
    v8 = 0;
    do
    {
      v9 = netdetect_get_history_by_index(v8++);
      v10 = v9;
      v11 = *(_DWORD *)(v9 + 4);
      if ( v11 == inet_addr(&cp) )
      {
        v12 = *(_DWORD *)(v10 + 24);
        if ( v12 & 1 )
        {
          v13 = v12 & 0xFFFFFFFE;
          *(_DWORD *)(v10 + 24) = v13;
          netdetect_write_option(*(_WORD *)v10, v13);
        }
      }
    }
    while ( v8 != 1000 );
    netdetect_set_option_rule(68, &cp);
  }
  printf("<form method=get action=\"netdetect.cgi\" name=\"ndwarning_fm\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  printf("<input type=hidden name=\"ignore\" value=\"\">");
  printf("<input type=hidden name=\"warn\" value=\"\">");
  printf("<input type=hidden name=\"flag\" value=\"\">");
  printf("<table style=\"border-collapse:collapse;\" border=0>");
  puts("<tr><td></td><td colspan=4><span class=\"item_string\">");
  puts("<font color=\"crimson\" size=2pt>");
  v15 = sub_134F4(729, v14);
  printf((const char *)v15);
  printf("</font>");
  printf("</span></tr></td>");
  print_blank_line(5, 10);
  get_ifconfig("br0", &v52, &v51);
  puts("<tr><td></td><td colspan=4><span class=\"item_string\">");
  puts("<font color=\"blue\" size=2>");
  v17 = sub_134F4(709, v16);
  printf((const char *)v17);
  printf("<br><br>");
  v19 = sub_134F4(717, v18);
  printf((const char *)v19, &v52);
  printf("</font>");
  printf("</span></tr></td>");
  print_blank_line(5, 15);
  puts("<tr>");
  printf("<td></td>");
  v21 = sub_134F4(710, v20);
  print_item_desc(v21, 140, 0, 0);
  v23 = sub_134F4(803, v22);
  print_item_desc(v23, 90, 0, 0);
  v25 = sub_134F4(215, v24);
  print_item_desc(v25, 240, 0, 0);
  v27 = sub_134F4(725, v26);
  print_item_desc(v27, 60, 0, 0);
  v28 = puts("</tr>");
  netdetect_read_current_history(v28);
  v29 = 0;
  v30 = 1;
  do
  {
    v31 = netdetect_get_history_by_index(v29);
    v32 = v31;
    v33.s_addr = *(_DWORD *)(v31 + 4);
    if ( !v33.s_addr )
      break;
    v34 = inet_ntoa(v33);
    if ( !strcmp(&cp, v34) )
    {
      puts("<tr>");
      if ( *(_DWORD *)(v32 + 24) & 1 )
        v35 = "<td><font color=\"limegreen\" size=2pt><sup> NEW </sup></font></td>";
      else
        v35 = "<td></td>";
      printf(v35);
      conv_time(*(_DWORD *)(v32 + 20), &v50, 1);
      print_item(&v50, 140, 0, 0);
      v36 = *(_DWORD *)(v32 + 8);
      if ( v36 == 6 )
      {
        v37 = "TCP";
      }
      else if ( v36 == 17 )
      {
        v37 = "UDP";
      }
      else
      {
        v37 = "ICMP";
        if ( v36 != 1 )
          v37 = "Multi Port";
      }
      snprintf2(&v50, 120, "%s", v37, 0);
      if ( *(_DWORD *)(v32 + 8) > 1u )
        snprintf2(&v50, 120, "%s/%d", &v50, *(_DWORD *)(v32 + 12));
      v30 = 0;
      print_item(&v50, 90, 0, 0);
      v38 = netdetect_comment_for_specified_port(*(_DWORD *)(v32 + 8), *(_DWORD *)(v32 + 12));
      print_item(v38, 240, 0, 0);
      v39 = *(_DWORD *)(v32 + 24);
      v40 = *(_DWORD *)(v32 + 8);
      v41 = "checked";
      v42 = *(_DWORD *)v32;
      if ( v39 & 0x8000 )
        v41 = "";
      v43 = "disabled";
      if ( v40 )
        v43 = "";
      snprintf2(&v50, 120, "<input type=checkbox name=\"w%d\" value=\"%d\" %s %s>", v42, v42, v41, v43);
      print_item(&v50, 60, 0, 0);
      puts("</tr>");
    }
    ++v29;
  }
  while ( v29 != 1000 );
  if ( v30 )
  {
    puts("<tr>");
    printf("<td></td>");
    v45 = sub_134F4(749, v44);
    print_item(v45, 140, 0, 0);
    print_item("-", 90, 0, 0);
    print_item("-", 240, 0, 0);
    print_item("-", 50, 0, 0);
    puts("</tr>");
  }
  print_blank_line(5, 10);
  printf("<tr><td colspan=5 align=center>");
  v47 = sub_134F4(730, v46);
  printf("<input type=button name=\"ndwarning\" value=\"%s\" onclick=\"Confirm()\">", v47);
  printf("</td></tr>");
  printf("</form>");
  print_blank_line(4, 20);
  return printf("</table>");
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EE28: using guessed type int __fastcall netdetect_write_option(_DWORD, _DWORD);
// EF18: using guessed type int __fastcall print_item(_DWORD, _DWORD, _DWORD, _DWORD);
// EF78: using guessed type int __fastcall conv_time(_DWORD, _DWORD, _DWORD);
// F020: using guessed type int __fastcall netdetect_set_option_rule(_DWORD, _DWORD);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// F680: using guessed type int __fastcall netdetect_comment_for_specified_port(_DWORD, _DWORD);
// F6F8: using guessed type int __fastcall netdetect_get_history_by_index(_DWORD);
// F764: using guessed type int __fastcall print_item_desc(_DWORD, _DWORD, _DWORD, _DWORD);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// FB9C: using guessed type int __fastcall netdetect_read_current_history(_DWORD);

//----- (000388A4) --------------------------------------------------------
int __fastcall sub_388A4(int a1)
{
  int v1; // r4@1
  const char *v2; // r0@1
  const char *v3; // r4@1
  signed int v4; // r5@4
  int v5; // r0@8
  int v6; // r1@8
  int v7; // r0@8
  int v8; // r0@8
  int v9; // r0@8
  const char *v10; // r0@9
  int v11; // r0@13
  char *v13; // r0@14
  char v14; // [sp+8h] [bp-130h]@12
  char v15; // [sp+108h] [bp-30h]@12
  char v16; // [sp+118h] [bp-20h]@14

  v1 = a1;
  puts("<script language=JavaScript>");
  puts("<!--");
  puts("function SelectMenu(menu)");
  puts("{");
  puts("\tvar F = document.menu_fm;");
  printf("\tif(menu == 'report')");
  puts("\t\tF.act.value = \"report\"");
  printf("\telse if(menu == 'scan')");
  puts("\t\tF.act.value = \"scan\"");
  printf("\telse if(menu == 'remedy')");
  puts("\t\tF.act.value = \"remedy\"");
  puts("\tF.flag.value = \"nd-warning\"");
  puts("\tF.submit();");
  puts("}");
  puts("-->");
  puts("</script>");
  v2 = (const char *)get_pvalue(v1, "act");
  v3 = v2;
  if ( !v2 || !strcmp(v2, "report") )
    goto LABEL_7;
  if ( strcmp(v3, "scan") )
  {
    if ( !strcmp(v3, "remedy") )
    {
      v4 = 3;
      goto LABEL_14;
    }
LABEL_7:
    v4 = 1;
    goto LABEL_8;
  }
  v4 = 2;
LABEL_14:
  v13 = getenv("REMOTE_ADDR");
  sf_strncpy(&v16, v13, 16);
  netdetect_set_option_rule(68, &v16);
LABEL_8:
  puts("<BODY BOTTOMMARGIN=0 RIGHTMARGIN=0 LEFTMARGIN=0 TOPMARGIN=0 MARGINWIDTH=0 MARGINHEIGHT=0 >");
  printf("<form method=get action=\"netdetect.cgi\" name=\"menu_fm\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  printf("<input type=hidden name=\"flag\" value=\"\">");
  puts("<table>");
  v5 = print_blank_line(2, 10);
  str(v5);
  printf("<td></td>");
  printf("<td align=right valign=middle>");
  v7 = sub_134F4(700, v6);
  printf("<input type=button name=\"ndwarning\" value=\"%s\" onclick=\"javascrip:parent.close()\">", v7);
  v8 = printf("</td>");
  v9 = etr(v8);
  str(v9);
  puts("<td colspan=2 valign=middle>");
  if ( v4 == 2 )
  {
    v10 = "<iframe width=\"600\" height=\"430\" name=\"subwin\" src=\"http://efm.livecall.co.kr/virusrepair/s_scan.html\"></iframe>";
  }
  else if ( v4 == 3 )
  {
    v10 = "<iframe width=\"600\" height=\"430\" name=\"subwin\" src=\"http://efm.livecall.co.kr/virusrepair/s_remedy.html\"></iframe>";
  }
  else
  {
    get_iptime_service_network(&v15);
    snprintf2(
      &v14,
      256,
      "<iframe width=\"600\" height=\"430\" name=\"subwin\" src=\"http://%s.1:%d/nd-bin/netdetect.cgi?flag=nd-report\">",
      &v15,
      80);
    printf("%s", &v14);
    v10 = "</iframe>";
  }
  printf(v10);
  v11 = printf("</td>");
  etr(v11);
  printf("</table>");
  printf("</form>");
  return printf("</body>");
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F020: using guessed type int __fastcall netdetect_set_option_rule(_DWORD, _DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// FBC0: using guessed type int __fastcall get_iptime_service_network(_DWORD);

//----- (00038B48) --------------------------------------------------------
int sub_38B48()
{
  puts("<style type=\"text/css\">");
  puts(".wol_main_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".wol_main_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".wol_main_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".wol_main_p {");
  puts("\tpadding:0 0 0 5px; display:inline-block;");
  puts("\tvertical-align:middle; margin:0;");
  puts("}");
  puts(".wol_main_span {");
  puts("\tdisplay:inline-block; vertical-align:middle;");
  puts("}");
  puts(".wol_main_button {");
  puts("\tpadding:0 1px 0 1px; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".wol_main_td input[type=checkbox], .wol_main_td input[type=radio] {");
  puts("display:inline-block; vertical-align:middle;");
  puts("}");
  puts("#wol_div_msg p {");
  puts("margin:5 0 5 15px; text-align:left;");
  puts("}");
  puts(".wol_ellipsis {");
  puts("text-overflow:ellipsis; overflow:hidden; white-space:nowrap; text-align:left;");
  puts("}");
  printf("input[type=\"text\"] {border:1px #CCC solid;}");
  printf("input[type=\"password\"] {border:1px #CCC solid;}");
  printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td {cursor:default;}");
  return printf("</style>");
}

//----- (00038CE4) --------------------------------------------------------
int sub_38CE4()
{
  int v0; // r1@1
  int v1; // r0@1
  char *v2; // r0@1
  _UNKNOWN *v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r1@1
  int v7; // r0@1
  _UNKNOWN *v8; // r4@1
  int v9; // r1@1
  int v10; // r0@1
  int v11; // r1@1
  int v12; // r0@1
  int v13; // r0@1
  int v14; // r0@2
  int v15; // r0@4
  int v16; // r0@5
  char v18; // [sp+4h] [bp-1Ch]@1

  printf("<table class=\"v3_table wol_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<form method=post action=timepro.cgi name=remotepc_fm style=\"margin:0; padding:0;\">");
  printf("<input type=hidden name=tmenu value=expertconf>");
  printf("<input type=hidden name=smenu value=remotepc>");
  printf("<input type=hidden name=act value=>");
  printf("<input type=hidden name=ocolor value=>");
  printf("<COL width=\"100\"><COL width=\"250\"><COL width=\"262\"><COL width=\"30\">");
  printf("<tr class=\"wol_main_tr\" height=\"5\"><td class=\"wol_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  printf("<tr class=\"wol_main_tr\" height=\"24\"><td class=\"wol_main_td\">");
  v1 = sub_134F4(512, v0);
  printf("<p class=\"wol_main_p\">%s</p>", v1);
  printf("</td><td class=\"wol_main_td\">");
  v2 = getenv("REMOTE_ADDR");
  get_internal_pc_hardware_address(v2, &v18);
  sub_121A0((int)"hw", 0, 0);
  v3 = sub_126C4();
  printf(
    "<button type=\"button\" class=\"wol_main_button\" name=\"hw_search\" style=\"margin-left:5px;\" onclick=\"onclick_macsearchbtn('hw')\">                <img src=\"/%s/fw_search.gif\" style=\"width:16px; height:16px; padding:0; margin:0;\"></button>",
    v3);
  printf("</td><td class=\"wol_main_td\">");
  printf(
    "<input type=checkbox class=navi_chk id=curpcmacchk onclick=\"SetHWOnCheckNoDisable(this,'hw','%s');\"> ",
    &v18);
  v5 = sub_134F4(347, v4);
  printf("<label for=\"curpcmacchk\">%s</label>", v5);
  printf("</td><td class=\"wol_main_td\">");
  printf("</td></tr>");
  printf("<tr class=\"wol_main_tr\" height=\"24\"><td class=\"wol_main_td\">");
  v7 = sub_134F4(213, v6);
  printf("<p class=\"wol_main_p\">%s</p>", v7);
  printf("</td><td class=\"wol_main_td\">");
  printf("<input type=text name=\"pcname\" maxlength=24 size=24 style=\"width:165px;\" value=>");
  printf("</td><td class=\"wol_main_td\" colspan=\"2\">");
  printf("</td></tr>");
  printf("<tr class=\"wol_main_tr\" height=\"5\"><td class=\"wol_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  printf("<tr class=\"wol_main_tr\" height=\"5\" style=\"border-top:1px #CCC solid;\"><td class=\"wol_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  printf("<tr class=\"wol_main_tr\" height=\"24\"><td class=\"wol_main_td\">");
  v8 = sub_126C4();
  v10 = sub_134F4(3, v9);
  printf(
    "<button type=\"button\" class=\"wol_main_button\" style=\"width:55px; margin-left:5px;\" onclick=\"AddPC(); return ClickEventPropagater(event);\">\t\t<span class=\"wol_main_span\"><img src=\"/%s/plus_icon.gif\" style=\"padding-right:4px;\">%s</span></button>",
    v8,
    v10);
  printf("</td><td class=\"wol_main_td\">");
  printf("</td><td class=\"wol_main_td\" align=\"right\">");
  printf("<span class=\"wol_main_span\"><font color=\"gray\">");
  v12 = sub_134F4(521, v11);
  printf((const char *)v12, 100);
  printf("</font></span>");
  printf("</td><td class=\"wol_main_td\">");
  printf("</td></tr>");
  printf("<tr class=\"wol_main_tr\" height=\"5\" style=\"border-bottom:1px #CCC solid;\"><td class=\"wol_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  v13 = printf("<tr class=\"wol_main_tr\" style=\"border-bottom:1px #CCC solid;\"><td class=\"wol_main_td\" colspan=\"4\">");
  if ( is_mobile_agent(v13) )
  {
    sub_12790((int)"384", (int)"100%%", (int)"display:inline-block; *display:inline; zoom:1;");
    v14 = printf("<iframe name=\"wollist_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=expertconfwollist\"                         frameborder=no width=100%% height=384 align=center scrolling=yes></iframe>");
    sub_12770(v14);
  }
  else
  {
    printf("<iframe name=\"wollist_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=expertconfwollist\"                         frameborder=no width=100%% height=384 align=center scrolling=yes></iframe>");
  }
  v15 = printf("</td></tr>");
  if ( is_mobile_agent(v15) )
  {
    sub_12790((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v16 = printf("<iframe name=\"hiddenmacsearch_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=expertconfmacsearch\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    sub_12770(v16);
  }
  else
  {
    printf("<iframe name=\"hiddenmacsearch_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=expertconfmacsearch\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  puts("</form>");
  printf("</table>");
  printf("<script>");
  printf("init_wolmain();");
  return printf("</script>");
}
// EB70: using guessed type int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD);
// F74C: using guessed type int __fastcall is_mobile_agent(_DWORD);

//----- (00038FDC) --------------------------------------------------------
int sub_38FDC()
{
  _UNKNOWN *v0; // r0@1

  sub_133E4((int)"expertconf", (int)"remotepc");
  sub_38B48();
  sub_38CE4();
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v0 = sub_126C4();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v0);
  printf("</SPAN></td>");
  printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"wol_div_msg\">\n");
  printf("</SPAN></td>");
  printf((const char *)&unk_60F0E);
  printf("<DIV id=\"%s\" style=\"display:none;\">", "macsearch_mask");
  printf(
    "<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\"                 onclick=\"UnMaskIt(document,'%s');\">\n",
    "macsearch_mask");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:151px; top:128px; width:340px; height:210px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888; overflow:hidden;\" id=\"searchmaclist\">");
  return printf((const char *)&unk_60F1B);
}

//----- (000390EC) --------------------------------------------------------
int __fastcall sub_390EC(int a1, int a2)
{
  int v2; // r6@1
  char *v3; // r0@6
  int v4; // r5@9
  int v5; // r0@11
  bool v6; // zf@11
  int v7; // r5@16
  int v8; // r0@18
  int v9; // r0@20
  signed int v10; // r5@20
  int v11; // r1@20
  int v12; // r1@20
  int v13; // r0@20
  int v14; // r1@20
  int v15; // r0@20
  _UNKNOWN *v16; // r4@20
  int v17; // r1@20
  int v18; // r0@20
  _UNKNOWN *v19; // r4@20
  int v20; // r1@20
  int v21; // r0@20
  int v22; // r0@21
  signed int v23; // r2@21
  char *v24; // r1@21
  __int16 v26; // [sp+Eh] [bp-22Ah]@1
  __int16 v27; // [sp+8Eh] [bp-1AAh]@6
  char v28; // [sp+B7h] [bp-181h]@6
  char v29; // [sp+C7h] [bp-171h]@21
  char v30; // [sp+147h] [bp-F1h]@21
  char v31; // [sp+180h] [bp-B8h]@22
  char v32; // [sp+200h] [bp-38h]@1

  v2 = a2;
  memset(&v26, 0, 0xB9u);
  if ( get_value_post(v2, "act", &v32, 32) && !strcmp(&v32, "add") )
  {
    if ( ((int (*)(void))get_remotepc_num)() <= 99 )
    {
      get_value_post(v2, "pcname", &v26, 128);
      if ( check_unpermitted_chars(&v26) )
        strcpy((char *)&v26, "");
      get_hw_value_post(v2, "hw", &v27);
      get_value_post(v2, "service", &v28, 20);
      v3 = (char *)add_remotepc_config(&v26);
      goto LABEL_13;
    }
  }
  else
  {
    if ( get_value_post(v2, "act", &v32, 32) && !strcmp(&v32, "del") )
    {
      v4 = 0;
      while ( 1 )
      {
        v5 = get_value_array_post(v2, "delchk", v4++, &v32);
        v6 = v5 == 0;
        v3 = &v32;
        if ( v6 )
          break;
        remove_remotepc_config(&v32);
      }
LABEL_13:
      signal_save(v3);
      goto LABEL_20;
    }
    if ( get_value_post(v2, "act", &v32, 32) && !strcmp(&v32, "wake") )
    {
      v7 = 0;
      while ( 1 )
      {
        v8 = get_value_array_post(v2, "wakeupchk", v7++, &v32);
        if ( !v8 )
          break;
        send_wol_packet(&v32);
      }
    }
  }
LABEL_20:
  sub_38B48();
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"remotepc_wollist\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  v9 = printf("<input type=hidden name=smenu value=expertconfwollist>");
  v10 = 0;
  v11 = get_remotepc_num(v9) > 99;
  printf("<input type=\"hidden\" name=\"nomore\" value=\"%d\">", v11);
  printf("<table class=\"v3_table wol_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"30\"><COL width=\"180\"><COL width=\"290\"><COL width=\"67\"><COL width=\"45\"><COL width=\"30\">");
  printf("<tr height=\"24\" class=\"wol_main_tr\" style=\"background-color:#DBDBDB;\"><td class=\"wol_main_td\">");
  printf("</td><td class=\"wol_main_td\">");
  v13 = sub_134F4(512, v12);
  printf("<span class=\"wol_main_span\">%s</span>", v13);
  printf("</td><td class=\"wol_main_td\">");
  v15 = sub_134F4(213, v14);
  printf("<span class=\"wol_main_span\">%s</span>", v15);
  printf("</td><td class=\"wol_main_td\">");
  v16 = sub_126C4();
  v18 = sub_134F4(214, v17);
  printf(
    "<span class=\"wol_main_span\" style=\"cursor:pointer;\" onclick=\"parent.window.WakeUp();\">\t\t<img src=\"/%s/apscan.gif\" class=\"wol_main_span\" style=\"width:10px; height:10px;\">\t\t<span class=\"wol_main_span\">%s</span></span>",
    v16,
    v18);
  printf("</td><td class=\"wol_main_td\">");
  v19 = sub_126C4();
  v21 = sub_134F4(118, v20);
  printf(
    "<span class=\"wol_main_span\" style=\"cursor:pointer;\" onclick=\"parent.window.DeleteRemotePC();\">\t\t<img src=\"/%s/minus_icon.gif\" class=\"wol_main_span\" style=\"width:10px; height:10px;\">\t\t<span class=\"wol_main_span\">%s</span></span>",
    v19,
    v21);
  printf("</td><td class=\"wol_main_td\">");
  printf("</td></tr>");
  do
  {
    v22 = get_remotepc_config(v10, &v29);
    v23 = 128;
    v24 = &v30;
    if ( !v22 )
      break;
    sf_strncpy(&v31, &v30, 128);
    convert_mac(&v31);
    ++v10;
    printf("<tr height=\"24\" class=\"wol_main_tr\" style=\"background-color:#%s;\"><td class=\"wol_main_td\">");
    printf("<p class=\"wol_main_p\">%d</p>", v10);
    printf("</td><td class=\"wol_main_td\">");
    printf("<span class=\"wol_main_span\">%s</span>", &v31);
    printf("</td><td class=\"wol_main_td\">");
    printf("<span class=\"wol_main_span\">%s</span>", &v29);
    printf("</td><td class=\"wol_main_td\">");
    printf("<span class=\"wol_main_span\">\t\t\t<input type=\"checkbox\" name=\"wakeupchk\" value=\"%s\"></span>", &v30);
    printf("</td><td class=\"wol_main_td\">");
    printf("<span class=\"wol_main_span\">\t\t\t<input type=\"checkbox\" name=\"delchk\" value=\"%s\"></span>", &v30);
    printf("</td><td class=\"wol_main_td\">");
    printf("</td></tr>");
  }
  while ( v10 != 100 );
  while ( v10 <= 14 )
  {
    printf("<tr height=\"24\" class=\"wol_main_tr\" style=\"background-color:#%s;\"><td class=\"wol_main_td\" colspan=\"7\">");
    printf("</td></tr>");
    ++v10;
  }
  printf("</table>", v24, v23);
  printf("</form>");
  printf("</BODY>");
  return printf("<script>setTimeout(function(){UnMaskIt(parent.document,'apply_mask');}, 1000);</script>");
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EE10: using guessed type int __fastcall convert_mac(_DWORD);
// EFC0: using guessed type int __fastcall add_remotepc_config(_DWORD);
// F11C: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F674: using guessed type int __cdecl send_wol_packet(_DWORD);
// F7DC: using guessed type int __fastcall get_hw_value_post(_DWORD, _DWORD, _DWORD);
// F968: using guessed type int __cdecl remove_remotepc_config(_DWORD);
// F9BC: using guessed type int __fastcall get_value_array_post(_DWORD, _DWORD, _DWORD, _DWORD);
// FA4C: using guessed type int __fastcall get_remotepc_config(_DWORD, _DWORD);
// FDE8: using guessed type int __fastcall get_remotepc_num(_DWORD);

//----- (0003953C) --------------------------------------------------------
int __fastcall sub_3953C(int a1, int a2)
{
  int v2; // r4@1
  int v3; // r8@3
  int v4; // r7@3
  void *v5; // r10@3
  void *v6; // r6@3
  int v7; // r11@3
  int v8; // r9@5
  int v9; // r1@8
  int v10; // r0@8
  int v11; // r1@8
  int v12; // r0@8
  char *v13; // r3@11
  int v14; // r1@21
  int v15; // r0@21
  char v17; // [sp+4h] [bp-B4h]@5
  char v18; // [sp+30h] [bp-88h]@10
  char v19; // [sp+70h] [bp-48h]@2
  char v20; // [sp+80h] [bp-38h]@1

  v2 = a2;
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_macsearchiframe\">");
  printf("<input type=\"hidden\" name=\"tmenu\" value=\"iframe\">");
  printf("<input type=\"hidden\" name=\"smenu\" value=\"expertconfmacsearch\">");
  printf("<input type=\"hidden\" name=\"inputprefix\" value=\"\">");
  printf("<input type=\"hidden\" name=\"act\" value=\"\">");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  if ( get_value_post(v2, "act", &v20, 16) && get_value_post(v2, "inputprefix", &v19, 16) )
  {
    puts("function MakeMacAddrTable()");
    puts("{");
    puts("var obj = parent.document.getElementById('searchmaclist');");
    puts("var HTMLStr = '<div style=\\\"display:block; width:340px; height:24px;\\\">                        <table class=\\\"wol_main_table\\\" style=\\\"width:340px; height:24px;\\\">';");
    v3 = 0;
    v4 = 0;
    v5 = malloc(0xBC00u);
    memset(v5, 0, 0xBC00u);
    v6 = v5;
    v7 = get_hostinfo_from_arp("br0", 256, v5);
    while ( v3 < v7 )
    {
      if ( strcmp((const char *)v6 + 148, "00:00:00:00:00:00") )
      {
        convert_mac((char *)v6 + 148);
        v8 = dhcpd_get_dynamic_lease((char *)v6 + 128, &v17);
        if ( v8 )
          v8 = 1;
        if ( !v4 )
        {
          printf("HTMLStr += '<tr class=\\\"wol_main_tr\\\" height=\\\"24\\\">';");
          v10 = sub_134F4(783, v9);
          printf(
            "HTMLStr += '<td class=\\\"wol_main_td\\\"                                         style=\\\"width:169px; background-color:#EEEEEE; border:1px #ccc solid;\\\">                                        <span class=\\\"wol_main_span\\\" style=\\\"text-align:center; width:100%%;\\\">%s</span></td>';",
            v10);
          v12 = sub_134F4(782, v11);
          printf(
            "HTMLStr += '<td class=\\\"wol_main_td\\\"                                         style=\\\"width:169px; background-color:#EEEEEE; border:1px #ccc solid;\\\">                                        <span class=\\\"wol_main_span\\\" style=\\\"text-align:center; width:100%%;\\\">%s</span></td>';",
            v12);
          printf("HTMLStr += '</tr>';");
          printf("HTMLStr += '</table></div><div                         style=\\\"display:block; width:340px; max-height:186px; height:186px; overflow:auto; overflow-x:hidden; -ms-overflow-x:hidden;\\\">                                        <table class=\\\"wol_main_table\\\" style=\\\"width:340px;\\\">';");
        }
        if ( v8 && v18 )
          v13 = &v18;
        else
          v13 = "";
        printf(
          "HTMLStr += '<tr class=\\\"wol_main_tr\\\" height=\\\"24\\\" style=\"cursor:pointer;\"                                onclick=\\\"SelectMacFromPopup(\\'%s\\', \\'%s\\', \\'%s\\');\\\" \t\t\t\tonmouseover=\\\"ChangeToOverColor(this);\\\" onmouseout=\\\"ChangeToOutColor(this);\\\">';",
          &v19,
          (char *)v6 + 148,
          v13);
        printf(
          "HTMLStr += '<td class=\\\"wol_main_td\\\" style=\\\"border:1px #ccc solid;\\\">                                <span class=\\\"wol_main_span\\\" style=\\\"margin-left:5px; min-width:163px;\\\">%s</a></td>';",
          (char *)v6 + 148);
        if ( v8 && v18 )
          printf(
            "HTMLStr += '<td class=\\\"wol_main_td\\\" style=\\\"border:1px #ccc solid;\\\">                        \t        <span class=\\\"wol_main_span\\\" style=\\\"margin-left:5px; min-width:163px;\\\">%s(%s)</span></td>';",
            (char *)v6 + 128,
            &v18);
        else
          printf(
            "HTMLStr += '<td class=\\\"wol_main_td\\\" style=\\\"border:1px #ccc solid;\\\">                        \t        <span class=\\\"wol_main_span\\\" style=\\\"margin-left:5px; min-width:163px;\\\">%s</span></td>';",
            (char *)v6 + 128);
        ++v4;
        printf("HTMLStr += '</tr>';");
      }
      ++v3;
      v6 = (char *)v6 + 188;
    }
    if ( !v4 )
    {
      printf("HTMLStr += '<tr class=\\\"wol_main_tr\\\" height=\\\"24\\\">';");
      v15 = sub_134F4(784, v14);
      printf(
        "HTMLStr += '<td class=\\\"wol_main_td\\\" colspan=\\\"2\\\" style=\\\"background-color:#EEEEEE;\\\">                                <span class=\\\"wol_main_span\\\">%s</span></td>';",
        v15);
      printf("HTMLStr += '</tr>';");
    }
    free(v5);
    puts("HTMLStr += '</table></div>';");
    puts("obj.innerHTML = HTMLStr;");
    puts("}");
    printf("MakeMacAddrTable();");
  }
  return printf("</script>");
}
// EA20: using guessed type int __fastcall get_hostinfo_from_arp(_DWORD, _DWORD, _DWORD);
// EE10: using guessed type int __fastcall convert_mac(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F368: using guessed type int __fastcall dhcpd_get_dynamic_lease(_DWORD, _DWORD);

//----- (00039818) --------------------------------------------------------
_UNKNOWN *__fastcall sub_39818(const char *a1, int a2)
{
  const char *v2; // r4@1
  int v3; // r0@2
  int v4; // r1@37
  _UNKNOWN *v5; // r0@37

  v2 = a1;
  if ( *a1 )
  {
    if ( !strcmp(a1, "SUCCESS") )
    {
      v3 = 164;
    }
    else if ( !strcmp(v2, "CONN_FAIL") )
    {
      v3 = 154;
    }
    else if ( !strcmp(v2, "BLOCKED") )
    {
      v3 = 153;
    }
    else if ( !strcmp(v2, "BAD_AUTH") )
    {
      v3 = 152;
    }
    else if ( !strcmp(v2, "PARAMETER_INVALID") )
    {
      v3 = 162;
    }
    else if ( !strcmp(v2, "DOMAIN_NOT_SUPPORTED") )
    {
      v3 = 157;
    }
    else if ( !strcmp(v2, "HOSTNAME_NOT_EXIST") )
    {
      v3 = 159;
    }
    else if ( !strcmp(v2, "USER_IS_NOT_A_DONATOR") )
    {
      v3 = 168;
    }
    else if ( !strcmp(v2, "NOT_YOURS") )
    {
      v3 = 160;
    }
    else if ( !strcmp(v2, "CUSTOM_DNS_NOT_ACT") )
    {
      v3 = 155;
    }
    else if ( !strcmp(v2, "HOSTNAME_IS_BLOCKED_BY_ABUSE") )
    {
      v3 = 158;
    }
    else if ( !strcmp(v2, "TOO_MANY_OR_FEW") )
    {
      v3 = 165;
    }
    else if ( !strcmp(v2, "DDNS_ERROR") )
    {
      v3 = 156;
    }
    else if ( !strcmp(v2, "SERVER_SHUTDOWN") )
    {
      v3 = 163;
    }
    else if ( !strcmp(v2, "ONLY_ONE_DOMAIN") )
    {
      v3 = 161;
    }
    else if ( !strcmp(v2, (const char *)&unk_825C6) )
    {
      v3 = 167;
    }
    else
    {
      if ( strcmp(v2, "FORGET_MYINFO") )
      {
        v4 = sub_134F4(166, a2);
        v5 = &unk_986DC;
        goto LABEL_39;
      }
      v3 = 171;
    }
  }
  else
  {
    v3 = 166;
  }
  v4 = sub_134F4(v3, a2);
  v5 = &unk_986DC;
LABEL_39:
  sf_strncpy(v5, v4, 64);
  return &unk_986DC;
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);

//----- (00039A40) --------------------------------------------------------
int __fastcall sub_39A40(int a1, int a2, int a3)
{
  int v3; // r6@1
  int v4; // r4@1
  int v5; // r5@1
  int v6; // r0@1
  int v7; // r1@1
  int v8; // r0@2
  char *v9; // r1@2
  int v10; // r0@7

  v3 = a2;
  v4 = a1;
  v5 = a3;
  v6 = strcmp((const char *)(a1 + 28), "SUCCESS");
  if ( v6 )
  {
    v8 = v3;
    v9 = "-";
  }
  else
  {
    if ( v5 )
      v6 = *(_DWORD *)(v4 + 20);
    else
      v7 = 2;
    if ( v5 )
    {
      v10 = v6 + 1425408;
      v7 = 2;
    }
    else
    {
      v10 = *(_DWORD *)(v4 + 20);
    }
    if ( v5 )
      v10 += 14592;
    v9 = (char *)sub_12BF8(v10, v7);
    v8 = v3;
  }
  return sf_strncpy(v8, v9, 128);
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);

//----- (00039AA8) --------------------------------------------------------
int sub_39AA8()
{
  int v0; // r6@1
  int v1; // r0@4
  char *v2; // r1@5
  int v3; // r1@9
  int v4; // r0@9
  int v5; // r1@9
  int v6; // r0@9
  int v7; // r1@9
  int v8; // r0@9
  int v9; // r0@9
  int v10; // r1@9
  const char *v11; // r0@10
  int v12; // r0@11
  int v13; // r1@11
  int v14; // r0@11
  int v15; // r1@11
  int v16; // r0@11
  int v17; // r0@12
  int v18; // r1@13
  int v19; // r0@13
  _UNKNOWN *v20; // r4@14
  int v21; // r1@14
  int v22; // r0@14
  int v23; // r1@14
  int v24; // r4@14
  int v25; // r1@14
  int v26; // r0@14
  int v27; // r1@14
  int v28; // r0@14
  int v29; // r1@14
  int v30; // r0@14
  char *v31; // r1@15
  int v32; // r1@19
  char *v33; // r0@20
  int v34; // r1@22
  int v35; // r0@22
  char *v36; // r1@23
  int v37; // r1@27
  int v38; // r0@27
  char *v39; // r1@28
  int v40; // r1@32
  int v41; // r0@32
  char *v42; // r1@33
  int v43; // r1@35
  int v44; // r0@35
  char *v45; // r1@36
  char *v46; // r5@40
  _UNKNOWN *v47; // r4@42
  int v48; // r1@42
  int v49; // r0@42
  _UNKNOWN *v50; // r4@42
  int v51; // r1@42
  int v52; // r0@42
  int v53; // r0@42
  int v54; // r0@43
  int v55; // r0@43
  int v56; // r0@46
  _UNKNOWN *v57; // r0@48
  int v59; // [sp+4h] [bp-64Ch]@1
  int v60; // [sp+28h] [bp-628h]@2
  char v61; // [sp+30h] [bp-620h]@5
  char v62; // [sp+420h] [bp-230h]@23
  int v63; // [sp+504h] [bp-14Ch]@34
  char v64; // [sp+580h] [bp-D0h]@28
  int v65; // [sp+584h] [bp-CCh]@1
  char s1; // [sp+5A0h] [bp-B0h]@3
  char v67; // [sp+5E0h] [bp-70h]@13
  char v68; // [sp+620h] [bp-30h]@13

  memset(&v65, 0, 0x5Cu);
  memset(&v59, 0, 0x500u);
  v0 = ddnsapi_read_config_by_service_type(0, "iptime", &v59);
  if ( v0 )
  {
    ddnsapi_get_status(&v60, &v65);
    if ( ddnsapi_get_refresh_flag(&v60) )
      sf_strncpy(&s1, "", 64);
  }
  printf("<table class=\"v3_table ddns_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<tr class=\"ddns_main_tr\"><td class=\"ddns_main_td\">");
  puts("<form method=post action=timepro.cgi name=dyndns_conf style=\"margin:0; padding:0;\">");
  puts("<input type=hidden name=tmenu value=expertconf>");
  puts("<input type=hidden name=smenu value=ddns>");
  puts("<input type=hidden name=act value=>");
  v1 = ddnsapi_get_host_count("iptime");
  printf("<input type=hidden name=iptimecnt value=%d>\n", v1);
  if ( v0 )
    v2 = &v61;
  else
    v2 = "";
  if ( v0 )
    v2 -= 8;
  printf("<input type=\"hidden\" name=\"refhostname\" value=\"%s\">", v2);
  printf("<table class=\"v3_table ddns_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"321\"><COL width=\"321\">");
  printf("<tr class=\"ddns_main_tr\" height=\"96\"><td class=\"ddns_main_td\">");
  printf("<table class=\"v3_table ddns_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"100\"><COL width=\"145\"><COL width=\"76\">");
  printf("<tr class=\"ddns_main_tr\" height=\"24\"><td class=\"ddns_main_td\">");
  printf("<p class=\"ddns_main_p\">");
  v4 = sub_134F4(181, v3);
  printf("%s", v4);
  printf("</p>");
  printf("</td>");
  printf("<td class=\"ddns_main_td\">");
  printf("<input type=\"hidden\" name=\"select_ddns\" value=\"iptime_null\">");
  printf("<input type=\"text\" value=\"ipTIME DDNS\" style=\"width:140px;\" disabled>");
  printf("</td>");
  printf("<td class=\"ddns_main_td\">");
  printf("</td>");
  printf("</tr>");
  printf("<tr class=\"ddns_main_tr\" height=\"24\"><td class=\"ddns_main_td\">");
  printf("<p class=\"ddns_main_p\">");
  v6 = sub_134F4(173, v5);
  printf("%s", v6);
  printf("</p>");
  printf("</td>");
  printf("<td class=\"ddns_main_td\">");
  printf("<input type=\"text\" name=\"hostname\" size=\"32\" maxlength=\"50\" style=\"width:140px; ime-mode:disabled;\">");
  printf("</td>");
  printf("<td class=\"ddns_main_td\">");
  printf("<span class=\"ddns_main_span\">.iptime.org</span>");
  printf("</td>");
  printf("</tr>");
  printf("<tr class=\"ddns_main_tr\" height=\"24\"><td class=\"ddns_main_td\">");
  printf("<p class=\"ddns_main_p\">");
  v8 = sub_134F4(115, v7);
  printf("%s", v8);
  printf("</p>");
  printf("</td>");
  printf("<td class=\"ddns_main_td\">");
  printf("<input type=\"text\" name=\"userid\" size=\"20\" maxlength=\"32\" style=\"width:140px; ime-mode:disabled;\">");
  printf("</td>");
  printf("<td class=\"ddns_main_td\">");
  printf("</td>");
  v9 = printf("</tr>");
  if ( check_valid_account(v9) )
  {
    v11 = "<tr class=\"ddns_main_tr\" height=\"24\"><td class=\"ddns_main_td\" colspan=\"2\"></td></tr>";
  }
  else
  {
    v12 = sub_134F4(176, v10);
    printf("<input type=hidden name=default_captcha_desc value='%s'>\n", v12);
    puts("<input type=hidden name=captcha_file value=>");
    v14 = sub_134F4(206, v13);
    printf(
      "<tr class=\"ddns_main_tr\" height=\"24\"><td class=\"ddns_main_td\"><p class=\"ddns_main_p\">%s</p></td>",
      v14);
    printf("<td class=\"ddns_main_td\" colspan=\"2\">");
    v16 = sub_134F4(176, v15);
    printf(
      "<input type=text name=captcha_code maxlength=\"5\" STYLE=\"width:205px; height:21px; color:#888888;\" value=\"%s\"                         onfocus=\"FocusCaptcha(document.dyndns_conf);\" onblur=\"BlurCaptcha(document.dyndns_conf);\">",
      v16);
    v11 = "</td></tr>";
  }
  printf(v11);
  printf("</table>");
  v17 = printf("</td><td class=\"ddns_main_td\">");
  if ( !check_valid_account(v17) )
  {
    get_http_auth_method(&v67);
    get_ux_lang(&v68);
    puts("<table class=\"v3_table ddns_main_table\" width=\"321\" height=\"96\">");
    printf("<COL width=\"291\"><COL width=\"30\">");
    printf("<tr class=\"ddns_main_tr\"><td class=\"ddns_main_td\">");
    puts("<table class=\"v3_table ddns_main_table\" width=\"254\" height=\"96\">");
    printf("<COL width=\"90\"><COL width=\"201\">");
    printf((const char *)&unk_82B91);
    v19 = sub_134F4(206, v18);
    printf("<p class=\"ddns_main_p\">%s</p>", v19);
    printf("</td></tr>");
    printf(
      "<tr class=\"ddns_main_tr\"                         style=\"font: normal normal normal 12px arial; color:#000000; border:#C6C9CC 1px solid; background-color:#FFFFFF;\" height=\"72\">                        <td class=\"ddns_main_td\" style=\"cursor:pointer; background-color:#FAFAFA; border:0;\"                         onclick=\"iframe_captcha.location.reload();\">                        <img src=\"/images2/captcha_noborder.%s.gif\" style=\"border:0; margin-left:18px;\"></td>\n",
      &v68);
    strcmp(&v67, "session");
    printf("<td class=\"ddns_main_td\" style=\"border-left:1px #CCC solid;\">                        <iframe name=iframe_captcha id=iframe_captcha src=\"/%s/captcha.cgi\" width=\"200\" height=\"72\"                         frameborder=no scrolling=no></iframe>                        </td></tr>\n");
    printf("</table>");
    printf("</td><td class=\"ddns_main_td\"></td></tr></table>");
  }
  printf("</td>");
  printf("</tr>");
  printf("<tr class=\"ddns_main_tr\" height=\"10\" style=\"border-bottom:1px #ccc solid;\"><td class=\"ddns_main_td\" colspan=\"2\"></td></tr>");
  printf("<tr class=\"ddns_main_tr\"><td class=\"ddns_main_td\" colspan=\"2\">");
  printf("<table class=\"v3_table ddns_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"100\"><COL width=\"512\"><COL width=\"30\">");
  printf("<tr class=\"ddns_main_tr\" height=\"48\"><td class=\"ddns_main_td\">");
  v20 = sub_126C4();
  v22 = sub_134F4(205, v21);
  printf((const char *)&unk_83050, v20, v22);
  printf("</td><td class=\"ddns_main_td\" align=\"right\">");
  v24 = sub_134F4(189, v23);
  v26 = sub_134F4(190, v25);
  printf(
    "<p style=\"display:block; padding:0; margin:0;\"><font color=\"gray\">%s</font></p>\t\t<p style=\"display:block; padding:0; margin:0;\"><font color=\"gray\">%s</font></p>",
    v24,
    v26);
  printf("</td><td class=\"ddns_main_td\"></td></tr>");
  printf("</table");
  printf("</td></tr>");
  printf("<tr class=\"ddns_main_tr\"><td class=\"ddns_main_td\" colspan=\"2\">");
  printf("<table class=\"v3_table ddns_main_table\" id=\"STATTABLE\" style=\"%s\">");
  printf("<COL width=\"190\"><COL width=\"272\"><COL width=\"180\">");
  printf("<tr height=\"24\" class=\"ddns_main_tr\"><td class=\"ddns_main_td\">");
  v28 = sub_134F4(173, v27);
  printf("<p class=\"ddns_main_p\">%s</p>", v28);
  printf("</td><td class=\"ddns_main_td\" colspan=\"2\">");
  v30 = sub_134F4(169, v29);
  printf("<span class=\"ddns_main_span\">%s</span>", v30);
  printf("</td></tr>");
  printf("<tr height=\"24\" class=\"ddns_main_tr\" style=\"background-color:#FFFFFF;\"><td class=\"ddns_main_td\">");
  if ( v0 )
    v31 = &v61;
  else
    v31 = "";
  if ( v0 )
    v31 -= 8;
  printf((const char *)&unk_833C1, v31);
  printf("</td><td class=\"ddns_main_td\" colspan=\"2\">");
  if ( v0 )
    v33 = (char *)sub_39818(&s1, v32);
  else
    v33 = "";
  printf("<span class=\"ddns_main_span\" id=\"CONNSTATUSVAL\">%s</span>", v33);
  printf("</td></tr>");
  printf("<tr height=\"24\" class=\"ddns_main_tr\" style=\"border-top:1px #ccc solid;\"><td class=\"ddns_main_td\">");
  v35 = sub_134F4(115, v34);
  printf("<p class=\"ddns_main_p\">%s</p>", v35);
  printf("</td><td class=\"ddns_main_td\" colspan=\"2\">");
  if ( v0 )
    v36 = &v62;
  else
    v36 = "";
  if ( v0 )
    v36 += 8;
  printf("<span class=\"ddns_main_span\" id=\"IDVAL\">%s</span>", v36);
  printf("</td></tr>");
  printf("<tr height=\"24\" class=\"ddns_main_tr\"><td class=\"ddns_main_td\">");
  v38 = sub_134F4(210, v37);
  printf("<p class=\"ddns_main_p\">%s</p>", v38);
  printf("</td><td class=\"ddns_main_td\" colspan=\"2\">");
  if ( v0 )
    v39 = &v64;
  else
    v39 = "";
  if ( v0 )
    v39 += 8;
  printf("<span class=\"ddns_main_span\" id=\"IPADDRVAL\">%s</span>", v39);
  printf("</td></tr>");
  printf("<tr height=\"24\" class=\"ddns_main_tr\"><td class=\"ddns_main_td\">");
  v41 = sub_134F4(211, v40);
  printf("<p class=\"ddns_main_p\">%s</p>", v41);
  printf("</td><td class=\"ddns_main_td\" colspan=\"2\">");
  if ( v0 )
  {
    sub_39A40((int)&v65, (int)&v63, 0);
    v42 = (char *)&v63;
  }
  else
  {
    v42 = "";
  }
  printf("<span class=\"ddns_main_span\" id=\"LASTVAL\">%s</span>", v42);
  printf("</td></tr>");
  printf("<tr height=\"24\" class=\"ddns_main_tr\" style=\"border-bottom:1px #ccc solid;\"><td class=\"ddns_main_td\">");
  v44 = sub_134F4(212, v43);
  printf("<p class=\"ddns_main_p\">%s</p>", v44);
  printf("</td><td class=\"ddns_main_td\">");
  if ( v0 )
  {
    sub_39A40((int)&v65, (int)&v63, 1);
    v45 = (char *)&v63;
  }
  else
  {
    v45 = "";
  }
  printf("<span class=\"ddns_main_span\" id=\"NEXTVAL\">%s</span>", v45);
  printf("</td><td class=\"ddns_main_td\" align=\"right\">");
  if ( v0 && !strcmp(&s1, "SUCCESS") )
    v46 = "";
  else
    v46 = "display:none;";
  v47 = sub_126C4();
  v49 = sub_134F4(1128, v48);
  printf(
    "<button class=\"ddns_main_button\" style=\"margin-right:10px; width:60px; %s\" id=\"ref_bt\" onclick=\"RefreshHost(); return ClickEventPropagater(event);\">\t\t<img src=\"/%s/apscan.gif\" style=\"width:8px; height:8px;\" class=\"ddns_main_span\">\t\t<span class=\"ddns_main_span\">%s</span></button>",
    v46,
    v47,
    v49);
  v50 = sub_126C4();
  v52 = sub_134F4(118, v51);
  printf(
    "<button class=\"ddns_main_button\" style=\"margin-right:30px; width:60px;\" id=\"del_bt\" onclick=\"DelHost(); return ClickEventPropagater(event);\">\t\t<img src=\"/%s/minus_icon.gif\" style=\"width:8px; height:8px;\" class=\"ddns_main_span\">\t\t<span class=\"ddns_main_span\">%s</span></button>",
    v50,
    v52);
  printf("</td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("</table>");
  printf("</form>");
  printf("</td></tr>");
  v53 = printf("</table>");
  if ( is_mobile_agent(v53) )
  {
    sub_12790((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v54 = printf("<iframe name=\"hiddenddnsstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenddnsstatus\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    v55 = sub_12770(v54);
  }
  else
  {
    v55 = printf("<iframe name=\"hiddenddnsstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenddnsstatus\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  if ( is_mobile_agent(v55) )
  {
    sub_12790((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v56 = printf("<iframe name=\"hiddenddnssetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenddnssetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    sub_12770(v56);
  }
  else
  {
    printf("<iframe name=\"hiddenddnssetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenddnssetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  printf("<script> InitDDNS();</script>");
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v57 = sub_126C4();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v57);
  printf("</SPAN></td>");
  printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"ddns_div_msg\">\n");
  printf("</SPAN></td>");
  printf((const char *)&unk_60F0E);
  printf("<DIV id=\"setup_mask\" style=\"%s\">");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:154px; z-index:1; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  return printf((const char *)&unk_60F1B);
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E9A8: using guessed type int __fastcall ddnsapi_get_refresh_flag(_DWORD);
// E9E4: using guessed type int __fastcall get_http_auth_method(_DWORD);
// EF60: using guessed type int __fastcall check_valid_account(_DWORD);
// F5C0: using guessed type int __fastcall ddnsapi_get_host_count(_DWORD);
// F710: using guessed type int __fastcall ddnsapi_read_config_by_service_type(_DWORD, _DWORD, _DWORD);
// F74C: using guessed type int __fastcall is_mobile_agent(_DWORD);
// FA28: using guessed type int __fastcall ddnsapi_get_status(_DWORD, _DWORD);
// FBF0: using guessed type int __fastcall get_ux_lang(_DWORD);

//----- (0003A3D0) --------------------------------------------------------
int sub_3A3D0()
{
  sub_133E4((int)"expertconf", (int)"ddns");
  puts("<style type=\"text/css\">");
  puts(".ddns_main_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".ddns_main_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".ddns_main_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".ddns_main_p {");
  puts("\tpadding-left:5px; display:inline-block;");
  puts("\tvertical-align:middle; margin:0;");
  puts("}");
  puts(".ddns_main_span {");
  puts("\tdisplay:inline-block; vertical-align:middle;");
  puts("}");
  puts(".ddns_main_button {");
  puts("\tpadding:0 1 0 1; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".ddns_main_td input[type=checkbox], .ddns_main_td input[type=radio] {");
  puts("display:inline-block; vertical-align:middle;");
  puts("}");
  puts("#ddns_div_msg p {");
  puts("margin:5 0 5 15px; text-align:left;");
  puts("}");
  puts(".ddns_ellipsis {");
  puts("text-overflow:ellipsis; overflow:hidden; white-space:nowrap; text-align:left;");
  puts("}");
  printf("input[type=\"text\"] {border:1px #CCC solid;}");
  printf("input[type=\"password\"] {border:1px #CCC solid;}");
  printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td {cursor:default;}");
  printf("</style>");
  return sub_39AA8();
}

//----- (0003A584) --------------------------------------------------------
int sub_3A584()
{
  int v0; // r6@1
  int v1; // r1@5
  _UNKNOWN *v2; // r0@5
  char *v3; // r4@5
  int v4; // r2@9
  int v6; // [sp+4h] [bp-5F4h]@1
  int v7; // [sp+28h] [bp-5D0h]@2
  int v8; // [sp+428h] [bp-1D0h]@11
  int v9; // [sp+504h] [bp-F4h]@7
  int v10; // [sp+584h] [bp-74h]@1
  int v11; // [sp+588h] [bp-70h]@5
  int v12; // [sp+5A0h] [bp-58h]@3

  memset(&v10, 0, 0x5Cu);
  memset(&v6, 0, 0x500u);
  v0 = ddnsapi_read_config_by_service_type(0, "iptime", &v6);
  if ( v0 )
  {
    ddnsapi_get_status(&v7, &v10);
    if ( ddnsapi_get_refresh_flag(&v7) )
      sf_strncpy(&v12, "", 64);
  }
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_hiddenddnsstatus\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=hiddenddnsstatus>");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  if ( v0 )
  {
    printf("parent.window.update_status_ddns(true, '%s',", &v7);
    v2 = sub_39818((const char *)&v12, v1);
    v3 = (char *)&v11;
    printf("'%s', ", v2);
    if ( !strcmp((const char *)&v11, "0.0.0.0") )
      v3 = "-";
    printf("'%s', ", v3);
    sub_39A40((int)&v10, (int)&v9, 0);
    printf("'%s', ", &v9);
    sub_39A40((int)&v10, (int)&v9, 1);
    printf("'%s', ", &v9);
    if ( !strcmp((const char *)&v12, "SUCCESS") || !strcmp((const char *)&v12, "CONN_FAIL") )
      v4 = (int)"true";
    else
      v4 = (int)"false";
    printf("'%s', %s);", &v8, v4);
  }
  else
  {
    printf("parent.window.update_status_ddns(false);");
  }
  printf("setTimeout(function(){document.expertconf_hiddenddnsstatus.submit();}, 3000);");
  return printf("</script>");
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E9A8: using guessed type int __fastcall ddnsapi_get_refresh_flag(_DWORD);
// F710: using guessed type int __fastcall ddnsapi_read_config_by_service_type(_DWORD, _DWORD, _DWORD);
// FA28: using guessed type int __fastcall ddnsapi_get_status(_DWORD, _DWORD);

//----- (0003A8B8) --------------------------------------------------------
BOOL __fastcall sub_3A8B8(int a1)
{
  char v2; // [sp+4h] [bp-64h]@1
  int v3; // [sp+18h] [bp-50h]@1

  ddnsapi_get_status(a1, &v2);
  return time(0) - v3 <= 2;
}
// FA28: using guessed type int __fastcall ddnsapi_get_status(_DWORD, _DWORD);

//----- (0003A8EC) --------------------------------------------------------
signed int __fastcall sub_3A8EC(int a1)
{
  int v1; // r6@1
  void *v3; // r0@4
  int v4; // r0@7
  int v5; // r0@9
  char *v6; // r1@10
  char *v7; // r0@12
  char *v8; // r4@12
  int v9; // r0@21
  int v10; // r1@24
  int v11; // r0@30
  int v12; // r0@32
  bool v13; // zf@33
  signed int v14; // r4@37
  int *v15; // r4@41
  char *i; // r7@41
  int v17; // lr@42
  int v18; // r2@42
  int v19; // r3@43
  unsigned int v20; // r3@46
  unsigned int v21; // r5@46
  unsigned int v22; // r12@46
  int v23; // r6@52
  int v24; // r4@53
  int v25; // r5@53
  int v26; // r2@54
  bool v27; // nf@55
  unsigned __int8 v28; // vf@55
  char *v29; // r0@55
  int v30; // r0@58
  int v31; // r0@61
  int v32; // [sp+4h] [bp-14BCh]@0
  int v33; // [sp+Ch] [bp-14B4h]@4
  int v34; // [sp+10h] [bp-14B0h]@11
  int v35; // [sp+30h] [bp-1490h]@6
  int v36; // [sp+430h] [bp-1090h]@6
  int v37; // [sp+470h] [bp-1050h]@19
  char v38; // [sp+4B0h] [bp-1010h]@14
  char v39; // [sp+4F0h] [bp-FD0h]@10
  _BYTE v40[3]; // [sp+50Dh] [bp-FB3h]@53
  _BYTE v41[3]; // [sp+90Dh] [bp-BB3h]@56
  _BYTE v42[3]; // [sp+D0Dh] [bp-7B3h]@55
  _BYTE v43[3]; // [sp+110Dh] [bp-3B3h]@41
  _BYTE v44[3]; // [sp+130Dh] [bp-1B3h]@41
  _BYTE v45[3]; // [sp+138Dh] [bp-133h]@10
  _BYTE v46[3]; // [sp+140Dh] [bp-B3h]@26
  _BYTE v47[3]; // [sp+142Dh] [bp-93h]@41
  _BYTE v48[3]; // [sp+144Dh] [bp-73h]@1
  _BYTE v49[3]; // [sp+146Dh] [bp-53h]@35
  _BYTE v50[3]; // [sp+1481h] [bp-3Fh]@35
  _BYTE v51[3]; // [sp+1495h] [bp-2Bh]@26
  _BYTE v52[3]; // [sp+14A5h] [bp-1Bh]@43

  v1 = a1;
  if ( !get_value_post(a1, "act", v48, 32) )
    return -1;
  if ( !strcmp(v48, "addhost") )
  {
    v3 = memset(&v33, 0, 0x500u);
    if ( !check_valid_account(v3) && !sub_13298(v1) )
    {
      get_value_post(v1, "hostname", &v35, 1024);
      get_value_post(v1, "userid", &v36, 64);
      printf("if(parent.window.resetInputForm)parent.window.resetInputForm('%s','%s');\n", &v35, &v36);
      return 0;
    }
    v4 = get_value_post(v1, "hostname", &v35, 1024);
    if ( !v4 )
      goto LABEL_63;
    if ( !sub_13180((const char *)&v35) )
      return 0;
    LOBYTE(v5) = sub_3A8B8((int)&v35);
    if ( v5 )
      return 0;
    get_value_post(v1, &unk_83D89, v45, 128);
    strcpy(&v39, "wan1");
    v6 = strtok(v45, "_");
    if ( v6 )
      sf_strncpy(&v34, v6, 32);
    v7 = strtok(0, "");
    v8 = v7;
    if ( v7 && strcmp(v7, "null") )
      sf_strncpy(&v38, v8, 64);
    if ( !strcmp((const char *)&v34, "iptime") && sub_131E0(0) )
      return 0;
    get_value_post(v1, "userid", &v36, 64);
    if ( check_unpermitted_chars(&v36) )
      return 0;
    if ( !strcmp((const char *)&v34, "iptime") )
      strcpy((char *)&v37, "iptime");
    else
      get_value_post(v1, "passwd", &v37, 64);
    v9 = ddnsapi_add_config(&v33);
LABEL_57:
    v4 = signal_save(v9);
LABEL_63:
    signal_update(v4);
    sleep(3u);
    return 0;
  }
  if ( strcmp(v48, "delhost") )
  {
    v4 = strcmp(v48, "refreshhost");
    if ( !v4 )
    {
      if ( !get_value_post(v1, &unk_83D9D, v45, 128) )
        return 0;
      LOBYTE(v31) = sub_3A8B8((int)v45);
      if ( v31 )
        return 0;
      v4 = ddnsapi_set_refresh_flag(v45, 1);
    }
    goto LABEL_63;
  }
  if ( get_value_post(v1, &unk_83D9D, v45, 128) )
  {
    memset(&v33, 0, 0x500u);
    ddnsapi_read_config_by_service_type(0, "iptime", &v33);
    if ( strcmp(v45, (const char *)&v35) || !sub_13180((const char *)&v35) )
    {
LABEL_58:
      v30 = sub_134F4(170, v10);
      printf("alert('%s');\n", v30);
      return 0;
    }
    get_wan_hw_ifname("wan1", v46);
    get_wan_type("wan1", v51);
    if ( !strcmp(v51, "pppoe") || !strcmp(v51, "pptp") )
    {
      if ( get_idle_timeout(v46) )
        goto LABEL_38;
      if ( !get_wansetup_status("wan1") )
        goto LABEL_38;
      v11 = get_pppoe_status("wan1");
      if ( !v11 )
        goto LABEL_38;
      if ( v11 != 4 )
      {
        v13 = v11 == 6;
        goto LABEL_36;
      }
      v12 = (int)"ppp1";
    }
    else
    {
      v12 = (int)v46;
    }
    get_ifconfig(v12, v50, v49);
    v13 = v50[0] == 0;
LABEL_36:
    if ( !v13 )
    {
      v14 = 0;
LABEL_39:
      if ( get_wan_link("wan1") && !v14 )
      {
        get_random_str(v47, 32);
        v15 = (int *)v43;
        snprintf2(v43, 512, (const char *)&unk_83DA9, &v36);
        for ( i = v44; ; i += 4 )
        {
          v23 = *(_BYTE *)v15;
          if ( !*(_BYTE *)v15 )
            break;
          v17 = 0;
          v18 = 0;
          do
          {
            v19 = *(_BYTE *)v15;
            v52[v18++] = v19;
            if ( v19 )
            {
              ++v17;
              v15 = (int *)((char *)v15 + 1);
            }
          }
          while ( v18 != 3 );
          v20 = ((unsigned int)(unsigned __int8)v52[1] >> 4) | 16 * (v52[0] & 3);
          v21 = ((unsigned int)(unsigned __int8)v52[2] >> 6) | 4 * (v52[1] & 0xF);
          v22 = (unsigned int)(unsigned __int8)v52[0] >> 2;
          if ( v17 == 1 )
          {
            sprintf(i, "%c%c==", (unsigned __int8)aAbcdefghijklmn[v22], (unsigned __int8)aAbcdefghijklmn[v20]);
          }
          else if ( v17 == 2 )
          {
            sprintf(
              i,
              "%c%c%c=",
              (unsigned __int8)aAbcdefghijklmn[v22],
              (unsigned __int8)aAbcdefghijklmn[v20],
              (unsigned __int8)aAbcdefghijklmn[v21],
              v32);
          }
          else
          {
            sprintf(
              i,
              "%c%c%c%c",
              (unsigned __int8)aAbcdefghijklmn[v22],
              (unsigned __int8)aAbcdefghijklmn[v20],
              (unsigned __int8)aAbcdefghijklmn[v21],
              (unsigned __int8)aAbcdefghijklmn[v52[2] & 0x3F]);
          }
        }
        *i = v23;
        snprintf2(v43, 512, "rv=%s&domain=%s&userinfo=%s", v47, &v35, v44);
        memset(v40, v23, 0x400u);
        v24 = v23;
        strlen(v43);
        v25 = 2 * encode_crypt(v43, v40, 10, v23);
        while ( 1 )
        {
          v28 = __OFSUB__(v24, v25);
          v27 = v24 - v25 < 0;
          v29 = &v42[v24];
          v24 += 2;
          if ( !(v27 ^ v28) )
            break;
          v26 = v40[v23++];
          sprintf(v29, "%02x", v26);
        }
        snprintf2(
          v41,
          1024,
          "/usr/bin/wget 'http://members.iptime.org/ipcloud/iptimeddns_unregister.php?action=delete&content=%s' -q -O %s");
        system(v41);
        v9 = ddnsapi_remove_host(&v35);
        goto LABEL_57;
      }
      goto LABEL_58;
    }
LABEL_38:
    v14 = 1;
    goto LABEL_39;
  }
  return 0;
}
// E858: using guessed type int __fastcall get_wansetup_status(_DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E96C: using guessed type int __fastcall get_wan_type(_DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EB4C: using guessed type int __fastcall ddnsapi_remove_host(_DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EEAC: using guessed type int __fastcall get_idle_timeout(_DWORD);
// EF60: using guessed type int __fastcall check_valid_account(_DWORD);
// F008: using guessed type int __fastcall get_wan_link(_DWORD);
// F068: using guessed type int __fastcall ddnsapi_add_config(_DWORD);
// F0F8: using guessed type int __fastcall get_wan_hw_ifname(_DWORD, _DWORD);
// F11C: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F5D8: using guessed type int __fastcall get_random_str(_DWORD, _DWORD);
// F710: using guessed type int __fastcall ddnsapi_read_config_by_service_type(_DWORD, _DWORD, _DWORD);
// FCA4: using guessed type int __fastcall ddnsapi_set_refresh_flag(_DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);
// FD1C: using guessed type int __fastcall encode_crypt(_DWORD, _DWORD, _DWORD, _DWORD);
// FE00: using guessed type int __fastcall get_pppoe_status(_DWORD);

//----- (0003AFD4) --------------------------------------------------------
int __fastcall sub_3AFD4(int a1, int a2)
{
  int v2; // r4@1

  v2 = a2;
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_hiddenddnssetup\">");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  sub_3A8EC(v2);
  printf("UnMaskIt(parent.document, 'apply_mask');");
  return printf("</script>");
}

//----- (0003B03C) --------------------------------------------------------
int sub_3B03C()
{
  puts("<style type=\"text/css\">");
  puts(".pptpvpn_main_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".pptpvpn_main_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".pptpvpn_main_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pptpvpn_main_p {");
  puts("\tpadding-left:5px; display:inline-block;");
  puts("\tvertical-align:middle; margin:0;");
  puts("}");
  puts(".pptpvpn_main_span {");
  puts("\tdisplay:inline-block; vertical-align:middle;");
  puts("}");
  puts(".pptpvpn_main_button {");
  puts("\tpadding:0 1px 0 1px; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".pptpvpn_main_td input[type=checkbox], .pptpvpn_main_td input[type=radio] {");
  puts("display:inline-block; vertical-align:middle;");
  puts("}");
  puts("#pptpvpn_div_msg p {");
  puts("margin:5px 0 5px 15px; text-align:left;");
  puts("}");
  puts(".pptpvpn_ellipsis {");
  puts("text-overflow:ellipsis; overflow:hidden; white-space:nowrap; text-align:left;");
  puts("}");
  printf("input[type=\"text\"] {border:1px #CCC solid;}");
  printf("input[type=\"password\"] {border:1px #CCC solid;}");
  printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td {cursor:default;}");
  return printf("</style>");
}

//----- (0003B1D8) --------------------------------------------------------
int sub_3B1D8()
{
  int v0; // r1@1
  int v1; // r0@1
  char *v2; // r5@1
  int v3; // r1@1
  char *v4; // r4@2
  int v5; // r0@4
  int v6; // r1@4
  char *v7; // r4@5
  int v8; // r0@7
  int v9; // r1@7
  int v10; // r0@7
  int v11; // r1@7
  char *v12; // r4@8
  int v13; // r0@10
  int v14; // r1@10
  int v15; // r0@12
  int v16; // r1@12
  int v17; // r0@12
  int v18; // r1@12
  int v19; // r0@12
  int v20; // r0@12
  int v21; // r0@13
  int v22; // r1@15
  int v23; // r0@15
  int v24; // r1@15
  int v25; // r0@15
  int v26; // r1@15
  int v27; // r0@15
  int v28; // r1@15
  int v29; // r0@15
  int v30; // r1@15
  int v31; // r0@15
  int v32; // r0@15
  int v33; // r1@15
  const char *v34; // r0@16
  int v35; // r0@17
  int v36; // r1@17
  int v37; // r0@17
  int v38; // r1@17
  int v39; // r0@17
  int v40; // r0@18
  int v41; // r1@19
  int v42; // r0@19
  _UNKNOWN *v43; // r4@20
  int v44; // r1@20
  int v45; // r0@20
  int v46; // r1@20
  int v47; // r0@20
  int v48; // r0@20
  int v49; // r0@21
  int v50; // r0@21
  int v51; // r0@24
  _UNKNOWN *v52; // r0@26
  int v54; // [sp+0h] [bp-B8h]@19
  char v55; // [sp+40h] [bp-78h]@19
  char v56; // [sp+60h] [bp-58h]@15
  char v57; // [sp+80h] [bp-38h]@15
  int v58; // [sp+A0h] [bp-18h]@1
  int v59; // [sp+A4h] [bp-14h]@1

  sub_3B03C();
  sub_133E4((int)"expertconf", (int)"pptpvpn");
  pptpserver_get_config(&v59, &v58);
  printf("<form method=post action=\"timepro.cgi\" name=\"pptpvpn_conf_fm\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=\"tmenu\" value=\"expertconf\">");
  printf("<input type=hidden name=\"smenu\" value=\"pptpvpn\">");
  printf("<input type=hidden name=\"act\" value=\"\">");
  printf("<table class=\"v3_table pptpvpn_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<tr class=\"pptpvpn_main_tr\" height=\"48\"><td class=\"pptpvpn_main_td\" width=\"100%%\">");
  printf("<table class=\"v3_table pptpvpn_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"100\"><COL width=\"300\"><COL width=\"%%%%\">");
  printf("<tr class=\"pptpvpn_main_tr\" height=\"24\"><td class=\"pptpvpn_main_td\">");
  v1 = sub_134F4(1152, v0);
  v2 = "";
  printf("<p class=\"pptpvpn_main_p\">%s</p>", v1);
  printf("</td><td class=\"pptpvpn_main_td\">");
  printf("<div class=\"pptpvpn_main_span\" style=\"width:140px; *display:inline; zoom:1;\">");
  if ( v59 )
    v4 = "checked";
  else
    v4 = "";
  v5 = sub_134F4(894, v3);
  printf("<input type=radio name=operation id=operationtrue value=1 %s><label for=\"operationtrue\">%s</label>", v4, v5);
  printf("</div>");
  printf("<div class=\"pptpvpn_main_span\" style=\"width:140px; *display:inline; zoom:1;\">");
  if ( v59 )
    v7 = "";
  else
    v7 = "checked";
  v8 = sub_134F4(900, v6);
  printf(
    "<input type=radio name=operation id=operationfalse value=0 %s><label for=\"operationfalse\">%s</label>",
    v7,
    v8);
  printf("</div>");
  printf("</td><td class=\"pptpvpn_main_td\"></td></tr>");
  printf("<tr class=\"pptpvpn_main_tr\" height=\"24\"><td class=\"pptpvpn_main_td\">");
  v10 = sub_134F4(200, v9);
  printf("<p class=\"pptpvpn_main_p\">%s</p>", v10);
  printf("</td><td class=\"pptpvpn_main_td\">");
  printf("<div class=\"pptpvpn_main_span\" style=\"width:140px; *display:inline; zoom:1;\">");
  if ( v58 )
    v12 = "checked";
  else
    v12 = "";
  v13 = sub_134F4(199, v11);
  printf("<input type=radio name=mppe value=1 id=mppetrue %s><label for=\"mppetrue\">%s</label>", v12, v13);
  printf("</div>");
  printf("<div class=\"pptpvpn_main_span\" style=\"width:140px; *display:inline; zoom:1;\">");
  if ( !v58 )
    v2 = "checked";
  v15 = sub_134F4(201, v14);
  printf("<input type=radio name=mppe value=0 id=mppefalse %s><label for=\"mppefalse\">%s</label>", v2, v15);
  printf("</div>");
  printf("</td><td class=\"pptpvpn_main_td\" align=\"right\">");
  v17 = sub_134F4(28, v16);
  printf("<input type=button name=pptp_submit value=\"%s\" onclick=\"ApplyPPTP();\">\n", v17);
  printf("</td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("<tr class=\"pptpvpn_main_tr\" height=\"24\" style=\"background-color:#DBDBDB;\">\t\t<td class=\"pptpvpn_main_td\" style=\"border-top:1px #ccc solid; border-bottom:1px #ccc solid;\">");
  v19 = sub_134F4(207, v18);
  printf("<p class=\"pptpvpn_main_p\"><b>%s</b></p>", v19);
  printf("</td></tr>");
  v20 = printf("<tr class=\"pptpvpn_main_tr\"><td class=\"pptpvpn_main_td\">");
  if ( is_mobile_agent(v20) )
  {
    sub_12790((int)"144", (int)"100%%", (int)"display:inline-block; *display:inline; zoom:1;");
    v21 = printf("<iframe name=\"pptpvpn_account\" src=\"timepro.cgi?tmenu=iframe&smenu=pptpvpn_account\"                         frameborder=no width=100%% height=144 align=center scrolling=yes></iframe>");
    sub_12770(v21);
  }
  else
  {
    printf("<iframe name=\"pptpvpn_account\" src=\"timepro.cgi?tmenu=iframe&smenu=pptpvpn_account\"                         frameborder=no width=100%% height=144 align=center scrolling=yes></iframe>");
  }
  printf("</td></tr>");
  printf("<tr class=\"pptpvpn_main_tr\" height=\"24\" style=\"background-color:#DBDBDB;\">\t\t<td class=\"pptpvpn_main_td\" style=\"border-top:1px #ccc solid; border-bottom:1px #ccc solid;\">");
  v23 = sub_134F4(208, v22);
  printf("<p class=\"pptpvpn_main_p\"><b>%s</b></p>", v23);
  printf("</td></tr>");
  printf("<tr class=\"pptpvpn_main_tr\"><td class=\"pptpvpn_main_td\" width=\"100%%\">");
  printf("<table class=\"v3_table pptpvpn_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"321\"><COL width=\"321\">");
  printf("<tr class=\"pptpvpn_main_tr\" height=\"96\"><td class=\"pptpvpn_main_td\">");
  printf("<table class=\"v3_table pptpvpn_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"100\"><COL width=\"155\"><COL width=\"%%%%\">");
  v25 = sub_134F4(203, v24);
  printf(
    "<tr class=\"pptpvpn_main_tr\" height=\"24\"><td class=\"pptpvpn_main_td\"><p class=\"pptpvpn_main_p\">%s</p></td>",
    v25);
  printf((const char *)&unk_84708);
  v27 = sub_134F4(204, v26);
  printf(
    "<tr class=\"pptpvpn_main_tr\" height=\"24\"><td class=\"pptpvpn_main_td\"><p class=\"pptpvpn_main_p\">%s</p></td>",
    v27);
  v29 = sub_134F4(202, v28);
  printf(
    "<td class=\"pptpvpn_main_td\">\t\t<input type=password name=password size=30 maxlength=30 style=\"ime-mode:disabled; width:150px;\">\t\t<input type=text name=password_text size=30 maxlength=30 style=\"ime-mode:disabled; width:150px; display:none;\">\t\t</td><td class=\"pptpvpn_main_td\">\t\t<input type=checkbox id=\"passview\" onclick=\"onclick_passview(this.checked);\">\t\t<label for=\"passview\"><span class=\"pptpvpn_main_span\">%s</span></label>\t\t</td></tr>",
    v29);
  v31 = sub_134F4(38, v30);
  printf(
    "<tr class=\"pptpvpn_main_tr\" height=\"24\"><td class=\"pptpvpn_main_td\"><p class=\"pptpvpn_main_p\">%s</p></td>",
    v31);
  printf("<td class=\"pptpvpn_main_td\" colspan=\"2\">");
  get_ifconfig("br0", &v57, &v56);
  sub_11D7C((int)"ip", (int)&v57, 3);
  v32 = printf("</td></tr>");
  if ( check_valid_account(v32) )
  {
    v34 = "<tr class=\"pptpvpn_main_tr\" height=\"24\"><td class=\"pptpvpn_main_td\" colspan=\"2\"></td></tr>";
  }
  else
  {
    v35 = sub_134F4(194, v33);
    printf("<input type=hidden name=default_captcha_desc value='%s'>\n", v35);
    puts("<input type=hidden name=captcha_file value=>");
    v37 = sub_134F4(209, v36);
    printf(
      "<tr class=\"pptpvpn_main_tr\" height=\"24\"><td class=\"pptpvpn_main_td\"><p class=\"pptpvpn_main_p\">%s</p></td>",
      v37);
    printf("<td class=\"pptpvpn_main_td\" colspan=\"2\">");
    v39 = sub_134F4(194, v38);
    printf(
      "<input type=text name=captcha_code maxlength=\"5\" STYLE=\"width:205px; height:21px; color:#888888;\" value=\"%s\" \t\t\tonfocus=\"FocusCaptcha(document.pptpvpn_conf_fm);\" onblur=\"BlurCaptcha(document.pptpvpn_conf_fm);\">",
      v39);
    v34 = "</td></tr>";
  }
  printf(v34);
  printf("</table>");
  printf("</td>");
  v40 = printf("<td class=\"pptpvpn_main_td\">");
  if ( !check_valid_account(v40) )
  {
    get_http_auth_method(&v54);
    get_ux_lang(&v55);
    puts("<table class=\"v3_table pptpvpn_main_table\" width=\"321\" height=\"96\">");
    printf("<COL width=\"291\"><COL width=\"30\">");
    printf("<tr class=\"pptpvpn_main_tr\"><td class=\"pptpvpn_main_td\">");
    puts("<table class=\"v3_table pptpvpn_main_table\" width=\"254\" height=\"96\">");
    printf("<COL width=\"90\"><COL width=\"201\">");
    printf((const char *)&unk_84B07);
    v42 = sub_134F4(209, v41);
    printf("<p class=\"pptpvpn_main_p\">%s</p>", v42);
    printf("</td></tr>");
    printf(
      "<tr class=\"pptpvpn_main_tr\" \t\t\tstyle=\"font: normal normal normal 12px arial; color:#000000; border:#C6C9CC 1px solid; background-color:#FFFFFF;\" height=\"72\">\t\t\t<td class=\"pptpvpn_main_td\" style=\"cursor:pointer; background-color:#FAFAFA; border:0;\" \t\t\tonclick=\"iframe_captcha.location.reload();\">\t\t\t<img src=\"/images2/captcha_noborder.%s.gif\" style=\"border:0; margin-left:18px;\"></td>\n",
      &v55);
    strcmp((const char *)&v54, "session");
    printf("<td class=\"pptpvpn_main_td\" style=\"border-left:1px #CCC solid;\">\t\t\t<iframe name=iframe_captcha id=iframe_captcha src=\"/%s/captcha.cgi\" width=\"200\" height=\"72\" \t\t\tframeborder=no scrolling=no></iframe>\t\t\t</td></tr>\n");
    printf("</table>");
    printf("</td><td class=\"pptpvpn_main_td\"></td></tr></table>");
  }
  printf("</td></tr>");
  printf("<tr class=\"pptpvpn_main_tr\" height=\"10\"><td class=\"pptpvpn_main_td\" colspan=\"2\"></td></tr>");
  printf((const char *)&unk_84E41);
  v43 = sub_126C4();
  v45 = sub_134F4(3, v44);
  printf(
    "<button class=\"pptpvpn_main_button\" style=\"margin-left:5px; width:55px;\" id=\"btnadd\" \t\tonclick=\"AddPPTPServerUser(); return ClickEventPropagater(event);\">\t\t<span class=\"pptpvpn_main_span\" style=\"\"><img src=\"/%s/plus_icon.gif\" style=\"padding-right:4px;\">%s</span></button>",
    v43,
    v45);
  printf("</td><td class=\"pptpvpn_main_td\" align=\"right\">");
  printf("<span class=\"pptpvpn_main_span\" style=\"padding-right:30px;\"><font color=\"gray\">");
  v47 = sub_134F4(1151, v46);
  printf((const char *)v47, 5);
  printf("</font></span>");
  printf("</td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("</table>");
  v48 = printf("</form>");
  if ( is_mobile_agent(v48) )
  {
    sub_12790((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v49 = printf("<iframe name=\"hiddenpptpvpnstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenpptpvpnstatus\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    v50 = sub_12770(v49);
  }
  else
  {
    v50 = printf("<iframe name=\"hiddenpptpvpnstatus_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenpptpvpnstatus\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  if ( is_mobile_agent(v50) )
  {
    sub_12790((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v51 = printf("<iframe name=\"hiddenpptpvpnsetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenpptpvpnsetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    sub_12770(v51);
  }
  else
  {
    printf("<iframe name=\"hiddenpptpvpnsetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenpptpvpnsetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  printf("<script>init_pptpvpn();</script>");
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:536px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v52 = sub_126C4();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v52);
  printf("</SPAN></td>");
  printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"pptpvpn_div_msg\">\n");
  printf("</SPAN></td>");
  return printf((const char *)&unk_60F0E);
}
// E9E4: using guessed type int __fastcall get_http_auth_method(_DWORD);
// EF60: using guessed type int __fastcall check_valid_account(_DWORD);
// F1E8: using guessed type int __fastcall pptpserver_get_config(_DWORD, _DWORD);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F74C: using guessed type int __fastcall is_mobile_agent(_DWORD);
// FBF0: using guessed type int __fastcall get_ux_lang(_DWORD);

//----- (0003B8D0) --------------------------------------------------------
int sub_3B8D0()
{
  int v0; // r5@1
  bool v1; // zf@2
  int v2; // r1@2
  int v3; // r0@2
  int v4; // r0@5
  int v5; // r12@5
  int v6; // r3@5
  int v7; // r1@7
  char s; // [sp+8h] [bp-78h]@2
  int v10; // [sp+6Ch] [bp-14h]@3

  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_hiddenvpnstatus\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=hiddenpptpvpnstatus>");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  v0 = 0;
  do
  {
    memset(&s, 0, 0x68u);
    v1 = pptpserver_get_index_pptpinfo(v0, &s) == 0;
    v3 = 196;
    if ( v1 )
      break;
    if ( !v10 )
      v3 = 197;
    v4 = sub_134F4(v3, v2);
    v5 = (int)"false";
    v6 = v0;
    if ( !v10 )
      v5 = (int)"true";
    v7 = v0++;
    printf("parent.window.update_pptpvpn_status('connstat_%d', '%s', 'dischk_%d', %s);", v7, v4, v6, v5);
  }
  while ( v0 != 5 );
  printf("setTimeout(function(){document.expertconf_hiddenvpnstatus.submit();}, 3000);");
  return printf("</script>");
}
// F1D0: using guessed type int __fastcall pptpserver_get_index_pptpinfo(_DWORD, _DWORD);

//----- (0003B9D0) --------------------------------------------------------
int __fastcall sub_3B9D0(int a1, int a2)
{
  int v2; // r6@1
  int v3; // r5@4
  int v4; // r1@7
  int v5; // r0@11
  int v6; // r5@12
  int v7; // r0@14
  int v8; // r1@17
  int v9; // r0@18
  int v10; // r0@19
  int v11; // r4@21
  int v12; // r4@27
  int v13; // r0@28
  int v14; // r1@33
  int v15; // r0@33
  signed int v16; // r5@33
  int v17; // r1@33
  int v18; // r0@33
  int v19; // r1@33
  int v20; // r0@33
  _UNKNOWN *v21; // r4@33
  int v22; // r1@33
  int v23; // r0@33
  _UNKNOWN *v24; // r4@33
  int v25; // r1@33
  int v26; // r0@33
  int v27; // r1@35
  int v28; // r0@35
  int v29; // r0@37
  char *v30; // r3@38
  int v32; // r0@46
  signed int v33; // [sp+0h] [bp-190h]@0
  char s; // [sp+8h] [bp-188h]@7
  char s1; // [sp+48h] [bp-148h]@15
  char v36; // [sp+70h] [bp-120h]@12
  int v37; // [sp+90h] [bp-100h]@13
  char s2; // [sp+B0h] [bp-E0h]@13
  char v39; // [sp+D8h] [bp-B8h]@34
  int v40; // [sp+13Ch] [bp-54h]@35
  char v41; // [sp+140h] [bp-50h]@1

  v2 = a2;
  if ( !get_value_post(a2, "act", &v41, 64) )
    goto LABEL_33;
  if ( !strcmp(&v41, "add") )
  {
    if ( !check_valid_account(0) && !sub_13298(v2) )
      goto LABEL_33;
    v3 = 0;
    while ( 1 )
    {
      memset(&s, 0, 0x68u);
      if ( !pptpserver_get_index_pptpinfo(v3, &s) )
        break;
      ++v3;
      if ( v3 == 5 )
        goto LABEL_11;
    }
    if ( v3 == 5 )
    {
LABEL_11:
      v5 = 193;
LABEL_46:
      v32 = sub_134F4(v5, v4);
      sub_11620(v32);
      goto LABEL_33;
    }
    memset(&v36, 0, 0x68u);
    get_value_post(v2, "account", &v36, 32);
    v6 = check_unpermitted_chars(&v36);
    if ( v6 )
      goto LABEL_33;
    get_value_post(v2, "password", &v37, 32);
    get_ip_value_post(v2, "ip", &s2);
    do
    {
      memset(&s, 0, 0x68u);
      v7 = pptpserver_get_index_pptpinfo(v6++, &s);
      if ( !v7 )
        break;
      if ( !strcmp(&s1, &s2) )
      {
        v5 = 192;
        goto LABEL_46;
      }
    }
    while ( v6 != 5 );
    if ( sub_1311C(&v36) )
    {
      v9 = pptpserver_add_user(&v36);
    }
    else
    {
      v10 = sub_134F4(799, v8);
      v9 = sub_11620(v10);
    }
    goto LABEL_32;
  }
  if ( !strcmp(&v41, "del") )
  {
    v11 = 0;
    do
    {
      v33 = 64;
      v9 = get_value_array_post(v2, "delchk", v11++, &v41);
      if ( v9 )
        v9 = pptpserver_remove_user(&v41);
    }
    while ( v11 != 5 );
LABEL_32:
    signal_save(v9);
    goto LABEL_33;
  }
  if ( !strcmp(&v41, "disconnect") )
  {
    v12 = 0;
    do
    {
      v33 = 64;
      v13 = get_value_array_post(v2, "dischk", v12++, &v41);
      if ( v13 )
        pptpserver_disconnect_user(&v41);
    }
    while ( v12 != 5 );
    v9 = sleep(5u);
    goto LABEL_32;
  }
LABEL_33:
  sub_3B03C();
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"pptpvpn_account_fm\" style=\"padding:0; margin:0;\">");
  printf("<input type=hidden name=tmenu value=iframe>");
  printf("<input type=hidden name=smenu value=pptpvpn_account>");
  printf("<input type=hidden name=act value=>");
  printf("<table class=\"v3_table pptpvpn_main_table\" width=\"100%%\" height=\"144\" style=\"padding:0; margin:0;\">\n");
  printf("<COL width=\"200\"><COL width=\"140\"><COL width=\"140\"><COL width=\"100\"><COL width=\"%%%%\">");
  printf("<tr class=\"pptpvpn_main_tr\" height=\"24\">");
  printf("<td class=\"pptpvpn_main_td\">");
  v15 = sub_134F4(203, v14);
  v16 = 0;
  printf("<p class=\"pptpvpn_main_p\">%s</p>", v15);
  printf("</td>");
  printf("<td class=\"pptpvpn_main_td\">");
  v18 = sub_134F4(38, v17);
  printf("<span class=\"pptpvpn_main_span\">%s</span>", v18);
  printf("</td>");
  printf("<td class=\"pptpvpn_main_td\">");
  v20 = sub_134F4(195, v19);
  printf("<span class=\"pptpvpn_main_span\">%s</span>", v20);
  printf("</td>");
  printf("<td class=\"pptpvpn_main_td\">");
  v21 = sub_126C4();
  v23 = sub_134F4(198, v22);
  printf(
    "<span class=\"pptpvpn_main_span\" style=\"cursor:pointer;\" onclick=\"parent.window.DisconnectPPTPUser(document.pptpvpn_account_fm);\">\t\t<img src=\"/%s/minus_icon.gif\">%s</span>\t\t<input type=\"checkbox\" onclick=\"parent.window.onclick_alldischk(this);\">",
    v21,
    v23);
  printf("</td>");
  printf("<td class=\"pptpvpn_main_td\" align=\"right\">");
  v24 = sub_126C4();
  v26 = sub_134F4(118, v25);
  printf(
    "<span class=\"pptpvpn_main_span\" style=\"cursor:pointer;\" onclick=\"parent.window.RemovePPTPUser(document.pptpvpn_account_fm);\">\t\t<img src=\"/%s/minus_icon.gif\">%s</span>\t\t<input type=\"checkbox\" onclick=\"parent.window.onclick_alldelchk(this);\" style=\"margin-right:5px;\">",
    v24,
    v26);
  printf("</td>");
  printf("</tr>");
  do
  {
    memset(&v39, 0, 0x68u);
    if ( !pptpserver_get_index_pptpinfo(v16, &v39) )
      break;
    printf("<tr class=\"pptpvpn_main_tr\" height=\"24\" style=\"background-color:#%s;\">");
    printf("<td class=\"pptpvpn_main_td\">");
    printf("<span class=\"pptpvpn_main_span\" id=\"acc_%s\" style=\"margin-left:5px;\">%s</span>", &v39, &v39);
    printf("</td>");
    printf("<td class=\"pptpvpn_main_td\">");
    printf("<span class=\"pptpvpn_main_span\" id=\"ipa_%s\">%s</span>");
    printf("</td>");
    printf("<td class=\"pptpvpn_main_td\">");
    v28 = 196;
    if ( !v40 )
      v28 = 197;
    v29 = sub_134F4(v28, v27);
    printf("<span class=\"pptpvpn_main_span\" id=\"connstat_%d\">%s</span>", v16, v29);
    printf("</td>");
    printf("<td class=\"pptpvpn_main_td\">");
    v30 = v40 ? "" : "disabled";
    printf(
      "<input type=checkbox name=dischk id=\"dischk_%d\" value=\"%s\" style=\"margin-left:60px;\" %s>",
      v16,
      &v39,
      v30,
      v33);
    printf("</td>");
    printf("<td class=\"pptpvpn_main_td\" align=\"right\">");
    printf("<input type=checkbox name=delchk value=\"%s\" style=\"margin-right:5px;\">", &v39);
    printf("</td>");
    ++v16;
    printf("</tr>");
  }
  while ( v16 != 5 );
  while ( v16 <= 4 )
  {
    printf("<tr class=\"pptpvpn_main_tr\" height=\"24\" style=\"background-color:#%s;\">");
    printf("<td class=\"pptpvpn_main_td\" colspan=\"5\"></td>");
    printf("</tr>");
    ++v16;
  }
  printf("</table>");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  printf("UnMaskIt(parent.document, 'apply_mask');");
  return printf("</script>");
}
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EF60: using guessed type int __fastcall check_valid_account(_DWORD);
// F11C: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// F1D0: using guessed type int __fastcall pptpserver_get_index_pptpinfo(_DWORD, _DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F9BC: using guessed type int __fastcall get_value_array_post(_DWORD, _DWORD, _DWORD, _DWORD);
// FB24: using guessed type int __fastcall pptpserver_add_user(_DWORD);
// FB3C: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// FB90: using guessed type int __fastcall pptpserver_disconnect_user(_DWORD);
// FE9C: using guessed type int __fastcall pptpserver_remove_user(_DWORD);

//----- (0003BF74) --------------------------------------------------------
int __fastcall sub_3BF74(int a1)
{
  int v1; // r6@1
  int v2; // r4@3
  int v3; // r0@3
  int v4; // r5@3
  int v5; // r0@4
  unsigned int v6; // r0@6
  int v7; // r0@6
  int v9; // [sp+0h] [bp-A0h]@4
  char v10; // [sp+68h] [bp-38h]@1

  v1 = a1;
  if ( get_value_post(a1, "act", &v10, 32) && !strcmp(&v10, "apply") )
  {
    get_value_post(v1, "operation", &v10, 32);
    v2 = atoi(&v10);
    get_value_post(v1, "mppe", &v10, 32);
    v3 = atoi(&v10);
    v4 = 0;
    pptpserver_set_config(v2, v3);
    do
    {
      memset(&v9, 0, 0x68u);
      v5 = pptpserver_get_index_pptpinfo(v4++, &v9);
      if ( !v5 )
        break;
      pptpserver_disconnect_user(&v9);
    }
    while ( v4 != 5 );
    v6 = sleep(5u);
    v7 = signal_update(v6);
    signal_save(v7);
    signal_start("vpn");
  }
  return 0;
}
// E7B0: using guessed type int __fastcall pptpserver_set_config(_DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EE1C: using guessed type int __fastcall signal_start(_DWORD);
// F1D0: using guessed type int __fastcall pptpserver_get_index_pptpinfo(_DWORD, _DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// FB90: using guessed type int __fastcall pptpserver_disconnect_user(_DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);

//----- (0003C070) --------------------------------------------------------
int __fastcall sub_3C070(int a1, int a2)
{
  sub_3BF74(a2);
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_hiddenvpnsetup\">");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  printf("UnMaskIt(parent.document, 'apply_mask');");
  return printf("</script>");
}

//----- (0003C0D4) --------------------------------------------------------
int __fastcall sub_3C0D4(int a1)
{
  int v1; // r5@1
  int v2; // r1@1
  int v3; // r1@2
  int v4; // r4@2
  int v5; // r0@2
  int v6; // r0@4
  int v7; // r0@4
  int v8; // r1@4
  int v9; // r0@5
  int v10; // r0@5
  int v11; // r1@5
  int v12; // r0@5
  int v13; // r0@6
  int v14; // r0@6
  int v15; // r0@7
  int v16; // r0@7
  int v17; // r0@7
  int v18; // r0@7
  int v19; // r1@7
  int v20; // r0@7
  int v21; // r1@7
  int v22; // r0@7
  int v23; // r0@7
  int v25; // [sp+0h] [bp-38h]@1
  char v26; // [sp+20h] [bp-18h]@1

  v1 = a1;
  wizard_api_set_mode(0);
  puts("<form method=get action=timepro.cgi name=wizard>");
  puts("<input type=hidden name=tmenu value=wizard>");
  puts("<input type=hidden name=config value=auto>");
  puts("<input type=hidden name=step>");
  get_value(v1, "ifname", &v26, 8);
  printf("<input type=hidden name=ifname value=%s>\n", &v26);
  strcpy((char *)&v25, "");
  get_value(v1, "timeout", &v25, 32);
  if ( !strcmp((const char *)&v25, "pppoe") )
  {
    v4 = sub_134F4(1318, v2);
    v5 = 1321;
  }
  else
  {
    v4 = sub_134F4(1322, v2);
    v5 = 1323;
  }
  v6 = sub_134F4(v5, v3);
  v7 = sub_124D8(v4, v6);
  str(v7);
  puts("<td height=190 class=\"wizardbody_td\">");
  if ( !strcmp((const char *)&v25, "pppoe") )
  {
    v9 = sub_134F4(1319, v8);
    v10 = printf((const char *)v9);
    br(v10);
    v12 = 1320;
  }
  else
  {
    v13 = sub_134F4(1324, v8);
    v14 = printf((const char *)v13);
    br(v14);
    v12 = 1325;
  }
  v15 = sub_134F4(v12, v11);
  v16 = printf((const char *)v15);
  br(v16);
  v17 = printf("</td>");
  etr(v17);
  v18 = print_blank_line(1, 2);
  str(v18);
  puts("<td height=190 class=wizardbottom_td align=right>");
  v20 = sub_134F4(1337, v19);
  printf("<input type=button name=retry value='%s' onclick='WizardGotoPage(0)'>\n", v20);
  v22 = sub_134F4(1333, v21);
  printf("<input type=button name=exit value='%s' onclick='self.close();'>\n", v22);
  v23 = printf("</td>");
  return etr(v23);
}
// EBC4: using guessed type int __fastcall wizard_api_set_mode(_DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// F788: using guessed type int __fastcall br(_DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (0003C2B0) --------------------------------------------------------
int __fastcall sub_3C2B0(int a1)
{
  int v1; // r4@1
  int v2; // r1@1
  int v3; // r4@1
  int v4; // r1@1
  int v5; // r0@2
  int v6; // r0@4
  int v7; // r1@4
  int v8; // r0@5
  int v9; // r0@7
  int v10; // r0@7
  int v11; // r1@7
  int v12; // r0@7
  int v13; // r0@7
  int v14; // r0@7
  int v15; // r1@7
  int v16; // r0@7
  int v17; // r1@7
  int v18; // r0@7
  int v19; // r1@7
  int v20; // r0@7
  int v21; // r1@7
  int v22; // r0@7
  int v23; // r1@7
  int v24; // r0@7
  int v25; // r0@7
  int v26; // r1@7
  int v27; // r0@7
  int v28; // r0@7
  int v29; // r1@7
  int v30; // r0@7
  int v31; // r1@7
  int v32; // r0@7
  int v33; // r0@7
  char v35; // [sp+4h] [bp-BCh]@1
  char v36; // [sp+24h] [bp-9Ch]@7
  char v37; // [sp+38h] [bp-88h]@7
  char v38; // [sp+4Ch] [bp-74h]@7
  char v39; // [sp+60h] [bp-60h]@7
  char v40; // [sp+74h] [bp-4Ch]@7
  char v41; // [sp+88h] [bp-38h]@1
  char s1; // [sp+98h] [bp-28h]@1

  v1 = a1;
  wizard_api_set_mode(0);
  get_value(v1, "ifname", &v35, 32);
  eth2wan(&v35, &v41);
  get_wan_type(&v41, &s1);
  puts("<form method=get action=timepro.cgi name=wizard>");
  puts("<input type=hidden name=tmenu value=wizard>");
  puts("<input type=hidden name=config value=auto>");
  puts("<input type=hidden name=step>");
  puts("<input type=hidden name=nextstep value=finish>");
  v3 = sub_134F4(1314, v2);
  if ( !strcmp(&s1, "pppoe") )
    v5 = 1316;
  else
    v5 = 1312;
  v6 = sub_134F4(v5, v4);
  sub_124D8(v3, v6);
  puts("<tr><td height=190 class=wizardbody_td>");
  if ( !strcmp(&s1, "pppoe") )
    v8 = 1317;
  else
    v8 = 1313;
  v9 = sub_134F4(v8, v7);
  v10 = printf((const char *)v9);
  br(v10);
  v12 = sub_134F4(1315, v11);
  v13 = printf((const char *)v12);
  v14 = br(v13);
  br(v14);
  get_wan_ipinfo(&v41, &v40, &v39, &v38);
  get_domain_name_server(&v37, &v36);
  printf("<table class=wizard_content_table>");
  v16 = sub_134F4(216, v15);
  printf("<tr><td width=100px >%s</td><td>%s</td></tr>", v16, &v40);
  v18 = sub_134F4(907, v17);
  printf("<tr><td>%s</td><td>%s</td></tr>", v18, &v39);
  v20 = sub_134F4(345, v19);
  printf("<tr><td>%s</td><td>%s</td></tr>", v20, &v38);
  v22 = sub_134F4(227, v21);
  printf("<tr><td>%s</td><td>%s</td></tr>", v22, &v37);
  v24 = sub_134F4(874, v23);
  printf("<tr><td>%s</td><td>%s</td></tr>", v24, &v36);
  v25 = printf("</table>");
  br(v25);
  v27 = sub_134F4(1338, v26);
  printf((const char *)v27);
  v28 = print_blank_line(1, 2);
  str(v28);
  puts("<td class=\"wizardbottom_td\" align=right>");
  v30 = sub_134F4(1337, v29);
  printf("<input type=button name=retry value='%s' onclick='WizardGotoPage(0);'>\n", v30);
  v32 = sub_134F4(1336, v31);
  printf("<input type=button name=next value='%s' onclick=\"WizardGotoPage('save');\">\n", v32);
  v33 = puts("</td>");
  etr(v33);
  return puts("</form>");
}
// E96C: using guessed type int __fastcall get_wan_type(_DWORD, _DWORD);
// EBC4: using guessed type int __fastcall wizard_api_set_mode(_DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F104: using guessed type int __fastcall get_wan_ipinfo(_DWORD, _DWORD, _DWORD, _DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// F788: using guessed type int __fastcall br(_DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// F95C: using guessed type int __fastcall get_domain_name_server(_DWORD, _DWORD);
// FA1C: using guessed type int __fastcall eth2wan(_DWORD, _DWORD);

//----- (0003C534) --------------------------------------------------------
int __fastcall sub_3C534(int a1)
{
  int v1; // r6@1
  unsigned int v2; // r0@1
  unsigned int v3; // r0@1
  char *v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r0@1
  int v8; // r1@1
  int v9; // r0@1
  int v10; // r1@1
  int v11; // r0@1
  int v12; // r0@1
  int v13; // r1@1
  int v14; // r0@1
  int v15; // r0@1
  int v16; // r1@1
  int v17; // r0@1
  int v18; // r0@1
  int v19; // r0@1
  int v20; // r1@1
  int v21; // r0@1
  int v22; // r0@1
  int v23; // r0@1
  int v24; // r0@1
  int v25; // r1@1
  int v26; // r0@1
  int v27; // r1@1
  int v28; // r0@1
  int v29; // r0@1
  int v31; // [sp+0h] [bp-E8h]@1
  char v32; // [sp+20h] [bp-C8h]@1
  char v33; // [sp+40h] [bp-A8h]@1
  char v34; // [sp+60h] [bp-88h]@1
  char v35; // [sp+80h] [bp-68h]@1
  char v36; // [sp+A0h] [bp-48h]@1
  char v37; // [sp+C0h] [bp-28h]@1

  v1 = a1;
  get_localbroadaddr("br0", &v33);
  v2 = inet_addr(&v33);
  v3 = ((v2 >> 24) | (v2 << 24) | ((v2 & 0xFF0000) >> 8) | ((unsigned __int16)(v2 & 0xFF00) << 8)) + 2;
  v4 = inet_ntoa((struct in_addr)((v3 >> 24) | (v3 << 24) | ((v3 & 0xFF0000) >> 8) | ((unsigned __int16)(v3 & 0xFF00) << 8)));
  strcpy(&v32, v4);
  wizard_api_set_mode(0);
  puts("<form method=get action=timepro.cgi name=wizard>");
  puts("<input type=hidden name=tmenu value=wizard>");
  puts("<input type=hidden name=smenu value=>");
  puts("<input type=hidden name=commit value=>");
  puts("<input type=hidden name=wizard value=1>");
  puts("<input type=hidden name=config value=auto>");
  puts("<input type=hidden name=step>");
  get_value(v1, "ifname", &v37, 8);
  printf("<input type=hidden name=ifname value=%s>\n", &v37);
  get_netaddr("br0", &v31);
  printf("<input type=hidden name=\"wan1subnet\" value=\"%s\">\n", &v31);
  strcpy(&v36, "");
  get_value(v1, "timeout", &v36, 32);
  v6 = sub_134F4(1328, v5);
  sub_124D8(v6, 0);
  v7 = get_ifconfig("br0", &v35, &v34);
  str(v7);
  puts("<td height=190 class=\"wizardbody_td\">");
  v9 = sub_134F4(1326, v8);
  printf((const char *)v9);
  v11 = sub_134F4(1327, v10);
  v12 = printf((const char *)v11);
  br(v12);
  printf(
    "<input type=checkbox onclick=\"if(this.checked == true) SetIP('ip','%s'); else SetIP('ip','%s');\">",
    &v32,
    &v35);
  v14 = sub_134F4(442, v13);
  printf((const char *)v14);
  v15 = puts("<table>");
  str(v15);
  v17 = sub_134F4(389, v16);
  printf("<td>%s</td>", v17);
  puts("<td>");
  sub_11D7C((int)"ip", (int)&v35, 1);
  v18 = printf("</td>");
  v19 = etr(v18);
  str(v19);
  v21 = sub_134F4(907, v20);
  printf("<td>%s</td>", v21);
  puts("<td>");
  sub_11D7C((int)"sm", (int)&v34, 1);
  v22 = puts("</td>");
  etr(v22);
  printf("</table>");
  v23 = printf("</td>");
  etr(v23);
  v24 = print_blank_line(1, 2);
  str(v24);
  printf("<td class=wizardbottom_td align=right>");
  v26 = sub_134F4(1335, v25);
  printf("<input type=button class=navi_bt name=prev value='%s' onclick=\"WizardGotoPage('2');\">", v26);
  v28 = sub_134F4(1334, v27);
  printf(
    "<input type=button class=navi_bt name=next value='%s' onclick=\"document.wizard.step.value=8; CheckLanIPChange(document.wizard);\">",
    v28);
  v29 = printf("</td>");
  return etr(v29);
}
// EBC4: using guessed type int __fastcall wizard_api_set_mode(_DWORD);
// EEC4: using guessed type int __fastcall get_netaddr(_DWORD, _DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// F6E0: using guessed type int __fastcall get_localbroadaddr(_DWORD, _DWORD);
// F788: using guessed type int __fastcall br(_DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);

//----- (0003C82C) --------------------------------------------------------
int __fastcall sub_3C82C(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r0@1
  int v4; // r0@1
  int v5; // r0@1
  int v6; // r7@1
  int v7; // r1@1
  int v8; // r0@5
  int v9; // r0@6
  int v10; // r1@6
  int v11; // r0@6
  int v12; // r1@6
  int v13; // r0@6
  int v14; // r0@6
  int v15; // r0@6
  int v16; // r0@6
  int v17; // r0@6
  int v18; // r0@6
  int v19; // r0@6
  int v20; // r0@6
  int v22; // [sp+0h] [bp-438h]@3
  char v23; // [sp+10h] [bp-428h]@3
  char v24; // [sp+24h] [bp-414h]@3
  char v25; // [sp+38h] [bp-400h]@3
  char v26; // [sp+4Ch] [bp-3ECh]@3
  char v27; // [sp+60h] [bp-3D8h]@3
  char v28; // [sp+3B8h] [bp-80h]@1
  char v29; // [sp+3D8h] [bp-60h]@2
  char v30; // [sp+3F8h] [bp-40h]@3
  int v31; // [sp+40Ch] [bp-2Ch]@3

  v2 = a1;
  v3 = sub_134F4(1332, a2);
  v4 = sub_124D8(v3, 0);
  str(v4);
  v5 = puts("<td height=190 class=\"wizardbody_td\">");
  v6 = hwinfo_get_reboot_duration(v5) + 30;
  if ( get_ip_value(v2, "sm", &v28) && get_ip_value(v2, "ip", &v29) )
  {
    dhcpd_read_config(&v22);
    set_use_local_gateway(0);
    set_lan_ipconfig(&v29, &v28, 0);
    sf_strncpy(&v25, &v29, 20);
    sf_strncpy(&v26, &v28, 20);
    get_subnet_range(&v29, &v28, &v23, &v24);
    get_ifconfig("br0", &v31, &v30);
    if ( !strcmp(&v27, (const char *)&v31) )
      sf_strncpy(&v27, &v29, 20);
    v8 = dhcpd_commit_config(&v22);
    dhcpd_flush_dynamic_lease(v8);
  }
  v9 = sub_134F4(1329, v7);
  printf((const char *)v9);
  v11 = sub_134F4(1330, v10);
  printf("%s<br>", v11);
  v13 = sub_134F4(1331, v12);
  printf((const char *)v13);
  printf("<script>RunTimer('reboot_duration',%d,'self.close();');</script>", v6);
  v14 = printf("</td>");
  etr(v14);
  v15 = print_blank_line(1, 2);
  str(v15);
  printf("<td class=wizardbottom_td align=right>");
  print_html_progress_bar(v6, 545, 30);
  v16 = printf("</td>");
  etr(v16);
  v17 = syslog_msg(1, "@{42}");
  v18 = syslog_save(v17);
  v19 = saveconf(v18);
  v20 = signal_update(v19);
  signal_save(v20);
  return signal_reboot(3);
}
// E780: using guessed type int __fastcall syslog_save(_DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E9CC: using guessed type int __fastcall get_ip_value(_DWORD, _DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EBAC: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// EFCC: using guessed type int __fastcall dhcpd_flush_dynamic_lease(_DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F110: using guessed type int __fastcall saveconf(_DWORD);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F470: using guessed type int syslog_msg(_DWORD, const char *, ...);
// F548: using guessed type int __fastcall print_html_progress_bar(_DWORD, _DWORD, _DWORD);
// F620: using guessed type int __fastcall dhcpd_read_config(_DWORD);
// F6B0: using guessed type int __fastcall signal_reboot(_DWORD);
// F770: using guessed type int __fastcall dhcpd_commit_config(_DWORD);
// F854: using guessed type int __fastcall set_use_local_gateway(_DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// FAF4: using guessed type int __fastcall get_subnet_range(_DWORD, _DWORD, _DWORD, _DWORD);
// FB0C: using guessed type int __fastcall set_lan_ipconfig(_DWORD, _DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);

//----- (0003CA1C) --------------------------------------------------------
int __fastcall sub_3CA1C(int a1, int a2, int a3)
{
  int v3; // r1@1
  int v4; // r4@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r0@1
  int v8; // r1@1
  int v9; // r0@1
  int v10; // r1@1
  int v11; // r1@2
  int v12; // r0@2
  int v13; // r1@3
  int v14; // r0@3
  int v15; // r1@3
  int v16; // r0@3
  int v17; // r1@3
  int v18; // r0@3
  int v19; // r0@3
  int v20; // r1@3
  int v21; // r0@3
  int v22; // r0@3
  int v24; // [sp+0h] [bp-18h]@1
  int v25; // [sp+4h] [bp-14h]@1
  int v26; // [sp+8h] [bp-10h]@1

  v25 = a2;
  v26 = a3;
  strcpy((char *)&v24, "eth1");
  wizard_api_set_status(&v24, "initial");
  puts("<form method=get action=timepro.cgi name=wizard>");
  puts("<input type=hidden name=tmenu value=wizard>");
  puts("<input type=hidden name=step>");
  puts("<input type=hidden name=start_flag>");
  printf("<input type=hidden name=ifname value=%s>\n", &v24);
  v4 = sub_134F4(1380, v3);
  v6 = sub_134F4(1381, v5);
  v7 = sub_124D8(v4, v6);
  str(v7);
  printf("<td height=190 class=\"wizardbody_td\">");
  puts("<input type=radio name=config value=auto checked>");
  v9 = sub_134F4(1382, v8);
  printf("%s<br>\n", v9);
  puts("</span>");
  if ( *(_BYTE *)sub_134F4(1383, v10) )
  {
    print_nbsp(10);
    v12 = sub_134F4(1383, v11);
    printf("%s<br>\n", v12);
  }
  print_nbsp(10);
  v14 = sub_134F4(1384, v13);
  printf("%s<br><br>\n", v14);
  puts("<input type=radio name=config value=manual>");
  v16 = sub_134F4(1385, v15);
  printf("%s<br>\n", v16);
  print_nbsp(10);
  v18 = sub_134F4(1386, v17);
  printf("%s<br>\n", v18);
  puts("</td></tr>");
  v19 = print_blank_line(1, 2);
  str(v19);
  printf("<td class=wizardbottom_td align=right>");
  v21 = sub_134F4(1334, v20);
  printf("<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage(1);\">", v21);
  v22 = printf("</td>");
  etr(v22);
  return puts("</form>");
}
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// FA64: using guessed type int __fastcall wizard_api_set_status(_DWORD, _DWORD);

//----- (0003CBF4) --------------------------------------------------------
int __fastcall sub_3CBF4(int a1)
{
  int v1; // r6@1
  int v2; // r1@7
  char *v3; // r5@7
  int v4; // r4@7
  int v5; // r1@7
  int v6; // r0@7
  int v7; // r0@7
  int v8; // r1@7
  int v9; // r0@7
  int v10; // r1@7
  char *v11; // r4@8
  int v12; // r0@10
  int v13; // r1@10
  char *v14; // r4@11
  int v15; // r0@13
  int v16; // r0@13
  int v17; // r1@13
  int v18; // r0@13
  int v19; // r1@13
  char *v20; // r4@14
  int v21; // r0@16
  int v22; // r0@16
  int v23; // r1@16
  int v24; // r0@18
  int v25; // r0@18
  int v26; // r1@22
  int v27; // r4@25
  int v28; // r1@25
  int v29; // r0@25
  int v30; // r1@25
  int v31; // r0@25
  int v32; // r1@25
  int v33; // r0@25
  int v34; // r1@25
  int v35; // r0@25
  int v36; // r1@25
  int v37; // r0@25
  const char *v38; // r0@25
  int v39; // r1@27
  int v40; // r4@34
  int v41; // r1@34
  int v42; // r0@34
  int v43; // r0@34
  int v44; // r1@34
  int v45; // r0@34
  int v46; // r0@34
  int v47; // r0@34
  int v48; // r1@34
  int v49; // r0@34
  int v50; // r0@34
  int v51; // r0@34
  int v52; // r1@34
  int v53; // r0@34
  int v54; // r0@34
  int v55; // r0@34
  int v56; // r1@34
  int v57; // r0@34
  int v58; // r0@34
  int v59; // r0@34
  int v60; // r1@34
  int v61; // r0@34
  int v62; // r0@34
  int v63; // r0@36
  int v64; // r1@36
  int v65; // r0@36
  int v66; // r1@36
  int v67; // r0@36
  int v68; // r0@36
  int v70; // [sp+0h] [bp-360h]@24
  char v71; // [sp+80h] [bp-2E0h]@24
  char v72; // [sp+13Ch] [bp-224h]@22
  char v73; // [sp+1BCh] [bp-1A4h]@22
  char v74; // [sp+1FCh] [bp-164h]@22
  char v75; // [sp+23Ch] [bp-124h]@22
  char v76; // [sp+27Ch] [bp-E4h]@1
  char v77; // [sp+2BCh] [bp-A4h]@27
  char v78; // [sp+2D0h] [bp-90h]@27
  char v79; // [sp+2E4h] [bp-7Ch]@3
  char dest; // [sp+2F8h] [bp-68h]@3
  char s1; // [sp+30Ch] [bp-54h]@3
  char v82; // [sp+320h] [bp-40h]@1
  char v83; // [sp+330h] [bp-30h]@27
  char v84; // [sp+338h] [bp-28h]@3

  v1 = a1;
  get_value(a1, "ifname", &v82, 16);
  puts("<form method=get action=timepro.cgi name=wizard>");
  puts("<input type=hidden name=tmenu value=wizard>");
  puts("<input type=hidden name=config value=manual>");
  puts("<input type=hidden name=step>");
  printf("<input type=hidden name=ifname value=%s>\n", &v82);
  if ( get_value(v1, "wan_type", &v76, 64) )
  {
    printf("<input type=hidden name=wan_type value=%s>\n", &v76);
    if ( strcmp(&v76, "dynamic") )
    {
      if ( !strcmp(&v76, "pppoe") )
      {
        get_value(v1, "ifname", &v74, 64);
        eth2wan(&v74, &v73);
        strcpy(&v72, "");
        strcpy(&v75, "");
        get_value(v1, "userid", &v72, 128);
        get_value(v1, "passwd", &v75, 64);
        if ( !v72 && !v75 )
        {
          read_pppoe_option(&v73, &v70);
          sf_strncpy(&v72, &v70, 128);
          sf_strncpy(&v75, &v71, 64);
        }
        v27 = sub_134F4(1366, v26);
        v29 = sub_134F4(1367, v28);
        sub_124D8(v27, v29);
        puts((const char *)&unk_860B2);
        v31 = sub_134F4(1368, v30);
        printf((const char *)&unk_86063, v31);
        printf("<table class=navicontent_table>");
        printf("<tr><td width=100>");
        v33 = sub_134F4(385, v32);
        printf("%s", v33);
        printf("</td><td>");
        printf("<input type=text name=userid style=\"width:150;\" maxlength=63 value='%s'>", &v72);
        printf("</td></tr>");
        printf("<tr><td width=100>");
        v35 = sub_134F4(756, v34);
        printf("%s", v35);
        printf("</td><td>");
        printf("<input type=password name=\"passwd\" style=\"width:150;\" maxlength=32 value='%s'>", &v75);
        printf("</td></tr>");
        printf("</table>");
        v37 = sub_134F4(1304, v36);
        printf((const char *)v37);
        v38 = "</td></tr>";
      }
      else
      {
        if ( strcmp(&v76, "static") )
          goto LABEL_36;
        get_value(v1, "ifname", &v83, 8);
        eth2wan(&v83, &v84);
        strcpy(&s1, "");
        strcpy(&dest, "");
        strcpy(&dest, "");
        strcpy(&v79, "");
        strcpy(&v78, "");
        strcpy(&v77, "");
        get_value(v1, "ip", &s1, 20);
        get_value(v1, "sm", &dest, 20);
        get_value(v1, "gw", &v79, 20);
        get_value(v1, "fdns", &v78, 20);
        get_value(v1, "sdns", &v77, 20);
        if ( !s1 && !dest && !v79 )
          get_wan_ipinfo(&v84, &s1, &dest, &v79);
        if ( !v78 && !v77 )
          get_domain_name_server(&v78, &v77);
        v40 = sub_134F4(1357, v39);
        v42 = sub_134F4(1358, v41);
        sub_124D8(v40, v42);
        puts((const char *)&unk_860B2);
        v43 = puts("<table>");
        str(v43);
        v45 = sub_134F4(216, v44);
        printf("<td>%s</td>", v45);
        puts("<td>");
        sub_11D7C((int)"ip", (int)&s1, 1);
        v46 = printf("</td>");
        v47 = etr(v46);
        str(v47);
        v49 = sub_134F4(907, v48);
        printf("<td>%s</td>", v49);
        puts("<td>");
        sub_11D7C((int)"sm", (int)&dest, 1);
        v50 = puts("</td>");
        v51 = etr(v50);
        str(v51);
        v53 = sub_134F4(345, v52);
        printf("<td>%s</td>", v53);
        puts("<td>");
        sub_11D7C((int)"gw", (int)&v79, 1);
        v54 = puts("</td>");
        v55 = etr(v54);
        str(v55);
        v57 = sub_134F4(1359, v56);
        printf("<td>%s</td>", v57);
        puts("<td>");
        sub_11D7C((int)"fdns", (int)&v78, 1);
        v58 = puts("</td>");
        v59 = etr(v58);
        str(v59);
        v61 = sub_134F4(1360, v60);
        printf("<td>%s</td>", v61);
        puts("<td>");
        sub_11D7C((int)"sdns", (int)&v77, 1);
        v62 = puts("</td>");
        etr(v62);
        v38 = "</table></td></tr>";
      }
      puts(v38);
      goto LABEL_36;
    }
    get_value(v1, "ifname", &v84, 8);
    strcpy(&v79, "");
    strcpy(&dest, "");
    get_value(v1, "hw_conf", &v79, 20);
    if ( !get_value(v1, "private", &s1, 20) )
      strcpy(&s1, "on");
    if ( !v79 )
      strcpy(&v79, "auto");
    get_value(v1, "hw_addr", &dest, 20);
    v3 = "checked";
    v4 = sub_134F4(1355, v2);
    v6 = sub_134F4(1356, v5);
    v7 = sub_124D8(v4, v6);
    str(v7);
    puts("<td height=190 class=wizardbody_td>");
    v9 = sub_134F4(1361, v8);
    printf("%s<br><br>", v9);
    if ( !strcmp(&v79, "auto") )
      v11 = "checked";
    else
      v11 = "";
    v12 = sub_134F4(1362, v10);
    printf("<input type=radio name=hw_conf value=auto onclick=\"DisableHW('hw');\" %s> %s<br>", v11, v12);
    if ( !strcmp(&v79, "manual") )
      v14 = "checked";
    else
      v14 = "";
    v15 = sub_134F4(1363, v13);
    printf((const char *)&unk_85FBE, v14, v15);
    print_nbsp(8);
    v16 = sub_121A0((int)"hw", &dest, 0);
    br(v16);
    print_nbsp(10);
    v18 = sub_134F4(1364, v17);
    printf("%s<br>\n", v18);
    if ( !strcmp(&v79, "noclone") )
      v20 = "checked";
    else
      v20 = "";
    v21 = sub_134F4(1365, v19);
    v22 = printf((const char *)&unk_86017, v20, v21);
    br(v22);
    if ( strcmp(&s1, "on") )
      v3 = "";
    v24 = sub_134F4(1369, v23);
    printf("<input type=checkbox name=private value=on %s> %s", v3, v24);
    v25 = printf("</td>");
    etr(v25);
    printf("<script>");
    if ( strcmp(&v79, "manual") )
      printf("DisableHW('hw');");
    printf("</script>");
  }
LABEL_36:
  v63 = print_blank_line(1, 2);
  str(v63);
  puts("<td class=wizardbottom_td align=right>");
  v65 = sub_134F4(1335, v64);
  printf("<input type=button class=navi_bt name=prev value='%s' onclick=\"WizardGotoPage(1);\">", v65);
  v67 = sub_134F4(1334, v66);
  printf("<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage(3);\">", v67);
  v68 = puts("</td>");
  etr(v68);
  return puts("</form>");
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F104: using guessed type int __fastcall get_wan_ipinfo(_DWORD, _DWORD, _DWORD, _DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// F728: using guessed type int __fastcall read_pppoe_option(_DWORD, _DWORD);
// F788: using guessed type int __fastcall br(_DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// F95C: using guessed type int __fastcall get_domain_name_server(_DWORD, _DWORD);
// FA1C: using guessed type int __fastcall eth2wan(_DWORD, _DWORD);

//----- (0003D490) --------------------------------------------------------
int __fastcall sub_3D490(int a1)
{
  int v1; // r7@1
  int result; // r0@1
  int v3; // r1@2
  int v4; // r2@2
  int v5; // r1@7
  int v6; // r0@7
  int v7; // r0@7
  char *v8; // r4@7
  char *v9; // r1@8
  int v10; // r1@10
  int v11; // r0@10
  int v12; // r1@10
  int v13; // r0@10
  int v14; // r1@10
  int v15; // r0@10
  char *v16; // r1@11
  int v17; // r1@13
  int v18; // r0@13
  int v19; // r1@13
  int v20; // r0@13
  int v21; // r1@13
  int v22; // r0@13
  int v23; // r1@13
  int v24; // r0@13
  int v25; // r1@15
  int v26; // r0@15
  int v27; // r1@15
  int v28; // r0@15
  int v29; // r1@15
  int v30; // r0@15
  int v31; // r0@15
  int v32; // r0@15
  int v33; // r1@15
  int v34; // r0@15
  int v35; // r1@15
  int v36; // r0@15
  int v37; // r0@15
  int v38; // r5@18
  int v39; // r1@19
  int v40; // r0@19
  int v41; // r0@19
  int v42; // r1@19
  int v43; // r0@19
  char *v44; // r0@22
  char *v45; // r1@25
  const char *v46; // r0@25
  int v47; // r1@30
  int v48; // r4@32
  int v49; // r1@32
  int v50; // r0@32
  int v51; // r0@34
  int v52; // r1@34
  int v53; // r0@34
  int v54; // r1@34
  int v55; // r0@35
  char *v56; // r2@35
  int v57; // r1@35
  int v58; // r1@36
  int v59; // r0@37
  int v60; // r0@38
  int v61; // r1@39
  int v62; // r0@40
  int v63; // r0@41
  int v64; // r1@41
  int v65; // r4@41
  int v66; // r1@41
  int v67; // r0@42
  int v68; // r0@44
  int v69; // r0@44
  int v70; // r1@46
  int v71; // r4@46
  int v72; // r1@46
  int v73; // r0@46
  int v74; // r1@46
  int v75; // r4@46
  int v76; // r1@46
  int v77; // r0@46
  size_t v78; // r6@46
  bool v79; // nf@48
  unsigned __int8 v80; // vf@48
  int v81; // r0@49
  char *v82; // r2@49
  int v83; // r1@49
  const char *v84; // r0@49
  int v85; // r1@59
  int v86; // r4@61
  int v87; // r1@61
  int v88; // r0@61
  int v89; // r1@61
  int v90; // r0@61
  int v91; // r1@61
  int v92; // r0@61
  int v93; // r1@61
  int v94; // r0@61
  int v95; // r1@61
  int v96; // r0@61
  int v97; // r1@61
  int v98; // r0@61
  int v99; // r0@63
  int v100; // r1@63
  int v101; // r0@63
  int v102; // r0@63
  int v103; // r1@63
  int v104; // r0@63
  int v105; // r1@63
  int v106; // r0@63
  char v107; // [sp+4h] [bp-204h]@46
  char v108; // [sp+84h] [bp-184h]@46
  char v109; // [sp+C4h] [bp-144h]@46
  char v110; // [sp+104h] [bp-104h]@1
  char v111; // [sp+144h] [bp-C4h]@19
  char v112; // [sp+164h] [bp-A4h]@59
  char s1; // [sp+178h] [bp-90h]@22
  char dest; // [sp+18Ch] [bp-7Ch]@22
  char v115; // [sp+1A0h] [bp-68h]@22
  char v116; // [sp+1B4h] [bp-54h]@22
  char v117; // [sp+1C8h] [bp-40h]@5
  char v118; // [sp+1D8h] [bp-30h]@5
  char v119; // [sp+1E8h] [bp-20h]@5

  v1 = a1;
  result = get_value(a1, "step", &v110, 64);
  if ( result )
  {
    if ( !strcmp(&v110, "0") )
      return sub_3CA1C(v1, v3, v4);
    if ( !strcmp(&v110, "1") )
    {
      get_value(v1, "ifname", &v118, 16);
      eth2wan(&v118, &v119);
      set_wansetup_status(&v119, 1);
      if ( !get_value(v1, "wan_type", &v117, 16) )
        strcpy(&v117, "dynamic");
      puts("<form method=get action=timepro.cgi name=wizard>");
      puts("<input type=hidden name=tmenu value=wizard>");
      puts("<input type=hidden name=config value=manual>");
      puts("<input type=hidden name=step>");
      printf("<input type=hidden name=ifname value=%s>\n", &v118);
      v6 = sub_134F4(1344, v5);
      v7 = sub_124D8(v6, 0);
      str(v7);
      puts("<td height=190 class=wizardbody_td>");
      v8 = "checked";
      if ( !strcmp(&v117, "dynamic") )
        v9 = "checked";
      else
        v9 = "";
      printf("<input type=radio name=wan_type value=dynamic %s>\n", v9);
      v11 = sub_134F4(1345, v10);
      printf("<b>%s</b><br>\n", v11);
      print_nbsp(10);
      v13 = sub_134F4(1347, v12);
      printf("%s<br>\n", v13);
      print_nbsp(10);
      v15 = sub_134F4(1348, v14);
      printf("%s<br>\n", v15);
      if ( !strcmp(&v117, "pppoe") )
        v16 = "checked";
      else
        v16 = "";
      printf("<input type=radio name=wan_type value=pppoe %s>\n", v16);
      v18 = sub_134F4(1349, v17);
      printf("<b>%s</b><br>\n", v18);
      puts("</span>");
      print_nbsp(10);
      v20 = sub_134F4(1350, v19);
      printf("%s<br>\n", v20);
      print_nbsp(10);
      v22 = sub_134F4(1351, v21);
      printf("%s<br>\n", v22);
      print_nbsp(10);
      v24 = sub_134F4(1352, v23);
      printf("%s<br>\n", v24);
      if ( strcmp(&v117, "static") )
        v8 = "";
      printf("<input type=radio name=wan_type value=static %s>\n", v8);
      v26 = sub_134F4(1353, v25);
      printf("<b>%s</b><br>\n", v26);
      print_nbsp(10);
      v28 = sub_134F4(1354, v27);
      printf("%s<br>\n", v28);
      print_nbsp(10);
      v30 = sub_134F4(1346, v29);
      printf("%s", v30);
      v31 = printf("</td>");
      etr(v31);
      v32 = print_blank_line(1, 2);
      str(v32);
      puts("<td class=wizardbottom_td align=right>");
      v34 = sub_134F4(1335, v33);
      printf("<input type=button class=navi_bt name=prev value='%s' onclick=\"WizardGotoPage(0);\">", v34);
      v36 = sub_134F4(1334, v35);
      printf("<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage(2);\">", v36);
      v37 = printf("</td>");
      etr(v37);
      return puts("</form>");
    }
    if ( !strcmp(&v110, "2") )
      return sub_3CBF4(v1);
    result = strcmp(&v110, "3");
    v38 = result;
    if ( !result )
    {
      puts("<form method=get action=timepro.cgi name=wizard>");
      puts("<input type=hidden name=tmenu value=wizard>");
      puts("<input type=hidden name=config value=manual>");
      puts("<input type=hidden name=step>");
      puts("<input type=hidden name=commit>");
      puts("<input type=hidden name=nextstep>");
      get_value(v1, "ifname", &v117, 16);
      printf("<input type=hidden name=ifname value=%s>\n", &v117);
      v40 = sub_134F4(1370, v39);
      v41 = sub_124D8(v40, v38);
      str(v41);
      puts("<td height=190 class=wizardbody_td>");
      v43 = sub_134F4(1371, v42);
      printf("%s<br><br>\n", v43);
      if ( get_value(v1, "wan_type", &v111, 32) )
        printf("<input type=hidden name=wan_type value=%s>\n", &v111);
      printf("<table class=wizard_content_table>");
      if ( !strcmp(&v111, "dynamic") )
      {
        strcpy(&dest, "");
        strcpy(&v115, "");
        strcpy(&v116, "");
        v44 = getenv("REMOTE_ADDR");
        get_internal_pc_hardware_address(v44, &v115);
        if ( get_value(v1, "hw_conf", &s1, 20) )
          printf("<input type=hidden name=hw_conf value=%s>\n", &s1);
        if ( get_hw_value(v1, "hw", &dest) )
        {
          v45 = &dest;
          v46 = "<input type=hidden name=hw_addr value=\"%s\">\n";
        }
        else
        {
          if ( strcmp(&s1, "auto") )
            goto LABEL_29;
          v46 = "<input type=hidden name=hw_addr value=\"%s\">\n";
          v45 = &v115;
        }
        printf(v46, v45);
LABEL_29:
        if ( get_value(v1, "private", &v116, 20) )
          printf("<input type=hidden name=private value=%s>\n", &v116);
        else
          puts("<input type=hidden name=private value=off>");
        v48 = sub_134F4(1388, v47);
        v50 = sub_134F4(1389, v49);
        printf("<tr><td width=150px >%s</td><td><b>%s</b></td></tr>", v48, v50);
        if ( dest )
          convert_mac(&dest);
        v51 = convert_mac(&v115);
        str(v51);
        v53 = sub_134F4(1343, v52);
        printf("<td>%s</td>", v53);
        if ( !strcmp(&s1, "auto") )
        {
          v55 = sub_134F4(1342, v54);
          v56 = &v115;
          v57 = v55;
        }
        else
        {
          if ( strcmp(&s1, "manual") )
          {
            v60 = strcmp(&s1, "noclone");
            if ( !v60 )
            {
              v62 = sub_134F4(1341, v61);
              v60 = printf("<td>%s</td>", v62);
            }
            goto LABEL_41;
          }
          v59 = sub_134F4(1340, v58);
          v56 = &dest;
          v57 = v59;
        }
        v60 = printf((const char *)&unk_864CA, v57, v56);
LABEL_41:
        v63 = etr(v60);
        str(v63);
        v65 = sub_134F4(1377, v64);
        if ( !strcmp(&v116, "on") )
          v67 = 1378;
        else
          v67 = 1379;
        v68 = sub_134F4(v67, v66);
        v69 = printf((const char *)&unk_864DB, v65, v68);
        etr(v69);
        goto LABEL_63;
      }
      if ( !strcmp(&v111, "pppoe") )
      {
        get_value(v1, "userid", &v107, 128);
        printf("<input type=hidden name=userid value=\"%s\">\n", &v107);
        get_value(v1, "passwd", &v109, 64);
        printf("<input type=hidden name=passwd value=\"%s\">\n", &v109);
        v71 = sub_134F4(1388, v70);
        v73 = sub_134F4(1390, v72);
        v74 = v71;
        v75 = 0;
        printf("<tr><td width=150px >%s</td><td><b>%s</b></td></tr>", v74, v73);
        v77 = sub_134F4(385, v76);
        printf("<tr><td width=150px >%s</td><td><b>%s</b></td></tr>", v77, &v107);
        v78 = strlen(&v109);
        strcpy(&v108, "");
        while ( 1 )
        {
          v80 = __OFSUB__(v75, v78);
          v79 = ((v75++ - v78) & 0x80000000) != 0;
          if ( !(v79 ^ v80) )
            break;
          strcat(&v108, "*");
        }
        v81 = sub_134F4(756, (int)"*");
        v82 = &v108;
        v83 = v81;
        v84 = "<tr><td width=150px >%s</td><td><b>%s</b></td></tr>";
      }
      else
      {
        if ( strcmp(&v111, "static") )
        {
LABEL_63:
          v99 = printf("</table>");
          br(v99);
          v101 = sub_134F4(1338, v100);
          printf("%s<br>\n", v101);
          v102 = print_blank_line(1, 2);
          str(v102);
          puts("<td class=wizardbottom_td align=right>");
          v104 = sub_134F4(1335, v103);
          printf("<input type=button class=navi_bt name=prev value='%s' onclick=\"WizardGotoPage(2);\">", v104);
          v106 = sub_134F4(1336, v105);
          printf("<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage('save');\">", v106);
          puts("</td></tr>");
          return puts("</form>");
        }
        if ( get_ip_value(v1, "ip", &v116) )
          printf("<input type=hidden name=ip value=\"%s\">\n", &v116);
        if ( get_ip_value(v1, "sm", &v115) )
          printf("<input type=hidden name=sm value=\"%s\">\n", &v115);
        if ( get_ip_value(v1, "gw", &dest) )
          printf("<input type=hidden name=gw value=\"%s\">\n", &dest);
        if ( get_ip_value(v1, "fdns", &s1) )
          printf("<input type=hidden name=fdns value=\"%s\">\n", &s1);
        if ( get_ip_value(v1, "sdns", &v112) )
          printf("<input type=hidden name=sdns value=\"%s\">\n", &v112);
        v86 = sub_134F4(1388, v85);
        v88 = sub_134F4(1391, v87);
        printf("<tr><td width=150px >%s</td><td><b>%s</b></td></tr>", v86, v88);
        v90 = sub_134F4(216, v89);
        printf("<tr><td width=150px >%s</td><td><b>%s</b></td></tr>", v90, &v116);
        v92 = sub_134F4(907, v91);
        printf("<tr><td width=150px >%s</td><td><b>%s</b></td></tr>", v92, &v115);
        v94 = sub_134F4(345, v93);
        printf("<tr><td width=150px >%s</td><td><b>%s</b></td></tr>", v94, &dest);
        v96 = sub_134F4(227, v95);
        printf("<tr><td width=150px >%s</td><td><b>%s</b></td></tr>", v96, &s1);
        v98 = sub_134F4(874, v97);
        v82 = &v112;
        v83 = v98;
        v84 = "<tr><td width=150px >%s</td><td><b>%s</b></td></tr>";
      }
      printf(v84, v83, v82);
      goto LABEL_63;
    }
  }
  return result;
}
// E768: using guessed type int __fastcall get_hw_value(_DWORD, _DWORD, _DWORD);
// E9CC: using guessed type int __fastcall get_ip_value(_DWORD, _DWORD, _DWORD);
// EB70: using guessed type int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD);
// EE10: using guessed type int __fastcall convert_mac(_DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// F788: using guessed type int __fastcall br(_DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// FA10: using guessed type int __fastcall set_wansetup_status(_DWORD, _DWORD);
// FA1C: using guessed type int __fastcall eth2wan(_DWORD, _DWORD);

//----- (0003DEEC) --------------------------------------------------------
int __fastcall sub_3DEEC(int a1)
{
  int v1; // r7@1
  int result; // r0@3
  int v3; // r1@6
  int v4; // r2@6
  int v5; // r1@11
  int v6; // r0@12
  int v7; // r1@12
  int v8; // r0@14
  int v9; // r1@14
  int v10; // r0@15
  int v11; // r1@16
  int v12; // r0@16
  int v13; // r0@17
  int v14; // r0@17
  int v15; // r1@17
  int v16; // r0@17
  int v17; // r1@17
  int v18; // r4@17
  int v19; // r0@17
  int v20; // r1@19
  int v21; // r0@19
  int v22; // r0@19
  int v23; // r4@20
  int v24; // r0@21
  int v25; // r1@22
  int v26; // r0@22
  char *v27; // r5@22
  int v28; // r1@22
  int v29; // r0@22
  int v30; // r1@22
  int v31; // r0@22
  int v32; // r0@22
  int v33; // r0@22
  int v34; // r1@22
  int v35; // r0@22
  int v36; // r1@22
  int v37; // r0@22
  int v38; // r0@22
  char *v39; // r1@23
  const char *v40; // r0@23
  int v41; // r0@29
  int v42; // r2@29
  signed int v43; // r1@30
  const char *v44; // r0@32
  int v45; // r1@36
  int v46; // r1@37
  int v47; // r4@37
  int v48; // r0@37
  int v49; // r0@39
  int v50; // r1@39
  int v51; // r0@40
  int v52; // r0@42
  int v53; // r1@42
  int v54; // r0@42
  int v55; // r1@42
  int v56; // r0@42
  int v57; // r1@42
  int v58; // r0@42
  int v59; // r1@42
  int v60; // r0@42
  int v61; // r1@42
  int v62; // r0@42
  int v63; // r1@42
  int v64; // r0@42
  int v65; // r1@42
  int v66; // r0@42
  const char *v67; // r0@43
  int v68; // r10@49
  int v69; // r0@53
  int v70; // r1@54
  int v71; // r0@54
  int v72; // r0@54
  int v73; // r1@54
  int v74; // r0@54
  int v75; // r1@54
  int v76; // r0@54
  int v77; // r1@54
  int v78; // r0@54
  int v79; // r0@54
  int v80; // r1@54
  int v81; // r0@54
  int v82; // r1@54
  int v83; // r0@54
  int v84; // r0@54
  int v85; // r0@54
  int v86; // r1@70
  char v87; // [sp+4h] [bp-2ECh]@53
  char v88; // [sp+84h] [bp-26Ch]@53
  __int16 v89; // [sp+142h] [bp-1AEh]@22
  __int16 v90; // [sp+182h] [bp-16Eh]@19
  __int16 v91; // [sp+1C2h] [bp-12Eh]@8
  __int16 v92; // [sp+202h] [bp-EEh]@46
  __int16 v93; // [sp+222h] [bp-CEh]@48
  __int16 v94; // [sp+242h] [bp-AEh]@6
  __int16 v95; // [sp+262h] [bp-8Eh]@1
  __int16 v96; // [sp+282h] [bp-6Eh]@11
  char s1; // [sp+2A0h] [bp-50h]@34
  char v98; // [sp+2B0h] [bp-40h]@25
  char v99; // [sp+2C0h] [bp-30h]@11
  char v100; // [sp+2C8h] [bp-28h]@11

  v1 = a1;
  if ( get_value(a1, "step", &v95, 32) )
  {
    if ( !strcmp((const char *)&v95, "save") )
      return sub_1253C(v1);
    if ( !strcmp((const char *)&v95, "finish") )
      return sub_12418(v1);
  }
  if ( !get_value(v1, "config", &v94, 32) )
    return sub_3CA1C(v1, v3, v4);
  if ( strcmp((const char *)&v94, "auto") )
  {
    result = strcmp((const char *)&v94, "manual");
    if ( !result )
      result = sub_3D490(v1);
    return result;
  }
  result = get_value(v1, "step", &v91, 64);
  if ( !result )
    return result;
  if ( !strcmp((const char *)&v91, "0") )
    return sub_3CA1C(v1, v3, v4);
  if ( !strcmp((const char *)&v91, "1") )
  {
    get_value(v1, "ifname", &v99, 8);
    eth2wan(&v99, &v100);
    set_wansetup_status(&v100, 1);
    puts("<form method=get action=timepro.cgi name=wizard>");
    puts("<input type=hidden name=tmenu value=wizard>");
    puts("<input type=hidden name=config value=auto>");
    puts("<input type=hidden name=step>");
    printf("<input type=hidden name=ifname value=%s>\n", &v99);
    get_link_status(65537, &v96);
    if ( !strcmp((const char *)&v96, "On") )
    {
      v6 = sub_134F4(1294, v5);
      v7 = 0;
    }
    else
    {
      v6 = sub_134F4(1293, v5);
      v7 = 0;
    }
    v8 = sub_124D8(v6, v7);
    str(v8);
    puts("<td height=190 class=wizardbody_td>");
    if ( !strcmp((const char *)&v96, "On") )
    {
      puts("<input type=hidden name=start_flag value=1>");
      v12 = sub_134F4(1292, v11);
      printf((const char *)v12);
    }
    else
    {
      v10 = sub_134F4(1291, v9);
      printf("%s", v10);
      printf("<meta http-equiv=refresh content=\"3; URL=timepro.cgi?tmenu=wizard&config=auto&step=1&ifname=%s\">", &v99);
    }
    v13 = printf("</td>");
    etr(v13);
    v14 = print_blank_line(1, 2);
    str(v14);
    puts("<td class=wizardbottom_td align=right>");
    v16 = sub_134F4(1335, v15);
    printf("<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage(0);\">", v16);
    v18 = sub_134F4(1334, v17);
    strcmp((const char *)&v96, "On");
    printf("<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage(2);\" %s>", v18);
    v19 = printf("</td>");
    etr(v19);
LABEL_43:
    v67 = "</form>";
    return puts(v67);
  }
  if ( !strcmp((const char *)&v91, "2") )
  {
    get_value(v1, "ifname", &v100, 8);
    eth2wan(&v100, &v99);
    puts("<form method=get action=timepro.cgi name=wizard>");
    puts("<input type=hidden name=tmenu value=wizard>");
    puts("<input type=hidden name=config value=auto>");
    puts("<input type=hidden name=step>");
    printf("<input type=hidden name=ifname value=%s>\n", &v100);
    v21 = sub_134F4(1298, v20);
    sub_124D8(v21, 0);
    v22 = get_value(v1, "start_flag", &v90, 64);
    if ( v22 )
    {
      v22 = strcmp((const char *)&v90, "1");
      v23 = v22;
      if ( !v22 )
      {
        wizard_api_set_mode(1);
        set_dhclient_block_private_ip(&v100, v23);
        wizard_api_set_status(&v100, "detecting");
        set_default_gateway("br0", v23);
        set_default_gateway(&v100, v23);
        set_ifconfig(&v100);
        set_wan_type(&v99, "pppoe");
        set_pppoe_status(&v99, v23);
        pppoe_stop(&v99);
        v24 = dhclient_stop(&v99);
        v22 = signal_update(v24);
      }
    }
    etr(v22);
    puts("<td height=190 class=wizardbody_td>");
    v26 = sub_134F4(1295, v25);
    v27 = &v100;
    printf("%s<br>", v26);
    v29 = sub_134F4(1296, v28);
    printf("%s<br>", v29);
    v31 = sub_134F4(1297, v30);
    printf("%s<br><br>", v31);
    v32 = puts("</td>");
    etr(v32);
    v33 = print_blank_line(1, 2);
    str(v33);
    puts("<td class=wizardbottom_td align=right>");
    v35 = sub_134F4(1335, v34);
    printf("<input type=button class=navi_bt name=prev value='%s' onclick=\"WizardGotoPage(1);\">", v35);
    v37 = sub_134F4(1334, v36);
    printf("<input type=button class=navi_bt name=next value='%s' disabled>", v37);
    v38 = puts("</td>");
    etr(v38);
    puts("</form>");
    wizard_api_get_status(&v100, &v89);
    if ( !strcmp((const char *)&v89, "detecting") )
    {
      v39 = &v100;
      v40 = "<meta http-equiv=refresh content=\"5; URL=timepro.cgi?tmenu=wizard&config=auto&step=2&ifname=%s\">";
      return printf(v40, v39);
    }
    if ( !strcmp((const char *)&v89, "detected") )
    {
      get_wan_type(&v99, &v98);
      if ( !strcmp(&v98, "pppoe") )
      {
        v40 = "<meta http-equiv=refresh content=\"3; URL=timepro.cgi?tmenu=wizard&config=auto&step=3&ifname=%s\">";
        v39 = &v100;
        return printf(v40, v39);
      }
LABEL_56:
      v39 = v27;
      v40 = "<meta http-equiv=refresh content=\"3; URL=timepro.cgi?tmenu=wizard&config=auto&step=5&ifname=%s\">";
      return printf(v40, v39);
    }
    result = strcmp((const char *)&v89, "timeout");
    if ( result )
      return result;
    v41 = istatus_get_intvalue_direct("lanwan_samenetwork");
    v42 = (int)&v100;
    if ( v41 == 1 )
      v43 = 7;
    else
      v43 = 6;
    v44 = "<meta http-equiv=refresh content=\"3; URL=timepro.cgi?tmenu=wizard&config=auto&step=%d&ifname=%s\">";
    return printf(v44, v43, v42);
  }
  if ( !strcmp((const char *)&v91, "3") )
  {
    get_value(v1, "ifname", &v98, 16);
    if ( !get_value(v1, "auth", &s1, 16) )
      strcpy(&s1, "success");
    puts("<form method=get action=timepro.cgi name=wizard>");
    puts("<input type=hidden name=tmenu value=wizard>");
    puts("<input type=hidden name=config value=auto>");
    puts("<input type=hidden name=step>");
    printf("<input type=hidden name=ifname value=%s>\n", &v98);
    puts("<input type=hidden name=pppoe_start value=1>");
    if ( !strcmp(&s1, "fail") )
    {
      v47 = sub_134F4(1305, v45);
      v48 = 1307;
    }
    else
    {
      v47 = sub_134F4(1306, v45);
      v48 = 1303;
    }
    v49 = sub_134F4(v48, v46);
    sub_124D8(v47, v49);
    puts((const char *)&unk_860B2);
    if ( !strcmp(&s1, "fail") )
      v51 = 1299;
    else
      v51 = 1300;
    v52 = sub_134F4(v51, v50);
    printf("%s<br>", v52);
    v54 = sub_134F4(1301, v53);
    printf("%s<br>", v54);
    v56 = sub_134F4(1302, v55);
    printf("%s<br><br>", v56);
    printf("<table class=navicontent_table >");
    printf("<tr><td width=100>");
    v58 = sub_134F4(385, v57);
    printf("%s", v58);
    printf("</td><td>");
    printf("<input type=text name=\"userid\" style=\"width:150\" maxlength=63>");
    printf("</td></tr>");
    printf("<tr><td width=100>");
    v60 = sub_134F4(756, v59);
    printf("%s", v60);
    printf("</td><td>");
    printf("<input type=password name=\"passwd\" style=\"width:150\" maxlength=32>");
    printf("</td></tr>");
    printf("</table>");
    v62 = sub_134F4(1304, v61);
    printf("<span class=gray_text>%s</span>", v62);
    print_blank_line(1, 2);
    puts((const char *)&unk_86AAC);
    v64 = sub_134F4(1335, v63);
    printf("<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage(1);\">", v64);
    v66 = sub_134F4(1334, v65);
    printf("<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage(4);\">", v66);
    puts("</td></tr>");
    goto LABEL_43;
  }
  if ( !strcmp((const char *)&v91, "4") )
  {
    if ( !get_value(v1, "ifname", &v92, 32) )
    {
      v67 = "Debug:auto_step4: No ifname..";
      return puts(v67);
    }
    eth2wan(&v92, &s1);
    if ( get_value(v1, "count", &v93, 32) )
      v68 = atoi((const char *)&v93);
    else
      v68 = 0;
    if ( get_value(v1, "pppoe_start", &v93, 32) && !strcmp((const char *)&v93, "1") )
    {
      read_pppoe_option(&s1, &v87);
      get_value(v1, "userid", &v87, 128);
      get_value(v1, "passwd", &v88, 128);
      set_default_gateway("br0", 0);
      set_default_gateway(&v92, 0);
      set_ifconfig(&v92);
      save_pppoe_option(&s1, &v87);
      v69 = pppoe_stop(&s1);
      signal_update(v69);
    }
    puts("<form method=get action=timepro.cgi name=wizard>");
    puts("<input type=hidden name=tmenu value=wizard>");
    puts("<input type=hidden name=config value=auto>");
    v27 = (char *)&v92;
    puts("<input type=hidden name=step>");
    printf("<input type=hidden name=ifname value=%s>\n", &v92);
    v71 = sub_134F4(1311, v70);
    v72 = sub_124D8(v71, 0);
    str(v72);
    puts("<td height=190 class=\"wizardbody_td\">");
    v74 = sub_134F4(1308, v73);
    printf("%s<br>\n", v74);
    v76 = sub_134F4(1309, v75);
    printf("%s<br>\n", v76);
    v78 = sub_134F4(1310, v77);
    printf("%s<br>\n", v78);
    v79 = print_blank_line(1, 2);
    str(v79);
    puts("<td class=wizardbottom_td align=right>");
    v81 = sub_134F4(1335, v80);
    printf("<input type=button class=navi_bt name=next value='%s' onclick=\"WizardGotoPage(3);\">", v81);
    v83 = sub_134F4(1334, v82);
    printf("<input type=button class=navi_bt name=next value='%s' disabled>", v83);
    v84 = puts("</td>");
    etr(v84);
    puts("</form>");
    v85 = get_pppoe_status(&s1);
    if ( v85 == 4 )
    {
      if ( check_wan_connected(&s1) )
        goto LABEL_56;
    }
    else
    {
      if ( v85 == 6 )
      {
        v39 = (char *)&v92;
        v40 = "<meta http-equiv=refresh content=\"3; URL=timepro.cgi?tmenu=wizard&config=auto&step=3&ifname=%s&auth=fail\">";
        return printf(v40, v39);
      }
      if ( v85 == 7 )
        goto LABEL_61;
    }
    v42 = v68 + 1;
    if ( 3 * (v68 + 1) <= 30 )
    {
      v44 = "<meta http-equiv=refresh content=\"3; URL=timepro.cgi?tmenu=wizard&config=auto&step=4&ifname=%s&count=%d\">";
      v43 = (signed int)&v92;
      return printf(v44, v43, v42);
    }
LABEL_61:
    v39 = (char *)&v92;
    v40 = "<meta http-equiv=refresh content=\"3; URL=timepro.cgi?tmenu=wizard&config=auto&step=6&ifname=%s&timeout=pppoe\">";
    return printf(v40, v39);
  }
  if ( !strcmp((const char *)&v91, "5") )
  {
    result = sub_3C2B0(v1);
  }
  else if ( !strcmp((const char *)&v91, "6") )
  {
    result = sub_3C0D4(v1);
  }
  else if ( !strcmp((const char *)&v91, "7") )
  {
    result = sub_3C534(v1);
  }
  else
  {
    result = strcmp((const char *)&v91, "8");
    if ( !result )
      result = sub_3C82C(v1, v86);
  }
  return result;
}
// E774: using guessed type int __fastcall get_link_status(_DWORD, _DWORD);
// E804: using guessed type int __fastcall set_dhclient_block_private_ip(_DWORD, _DWORD);
// E96C: using guessed type int __fastcall get_wan_type(_DWORD, _DWORD);
// EBC4: using guessed type int __fastcall wizard_api_set_mode(_DWORD);
// EDE0: using guessed type int __fastcall pppoe_stop(_DWORD);
// EF48: using guessed type int __fastcall dhclient_stop(_DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F0EC: using guessed type int __fastcall istatus_get_intvalue_direct(_DWORD);
// F218: using guessed type int __fastcall set_wan_type(_DWORD, _DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F338: using guessed type int __fastcall set_pppoe_status(_DWORD, _DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// F728: using guessed type int __fastcall read_pppoe_option(_DWORD, _DWORD);
// F8C0: using guessed type int __fastcall check_wan_connected(_DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// FA10: using guessed type int __fastcall set_wansetup_status(_DWORD, _DWORD);
// FA1C: using guessed type int __fastcall eth2wan(_DWORD, _DWORD);
// FA64: using guessed type int __fastcall wizard_api_set_status(_DWORD, _DWORD);
// FAE8: using guessed type int __fastcall wizard_api_get_status(_DWORD, _DWORD);
// FC8C: using guessed type int __fastcall set_ifconfig(_DWORD);
// FCD4: using guessed type int __fastcall set_default_gateway(_DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);
// FDA0: using guessed type int __fastcall save_pppoe_option(_DWORD, _DWORD);
// FE00: using guessed type int __fastcall get_pppoe_status(_DWORD);

//----- (0003EAD8) --------------------------------------------------------
int __fastcall sub_3EAD8(int a1)
{
  int v1; // r4@1

  v1 = a1;
  puts("<body bgcolor=#dedede style=\"margin-left:0; margin-right:0; margin-top:0px; margin-bottom:0;\" >");
  puts("<table width=550 height=290 class=wizardtable_td bgcolor=#ffffff >");
  sub_3DEEC(v1);
  printf("</table>");
  return puts("</body>");
}

//----- (0003EB20) --------------------------------------------------------
int __fastcall sub_3EB20(int a1)
{
  char *v1; // r7@1
  int v2; // r6@1
  int result; // r0@1
  char *v4; // r5@6
  int v5; // r1@12
  char *v6; // r0@13
  int v7; // r0@28
  int v8; // [sp+0h] [bp-210h]@17
  char v9; // [sp+80h] [bp-190h]@17
  char v10; // [sp+13Ch] [bp-D4h]@3
  char v11; // [sp+17Ch] [bp-94h]@1
  char v12; // [sp+19Ch] [bp-74h]@19
  char cp; // [sp+1B0h] [bp-60h]@19
  char v14; // [sp+1C4h] [bp-4Ch]@6
  char v15; // [sp+1D8h] [bp-38h]@6
  char v16; // [sp+1ECh] [bp-24h]@10
  char v17; // [sp+200h] [bp-10h]@1
  char v18; // [sp+210h] [bp+0h]@1
  char dest; // [sp+220h] [bp+10h]@12

  v1 = &v18;
  v2 = a1;
  get_value(a1, "ifname", &v18, 16);
  eth2wan(&v18, &v17);
  result = get_value(v2, "wan_type", &v11, 32);
  if ( result )
  {
    if ( strcmp(&v11, "dynamic") )
    {
      if ( !strcmp(&v11, "pppoe") )
      {
        read_pppoe_option(&v17, &v8);
        get_value(v2, "userid", &v8, 128);
        get_value(v2, "passwd", &v9, 128);
        save_pppoe_option(&v17, &v8);
      }
      else if ( !strcmp(&v11, "static") )
      {
        get_value(v2, "ip", &v16, 20);
        get_value(v2, "sm", &v15, 20);
        get_value(v2, "gw", &v14, 20);
        get_value(v2, "fdns", &cp, 20);
        get_value(v2, "sdns", &v12, 20);
        set_wan_ipconfig(&v18, &v16, &v15, &v14);
        set_ifconfig(&v18);
        if ( check_default_gateway(&v14, &v16, &v15) )
        {
          set_default_gateway("br0", 0);
          set_default_gateway(&v18, 0);
        }
        else
        {
          set_default_gateway("br0", 0);
          if ( set_default_gateway(&v18, &v14) )
            set_default_gateway2(&v18, &v16, &v15, &v14);
        }
        if ( inet_addr(&cp) == -1 )
          strcpy(&cp, "");
        if ( inet_addr(&v12) == -1 )
          strcpy(&v12, "");
        dhcpd_set_dns(&cp, &v12);
        set_domain_name_server(&cp, &v12, "eth1");
        set_dns_shadow(&v18, &v11, &cp, &v12);
      }
      goto LABEL_28;
    }
    if ( !get_value(v2, "hw_conf", &v10, 64) )
    {
LABEL_28:
      set_wan_type(&v17, &v11);
      pppoe_stop(&v17);
      v7 = dhclient_stop(&v17);
      return signal_update(v7);
    }
    if ( !strcmp(&v10, "auto") || !strcmp(&v10, "manual") )
    {
      v1 = &v18;
      v4 = &v14;
      get_hwaddr_kernel(&v18, &v15);
      get_value(v2, "hw_addr", &v14, 20);
      if ( strcmp(&v14, &v15) && !check_invalid_hwaddr(&v14) )
      {
LABEL_11:
        set_hwaddr_kernel(v1, v4, 1);
        set_hwaddr_cloned(v1, v4);
        goto LABEL_12;
      }
    }
    else if ( !strcmp(&v10, "noclone") )
    {
      v4 = &v16;
      get_hwaddr_org(&v18, &v16);
      get_hwaddr_kernel(&v18, &v15);
      if ( strcmp(&v16, &v15) )
        goto LABEL_11;
    }
LABEL_12:
    strcpy(&dest, "");
    get_value(v2, "private", &dest, 8);
    v5 = strcmp(&dest, "on");
    if ( v5 )
    {
      v6 = &v18;
      v5 = 1;
    }
    else
    {
      v6 = &v18;
    }
    set_dhclient_block_private_ip(v6, v5);
    goto LABEL_28;
  }
  return result;
}
// E804: using guessed type int __fastcall set_dhclient_block_private_ip(_DWORD, _DWORD);
// E810: using guessed type int __fastcall dhcpd_set_dns(_DWORD, _DWORD);
// EA2C: using guessed type int __fastcall get_hwaddr_kernel(_DWORD, _DWORD);
// EA50: using guessed type int __fastcall get_hwaddr_org(_DWORD, _DWORD);
// EAB0: using guessed type int __fastcall set_dns_shadow(_DWORD, _DWORD, _DWORD, _DWORD);
// EC48: using guessed type int __fastcall set_hwaddr_cloned(_DWORD, _DWORD);
// EDE0: using guessed type int __fastcall pppoe_stop(_DWORD);
// EF48: using guessed type int __fastcall dhclient_stop(_DWORD);
// F050: using guessed type int __fastcall check_invalid_hwaddr(_DWORD);
// F0B0: using guessed type int __fastcall set_default_gateway2(_DWORD, _DWORD, _DWORD, _DWORD);
// F218: using guessed type int __fastcall set_wan_type(_DWORD, _DWORD);
// F50C: using guessed type int __fastcall set_hwaddr_kernel(_DWORD, _DWORD, _DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);
// F728: using guessed type int __fastcall read_pppoe_option(_DWORD, _DWORD);
// F9EC: using guessed type int __fastcall set_wan_ipconfig(_DWORD, _DWORD, _DWORD, _DWORD);
// FA1C: using guessed type int __fastcall eth2wan(_DWORD, _DWORD);
// FC8C: using guessed type int __fastcall set_ifconfig(_DWORD);
// FCD4: using guessed type int __fastcall set_default_gateway(_DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);
// FD88: using guessed type int __fastcall check_default_gateway(_DWORD, _DWORD, _DWORD);
// FDA0: using guessed type int __fastcall save_pppoe_option(_DWORD, _DWORD);
// FDD0: using guessed type int __fastcall set_domain_name_server(_DWORD, _DWORD, _DWORD);

//----- (0003EF34) --------------------------------------------------------
int sub_3EF34()
{
  puts("<style type=\"text/css\">");
  puts(".advertise_main_table {");
  puts("\tborder-collapse:collapse; padding:0 0 0 0; margin:0 0 0 0;");
  puts("\ttable-layout:fixed;");
  puts("}");
  puts(".advertise_main_tr {");
  puts("\tborder:0 0 0 0; padding:0 0 0 0;");
  puts("}");
  puts(".advertise_main_td {");
  puts("\tpadding:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".advertise_main_p {");
  puts("\tpadding:0 0 0 5px; display:inline-block;");
  puts("\tvertical-align:middle; margin:0;");
  puts("}");
  puts(".advertise_main_span {");
  puts("\tdisplay:inline-block; vertical-align:middle;");
  puts("}");
  puts(".advertise_main_button {");
  puts("\tpadding:0 1px 0 1px; margin:0 0 0 0; font-size:12px;");
  puts("\tvertical-align:middle;");
  puts("}");
  puts(".advertise_main_td input[type=checkbox], .advertise_main_td input[type=radio] {");
  puts("display:inline-block; vertical-align:middle;");
  puts("}");
  puts("#advertise_div_msg p {");
  puts("margin:5px 0 5px 15px; text-align:left;");
  puts("}");
  puts(".advertise_ellipsis {");
  puts("text-overflow:ellipsis; overflow:hidden; white-space:nowrap; text-align:left;");
  puts("}");
  printf("input[type=\"text\"] {border:1px #CCC solid;}");
  printf("input[type=\"password\"] {border:1px #CCC solid;}");
  printf("input[type=\"checkbox\"], input[type=\"radio\"], label, span, td {cursor:default;}");
  return printf("</style>");
}

//----- (0003F0D0) --------------------------------------------------------
int sub_3F0D0()
{
  int v0; // r1@1
  int v1; // r0@1
  char *v2; // r5@1
  int v3; // r4@1
  int v4; // r1@1
  int v5; // r0@1
  char *v6; // r1@2
  int v7; // r1@4
  int v8; // r0@4
  char *v9; // r1@5
  int v10; // r1@7
  int v11; // r0@7
  int v12; // r1@7
  int v13; // r0@7
  int v14; // r1@7
  int v15; // r0@7
  int v16; // r0@7
  int v17; // r7@7
  int v18; // r1@7
  int v19; // r0@7
  int v20; // r1@7
  char *v21; // r4@8
  int v22; // r0@10
  int v23; // r1@10
  int v24; // r0@12
  int v25; // r0@12
  int v26; // r4@12
  int v27; // r1@12
  int v28; // r0@12
  int v29; // r1@13
  char *v30; // r5@15
  int v31; // r4@15
  int v32; // r1@15
  int v33; // r0@15
  int v34; // r1@17
  int v35; // r0@17
  int v36; // r1@17
  int v37; // r0@17
  int v38; // r1@17
  int v39; // r0@17
  int v40; // r1@17
  int v41; // r0@17
  int v42; // r1@17
  int v43; // r0@17
  int v44; // r1@17
  int v45; // r0@17
  int v46; // r1@17
  int v47; // r0@17
  int v48; // r1@17
  int v49; // r0@17
  int v50; // r1@17
  int v51; // r0@17
  _UNKNOWN *v52; // r4@17
  int v53; // r1@17
  int v54; // r0@17
  int v55; // r1@17
  int v56; // r0@17
  int v57; // r1@17
  int v58; // r4@17
  int v59; // r1@17
  int v60; // r0@17
  int v61; // r1@17
  int v62; // r0@17
  int v63; // r1@17
  int v64; // r0@17
  int v65; // r1@17
  int v66; // r0@17
  int v67; // r1@17
  int v68; // r0@17
  int v69; // r1@17
  int v70; // r0@17
  _UNKNOWN *v71; // r4@17
  int v72; // r1@17
  int v73; // r0@17
  int v74; // r0@17
  int v75; // r0@18
  int v76; // r0@20
  int v77; // r0@21
  _UNKNOWN *v78; // r0@23
  _UNKNOWN *v79; // r0@23
  int v80; // r1@23
  int v81; // r0@23
  int v82; // r1@23
  int v83; // r0@23
  _UNKNOWN *v84; // r0@23
  int v85; // r1@23
  int v86; // r0@23
  _UNKNOWN *v87; // r0@23
  int v88; // r1@23
  int v89; // r0@23
  _UNKNOWN *v90; // r0@23
  int v91; // r1@23
  int v92; // r0@23
  int v94; // [sp+0h] [bp-340h]@15
  char v95; // [sp+100h] [bp-240h]@1
  char v96; // [sp+200h] [bp-140h]@1
  char v97; // [sp+300h] [bp-40h]@17
  char v98; // [sp+314h] [bp-2Ch]@17

  sub_133E4((int)"expertconf", (int)"advertise");
  sub_3EF34();
  printf("<table class=\"v3_table advertise_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  puts("<form method=get action=timepro.cgi name=advertise_fm>");
  puts("<input type=hidden name=tmenu value=expertconf>");
  puts("<input type=hidden name=smenu value=advertise>");
  puts("<input type=hidden name=act value=>");
  printf("<COL width=\"105\"><COL width=\"100\"><COL width=\"100\"><COL width=\"337\">");
  printf("<tr class=\"advertise_main_tr\" height=\"24\" style=\"background-color:#E3E3E3; border-bottom:1px #CCC solid;\">\t\t<td class=\"advertise_main_td\" colspan=\"4\">");
  v1 = sub_134F4(138, v0);
  v2 = "checked";
  printf("<p class=\"advertise_main_p\">%s</p>", v1);
  printf("</td></tr>");
  v3 = get_url_redirect_option(&v96);
  get_url_redirect_whitelist(&v95);
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\">");
  v5 = sub_134F4(754, v4);
  printf("<p class=\"advertise_main_p\">%s</p>", v5);
  printf("</td><td class=\"advertise_main_td\">");
  if ( v3 )
    v6 = "checked";
  else
    v6 = "";
  printf("<input type=radio name=url_redir id=\"opertrue\" value=1 %s>", v6);
  v8 = sub_134F4(894, v7);
  printf("<label for=\"opertrue\">%s</label>", v8);
  printf("</td><td class=\"advertise_main_td\">");
  if ( v3 )
    v9 = "";
  else
    v9 = "checked";
  printf("<input type=radio name=url_redir id=\"operfalse\"value=0 %s>", v9);
  v11 = sub_134F4(900, v10);
  printf("<label for=\"operfalse\">%s</label>", v11);
  printf("</td><td class=\"advertise_main_td\">");
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\">");
  v13 = sub_134F4(8, v12);
  printf("<p class=\"advertise_main_p\">%s</p>", v13);
  printf("</td><td class=\"advertise_main_td\" colspan=\"3\">");
  v15 = sub_134F4(147, v14);
  printf(
    "<input type=text name=url_redir_url value=\"%s\" size=54 maxlength=128 placeholder=\"%s\" style=\"width:520px;\">\n",
    &v96,
    v15);
  v16 = printf("</td></tr>");
  v17 = get_url_redirect_autoconfirm(v16);
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\">");
  v19 = sub_134F4(142, v18);
  printf("<p class=\"advertise_main_p\">%s</p>", v19);
  printf("</td><td class=\"advertise_main_td\">");
  if ( v17 )
    v21 = "checked";
  else
    v21 = "";
  v22 = sub_134F4(1146, v20);
  printf(
    "<input type=radio id=\"autotrue\" name=url_redir_autoconfirm value=1 onclick='AutoConfirmAdvertise(1);' %s>\t\t<label for=\"autotrue\">%s</label>",
    v21,
    v22);
  printf("</td><td class=\"advertise_main_td\">");
  if ( v17 )
    v2 = "";
  v24 = sub_134F4(745, v23);
  printf(
    "<input type=radio id=\"autofalse\" name=url_redir_autoconfirm value=0 onclick='AutoConfirmAdvertise(0);'%s>\t\t<label for=\"autofalse\">%s</label>",
    v2,
    v24);
  printf("</td><td class=\"advertise_main_td\">");
  v25 = printf("</td></tr>");
  v26 = get_url_redirect_cycle(v25);
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\">");
  v28 = sub_134F4(145, v27);
  printf("<p class=\"advertise_main_p\">%s</p>", v28);
  printf("</td><td class=\"advertise_main_td\" colspan=\"3\">");
  printf("<span class=\"advertise_main_span\"><input type=text name=cycle size=3 maxlength=3");
  if ( v26 )
    printf(" value=%d>", v26);
  else
    putchar(62);
  v30 = "none";
  v31 = sub_134F4(528, v29);
  v33 = sub_134F4(146, v32);
  printf((const char *)&unk_8732F, v31, v33);
  printf("</td></tr>");
  get_url_redirect_btnmsg(&v94);
  if ( !v17 )
    v30 = "";
  printf(
    "<tr id=\"confirm_btn\" class=\"advertise_main_tr\" height=\"24\" style=\"display:%s;\"><td class=\"advertise_main_td\">",
    v30);
  v35 = sub_134F4(143, v34);
  printf("<p class=\"advertise_main_p\">%s</p>", v35);
  printf("</td><td class=\"advertise_main_td\" colspan=\"3\">");
  v37 = sub_134F4(144, v36);
  printf(
    "<input type=text name=btnmsg value=\"%s\" size=54 maxlength=255 placeholder=\"%s\" style=\"width:520px;\">",
    &v94,
    v37);
  printf("</td></tr>");
  get_url_redirect_usermsg(&v94);
  printf(
    "<tr id=\"confirm_msg\" class=\"advertise_main_tr\" height=\"24\" style=\"display:%s;\"><td class=\"advertise_main_td\">",
    v30);
  v39 = sub_134F4(150, v38);
  printf("<p class=\"advertise_main_p\">%s</p>", v39);
  printf("</td><td class=\"advertise_main_td\" colspan=\"3\">");
  v41 = sub_134F4(151, v40);
  printf(
    "<input type=text name=usermsg value=\"%s\" size=54 maxlength=255 placeholder=\"%s\" style=\"width:520px;\">",
    &v94,
    v41);
  printf("</td></tr>");
  get_url_redirect_usermsg2(&v94);
  printf(
    "<tr id=\"allow_msg\" class=\"advertise_main_tr\" height=\"24\" style=\"display:%s;\"><td class=\"advertise_main_td\">",
    v30);
  v43 = sub_134F4(140, v42);
  printf("<p class=\"advertise_main_p\">%s</p>", v43);
  printf("</td><td class=\"advertise_main_td\" colspan=\"3\">");
  v45 = sub_134F4(141, v44);
  printf(
    "<input type=text name=usermsg2 value=\"%s\" size=54 maxlength=255 placeholder=\"%s\" style=\"width:520px;\">",
    &v94,
    v45);
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\">");
  printf("<p class=\"advertise_main_p\">White List</p>");
  printf("</td><td class=\"advertise_main_td\" colspan=\"3\">");
  v47 = sub_134F4(15, v46);
  printf(
    "<input type=text name=whitelist value=\"%s\" size=54 maxlength=128 placeholder=\"%s\" style=\"width:520px;\">",
    &v95,
    v47);
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"5\"><td class=\"advertise_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\">");
  v49 = sub_134F4(14, v48);
  printf(
    "<p class=\"advertise_main_p\" style=\"cursor:pointer;\" onclick=\"MaskIt(document, 'desc_mask');\"><font color=\"blue\">%s</font></p>",
    v49);
  printf("</td><td class=\"advertise_main_td\" colspan=\"3\" align=\"right\" style=\"padding-right:22px;\">");
  printf("<button class=\"advertise_main_button\" style=\"width:45px;\" onclick=\"ApplyAdvertise('url_redir'); return ClickEventPropagater(event);\">");
  v51 = sub_134F4(28, v50);
  printf("<span class=\"advertise_main_span\">%s</span>", v51);
  printf("</button>");
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"5\"><td class=\"advertise_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  printf(
    "<tr id=\"confirm_desc\" class=\"advertise_main_tr\" height=\"48\" style=\"border-top:1px #CCC solid; display:%s;\">\t\t<td class=\"advertise_main_td\" colspan=\"4\">",
    v30);
  v52 = sub_126C4();
  v54 = sub_134F4(4, v53);
  printf(
    "<div style=\"height:20px; padding-left:5px;\"><img class=\"advertise_main_span\" src=\"/%s/warning.gif\" style=\"width:14px; height:14px;\">\t\t<span class=\"advertise_main_span\"><font color=\"gray\">%s</font></span></div>",
    v52,
    v54);
  v56 = sub_134F4(5, v55);
  printf(
    "<div style=\"height:20px; padding-left:19px;\"><span class=\"advertise_main_span\"><font color=\"gray\">%s</font></span></div>",
    v56);
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"24\" style=\"background-color:#E3E3E3; border-bottom:1px #CCC solid; border-top:1px #CCC solid;\">\t\t<td class=\"advertise_main_td\" colspan=\"4\">");
  v58 = sub_134F4(148, v57);
  v60 = sub_134F4(6, v59);
  printf("<span class=\"advertise_main_p\">%s <font color=\"gray\">%s</font></span>", v58, v60);
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"5\"><td class=\"advertise_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\" colspan=\"4\">");
  printf("<table class=\"v3_table advertise_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\" width=\"80\">");
  v62 = sub_134F4(389, v61);
  printf("<p class=\"advertise_main_p\">%s</p>", v62);
  printf("</td><td class=\"advertise_main_td\" width=\"305\">");
  get_ifconfig("br0", &v98, &v97);
  sub_11D7C((int)"free_sip", (int)&v98, 3);
  printf(" ~ ");
  sub_11D7C((int)"free_eip", (int)&v98, 3);
  printf("</td><td class=\"advertise_main_td\" width=\"185\">");
  v64 = sub_134F4(7, v63);
  printf("<input type=text name=\"dev_desc\" maxlength=24 size=24 style=\"width:175px;\" placeholder=\"%s\">", v64);
  printf("</td><td class=\"advertise_main_td\" width=\"72\" align=\"right\">");
  printf("<button class=\"advertise_main_button\" style=\"width:45px; margin-right:22px;\" id=\"addbtn\" \t\tonclick=\"AddAdvertiseFreeDevice(); return ClickEventPropagater(event);\">");
  v66 = sub_134F4(3, v65);
  printf("<span class=\"advertise_main_span\">%s</span>", v66);
  printf("</button>");
  printf("</td></tr>");
  printf("</table>");
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"5\" style=\"border-bottom:1px #CCC solid;\"><td class=\"advertise_main_td\" colspan=\"4\">");
  printf("</td></tr>");
  printf("<tr class=\"advertise_main_tr\" height=\"24\" style=\"border-bottom:1px #CCC solid;\"><td class=\"advertise_main_td\" colspan=\"4\">");
  printf("<table class=\"v3_table advertise_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<tr class=\"advertise_main_tr\" height=\"24\"><td class=\"advertise_main_td\" width=\"30\">");
  printf("</td><td class=\"advertise_main_td\" width=\"250\">");
  v68 = sub_134F4(401, v67);
  printf("<span class=\"advertise_main_span\">%s</span>", v68);
  printf("</td><td class=\"advertise_main_td\" width=\"300\">");
  v70 = sub_134F4(215, v69);
  printf("<span class=\"advertise_main_span\">%s</span>", v70);
  printf("</td><td class=\"advertise_main_td\" align=\"right\">");
  v71 = sub_126C4();
  v73 = sub_134F4(118, v72);
  printf(
    "<span class=\"advertise_main_span\" style=\"width:40px; cursor:pointer; margin-right:22px;\" onclick=\"DeleteAdvertiseFreeDevice();\">\t\t<img src=\"/%s/minus_icon.gif\">%s</span>",
    v71,
    v73);
  printf("</td></tr></table>");
  printf("</td></tr>");
  v74 = printf("<tr class=\"advertise_main_tr\" height=\"96\" style=\"border-bottom:1px #CCC solid;\"><td class=\"advertise_main_td\" colspan=\"4\">");
  if ( is_mobile_agent(v74) )
  {
    sub_12790((int)"96", (int)"100%%", (int)"display:inline-block; *display:inline; zoom:1;");
    v75 = printf("<iframe name=\"advertiseexlist_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=advertiseexlist\"                         frameborder=no width=100%% height=96 align=center scrolling=auto></iframe>");
    sub_12770(v75);
  }
  else
  {
    printf("<iframe name=\"advertiseexlist_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=advertiseexlist\"                         frameborder=no width=100%% height=96 align=center scrolling=auto></iframe>");
  }
  printf("</td></tr>");
  v76 = printf("</form></table>");
  if ( is_mobile_agent(v76) )
  {
    sub_12790((int)"0", (int)"0", (int)"display:inline-block; *display:inline; zoom:1;");
    v77 = printf("<iframe name=\"hiddenadvertisesetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenadvertisesetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
    sub_12770(v77);
  }
  else
  {
    printf("<iframe name=\"hiddenadvertisesetup_iframe\" src=\"timepro.cgi?tmenu=iframe&smenu=hiddenadvertisesetup\"                         frameborder=no width=0 height=0 align=center scrolling=no></iframe>");
  }
  printf("<DIV id=\"%s\" style=\"display:none;\">", "apply_mask");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v78 = sub_126C4();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v78);
  printf("</SPAN></td>");
  printf("<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\" id=\"advertise_div_msg\">\n");
  printf("</SPAN></td>");
  printf((const char *)&unk_60F0E);
  printf("<DIV id=\"%s\" style=\"display:none;\" onclick=\"UnMaskIt(document, '%s');\">");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:91px; top:178px; width:460px; height:125px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"460\" height=\"125\">");
  puts("<tr height=\"22\"><td width=\"10\" align=\"center\" valign=\"middle\">");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v79 = sub_126C4();
  printf(
    "<img src=\"/%s/pf_square_icon.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v79);
  printf("</SPAN></td>");
  puts("<td width=\"450\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:left;\">");
  v81 = sub_134F4(9, v80);
  printf("<font color=\"gray\">%s</font>", v81);
  printf("</SPAN></td></tr>");
  puts("<tr height=\"22\"><td width=\"10\" align=\"center\" valign=\"middle\">");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  printf("</SPAN></td>");
  puts("<td width=\"450\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:left;\">");
  v83 = sub_134F4(10, v82);
  printf("<font color=\"gray\">%s</font>", v83);
  printf("</SPAN></td></tr>");
  puts("<tr height=\"22\"><td width=\"10\" align=\"center\" valign=\"middle\">");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v84 = sub_126C4();
  printf(
    "<img src=\"/%s/pf_square_icon.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v84);
  printf("</SPAN></td>");
  puts("<td width=\"450\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:left;\">");
  v86 = sub_134F4(11, v85);
  printf("<font color=\"gray\">%s</font>", v86);
  printf("</SPAN></td></tr>");
  puts("<tr height=\"22\"><td width=\"10\" align=\"center\" valign=\"middle\">");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v87 = sub_126C4();
  printf(
    "<img src=\"/%s/pf_square_icon.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v87);
  printf("</SPAN></td>");
  puts("<td width=\"450\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:left;\">");
  v89 = sub_134F4(12, v88);
  printf("<font color=\"gray\">%s</font>", v89);
  printf("</SPAN></td></tr>");
  puts("<tr height=\"22\"><td width=\"10\" align=\"center\" valign=\"middle\">");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v90 = sub_126C4();
  printf(
    "<img src=\"/%s/pf_square_icon.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v90);
  printf("</SPAN></td>");
  puts("<td width=\"450\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:left;\">");
  v92 = sub_134F4(13, v91);
  printf("<font color=\"gray\">%s</font>", v92);
  printf("</SPAN></td></tr>");
  return printf((const char *)&unk_60F13);
}
// EA80: using guessed type int __fastcall get_url_redirect_option(_DWORD);
// EAE0: using guessed type int __fastcall get_url_redirect_usermsg(_DWORD);
// F320: using guessed type int __fastcall get_ifconfig(_DWORD, _DWORD, _DWORD);
// F488: using guessed type int __fastcall get_url_redirect_whitelist(_DWORD);
// F4C4: using guessed type int __fastcall get_url_redirect_btnmsg(_DWORD);
// F74C: using guessed type int __fastcall is_mobile_agent(_DWORD);
// F7E8: using guessed type int __fastcall get_url_redirect_autoconfirm(_DWORD);
// F8B4: using guessed type int __fastcall get_url_redirect_usermsg2(_DWORD);
// FAD0: using guessed type int __fastcall get_url_redirect_cycle(_DWORD);

//----- (0003FB00) --------------------------------------------------------
int __fastcall sub_3FB00(int a1)
{
  int v1; // r6@1
  int result; // r0@1
  char *v3; // r0@7
  int v4; // r4@9
  bool v5; // zf@13
  int v6; // r0@15
  char v7; // [sp+8h] [bp-110h]@1
  char v8; // [sp+88h] [bp-90h]@6
  char v9; // [sp+C8h] [bp-50h]@4
  char v10; // [sp+E8h] [bp-30h]@3

  v1 = a1;
  result = get_value_post(a1, "act", &v7, 32);
  if ( result )
  {
    if ( !strcmp(&v7, "add") )
    {
      result = get_ip_value_post(v1, "free_sip", &v10);
      if ( result )
      {
        if ( !get_ip_value_post(v1, "free_eip", &v9) )
          strcpy(&v9, &v10);
        snprintf2(&v8, 64, "%s-%s", &v10, &v9);
        memset(&v7, 0, 0x80u);
        get_value_post(v1, &unk_885BA, &v7, 128);
        result = check_unpermitted_chars(&v7);
        if ( !result )
        {
          v3 = (char *)add_url_redir_freedevice(&v8);
LABEL_15:
          v6 = signal_save(v3);
          return signal_update(v6);
        }
      }
    }
    else
    {
      result = strcmp(&v7, "del");
      if ( !result )
      {
        v4 = 0;
        while ( 1 )
        {
          v5 = get_value_array_post(v1, "delchk", v4, &v10) == 0;
          v3 = &v10;
          if ( v5 )
            break;
          if ( !check_unpermitted_chars(&v10) )
          {
            remove_url_redir_freedevice(&v10);
            ++v4;
          }
        }
        goto LABEL_15;
      }
    }
  }
  return result;
}
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// F11C: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F668: using guessed type int __fastcall remove_url_redir_freedevice(_DWORD);
// F704: using guessed type int __fastcall add_url_redir_freedevice(_DWORD);
// F9BC: using guessed type int __fastcall get_value_array_post(_DWORD, _DWORD, _DWORD, _DWORD);
// FB3C: using guessed type int __fastcall get_ip_value_post(_DWORD, _DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);

//----- (0003FC88) --------------------------------------------------------
int __fastcall sub_3FC88(int a1, int a2)
{
  int v2; // r4@1
  signed int v3; // r4@1
  int v4; // r0@2
  signed int v5; // r2@2
  char *v6; // r1@2
  char *v7; // r1@3
  char *v8; // r1@5
  int v9; // r0@11
  int v11; // [sp+0h] [bp-1D0h]@2
  char v12; // [sp+100h] [bp-D0h]@3
  char v13; // [sp+140h] [bp-90h]@2
  char s1; // [sp+180h] [bp-50h]@6
  char v15; // [sp+1A0h] [bp-30h]@4

  v2 = a2;
  sub_3EF34();
  sub_3FB00(v2);
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0;\">");
  printf("<table class=\"v3_table advertise_main_table\" width=\"100%%\" style=\"padding:0; margin:0;\">\n");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"advertisefreedevice_fm\">");
  printf("<COL width=\"30\"><COL width=\"250\"><COL width=\"300\"><COL width=\"30\"><COL width=\"%%%%\">");
  v3 = 0;
  do
  {
    v4 = get_url_redir_freedevice(v3, &v13, &v11);
    v5 = 64;
    v6 = &v13;
    if ( v4 < 0 )
      break;
    sf_strncpy(&v12, &v13, 64);
    v7 = strtok(&v13, "-");
    if ( v7 )
      sf_strncpy(&v15, v7, 32);
    v8 = strtok(0, "-");
    if ( v8 )
      sf_strncpy(&s1, v8, 32);
    sf_strncpy(&v13, &v12, 64);
    ++v3;
    printf("<tr class=\"advertise_main_tr\" height=\"24\" style=\"background-color:#%s;\">\t\t\t<td class=\"advertise_main_td\">");
    printf("<p class=\"advertise_main_p\">%d</p>", v3);
    printf("</td><td class=\"advertise_main_td\">");
    strcmp(&s1, "0.0.0.0");
    printf("<span class=\"advertise_main_span\">%s</span>");
    printf("</td><td class=\"advertise_main_td\">");
    printf("<span class=\"advertise_main_span\">%s</span>", &v11);
    printf("</td><td class=\"advertise_main_td\" align=\"right\">");
    printf("<div>");
    printf("<input type=checkbox name=delchk value=\"%s\">", &v13);
    printf("</div>");
    printf("</td><td class=\"advertise_main_td\"></td></tr>");
  }
  while ( v3 != 10 );
  while ( v3 <= 3 )
  {
    printf("<tr class=\"advertise_main_tr\" height=\"24\" style=\"background-color:#%s;\">\t\t\t<td class=\"advertise_main_td\" colspan=\"5\">");
    printf("</td></tr>");
    ++v3;
  }
  printf("</form>", v6, v5);
  printf("</table>");
  printf("</BODY>");
  printf("<script>");
  v9 = puts("UnMaskIt(parent.document, 'apply_mask');");
  get_url_redir_freedevice_num(v9);
  printf("if(parent.window.setAddBtnDisable)parent.window.setAddBtnDisable(%s)");
  return printf("</script>");
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// F41C: using guessed type int __fastcall get_url_redir_freedevice_num(_DWORD);
// FA88: using guessed type int __fastcall get_url_redir_freedevice(_DWORD, _DWORD, _DWORD);

//----- (0003FED0) --------------------------------------------------------
signed int __fastcall sub_3FED0(const char *a1)
{
  const char *v1; // r6@1
  size_t v2; // r4@1
  size_t v3; // r5@1
  char *v4; // r0@2

  v1 = a1;
  v2 = 0;
  v3 = strlen(a1);
  while ( v2 < v3 )
  {
    v4 = strchr("&;|`\\><\"'`", v1[v2++]);
    if ( v4 )
      return 1;
  }
  return 0;
}

//----- (0003FF24) --------------------------------------------------------
int __fastcall sub_3FF24(int a1)
{
  int v1; // r7@1
  int result; // r0@1
  int v3; // r8@4
  int v4; // r0@8
  int v5; // r0@9
  char *v6; // r0@13
  char *v7; // r0@19
  char *v8; // r0@25
  char *v9; // r0@31
  int v10; // r0@35
  int v11; // r0@35
  int v12; // r0@37
  int v13; // [sp+0h] [bp-418h]@1
  char v14; // [sp+200h] [bp-218h]@6
  char v15; // [sp+300h] [bp-118h]@6

  v1 = a1;
  result = get_value_post(a1, "act", &v13, 32);
  if ( !result )
    return result;
  result = strcmp((const char *)&v13, "url_redir");
  if ( result )
    return result;
  result = get_value_post(v1, "url_redir", &v13, 512);
  if ( !result )
    return result;
  v3 = atoi((const char *)&v13);
  result = get_value_post(v1, "url_redir_url", &v13, 512);
  if ( !result )
    return result;
  result = sub_3FED0((const char *)&v13);
  if ( result )
    return result;
  sf_strncpy(&v15, &v13, 63);
  sf_strncpy(&v14, &v15, 63);
  strtoupper(&v14);
  result = (int)strstr(&v14, "<SCRIPT>");
  if ( result )
    return result;
  set_url_redirect_option(v3, &v15);
  result = get_value_post(v1, &unk_88821, &v13, 512);
  if ( !result )
    return result;
  v4 = atoi((const char *)&v13);
  set_url_redirect_autoconfirm(v4);
  if ( get_value_post(v1, "cycle", &v13, 512) )
    v5 = atoi((const char *)&v13);
  else
    v5 = -1;
  set_url_redirect_cycle(v5);
  if ( !get_value_post(v1, "whitelist", &v13, 512) || sub_3FED0((const char *)&v13) )
  {
    v6 = &v15;
LABEL_16:
    strcpy(v6, "");
    goto LABEL_17;
  }
  sf_strncpy(&v15, &v13, 128);
  sf_strncpy(&v14, &v15, 128);
  strtoupper(&v14);
  if ( strstr(&v14, "<SCRIPT>") )
  {
    v6 = &v15;
    goto LABEL_16;
  }
LABEL_17:
  set_url_redirect_whitelist(&v15);
  if ( !get_value_post(v1, "btnmsg", &v13, 512) || check_unpermitted_chars(&v13) )
  {
    v7 = &v15;
LABEL_22:
    strcpy(v7, "");
    goto LABEL_23;
  }
  sf_strncpy(&v15, &v13, 255);
  sf_strncpy(&v14, &v15, 255);
  strtoupper(&v14);
  if ( strstr(&v14, "<SCRIPT>") )
  {
    v7 = &v15;
    goto LABEL_22;
  }
LABEL_23:
  set_url_redirect_btnmsg(&v15);
  if ( !get_value_post(v1, "usermsg", &v13, 512) || check_unpermitted_chars(&v13) )
  {
    v8 = &v15;
LABEL_28:
    strcpy(v8, "");
    goto LABEL_29;
  }
  sf_strncpy(&v15, &v13, 255);
  sf_strncpy(&v14, &v15, 255);
  strtoupper(&v14);
  if ( strstr(&v14, "<SCRIPT>") )
  {
    v8 = &v15;
    goto LABEL_28;
  }
LABEL_29:
  set_url_redirect_usermsg(&v15);
  if ( !get_value_post(v1, "usermsg2", &v13, 512) || check_unpermitted_chars(&v13) )
  {
    v9 = &v15;
LABEL_34:
    strcpy(v9, "");
    goto LABEL_35;
  }
  sf_strncpy(&v15, &v13, 255);
  sf_strncpy(&v14, &v15, 255);
  strtoupper(&v14);
  if ( strstr(&v14, "<SCRIPT>") )
  {
    v9 = &v15;
    goto LABEL_34;
  }
LABEL_35:
  v10 = set_url_redirect_usermsg2(&v15);
  v11 = clear_url_redirection(v10);
  if ( v3 )
    v11 = init_url_redirection(0);
  v12 = signal_save(v11);
  return signal_update(v12);
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// ED14: using guessed type int __fastcall clear_url_redirection(_DWORD);
// ED50: using guessed type int __fastcall set_url_redirect_cycle(_DWORD);
// ED8C: using guessed type int __fastcall set_url_redirect_autoconfirm(_DWORD);
// EF3C: using guessed type int __fastcall init_url_redirection(_DWORD);
// F11C: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F3B0: using guessed type int __fastcall strtoupper(_DWORD);
// F500: using guessed type int __fastcall set_url_redirect_btnmsg(_DWORD);
// F6A4: using guessed type int __fastcall set_url_redirect_usermsg(_DWORD);
// FA58: using guessed type int __fastcall set_url_redirect_usermsg2(_DWORD);
// FB48: using guessed type int __fastcall set_url_redirect_option(_DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);
// FDB8: using guessed type int __fastcall set_url_redirect_whitelist(_DWORD);

//----- (000402DC) --------------------------------------------------------
int __fastcall sub_402DC(int a1, int a2)
{
  sub_3FF24(a2);
  printf("<BODY style=\"display:block; vertical-align:middle; padding:0 0 0 0; margin:0 0 0 0; border:0 0 0 0; overflow:hidden;\">");
  printf("<form action=\"timepro.cgi\" method=\"post\" name=\"expertconf_hiddenadvertisesetup\">");
  printf("</form>");
  printf("</BODY>");
  printf("<script>");
  printf("UnMaskIt(parent.document, 'apply_mask');");
  return printf("</script>");
}

//----- (00040340) --------------------------------------------------------
int __fastcall sub_40340(int a1)
{
  int v1; // r4@1
  const char *v2; // r0@1
  int v3; // r1@3
  int v4; // r0@4
  int v5; // r0@5
  int v6; // r0@5
  int v7; // r0@6
  int v8; // r0@9
  const char *v9; // r0@12
  int v10; // r1@14
  int v11; // r0@15
  int v12; // r1@16
  int v13; // r0@17
  int v14; // r0@18
  const char *v15; // r0@20
  int v16; // r0@21
  const char *v17; // r0@22
  char *v18; // r0@24
  char *v19; // r4@24
  int v20; // r0@26
  char format; // [sp+Ch] [bp-254h]@3
  char v23; // [sp+10Ch] [bp-154h]@11
  char v24; // [sp+20Ch] [bp-54h]@26
  char v25; // [sp+220h] [bp-40h]@5
  char v26; // [sp+234h] [bp-2Ch]@10

  v1 = a1;
  puts("<html>");
  puts("<script type=\"text/javascript\">");
  puts("<!--");
  puts("function detectmob()");
  puts("{");
  puts("\tif(navigator.userAgent.match(/Android/i) || navigator.userAgent.match(/webOS/i) || navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/iPod/i) || navigator.userAgent.match(/BlackBerry/i) || navigator.userAgent.match(/Windows Phone/i))");
  puts("\t\treturn true;");
  puts("\telse");
  puts("\t\treturn false;");
  puts("}");
  puts("//-->");
  puts("</script>");
  v2 = (const char *)get_pvalue(v1, "subpage");
  if ( v2 && !strcmp(v2, "allow") )
  {
    printf("<table width=100%%><tr><td align=center>");
    printf("<span ID='str' style='color:#1e3269; font:normal normal bold 12px arial;'>");
    get_url_redirect_usermsg2(&format);
    if ( !format )
    {
      v4 = sub_134F4(139, v3);
      sf_strncpy(&format, v4, 256);
    }
    printf(&format);
    printf("</span>");
    printf("</td></tr></table>");
    puts("<script type=\"text/javascript\">");
    puts("<!--");
    puts("if(detectmob())");
    puts("{");
    puts("\tdocument.getElementById('str').style.fontSize='26px';");
    puts("}");
    puts("//-->");
    v5 = puts("</script>");
    v6 = get_remote_addr(v5);
    sf_strncpy(&v25, v6, 20);
    if ( !strcmp(&v25, "Twin IP (WAN2)") )
    {
      v7 = (int)"wan2";
    }
    else
    {
      if ( strncmp(&v25, "Twin IP", 7u) )
        goto LABEL_10;
      v7 = (int)"wan1";
    }
    v8 = get_twinip_wan_virtual_ip(v7);
    sf_strncpy(&v25, v8, 20);
LABEL_10:
    if ( get_hwaddr_by_ip(&v25, &v26) )
    {
      snprintf2(&v23, 256, "/sbin/iptables -t nat -D url_redir -m mac --mac-source %s -j RETURN", &v26);
      system(&v23);
      snprintf2(&v23, 256, "/sbin/iptables -t nat -I url_redir -m mac --mac-source %s -j RETURN", &v26);
      system(&v23);
      snprintf2(&v23, 256, (const char *)&unk_88B86, &v26);
      system(&v23);
    }
    return puts("</html>");
  }
  v9 = (const char *)get_pvalue(v1, "subpage");
  if ( v9 && !strcmp(v9, "frame2") )
  {
    puts("<form method=get action=urlredir.cgi name=misc_fm>");
    puts("<input type=hidden name=page value=url_redirect>");
    puts("<input type=hidden name=subpage value=allow>");
    printf("<table width=100%%><tr><td align=center>");
    printf("<span ID='str' style='color:#1e3269; font:normal normal bold 12px arial;'>");
    get_url_redirect_usermsg(&format);
    if ( !format )
    {
      v11 = sub_134F4(149, v10);
      strcpy(&format, (const char *)v11);
    }
    printf(&format);
    get_url_redirect_btnmsg(&format);
    if ( !format )
    {
      v13 = sub_134F4(59, v12);
      strcpy(&format, (const char *)v13);
    }
    printf("</span><br>");
    printf("<input ID='bt' type=submit value='%s'>\n", &format);
    printf("</td></tr></table>");
    puts("</form>");
    puts("<script type=\"text/javascript\">");
    puts("<!--");
    puts("if(detectmob())");
    puts("{");
    puts("\tdocument.getElementById('str').style.fontSize='26px';");
    puts("\tdocument.getElementById('bt').style.fontSize='30px';");
    v14 = puts("}");
    if ( get_url_redirect_autoconfirm(v14) )
      printf("document.misc_fm.submit()");
    puts("//-->");
    v15 = "</script>";
  }
  else
  {
    get_url_redirect_option(&v23);
    puts("<head>");
    v16 = puts("</head>");
    if ( get_url_redirect_autoconfirm(v16) )
      v17 = "<frameset rows='100%%,0%%' frameborder=0>\n";
    else
      v17 = "<frameset rows='90%%,10%%' frameborder=0>\n";
    printf(v17);
    v18 = strrchr(&v23, 63);
    v19 = v18;
    if ( v18 && !strcmp(v18 + 1, "tx2useri2firstpage") )
    {
      *v19 = 0;
      v20 = get_remote_addr(0);
      sf_strncpy(&v26, v20, 20);
      get_hwaddr_by_ip(&v26, &v25);
      get_hwaddr_kernel("br0", &v24);
      printf("<frame src='%s?umac=%s&uip=%s&apmac=%s'>\n", &v23, &v25, &v26, &v24);
    }
    else
    {
      printf("<frame src='%s'>\n", &v23);
    }
    puts("<frame src='urlredir.cgi?page=url_redirect&subpage=frame2'>");
    v15 = "</frameset>";
  }
  puts(v15);
  return puts("</html>");
}
// E7F8: using guessed type int __fastcall get_remote_addr(_DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E9D8: using guessed type int __fastcall get_hwaddr_by_ip(_DWORD, _DWORD);
// EA2C: using guessed type int __fastcall get_hwaddr_kernel(_DWORD, _DWORD);
// EA80: using guessed type int __fastcall get_url_redirect_option(_DWORD);
// EAE0: using guessed type int __fastcall get_url_redirect_usermsg(_DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// F4C4: using guessed type int __fastcall get_url_redirect_btnmsg(_DWORD);
// F7E8: using guessed type int __fastcall get_url_redirect_autoconfirm(_DWORD);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);
// F8B4: using guessed type int __fastcall get_url_redirect_usermsg2(_DWORD);
// F920: using guessed type int __fastcall get_twinip_wan_virtual_ip(_DWORD);

//----- (00040800) --------------------------------------------------------
int sub_40800()
{
  int v0; // r4@1

  printf("<style>");
  printf((const char *)&unk_88DA0);
  printf("</style>");
  printf("<table id='list_table' cellspacing=0px cellpadding=0px style='width: 100%%;'>\n");
  v0 = 0;
  do
  {
    ++v0;
    printf("<tr style='height: 24px; %s'><td colspan=4></td></tr>");
  }
  while ( v0 != 4 );
  printf("</table>");
  return printf("<iframe name=\"experconf_iptv_macgroup_status\" src=\"timepro.cgi?tmenu=iframe&smenu=experconf_iptv_macgroup_status\" frameborder=no style='display:none;'></iframe>");
}

//----- (00040884) --------------------------------------------------------
int __fastcall sub_40884(const char *a1, int a2)
{
  int v2; // r5@1
  const char *v3; // r4@1
  _UNKNOWN *v4; // r0@3

  v2 = a2;
  v3 = a1;
  if ( !strcmp(a1, "reboot_mask") )
  {
    printf("<style>");
    printf("#%s p { margin: 5px 0 5px 15px; text-align: left; }", v3);
    printf("</style>");
  }
  printf("<DIV id=\"%s\" style=\"display:none;\">", v3);
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:231px; top:198px; width:180px; height:70px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  puts("<table width=\"180\" height=\"70\">");
  printf("<tr><td width=\"20%%\" height=\"100%%\" align=\"center\" valign=\"middle\">\n");
  puts("<SPAN style=\"vertical-align:middle; display:block; text-align:center;\">");
  v4 = sub_126C4();
  printf(
    "<img src=\"/%s/apply_ani.gif\" style=\"display:inline-block; *display:inline; zoom:1; vertical-align:middle;\">",
    v4);
  printf("</SPAN></td>");
  printf(
    "<td width=\"80%%\" height=\"100%%\" align=\"center\" valign=\"middle\">                <SPAN style=\"vertical-align:middle; display:block; text-align:center;\">%s\n",
    v2);
  printf("</SPAN></td>");
  return printf((const char *)&unk_60F0E);
}

//----- (0004096C) --------------------------------------------------------
int sub_4096C()
{
  int v0; // r0@1
  char *v1; // r5@1
  int v2; // r4@1
  char *v3; // r1@2
  int v4; // r1@4
  int v5; // r0@4
  char *v6; // r2@5
  int v7; // r1@7
  int v8; // r0@7
  int v9; // r1@7
  int v10; // r4@7
  int v11; // r1@9
  int v12; // r0@9
  int v13; // r4@9
  int v14; // r0@9
  int v15; // r1@9
  int v16; // r0@9
  int v17; // r1@9
  int v18; // r0@9
  int v19; // r1@9
  int v20; // r0@9
  int v21; // r1@9
  int v22; // r0@9
  int v23; // r1@9
  int v24; // r0@9
  int v25; // r1@9
  int v26; // r0@9
  int v27; // r1@9
  int v28; // r0@9

  v0 = puts("<table cellpadding=0px cellspacing=0px style='width: 641px; background-color: #EEE;'>");
  v1 = "";
  v2 = get_iptv_config(v0);
  sub_133E4((int)"expertconf", (int)"iptv");
  puts("<form method=post action=\"timepro.cgi\" name=\"iptv_fm\">");
  puts("<input type=hidden name=\"tmenu\" value='expertconf'>");
  puts("<input type=hidden name=\"smenu\" value='iptv'>");
  puts("<input type=hidden name=\"act\" value=\"iptv\">");
  printf("<input type=hidden name=\"cur_op\" value=\"%d\">\n", v2);
  puts("<input type=hidden name=commit>");
  puts("<tr><td>");
  printf("<table cellspacing=0px cellpadding=0px style='width:100%%; margin-top: 10px; padding: 0 0 10px 5px; border-bottom: 1px solid #CCC;'>\n");
  printf("<tr>");
  puts("<td colspan=2 style='padding: 4px 0;'>");
  if ( v2 )
    v3 = "";
  else
    v3 = "checked";
  printf("<input type=radio id='mc_run_nouse' name=\"mc_run\" value=0 style='vertical-align: bottom;' %s>", v3);
  v5 = sub_134F4(398, v4);
  printf("<label for='mc_run_nouse'>%s</label>", v5);
  printf("</td>");
  printf("</tr>");
  printf("<tr>");
  printf("<td>");
  if ( v2 == 2 )
    v6 = "checked";
  else
    v6 = "";
  printf("<input type=radio id='mc_run_private' name=\"mc_run\" value=%d style='vertical-align: bottom;' %s>", 2, v6);
  v8 = sub_134F4(399, v7);
  printf("<label for='mc_run_private'>%s</label>", v8);
  printf("</td>");
  printf("<td style='padding: 1px 0;'>");
  v10 = sub_134F4(544, v9);
  if ( !get_igmp_proxy() )
    v1 = "disabled";
  printf(
    "<input type=button name='mcgroup_bt' value='%s' style='float: right; margin-right: 10px;' \tonclick=\"showGroupList();\" %s>",
    v10,
    v1);
  printf("</td>");
  printf("</tr>");
  printf("<tr>");
  printf("<td colspan=2 style='padding: 4px 0;'>");
  printf("</td>");
  printf("</tr>");
  puts("</table></td></tr>");
  printf("<tr>");
  puts("<td align=right width=43>");
  v12 = sub_134F4(28, v11);
  v13 = v12;
  v14 = hwinfo_get_reboot_duration(v12);
  printf(
    "<input type=button name=\"mc_apply\" value=\"%s\" style='margin:10px;' onclick=\"setIPTV(%d, false);\">\n",
    v13,
    v14);
  printf("<iframe name=\"expertconf_iptv_setup_status\" src=\"timepro.cgi?tmenu=iframe&smenu=expertconf_iptv_setup_status\" frameborder=no style='display:none;'></iframe>");
  printf("</td>");
  printf("</tr>");
  printf("</form>");
  printf("<script> CheckIPTVForm(); </script>");
  printf("</table>");
  v16 = sub_134F4(191, v15);
  sub_40884("reboot_mask", v16);
  v18 = sub_134F4(27, v17);
  sub_40884("apply_mask", v18);
  printf("<style>");
  printf(".title td { border-bottom: 1px solid #CCC; }");
  printf("</style>");
  printf("<DIV id='macgroup_list' style=\"display:none;\">");
  puts("<DIV style=\"position:absolute; left:0px; top:0px; width:642px; height:535px; z-index:10; background-color:#ffffff;                 opacity:0.5; -moz-opacity:0.5; -khtml-opacity:0.5; -webkit-opacity:0.5; filter:alpha(opacity=50);\" onclick=\"hideGroupList();\">");
  printf("</DIV>");
  puts("<DIV style=\"position:absolute; left:75px; top:130px; width:480px; height:242px; z-index:100; background-color:#ffffff;                 opacity:1; -moz-opacity:1; -khtml-opacity:1; -webkit-opacity:1; filter:alpha(opacity=100); border:1px #CCC solid;                 box-shadow:5px 5px 20px #888888;\">");
  printf("<table cellspacing=0px cellpadding=0px style='width: 100%%;'>\n");
  printf("<colgroup><col width=180px><col width=145px><col width=70px></colgroup>");
  printf("<tr style='background-color: #DBDBDB; height: 24px;'><td colspan=4 style='border-bottom: 1px solid #CCC;'>");
  v20 = sub_134F4(544, v19);
  printf("<b style='margin-left: 5px;'>%s</b>", v20);
  printf("</td></tr>");
  printf("<tr class=title style='height: 24px; background-color: #E7E7E7; border-bottom: 1px solid #CCC;'>");
  v22 = sub_134F4(543, v21);
  printf("<td style='width: 180px;'><span style='margin-left: 5px;'>%s</span></td>", v22);
  v24 = sub_134F4(545, v23);
  printf("<td>%s</td>", v24);
  v26 = sub_134F4(546, v25);
  printf("<td>%s</td>", v26);
  v28 = sub_134F4(547, v27);
  printf("<td>%s</td>", v28);
  printf("</tr>");
  printf("</table>");
  printf("<iframe name=\"experconf_iptv_macgroup\" src=\"timepro.cgi?tmenu=iframe&smenu=experconf_iptv_macgroup\" frameborder=no style='width:100%%; height:192px;'></iframe>");
  printf("</DIV>");
  return printf("</DIV>");
}
// E900: using guessed type int __fastcall get_iptv_config(_DWORD);
// EBAC: using guessed type int __fastcall hwinfo_get_reboot_duration(_DWORD);
// F644: using guessed type int get_igmp_proxy(void);

//----- (00040D28) --------------------------------------------------------
int __fastcall sub_40D28(int a1, int a2)
{
  int v2; // r5@1
  int v3; // r6@1
  int v4; // r0@4
  bool v5; // zf@4
  signed int v6; // r4@7
  int v7; // r4@9
  int v8; // r0@9
  int v9; // r0@10
  signed int v10; // r4@10
  int result; // r0@13
  int v12; // [sp+0h] [bp-30h]@1

  v2 = a2;
  v3 = get_iptv_config(a1);
  if ( get_value_post(v2, "act", &v12, 32)
    && !strcmp((const char *)&v12, "mc")
    && get_value_post(v2, "mc_run", &v12, 32) )
  {
    v4 = atoi((const char *)&v12);
    v5 = v3 == 1;
    if ( v3 != 1 )
      v5 = v4 == 1;
    v6 = !v5;
    v7 = v6 ^ 1;
    v8 = set_iptv_config(v4, v7);
    if ( v7 )
    {
      saveconf(v8);
      signal_reboot(3);
      v10 = 1;
    }
    else
    {
      v9 = signal_update(v8);
      v10 = 1;
      signal_save(v9);
    }
  }
  else
  {
    v10 = 0;
  }
  sub_133E4((int)"expertconf", (int)"iptv");
  puts("<form method=post action=\"timepro.cgi\" name=\"iptv_fm\">");
  puts("<input type=hidden name=\"tmenu\" value='iframe'>");
  puts("<input type=hidden name=\"smenu\" value='expertconf_iptv_setup_status'>");
  puts("<input type=hidden name=\"act\" value=\"iptv\">");
  puts("<input type=hidden name=mc_run value=''>");
  result = printf("</form>");
  if ( v10 )
  {
    printf("<script>");
    printf((const char *)&unk_69E61);
    result = printf("</script>");
  }
  return result;
}
// E900: using guessed type int __fastcall get_iptv_config(_DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EAC8: using guessed type int __fastcall set_iptv_config(_DWORD, _DWORD);
// F110: using guessed type int __fastcall saveconf(_DWORD);
// F224: using guessed type int __fastcall get_value_post(_DWORD, _DWORD, _DWORD, _DWORD);
// F6B0: using guessed type int __fastcall signal_reboot(_DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);

//----- (00040E78) --------------------------------------------------------
int __fastcall sub_40E78(int a1)
{
  int result; // r0@1
  int v2; // r4@2
  FILE *v3; // r0@3
  FILE *v4; // r10@3
  signed int v5; // r6@4
  char *v6; // r0@8
  const char *v7; // r7@9
  int v8; // r0@9
  char v9; // r5@9
  char *v10; // r0@10
  int v11; // r4@11
  char *v12; // r0@11
  char *v13; // r0@13
  const char *v14; // r4@14
  char *v15; // r0@14
  int v16; // r5@15
  char *v17; // r0@15
  int v18; // r0@16
  int v19; // r1@16
  int v20; // r0@17
  int v21; // r0@21
  int v22; // [sp+0h] [bp-C0h]@8
  char v23; // [sp+80h] [bp-40h]@1

  result = get_value(a1, "act", &v23, 32);
  if ( !result )
    return result;
  result = strcmp(&v23, "print");
  v2 = result;
  if ( result )
    return result;
  printf("<table id='list_table' cellspacing=0px cellpadding=0px style='width: 100%%;'>\n");
  printf("<colgroup><col width=180px><col width=145px><col width=70px></colgroup>");
  v3 = fopen("/var/run/mcgroup", "r");
  v4 = v3;
  if ( v3 )
    v5 = v2;
  else
    v5 = (signed int)v3;
  if ( v3 )
  {
    while ( 1 )
    {
      while ( 1 )
      {
        do
        {
          if ( !fgets((char *)&v22, 128, v4) )
            goto LABEL_26;
          v6 = strchr((const char *)&v22, 32);
        }
        while ( !v6 );
        *v6 = 0;
        v7 = v6 + 1;
        v8 = strcmp((const char *)&v22, "G");
        v9 = v8;
        if ( v8 )
          break;
        v10 = strchr(v7, 32);
        if ( v10 )
        {
          *v10 = v9;
          v11 = (int)(v10 + 1);
          v12 = strchr(v10 + 1, 32);
          if ( v12 )
          {
            *v12 = v9;
            printf("<tr style='height: 24px; %s'>");
            printf("<td colspan=4 style='padding-left: 5px;'> %s (%s)</td>\n", v7, v11);
            printf("</tr>");
            goto LABEL_22;
          }
        }
      }
      v13 = strchr(v7, 32);
      if ( v13 )
      {
        *v13 = 0;
        v14 = v13 + 1;
        v15 = strchr(v13 + 1, 32);
        if ( v15 )
        {
          *v15 = 0;
          v16 = (int)(v15 + 1);
          v17 = strchr(v15 + 1, 10);
          if ( v17 )
          {
            *v17 = 0;
            printf("<tr style='height: 24px; %s'>");
            puts("<td></td>");
            printf("<td>%s</td>\n", v7);
            v18 = atoi(v14);
            if ( v18 >= 0 )
            {
              if ( v18 > 31 )
                v20 = sub_134F4(1182, v19);
              else
                v20 = (int)v14;
            }
            else
            {
              v20 = (int)"N.A.";
            }
            printf("<td>%s</td>\n", v20);
            v21 = printf("<td>%s</td>\n", v16);
            etr(v21);
LABEL_22:
            ++v5;
          }
        }
      }
    }
  }
LABEL_26:
  while ( v5 <= 7 )
  {
    ++v5;
    printf("<tr style='height: 24px; %s'><td colspan=4></td></tr>");
  }
  printf("</table>");
  printf("<script>");
  printf("parent.document.getElementById('list_table').outerHTML = document.getElementById('list_table').outerHTML;");
  printf("setTimeout(function() { location.reload(); }, 3000);");
  return printf("</script>");
}
// F32C: using guessed type int __fastcall etr(_DWORD);
// F590: using guessed type int __fastcall get_value(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0004110C) --------------------------------------------------------
int sub_4110C()
{
  int v0; // r7@1
  int v1; // r0@1
  int v2; // r1@1
  int v3; // r0@1
  int v4; // r1@1
  int v5; // r0@1
  int v6; // r0@1
  int v7; // r0@1
  int v8; // r5@1
  int v9; // r6@2
  signed int v10; // r4@4
  int v11; // r8@4
  int v12; // r0@12
  bool v13; // zf@13
  bool v14; // nf@13
  unsigned __int8 v15; // vf@13
  int v16; // r0@14
  int v17; // r0@14
  int result; // r0@14
  char v19; // [sp+Ch] [bp-3D4h]@1
  int v20; // [sp+280h] [bp-160h]@1
  int v21; // [sp+3B8h] [bp-28h]@1
  int v22; // [sp+3BCh] [bp-24h]@1

  get_si("hw", &v19);
  v0 = v20;
  v21 = 0;
  v22 = 0;
  genconfig_read_file("/etc/vlan_config", &v21);
  puts("<tr><td>");
  v1 = printf("<table cellspacing=0px cellpadding=0px style='width:100%%'>\n");
  str(v1);
  printf("<td align=left style=\"padding:0px 3px 0px 3px;\" colspan=%d>", 2);
  v3 = sub_134F4(118, v2);
  printf("<input type=button value=\"%s\" name=\"del_bt\" style='margin:4px;' onclick=\"removeVLAN()\">\n", v3);
  printf("</td>");
  printf("<td align=right style=\"padding:0px 3px 0px 3px;\" colspan=%d>", v0);
  v5 = sub_134F4(1150, v4);
  printf("<font color='gray'>%s", v5);
  v6 = printf("</td>");
  etr(v6);
  printf("<tr style='height:1px;'>");
  printf("<td colspan=%d style='border-bottom: 1px solid #CCC;'>", v0 + 2);
  v7 = printf("</td>");
  etr(v7);
  v8 = v21;
  if ( v21 )
  {
    v9 = 0;
    do
    {
      ++v9;
      v10 = 1;
      v11 = atoi((const char *)(v8 + 64));
      printf("<tr style='background-color:#%s'>");
      printf("<td width=10 style=\"padding:0px 3px 0px 3px;\">");
      printf("<input type=checkbox name=vdel value=%s>", v8);
      printf("</td>");
      printf("<td width=130 style=\"padding:0px 3px 0px 3px;\">");
      printf("<a href=\"#\" onclick=\"modifyVLAN('%s','0x%x', %d)\">%s</a>", v8, v11, v0, v8);
      printf("</td>");
      while ( v10 <= v0 )
      {
        printf("<td style=\"padding:0px 3px 0px 3px;\" align=left>");
        if ( (v11 >> (v10 - 1)) & 1 )
          printf("%2d", v10);
        else
          printf("--", v10);
        printf("</td>");
        ++v10;
      }
      etr("<td style=\"padding:0px 3px 0px 3px;\" align=left>");
      v8 = *(_DWORD *)(v8 + 248);
    }
    while ( v8 );
  }
  else
  {
    v9 = 0;
  }
  while ( 1 )
  {
    v15 = __OFSUB__(v9, 14);
    v13 = v9 == 14;
    v14 = v9++ - 14 < 0;
    if ( !((unsigned __int8)(v14 ^ v15) | v13) )
      break;
    printf("<tr style='background-color:#%s'>");
    printf("<td width=10 style=\"padding:0px 3px 0px 3px;\">");
    printf("</td>");
    printf("<td colspan=%d width=130 style=\"padding:0px 3px 0px 3px;\">", v0 + 1);
    v12 = printf("</td>");
    etr(v12);
  }
  printf("<tr style='height:1px;'>");
  printf("<td colspan=%d style='border-bottom: 1px solid #CCC;'>", v0 + 2);
  v16 = printf("</td>");
  v17 = etr(v16);
  result = print_end_content_table(v17);
  if ( v21 )
    result = genconfig_free_ll(&v21);
  return result;
}
// E7D4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// ED20: using guessed type int __fastcall genconfig_read_file(_DWORD, _DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F698: using guessed type int __fastcall genconfig_free_ll(_DWORD);
// FBA8: using guessed type int __fastcall print_end_content_table(_DWORD);

//----- (00041390) --------------------------------------------------------
int sub_41390()
{
  int v0; // r5@1
  int i; // r4@1
  int v2; // r0@3
  int v3; // r0@4
  int v4; // r1@4
  int v5; // r0@4
  signed int v6; // r4@4
  int v7; // r0@4
  int v8; // r0@4
  bool v9; // zf@6
  bool v10; // nf@6
  unsigned __int8 v11; // vf@6
  int v12; // r0@7
  signed int v13; // r4@7
  int v14; // r0@10
  int v15; // r1@10
  int v16; // r0@10
  int v17; // r1@10
  int v18; // r0@10
  int v19; // r0@10
  int v20; // r0@10
  char v22; // [sp+4h] [bp-3C4h]@1
  int v23; // [sp+278h] [bp-150h]@1
  int v24; // [sp+3B0h] [bp-18h]@1
  int v25; // [sp+3B4h] [bp-14h]@1

  get_si("hw", &v22);
  v0 = v23;
  puts("<form method=get action=timepro.cgi name=vlan_fm>");
  puts("<input type=hidden name=tmenu value=switchconf>");
  puts("<input type=hidden name=smenu value=vlan>");
  puts("<input type=hidden name=act value=>");
  puts("<input type=hidden name=dellist value=>");
  puts("<input type=hidden name=trunkname value='None'>");
  puts("<input type=hidden name=trunkmap value=0>");
  v25 = 0;
  v24 = 0;
  genconfig_read_file(&unk_89DA1, &v24);
  for ( i = v24; i; i = *(_DWORD *)(i + 248) )
  {
    printf("<input type=hidden name=trunkname value='%s'>\n", i);
    v2 = atoi((const char *)(i + 64));
    printf("<input type=hidden name=trunkmap value=%d>\n", v2);
  }
  puts("<tr><td>");
  v3 = printf("<table cellspacing=0px cellpadding=0px style='width:100%%; padding: 5px;'>\n");
  str(v3);
  v5 = sub_134F4(541, v4);
  v6 = 1;
  printf("<td style='padding: 0 3px;' colspan=4 align=left>VLAN %s</td>", v5);
  printf("<td colspan=%d>", v0 - 4);
  printf("<input type=text name=vname size=20 maxlength=20>");
  v7 = printf("</td>");
  v8 = etr(v7);
  str(v8);
  while ( 1 )
  {
    v11 = __OFSUB__(v6, v0);
    v9 = v6 == v0;
    v10 = v6++ - v0 < 0;
    if ( !((unsigned __int8)(v10 ^ v11) | v9) )
      break;
    printf("<td style='padding: 0 3px; width:10px' align=center><label for=checkbox_p%d>%d</label></td>");
  }
  v12 = etr("<td style='padding: 0 3px; width:10px' align=center><label for=checkbox_p%d>%d</label></td>");
  v13 = 1;
  str(v12);
  while ( v13 <= v0 )
  {
    printf("<td style=\"padding:0px 3px 0px 3px;\" width=10 align=right>");
    printf("<input id=checkbox_p%d type=checkbox name=p%d >", v13, v13);
    printf("</td>");
    ++v13;
  }
  v14 = etr("<td style=\"padding:0px 3px 0px 3px;\" width=10 align=right>");
  str(v14);
  printf("<td style=\"padding:0px 3px 0px 3px;\" colspan=%d align=right>\n", v0);
  v16 = sub_134F4(3, v15);
  printf("<input type=button value=\"%s\" name=\"add_bt\" onclick=\"addVLAN(%d)\">\n", v16, v0);
  v18 = sub_134F4(47, v17);
  printf("<input type=button value=\"%s\" name=\"cancel_bt\" onclick=\"cancelVLAN()\" disabled>\n", v18);
  v19 = printf("</td>");
  etr(v19);
  v20 = printf("<tr style='height: 10px;'><td colspan=24></td></tr>");
  print_end_content_table(v20);
  sub_4110C();
  return printf("</form>");
}
// E7D4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// ED20: using guessed type int __fastcall genconfig_read_file(_DWORD, _DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// FBA8: using guessed type int __fastcall print_end_content_table(_DWORD);

//----- (000415AC) --------------------------------------------------------
int __fastcall sub_415AC(int a1)
{
  int v1; // r7@1
  int result; // r0@1
  const char *v3; // r4@1
  int v4; // r5@4
  int v5; // r1@10
  signed int v6; // r4@12
  const char *v7; // r0@13
  int v8; // r0@15
  char v9; // r3@15
  char *v10; // r0@15
  int v11; // r0@19
  const char *i; // r5@22
  int v13; // r6@25
  int v14; // r0@28
  int v15; // r0@28
  int v16; // [sp+4h] [bp-44Ch]@2
  int v17; // [sp+278h] [bp-1D8h]@18
  char v18; // [sp+3B3h] [bp-9Dh]@6
  char v19; // [sp+413h] [bp-3Dh]@11
  int v20; // [sp+42Ch] [bp-24h]@13
  int v21; // [sp+438h] [bp-18h]@15

  v1 = a1;
  result = ((int (*)(void))get_pvalue)();
  v3 = (const char *)result;
  if ( result )
  {
    get_si("hw", &v16);
    if ( strcmp(v3, (const char *)&unk_8A0A8) && strcmp(v3, "modifyvlan") )
    {
      result = strcmp(v3, "removevlan");
      if ( result )
        return result;
      v11 = get_pvalue(v1, "dellist");
      if ( v11 )
      {
        for ( i = (const char *)v11; ; i = (const char *)(v13 + 1) )
        {
          v11 = (int)strchr(i, 44);
          v13 = v11;
          if ( !v11 )
            break;
          *(_BYTE *)v11 = 0;
          if ( *i )
          {
            sf_strncpy(&v18, i, 96);
            vlan_remove_config(&v18, -1);
          }
        }
      }
      goto LABEL_28;
    }
    result = get_pvalue(v1, "vname");
    v4 = result;
    if ( result )
    {
      result = check_unpermitted_chars(result);
      if ( !result )
      {
        sf_strncpy(&v18, v4, 96);
        if ( strcmp(v3, (const char *)&unk_8A0A8) || (result = vlan_check_vname_available(&v18)) == 0 )
        {
          if ( !strcmp(v3, "modifyvlan") )
            vlan_remove_config(&v18, 255);
          v5 = 0;
          do
            *(&v19 + v5++) = 48;
          while ( v5 != 25 );
          v6 = 1;
          while ( v6 <= v17 )
          {
            sprintf((char *)&v20, "p%d");
            v7 = (const char *)get_pvalue(v1, &v20);
            if ( v7 && !strcmp(v7, "on") )
            {
              v8 = get_dev_port(&v16, v6);
              v9 = 49;
              v10 = (char *)&v21 + v8;
            }
            else
            {
              v10 = (char *)&v21 + get_dev_port(&v16, v6);
              v9 = 48;
            }
            ++v6;
            *(v10 - 37) = v9;
          }
          *((_BYTE *)&v21 + v17 - 37) = 0;
          v11 = vlan_add_config(&v18, &v19);
LABEL_28:
          v14 = vlan_apply_system(v11);
          v15 = signal_update(v14);
          return signal_save(v15);
        }
      }
    }
  }
  return result;
}
// E7D4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E924: using guessed type int __fastcall vlan_remove_config(_DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EDD4: using guessed type int __fastcall vlan_apply_system(_DWORD);
// F11C: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);
// FAAC: using guessed type int __fastcall vlan_add_config(_DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);
// FD58: using guessed type int __fastcall vlan_check_vname_available(_DWORD);
// FDC4: using guessed type int __fastcall get_dev_port(_DWORD, _DWORD);

//----- (0004182C) --------------------------------------------------------
int __fastcall sub_4182C(int a1)
{
  int v1; // r4@1
  int v2; // r0@1

  v1 = a1;
  printf("<style>");
  printf("tr { height: 22px; }");
  printf("</style>");
  sub_133E4((int)"switchconf", (int)"vlan");
  printf("<table cellpadding=0px cellspacing=0px style='width:100%%;'>\n");
  sub_415AC(v1);
  v2 = sub_41390();
  return print_end_main_table(v2);
}
// F5F0: using guessed type int __fastcall print_end_main_table(_DWORD);

//----- (00041890) --------------------------------------------------------
int __fastcall sub_41890(int a1, int a2, int a3)
{
  int v3; // ST00_4@1
  int v4; // ST04_4@1
  int v5; // ST08_4@1
  int v6; // ST0C_4@1
  int v7; // ST10_4@1
  int v8; // ST14_4@1
  int v9; // ST18_4@1
  int v10; // ST1C_4@1

  v3 = *(_BYTE *)a3;
  v4 = *(_BYTE *)(a3 + 1);
  v5 = *(_BYTE *)(a3 + 2);
  v6 = *(_BYTE *)(a3 + 3);
  v7 = *(_BYTE *)(a3 + 4);
  v8 = *(_BYTE *)(a3 + 5);
  v9 = *(_BYTE *)(a3 + 6);
  v10 = *(_BYTE *)(a3 + 7);
  return snprintf2(a1, 128, "<font color='%s'>%.2x%.2x.%.2x%.2x%.2x%.2x%.2x%.2x</font>");
}
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);

//----- (000418EC) --------------------------------------------------------
int sub_418EC()
{
  int result; // r0@1
  int v1; // r5@1
  int v2; // r0@2
  int v3; // r0@2
  int v4; // r0@2
  int v5; // r0@2
  char v6; // r10@2
  int i; // r5@2
  char *v8; // r3@4
  char *v9; // r4@7
  int v10; // r0@9
  char *v11; // r3@10
  char *v12; // r3@13
  char *v13; // r3@16
  int v14; // r0@18
  char v15; // [sp+Ch] [bp-A4h]@2
  int v16; // [sp+8Ch] [bp-24h]@9

  result = stp_get_bridge_info("br0");
  v1 = result;
  if ( result )
  {
    puts("<tr><td>");
    printf("<table cellspacing=0px cellpadding=0px style='width:100%%;'>\n");
    printf("<tr class='title info'>");
    printf("<td>Root ID</td>");
    printf("<td align=center>Path Cost</td>");
    printf("<td align=center>Priority</td>");
    printf("<td align=center>Max Age</td>");
    printf("<td align=center>Hello Time</td>");
    v2 = printf("<td align=center>Fwd Delay</td>");
    etr(v2);
    printf("<tr class='list' style='background-color:#FFF;'>");
    sub_41890((int)&v15, 128, v1 + 1060);
    printf("<td>%s</td>", &v15);
    sprintf(&v15, "%d", *(_DWORD *)(v1 + 1068));
    printf("<td align=center>%s</td>", &v15);
    sprintf(&v15, (const char *)&unk_8A276, *(_BYTE *)(v1 + 1060), *(_BYTE *)(v1 + 1061));
    printf("<td align=center>%s</td>", &v15);
    sprintf(&v15, "%i", *(_DWORD *)(v1 + 1096));
    printf("<td align=center>%s</td>", &v15);
    sprintf(&v15, "%i", *(_DWORD *)(v1 + 1104));
    printf("<td align=center>%s</td>", &v15);
    sprintf(&v15, "%i", *(_DWORD *)(v1 + 1112));
    v3 = printf("<td align=center>%s</td>", &v15);
    v4 = etr(v3);
    print_end_content_table(v4);
    puts("<tr><td>");
    printf("<table cellspacing=0px cellpadding=0px style='width: 100%%;'>\n");
    printf("<tr class='title info'>");
    printf("<td>Port</td>");
    printf("<td>State</td>");
    printf("<td>Priority</td>");
    printf("<td>Path Cost</td>");
    printf("<td>Designated Root</td>");
    v5 = printf("<td>Designated Port</td>");
    v6 = 0;
    etr(v5);
    for ( i = *(_DWORD *)(v1 + 24); i; i = *(_DWORD *)i )
    {
      printf("<tr class='list' style='background-color:%s'>");
      if ( *(_DWORD *)(i + 44) == 4 )
        v8 = "red";
      else
        v8 = "black";
      snprintf2(&v15, 128, "<font color='%s'>%2d</font>", v8, *(_DWORD *)(i + 4));
      printf("<td>%s</td>", &v15);
      ++v6;
      if ( *(_DWORD *)(i + 44) == 4 )
        v9 = "red";
      else
        v9 = "black";
      v10 = br_get_state_name(*(_DWORD *)(i + 44));
      snprintf2(&v15, 128, "<font color='%s'>%s</font>", v9, v10);
      printf("<td>%s</td>", &v15);
      stp_get_bridge_port_priority("br0", *(_DWORD *)(i + 4), &v16);
      if ( *(_DWORD *)(i + 44) == 4 )
        v11 = "red";
      else
        v11 = "black";
      snprintf2(&v15, 128, "<font color='%s'>%d</font>", v11, v16);
      printf("<td>%s</td>", &v15);
      if ( *(_DWORD *)(i + 44) == 4 )
        v12 = "red";
      else
        v12 = "black";
      snprintf2(&v15, 128, "<font color='%s'>%d</font>", v12, *(_DWORD *)(i + 36));
      printf("<td>%s</td>", &v15);
      *(_DWORD *)(i + 44);
      sub_41890((int)&v15, 128, i + 16);
      printf("<td>%s</td>", &v15);
      if ( *(_DWORD *)(i + 44) == 4 )
        v13 = "red";
      else
        v13 = "black";
      snprintf2(&v15, 128, "<font color='%s'>%d</font>", v13, *(_BYTE *)(i + 34));
      v14 = printf("<td>%s</td>", &v15);
      etr(v14);
    }
    result = print_end_content_table("<tr class='list' style='background-color:%s'>");
  }
  return result;
}
// EBF4: using guessed type int __fastcall br_get_state_name(_DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F4DC: using guessed type int __fastcall stp_get_bridge_port_priority(_DWORD, _DWORD, _DWORD);
// FBA8: using guessed type int __fastcall print_end_content_table(_DWORD);
// FCF8: using guessed type int __fastcall stp_get_bridge_info(_DWORD);

//----- (00041C78) --------------------------------------------------------
int sub_41C78()
{
  int v0; // r1@1
  int v1; // r0@1
  char *v2; // r5@1
  int v3; // r1@1
  char *v4; // r4@2
  int v5; // r0@4
  char *v6; // r1@4
  signed int v7; // r4@4
  int v8; // r1@4
  int v9; // r0@6
  int v10; // r1@6
  int v11; // r0@6
  int v12; // r0@6
  int v13; // r0@6
  int v14; // r0@6
  int v15; // r1@6
  int v16; // r0@6
  int v17; // r0@6
  int v18; // r0@6
  int v19; // r1@6
  int v20; // r0@6
  int v21; // r0@6
  int v22; // r1@6
  int v23; // r0@6
  int v24; // r0@6
  int v25; // r1@6
  int v26; // r0@6
  int v27; // r0@6
  int v28; // r1@6
  int v29; // r0@6
  int v30; // r0@6
  int v31; // r1@6
  int v32; // r0@6
  int v33; // r0@6
  int v34; // r0@6
  int v35; // r0@6
  signed int v36; // r1@8
  bool v37; // zf@8
  bool v38; // nf@8
  unsigned __int8 v39; // vf@8
  signed int v40; // r2@8
  int v41; // r0@9
  int v42; // r0@9
  int v43; // r1@9
  int v44; // r0@9
  int v45; // r0@9
  int v46; // r0@9
  int v47; // r0@9
  int v49; // [sp+0h] [bp-3C8h]@6
  int v50; // [sp+274h] [bp-154h]@8
  int v51; // [sp+3ACh] [bp-1Ch]@1

  puts("<form method=get action=timepro.cgi name=stp_fm>");
  puts("<input type=hidden name=tmenu value=switchconf>");
  puts("<input type=hidden name=smenu value=stp>");
  puts("<input type=hidden name=act value=opstp>");
  stp_get_operation("br0", &v51);
  puts("<tr><td>");
  printf("<table cellspacing=0px cellpadding=0px style='width: 100%%; margin-top: 5px;'>\n");
  printf("<tr class='title'>");
  v1 = sub_134F4(754, v0);
  v2 = "";
  printf("<td style='width: 110px;'><b>STP %s</b></td>", v1);
  puts("<td>");
  if ( v51 )
    v4 = "checked";
  else
    v4 = "";
  v5 = sub_134F4(894, v3);
  v6 = v4;
  v7 = 1;
  printf("<input type=radio name=op value=1 %s> %s", v6, v5);
  print_nbsp(10);
  if ( !v51 )
    v2 = "checked";
  v9 = sub_134F4(900, v8);
  printf("<input type=radio name=op value=0 %s> %s", v2, v9);
  puts("</td>");
  puts("<td align=right>");
  v11 = sub_134F4(28, v10);
  printf("<input type=button value=\"%s\" name=\"set_bt\" style='margin-right: 39px;' onclick=\"setupStp()\">\n", v11);
  v12 = printf("</td>");
  etr(v12);
  v13 = print_blank_line(3, 5);
  print_end_content_table(v13);
  puts("</form>");
  puts("<tr><td>");
  v14 = puts("<table cellspacing=0px cellpadding=0px>");
  str(v14);
  puts("<form method=get action=timepro.cgi name=stp_bridge_fm>");
  puts("<input type=hidden name=tmenu value=switchconf>");
  puts("<input type=hidden name=smenu value=stp>");
  puts("<input type=hidden name=act value=setbridge>");
  printf("<td width=50%% valign=top>");
  puts("<table cellspacing=0px cellpadding=0px>");
  printf("<tr class='title'>");
  puts("<td colspan=3 align=left>");
  v16 = sub_134F4(883, v15);
  printf("<b>Bridge %s</b>", v16);
  printf("</td>");
  v17 = printf("</tr>");
  etr(v17);
  stp_get_bridge_priority("br0", &v51);
  printf("<tr class='list'>");
  printf("<td style='width: 90px;'>Priorirty</td>");
  printf("<td><input type=text name=br_prio size=5 maxlength=5 value=%d>", v51);
  printf("</td>");
  v18 = printf("<td>(0 ~ 65535, 32768)</td>");
  etr(v18);
  stp_get_bridge_forward_delay("br0", &v51);
  printf("<tr class='list'>");
  printf("<td>Forward Delay</td>");
  printf("<td><input type=text name=br_fd size=2 maxlength=2 value=%d> ", v51);
  v20 = sub_134F4(878, v19);
  printf((const char *)v20);
  printf("</td>");
  v21 = printf("<td>(4 ~ 30, 15)</td>");
  etr(v21);
  stp_get_bridge_max_message_age("br0", &v51);
  printf("<tr class='list'>");
  printf("<td>Max Age</td>");
  printf("<td><input type=text name=br_maxage size=2 maxlength=2 value=%d> ", v51);
  v23 = sub_134F4(878, v22);
  printf((const char *)v23);
  printf("</td>");
  v24 = printf("<td>(6 ~ 40, 20)</td>");
  etr(v24);
  stp_get_bridge_hello_time("br0", &v51);
  printf("<tr class='list'>");
  printf("<td>Hello Time</td>");
  printf("<td><input type=text name=br_hello size=2 maxlength=2 value=%d> ", v51);
  v26 = sub_134F4(878, v25);
  printf((const char *)v26);
  printf("</td>");
  v27 = printf("<td>(1 ~ 10, 2)</td>");
  etr(v27);
  printf("<tr class='list'>");
  puts("<td colspan=3 align=right>");
  v29 = sub_134F4(28, v28);
  printf(
    "<input type=button value=\"Bridge %s\" name=\"set_bt\" onclick=\"setupStpBridge()\" style='margin-right: 10px;'>\n",
    v29);
  v30 = printf("</td>");
  etr(v30);
  printf("</table>");
  printf("</td>");
  printf("</form>");
  puts("<form method=get action=timepro.cgi name=stp_port_fm>");
  puts("<input type=hidden name=tmenu value=switchconf>");
  puts("<input type=hidden name=smenu value=stp>");
  puts("<input type=hidden name=act value=setport>");
  printf("<td valign=top>");
  puts("<table cellspacing=0px cellpadding=0px>");
  printf("<tr class='title'>");
  puts("<td colspan=3 align=left>");
  v32 = sub_134F4(883, v31);
  printf("<b>Port %s</b>", v32);
  v33 = printf("</td>");
  etr(v33);
  printf("<tr class='list'>");
  printf("<td style='width: 90px;'>Priorirty</td>");
  printf("<td><input type=text name=port_prio size=3 maxlength=3 value=128 style='width: 60px;'>");
  printf("</td>");
  v34 = printf("<td>(0 ~ 255, 128)</td>");
  etr(v34);
  printf("<tr class='list'>");
  printf("<td>Path Cost</td>");
  printf("<td><input type=text name=port_cost size=5 maxlength=5 value=4 style='width: 60px;'>");
  printf("</td>");
  v35 = printf("<td>(0 ~ 65535, 4)</td>");
  etr(v35);
  printf("<tr class='list'>");
  printf("<td>Port</td>");
  printf("<td height=23 colspan=2>");
  puts("<select name=port style='height: 20px; width: 60px;'>");
  get_si("hw", &v49);
  while ( 1 )
  {
    v36 = v7;
    v39 = __OFSUB__(v7, v50);
    v37 = v7 == v50;
    v38 = v7 - v50 < 0;
    v40 = v7++;
    if ( !((unsigned __int8)(v38 ^ v39) | v37) )
      break;
    printf("<option value=%d>%d");
  }
  printf("<option value=0>All", v36, v40);
  printf("</select>");
  v41 = printf("</td>");
  etr(v41);
  printf("<tr class='list'>");
  printf("<td height=23></td>");
  v42 = printf("<td colspan=2></td>");
  etr(v42);
  printf("<tr class='list'>");
  puts("<td colspan=3 align=right>");
  v44 = sub_134F4(28, v43);
  printf("<input type=button value=\"Port %s\" name=\"set_bt\" onclick=\"setupStpPort()\">\n", v44);
  v45 = printf("</td>");
  etr(v45);
  printf("</table>");
  printf("</td>");
  v46 = printf("</form>");
  etr(v46);
  v47 = print_blank_line(3, 15);
  return print_end_content_table(v47);
}
// E7D4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// EB1C: using guessed type int __fastcall stp_get_bridge_priority(_DWORD, _DWORD);
// EB94: using guessed type int __fastcall stp_get_operation(_DWORD, _DWORD);
// EC3C: using guessed type int __fastcall stp_get_bridge_max_message_age(_DWORD, _DWORD);
// EF90: using guessed type int __fastcall stp_get_bridge_forward_delay(_DWORD, _DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// F7B8: using guessed type int __fastcall stp_get_bridge_hello_time(_DWORD, _DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// FBA8: using guessed type int __fastcall print_end_content_table(_DWORD);

//----- (00042208) --------------------------------------------------------
int __fastcall sub_42208(int a1)
{
  int v1; // r6@1
  int result; // r0@1
  const char *v3; // r4@1
  const char *v4; // r0@3
  int v5; // r0@3
  const char *v6; // r0@5
  int v7; // r0@6
  const char *v8; // r0@7
  int v9; // r0@8
  const char *v10; // r0@9
  int v11; // r0@10
  int v12; // r0@12
  const char *v13; // r4@14
  int v14; // r0@15
  signed int v15; // r3@15
  int v16; // r5@15
  int i; // r4@20
  const char *v18; // r0@21
  int v19; // r0@22
  const char *v20; // r0@23
  int v21; // r0@24
  int v22; // r0@27
  char v23; // [sp+4h] [bp-3BCh]@15
  int v24; // [sp+278h] [bp-148h]@15

  v1 = a1;
  result = get_pvalue(a1, "act");
  v3 = (const char *)result;
  if ( result )
  {
    if ( !strcmp((const char *)result, "opstp") )
    {
      v4 = (const char *)get_pvalue(v1, "op");
      atoi(v4);
      v5 = stp_set_operation("br0");
    }
    else if ( !strcmp(v3, "setbridge") )
    {
      v6 = (const char *)get_pvalue(v1, "br_prio");
      if ( v6 )
      {
        v7 = atoi(v6);
        stp_set_bridge_priority("br0", v7);
      }
      v8 = (const char *)get_pvalue(v1, "br_fd");
      if ( v8 )
      {
        v9 = atoi(v8);
        stp_set_bridge_forward_delay("br0", v9);
      }
      v10 = (const char *)get_pvalue(v1, "br_maxage");
      if ( v10 )
      {
        v11 = atoi(v10);
        stp_set_bridge_max_message_age("br0", v11);
      }
      v5 = get_pvalue(v1, "br_hello");
      if ( v5 )
      {
        v12 = atoi((const char *)v5);
        v5 = stp_set_bridge_hello_time("br0", v12);
      }
    }
    else
    {
      v5 = strcmp(v3, "setport");
      if ( !v5 )
      {
        v5 = get_pvalue(v1, "port");
        v13 = (const char *)v5;
        if ( v5 )
        {
          get_si("hw", &v23);
          v14 = atoi(v13);
          v15 = v24;
          v16 = v14;
          if ( v14 )
            v15 = v14;
          else
            v16 = v24;
          if ( !v14 )
            v15 = 1;
          for ( i = v15; ; ++i )
          {
            v5 = v1;
            if ( i > v16 )
              break;
            v18 = (const char *)get_pvalue(v1, "port_prio");
            if ( v18 )
            {
              v19 = atoi(v18);
              stp_set_bridge_port_priority("br0", i, v19);
            }
            v20 = (const char *)get_pvalue(v1, "port_cost");
            if ( v20 )
            {
              v21 = atoi(v20);
              stp_set_bridge_port_cost("br0", i, v21);
            }
          }
        }
      }
    }
    v22 = signal_update(v5);
    result = signal_save(v22);
  }
  return result;
}
// E7D4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EE70: using guessed type int __fastcall stp_set_bridge_forward_delay(_DWORD, _DWORD);
// EFF0: using guessed type int __fastcall stp_set_bridge_hello_time(_DWORD, _DWORD);
// F2B4: using guessed type int __fastcall stp_set_bridge_priority(_DWORD, _DWORD);
// F65C: using guessed type int __fastcall stp_set_bridge_max_message_age(_DWORD, _DWORD);
// F77C: using guessed type int __fastcall stp_set_bridge_port_cost(_DWORD, _DWORD, _DWORD);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);
// F9E0: using guessed type int __fastcall stp_set_operation(_DWORD);
// FC74: using guessed type int __fastcall stp_set_bridge_port_priority(_DWORD, _DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);

//----- (000423FC) --------------------------------------------------------
int __fastcall sub_423FC(int a1)
{
  int v1; // r4@1
  int v2; // r0@1

  v1 = a1;
  printf("<style>");
  printf("tr.title { height: 22px; }");
  printf("tr.title td { padding: 0 10px; }");
  printf("tr.title.info td { border-width: 1px 0; border-style: solid; border-color: #CCC; }");
  printf("tr.list { height: 20px; }");
  printf("tr.list td { padding: 0 10px; }");
  printf("</style>");
  printf("<table cellpadding=0px cellspacing=0px style='width: 100%%;'>\n");
  sub_42208(v1);
  sub_41C78();
  v2 = sub_418EC();
  return print_end_main_table(v2);
}
// F5F0: using guessed type int __fastcall print_end_main_table(_DWORD);

//----- (00042480) --------------------------------------------------------
int sub_42480()
{
  int v0; // r0@1
  int v1; // r8@1
  char *v2; // r5@1
  int v3; // r7@1
  int v4; // r0@1
  int v5; // r1@1
  int v6; // r0@1
  int v7; // r1@1
  char *v8; // r4@2
  int v9; // r0@4
  char *v10; // r1@4
  signed int v11; // r4@4
  int v12; // r1@4
  int v13; // r0@6
  int v14; // r0@6
  int v15; // r0@6
  int v16; // r0@6
  bool v17; // zf@8
  bool v18; // nf@8
  unsigned __int8 v19; // vf@8
  int v20; // r0@9
  signed int v21; // r4@9
  signed int v22; // r5@9
  int v23; // r6@9
  char *v24; // r3@11
  int v25; // r0@16
  int v26; // r1@16
  int v27; // r0@16
  signed int v28; // r4@16
  int v29; // r1@16
  int v30; // r0@16
  int v31; // r1@19
  int v32; // r0@19
  int v33; // r0@19
  int v34; // r0@19
  int v35; // r1@19
  int v36; // r0@19
  int v37; // r0@19
  int v38; // r0@19
  char v40; // [sp+4h] [bp-3C4h]@1
  int v41; // [sp+278h] [bp-150h]@1

  v0 = get_si("hw", &v40);
  v1 = v41;
  v2 = "";
  v3 = get_mirroring_op(v0);
  puts("<form method=get action=timepro.cgi name=mirroring_fm>");
  puts("<input type=hidden name=tmenu value=switchconf>");
  puts("<input type=hidden name=smenu value=mirroring>");
  puts("<input type=hidden name=act value=setup_mirroring>");
  puts("<tr><td>");
  v4 = puts("<table cellspacing=0px cellpadding=0px>");
  str(v4);
  v6 = sub_134F4(754, v5);
  printf("<td style='padding-left: 10px;'>%s</td>", v6);
  puts("<td style='padding: 0 20px;'>");
  if ( v3 > 0 )
    v8 = "checked";
  else
    v8 = "";
  v9 = sub_134F4(894, v7);
  v10 = v8;
  v11 = 1;
  printf("<input type=radio id=mirroring_on name=op value=1 %s><label for=mirroring_on> %s</label>", v10, v9);
  print_nbsp(10);
  if ( v3 <= 0 )
    v2 = "checked";
  v13 = sub_134F4(900, v12);
  printf("<input type=radio id=mirroring_off name=op value=0 %s><label for=mirroring_off> %s</label>", v2, v13);
  v14 = puts("</td>");
  v15 = etr(v14);
  print_end_content_table(v15);
  puts("<tr><td>");
  v16 = printf("<table cellspacing=0px cellpadding=0px style='width:100%%;'>\n");
  str(v16);
  while ( 1 )
  {
    v19 = __OFSUB__(v11, v1);
    v17 = v11 == v1;
    v18 = v11++ - v1 < 0;
    if ( !((unsigned __int8)(v18 ^ v19) | v17) )
      break;
    printf("<td style='width: 10px; padding: 0 3px;' align=center><label for=checkbox_p%d>%d</label></td>");
  }
  v20 = etr("<td style='width: 10px; padding: 0 3px;' align=center><label for=checkbox_p%d>%d</label></td>");
  v21 = 1;
  v22 = get_mirrored_port(v20);
  v23 = get_mirroring_port();
  str(v23);
  while ( v21 <= v1 )
  {
    printf("<td style=\"padding:0px 3px 0px 3px;\" width=10 align=center>");
    if ( (v22 >> (v21 - 1)) & 1 )
    {
      v24 = "checked";
    }
    else
    {
      v24 = "disabled";
      if ( v23 != v21 )
        v24 = "";
    }
    printf("<input type=checkbox id=checkbox_p%d name=p%d %s>", v21, v21, v24);
    printf("</td>");
    ++v21;
  }
  v25 = etr("<td style=\"padding:0px 3px 0px 3px;\" width=10 align=center>");
  str(v25);
  printf("<td colspan=%d style='padding-left: 10px'>", v1 + 1);
  v27 = sub_134F4(532, v26);
  v28 = 1;
  printf("%s", v27);
  v30 = sub_134F4(788, v29);
  printf(" %s ", v30);
  printf("<select name=mirroring_port style='height: 20px; width: 50px;' onchange=\"checkMirroredPort(%d)\">\n", v1);
  printf("<option value=0>--");
  while ( v28 <= v1 )
  {
    printf("<option value=%d %s>%d");
    ++v28;
  }
  printf("</select>", v28);
  v32 = sub_134F4(533, v31);
  printf(" %s", v32);
  v33 = printf("</td>");
  v34 = etr(v33);
  str(v34);
  printf("<td style=\"padding:0px 3px 0px 3px;\" colspan=%d align=right>\n", v1 + 1);
  v36 = sub_134F4(28, v35);
  printf("<input type=button value=\"%s\" name=\"set_bt\" onclick=\"setupMirroring(%d)\">\n", v36, v1);
  v37 = printf("</td>");
  v38 = etr(v37);
  print_end_content_table(v38);
  printf("</td>");
  return printf("</form>");
}
// E7D4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F2F0: using guessed type int __fastcall get_mirroring_op(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F584: using guessed type int __fastcall get_mirrored_port(_DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// FBA8: using guessed type int __fastcall print_end_content_table(_DWORD);
// FD70: using guessed type int get_mirroring_port(void);

//----- (00042784) --------------------------------------------------------
int __fastcall sub_42784(int a1)
{
  int v1; // r5@1
  int result; // r0@1
  signed int i; // r4@2
  const char *v4; // r0@4
  signed int v5; // r0@6
  signed int v6; // r1@6
  const char *v7; // r0@10
  int v8; // r0@11
  int v9; // r0@13
  int v10; // r0@14
  int v11; // r0@15
  int v12; // [sp+0h] [bp-3C8h]@1
  int v13; // [sp+274h] [bp-154h]@9
  char s; // [sp+3ACh] [bp-1Ch]@4

  v1 = a1;
  get_si("hw", &v12);
  result = get_pvalue(v1, "act");
  if ( result )
  {
    for ( i = 1; i <= v13; ++i )
    {
      sprintf(&s, "p%d");
      v4 = (const char *)get_pvalue(v1, &s);
      if ( v4 && !strcmp(v4, "on") )
      {
        v5 = i;
        v6 = 1;
      }
      else
      {
        v5 = i;
        v6 = 0;
      }
      set_mirrored_port(v5, v6);
    }
    v7 = (const char *)get_pvalue(v1, "mirroring_port");
    if ( v7 )
    {
      v8 = atoi(v7);
      if ( v8 <= v13 )
        set_mirroring_port();
    }
    v9 = get_pvalue(v1, "op");
    if ( v9 )
    {
      v10 = atoi((const char *)v9);
      v9 = set_mirroring_op(v10);
    }
    v11 = signal_update(v9);
    result = signal_save(v11);
  }
  return result;
}
// E7D4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EC0C: using guessed type int __fastcall set_mirrored_port(_DWORD, _DWORD);
// F398: using guessed type int set_mirroring_port(void);
// F608: using guessed type int __fastcall set_mirroring_op(_DWORD);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);

//----- (00042884) --------------------------------------------------------
int __fastcall sub_42884(int a1)
{
  int v1; // r6@1
  int v2; // r0@1

  v1 = a1;
  printf("<style>");
  printf("tr { height: 22px; }");
  printf("</style>");
  printf("<style>");
  printf("tr.title { height: 22px; }");
  printf("tr.title td { padding: 0 10px; }");
  printf("tr.list { height: 20px; }");
  printf("tr.list td { padding: 0 10px; }");
  printf("</style>");
  printf("<table cellpadding=0px cellspacing=0px style='width: 100%%; padding: 5px;'>\n");
  sub_42784(v1);
  v2 = sub_42480();
  return print_end_main_table(v2);
}
// F5F0: using guessed type int __fastcall print_end_main_table(_DWORD);

//----- (0004291C) --------------------------------------------------------
int sub_4291C()
{
  int v0; // r4@1
  int v1; // r8@1
  int v2; // r0@1
  int v3; // r1@1
  int v4; // r0@1
  int v5; // r0@1
  int v6; // r0@1
  int v7; // r5@1
  int v8; // r7@2
  int v9; // r6@2
  int v10; // r9@4
  signed int i; // r4@4
  int v12; // r0@10
  int v13; // r0@13
  bool v14; // zf@14
  bool v15; // nf@14
  unsigned __int8 v16; // vf@14
  int v17; // r0@15
  char v19; // [sp+4h] [bp-3D4h]@1
  int v20; // [sp+278h] [bp-160h]@1
  int v21; // [sp+3B0h] [bp-28h]@1
  int v22; // [sp+3B4h] [bp-24h]@1

  get_si("hw", &v19);
  v0 = 0;
  v1 = v20;
  v21 = 0;
  v22 = 0;
  genconfig_read_file(&unk_89DA1, &v21);
  puts("<tr><td>");
  v2 = printf("<table cellspacing=0px cellpadding=0px style='width: 100%%;'>\n");
  str(v2);
  printf("<td align=left style=\"padding:0px 3px 0px 3px;\" colspan=%d>", 2);
  v4 = sub_134F4(118, v3);
  printf("<input type=button value=\"%s\" name=\"del_bt\" style='margin: 4px;' onclick=\"removeTRUNK()\">\n", v4);
  printf("</td>");
  printf("<td align=right style=\"padding:0px 3px 0px 3px;\" colspan=%d>", v1);
  v5 = printf("</td>");
  etr(v5);
  printf("<tr style='height:1px;'>");
  printf("<td colspan=%d style='border-bottom: 1px solid #CCC;'>", v1 + 2);
  v6 = printf("</td>");
  etr(v6);
  v7 = v21;
  if ( v21 )
  {
    v8 = 0;
    while ( 1 )
    {
      v9 = v0 + 1;
      v10 = atoi((const char *)(v7 + 64));
      printf("<tr style='background-color: #%s;'>");
      printf("<td width=10 style=\"padding:0px 3px 0px 3px;\">");
      printf("<input type=checkbox id=checkbox%d name=vdel value=%s>", v0, v7);
      printf("</td>");
      printf("<td width=130 style=\"padding:0px 3px 0px 3px;\">");
      printf("<label for=checkbox%d>%s</label>", v0, v7);
      v8 |= v10;
      printf("</td>");
      for ( i = 1; i <= v1; ++i )
      {
        printf("<td style=\"padding:0px 3px 0px 3px;\" align=left>");
        if ( (v10 >> (i - 1)) & 1 )
          printf("%2d", i);
        else
          printf("--", i);
        printf("</td>");
      }
      v12 = etr("<td style=\"padding:0px 3px 0px 3px;\" align=left>");
      v7 = *(_DWORD *)(v7 + 248);
      if ( !v7 )
        break;
      v0 = v9;
    }
    print_end_content_table(v12);
    genconfig_free_ll(&v21);
  }
  else
  {
    v8 = 0;
    v9 = v21;
  }
  while ( 1 )
  {
    v16 = __OFSUB__(v9, 14);
    v14 = v9 == 14;
    v15 = v9++ - 14 < 0;
    if ( !((unsigned __int8)(v15 ^ v16) | v14) )
      break;
    printf("<tr style='background-color: #%s;'>");
    printf("<td colspan=%d>", v1 + 2);
    v13 = printf("</td>");
    etr(v13);
  }
  printf("<tr style='height:1px;'>");
  printf("<td colspan=%d style='border-bottom: 1px solid #CCC;'>", v1 + 2);
  v17 = printf("</td>");
  etr(v17);
  return printf("<input type=hidden name=trunkmembers value=%d>\n", v8);
}
// E7D4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// ED20: using guessed type int __fastcall genconfig_read_file(_DWORD, _DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F698: using guessed type int __fastcall genconfig_free_ll(_DWORD);
// FBA8: using guessed type int __fastcall print_end_content_table(_DWORD);

//----- (00042B80) --------------------------------------------------------
int sub_42B80()
{
  int v0; // r5@1
  int i; // r4@1
  int v2; // r0@3
  int v3; // r0@4
  int v4; // r1@4
  int v5; // r0@4
  signed int v6; // r4@4
  int v7; // r0@4
  int v8; // r0@4
  bool v9; // zf@6
  bool v10; // nf@6
  unsigned __int8 v11; // vf@6
  int v12; // r0@7
  signed int v13; // r4@7
  int v14; // r0@10
  int v15; // r1@10
  int v16; // r0@10
  int v17; // r1@10
  int v18; // r4@10
  int v19; // r0@10
  char *v20; // r12@10
  int v21; // r0@12
  int v22; // r0@12
  char v24; // [sp+Ch] [bp-3C4h]@1
  int v25; // [sp+280h] [bp-150h]@1
  int v26; // [sp+3B8h] [bp-18h]@1
  int v27; // [sp+3BCh] [bp-14h]@1

  get_si("hw", &v24);
  v0 = v25;
  puts("<form method=get action=timepro.cgi name=trunk_fm>");
  puts("<input type=hidden name=tmenu value=switchconf>");
  puts("<input type=hidden name=smenu value=trunk>");
  puts("<input type=hidden name=act value=>");
  puts("<input type=hidden name=dellist value=>");
  puts("<input type=hidden name=vlanname value='All'>");
  puts("<input type=hidden name=vlanmap value=4294967295>");
  v27 = 0;
  v26 = 0;
  genconfig_read_file("/etc/vlan_config", &v26);
  for ( i = v26; i; i = *(_DWORD *)(i + 248) )
  {
    printf("<input type=hidden name=vlanname value='%s'>\n", i);
    v2 = atoi((const char *)(i + 64));
    printf("<input type=hidden name=vlanmap value=%d>\n", v2);
  }
  puts("<tr><td>");
  v3 = printf("<table cellspacing=0px cellpadding=0px style='width: 100%%; padding: 5px;'>\n");
  str(v3);
  v5 = sub_134F4(541, v4);
  v6 = 1;
  printf("<td colspan=4 align=left style='padding: 0 3px;'>TRUNK %s</td>", v5);
  printf("<td colspan=%d>", v0 - 4);
  printf("<input type=text name=tname size=20 maxlength=20>");
  v7 = printf("</td>");
  v8 = etr(v7);
  str(v8);
  while ( 1 )
  {
    v11 = __OFSUB__(v6, v0);
    v9 = v6 == v0;
    v10 = v6++ - v0 < 0;
    if ( !((unsigned __int8)(v10 ^ v11) | v9) )
      break;
    printf("<td align=center style='width: 10px; padding: 0 3px;'><label for=checkbox_p%d>%d</label></td>");
  }
  v12 = etr("<td align=center style='width: 10px; padding: 0 3px;'><label for=checkbox_p%d>%d</label></td>");
  v13 = 1;
  str(v12);
  while ( v13 <= v0 )
  {
    printf("<td style=\"padding:0px 3px 0px 3px;\" width=10 align=right>");
    printf("<input type=checkbox id=checkbox_p%d name=p%d >", v13, v13);
    printf("</td>");
    ++v13;
  }
  v14 = etr("<td style=\"padding:0px 3px 0px 3px;\" width=10 align=right>");
  str(v14);
  printf("<td style=\"padding:0px 3px 0px 3px;\" colspan=%d align=right>\n", v0);
  v16 = sub_134F4(1118, v15);
  printf("<font style='color:gray; float: left; padding: 4px;'>%s</font>", v16);
  v18 = sub_134F4(3, v17);
  v19 = trunk_group_is_full();
  v20 = "disabled";
  if ( !v19 )
    v20 = "";
  printf("<input type=button value=\"%s\" name=\"add_bt\" onclick=\"addTRUNK(%d, %d)\" %s>\n", v18, v0, 4, v20);
  v21 = printf("</td>");
  etr(v21);
  v22 = printf("<tr style='height: 8px;'><td colspan=24></td></tr>");
  print_end_content_table(v22);
  sub_4291C();
  return printf("</form>");
}
// E7D4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// ED20: using guessed type int __fastcall genconfig_read_file(_DWORD, _DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F980: using guessed type int trunk_group_is_full(void);
// FBA8: using guessed type int __fastcall print_end_content_table(_DWORD);

//----- (00042DC8) --------------------------------------------------------
int __fastcall sub_42DC8(int a1)
{
  int v1; // r7@1
  int result; // r0@1
  const char *v3; // r4@1
  int v4; // r5@4
  int v5; // r0@10
  int j; // r1@10
  signed int v7; // r4@13
  const char *v8; // r0@14
  int v9; // r0@16
  char v10; // r3@16
  char *v11; // r0@16
  int v12; // r0@20
  const char *i; // r5@23
  int v14; // r6@26
  int v15; // r0@29
  int v16; // [sp+4h] [bp-44Ch]@2
  int v17; // [sp+278h] [bp-1D8h]@10
  char v18; // [sp+3B3h] [bp-9Dh]@6
  char v19; // [sp+413h] [bp-3Dh]@11
  int v20; // [sp+42Ch] [bp-24h]@14
  int v21; // [sp+438h] [bp-18h]@16

  v1 = a1;
  result = get_pvalue(a1, "act");
  v3 = (const char *)result;
  if ( result )
  {
    get_si("hw", &v16);
    if ( strcmp(v3, (const char *)&unk_8B2CE) && strcmp(v3, "modifytrunk") )
    {
      result = strcmp(v3, "removetrunk");
      if ( result )
        return result;
      v12 = get_pvalue(v1, "dellist");
      if ( v12 )
      {
        for ( i = (const char *)v12; ; i = (const char *)(v14 + 1) )
        {
          v12 = (int)strchr(i, 44);
          v14 = v12;
          if ( !v12 )
            break;
          *(_BYTE *)v12 = 0;
          if ( *i )
          {
            sf_strncpy(&v18, i, 96);
            trunk_remove_config(&v18, -1);
          }
        }
      }
      goto LABEL_29;
    }
    result = get_pvalue(v1, "tname");
    v4 = result;
    if ( result )
    {
      result = check_unpermitted_chars(result);
      if ( !result )
      {
        sf_strncpy(&v18, v4, 96);
        if ( strcmp(v3, (const char *)&unk_8B2CE) || (result = trunk_check_tname_available(&v18)) == 0 )
        {
          if ( !strcmp(v3, "modifytrunk") )
            trunk_remove_config(&v18, 255);
          v5 = v17;
          for ( j = 0; j < v5; ++j )
            *(&v19 + j) = 48;
          v7 = 1;
          while ( v7 <= v17 )
          {
            sprintf((char *)&v20, "p%d");
            v8 = (const char *)get_pvalue(v1, &v20);
            if ( v8 && !strcmp(v8, "on") )
            {
              v9 = get_dev_port(&v16, v7);
              v10 = 49;
              v11 = (char *)&v21 + v9;
            }
            else
            {
              v11 = (char *)&v21 + get_dev_port(&v16, v7);
              v10 = 48;
            }
            ++v7;
            *(v11 - 37) = v10;
          }
          *((_BYTE *)&v21 + v17 - 37) = 0;
          v12 = trunk_add_config(&v18, &v19);
LABEL_29:
          v15 = signal_update(v12);
          return signal_save(v15);
        }
      }
    }
  }
  return result;
}
// E7D4: using guessed type int __fastcall get_si(_DWORD, _DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// ECCC: using guessed type int __fastcall trunk_add_config(_DWORD, _DWORD);
// F0E0: using guessed type int __fastcall trunk_check_tname_available(_DWORD);
// F11C: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// F164: using guessed type int __fastcall trunk_remove_config(_DWORD, _DWORD);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);
// FDC4: using guessed type int __fastcall get_dev_port(_DWORD, _DWORD);

//----- (0004304C) --------------------------------------------------------
int __fastcall sub_4304C(int a1)
{
  int v1; // r4@1
  int v2; // r0@1

  v1 = a1;
  printf("<style>");
  printf("tr { height: 22px; }");
  printf("</style>");
  printf("<table cellpadding=0px cellspacing=0px style='width: 100%%;'>\n");
  sub_42DC8(v1);
  v2 = sub_42B80();
  return print_end_main_table(v2);
}
// F5F0: using guessed type int __fastcall print_end_main_table(_DWORD);

//----- (0004309C) --------------------------------------------------------
int sub_4309C()
{
  int v0; // r0@1
  int v1; // r0@2
  int v2; // r1@2
  int v3; // r4@2
  int v4; // r1@2
  int v5; // r0@2
  int v6; // r0@2
  int v7; // r0@2
  int result; // r0@2
  int v9; // r0@3
  int v10; // r1@3
  int v11; // r0@3
  int v12; // r0@3
  int v13; // r0@3
  int v14; // r0@3
  int v15; // r8@3
  int v16; // r1@3
  int v17; // r7@4
  int v18; // r0@5
  int v19; // r0@7
  int v20; // r0@7
  int v21; // r0@7
  int v22; // r1@7
  int v23; // r0@7
  char *v24; // r5@7
  int v25; // r1@7
  char *v26; // r4@8
  int v27; // r0@10
  int v28; // r1@10
  int v29; // r0@12
  int v30; // r1@12
  int v31; // r0@12
  int v32; // r0@12
  int v33; // r0@12
  int v34; // r0@12
  int v35; // r0@12
  int v36; // r0@12
  int v37; // r0@12
  int v38; // r0@12
  int v39; // r1@12
  int v40; // r0@12
  int v41; // r0@12
  int v42; // r0@12
  int v43; // r1@12
  int v44; // r0@12
  char *v45; // r5@13
  char *v46; // r0@15
  int v47; // r1@15
  int v48; // r0@15
  int v49; // r1@15
  int v50; // r0@15
  int v51; // r0@15
  int v52; // r1@15
  int v53; // r0@15
  int v54; // r0@15
  int v55; // r0@15
  int v56; // r8@15
  int v57; // r1@15
  int v58; // r0@15
  int v59; // r1@15
  int v60; // r0@15
  char *v61; // r2@16
  int v62; // r4@20
  int v63; // r0@20
  int v64; // r0@20
  int v65; // r0@20
  int v66; // r0@20
  int v67; // r1@20
  int v68; // r0@20
  int v69; // r1@20
  int v70; // r0@20
  int v71; // r1@20
  int v72; // r0@20
  int i; // r0@20
  int v74; // r0@21
  bool v75; // nf@23
  unsigned __int8 v76; // vf@23
  int v77; // r0@24
  int v78; // r0@24
  char v79; // [sp+Ch] [bp-35Ch]@1
  char v80; // [sp+20Ch] [bp-15Ch]@22
  char v81; // [sp+30Ch] [bp-5Ch]@21
  char v82; // [sp+320h] [bp-48h]@3
  char v83; // [sp+334h] [bp-34h]@12

  v0 = get_wan_ip("wan1", &v79);
  if ( v0 )
  {
    v9 = print_start_content_table(v0);
    str(v9);
    v11 = sub_134F4(776, v10);
    snprintf2(&v79, 512, (const char *)v11, "http://iptime.iansim.net/service/serviceIntroduce.jsp");
    v12 = print_item(&v79, 0, 0, 0);
    v13 = etr(v12);
    print_end_content_table(v13);
    print_blank_line(1, 15);
    printf("<form method=get action=timepro.cgi name=plantynet_fm>");
    printf("<input type=hidden name=tmenu value=firewallconf>");
    printf("<input type=hidden name=smenu value=plantynet>");
    v14 = printf("<input type=hidden name=act value=>");
    v15 = get_plantynet_service(v14);
    plantynet_service_request("TCP", 85, 0, 0);
    get_plantynet_status(&v82);
    if ( !strcmp(&v82, "free") )
    {
      v17 = 1;
    }
    else
    {
      v18 = strcmp(&v82, "paid");
      v17 = 1 - v18;
      if ( (unsigned int)v18 > 1 )
        v17 = 0;
    }
    v19 = sub_134F4(779, v16);
    v20 = print_sub_title(v19, 1);
    v21 = print_start_content_table(v20);
    str(v21);
    v23 = sub_134F4(754, v22);
    v24 = "checked";
    print_item_desc(v23, 0, 0, 0);
    puts("<td class=item_td>");
    if ( v15 == 1 )
      v26 = "checked";
    else
      v26 = "";
    v27 = sub_134F4(894, v25);
    printf("<input type=radio name=op value=1 %s> %s", v26, v27);
    print_nbsp(5);
    if ( v15 == 1 )
      v24 = "";
    v29 = sub_134F4(900, v28);
    printf("<input type=radio name=op value=0 %s> %s", v24, v29);
    puts("</td>");
    puts("<td class=item_td>");
    v31 = sub_134F4(28, v30);
    printf("<input type=button name=op_button value=\"%s\" onclick=\"ApplyPlantynet()\">", v31);
    v32 = puts("</td>");
    v33 = etr(v32);
    str(v33);
    v34 = puts("<td colspan=3 class=item_td></td>");
    v35 = etr(v34);
    str(v35);
    printf("<td colspan=3 height=310 valign=top align=center style=\"padding: 0px; background-color:#f2f2fc; border:1px solid #cccccc; border-style:none solid solid solid;\" >");
    printf("<iframe name=\"ifr_plantynet\" scrolling=no style=\"border:1px solid #cccccc;\" frameborder=no width=600 height=310 src=\about:blank\"></iframe>");
    v36 = printf("</td>");
    v37 = etr(v36);
    print_end_content_table(v37);
    printf("</form>");
    get_hwaddr_kernel("br0", &v83);
    printf(
      "<form name=\"ifr_form\" target=\"ifr_plantynet\" method=\"POST\" action=\"%s\">",
      "http://iptime.iansim.net/service/serviceInfo.jsp");
    v38 = strtolower(&v83);
    printf("<input type=hidden name=MAC value=%s>", v38);
    printf("</form>");
    puts("<script language=\"JavaScript\">");
    puts("document.ifr_form.target=\"ifr_plantynet\";");
    puts("document.ifr_form.submit();");
    puts("</script>");
    print_blank_line(1, 15);
    printf("<form method=get action=timepro.cgi name=freedevice_fm>");
    printf("<input type=hidden name=tmenu value=firewallconf>");
    printf("<input type=hidden name=smenu value=plantynet>");
    printf("<input type=hidden name=act value=>");
    printf("<input type=hidden name=del value=>");
    v40 = sub_134F4(774, v39);
    v41 = print_sub_title(v40, 1);
    v42 = print_start_content_table(v41);
    str(v42);
    v44 = sub_134F4(512, v43);
    print_item_desc(v44, 0, 0, 0);
    puts("<td class=item_td align=left>");
    if ( v17 )
      v45 = "";
    else
      v45 = "disabled";
    v46 = getenv("REMOTE_ADDR");
    get_internal_pc_hardware_address(v46, &v83);
    printf(
      "<input type=checkbox class=navi_chk name=delchk onclick=\"SetHWOnCheckNoDisable(this,'hw','%s');\" %s> ",
      &v83,
      v45);
    v48 = sub_134F4(347, v47);
    printf((const char *)v48);
    printf("<br>");
    sub_121A0((int)"hw", 0, v17 ^ 1);
    print_nbsp(5);
    sub_134F4(781, v49);
    print_popup_button(
      "timepro.cgi?tmenu=popup&smenu=selectmac&formname=freedevice_fm&macprefix=hw",
      "searchmac",
      "width=400px,height=250px,scrollbars=yes,menubar=no,toolbar=no,resizable=yes",
      "macbutton");
    v50 = printf("</td>");
    v51 = etr(v50);
    str(v51);
    v53 = sub_134F4(215, v52);
    print_item_desc(v53, 0, 0, 0);
    puts("<td colspan=2 class=item_td>");
    v54 = printf("<input type=text name=\"dev_desc\" maxlength=24 size=24 value='' %s></td>\n", v45);
    v55 = etr(v54);
    v56 = get_plantynet_freedevice_num(v55);
    str(v56);
    puts("<td class=item_td colspan=2>");
    printf("<table class=nomargin_table width=100%%><tr><td align=left><font color='gray'>\n");
    v58 = sub_134F4(775, v57);
    printf((const char *)v58, 10);
    printf("</td><td align=right>");
    v60 = sub_134F4(3, v59);
    if ( v56 <= 9 )
    {
      if ( v17 )
        v61 = "";
      else
        v61 = "disabled";
    }
    else
    {
      v61 = "disabled";
    }
    printf("<input type=button name=freedev_submit value=\"%s\" onclick=\"AddPlantynetFreeDevice();\" %s>", v60, v61);
    printf("</td></tr></table>");
    v62 = 0;
    v63 = printf("</td>");
    v64 = etr(v63);
    print_end_content_table(v64);
    v65 = print_blank_line(1, 20);
    v66 = print_start_content_table(v65);
    str(v66);
    print_item_desc("", 30, 0, 0);
    v68 = sub_134F4(512, v67);
    print_item_desc(v68, 200, 0, 0);
    v70 = sub_134F4(215, v69);
    print_item_desc(v70, 250, 0, 0);
    printf("<td class=itemdesc_td align=left width=38>");
    v72 = sub_134F4(118, v71);
    printf("<input class=navi_bt type=button name=del_bt value=\"%s\" onclick=\"DeletePlantynetFreeDevice()\" %s>", v72);
    for ( i = printf("</td>");
          ;
          i = printf("<td class=item_td align=center ><input type=checkbox name=delchk value=\"%s\"></td>", &v81) )
    {
      etr(i);
      v76 = __OFSUB__(v62, v56);
      v75 = v62 - v56 < 0;
      v74 = v62++;
      if ( !(v75 ^ v76) )
        break;
      v74 = get_plantynet_freedevice(v74, &v81);
      if ( !v74 )
        break;
      str(v74);
      printf("<td class=item_td width=70>%d</td>\n", v62);
      sf_strncpy(&v79, &v81, 512);
      convert_mac(&v79);
      print_item(&v79, 200, 0, 0);
      print_item(&v80, 300, 0, 0);
    }
    str(v74);
    v77 = puts("<td class=item_td colspan=4> </td>");
    v78 = etr(v77);
    print_end_content_table(v78);
    result = puts("</form>");
  }
  else
  {
    v1 = print_start_content_table(0);
    str(v1);
    v3 = sub_134F4(777, v2);
    v5 = sub_134F4(780, v4);
    snprintf2(&v79, 512, "%s<br>%s", v3, v5);
    v6 = printf("<td style='padding: 5px;'>%s</td>", &v79);
    v7 = etr(v6);
    result = print_end_content_table(v7);
  }
  return result;
}
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E8D0: using guessed type int __fastcall get_plantynet_freedevice_num(_DWORD);
// E954: using guessed type int __fastcall get_plantynet_status(_DWORD);
// EA2C: using guessed type int __fastcall get_hwaddr_kernel(_DWORD, _DWORD);
// EA5C: using guessed type int __fastcall get_plantynet_service(_DWORD);
// EB70: using guessed type int __fastcall get_internal_pc_hardware_address(_DWORD, _DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EDBC: using guessed type int __fastcall print_popup_button(_DWORD, _DWORD, _DWORD, _DWORD);
// EE10: using guessed type int __fastcall convert_mac(_DWORD);
// EF18: using guessed type int __fastcall print_item(_DWORD, _DWORD, _DWORD, _DWORD);
// EFE4: using guessed type int __fastcall str(_DWORD);
// F32C: using guessed type int __fastcall etr(_DWORD);
// F374: using guessed type int __fastcall print_sub_title(_DWORD, _DWORD);
// F5A8: using guessed type int __fastcall print_nbsp(_DWORD);
// F764: using guessed type int __fastcall print_item_desc(_DWORD, _DWORD, _DWORD, _DWORD);
// F8A8: using guessed type int __fastcall print_start_content_table(_DWORD);
// F8CC: using guessed type int __fastcall get_wan_ip(_DWORD, _DWORD);
// F938: using guessed type int __fastcall print_blank_line(_DWORD, _DWORD);
// FA94: using guessed type int __fastcall plantynet_service_request(_DWORD, _DWORD, _DWORD, _DWORD);
// FBA8: using guessed type int __fastcall print_end_content_table(_DWORD);
// FBE4: using guessed type int __cdecl get_plantynet_freedevice(_DWORD, _DWORD);
// FDAC: using guessed type int __fastcall strtolower(_DWORD);

//----- (00043728) --------------------------------------------------------
int __fastcall sub_43728(int a1)
{
  int v1; // r7@1
  const char *v2; // r0@1
  const char *v3; // r4@1
  const char *v4; // r0@3
  int v5; // r5@3
  int v6; // r0@9
  int v7; // r0@9
  int v8; // r5@10
  const char *v9; // r6@11
  size_t v10; // r0@14
  const char *v11; // r1@14
  size_t v12; // r2@14
  int *v13; // r0@14
  size_t v14; // r0@15
  const char *v15; // r1@17
  int v16; // r4@20
  bool v17; // zf@26
  int v19; // [sp+Ch] [bp-11ACh]@21
  int v20; // [sp+100Ch] [bp-1ACh]@16
  int v21; // [sp+110Ch] [bp-ACh]@14
  int v22; // [sp+118Ch] [bp-2Ch]@4

  v1 = a1;
  v2 = (const char *)get_pvalue(a1, "act");
  v3 = v2;
  if ( !v2 )
    return 0;
  if ( strcmp(v2, "apply") )
  {
    v8 = strcmp(v3, "add");
    if ( v8 )
    {
      v16 = strcmp(v3, "del");
      if ( !v16 )
      {
        memset(&v19, 0, 0x1000u);
        while ( 1 )
        {
          v17 = get_value_array(v1, "delchk", v16, &v22) == 0;
          v7 = (int)&v19;
          if ( v17 )
            break;
          if ( (_BYTE)v19 )
            snprintf2(&v19, 4095, "%s|%s");
          else
            sf_strncpy(&v19, &v22, 4096);
          remove_plantynet_freedevice(&v22);
          ++v16;
        }
        if ( (_BYTE)v19 )
          v7 = plantynet_service_event(512, &v19);
        goto LABEL_30;
      }
      return 0;
    }
    memset(&v22, 0, 0x14u);
    get_hw_value(v1, "hw", &v22);
    strtolower(&v22);
    v9 = (const char *)get_pvalue(v1, &unk_885BA);
    if ( check_unpermitted_chars(v9) )
    {
      v9 = (const char *)v8;
    }
    else if ( v9 )
    {
      v10 = strlen(v9);
      v11 = v9;
      v12 = v10;
      v13 = &v21;
LABEL_16:
      Base64encode(v13, v11, v12);
      snprintf2(&v20, 254, "%s,%s", &v22, &v21);
      plantynet_service_event(256, &v20);
      if ( v9 )
        v15 = v9;
      else
        v15 = (const char *)&v22;
      v7 = add_plantynet_freedevice(&v22, v15);
LABEL_30:
      signal_save(v7);
      return 0;
    }
    v14 = strlen((const char *)&v22);
    v11 = (const char *)&v22;
    v12 = v14;
    v13 = &v21;
    goto LABEL_16;
  }
  v4 = (const char *)get_pvalue(v1, "op");
  v5 = atoi(v4);
  if ( v5 != get_plantynet_service(v5) )
  {
    plantynet_service_request("TCP", 85, 0, 0);
    get_plantynet_status(&v22);
    if ( !strcmp((const char *)&v22, "free") || !strcmp((const char *)&v22, "paid") )
    {
      if ( v5 )
        plantynet_service_event(3, 0);
      else
        v5 = 2;
    }
    v6 = set_plantynet_service(v5);
    v7 = signal_update(v6);
    goto LABEL_30;
  }
  return 0;
}
// E768: using guessed type int __fastcall get_hw_value(_DWORD, _DWORD, _DWORD);
// E8C4: using guessed type int __fastcall sf_strncpy(_DWORD, _DWORD, _DWORD);
// E954: using guessed type int __fastcall get_plantynet_status(_DWORD);
// EA44: using guessed type int __fastcall signal_save(_DWORD);
// EA5C: using guessed type int __fastcall get_plantynet_service(_DWORD);
// EC84: using guessed type int __fastcall set_plantynet_service(_DWORD);
// ED08: using guessed type int snprintf2(_DWORD, _DWORD, const char *, ...);
// EE7C: using guessed type int __fastcall get_value_array(_DWORD, _DWORD, _DWORD, _DWORD);
// F11C: using guessed type int __fastcall check_unpermitted_chars(_DWORD);
// F134: using guessed type int __fastcall plantynet_service_event(_DWORD, _DWORD);
// F5E4: using guessed type int __fastcall Base64encode(_DWORD, _DWORD, _DWORD);
// F794: using guessed type int __fastcall add_plantynet_freedevice(_DWORD, _DWORD);
// F878: using guessed type int __fastcall get_pvalue(_DWORD, _DWORD);
// FA94: using guessed type int __fastcall plantynet_service_request(_DWORD, _DWORD, _DWORD, _DWORD);
// FAA0: using guessed type int __fastcall remove_plantynet_freedevice(_DWORD);
// FCE0: using guessed type int __fastcall signal_update(_DWORD);
// FDAC: using guessed type int __fastcall strtolower(_DWORD);

//----- (00043A14) --------------------------------------------------------
int __fastcall sub_43A14(int a1)
{
  int v1; // r0@1
  int v2; // r0@1

  v1 = sub_43728(a1);
  print_start_main_table(v1);
  v2 = sub_4309C();
  return print_end_main_table(v2);
}
// F2A8: using guessed type int __fastcall print_start_main_table(_DWORD);
// F5F0: using guessed type int __fastcall print_end_main_table(_DWORD);

//----- (00043A2C) --------------------------------------------------------
unsigned int __fastcall sub_43A2C(unsigned int result, unsigned int a2)
{
  char v2; // r2@5
  unsigned int v3; // r1@5
  unsigned int v4; // r3@5
  unsigned int v5; // r2@5
  bool v6; // zf@14

  if ( a2 != 1 )
  {
    if ( a2 < 1 )
      JUMPOUT(&loc_449F8);
    if ( result <= a2 )
    {
      result = result == a2;
    }
    else if ( a2 & (a2 - 1) )
    {
      v2 = __clz(a2) - __clz(result);
      v3 = a2 << v2;
      v4 = 1 << v2;
      v5 = 0;
      while ( 1 )
      {
        if ( result >= v3 )
        {
          result -= v3;
          v5 |= v4;
        }
        if ( result >= v3 >> 1 )
        {
          result -= v3 >> 1;
          v5 |= v4 >> 1;
        }
        if ( result >= v3 >> 2 )
        {
          result -= v3 >> 2;
          v5 |= v4 >> 2;
        }
        if ( result >= v3 >> 3 )
        {
          result -= v3 >> 3;
          v5 |= v4 >> 3;
        }
        v6 = result == 0;
        if ( result )
        {
          v4 >>= 4;
          v6 = v4 == 0;
        }
        if ( v6 )
          break;
        v3 >>= 4;
      }
      result = v5;
    }
    else
    {
      result >>= 31 - __clz(a2);
    }
  }
  return result;
}

//----- (00043AD4) --------------------------------------------------------
unsigned int __fastcall sub_43AD4(unsigned int a1, unsigned int a2)
{
  if ( !a2 )
    JUMPOUT(&loc_43AC8);
  return sub_43A2C(a1, a2);
}

//----- (00043AF4) --------------------------------------------------------
int __fastcall sub_43AF4(int a1, int a2)
{
  if ( !a2 )
    JUMPOUT(&loc_449F8);
  return sub_43AFC(a1, a2);
}

//----- (00043AFC) --------------------------------------------------------
int __fastcall sub_43AFC(int result, unsigned int a2)
{
  char v2; // nf@0
  int v3; // r12@1
  int v4; // r3@4
  char v5; // r0@8
  unsigned int v6; // r1@8
  unsigned int v7; // r2@8
  bool v8; // zf@17

  v3 = result ^ a2;
  if ( v2 )
    a2 = -a2;
  if ( a2 == 1 )
  {
    if ( (v3 ^ result) < 0 )
      result = -result;
  }
  else
  {
    v4 = result;
    if ( result < 0 )
      v4 = -result;
    if ( v4 <= a2 )
    {
      if ( v4 < a2 )
        result = 0;
      if ( v4 == a2 )
        result = (v3 >> 31) | 1;
    }
    else if ( a2 & (a2 - 1) )
    {
      v5 = __clz(a2) - __clz(v4);
      v6 = a2 << v5;
      v7 = 1 << v5;
      result = 0;
      while ( 1 )
      {
        if ( v4 >= v6 )
        {
          v4 -= v6;
          result |= v7;
        }
        if ( v4 >= v6 >> 1 )
        {
          v4 -= v6 >> 1;
          result |= v7 >> 1;
        }
        if ( v4 >= v6 >> 2 )
        {
          v4 -= v6 >> 2;
          result |= v7 >> 2;
        }
        if ( v4 >= v6 >> 3 )
        {
          v4 -= v6 >> 3;
          result |= v7 >> 3;
        }
        v8 = v4 == 0;
        if ( v4 )
        {
          v7 >>= 4;
          v8 = v7 == 0;
        }
        if ( v8 )
          break;
        v6 >>= 4;
      }
      if ( v3 < 0 )
        result = -result;
    }
    else
    {
      result = (unsigned int)v4 >> (31 - __clz(a2));
      if ( v3 < 0 )
        result = -result;
    }
  }
  return result;
}

//----- (00043BD0) --------------------------------------------------------
int __fastcall sub_43BD0(int a1, unsigned int a2)
{
  if ( !a2 )
    JUMPOUT(&loc_43BC0);
  return sub_43AFC(a1, a2);
}

//----- (00043EA8) --------------------------------------------------------
unsigned int __fastcall sub_43EA8(unsigned int result, int a2, int a3, int a4, int a5, int a6, int (__fastcall *a7)(_DWORD, _DWORD))
{
  unsigned int v7; // r3@2

  if ( result )
  {
    v7 = __clz(result) + 21;
    result = a7(0, (result << (v7 - 32)) + ((1074 - v7) << 20));
  }
  return result;
}

//----- (00043ECC) --------------------------------------------------------
int __fastcall sub_43ECC(int result)
{
  if ( result )
    JUMPOUT(&loc_43D44);
  return result;
}

//----- (00043FA8) --------------------------------------------------------
int __fastcall sub_43FA8(int result, unsigned int a2, int a3, unsigned int a4)
{
  int v4; // r5@0
  bool v5; // zf@1
  int v6; // r4@1
  int v7; // r4@7
  int v8; // r6@7
  int v9; // r1@7
  int v10; // r3@7
  bool v11; // zf@7
  int v12; // r1@9
  int v13; // r3@9
  int v14; // r12@10
  unsigned int v15; // r5@10
  unsigned int v16; // lr@10
  unsigned int v17; // r2@10
  unsigned int v18; // r5@10
  unsigned int v19; // lr@10
  unsigned __int64 v20; // kr18_8@10
  unsigned int v21; // r5@10
  unsigned int v22; // r6@10
  int v23; // r4@12
  int v24; // off@13
  int v25; // r1@14
  unsigned int v26; // lr@14
  unsigned __int8 v27; // cf@14
  bool v28; // zf@14
  bool v29; // nf@14
  unsigned __int8 v30; // vf@14
  int v31; // r12@14
  unsigned __int8 v32; // cf@17
  unsigned int v33; // r1@20
  bool v34; // zf@20
  bool v35; // nf@20
  unsigned __int8 v36; // vf@20
  int v37; // r4@20
  int v38; // r4@29
  int v39; // r4@29
  int v40; // r4@31
  char v41; // r4@33
  unsigned int v42; // r3@33
  char v43; // r4@36
  unsigned int v44; // r3@36
  int v45; // lr@39
  int v46; // r3@39
  int v47; // r5@47
  bool v48; // zf@49
  bool v49; // zf@52
  bool v50; // zf@57

  v6 = (a2 >> 20) & 0x7FF;
  v5 = v6 == 0;
  if ( v6 )
  {
    v4 = (a4 >> 20) & 0x7FF;
    v5 = v4 == 0;
  }
  if ( !v5 )
  {
    v5 = v6 == 2047;
    if ( v6 != 2047 )
      v5 = v4 == 2047;
  }
  if ( v5 )
  {
    v48 = v6 == 2047;
    v47 = (a4 >> 20) & 0x7FF;
    if ( v6 != 2047 )
      v48 = v47 == 2047;
    if ( v48 )
    {
      v50 = (result | 2 * a2) == 0;
      if ( result | 2 * a2 )
      {
        v50 = (a3 | 2 * a4) == 0;
      }
      else
      {
        result = a3;
        a2 = a4;
      }
      if ( !v50 && (v6 != 2047 || !(result | (a2 << 12))) )
      {
        if ( v47 == 2047 && a3 | (a4 << 12) )
          return a3;
        return 0;
      }
    }
    else
    {
      v49 = (result | 2 * a2) == 0;
      if ( result | 2 * a2 )
        v49 = (a3 | 2 * a4) == 0;
      if ( v49 )
      {
        result = 0;
      }
      else
      {
        if ( v6 )
          goto LABEL_69;
        while ( 1 )
        {
          v27 = __CFSHL__(result, 1);
          result *= 2;
          a2 += v27 + a2;
          if ( a2 & 0x100000 )
            break;
          --v6;
        }
        if ( !v47 )
        {
LABEL_69:
          while ( 1 )
          {
            v27 = __CFSHL__(a3, 1);
            a3 *= 2;
            a4 += v27 + a4;
            if ( a4 & 0x100000 )
              break;
            --v47;
          }
        }
      }
    }
  }
  else
  {
    v7 = v6 + v4;
    v8 = a2 ^ a4;
    v9 = a2 & 0x1FFFFF;
    v10 = a4 & 0x1FFFFF;
    v11 = (result | (v9 << 12)) == 0;
    if ( result | (v9 << 12) )
      v11 = (a3 | (v10 << 12)) == 0;
    v12 = v9 | 0x100000;
    v13 = v10 | 0x100000;
    if ( v11 )
    {
      result |= a3;
      v33 = (v8 & 0x80000000 | v12) ^ v13;
      v36 = __OFSUB__(v7, 1023);
      v37 = v7 - 1023;
      v34 = v37 == 0;
      v35 = v37 < 0;
      if ( !((unsigned __int8)((v37 < 0) ^ v36) | (v37 == 0)) )
      {
        v36 = __OFSUB__(2047, v37);
        v34 = 2047 == v37;
        v35 = 2047 - v37 < 0;
      }
      if ( !((unsigned __int8)(v35 ^ v36) | v34) )
        return result;
      v25 = v33 | 0x100000;
      v26 = 0;
      v30 = __OFSUB__(v37, 1);
      v23 = v37 - 1;
      v28 = v23 == 0;
      v29 = v23 < 0;
    }
    else
    {
      v14 = result * a3;
      v15 = ((unsigned int)v12 * (unsigned __int64)(unsigned int)a3
           + (unsigned int)((unsigned int)result * (unsigned __int64)(unsigned int)a3 >> 32)) >> 32;
      v16 = v12 * a3 + ((unsigned int)result * (unsigned __int64)(unsigned int)a3 >> 32);
      v17 = v8 & 0x80000000;
      v20 = (unsigned int)result * (unsigned __int64)(unsigned int)v13 + __PAIR__(v15, v16);
      v18 = v20 >> 32;
      v19 = v20;
      v22 = ((unsigned int)v12 * (unsigned __int64)(unsigned int)v13 + v18) >> 32;
      v21 = v12 * v13 + v18;
      if ( v14 )
        v19 = v20 | 1;
      v23 = (__PAIR__((unsigned int)(v7 - 255), v22) - 3298534883840LL) >> 32;
      if ( v22 < 0x200 )
      {
        v27 = __CFSHL__(v19, 1);
        v19 *= 2;
        v24 = v27 + v21;
        v27 = __CFADD__(v27, v21) | __CFADD__(v21, v24);
        v21 += v24;
        v22 += v27 + v22;
      }
      v25 = v17 | (v22 << 11) | (v21 >> 21);
      result = (v21 << 11) | (v19 >> 21);
      v26 = v19 << 11;
      v30 = __OFSUB__(v23, 253);
      v27 = (unsigned int)v23 >= 0xFD;
      v31 = v23 - 253;
      v28 = v23 == 253;
      v29 = v23 - 253 < 0;
      if ( (unsigned int)v23 > 0xFD )
      {
        v30 = __OFSUB__(v31, 1792);
        v27 = (unsigned int)v31 >= 0x700;
        v28 = v31 == 1792;
        v29 = v23 - 2045 < 0;
      }
      if ( !(!v28 & v27) )
      {
        v32 = v26 >= 0x80000000;
        if ( v26 == 0x80000000 )
          v32 = result & 1;
        result += v32;
        return result;
      }
    }
    if ( !((unsigned __int8)(v29 ^ v30) | v28) )
      return 0;
    if ( (unsigned __int8)((v23 + 54 < 0) ^ __OFADD__(v23, 54)) | (v23 == -54) )
    {
      result = 0;
    }
    else
    {
      v38 = -v23;
      v30 = __OFSUB__(v38, 32);
      v39 = v38 - 32;
      if ( (v39 < 0) ^ v30 )
      {
        v30 = __OFADD__(v39, 12);
        v40 = v39 + 12;
        if ( (unsigned __int8)((v40 < 0) ^ v30) | (v40 == 0) )
        {
          v41 = v40 + 20;
          v42 = result << (32 - v41);
          result = (((unsigned int)result >> v41) | (v25 << (32 - v41))) + (v42 >> 31);
          if ( !(v26 | 2 * v42) )
            result &= ~(v42 >> 31);
        }
        else
        {
          v43 = 12 - v40;
          v44 = result << v43;
          result = (((unsigned int)result >> (32 - v43)) | (v25 << v43)) + ((unsigned int)(result << v43) >> 31);
          if ( !(v26 | 2 * v44) )
            result &= ~(v44 >> 31);
        }
      }
      else
      {
        v45 = v26 | (result << (32 - v39));
        v46 = ((unsigned int)result >> v39) | (v25 << (32 - v39));
        result = (((unsigned int)v25 >> v39) & ~((v25 & 0x80000000) >> v39)) + ((unsigned int)v46 >> 31);
        if ( !(v45 | 2 * v46) )
          result &= ~((unsigned int)v46 >> 31);
      }
    }
  }
  return result;
}

//----- (000443A8) --------------------------------------------------------
void __fastcall sub_443A8(int a1, int a2, int a3, unsigned int a4)
{
  int v4; // r4@0
  int v5; // r12@0
  int v6; // r5@1
  bool v7; // zf@1
  bool v8; // zf@15

  v6 = v5 & (a4 >> 20);
  v7 = v4 == v5;
  if ( v4 == v5 )
    v7 = v6 == v5;
  if ( v7 )
    JUMPOUT(&loc_44208);
  if ( v4 == v5 )
  {
    if ( a1 | (a2 << 12) )
      JUMPOUT(&loc_44208);
    if ( v6 != v5 )
      JUMPOUT(&loc_441F0);
    JUMPOUT(&loc_44208);
  }
  if ( v6 == v5 )
  {
    if ( !(a3 | (a4 << 12)) )
      JUMPOUT(&loc_441A4);
    JUMPOUT(&loc_44208);
  }
  v8 = (a1 | 2 * a2) == 0;
  if ( a1 | 2 * a2 )
    v8 = (a3 | 2 * a4) == 0;
  if ( !v8 )
    JUMPOUT(&loc_4413C);
  if ( a1 | 2 * a2 )
    JUMPOUT(&loc_441F0);
  if ( a3 | 2 * a4 )
    JUMPOUT(&loc_441A4);
  JUMPOUT(&loc_44208);
}

//----- (00044424) --------------------------------------------------------
int __fastcall sub_44424(int result, int a2, int a3, int a4)
{
  bool v4; // zf@1
  int v5; // r2@1
  signed int v6; // r2@8
  unsigned __int8 v7; // vf@8
  int v8; // r3@8
  int v9; // r1@9
  int v10; // r0@13
  int v11; // r1@15
  int v12; // r2@18
  int v13; // r0@18
  int v14; // r1@18
  unsigned int v15; // r3@18
  unsigned __int8 v16; // cf@19
  int v17; // off@22
  int v18; // r0@23
  unsigned int v19; // r12@27
  bool v20; // nf@27
  unsigned __int8 v21; // vf@27
  int v22; // r2@27
  unsigned int v23; // r0@27
  signed int v24; // r3@38
  bool v25; // zf@38
  bool v26; // zf@55
  int v27; // r2@55
  bool v28; // zf@60

  v5 = 2 * result;
  v4 = 2 * result == 0;
  if ( 2 * result )
  {
    a4 = 2 * a2;
    v4 = 2 * a2 == 0;
  }
  if ( !v4 )
  {
    v4 = v5 == a4;
    if ( v5 != a4 )
    {
      v4 = ~(v5 >> 24) == 0;
      if ( ~(v5 >> 24) )
        v4 = ~(a4 >> 24) == 0;
    }
  }
  if ( v4 )
  {
    v24 = 2 * a2;
    v25 = ~(v5 >> 24) == 0;
    if ( ~(v5 >> 24) )
      v25 = ~(v24 >> 24) == 0;
    if ( v25 )
    {
      v27 = ~(v5 >> 24);
      v26 = v27 == 0;
      if ( v27 )
        result = a2;
      else
        v26 = ~(v24 >> 24) == 0;
      if ( !v26 )
        a2 = result;
      v28 = result << 9 == 0;
      if ( !(result << 9) )
        v28 = a2 << 9 == 0;
      if ( v28 )
        v28 = result == a2;
      if ( !v28 )
        result |= 0x400000u;
    }
    else if ( v5 == v24 )
    {
      if ( result != a2 )
        return 0;
      if ( v5 & 0xFF000000 )
      {
        if ( (unsigned int)v5 < 0xFE000000 )
        {
          result += 0x800000;
          return result;
        }
        v15 = result & 0x80000000;
        return v15 | 0x7F800000;
      }
      v16 = __CFSHL__(result, 1);
      result *= 2;
      if ( v16 )
        result |= 0x80000000;
    }
    else if ( !v5 )
    {
      result = a2;
    }
  }
  else
  {
    v6 = (unsigned int)v5 >> 24;
    v7 = __OFSUB__((unsigned int)a4 >> 24, v6);
    v8 = ((unsigned int)a4 >> 24) - v6;
    if ( !((unsigned __int8)((v8 < 0) ^ v7) | (v8 == 0)) )
    {
      v6 += v8;
      v9 = result ^ a2;
      result ^= v9;
      a2 = result ^ v9;
    }
    if ( (v8 < 0) ^ v7 )
      v8 = -v8;
    if ( (unsigned int)v8 <= 0x19 )
    {
      v4 = (result & 0x80000000) == 0;
      v10 = (result | 0x800000) & 0xFFFFFF;
      if ( !v4 )
        v10 = -v10;
      v4 = (a2 & 0x80000000) == 0;
      v11 = (a2 | 0x800000) & 0xFFFFFF;
      if ( !v4 )
        v11 = -v11;
      if ( v6 == v8 )
      {
        v11 ^= 0x800000u;
        if ( v6 )
        {
          LOBYTE(v8) = v8 - 1;
        }
        else
        {
          v10 ^= 0x800000u;
          v6 = 1;
        }
      }
      v12 = v6 - 1;
      v13 = v10 + (v11 >> v8);
      v14 = v11 << (32 - v8);
      v15 = v13 & 0x80000000;
      if ( v13 < 0 )
      {
        v16 = (unsigned int)v14 <= 0;
        v14 = -v14;
        v13 = -(!v16 + v13);
      }
      if ( (unsigned int)v13 >= 0x800000 )
      {
        if ( (unsigned int)v13 < 0x1000000
          || (v13 = (unsigned int)v13 >> 1, v17 = __RCR__(v14, 1), v14 = v17, ++v12, (unsigned int)v12 < 0xFE) )
        {
LABEL_23:
          v18 = (v12 << 23) + ((unsigned int)v14 >= 0x80000000) + v13;
          if ( v14 == 0x80000000 )
            v18 &= 0xFFFFFFFE;
          return v18 | v15;
        }
        return v15 | 0x7F800000;
      }
      v16 = __CFSHL__(v14, 1);
      v14 *= 2;
      v13 += v16 + v13;
      --v12;
      if ( v13 & 0x800000 )
        goto LABEL_23;
      v19 = __clz(v13) - 8;
      v21 = __OFSUB__(v12, v19);
      v22 = v12 - v19;
      v20 = v22 < 0;
      v23 = v13 << v19;
      if ( (v22 < 0) ^ v21 )
        v22 = -v22;
      else
        v23 += v22 << 23;
      if ( v20 ^ v21 )
        result = v15 | (v23 >> v22);
      else
        result = v23 | v15;
    }
  }
  return result;
}

//----- (000445BC) --------------------------------------------------------
int __fastcall sub_445BC(int result)
{
  unsigned int v1; // r3@1
  int v2; // r1@4
  unsigned int v3; // r2@4
  unsigned __int8 v4; // vf@4
  int v5; // r2@4
  int v6; // r3@4
  char v7; // r2@6

  v1 = result & 0x80000000;
  if ( (result & 0x80000000 & 0x80000000) != 0 )
    result = -result;
  if ( result )
  {
    v2 = result;
    v3 = __clz(result);
    v4 = __OFSUB__(v3, 8);
    v5 = v3 - 8;
    v6 = (v1 | 0x4B000000) - 0x800000 - (v5 << 23);
    if ( (v5 < 0) ^ v4 )
    {
      v7 = v5 + 32;
      result = ((unsigned int)result >> (32 - v7)) + __CFSHL__(result << v7, 1) + v6;
      if ( !(2 * (v2 << v7)) )
        result &= ~((unsigned int)(v2 << v7) >> 31);
    }
    else
    {
      result = v6 + (result << v5);
    }
  }
  return result;
}

//----- (00044668) --------------------------------------------------------
int __fastcall sub_44668(unsigned int a1, unsigned int a2, int a3, int a4)
{
  bool v4; // zf@1
  int v5; // r2@1
  int v6; // r2@7
  int v7; // r12@7
  bool v8; // zf@7
  unsigned int v9; // r0@7
  unsigned int v10; // r1@10
  int v11; // r3@10
  unsigned int v12; // kr00_4@10
  bool v13; // cf@10
  unsigned int v14; // r0@12
  int v15; // r2@12
  bool v16; // zf@12
  bool v17; // nf@12
  unsigned __int8 v18; // vf@12
  int result; // r0@13
  unsigned int v20; // r12@16
  int v21; // r0@18
  bool v22; // zf@18
  bool v23; // nf@18
  unsigned __int8 v24; // vf@18
  int v25; // r2@18
  int v26; // r2@27
  unsigned int v27; // r12@27
  int v28; // off@27
  unsigned int v29; // r12@44
  bool v30; // zf@31
  bool v31; // zf@33
  unsigned int v32; // r12@33
  bool v33; // zf@38
  bool v34; // zf@41
  bool v35; // zf@46

  v5 = (a1 >> 23) & 0xFF;
  v4 = v5 == 0;
  if ( v5 )
  {
    a4 = (a2 >> 23) & 0xFF;
    v4 = a4 == 0;
  }
  if ( !v4 )
  {
    v4 = v5 == 255;
    if ( v5 != 255 )
      v4 = a4 == 255;
  }
  if ( v4 )
  {
    a4 = (a2 >> 23) & 0xFF;
    v33 = v5 == 255;
    if ( v5 != 255 )
      v33 = a4 == 255;
    if ( v33 )
    {
      v35 = a1 == 0;
      if ( a1 )
        v35 = a1 == 2147483648;
      if ( v35 )
        a1 = a2;
      else
        v35 = a2 == 0;
      if ( !v35 )
        v35 = a2 == 2147483648;
      if ( !v35 && (v5 != 255 || !(a1 << 9)) )
      {
        if ( a4 != 255 || !(a2 << 9) )
        {
          v14 = a1 ^ a2;
          return v14 & 0x80000000 | 0x7F800000;
        }
        a1 = a2;
      }
      return a1 | 0x7FC00000;
    }
    v34 = (a1 & 0x7FFFFFFF) == 0;
    if ( a1 & 0x7FFFFFFF )
      v34 = (a2 & 0x7FFFFFFF) == 0;
    if ( v34 )
      return (a1 ^ a2) & 0x80000000;
    v30 = v5 == 0;
    v29 = a1 & 0x80000000;
    while ( v30 )
    {
      a1 *= 2;
      v30 = (a1 & 0x800000) == 0;
      if ( a1 & 0x800000 )
        break;
      --v5;
    }
    a1 |= v29;
    v31 = a4 == 0;
    v32 = a2 & 0x80000000;
    while ( v31 )
    {
      a2 *= 2;
      v31 = (a2 & 0x800000) == 0;
      if ( a2 & 0x800000 )
        break;
      --a4;
    }
    a2 |= v32;
  }
  v6 = v5 + a4;
  v7 = a1 ^ a2;
  v9 = a1 << 9;
  v8 = v9 == 0;
  if ( v9 )
  {
    a2 <<= 9;
    v8 = a2 == 0;
  }
  if ( v8 )
  {
    v20 = v7 & 0x80000000;
    if ( !v9 )
      a2 <<= 9;
    v21 = v20 | (v9 >> 9) | (a2 >> 9);
    v24 = __OFSUB__(v6, 127);
    v25 = v6 - 127;
    v22 = v25 == 0;
    v23 = v25 < 0;
    if ( !((unsigned __int8)((v25 < 0) ^ v24) | (v25 == 0)) )
    {
      v24 = __OFSUB__(255, v25);
      v22 = 255 == v25;
      v23 = 255 - v25 < 0;
    }
    if ( !((unsigned __int8)(v23 ^ v24) | v22) )
      return v21 | (v25 << 23);
    v14 = v21 | 0x800000;
    v11 = 0;
    v18 = __OFSUB__(v25, 1);
    v15 = v25 - 1;
    v16 = v15 == 0;
    v17 = v15 < 0;
  }
  else
  {
    v12 = ((v9 >> 5) | 0x8000000) * ((a2 >> 5) | 0x8000000);
    v10 = ((v9 >> 5) | 0x8000000) * (unsigned __int64)((a2 >> 5) | 0x8000000) >> 32;
    v11 = v12;
    v13 = v10 >= 0x800000;
    if ( v10 < 0x800000 )
    {
      v10 = 2 * v10 | (v12 >> 31);
      v11 = 2 * v12;
    }
    v14 = v7 & 0x80000000 | v10;
    v15 = v6 - (!v13 + 127);
    v18 = __OFSUB__(v15, 253);
    v16 = v15 == 253;
    v17 = v15 - 253 < 0;
    if ( (unsigned int)v15 <= 0xFD )
    {
      result = (v15 << 23) + ((unsigned int)v11 >= 0x80000000) + v14;
      if ( v11 == 0x80000000 )
        result &= 0xFFFFFFFE;
      return result;
    }
  }
  if ( !((unsigned __int8)(v17 ^ v18) | v16) )
    return v14 & 0x80000000 | 0x7F800000;
  if ( (unsigned __int8)((v15 + 25 < 0) ^ __OFADD__(v15, 25)) | (v15 == -25) )
  {
    result = v14 & 0x80000000;
  }
  else
  {
    v26 = -v15;
    v27 = v14 << (32 - v26);
    v28 = __RCR__(2 * v14 >> v26, 1);
    result = ((2 * v14 >> v26) & 1) + v28;
    if ( !(v11 | 2 * v27) )
      result &= ~(v27 >> 31);
  }
  return result;
}

//----- (00044800) --------------------------------------------------------
int __fastcall sub_44800(unsigned int a1, unsigned int a2, int a3, int a4)
{
  bool v4; // zf@1
  int v5; // r2@1
  int v6; // r2@7
  int v7; // r12@7
  unsigned int v8; // r1@7
  unsigned int v9; // r0@7
  int v10; // r1@8
  int v11; // r3@8
  unsigned int v12; // r0@8
  bool v13; // cf@8
  int v14; // r2@10
  unsigned int v15; // r12@10
  bool v16; // zf@19
  int result; // r0@25
  unsigned int v18; // r0@28
  bool v19; // zf@28
  bool v20; // nf@28
  unsigned __int8 v21; // vf@28
  int v22; // r2@28
  unsigned int v23; // r12@54
  bool v24; // zf@34
  bool v25; // zf@36
  unsigned int v26; // r12@36
  bool v27; // zf@51

  v5 = (a1 >> 23) & 0xFF;
  v4 = v5 == 0;
  if ( v5 )
  {
    a4 = (a2 >> 23) & 0xFF;
    v4 = a4 == 0;
  }
  if ( !v4 )
  {
    v4 = v5 == 255;
    if ( v5 != 255 )
      v4 = a4 == 255;
  }
  if ( v4 )
  {
    a4 = (a2 >> 23) & 0xFF;
    if ( v5 == 255 )
    {
      if ( a1 << 9 )
        JUMPOUT(&loc_447F4);
      if ( a4 != 255 )
        JUMPOUT(&loc_447E0);
      JUMPOUT(&loc_447F4);
    }
    if ( a4 == 255 )
    {
      if ( !(a2 << 9) )
        JUMPOUT(&loc_44798);
      JUMPOUT(&loc_447F4);
    }
    v27 = (a1 & 0x7FFFFFFF) == 0;
    if ( a1 & 0x7FFFFFFF )
      v27 = (a2 & 0x7FFFFFFF) == 0;
    if ( v27 )
    {
      if ( a1 & 0x7FFFFFFF )
        JUMPOUT(&loc_447E0);
      if ( a2 & 0x7FFFFFFF )
        JUMPOUT(&loc_44798);
      JUMPOUT(&loc_447F4);
    }
    v24 = v5 == 0;
    v23 = a1 & 0x80000000;
    while ( v24 )
    {
      a1 *= 2;
      v24 = (a1 & 0x800000) == 0;
      if ( a1 & 0x800000 )
        break;
      --v5;
    }
    a1 |= v23;
    v25 = a4 == 0;
    v26 = a2 & 0x80000000;
    while ( v25 )
    {
      a2 *= 2;
      v25 = (a2 & 0x800000) == 0;
      if ( a2 & 0x800000 )
        break;
      --a4;
    }
    a2 |= v26;
  }
  v6 = v5 - a4;
  v7 = a1 ^ a2;
  v8 = a2 << 9;
  v9 = a1 << 9;
  if ( v8 )
  {
    v10 = (v8 >> 4) | 0x10000000;
    v11 = (v9 >> 4) | 0x10000000;
    v12 = v7 & 0x80000000;
    v13 = v11 >= (unsigned int)v10;
    if ( v11 < (unsigned int)v10 )
      v11 *= 2;
    v14 = v13 + v6 + 125;
    v15 = 0x800000;
    do
    {
      if ( v11 >= (unsigned int)v10 )
      {
        v11 -= v10;
        v12 |= v15;
      }
      if ( v11 >= (unsigned int)v10 >> 1 )
      {
        v11 -= (unsigned int)v10 >> 1;
        v12 |= v15 >> 1;
      }
      if ( v11 >= (unsigned int)v10 >> 2 )
      {
        v11 -= (unsigned int)v10 >> 2;
        v12 |= v15 >> 2;
      }
      if ( v11 >= (unsigned int)v10 >> 3 )
      {
        v11 -= (unsigned int)v10 >> 3;
        v12 |= v15 >> 3;
      }
      v11 *= 16;
      v16 = v11 == 0;
      if ( v11 )
      {
        v15 >>= 4;
        v16 = v15 == 0;
      }
    }
    while ( !v16 );
    if ( (unsigned int)v14 > 0xFD )
      JUMPOUT(&loc_44708);
    result = (v14 << 23) + (v11 >= (unsigned int)v10) + v12;
    if ( v11 == v10 )
      result &= 0xFFFFFFFE;
  }
  else
  {
    v18 = v7 & 0x80000000 | (v9 >> 9);
    v21 = __OFADD__(v6, 127);
    v22 = v6 + 127;
    v19 = v22 == 0;
    v20 = v22 < 0;
    if ( !((unsigned __int8)((v22 < 0) ^ v21) | (v22 == 0)) )
    {
      v21 = __OFSUB__(255, v22);
      v19 = 255 == v22;
      v20 = 255 - v22 < 0;
    }
    if ( (unsigned __int8)(v20 ^ v21) | v19 )
      JUMPOUT(&loc_44708);
    result = v18 | (v22 << 23);
  }
  return result;
}

//----- (00044960) --------------------------------------------------------
unsigned int __fastcall sub_44960(int a1)
{
  unsigned int v1; // r2@1
  bool v2; // cf@2
  int v3; // r2@2
  bool v4; // zf@4
  unsigned int result; // r0@4

  v1 = 2 * a1;
  if ( (unsigned int)(2 * a1) < 0x7F000000 )
  {
    result = 0;
  }
  else
  {
    v2 = v1 >> 24 <= 0x9E;
    v3 = 158 - (v1 >> 24);
    if ( v3 != 0 && v2 )
    {
      v4 = (a1 & 0x80000000) == 0;
      result = ((a1 << 8) | 0x80000000) >> v3;
      if ( !v4 )
        result = -result;
    }
    else if ( v3 == -97 && a1 << 9 )
    {
      result = 0;
    }
    else
    {
      result = a1 & 0x80000000;
      if ( !result )
        result = 0x7FFFFFFF;
    }
  }
  return result;
}

//----- (000449BC) --------------------------------------------------------
int __fastcall sub_449BC(__int64 a1, __int64 a2)
{
  int v2; // lr@0
  int v4; // [sp+4h] [bp-8h]@2
  int v5; // [sp+8h] [bp-4h]@5

  if ( !a2 )
  {
    if ( a1 )
      HIDWORD(a1) = -1;
    v4 = HIDWORD(a1);
    v5 = v2;
    raise(8);
    JUMPOUT(__CS__, v5);
  }
  return sub_44A08(a1, a2, HIDWORD(a2), (int)&v4);
}

//----- (00044A08) --------------------------------------------------------
int __fastcall sub_44A08(__int64 a1, unsigned int a2, unsigned int a3, int a4)
{
  unsigned int v4; // r7@1
  unsigned int v5; // r6@1
  __int64 v6; // r4@1
  __int64 v7; // r0@1

  v4 = a2;
  v5 = a3;
  v6 = a1;
  LODWORD(v7) = sub_44FA8(a1, HIDWORD(a1), a2, a3);
  *(_QWORD *)a4 = v6 - v7 * __PAIR__(v5, v4);
  return v7;
}

//----- (00044A88) --------------------------------------------------------
unsigned __int64 __fastcall sub_44A88(unsigned int a1, int a2, unsigned int a3, unsigned int a4)
{
  bool v4; // nf@1
  unsigned int v5; // r4@1
  int v6; // r5@1
  unsigned int v7; // r0@1
  unsigned int v8; // r1@1
  signed int v9; // r12@2
  unsigned int v10; // r12@6
  int v11; // r7@6
  unsigned int v12; // r11@6
  unsigned int v13; // r5@6
  signed int v14; // r2@10
  int v15; // r2@16
  unsigned int v16; // r10@20
  int v17; // r7@20
  int v18; // r2@20
  int v19; // r1@20
  int v20; // r4@20
  unsigned int v21; // r4@24
  unsigned int v22; // r6@24
  int v23; // r0@24
  int v24; // r1@24
  int v25; // r2@24
  int v26; // r0@28
  signed int v27; // r2@33
  unsigned int v28; // r1@39
  int v29; // r2@39
  int v30; // r3@39
  char v31; // r9@39
  unsigned int v32; // r4@40
  int v33; // r7@40
  unsigned int v34; // r4@41
  unsigned int v35; // r0@41
  int v36; // r7@41
  unsigned int v37; // r10@41
  int v38; // r2@41
  int v39; // r1@41
  int v40; // r4@41
  unsigned int v41; // r4@45
  unsigned int v42; // r6@45
  int v43; // r4@45
  int v44; // r1@45
  int v45; // r0@45
  int v46; // r8@50
  unsigned int v47; // r9@50
  int v48; // r2@50
  int v49; // r1@50
  int v50; // r4@50
  unsigned int v51; // r4@54
  unsigned int v52; // r6@54
  int v53; // r0@54
  int v54; // r1@54
  int v55; // r2@54
  signed int v56; // r2@62
  unsigned int v57; // r1@68
  int v58; // r2@68
  int v59; // r3@68
  char v60; // r9@68
  unsigned __int8 v61; // cf@69
  unsigned int v62; // r4@74
  int v63; // r6@74
  unsigned int v64; // r0@74
  int v65; // r7@74
  unsigned int v66; // r10@74
  int v67; // r2@74
  int v68; // r1@74
  int v69; // r4@74
  unsigned int v70; // r4@78
  unsigned int v71; // r5@78
  int v72; // r2@78
  int v73; // r1@78
  int v74; // r0@78
  int v75; // r2@82
  int v76; // lr@82
  int v77; // r4@82
  int v78; // r1@82
  int v79; // r4@82
  int v80; // lr@82
  int v81; // r3@82
  unsigned int v82; // lr@82
  unsigned __int64 v83; // kr08_8@84
  int v84; // r2@86
  unsigned __int64 v85; // r2@93
  int v87; // [sp+0h] [bp-38h]@4
  int v88; // [sp+4h] [bp-34h]@41
  unsigned int v89; // [sp+8h] [bp-30h]@74
  int v90; // [sp+Ch] [bp-2Ch]@74

  v4 = a2 < 0;
  v5 = a1;
  v6 = a2;
  v7 = a3;
  v8 = a4;
  if ( v4 )
  {
    v61 = v5 <= 0;
    v5 = -v5;
    v6 = -(!v61 + v6);
    v9 = -1;
  }
  else
  {
    v9 = 0;
  }
  v87 = v9;
  if ( (a4 & 0x80000000) != 0 )
  {
    v7 = -a3;
    v8 = -((a3 > 0) + a4);
    v87 = ~v9;
  }
  v10 = v8;
  v11 = v6;
  v12 = v5;
  v13 = v7;
  if ( v8 )
  {
    if ( v8 <= v11 )
    {
      if ( v8 >= 0x10000 )
      {
        if ( v8 >= 0x1000000 )
          v56 = 24;
        else
          v56 = 16;
      }
      else if ( v8 <= 0xFF )
      {
        v56 = 0;
      }
      else
      {
        v56 = 8;
      }
      v57 = v8 >> v56;
      v58 = 32 - v56;
      v59 = byte_8BA3E[v57];
      v60 = v58 - v59;
      if ( v58 != v59 )
      {
        v62 = (unsigned int)v11 >> (32 - v60);
        v63 = (v7 >> (32 - v60)) | (v10 << v60);
        v90 = (v12 >> (32 - v60)) | (v11 << v60);
        v64 = sub_43A2C((unsigned int)v11 >> (32 - v60), (unsigned int)v63 >> 16);
        v65 = (unsigned __int16)v63;
        v66 = v64;
        sub_43AD4(v62, (unsigned int)v63 >> 16);
        v67 = (unsigned __int16)v63 * v66;
        v89 = v13 << v60;
        v69 = ((unsigned int)v90 >> 16) | (v68 << 16);
        if ( v69 < (unsigned int)v67 )
        {
          v61 = __CFADD__(v69, v63);
          v69 += v63;
          --v66;
          if ( !v61 && v69 < (unsigned int)v67 )
          {
            --v66;
            v69 += v63;
          }
        }
        v70 = v69 - v67;
        v71 = sub_43A2C(v70, (unsigned int)v63 >> 16);
        sub_43AD4(v70, (unsigned int)v63 >> 16);
        v72 = v65 * v71;
        v74 = (unsigned __int16)v90 | (v73 << 16);
        if ( v74 < v65 * v71 )
        {
          v61 = __CFADD__(v74, v63);
          v74 += v63;
          --v71;
          if ( !v61 && v74 < (unsigned int)v72 )
          {
            v74 += v63;
            --v71;
          }
        }
        v75 = v74 - v72;
        v26 = v71 | (v66 << 16);
        v76 = v26 & ~((unsigned int)v26 >> 16 << 16);
        v77 = v89 & ~(v89 >> 16 << 16);
        v78 = v76 * v77;
        v79 = ((unsigned int)v26 >> 16) * v77;
        v80 = (v89 >> 16) * v76;
        v81 = ((unsigned int)v26 >> 16) * (v89 >> 16);
        v61 = __CFADD__(v79, v80);
        v82 = v79 + v80;
        if ( v61 )
          v81 += 0x10000;
        v83 = __PAIR__(v81, v78) + __PAIR__(v82 >> 16, v82 << 16);
        if ( (__PAIR__(v81, v78) + __PAIR__(v82 >> 16, v82 << 16)) >> 32 <= (unsigned int)v75 )
        {
          v84 = (unsigned int)v83 > v12 << v60 ? (unsigned __int8)(HIDWORD(v83) == v75) : 0;
          if ( !v84 )
          {
            v33 = 0;
            goto LABEL_93;
          }
        }
        --v26;
        goto LABEL_91;
      }
      v61 = v11 >= v10;
      if ( v11 <= v10 )
        v61 = v5 >= v7;
      if ( v61 )
      {
        v33 = v58 - v59;
        v26 = 1;
        goto LABEL_93;
      }
    }
    v33 = 0;
    v26 = 0;
  }
  else
  {
    if ( v7 > v11 )
    {
      if ( v7 >= 0x10000 )
      {
        if ( v7 >= 0x1000000 )
          v14 = 24;
        else
          v14 = 16;
      }
      else if ( v7 <= 0xFF )
      {
        v14 = 0;
      }
      else
      {
        v14 = 8;
      }
      v15 = 32 - v14 - byte_8BA3E[v7 >> v14];
      if ( v15 )
      {
        v13 = v7 << v15;
        v11 = (v5 >> (32 - v15)) | (v11 << v15);
      }
      if ( v15 )
        v12 = v5 << v15;
      v16 = sub_43A2C(v11, v13 >> 16);
      sub_43AD4(v11, v13 >> 16);
      v17 = (unsigned __int16)v13;
      v18 = (unsigned __int16)v13 * v16;
      v20 = (v12 >> 16) | (v19 << 16);
      if ( v20 < (unsigned int)v18 )
      {
        v61 = __CFADD__(v20, v13);
        v20 += v13;
        --v16;
        if ( !v61 && v20 < (unsigned int)v18 )
        {
          --v16;
          v20 += v13;
        }
      }
      v21 = v20 - v18;
      v22 = sub_43A2C(v21, v13 >> 16);
      sub_43AD4(v21, v13 >> 16);
      v23 = v17 * v22;
      v25 = (unsigned __int16)v12 | (v24 << 16);
      if ( v25 < v17 * v22 )
      {
        --v22;
        if ( !__CFADD__(v25, v13) && v25 + v13 < v23 )
          --v22;
      }
      v26 = v22 | (v16 << 16);
LABEL_91:
      v33 = 0;
      goto LABEL_93;
    }
    if ( !v7 )
      v13 = sub_43A2C(1u, 0);
    if ( v13 >= 0x10000 )
    {
      if ( v13 >= 0x1000000 )
        v27 = 24;
      else
        v27 = 16;
    }
    else if ( v13 <= 0xFF )
    {
      v27 = 0;
    }
    else
    {
      v27 = 8;
    }
    v28 = v13 >> v27;
    v29 = 32 - v27;
    v30 = byte_8BA3E[v28];
    v31 = v29 - v30;
    if ( v29 == v30 )
    {
      v32 = v11 - v13;
      v33 = 1;
    }
    else
    {
      v34 = (unsigned int)v11 >> (32 - v31);
      v13 <<= v31;
      v88 = (v12 >> (32 - v31)) | (v11 << v31);
      v35 = sub_43A2C((unsigned int)v11 >> (32 - v31), v13 >> 16);
      v36 = (unsigned __int16)v13;
      v37 = v35;
      sub_43AD4(v34, v13 >> 16);
      v38 = (unsigned __int16)v13 * v37;
      v40 = ((unsigned int)v88 >> 16) | (v39 << 16);
      if ( v40 < (unsigned int)v38 )
      {
        v61 = __CFADD__(v40, v13);
        v40 += v13;
        --v37;
        if ( !v61 && v40 < (unsigned int)v38 )
        {
          --v37;
          v40 += v13;
        }
      }
      v41 = v40 - v38;
      v42 = sub_43A2C(v41, v13 >> 16);
      sub_43AD4(v41, v13 >> 16);
      v43 = v36 * v42;
      v45 = (unsigned __int16)v88 | (v44 << 16);
      if ( v45 < v36 * v42 )
      {
        v61 = __CFADD__(v45, v13);
        v45 += v13;
        --v42;
        if ( !v61 && v45 < (unsigned int)v43 )
        {
          --v42;
          v45 += v13;
        }
      }
      v12 <<= v31;
      v32 = v45 - v43;
      v33 = v42 | (v37 << 16);
    }
    v46 = (unsigned __int16)v13;
    v47 = sub_43A2C(v32, v13 >> 16);
    sub_43AD4(v32, v13 >> 16);
    v48 = (unsigned __int16)v13 * v47;
    v50 = (v12 >> 16) | (v49 << 16);
    if ( v50 < (unsigned int)v48 )
    {
      v61 = __CFADD__(v50, v13);
      v50 += v13;
      --v47;
      if ( !v61 && v50 < (unsigned int)v48 )
      {
        --v47;
        v50 += v13;
      }
    }
    v51 = v50 - v48;
    v52 = sub_43A2C(v51, v13 >> 16);
    sub_43AD4(v51, v13 >> 16);
    v53 = v46 * v52;
    v55 = (unsigned __int16)v12 | (v54 << 16);
    if ( v55 < v46 * v52 )
    {
      --v52;
      if ( !__CFADD__(v55, v13) && v55 + v13 < v53 )
        --v52;
    }
    v26 = v52 | (v47 << 16);
  }
LABEL_93:
  v85 = __PAIR__(v33, v26);
  if ( v87 )
  {
    LODWORD(v85) = -v26;
    HIDWORD(v85) = -(((unsigned int)v26 > 0) + v33);
  }
  return v85;
}

//----- (00044FA8) --------------------------------------------------------
signed int __fastcall sub_44FA8(unsigned int a1, unsigned int a2, unsigned int a3, unsigned int a4)
{
  unsigned int v4; // r7@1
  unsigned int v5; // r12@1
  unsigned int v6; // r11@1
  unsigned int v7; // r5@1
  int v8; // r4@1
  signed int v9; // r2@5
  int v10; // r2@11
  int v11; // r7@15
  unsigned int v12; // r10@15
  int v13; // r2@15
  int v14; // r1@15
  int v15; // r4@15
  unsigned int v16; // r4@19
  unsigned int v17; // r6@19
  int v18; // r2@19
  int v19; // r1@19
  int v20; // r0@19
  int v21; // r12@23
  signed int v22; // r2@28
  unsigned int v23; // r1@34
  int v24; // r2@34
  int v25; // r3@34
  char v26; // r9@34
  unsigned int v27; // r4@35
  unsigned int v28; // r4@36
  int v29; // r7@36
  unsigned int v30; // r10@36
  int v31; // r2@36
  unsigned int v32; // r1@36
  unsigned int v33; // r4@36
  unsigned int v34; // r4@40
  unsigned int v35; // r6@40
  int v36; // r4@40
  int v37; // r1@40
  int v38; // r0@40
  int v39; // r8@45
  unsigned int v40; // r9@45
  int v41; // r2@45
  int v42; // r1@45
  int v43; // r4@45
  unsigned int v44; // r4@49
  unsigned int v45; // r6@49
  int v46; // r2@49
  int v47; // r1@49
  int v48; // r0@49
  signed int v49; // r2@57
  unsigned int v50; // r1@63
  int v51; // r2@63
  int v52; // r3@63
  char v53; // r9@63
  unsigned __int8 v54; // cf@64
  unsigned int v55; // r4@69
  int v56; // r6@69
  int v57; // r7@69
  unsigned int v58; // r10@69
  int v59; // r2@69
  unsigned int v60; // r1@69
  unsigned int v61; // r4@69
  unsigned int v62; // r4@73
  unsigned int v63; // r5@73
  int v64; // r2@73
  int v65; // r1@73
  int v66; // r0@73
  int v67; // r2@77
  int v68; // lr@77
  int v69; // r4@77
  int v70; // r1@77
  int v71; // r4@77
  int v72; // lr@77
  int v73; // r3@77
  unsigned int v74; // lr@77
  unsigned __int64 v75; // kr08_8@79
  int v76; // r0@81
  int v78; // [sp+4h] [bp-34h]@36
  unsigned int v79; // [sp+8h] [bp-30h]@69
  int v80; // [sp+Ch] [bp-2Ch]@69

  v4 = a2;
  v5 = a4;
  v6 = a1;
  v7 = a3;
  v8 = a2;
  if ( !a4 )
  {
    if ( a3 <= a2 )
    {
      if ( !a3 )
        v7 = sub_43A2C(1u, 0);
      if ( v7 >= 0x10000 )
      {
        if ( v7 >= 0x1000000 )
          v22 = 24;
        else
          v22 = 16;
      }
      else if ( v7 <= 0xFF )
      {
        v22 = 0;
      }
      else
      {
        v22 = 8;
      }
      v23 = v7 >> v22;
      v24 = 32 - v22;
      v25 = byte_8BA3E[v23];
      v26 = v24 - v25;
      if ( v24 == v25 )
      {
        v27 = v4 - v7;
      }
      else
      {
        v28 = v4 >> (32 - v26);
        v7 <<= v26;
        v78 = (v6 >> (32 - v26)) | (v4 << v26);
        v29 = (unsigned __int16)v7;
        v30 = sub_43A2C(v28, v7 >> 16);
        sub_43AD4(v28, v7 >> 16);
        v31 = (unsigned __int16)v7 * v30;
        v33 = (signed __int64)__PAIR__(v32, v78) >> 16;
        if ( v33 < v31 )
        {
          v54 = __CFADD__(v33, v7);
          v33 += v7;
          if ( !v54 && v33 < v31 )
            v33 += v7;
        }
        v34 = v33 - v31;
        v35 = sub_43A2C(v34, v7 >> 16);
        sub_43AD4(v34, v7 >> 16);
        v36 = v29 * v35;
        v38 = (unsigned __int16)v78 | (v37 << 16);
        if ( v38 < v29 * v35 )
        {
          v54 = __CFADD__(v38, v7);
          v38 += v7;
          if ( !v54 && v38 < (unsigned int)v36 )
            v38 += v7;
        }
        v6 <<= v26;
        v27 = v38 - v36;
      }
      v39 = (unsigned __int16)v7;
      v40 = sub_43A2C(v27, v7 >> 16);
      sub_43AD4(v27, v7 >> 16);
      v41 = (unsigned __int16)v7 * v40;
      v43 = (v6 >> 16) | (v42 << 16);
      if ( v43 < (unsigned int)v41 )
      {
        v54 = __CFADD__(v43, v7);
        v43 += v7;
        --v40;
        if ( !v54 && v43 < (unsigned int)v41 )
        {
          --v40;
          v43 += v7;
        }
      }
      v44 = v43 - v41;
      v45 = sub_43A2C(v44, v7 >> 16);
      sub_43AD4(v44, v7 >> 16);
      v46 = v39 * v45;
      v48 = (unsigned __int16)v6 | (v47 << 16);
      if ( v48 < v39 * v45 )
      {
        --v45;
        if ( !__CFADD__(v48, v7) && v48 + v7 < v46 )
          --v45;
      }
      v21 = v45 | (v40 << 16);
    }
    else
    {
      if ( a3 >= 0x10000 )
      {
        if ( a3 >= 0x1000000 )
          v9 = 24;
        else
          v9 = 16;
      }
      else if ( a3 <= 0xFF )
      {
        v9 = 0;
      }
      else
      {
        v9 = 8;
      }
      v10 = 32 - v9 - byte_8BA3E[v7 >> v9];
      if ( v10 )
      {
        v7 <<= v10;
        v8 = (a1 >> (32 - v10)) | (a2 << v10);
      }
      if ( v10 )
        v6 = a1 << v10;
      v11 = (unsigned __int16)v7;
      v12 = sub_43A2C(v8, v7 >> 16);
      sub_43AD4(v8, v7 >> 16);
      v13 = (unsigned __int16)v7 * v12;
      v15 = (v6 >> 16) | (v14 << 16);
      if ( v15 < (unsigned int)v13 )
      {
        v54 = __CFADD__(v15, v7);
        v15 += v7;
        --v12;
        if ( !v54 && v15 < (unsigned int)v13 )
        {
          --v12;
          v15 += v7;
        }
      }
      v16 = v15 - v13;
      v17 = sub_43A2C(v16, v7 >> 16);
      sub_43AD4(v16, v7 >> 16);
      v18 = v11 * v17;
      v20 = (unsigned __int16)v6 | (v19 << 16);
      if ( v20 < v11 * v17 )
      {
        --v17;
        if ( !__CFADD__(v20, v7) && v20 + v7 < v18 )
          --v17;
      }
      v21 = v17 | (v12 << 16);
    }
    return v21;
  }
  if ( a4 > a2 )
    return 0;
  if ( a4 >= 0x10000 )
  {
    if ( a4 >= 0x1000000 )
      v49 = 24;
    else
      v49 = 16;
  }
  else if ( a4 <= 0xFF )
  {
    v49 = 0;
  }
  else
  {
    v49 = 8;
  }
  v50 = a4 >> v49;
  v51 = 32 - v49;
  v52 = byte_8BA3E[v50];
  v53 = v51 - v52;
  if ( v51 == v52 )
  {
    v54 = v4 >= v5;
    if ( v4 <= v5 )
      v54 = a1 >= v7;
    if ( v54 )
      return 1;
    return 0;
  }
  v55 = v4 >> (32 - v53);
  v56 = (v7 >> (32 - v53)) | (v5 << v53);
  v80 = (a1 >> (32 - v53)) | (v4 << v53);
  v57 = (unsigned __int16)v56;
  v58 = sub_43A2C(v55, (unsigned int)v56 >> 16);
  sub_43AD4(v55, (unsigned int)v56 >> 16);
  v59 = (unsigned __int16)v56 * v58;
  v79 = v7 << v53;
  v61 = (signed __int64)__PAIR__(v60, v80) >> 16;
  if ( v61 < v59 )
  {
    v54 = __CFADD__(v61, v56);
    v61 += v56;
    --v58;
    if ( !v54 && v61 < v59 )
    {
      --v58;
      v61 += v56;
    }
  }
  v62 = v61 - v59;
  v63 = sub_43A2C(v62, (unsigned int)v56 >> 16);
  sub_43AD4(v62, (unsigned int)v56 >> 16);
  v64 = v57 * v63;
  v66 = (unsigned __int16)v80 | (v65 << 16);
  if ( v66 < v57 * v63 )
  {
    v54 = __CFADD__(v66, v56);
    v66 += v56;
    --v63;
    if ( !v54 && v66 < (unsigned int)v64 )
    {
      v66 += v56;
      --v63;
    }
  }
  v67 = v66 - v64;
  v21 = v63 | (v58 << 16);
  v68 = v21 & ~((unsigned int)v21 >> 16 << 16);
  v69 = v79 & ~(v79 >> 16 << 16);
  v70 = v68 * v69;
  v71 = ((unsigned int)v21 >> 16) * v69;
  v72 = (v79 >> 16) * v68;
  v73 = ((unsigned int)v21 >> 16) * (v79 >> 16);
  v54 = __CFADD__(v71, v72);
  v74 = v71 + v72;
  if ( v54 )
    v73 += 0x10000;
  v75 = __PAIR__(v73, v70) + __PAIR__(v74 >> 16, v74 << 16);
  if ( (__PAIR__(v73, v70) + __PAIR__(v74 >> 16, v74 << 16)) >> 32 > (unsigned int)v67
    || ((unsigned int)v75 > v6 << v53 ? (v76 = HIDWORD(v75) == v67) : (v76 = 0), v76) )
    --v21;
  return v21;
}

//----- (00045470) --------------------------------------------------------
int __fastcall sub_45470(int a1, int a2, int a3)
{
  int v3; // r10@1
  int v4; // r8@1
  int v5; // r7@1
  int result; // r0@1
  unsigned int v7; // r4@2

  v3 = a1;
  v4 = a2;
  v5 = a3;
  result = init_proc();
  if ( 4 >> 2 )
  {
    v7 = 0;
    do
      result = ((int (__fastcall *)(int, int, int))off_93EE4[v7++])(v3, v4, v5);
    while ( v7 < 4 >> 2 );
  }
  return result;
}
// 93EE4: using guessed type int (*off_93EE4[2])();

//----- (000454DC) --------------------------------------------------------
void term_proc()
{
  ;
}

#error "There were 1 decompilation failure(s) on 359 function(s)"
